[
  {
    "function_name": "virCgroupGetCpuPeriodQuota",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "3744-3755",
    "snippet": "int\nvirCgroupGetCpuPeriodQuota(virCgroupPtr cgroup, unsigned long long *period,\n                           long long *quota)\n{\n    if (virCgroupGetCpuCfsPeriod(cgroup, period) < 0)\n        return -1;\n\n    if (virCgroupGetCpuCfsQuota(cgroup, quota) < 0)\n        return -1;\n\n    return 0;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCgroupGetCpuCfsQuota",
          "args": [
            "cgroup",
            "quota"
          ],
          "line": 3751
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupGetCpuCfsQuota",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3406-3413",
          "snippet": "int\nvirCgroupGetCpuCfsQuota(virCgroupPtr group G_GNUC_UNUSED,\n                        long long *cfs_quota G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetCpuCfsQuota(virCgroupPtr group G_GNUC_UNUSED,\n                        long long *cfs_quota G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupGetCpuCfsPeriod",
          "args": [
            "cgroup",
            "period"
          ],
          "line": 3748
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupGetCpuCfsPeriod",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3358-3365",
          "snippet": "int\nvirCgroupGetCpuCfsPeriod(virCgroupPtr group G_GNUC_UNUSED,\n                         unsigned long long *cfs_period G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetCpuCfsPeriod(virCgroupPtr group G_GNUC_UNUSED,\n                         unsigned long long *cfs_period G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetCpuPeriodQuota(virCgroupPtr cgroup, unsigned long long *period,\n                           long long *quota)\n{\n    if (virCgroupGetCpuCfsPeriod(cgroup, period) < 0)\n        return -1;\n\n    if (virCgroupGetCpuCfsQuota(cgroup, quota) < 0)\n        return -1;\n\n    return 0;\n}"
  },
  {
    "function_name": "virCgroupSetupCpuPeriodQuota",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "3706-3741",
    "snippet": "int\nvirCgroupSetupCpuPeriodQuota(virCgroupPtr cgroup,\n                             unsigned long long period,\n                             long long quota)\n{\n    unsigned long long old_period;\n\n    if (period == 0 && quota == 0)\n        return 0;\n\n    if (period) {\n        /* get old period, and we can rollback if set quota failed */\n        if (virCgroupGetCpuCfsPeriod(cgroup, &old_period) < 0)\n            return -1;\n\n        if (virCgroupSetCpuCfsPeriod(cgroup, period) < 0)\n            return -1;\n    }\n\n    if (quota &&\n        virCgroupSetCpuCfsQuota(cgroup, quota) < 0)\n        goto error;\n\n    return 0;\n\n error:\n    if (period) {\n        virErrorPtr saved;\n\n        virErrorPreserveLast(&saved);\n        ignore_value(virCgroupSetCpuCfsPeriod(cgroup, old_period));\n        virErrorRestore(&saved);\n    }\n\n    return -1;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virErrorRestore",
          "args": [
            "&saved"
          ],
          "line": 3737
        },
        "resolved": true,
        "details": {
          "function_name": "virErrorRestore",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "445-457",
          "snippet": "void\nvirErrorRestore(virErrorPtr *savederr)\n{\n    int saved_errno = errno;\n\n    if (!*savederr)\n        return;\n\n    virSetError(*savederr);\n    virFreeError(*savederr);\n    *savederr = NULL;\n    errno = saved_errno;\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirErrorRestore(virErrorPtr *savederr)\n{\n    int saved_errno = errno;\n\n    if (!*savederr)\n        return;\n\n    virSetError(*savederr);\n    virFreeError(*savederr);\n    *savederr = NULL;\n    errno = saved_errno;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ignore_value",
          "args": [
            "virCgroupSetCpuCfsPeriod(cgroup, old_period)"
          ],
          "line": 3736
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCgroupSetCpuCfsPeriod",
          "args": [
            "cgroup",
            "old_period"
          ],
          "line": 3736
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupSetCpuCfsPeriod",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3348-3355",
          "snippet": "int\nvirCgroupSetCpuCfsPeriod(virCgroupPtr group G_GNUC_UNUSED,\n                         unsigned long long cfs_period G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupSetCpuCfsPeriod(virCgroupPtr group G_GNUC_UNUSED,\n                         unsigned long long cfs_period G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virErrorPreserveLast",
          "args": [
            "&saved"
          ],
          "line": 3735
        },
        "resolved": true,
        "details": {
          "function_name": "virErrorPreserveLast",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "424-436",
          "snippet": "void\nvirErrorPreserveLast(virErrorPtr *saveerr)\n{\n    int saved_errno = errno;\n    virErrorPtr lasterr = virGetLastError();\n\n    *saveerr = NULL;\n\n    if (lasterr)\n        *saveerr = virErrorCopyNew(lasterr);\n\n    errno = saved_errno;\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirErrorPreserveLast(virErrorPtr *saveerr)\n{\n    int saved_errno = errno;\n    virErrorPtr lasterr = virGetLastError();\n\n    *saveerr = NULL;\n\n    if (lasterr)\n        *saveerr = virErrorCopyNew(lasterr);\n\n    errno = saved_errno;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupSetCpuCfsQuota",
          "args": [
            "cgroup",
            "quota"
          ],
          "line": 3726
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupSetCpuCfsQuota",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3368-3375",
          "snippet": "int\nvirCgroupSetCpuCfsQuota(virCgroupPtr group G_GNUC_UNUSED,\n                        long long cfs_quota G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupSetCpuCfsQuota(virCgroupPtr group G_GNUC_UNUSED,\n                        long long cfs_quota G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupGetCpuCfsPeriod",
          "args": [
            "cgroup",
            "&old_period"
          ],
          "line": 3718
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupGetCpuCfsPeriod",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3358-3365",
          "snippet": "int\nvirCgroupGetCpuCfsPeriod(virCgroupPtr group G_GNUC_UNUSED,\n                         unsigned long long *cfs_period G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetCpuCfsPeriod(virCgroupPtr group G_GNUC_UNUSED,\n                         unsigned long long *cfs_period G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupSetupCpuPeriodQuota(virCgroupPtr cgroup,\n                             unsigned long long period,\n                             long long quota)\n{\n    unsigned long long old_period;\n\n    if (period == 0 && quota == 0)\n        return 0;\n\n    if (period) {\n        /* get old period, and we can rollback if set quota failed */\n        if (virCgroupGetCpuCfsPeriod(cgroup, &old_period) < 0)\n            return -1;\n\n        if (virCgroupSetCpuCfsPeriod(cgroup, period) < 0)\n            return -1;\n    }\n\n    if (quota &&\n        virCgroupSetCpuCfsQuota(cgroup, quota) < 0)\n        goto error;\n\n    return 0;\n\n error:\n    if (period) {\n        virErrorPtr saved;\n\n        virErrorPreserveLast(&saved);\n        ignore_value(virCgroupSetCpuCfsPeriod(cgroup, old_period));\n        virErrorRestore(&saved);\n    }\n\n    return -1;\n}"
  },
  {
    "function_name": "virCgroupSetupCpuShares",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "3692-3703",
    "snippet": "int\nvirCgroupSetupCpuShares(virCgroupPtr cgroup, unsigned long long shares,\n                        unsigned long long *realValue)\n{\n    if (virCgroupSetCpuShares(cgroup, shares) < 0)\n        return -1;\n\n    if (virCgroupGetCpuShares(cgroup, realValue) < 0)\n        return -1;\n\n    return 0;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCgroupGetCpuShares",
          "args": [
            "cgroup",
            "realValue"
          ],
          "line": 3699
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupGetCpuShares",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3338-3345",
          "snippet": "int\nvirCgroupGetCpuShares(virCgroupPtr group G_GNUC_UNUSED,\n                      unsigned long long *shares G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetCpuShares(virCgroupPtr group G_GNUC_UNUSED,\n                      unsigned long long *shares G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupSetCpuShares",
          "args": [
            "cgroup",
            "shares"
          ],
          "line": 3696
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupSetCpuShares",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3328-3335",
          "snippet": "int\nvirCgroupSetCpuShares(virCgroupPtr group G_GNUC_UNUSED,\n                      unsigned long long shares G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupSetCpuShares(virCgroupPtr group G_GNUC_UNUSED,\n                      unsigned long long shares G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupSetupCpuShares(virCgroupPtr cgroup, unsigned long long shares,\n                        unsigned long long *realValue)\n{\n    if (virCgroupSetCpuShares(cgroup, shares) < 0)\n        return -1;\n\n    if (virCgroupGetCpuShares(cgroup, realValue) < 0)\n        return -1;\n\n    return 0;\n}"
  },
  {
    "function_name": "virCgroupSetupCpusetCpus",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "3671-3683",
    "snippet": "int\nvirCgroupSetupCpusetCpus(virCgroupPtr cgroup, virBitmapPtr cpumask)\n{\n    g_autofree char *new_cpus = NULL;\n\n    if (!(new_cpus = virBitmapFormat(cpumask)))\n        return -1;\n\n    if (virCgroupSetCpusetCpus(cgroup, new_cpus) < 0)\n        return -1;\n\n    return 0;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCgroupSetCpusetCpus",
          "args": [
            "cgroup",
            "new_cpus"
          ],
          "line": 3679
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupSetCpusetCpus",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3241-3248",
          "snippet": "int\nvirCgroupSetCpusetCpus(virCgroupPtr group G_GNUC_UNUSED,\n                       const char *cpus G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupSetCpusetCpus(virCgroupPtr group G_GNUC_UNUSED,\n                       const char *cpus G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBitmapFormat",
          "args": [
            "cpumask"
          ],
          "line": 3676
        },
        "resolved": true,
        "details": {
          "function_name": "virBitmapFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
          "lines": "404-442",
          "snippet": "char *\nvirBitmapFormat(virBitmapPtr bitmap)\n{\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n    bool first = true;\n    int start, cur, prev;\n\n    if (!bitmap || (cur = virBitmapNextSetBit(bitmap, -1)) < 0) {\n        char *ret;\n        ret = g_strdup(\"\");\n        return ret;\n    }\n\n    start = prev = cur;\n    while (prev >= 0) {\n        cur = virBitmapNextSetBit(bitmap, prev);\n\n        if (cur == prev + 1) {\n            prev = cur;\n            continue;\n        }\n\n        /* cur < 0 or cur > prev + 1 */\n\n        if (!first)\n            virBufferAddLit(&buf, \",\");\n        else\n            first = false;\n\n        if (prev == start)\n            virBufferAsprintf(&buf, \"%d\", start);\n        else\n            virBufferAsprintf(&buf, \"%d-%d\", start, prev);\n\n        start = prev = cur;\n    }\n\n    return virBufferContentAndReset(&buf);\n}",
          "includes": [
            "#include \"virerror.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbitmap.h\"",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\nchar *\nvirBitmapFormat(virBitmapPtr bitmap)\n{\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n    bool first = true;\n    int start, cur, prev;\n\n    if (!bitmap || (cur = virBitmapNextSetBit(bitmap, -1)) < 0) {\n        char *ret;\n        ret = g_strdup(\"\");\n        return ret;\n    }\n\n    start = prev = cur;\n    while (prev >= 0) {\n        cur = virBitmapNextSetBit(bitmap, prev);\n\n        if (cur == prev + 1) {\n            prev = cur;\n            continue;\n        }\n\n        /* cur < 0 or cur > prev + 1 */\n\n        if (!first)\n            virBufferAddLit(&buf, \",\");\n        else\n            first = false;\n\n        if (prev == start)\n            virBufferAsprintf(&buf, \"%d\", start);\n        else\n            virBufferAsprintf(&buf, \"%d-%d\", start, prev);\n\n        start = prev = cur;\n    }\n\n    return virBufferContentAndReset(&buf);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupSetupCpusetCpus(virCgroupPtr cgroup, virBitmapPtr cpumask)\n{\n    g_autofree char *new_cpus = NULL;\n\n    if (!(new_cpus = virBitmapFormat(cpumask)))\n        return -1;\n\n    if (virCgroupSetCpusetCpus(cgroup, new_cpus) < 0)\n        return -1;\n\n    return 0;\n}"
  },
  {
    "function_name": "virCgroupSetupBlkioDeviceWriteBps",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "3659-3668",
    "snippet": "int\nvirCgroupSetupBlkioDeviceWriteBps(virCgroupPtr cgroup, const char *path,\n                                  unsigned long long *wbps)\n{\n    if (virCgroupSetBlkioDeviceWriteBps(cgroup, path, *wbps) < 0 ||\n        virCgroupGetBlkioDeviceWriteBps(cgroup, path, wbps) < 0)\n        return -1;\n\n    return 0;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCgroupGetBlkioDeviceWriteBps",
          "args": [
            "cgroup",
            "path",
            "wbps"
          ],
          "line": 3664
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupGetBlkioDeviceWriteBps",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3086-3094",
          "snippet": "static int\nvirCgroupGetBlkioDeviceWriteBps(virCgroupPtr group G_GNUC_UNUSED,\n                                const char *path G_GNUC_UNUSED,\n                                unsigned long long *wbps G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nstatic int\nvirCgroupGetBlkioDeviceWriteBps(virCgroupPtr group G_GNUC_UNUSED,\n                                const char *path G_GNUC_UNUSED,\n                                unsigned long long *wbps G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupSetBlkioDeviceWriteBps",
          "args": [
            "cgroup",
            "path",
            "*wbps"
          ],
          "line": 3663
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupSetBlkioDeviceWriteBps",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3036-3044",
          "snippet": "static int\nvirCgroupSetBlkioDeviceWriteBps(virCgroupPtr group G_GNUC_UNUSED,\n                                const char *path G_GNUC_UNUSED,\n                                unsigned long long wbps G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nstatic int\nvirCgroupSetBlkioDeviceWriteBps(virCgroupPtr group G_GNUC_UNUSED,\n                                const char *path G_GNUC_UNUSED,\n                                unsigned long long wbps G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupSetupBlkioDeviceWriteBps(virCgroupPtr cgroup, const char *path,\n                                  unsigned long long *wbps)\n{\n    if (virCgroupSetBlkioDeviceWriteBps(cgroup, path, *wbps) < 0 ||\n        virCgroupGetBlkioDeviceWriteBps(cgroup, path, wbps) < 0)\n        return -1;\n\n    return 0;\n}"
  },
  {
    "function_name": "virCgroupSetupBlkioDeviceReadBps",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "3642-3651",
    "snippet": "int\nvirCgroupSetupBlkioDeviceReadBps(virCgroupPtr cgroup, const char *path,\n                                 unsigned long long *rbps)\n{\n    if (virCgroupSetBlkioDeviceReadBps(cgroup, path, *rbps) < 0 ||\n        virCgroupGetBlkioDeviceReadBps(cgroup, path, rbps) < 0)\n        return -1;\n\n    return 0;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCgroupGetBlkioDeviceReadBps",
          "args": [
            "cgroup",
            "path",
            "rbps"
          ],
          "line": 3647
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupGetBlkioDeviceReadBps",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3076-3084",
          "snippet": "static int\nvirCgroupGetBlkioDeviceReadBps(virCgroupPtr group G_GNUC_UNUSED,\n                               const char *path G_GNUC_UNUSED,\n                               unsigned long long *rbps G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nstatic int\nvirCgroupGetBlkioDeviceReadBps(virCgroupPtr group G_GNUC_UNUSED,\n                               const char *path G_GNUC_UNUSED,\n                               unsigned long long *rbps G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupSetBlkioDeviceReadBps",
          "args": [
            "cgroup",
            "path",
            "*rbps"
          ],
          "line": 3646
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupSetBlkioDeviceReadBps",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3026-3034",
          "snippet": "static int\nvirCgroupSetBlkioDeviceReadBps(virCgroupPtr group G_GNUC_UNUSED,\n                               const char *path G_GNUC_UNUSED,\n                               unsigned long long rbps G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nstatic int\nvirCgroupSetBlkioDeviceReadBps(virCgroupPtr group G_GNUC_UNUSED,\n                               const char *path G_GNUC_UNUSED,\n                               unsigned long long rbps G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupSetupBlkioDeviceReadBps(virCgroupPtr cgroup, const char *path,\n                                 unsigned long long *rbps)\n{\n    if (virCgroupSetBlkioDeviceReadBps(cgroup, path, *rbps) < 0 ||\n        virCgroupGetBlkioDeviceReadBps(cgroup, path, rbps) < 0)\n        return -1;\n\n    return 0;\n}"
  },
  {
    "function_name": "virCgroupSetupBlkioDeviceWriteIops",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "3625-3634",
    "snippet": "int\nvirCgroupSetupBlkioDeviceWriteIops(virCgroupPtr cgroup, const char *path,\n                                   unsigned int *wiops)\n{\n    if (virCgroupSetBlkioDeviceWriteIops(cgroup, path, *wiops) < 0 ||\n        virCgroupGetBlkioDeviceWriteIops(cgroup, path, wiops) < 0)\n        return -1;\n\n    return 0;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCgroupGetBlkioDeviceWriteIops",
          "args": [
            "cgroup",
            "path",
            "wiops"
          ],
          "line": 3630
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupGetBlkioDeviceWriteIops",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3066-3074",
          "snippet": "static int\nvirCgroupGetBlkioDeviceWriteIops(virCgroupPtr group G_GNUC_UNUSED,\n                                 const char *path G_GNUC_UNUSED,\n                                 unsigned int *wiops G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nstatic int\nvirCgroupGetBlkioDeviceWriteIops(virCgroupPtr group G_GNUC_UNUSED,\n                                 const char *path G_GNUC_UNUSED,\n                                 unsigned int *wiops G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupSetBlkioDeviceWriteIops",
          "args": [
            "cgroup",
            "path",
            "*wiops"
          ],
          "line": 3629
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupSetBlkioDeviceWriteIops",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3016-3024",
          "snippet": "static int\nvirCgroupSetBlkioDeviceWriteIops(virCgroupPtr group G_GNUC_UNUSED,\n                                 const char *path G_GNUC_UNUSED,\n                                 unsigned int wiops G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nstatic int\nvirCgroupSetBlkioDeviceWriteIops(virCgroupPtr group G_GNUC_UNUSED,\n                                 const char *path G_GNUC_UNUSED,\n                                 unsigned int wiops G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupSetupBlkioDeviceWriteIops(virCgroupPtr cgroup, const char *path,\n                                   unsigned int *wiops)\n{\n    if (virCgroupSetBlkioDeviceWriteIops(cgroup, path, *wiops) < 0 ||\n        virCgroupGetBlkioDeviceWriteIops(cgroup, path, wiops) < 0)\n        return -1;\n\n    return 0;\n}"
  },
  {
    "function_name": "virCgroupSetupBlkioDeviceReadIops",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "3608-3617",
    "snippet": "int\nvirCgroupSetupBlkioDeviceReadIops(virCgroupPtr cgroup, const char *path,\n                                  unsigned int *riops)\n{\n    if (virCgroupSetBlkioDeviceReadIops(cgroup, path, *riops) < 0 ||\n        virCgroupGetBlkioDeviceReadIops(cgroup, path, riops) < 0)\n        return -1;\n\n    return 0;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCgroupGetBlkioDeviceReadIops",
          "args": [
            "cgroup",
            "path",
            "riops"
          ],
          "line": 3613
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupGetBlkioDeviceReadIops",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3056-3064",
          "snippet": "static int\nvirCgroupGetBlkioDeviceReadIops(virCgroupPtr group G_GNUC_UNUSED,\n                                const char *path G_GNUC_UNUSED,\n                                unsigned int *riops G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nstatic int\nvirCgroupGetBlkioDeviceReadIops(virCgroupPtr group G_GNUC_UNUSED,\n                                const char *path G_GNUC_UNUSED,\n                                unsigned int *riops G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupSetBlkioDeviceReadIops",
          "args": [
            "cgroup",
            "path",
            "*riops"
          ],
          "line": 3612
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupSetBlkioDeviceReadIops",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3006-3014",
          "snippet": "static int\nvirCgroupSetBlkioDeviceReadIops(virCgroupPtr group G_GNUC_UNUSED,\n                                const char *path G_GNUC_UNUSED,\n                                unsigned int riops G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nstatic int\nvirCgroupSetBlkioDeviceReadIops(virCgroupPtr group G_GNUC_UNUSED,\n                                const char *path G_GNUC_UNUSED,\n                                unsigned int riops G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupSetupBlkioDeviceReadIops(virCgroupPtr cgroup, const char *path,\n                                  unsigned int *riops)\n{\n    if (virCgroupSetBlkioDeviceReadIops(cgroup, path, *riops) < 0 ||\n        virCgroupGetBlkioDeviceReadIops(cgroup, path, riops) < 0)\n        return -1;\n\n    return 0;\n}"
  },
  {
    "function_name": "virCgroupSetupBlkioDeviceWeight",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "3591-3600",
    "snippet": "int\nvirCgroupSetupBlkioDeviceWeight(virCgroupPtr cgroup, const char *path,\n                                unsigned int *weight)\n{\n    if (virCgroupSetBlkioDeviceWeight(cgroup, path, *weight) < 0 ||\n        virCgroupGetBlkioDeviceWeight(cgroup, path, weight) < 0)\n        return -1;\n\n    return 0;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCgroupGetBlkioDeviceWeight",
          "args": [
            "cgroup",
            "path",
            "weight"
          ],
          "line": 3596
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupGetBlkioDeviceWeight",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3046-3054",
          "snippet": "static int\nvirCgroupGetBlkioDeviceWeight(virCgroupPtr group G_GNUC_UNUSED,\n                              const char *path G_GNUC_UNUSED,\n                              unsigned int *weight G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nstatic int\nvirCgroupGetBlkioDeviceWeight(virCgroupPtr group G_GNUC_UNUSED,\n                              const char *path G_GNUC_UNUSED,\n                              unsigned int *weight G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupSetBlkioDeviceWeight",
          "args": [
            "cgroup",
            "path",
            "*weight"
          ],
          "line": 3595
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupSetBlkioDeviceWeight",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "2996-3004",
          "snippet": "static int\nvirCgroupSetBlkioDeviceWeight(virCgroupPtr group G_GNUC_UNUSED,\n                              const char *path G_GNUC_UNUSED,\n                              unsigned int weight G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nstatic int\nvirCgroupSetBlkioDeviceWeight(virCgroupPtr group G_GNUC_UNUSED,\n                              const char *path G_GNUC_UNUSED,\n                              unsigned int weight G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupSetupBlkioDeviceWeight(virCgroupPtr cgroup, const char *path,\n                                unsigned int *weight)\n{\n    if (virCgroupSetBlkioDeviceWeight(cgroup, path, *weight) < 0 ||\n        virCgroupGetBlkioDeviceWeight(cgroup, path, weight) < 0)\n        return -1;\n\n    return 0;\n}"
  },
  {
    "function_name": "virCgroupDelThread",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "3566-3583",
    "snippet": "int\nvirCgroupDelThread(virCgroupPtr cgroup,\n                   virCgroupThreadName nameval,\n                   int idx)\n{\n    virCgroupPtr new_cgroup = NULL;\n\n    if (cgroup) {\n        if (virCgroupNewThread(cgroup, nameval, idx, false, &new_cgroup) < 0)\n            return -1;\n\n        /* Remove the offlined cgroup */\n        virCgroupRemove(new_cgroup);\n        virCgroupFree(&new_cgroup);\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCgroupFree",
          "args": [
            "&new_cgroup"
          ],
          "line": 3579
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3544-3563",
          "snippet": "void\nvirCgroupFree(virCgroupPtr *group)\n{\n    size_t i;\n\n    if (*group == NULL)\n        return;\n\n    for (i = 0; i < VIR_CGROUP_CONTROLLER_LAST; i++) {\n        VIR_FREE((*group)->legacy[i].mountPoint);\n        VIR_FREE((*group)->legacy[i].linkPoint);\n        VIR_FREE((*group)->legacy[i].placement);\n    }\n\n    VIR_FREE((*group)->unified.mountPoint);\n    VIR_FREE((*group)->unified.placement);\n\n    VIR_FREE((*group)->path);\n    VIR_FREE(*group);\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nvoid\nvirCgroupFree(virCgroupPtr *group)\n{\n    size_t i;\n\n    if (*group == NULL)\n        return;\n\n    for (i = 0; i < VIR_CGROUP_CONTROLLER_LAST; i++) {\n        VIR_FREE((*group)->legacy[i].mountPoint);\n        VIR_FREE((*group)->legacy[i].linkPoint);\n        VIR_FREE((*group)->legacy[i].placement);\n    }\n\n    VIR_FREE((*group)->unified.mountPoint);\n    VIR_FREE((*group)->unified.placement);\n\n    VIR_FREE((*group)->path);\n    VIR_FREE(*group);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupRemove",
          "args": [
            "new_cgroup"
          ],
          "line": 3578
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupRemove",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3378-3384",
          "snippet": "int\nvirCgroupRemove(virCgroupPtr group G_GNUC_UNUSED)\n{\n    virReportSystemError(ENXIO, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupRemove(virCgroupPtr group G_GNUC_UNUSED)\n{\n    virReportSystemError(ENXIO, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupNewThread",
          "args": [
            "cgroup",
            "nameval",
            "idx",
            "false",
            "&new_cgroup"
          ],
          "line": 3574
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupNewThread",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "2825-2835",
          "snippet": "int\nvirCgroupNewThread(virCgroupPtr domain G_GNUC_UNUSED,\n                   virCgroupThreadName nameval G_GNUC_UNUSED,\n                   int id G_GNUC_UNUSED,\n                   bool create G_GNUC_UNUSED,\n                   virCgroupPtr *group G_GNUC_UNUSED)\n{\n    virReportSystemError(ENXIO, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupNewThread(virCgroupPtr domain G_GNUC_UNUSED,\n                   virCgroupThreadName nameval G_GNUC_UNUSED,\n                   int id G_GNUC_UNUSED,\n                   bool create G_GNUC_UNUSED,\n                   virCgroupPtr *group G_GNUC_UNUSED)\n{\n    virReportSystemError(ENXIO, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupDelThread(virCgroupPtr cgroup,\n                   virCgroupThreadName nameval,\n                   int idx)\n{\n    virCgroupPtr new_cgroup = NULL;\n\n    if (cgroup) {\n        if (virCgroupNewThread(cgroup, nameval, idx, false, &new_cgroup) < 0)\n            return -1;\n\n        /* Remove the offlined cgroup */\n        virCgroupRemove(new_cgroup);\n        virCgroupFree(&new_cgroup);\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virCgroupFree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "3544-3563",
    "snippet": "void\nvirCgroupFree(virCgroupPtr *group)\n{\n    size_t i;\n\n    if (*group == NULL)\n        return;\n\n    for (i = 0; i < VIR_CGROUP_CONTROLLER_LAST; i++) {\n        VIR_FREE((*group)->legacy[i].mountPoint);\n        VIR_FREE((*group)->legacy[i].linkPoint);\n        VIR_FREE((*group)->legacy[i].placement);\n    }\n\n    VIR_FREE((*group)->unified.mountPoint);\n    VIR_FREE((*group)->unified.placement);\n\n    VIR_FREE((*group)->path);\n    VIR_FREE(*group);\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "*group"
          ],
          "line": 3562
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "(*group)->path"
          ],
          "line": 3561
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "(*group)->unified.placement"
          ],
          "line": 3559
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "(*group)->unified.mountPoint"
          ],
          "line": 3558
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "(*group)->legacy[i].placement"
          ],
          "line": 3555
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "(*group)->legacy[i].linkPoint"
          ],
          "line": 3554
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "(*group)->legacy[i].mountPoint"
          ],
          "line": 3553
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nvoid\nvirCgroupFree(virCgroupPtr *group)\n{\n    size_t i;\n\n    if (*group == NULL)\n        return;\n\n    for (i = 0; i < VIR_CGROUP_CONTROLLER_LAST; i++) {\n        VIR_FREE((*group)->legacy[i].mountPoint);\n        VIR_FREE((*group)->legacy[i].linkPoint);\n        VIR_FREE((*group)->legacy[i].placement);\n    }\n\n    VIR_FREE((*group)->unified.mountPoint);\n    VIR_FREE((*group)->unified.placement);\n\n    VIR_FREE((*group)->path);\n    VIR_FREE(*group);\n}"
  },
  {
    "function_name": "virCgroupControllerAvailable",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "3531-3535",
    "snippet": "bool\nvirCgroupControllerAvailable(int controller G_GNUC_UNUSED)\n{\n    return false;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nbool\nvirCgroupControllerAvailable(int controller G_GNUC_UNUSED)\n{\n    return false;\n}"
  },
  {
    "function_name": "virCgroupHasEmptyTasks",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "3522-3529",
    "snippet": "int\nvirCgroupHasEmptyTasks(virCgroupPtr cgroup G_GNUC_UNUSED,\n                       int controller G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "\"%s\"",
            "_(\"Control groups not supported on this platform\")"
          ],
          "line": 3526
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Control groups not supported on this platform\""
          ],
          "line": 3527
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupHasEmptyTasks(virCgroupPtr cgroup G_GNUC_UNUSED,\n                       int controller G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
  },
  {
    "function_name": "virCgroupSetOwner",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "3511-3520",
    "snippet": "int\nvirCgroupSetOwner(virCgroupPtr cgroup G_GNUC_UNUSED,\n                  uid_t uid G_GNUC_UNUSED,\n                  gid_t gid G_GNUC_UNUSED,\n                  int controllers G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "\"%s\"",
            "_(\"Control groups not supported on this platform\")"
          ],
          "line": 3517
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Control groups not supported on this platform\""
          ],
          "line": 3518
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupSetOwner(virCgroupPtr cgroup G_GNUC_UNUSED,\n                  uid_t uid G_GNUC_UNUSED,\n                  gid_t gid G_GNUC_UNUSED,\n                  int controllers G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
  },
  {
    "function_name": "virCgroupGetPercpuStats",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "3497-3508",
    "snippet": "int\nvirCgroupGetPercpuStats(virCgroupPtr group G_GNUC_UNUSED,\n                        virTypedParameterPtr params G_GNUC_UNUSED,\n                        unsigned int nparams G_GNUC_UNUSED,\n                        int start_cpu G_GNUC_UNUSED,\n                        unsigned int ncpus G_GNUC_UNUSED,\n                        virBitmapPtr guestvcpus G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "\"%s\"",
            "_(\"Control groups not supported on this platform\")"
          ],
          "line": 3505
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Control groups not supported on this platform\""
          ],
          "line": 3506
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetPercpuStats(virCgroupPtr group G_GNUC_UNUSED,\n                        virTypedParameterPtr params G_GNUC_UNUSED,\n                        unsigned int nparams G_GNUC_UNUSED,\n                        int start_cpu G_GNUC_UNUSED,\n                        unsigned int ncpus G_GNUC_UNUSED,\n                        virBitmapPtr guestvcpus G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
  },
  {
    "function_name": "virCgroupSupportsCpuBW",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "3489-3494",
    "snippet": "bool\nvirCgroupSupportsCpuBW(virCgroupPtr cgroup G_GNUC_UNUSED)\n{\n    VIR_DEBUG(\"Control groups not supported on this platform\");\n    return false;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Control groups not supported on this platform\""
          ],
          "line": 3492
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nbool\nvirCgroupSupportsCpuBW(virCgroupPtr cgroup G_GNUC_UNUSED)\n{\n    VIR_DEBUG(\"Control groups not supported on this platform\");\n    return false;\n}"
  },
  {
    "function_name": "virCgroupBindMount",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "3478-3486",
    "snippet": "int\nvirCgroupBindMount(virCgroupPtr group G_GNUC_UNUSED,\n                   const char *oldroot G_GNUC_UNUSED,\n                   const char *mountopts G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "\"%s\"",
            "_(\"Control groups not supported on this platform\")"
          ],
          "line": 3483
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Control groups not supported on this platform\""
          ],
          "line": 3484
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupBindMount(virCgroupPtr group G_GNUC_UNUSED,\n                   const char *oldroot G_GNUC_UNUSED,\n                   const char *mountopts G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
  },
  {
    "function_name": "virCgroupGetFreezerState",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "3468-3475",
    "snippet": "int\nvirCgroupGetFreezerState(virCgroupPtr group G_GNUC_UNUSED,\n                         char **state G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "\"%s\"",
            "_(\"Control groups not supported on this platform\")"
          ],
          "line": 3472
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Control groups not supported on this platform\""
          ],
          "line": 3473
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetFreezerState(virCgroupPtr group G_GNUC_UNUSED,\n                         char **state G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
  },
  {
    "function_name": "virCgroupSetFreezerState",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "3458-3465",
    "snippet": "int\nvirCgroupSetFreezerState(virCgroupPtr group G_GNUC_UNUSED,\n                         const char *state G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "\"%s\"",
            "_(\"Control groups not supported on this platform\")"
          ],
          "line": 3462
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Control groups not supported on this platform\""
          ],
          "line": 3463
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupSetFreezerState(virCgroupPtr group G_GNUC_UNUSED,\n                         const char *state G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
  },
  {
    "function_name": "virCgroupGetDomainTotalCpuStats",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "3447-3455",
    "snippet": "int\nvirCgroupGetDomainTotalCpuStats(virCgroupPtr group G_GNUC_UNUSED,\n                                virTypedParameterPtr params G_GNUC_UNUSED,\n                                int nparams G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "\"%s\"",
            "_(\"Control groups not supported on this platform\")"
          ],
          "line": 3452
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Control groups not supported on this platform\""
          ],
          "line": 3453
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetDomainTotalCpuStats(virCgroupPtr group G_GNUC_UNUSED,\n                                virTypedParameterPtr params G_GNUC_UNUSED,\n                                int nparams G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
  },
  {
    "function_name": "virCgroupGetCpuacctStat",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "3436-3444",
    "snippet": "int\nvirCgroupGetCpuacctStat(virCgroupPtr group G_GNUC_UNUSED,\n                        unsigned long long *user G_GNUC_UNUSED,\n                        unsigned long long *sys G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "\"%s\"",
            "_(\"Control groups not supported on this platform\")"
          ],
          "line": 3441
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Control groups not supported on this platform\""
          ],
          "line": 3442
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetCpuacctStat(virCgroupPtr group G_GNUC_UNUSED,\n                        unsigned long long *user G_GNUC_UNUSED,\n                        unsigned long long *sys G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
  },
  {
    "function_name": "virCgroupGetCpuacctPercpuUsage",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "3426-3433",
    "snippet": "int\nvirCgroupGetCpuacctPercpuUsage(virCgroupPtr group G_GNUC_UNUSED,\n                               char **usage G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "\"%s\"",
            "_(\"Control groups not supported on this platform\")"
          ],
          "line": 3430
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Control groups not supported on this platform\""
          ],
          "line": 3431
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetCpuacctPercpuUsage(virCgroupPtr group G_GNUC_UNUSED,\n                               char **usage G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
  },
  {
    "function_name": "virCgroupGetCpuacctUsage",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "3416-3423",
    "snippet": "int\nvirCgroupGetCpuacctUsage(virCgroupPtr group G_GNUC_UNUSED,\n                         unsigned long long *usage G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "\"%s\"",
            "_(\"Control groups not supported on this platform\")"
          ],
          "line": 3420
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Control groups not supported on this platform\""
          ],
          "line": 3421
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetCpuacctUsage(virCgroupPtr group G_GNUC_UNUSED,\n                         unsigned long long *usage G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
  },
  {
    "function_name": "virCgroupGetCpuCfsQuota",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "3406-3413",
    "snippet": "int\nvirCgroupGetCpuCfsQuota(virCgroupPtr group G_GNUC_UNUSED,\n                        long long *cfs_quota G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "\"%s\"",
            "_(\"Control groups not supported on this platform\")"
          ],
          "line": 3410
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Control groups not supported on this platform\""
          ],
          "line": 3411
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetCpuCfsQuota(virCgroupPtr group G_GNUC_UNUSED,\n                        long long *cfs_quota G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
  },
  {
    "function_name": "virCgroupKillPainfully",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "3397-3403",
    "snippet": "int\nvirCgroupKillPainfully(virCgroupPtr group G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "\"%s\"",
            "_(\"Control groups not supported on this platform\")"
          ],
          "line": 3400
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Control groups not supported on this platform\""
          ],
          "line": 3401
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupKillPainfully(virCgroupPtr group G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
  },
  {
    "function_name": "virCgroupKillRecursive",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "3387-3394",
    "snippet": "int\nvirCgroupKillRecursive(virCgroupPtr group G_GNUC_UNUSED,\n                       int signum G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "\"%s\"",
            "_(\"Control groups not supported on this platform\")"
          ],
          "line": 3391
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Control groups not supported on this platform\""
          ],
          "line": 3392
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupKillRecursive(virCgroupPtr group G_GNUC_UNUSED,\n                       int signum G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
  },
  {
    "function_name": "virCgroupRemove",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "3378-3384",
    "snippet": "int\nvirCgroupRemove(virCgroupPtr group G_GNUC_UNUSED)\n{\n    virReportSystemError(ENXIO, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENXIO",
            "\"%s\"",
            "_(\"Control groups not supported on this platform\")"
          ],
          "line": 3381
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Control groups not supported on this platform\""
          ],
          "line": 3382
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupRemove(virCgroupPtr group G_GNUC_UNUSED)\n{\n    virReportSystemError(ENXIO, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
  },
  {
    "function_name": "virCgroupSetCpuCfsQuota",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "3368-3375",
    "snippet": "int\nvirCgroupSetCpuCfsQuota(virCgroupPtr group G_GNUC_UNUSED,\n                        long long cfs_quota G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "\"%s\"",
            "_(\"Control groups not supported on this platform\")"
          ],
          "line": 3372
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Control groups not supported on this platform\""
          ],
          "line": 3373
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupSetCpuCfsQuota(virCgroupPtr group G_GNUC_UNUSED,\n                        long long cfs_quota G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
  },
  {
    "function_name": "virCgroupGetCpuCfsPeriod",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "3358-3365",
    "snippet": "int\nvirCgroupGetCpuCfsPeriod(virCgroupPtr group G_GNUC_UNUSED,\n                         unsigned long long *cfs_period G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "\"%s\"",
            "_(\"Control groups not supported on this platform\")"
          ],
          "line": 3362
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Control groups not supported on this platform\""
          ],
          "line": 3363
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetCpuCfsPeriod(virCgroupPtr group G_GNUC_UNUSED,\n                         unsigned long long *cfs_period G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
  },
  {
    "function_name": "virCgroupSetCpuCfsPeriod",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "3348-3355",
    "snippet": "int\nvirCgroupSetCpuCfsPeriod(virCgroupPtr group G_GNUC_UNUSED,\n                         unsigned long long cfs_period G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "\"%s\"",
            "_(\"Control groups not supported on this platform\")"
          ],
          "line": 3352
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Control groups not supported on this platform\""
          ],
          "line": 3353
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupSetCpuCfsPeriod(virCgroupPtr group G_GNUC_UNUSED,\n                         unsigned long long cfs_period G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
  },
  {
    "function_name": "virCgroupGetCpuShares",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "3338-3345",
    "snippet": "int\nvirCgroupGetCpuShares(virCgroupPtr group G_GNUC_UNUSED,\n                      unsigned long long *shares G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "\"%s\"",
            "_(\"Control groups not supported on this platform\")"
          ],
          "line": 3342
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Control groups not supported on this platform\""
          ],
          "line": 3343
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetCpuShares(virCgroupPtr group G_GNUC_UNUSED,\n                      unsigned long long *shares G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
  },
  {
    "function_name": "virCgroupSetCpuShares",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "3328-3335",
    "snippet": "int\nvirCgroupSetCpuShares(virCgroupPtr group G_GNUC_UNUSED,\n                      unsigned long long shares G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "\"%s\"",
            "_(\"Control groups not supported on this platform\")"
          ],
          "line": 3332
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Control groups not supported on this platform\""
          ],
          "line": 3333
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupSetCpuShares(virCgroupPtr group G_GNUC_UNUSED,\n                      unsigned long long shares G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
  },
  {
    "function_name": "virCgroupDenyDevicePath",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "3316-3325",
    "snippet": "int\nvirCgroupDenyDevicePath(virCgroupPtr group G_GNUC_UNUSED,\n                        const char *path G_GNUC_UNUSED,\n                        int perms G_GNUC_UNUSED,\n                        bool ignoreEacces G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "\"%s\"",
            "_(\"Control groups not supported on this platform\")"
          ],
          "line": 3322
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Control groups not supported on this platform\""
          ],
          "line": 3323
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupDenyDevicePath(virCgroupPtr group G_GNUC_UNUSED,\n                        const char *path G_GNUC_UNUSED,\n                        int perms G_GNUC_UNUSED,\n                        bool ignoreEacces G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
  },
  {
    "function_name": "virCgroupDenyDevice",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "3303-3313",
    "snippet": "int\nvirCgroupDenyDevice(virCgroupPtr group G_GNUC_UNUSED,\n                    char type G_GNUC_UNUSED,\n                    int major G_GNUC_UNUSED,\n                    int minor G_GNUC_UNUSED,\n                    int perms G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "\"%s\"",
            "_(\"Control groups not supported on this platform\")"
          ],
          "line": 3310
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Control groups not supported on this platform\""
          ],
          "line": 3311
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupDenyDevice(virCgroupPtr group G_GNUC_UNUSED,\n                    char type G_GNUC_UNUSED,\n                    int major G_GNUC_UNUSED,\n                    int minor G_GNUC_UNUSED,\n                    int perms G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
  },
  {
    "function_name": "virCgroupAllowDevicePath",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "3291-3300",
    "snippet": "int\nvirCgroupAllowDevicePath(virCgroupPtr group G_GNUC_UNUSED,\n                         const char *path G_GNUC_UNUSED,\n                         int perms G_GNUC_UNUSED,\n                         bool ignoreEaccess G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "\"%s\"",
            "_(\"Control groups not supported on this platform\")"
          ],
          "line": 3297
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Control groups not supported on this platform\""
          ],
          "line": 3298
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupAllowDevicePath(virCgroupPtr group G_GNUC_UNUSED,\n                         const char *path G_GNUC_UNUSED,\n                         int perms G_GNUC_UNUSED,\n                         bool ignoreEaccess G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
  },
  {
    "function_name": "virCgroupAllowDevice",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "3278-3288",
    "snippet": "int\nvirCgroupAllowDevice(virCgroupPtr group G_GNUC_UNUSED,\n                     char type G_GNUC_UNUSED,\n                     int major G_GNUC_UNUSED,\n                     int minor G_GNUC_UNUSED,\n                     int perms G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "\"%s\"",
            "_(\"Control groups not supported on this platform\")"
          ],
          "line": 3285
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Control groups not supported on this platform\""
          ],
          "line": 3286
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupAllowDevice(virCgroupPtr group G_GNUC_UNUSED,\n                     char type G_GNUC_UNUSED,\n                     int major G_GNUC_UNUSED,\n                     int minor G_GNUC_UNUSED,\n                     int perms G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
  },
  {
    "function_name": "virCgroupDenyAllDevices",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "3269-3275",
    "snippet": "int\nvirCgroupDenyAllDevices(virCgroupPtr group G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "\"%s\"",
            "_(\"Control groups not supported on this platform\")"
          ],
          "line": 3272
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Control groups not supported on this platform\""
          ],
          "line": 3273
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupDenyAllDevices(virCgroupPtr group G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
  },
  {
    "function_name": "virCgroupAllowAllDevices",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "3260-3267",
    "snippet": "int\nvirCgroupAllowAllDevices(virCgroupPtr group G_GNUC_UNUSED,\n                         int perms G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "\"%s\"",
            "_(\"Control groups not supported on this platform\")"
          ],
          "line": 3264
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Control groups not supported on this platform\""
          ],
          "line": 3265
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupAllowAllDevices(virCgroupPtr group G_GNUC_UNUSED,\n                         int perms G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
  },
  {
    "function_name": "virCgroupGetCpusetCpus",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "3251-3258",
    "snippet": "int\nvirCgroupGetCpusetCpus(virCgroupPtr group G_GNUC_UNUSED,\n                       char **cpus G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "\"%s\"",
            "_(\"Control groups not supported on this platform\")"
          ],
          "line": 3255
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Control groups not supported on this platform\""
          ],
          "line": 3256
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetCpusetCpus(virCgroupPtr group G_GNUC_UNUSED,\n                       char **cpus G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
  },
  {
    "function_name": "virCgroupSetCpusetCpus",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "3241-3248",
    "snippet": "int\nvirCgroupSetCpusetCpus(virCgroupPtr group G_GNUC_UNUSED,\n                       const char *cpus G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "\"%s\"",
            "_(\"Control groups not supported on this platform\")"
          ],
          "line": 3245
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Control groups not supported on this platform\""
          ],
          "line": 3246
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupSetCpusetCpus(virCgroupPtr group G_GNUC_UNUSED,\n                       const char *cpus G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
  },
  {
    "function_name": "virCgroupGetCpusetMemoryMigrate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "3231-3238",
    "snippet": "int\nvirCgroupGetCpusetMemoryMigrate(virCgroupPtr group G_GNUC_UNUSED,\n                                bool *migrate G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "\"%s\"",
            "_(\"Control groups not supported on this platform\")"
          ],
          "line": 3235
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Control groups not supported on this platform\""
          ],
          "line": 3236
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetCpusetMemoryMigrate(virCgroupPtr group G_GNUC_UNUSED,\n                                bool *migrate G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
  },
  {
    "function_name": "virCgroupSetCpusetMemoryMigrate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "3221-3228",
    "snippet": "int\nvirCgroupSetCpusetMemoryMigrate(virCgroupPtr group G_GNUC_UNUSED,\n                                bool migrate G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "\"%s\"",
            "_(\"Control groups not supported on this platform\")"
          ],
          "line": 3225
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Control groups not supported on this platform\""
          ],
          "line": 3226
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupSetCpusetMemoryMigrate(virCgroupPtr group G_GNUC_UNUSED,\n                                bool migrate G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
  },
  {
    "function_name": "virCgroupGetCpusetMems",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "3211-3218",
    "snippet": "int\nvirCgroupGetCpusetMems(virCgroupPtr group G_GNUC_UNUSED,\n                       char **mems G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "\"%s\"",
            "_(\"Control groups not supported on this platform\")"
          ],
          "line": 3215
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Control groups not supported on this platform\""
          ],
          "line": 3216
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetCpusetMems(virCgroupPtr group G_GNUC_UNUSED,\n                       char **mems G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
  },
  {
    "function_name": "virCgroupSetCpusetMems",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "3201-3208",
    "snippet": "int\nvirCgroupSetCpusetMems(virCgroupPtr group G_GNUC_UNUSED,\n                       const char *mems G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "\"%s\"",
            "_(\"Control groups not supported on this platform\")"
          ],
          "line": 3205
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Control groups not supported on this platform\""
          ],
          "line": 3206
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupSetCpusetMems(virCgroupPtr group G_GNUC_UNUSED,\n                       const char *mems G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
  },
  {
    "function_name": "virCgroupGetMemSwapUsage",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "3191-3198",
    "snippet": "int\nvirCgroupGetMemSwapUsage(virCgroupPtr group G_GNUC_UNUSED,\n                         unsigned long long *kb G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "\"%s\"",
            "_(\"Control groups not supported on this platform\")"
          ],
          "line": 3195
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Control groups not supported on this platform\""
          ],
          "line": 3196
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetMemSwapUsage(virCgroupPtr group G_GNUC_UNUSED,\n                         unsigned long long *kb G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
  },
  {
    "function_name": "virCgroupGetMemSwapHardLimit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "3181-3188",
    "snippet": "int\nvirCgroupGetMemSwapHardLimit(virCgroupPtr group G_GNUC_UNUSED,\n                             unsigned long long *kb G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "\"%s\"",
            "_(\"Control groups not supported on this platform\")"
          ],
          "line": 3185
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Control groups not supported on this platform\""
          ],
          "line": 3186
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetMemSwapHardLimit(virCgroupPtr group G_GNUC_UNUSED,\n                             unsigned long long *kb G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
  },
  {
    "function_name": "virCgroupSetMemSwapHardLimit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "3171-3178",
    "snippet": "int\nvirCgroupSetMemSwapHardLimit(virCgroupPtr group G_GNUC_UNUSED,\n                             unsigned long long kb G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "\"%s\"",
            "_(\"Control groups not supported on this platform\")"
          ],
          "line": 3175
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Control groups not supported on this platform\""
          ],
          "line": 3176
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupSetMemSwapHardLimit(virCgroupPtr group G_GNUC_UNUSED,\n                             unsigned long long kb G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
  },
  {
    "function_name": "virCgroupGetMemorySoftLimit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "3161-3168",
    "snippet": "int\nvirCgroupGetMemorySoftLimit(virCgroupPtr group G_GNUC_UNUSED,\n                            unsigned long long *kb G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "\"%s\"",
            "_(\"Control groups not supported on this platform\")"
          ],
          "line": 3165
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Control groups not supported on this platform\""
          ],
          "line": 3166
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetMemorySoftLimit(virCgroupPtr group G_GNUC_UNUSED,\n                            unsigned long long *kb G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
  },
  {
    "function_name": "virCgroupSetMemorySoftLimit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "3151-3158",
    "snippet": "int\nvirCgroupSetMemorySoftLimit(virCgroupPtr group G_GNUC_UNUSED,\n                            unsigned long long kb G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "\"%s\"",
            "_(\"Control groups not supported on this platform\")"
          ],
          "line": 3155
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Control groups not supported on this platform\""
          ],
          "line": 3156
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupSetMemorySoftLimit(virCgroupPtr group G_GNUC_UNUSED,\n                            unsigned long long kb G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
  },
  {
    "function_name": "virCgroupGetMemoryHardLimit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "3141-3148",
    "snippet": "int\nvirCgroupGetMemoryHardLimit(virCgroupPtr group G_GNUC_UNUSED,\n                            unsigned long long *kb G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "\"%s\"",
            "_(\"Control groups not supported on this platform\")"
          ],
          "line": 3145
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Control groups not supported on this platform\""
          ],
          "line": 3146
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetMemoryHardLimit(virCgroupPtr group G_GNUC_UNUSED,\n                            unsigned long long *kb G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
  },
  {
    "function_name": "virCgroupSetMemoryHardLimit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "3131-3138",
    "snippet": "int\nvirCgroupSetMemoryHardLimit(virCgroupPtr group G_GNUC_UNUSED,\n                            unsigned long long kb G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "\"%s\"",
            "_(\"Control groups not supported on this platform\")"
          ],
          "line": 3135
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Control groups not supported on this platform\""
          ],
          "line": 3136
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupSetMemoryHardLimit(virCgroupPtr group G_GNUC_UNUSED,\n                            unsigned long long kb G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
  },
  {
    "function_name": "virCgroupGetMemoryUsage",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "3121-3128",
    "snippet": "int\nvirCgroupGetMemoryUsage(virCgroupPtr group G_GNUC_UNUSED,\n                        unsigned long *kb G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "\"%s\"",
            "_(\"Control groups not supported on this platform\")"
          ],
          "line": 3125
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Control groups not supported on this platform\""
          ],
          "line": 3126
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetMemoryUsage(virCgroupPtr group G_GNUC_UNUSED,\n                        unsigned long *kb G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
  },
  {
    "function_name": "virCgroupGetMemoryStat",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "3106-3118",
    "snippet": "int\nvirCgroupGetMemoryStat(virCgroupPtr group G_GNUC_UNUSED,\n                       unsigned long long *cache G_GNUC_UNUSED,\n                       unsigned long long *activeAnon G_GNUC_UNUSED,\n                       unsigned long long *inactiveAnon G_GNUC_UNUSED,\n                       unsigned long long *activeFile G_GNUC_UNUSED,\n                       unsigned long long *inactiveFile G_GNUC_UNUSED,\n                       unsigned long long *unevictable G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "\"%s\"",
            "_(\"Control groups not supported on this platform\")"
          ],
          "line": 3115
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Control groups not supported on this platform\""
          ],
          "line": 3116
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetMemoryStat(virCgroupPtr group G_GNUC_UNUSED,\n                       unsigned long long *cache G_GNUC_UNUSED,\n                       unsigned long long *activeAnon G_GNUC_UNUSED,\n                       unsigned long long *inactiveAnon G_GNUC_UNUSED,\n                       unsigned long long *activeFile G_GNUC_UNUSED,\n                       unsigned long long *inactiveFile G_GNUC_UNUSED,\n                       unsigned long long *unevictable G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
  },
  {
    "function_name": "virCgroupSetMemory",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "3096-3103",
    "snippet": "int\nvirCgroupSetMemory(virCgroupPtr group G_GNUC_UNUSED,\n                   unsigned long long kb G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "\"%s\"",
            "_(\"Control groups not supported on this platform\")"
          ],
          "line": 3100
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Control groups not supported on this platform\""
          ],
          "line": 3101
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupSetMemory(virCgroupPtr group G_GNUC_UNUSED,\n                   unsigned long long kb G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
  },
  {
    "function_name": "virCgroupGetBlkioDeviceWriteBps",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "3086-3094",
    "snippet": "static int\nvirCgroupGetBlkioDeviceWriteBps(virCgroupPtr group G_GNUC_UNUSED,\n                                const char *path G_GNUC_UNUSED,\n                                unsigned long long *wbps G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "\"%s\"",
            "_(\"Control groups not supported on this platform\")"
          ],
          "line": 3091
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Control groups not supported on this platform\""
          ],
          "line": 3092
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nstatic int\nvirCgroupGetBlkioDeviceWriteBps(virCgroupPtr group G_GNUC_UNUSED,\n                                const char *path G_GNUC_UNUSED,\n                                unsigned long long *wbps G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
  },
  {
    "function_name": "virCgroupGetBlkioDeviceReadBps",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "3076-3084",
    "snippet": "static int\nvirCgroupGetBlkioDeviceReadBps(virCgroupPtr group G_GNUC_UNUSED,\n                               const char *path G_GNUC_UNUSED,\n                               unsigned long long *rbps G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "\"%s\"",
            "_(\"Control groups not supported on this platform\")"
          ],
          "line": 3081
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Control groups not supported on this platform\""
          ],
          "line": 3082
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nstatic int\nvirCgroupGetBlkioDeviceReadBps(virCgroupPtr group G_GNUC_UNUSED,\n                               const char *path G_GNUC_UNUSED,\n                               unsigned long long *rbps G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
  },
  {
    "function_name": "virCgroupGetBlkioDeviceWriteIops",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "3066-3074",
    "snippet": "static int\nvirCgroupGetBlkioDeviceWriteIops(virCgroupPtr group G_GNUC_UNUSED,\n                                 const char *path G_GNUC_UNUSED,\n                                 unsigned int *wiops G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "\"%s\"",
            "_(\"Control groups not supported on this platform\")"
          ],
          "line": 3071
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Control groups not supported on this platform\""
          ],
          "line": 3072
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nstatic int\nvirCgroupGetBlkioDeviceWriteIops(virCgroupPtr group G_GNUC_UNUSED,\n                                 const char *path G_GNUC_UNUSED,\n                                 unsigned int *wiops G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
  },
  {
    "function_name": "virCgroupGetBlkioDeviceReadIops",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "3056-3064",
    "snippet": "static int\nvirCgroupGetBlkioDeviceReadIops(virCgroupPtr group G_GNUC_UNUSED,\n                                const char *path G_GNUC_UNUSED,\n                                unsigned int *riops G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "\"%s\"",
            "_(\"Control groups not supported on this platform\")"
          ],
          "line": 3061
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Control groups not supported on this platform\""
          ],
          "line": 3062
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nstatic int\nvirCgroupGetBlkioDeviceReadIops(virCgroupPtr group G_GNUC_UNUSED,\n                                const char *path G_GNUC_UNUSED,\n                                unsigned int *riops G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
  },
  {
    "function_name": "virCgroupGetBlkioDeviceWeight",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "3046-3054",
    "snippet": "static int\nvirCgroupGetBlkioDeviceWeight(virCgroupPtr group G_GNUC_UNUSED,\n                              const char *path G_GNUC_UNUSED,\n                              unsigned int *weight G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "\"%s\"",
            "_(\"Control groups not supported on this platform\")"
          ],
          "line": 3051
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Control groups not supported on this platform\""
          ],
          "line": 3052
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nstatic int\nvirCgroupGetBlkioDeviceWeight(virCgroupPtr group G_GNUC_UNUSED,\n                              const char *path G_GNUC_UNUSED,\n                              unsigned int *weight G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
  },
  {
    "function_name": "virCgroupSetBlkioDeviceWriteBps",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "3036-3044",
    "snippet": "static int\nvirCgroupSetBlkioDeviceWriteBps(virCgroupPtr group G_GNUC_UNUSED,\n                                const char *path G_GNUC_UNUSED,\n                                unsigned long long wbps G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "\"%s\"",
            "_(\"Control groups not supported on this platform\")"
          ],
          "line": 3041
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Control groups not supported on this platform\""
          ],
          "line": 3042
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nstatic int\nvirCgroupSetBlkioDeviceWriteBps(virCgroupPtr group G_GNUC_UNUSED,\n                                const char *path G_GNUC_UNUSED,\n                                unsigned long long wbps G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
  },
  {
    "function_name": "virCgroupSetBlkioDeviceReadBps",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "3026-3034",
    "snippet": "static int\nvirCgroupSetBlkioDeviceReadBps(virCgroupPtr group G_GNUC_UNUSED,\n                               const char *path G_GNUC_UNUSED,\n                               unsigned long long rbps G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "\"%s\"",
            "_(\"Control groups not supported on this platform\")"
          ],
          "line": 3031
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Control groups not supported on this platform\""
          ],
          "line": 3032
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nstatic int\nvirCgroupSetBlkioDeviceReadBps(virCgroupPtr group G_GNUC_UNUSED,\n                               const char *path G_GNUC_UNUSED,\n                               unsigned long long rbps G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
  },
  {
    "function_name": "virCgroupSetBlkioDeviceWriteIops",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "3016-3024",
    "snippet": "static int\nvirCgroupSetBlkioDeviceWriteIops(virCgroupPtr group G_GNUC_UNUSED,\n                                 const char *path G_GNUC_UNUSED,\n                                 unsigned int wiops G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "\"%s\"",
            "_(\"Control groups not supported on this platform\")"
          ],
          "line": 3021
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Control groups not supported on this platform\""
          ],
          "line": 3022
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nstatic int\nvirCgroupSetBlkioDeviceWriteIops(virCgroupPtr group G_GNUC_UNUSED,\n                                 const char *path G_GNUC_UNUSED,\n                                 unsigned int wiops G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
  },
  {
    "function_name": "virCgroupSetBlkioDeviceReadIops",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "3006-3014",
    "snippet": "static int\nvirCgroupSetBlkioDeviceReadIops(virCgroupPtr group G_GNUC_UNUSED,\n                                const char *path G_GNUC_UNUSED,\n                                unsigned int riops G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "\"%s\"",
            "_(\"Control groups not supported on this platform\")"
          ],
          "line": 3011
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Control groups not supported on this platform\""
          ],
          "line": 3012
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nstatic int\nvirCgroupSetBlkioDeviceReadIops(virCgroupPtr group G_GNUC_UNUSED,\n                                const char *path G_GNUC_UNUSED,\n                                unsigned int riops G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
  },
  {
    "function_name": "virCgroupSetBlkioDeviceWeight",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "2996-3004",
    "snippet": "static int\nvirCgroupSetBlkioDeviceWeight(virCgroupPtr group G_GNUC_UNUSED,\n                              const char *path G_GNUC_UNUSED,\n                              unsigned int weight G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "\"%s\"",
            "_(\"Control groups not supported on this platform\")"
          ],
          "line": 3001
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Control groups not supported on this platform\""
          ],
          "line": 3002
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nstatic int\nvirCgroupSetBlkioDeviceWeight(virCgroupPtr group G_GNUC_UNUSED,\n                              const char *path G_GNUC_UNUSED,\n                              unsigned int weight G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
  },
  {
    "function_name": "virCgroupGetBlkioWeight",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "2986-2993",
    "snippet": "int\nvirCgroupGetBlkioWeight(virCgroupPtr group G_GNUC_UNUSED,\n                        unsigned int *weight G_GNUC_UNUSED)\n{\n    virReportSystemError(ENXIO, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENXIO",
            "\"%s\"",
            "_(\"Control groups not supported on this platform\")"
          ],
          "line": 2990
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Control groups not supported on this platform\""
          ],
          "line": 2991
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetBlkioWeight(virCgroupPtr group G_GNUC_UNUSED,\n                        unsigned int *weight G_GNUC_UNUSED)\n{\n    virReportSystemError(ENXIO, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
  },
  {
    "function_name": "virCgroupSetBlkioWeight",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "2976-2983",
    "snippet": "int\nvirCgroupSetBlkioWeight(virCgroupPtr group G_GNUC_UNUSED,\n                        unsigned int weight G_GNUC_UNUSED)\n{\n    virReportSystemError(ENXIO, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENXIO",
            "\"%s\"",
            "_(\"Control groups not supported on this platform\")"
          ],
          "line": 2980
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Control groups not supported on this platform\""
          ],
          "line": 2981
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupSetBlkioWeight(virCgroupPtr group G_GNUC_UNUSED,\n                        unsigned int weight G_GNUC_UNUSED)\n{\n    virReportSystemError(ENXIO, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
  },
  {
    "function_name": "virCgroupGetBlkioIoDeviceServiced",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "2962-2973",
    "snippet": "int\nvirCgroupGetBlkioIoDeviceServiced(virCgroupPtr group G_GNUC_UNUSED,\n                                  const char *path G_GNUC_UNUSED,\n                                  long long *bytes_read G_GNUC_UNUSED,\n                                  long long *bytes_write G_GNUC_UNUSED,\n                                  long long *requests_read G_GNUC_UNUSED,\n                                  long long *requests_write G_GNUC_UNUSED)\n{\n    virReportSystemError(ENXIO, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENXIO",
            "\"%s\"",
            "_(\"Control groups not supported on this platform\")"
          ],
          "line": 2970
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Control groups not supported on this platform\""
          ],
          "line": 2971
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetBlkioIoDeviceServiced(virCgroupPtr group G_GNUC_UNUSED,\n                                  const char *path G_GNUC_UNUSED,\n                                  long long *bytes_read G_GNUC_UNUSED,\n                                  long long *bytes_write G_GNUC_UNUSED,\n                                  long long *requests_read G_GNUC_UNUSED,\n                                  long long *requests_write G_GNUC_UNUSED)\n{\n    virReportSystemError(ENXIO, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
  },
  {
    "function_name": "virCgroupGetBlkioIoServiced",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "2949-2959",
    "snippet": "int\nvirCgroupGetBlkioIoServiced(virCgroupPtr group G_GNUC_UNUSED,\n                            long long *bytes_read G_GNUC_UNUSED,\n                            long long *bytes_write G_GNUC_UNUSED,\n                            long long *requests_read G_GNUC_UNUSED,\n                            long long *requests_write G_GNUC_UNUSED)\n{\n    virReportSystemError(ENXIO, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENXIO",
            "\"%s\"",
            "_(\"Control groups not supported on this platform\")"
          ],
          "line": 2956
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Control groups not supported on this platform\""
          ],
          "line": 2957
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetBlkioIoServiced(virCgroupPtr group G_GNUC_UNUSED,\n                            long long *bytes_read G_GNUC_UNUSED,\n                            long long *bytes_write G_GNUC_UNUSED,\n                            long long *requests_read G_GNUC_UNUSED,\n                            long long *requests_write G_GNUC_UNUSED)\n{\n    virReportSystemError(ENXIO, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
  },
  {
    "function_name": "virCgroupAddThread",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "2939-2946",
    "snippet": "int\nvirCgroupAddThread(virCgroupPtr group G_GNUC_UNUSED,\n                   pid_t pid G_GNUC_UNUSED)\n{\n    virReportSystemError(ENXIO, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENXIO",
            "\"%s\"",
            "_(\"Control groups not supported on this platform\")"
          ],
          "line": 2943
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Control groups not supported on this platform\""
          ],
          "line": 2944
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupAddThread(virCgroupPtr group G_GNUC_UNUSED,\n                   pid_t pid G_GNUC_UNUSED)\n{\n    virReportSystemError(ENXIO, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
  },
  {
    "function_name": "virCgroupAddMachineProcess",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "2929-2936",
    "snippet": "int\nvirCgroupAddMachineProcess(virCgroupPtr group G_GNUC_UNUSED,\n                           pid_t pid G_GNUC_UNUSED)\n{\n    virReportSystemError(ENXIO, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENXIO",
            "\"%s\"",
            "_(\"Control groups not supported on this platform\")"
          ],
          "line": 2933
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Control groups not supported on this platform\""
          ],
          "line": 2934
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupAddMachineProcess(virCgroupPtr group G_GNUC_UNUSED,\n                           pid_t pid G_GNUC_UNUSED)\n{\n    virReportSystemError(ENXIO, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
  },
  {
    "function_name": "virCgroupAddProcess",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "2919-2926",
    "snippet": "int\nvirCgroupAddProcess(virCgroupPtr group G_GNUC_UNUSED,\n                    pid_t pid G_GNUC_UNUSED)\n{\n    virReportSystemError(ENXIO, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENXIO",
            "\"%s\"",
            "_(\"Control groups not supported on this platform\")"
          ],
          "line": 2923
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Control groups not supported on this platform\""
          ],
          "line": 2924
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupAddProcess(virCgroupPtr group G_GNUC_UNUSED,\n                    pid_t pid G_GNUC_UNUSED)\n{\n    virReportSystemError(ENXIO, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
  },
  {
    "function_name": "virCgroupPathOfController",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "2907-2916",
    "snippet": "int\nvirCgroupPathOfController(virCgroupPtr group G_GNUC_UNUSED,\n                          unsigned int controller G_GNUC_UNUSED,\n                          const char *key G_GNUC_UNUSED,\n                          char **path G_GNUC_UNUSED)\n{\n    virReportSystemError(ENXIO, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENXIO",
            "\"%s\"",
            "_(\"Control groups not supported on this platform\")"
          ],
          "line": 2913
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Control groups not supported on this platform\""
          ],
          "line": 2914
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupPathOfController(virCgroupPtr group G_GNUC_UNUSED,\n                          unsigned int controller G_GNUC_UNUSED,\n                          const char *key G_GNUC_UNUSED,\n                          char **path G_GNUC_UNUSED)\n{\n    virReportSystemError(ENXIO, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
  },
  {
    "function_name": "virCgroupHasController",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "2899-2904",
    "snippet": "bool\nvirCgroupHasController(virCgroupPtr cgroup G_GNUC_UNUSED,\n                       int controller G_GNUC_UNUSED)\n{\n    return false;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nbool\nvirCgroupHasController(virCgroupPtr cgroup G_GNUC_UNUSED,\n                       int controller G_GNUC_UNUSED)\n{\n    return false;\n}"
  },
  {
    "function_name": "virCgroupNewIgnoreError",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "2891-2896",
    "snippet": "bool\nvirCgroupNewIgnoreError(void)\n{\n    VIR_DEBUG(\"No cgroups present/configured/accessible, ignoring error\");\n    return true;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"No cgroups present/configured/accessible, ignoring error\""
          ],
          "line": 2894
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nbool\nvirCgroupNewIgnoreError(void)\n{\n    VIR_DEBUG(\"No cgroups present/configured/accessible, ignoring error\");\n    return true;\n}"
  },
  {
    "function_name": "virCgroupNewMachine",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "2871-2888",
    "snippet": "int\nvirCgroupNewMachine(const char *name G_GNUC_UNUSED,\n                    const char *drivername G_GNUC_UNUSED,\n                    const unsigned char *uuid G_GNUC_UNUSED,\n                    const char *rootdir G_GNUC_UNUSED,\n                    pid_t pidleader G_GNUC_UNUSED,\n                    bool isContainer G_GNUC_UNUSED,\n                    size_t nnicindexes G_GNUC_UNUSED,\n                    int *nicindexes G_GNUC_UNUSED,\n                    const char *partition G_GNUC_UNUSED,\n                    int controllers G_GNUC_UNUSED,\n                    unsigned int maxthreads G_GNUC_UNUSED,\n                    virCgroupPtr *group G_GNUC_UNUSED)\n{\n    virReportSystemError(ENXIO, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENXIO",
            "\"%s\"",
            "_(\"Control groups not supported on this platform\")"
          ],
          "line": 2885
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Control groups not supported on this platform\""
          ],
          "line": 2886
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupNewMachine(const char *name G_GNUC_UNUSED,\n                    const char *drivername G_GNUC_UNUSED,\n                    const unsigned char *uuid G_GNUC_UNUSED,\n                    const char *rootdir G_GNUC_UNUSED,\n                    pid_t pidleader G_GNUC_UNUSED,\n                    bool isContainer G_GNUC_UNUSED,\n                    size_t nnicindexes G_GNUC_UNUSED,\n                    int *nicindexes G_GNUC_UNUSED,\n                    const char *partition G_GNUC_UNUSED,\n                    int controllers G_GNUC_UNUSED,\n                    unsigned int maxthreads G_GNUC_UNUSED,\n                    virCgroupPtr *group G_GNUC_UNUSED)\n{\n    virReportSystemError(ENXIO, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
  },
  {
    "function_name": "virCgroupTerminateMachine",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "2863-2868",
    "snippet": "int virCgroupTerminateMachine(const char *name G_GNUC_UNUSED)\n{\n    virReportSystemError(ENXIO, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENXIO",
            "\"%s\"",
            "_(\"Control groups not supported on this platform\")"
          ],
          "line": 2865
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Control groups not supported on this platform\""
          ],
          "line": 2866
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint virCgroupTerminateMachine(const char *name G_GNUC_UNUSED)\n{\n    virReportSystemError(ENXIO, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
  },
  {
    "function_name": "virCgroupNewDetectMachine",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "2849-2860",
    "snippet": "int\nvirCgroupNewDetectMachine(const char *name G_GNUC_UNUSED,\n                          const char *drivername G_GNUC_UNUSED,\n                          pid_t pid G_GNUC_UNUSED,\n                          int controllers G_GNUC_UNUSED,\n                          char *machinename G_GNUC_UNUSED,\n                          virCgroupPtr *group G_GNUC_UNUSED)\n{\n    virReportSystemError(ENXIO, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENXIO",
            "\"%s\"",
            "_(\"Control groups not supported on this platform\")"
          ],
          "line": 2857
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Control groups not supported on this platform\""
          ],
          "line": 2858
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupNewDetectMachine(const char *name G_GNUC_UNUSED,\n                          const char *drivername G_GNUC_UNUSED,\n                          pid_t pid G_GNUC_UNUSED,\n                          int controllers G_GNUC_UNUSED,\n                          char *machinename G_GNUC_UNUSED,\n                          virCgroupPtr *group G_GNUC_UNUSED)\n{\n    virReportSystemError(ENXIO, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
  },
  {
    "function_name": "virCgroupNewDetect",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "2838-2846",
    "snippet": "int\nvirCgroupNewDetect(pid_t pid G_GNUC_UNUSED,\n                   int controllers G_GNUC_UNUSED,\n                   virCgroupPtr *group G_GNUC_UNUSED)\n{\n    virReportSystemError(ENXIO, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENXIO",
            "\"%s\"",
            "_(\"Control groups not supported on this platform\")"
          ],
          "line": 2843
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Control groups not supported on this platform\""
          ],
          "line": 2844
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupNewDetect(pid_t pid G_GNUC_UNUSED,\n                   int controllers G_GNUC_UNUSED,\n                   virCgroupPtr *group G_GNUC_UNUSED)\n{\n    virReportSystemError(ENXIO, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
  },
  {
    "function_name": "virCgroupNewThread",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "2825-2835",
    "snippet": "int\nvirCgroupNewThread(virCgroupPtr domain G_GNUC_UNUSED,\n                   virCgroupThreadName nameval G_GNUC_UNUSED,\n                   int id G_GNUC_UNUSED,\n                   bool create G_GNUC_UNUSED,\n                   virCgroupPtr *group G_GNUC_UNUSED)\n{\n    virReportSystemError(ENXIO, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENXIO",
            "\"%s\"",
            "_(\"Control groups not supported on this platform\")"
          ],
          "line": 2832
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Control groups not supported on this platform\""
          ],
          "line": 2833
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupNewThread(virCgroupPtr domain G_GNUC_UNUSED,\n                   virCgroupThreadName nameval G_GNUC_UNUSED,\n                   int id G_GNUC_UNUSED,\n                   bool create G_GNUC_UNUSED,\n                   virCgroupPtr *group G_GNUC_UNUSED)\n{\n    virReportSystemError(ENXIO, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
  },
  {
    "function_name": "virCgroupNewDomainPartition",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "2812-2822",
    "snippet": "int\nvirCgroupNewDomainPartition(virCgroupPtr partition G_GNUC_UNUSED,\n                            const char *driver G_GNUC_UNUSED,\n                            const char *name G_GNUC_UNUSED,\n                            bool create G_GNUC_UNUSED,\n                            virCgroupPtr *group G_GNUC_UNUSED)\n{\n    virReportSystemError(ENXIO, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENXIO",
            "\"%s\"",
            "_(\"Control groups not supported on this platform\")"
          ],
          "line": 2819
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Control groups not supported on this platform\""
          ],
          "line": 2820
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupNewDomainPartition(virCgroupPtr partition G_GNUC_UNUSED,\n                            const char *driver G_GNUC_UNUSED,\n                            const char *name G_GNUC_UNUSED,\n                            bool create G_GNUC_UNUSED,\n                            virCgroupPtr *group G_GNUC_UNUSED)\n{\n    virReportSystemError(ENXIO, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
  },
  {
    "function_name": "virCgroupNewSelf",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "2803-2809",
    "snippet": "int\nvirCgroupNewSelf(virCgroupPtr *group G_GNUC_UNUSED)\n{\n    virReportSystemError(ENXIO, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENXIO",
            "\"%s\"",
            "_(\"Control groups not supported on this platform\")"
          ],
          "line": 2806
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Control groups not supported on this platform\""
          ],
          "line": 2807
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupNewSelf(virCgroupPtr *group G_GNUC_UNUSED)\n{\n    virReportSystemError(ENXIO, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
  },
  {
    "function_name": "virCgroupNewPartition",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "2791-2800",
    "snippet": "int\nvirCgroupNewPartition(const char *path G_GNUC_UNUSED,\n                      bool create G_GNUC_UNUSED,\n                      int controllers G_GNUC_UNUSED,\n                      virCgroupPtr *group G_GNUC_UNUSED)\n{\n    virReportSystemError(ENXIO, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENXIO",
            "\"%s\"",
            "_(\"Control groups not supported on this platform\")"
          ],
          "line": 2797
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Control groups not supported on this platform\""
          ],
          "line": 2798
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupNewPartition(const char *path G_GNUC_UNUSED,\n                      bool create G_GNUC_UNUSED,\n                      int controllers G_GNUC_UNUSED,\n                      virCgroupPtr *group G_GNUC_UNUSED)\n{\n    virReportSystemError(ENXIO, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
  },
  {
    "function_name": "virCgroupAvailable",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "2784-2788",
    "snippet": "bool\nvirCgroupAvailable(void)\n{\n    return false;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nbool\nvirCgroupAvailable(void)\n{\n    return false;\n}"
  },
  {
    "function_name": "virCgroupControllerAvailable",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "2768-2780",
    "snippet": "bool\nvirCgroupControllerAvailable(int controller)\n{\n    virCgroupPtr cgroup;\n    bool ret = false;\n\n    if (virCgroupNewSelf(&cgroup) < 0)\n        return ret;\n\n    ret = virCgroupHasController(cgroup, controller);\n    virCgroupFree(&cgroup);\n    return ret;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCgroupFree",
          "args": [
            "&cgroup"
          ],
          "line": 2778
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3544-3563",
          "snippet": "void\nvirCgroupFree(virCgroupPtr *group)\n{\n    size_t i;\n\n    if (*group == NULL)\n        return;\n\n    for (i = 0; i < VIR_CGROUP_CONTROLLER_LAST; i++) {\n        VIR_FREE((*group)->legacy[i].mountPoint);\n        VIR_FREE((*group)->legacy[i].linkPoint);\n        VIR_FREE((*group)->legacy[i].placement);\n    }\n\n    VIR_FREE((*group)->unified.mountPoint);\n    VIR_FREE((*group)->unified.placement);\n\n    VIR_FREE((*group)->path);\n    VIR_FREE(*group);\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nvoid\nvirCgroupFree(virCgroupPtr *group)\n{\n    size_t i;\n\n    if (*group == NULL)\n        return;\n\n    for (i = 0; i < VIR_CGROUP_CONTROLLER_LAST; i++) {\n        VIR_FREE((*group)->legacy[i].mountPoint);\n        VIR_FREE((*group)->legacy[i].linkPoint);\n        VIR_FREE((*group)->legacy[i].placement);\n    }\n\n    VIR_FREE((*group)->unified.mountPoint);\n    VIR_FREE((*group)->unified.placement);\n\n    VIR_FREE((*group)->path);\n    VIR_FREE(*group);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupHasController",
          "args": [
            "cgroup",
            "controller"
          ],
          "line": 2777
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupHasController",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "2899-2904",
          "snippet": "bool\nvirCgroupHasController(virCgroupPtr cgroup G_GNUC_UNUSED,\n                       int controller G_GNUC_UNUSED)\n{\n    return false;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nbool\nvirCgroupHasController(virCgroupPtr cgroup G_GNUC_UNUSED,\n                       int controller G_GNUC_UNUSED)\n{\n    return false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupNewSelf",
          "args": [
            "&cgroup"
          ],
          "line": 2774
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupNewSelf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "2803-2809",
          "snippet": "int\nvirCgroupNewSelf(virCgroupPtr *group G_GNUC_UNUSED)\n{\n    virReportSystemError(ENXIO, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupNewSelf(virCgroupPtr *group G_GNUC_UNUSED)\n{\n    virReportSystemError(ENXIO, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nbool\nvirCgroupControllerAvailable(int controller)\n{\n    virCgroupPtr cgroup;\n    bool ret = false;\n\n    if (virCgroupNewSelf(&cgroup) < 0)\n        return ret;\n\n    ret = virCgroupHasController(cgroup, controller);\n    virCgroupFree(&cgroup);\n    return ret;\n}"
  },
  {
    "function_name": "virCgroupHasEmptyTasks",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "2752-2766",
    "snippet": "int\nvirCgroupHasEmptyTasks(virCgroupPtr cgroup, int controller)\n{\n    size_t i;\n\n    for (i = 0; i < VIR_CGROUP_BACKEND_TYPE_LAST; i++) {\n        if (cgroup->backends[i]) {\n            int rc = cgroup->backends[i]->hasEmptyTasks(cgroup, controller);\n            if (rc <= 0)\n                return rc;\n        }\n    }\n\n    return 1;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cgroup->backends[i]->hasEmptyTasks",
          "args": [
            "cgroup",
            "controller"
          ],
          "line": 2759
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupHasEmptyTasks(virCgroupPtr cgroup, int controller)\n{\n    size_t i;\n\n    for (i = 0; i < VIR_CGROUP_BACKEND_TYPE_LAST; i++) {\n        if (cgroup->backends[i]) {\n            int rc = cgroup->backends[i]->hasEmptyTasks(cgroup, controller);\n            if (rc <= 0)\n                return rc;\n        }\n    }\n\n    return 1;\n}"
  },
  {
    "function_name": "virCgroupSupportsCpuBW",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "2745-2750",
    "snippet": "bool\nvirCgroupSupportsCpuBW(virCgroupPtr cgroup)\n{\n    VIR_CGROUP_BACKEND_CALL(cgroup, VIR_CGROUP_CONTROLLER_CPU,\n                            supportsCpuBW, false);\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_CGROUP_BACKEND_CALL",
          "args": [
            "cgroup",
            "VIR_CGROUP_CONTROLLER_CPU",
            "supportsCpuBW",
            "false"
          ],
          "line": 2748
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nbool\nvirCgroupSupportsCpuBW(virCgroupPtr cgroup)\n{\n    VIR_CGROUP_BACKEND_CALL(cgroup, VIR_CGROUP_CONTROLLER_CPU,\n                            supportsCpuBW, false);\n}"
  },
  {
    "function_name": "virCgroupSetOwner",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "2720-2735",
    "snippet": "int virCgroupSetOwner(virCgroupPtr cgroup,\n                      uid_t uid,\n                      gid_t gid,\n                      int controllers)\n{\n    size_t i;\n\n    for (i = 0; i < VIR_CGROUP_BACKEND_TYPE_LAST; i++) {\n        if (cgroup->backends[i] &&\n            cgroup->backends[i]->setOwner(cgroup, uid, gid, controllers) < 0) {\n            return -1;\n        }\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cgroup->backends[i]->setOwner",
          "args": [
            "cgroup",
            "uid",
            "gid",
            "controllers"
          ],
          "line": 2729
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint virCgroupSetOwner(virCgroupPtr cgroup,\n                      uid_t uid,\n                      gid_t gid,\n                      int controllers)\n{\n    size_t i;\n\n    for (i = 0; i < VIR_CGROUP_BACKEND_TYPE_LAST; i++) {\n        if (cgroup->backends[i] &&\n            cgroup->backends[i]->setOwner(cgroup, uid, gid, controllers) < 0) {\n            return -1;\n        }\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virCgroupBindMount",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "2703-2717",
    "snippet": "int\nvirCgroupBindMount(virCgroupPtr group, const char *oldroot,\n                   const char *mountopts)\n{\n    size_t i;\n\n    for (i = 0; i < VIR_CGROUP_BACKEND_TYPE_LAST; i++) {\n        if (group->backends[i] &&\n            group->backends[i]->bindMount(group, oldroot, mountopts) < 0) {\n            return -1;\n        }\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "group->backends[i]->bindMount",
          "args": [
            "group",
            "oldroot",
            "mountopts"
          ],
          "line": 2711
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupBindMount(virCgroupPtr group, const char *oldroot,\n                   const char *mountopts)\n{\n    size_t i;\n\n    for (i = 0; i < VIR_CGROUP_BACKEND_TYPE_LAST; i++) {\n        if (group->backends[i] &&\n            group->backends[i]->bindMount(group, oldroot, mountopts) < 0) {\n            return -1;\n        }\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virCgroupGetFreezerState",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "2695-2700",
    "snippet": "int\nvirCgroupGetFreezerState(virCgroupPtr group, char **state)\n{\n    VIR_CGROUP_BACKEND_CALL(group, VIR_CGROUP_CONTROLLER_FREEZER,\n                            getFreezerState, -1, state);\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_CGROUP_BACKEND_CALL",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_FREEZER",
            "getFreezerState",
            "-1",
            "state"
          ],
          "line": 2698
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetFreezerState(virCgroupPtr group, char **state)\n{\n    VIR_CGROUP_BACKEND_CALL(group, VIR_CGROUP_CONTROLLER_FREEZER,\n                            getFreezerState, -1, state);\n}"
  },
  {
    "function_name": "virCgroupSetFreezerState",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "2687-2692",
    "snippet": "int\nvirCgroupSetFreezerState(virCgroupPtr group, const char *state)\n{\n    VIR_CGROUP_BACKEND_CALL(group, VIR_CGROUP_CONTROLLER_FREEZER,\n                            setFreezerState, -1, state);\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_CGROUP_BACKEND_CALL",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_FREEZER",
            "setFreezerState",
            "-1",
            "state"
          ],
          "line": 2690
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupSetFreezerState(virCgroupPtr group, const char *state)\n{\n    VIR_CGROUP_BACKEND_CALL(group, VIR_CGROUP_CONTROLLER_FREEZER,\n                            setFreezerState, -1, state);\n}"
  },
  {
    "function_name": "virCgroupGetCpuacctStat",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "2678-2684",
    "snippet": "int\nvirCgroupGetCpuacctStat(virCgroupPtr group, unsigned long long *user,\n                        unsigned long long *sys)\n{\n    VIR_CGROUP_BACKEND_CALL(group, VIR_CGROUP_CONTROLLER_CPUACCT,\n                            getCpuacctStat, -1, user, sys);\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_CGROUP_BACKEND_CALL",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_CPUACCT",
            "getCpuacctStat",
            "-1",
            "user",
            "sys"
          ],
          "line": 2682
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetCpuacctStat(virCgroupPtr group, unsigned long long *user,\n                        unsigned long long *sys)\n{\n    VIR_CGROUP_BACKEND_CALL(group, VIR_CGROUP_CONTROLLER_CPUACCT,\n                            getCpuacctStat, -1, user, sys);\n}"
  },
  {
    "function_name": "virCgroupGetCpuacctUsage",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "2670-2675",
    "snippet": "int\nvirCgroupGetCpuacctUsage(virCgroupPtr group, unsigned long long *usage)\n{\n    VIR_CGROUP_BACKEND_CALL(group, VIR_CGROUP_CONTROLLER_CPUACCT,\n                            getCpuacctUsage, -1, usage);\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_CGROUP_BACKEND_CALL",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_CPUACCT",
            "getCpuacctUsage",
            "-1",
            "usage"
          ],
          "line": 2673
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetCpuacctUsage(virCgroupPtr group, unsigned long long *usage)\n{\n    VIR_CGROUP_BACKEND_CALL(group, VIR_CGROUP_CONTROLLER_CPUACCT,\n                            getCpuacctUsage, -1, usage);\n}"
  },
  {
    "function_name": "virCgroupGetCpuCfsQuota",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "2662-2667",
    "snippet": "int\nvirCgroupGetCpuCfsQuota(virCgroupPtr group, long long *cfs_quota)\n{\n    VIR_CGROUP_BACKEND_CALL(group, VIR_CGROUP_CONTROLLER_CPU,\n                            getCpuCfsQuota, -1, cfs_quota);\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_CGROUP_BACKEND_CALL",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_CPU",
            "getCpuCfsQuota",
            "-1",
            "cfs_quota"
          ],
          "line": 2665
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetCpuCfsQuota(virCgroupPtr group, long long *cfs_quota)\n{\n    VIR_CGROUP_BACKEND_CALL(group, VIR_CGROUP_CONTROLLER_CPU,\n                            getCpuCfsQuota, -1, cfs_quota);\n}"
  },
  {
    "function_name": "virCgroupKillPainfully",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "2625-2650",
    "snippet": "int\nvirCgroupKillPainfully(virCgroupPtr group)\n{\n    size_t i;\n    int ret;\n    VIR_DEBUG(\"cgroup=%p path=%s\", group, group->path);\n    for (i = 0; i < 15; i++) {\n        int signum;\n        if (i == 0)\n            signum = SIGTERM;\n        else if (i == 8)\n            signum = SIGKILL;\n        else\n            signum = 0; /* Just check for existence */\n\n        ret = virCgroupKillRecursive(group, signum);\n        VIR_DEBUG(\"Iteration %zu rc=%d\", i, ret);\n        /* If ret == -1 we hit error, if 0 we ran out of PIDs */\n        if (ret <= 0)\n            break;\n\n        g_usleep(200 * 1000);\n    }\n    VIR_DEBUG(\"Complete %d\", ret);\n    return ret;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Complete %d\"",
            "ret"
          ],
          "line": 2648
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_usleep",
          "args": [
            "200 * 1000"
          ],
          "line": 2646
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Iteration %zu rc=%d\"",
            "i",
            "ret"
          ],
          "line": 2641
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCgroupKillRecursive",
          "args": [
            "group",
            "signum"
          ],
          "line": 2640
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupKillRecursive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3387-3394",
          "snippet": "int\nvirCgroupKillRecursive(virCgroupPtr group G_GNUC_UNUSED,\n                       int signum G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupKillRecursive(virCgroupPtr group G_GNUC_UNUSED,\n                       int signum G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"cgroup=%p path=%s\"",
            "group",
            "group->path"
          ],
          "line": 2630
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupKillPainfully(virCgroupPtr group)\n{\n    size_t i;\n    int ret;\n    VIR_DEBUG(\"cgroup=%p path=%s\", group, group->path);\n    for (i = 0; i < 15; i++) {\n        int signum;\n        if (i == 0)\n            signum = SIGTERM;\n        else if (i == 8)\n            signum = SIGKILL;\n        else\n            signum = 0; /* Just check for existence */\n\n        ret = virCgroupKillRecursive(group, signum);\n        VIR_DEBUG(\"Iteration %zu rc=%d\", i, ret);\n        /* If ret == -1 we hit error, if 0 we ran out of PIDs */\n        if (ret <= 0)\n            break;\n\n        g_usleep(200 * 1000);\n    }\n    VIR_DEBUG(\"Complete %d\", ret);\n    return ret;\n}"
  },
  {
    "function_name": "virCgroupKillRecursive",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "2582-2622",
    "snippet": "int\nvirCgroupKillRecursive(virCgroupPtr group, int signum)\n{\n    int ret = 0;\n    int rc;\n    size_t i;\n    bool backendAvailable = false;\n    virCgroupBackendPtr *backends = virCgroupBackendGetAll();\n    virHashTablePtr pids = virHashCreateFull(100,\n                                             NULL,\n                                             virCgroupPidCode,\n                                             virCgroupPidEqual,\n                                             virCgroupPidCopy,\n                                             virCgroupPidPrintHuman,\n                                             NULL);\n\n    VIR_DEBUG(\"group=%p path=%s signum=%d\", group, group->path, signum);\n\n    for (i = 0; i < VIR_CGROUP_BACKEND_TYPE_LAST; i++) {\n        if (backends && backends[i] && backends[i]->available()) {\n            backendAvailable = true;\n            rc = backends[i]->killRecursive(group, signum, pids);\n            if (rc < 0) {\n                ret = -1;\n                goto cleanup;\n            }\n            if (rc > 0)\n                ret = rc;\n        }\n    }\n\n    if (!backends || !backendAvailable) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"no cgroup backend available\"));\n        goto cleanup;\n    }\n\n cleanup:\n    virHashFree(pids);\n    return ret;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virHashFree",
          "args": [
            "pids"
          ],
          "line": 2620
        },
        "resolved": true,
        "details": {
          "function_name": "virHashFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "313-337",
          "snippet": "void\nvirHashFree(virHashTablePtr table)\n{\n    size_t i;\n\n    if (table == NULL)\n        return;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr iter = table->table[i];\n        while (iter) {\n            virHashEntryPtr next = iter->next;\n\n            if (table->dataFree)\n                table->dataFree(iter->payload);\n            if (table->keyFree)\n                table->keyFree(iter->name);\n            VIR_FREE(iter);\n            iter = next;\n        }\n    }\n\n    VIR_FREE(table->table);\n    VIR_FREE(table);\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvoid\nvirHashFree(virHashTablePtr table)\n{\n    size_t i;\n\n    if (table == NULL)\n        return;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr iter = table->table[i];\n        while (iter) {\n            virHashEntryPtr next = iter->next;\n\n            if (table->dataFree)\n                table->dataFree(iter->payload);\n            if (table->keyFree)\n                table->keyFree(iter->name);\n            VIR_FREE(iter);\n            iter = next;\n        }\n    }\n\n    VIR_FREE(table->table);\n    VIR_FREE(table);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"no cgroup backend available\")"
          ],
          "line": 2614
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"no cgroup backend available\""
          ],
          "line": 2615
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "backends[i]->killRecursive",
          "args": [
            "group",
            "signum",
            "pids"
          ],
          "line": 2603
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "backends[i]->available",
          "args": [],
          "line": 2601
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"group=%p path=%s signum=%d\"",
            "group",
            "group->path",
            "signum"
          ],
          "line": 2598
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virHashCreateFull",
          "args": [
            "100",
            "NULL",
            "virCgroupPidCode",
            "virCgroupPidEqual",
            "virCgroupPidCopy",
            "virCgroupPidPrintHuman",
            "NULL"
          ],
          "line": 2590
        },
        "resolved": true,
        "details": {
          "function_name": "virHashCreateFull",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "141-169",
          "snippet": "virHashTablePtr virHashCreateFull(ssize_t size,\n                                  virHashDataFree dataFree,\n                                  virHashKeyCode keyCode,\n                                  virHashKeyEqual keyEqual,\n                                  virHashKeyCopy keyCopy,\n                                  virHashKeyPrintHuman keyPrint,\n                                  virHashKeyFree keyFree)\n{\n    virHashTablePtr table = NULL;\n\n    if (size <= 0)\n        size = 256;\n\n    table = g_new0(virHashTable, 1);\n\n    table->seed = virRandomBits(32);\n    table->size = size;\n    table->nbElems = 0;\n    table->dataFree = dataFree;\n    table->keyCode = keyCode;\n    table->keyEqual = keyEqual;\n    table->keyCopy = keyCopy;\n    table->keyPrint = keyPrint;\n    table->keyFree = keyFree;\n\n    table->table = g_new0(virHashEntryPtr, table->size);\n\n    return table;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvirHashTablePtr virHashCreateFull(ssize_t size,\n                                  virHashDataFree dataFree,\n                                  virHashKeyCode keyCode,\n                                  virHashKeyEqual keyEqual,\n                                  virHashKeyCopy keyCopy,\n                                  virHashKeyPrintHuman keyPrint,\n                                  virHashKeyFree keyFree)\n{\n    virHashTablePtr table = NULL;\n\n    if (size <= 0)\n        size = 256;\n\n    table = g_new0(virHashTable, 1);\n\n    table->seed = virRandomBits(32);\n    table->size = size;\n    table->nbElems = 0;\n    table->dataFree = dataFree;\n    table->keyCode = keyCode;\n    table->keyEqual = keyEqual;\n    table->keyCopy = keyCopy;\n    table->keyPrint = keyPrint;\n    table->keyFree = keyFree;\n\n    table->table = g_new0(virHashEntryPtr, table->size);\n\n    return table;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupBackendGetAll",
          "args": [],
          "line": 2589
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupBackendGetAll",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupbackend.c",
          "lines": "64-73",
          "snippet": "virCgroupBackendPtr *\nvirCgroupBackendGetAll(void)\n{\n    if (virOnce(&virCgroupBackendOnce, virCgroupBackendOnceInit) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Failed to initialize cgroup backend.\"));\n        return NULL;\n    }\n    return virCgroupBackends;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupv2.h\"",
            "#include \"vircgroupv1.h\"",
            "#include \"vircgrouppriv.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virOnceControl virCgroupBackendOnce = VIR_ONCE_CONTROL_INITIALIZER;",
            "static virCgroupBackendPtr virCgroupBackends[VIR_CGROUP_BACKEND_TYPE_LAST] = { 0 };"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"vircgroupv2.h\"\n#include \"vircgroupv1.h\"\n#include \"vircgrouppriv.h\"\n#include \"vircgroupbackend.h\"\n#include <config.h>\n\nstatic virOnceControl virCgroupBackendOnce = VIR_ONCE_CONTROL_INITIALIZER;\nstatic virCgroupBackendPtr virCgroupBackends[VIR_CGROUP_BACKEND_TYPE_LAST] = { 0 };\n\nvirCgroupBackendPtr *\nvirCgroupBackendGetAll(void)\n{\n    if (virOnce(&virCgroupBackendOnce, virCgroupBackendOnceInit) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Failed to initialize cgroup backend.\"));\n        return NULL;\n    }\n    return virCgroupBackends;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupKillRecursive(virCgroupPtr group, int signum)\n{\n    int ret = 0;\n    int rc;\n    size_t i;\n    bool backendAvailable = false;\n    virCgroupBackendPtr *backends = virCgroupBackendGetAll();\n    virHashTablePtr pids = virHashCreateFull(100,\n                                             NULL,\n                                             virCgroupPidCode,\n                                             virCgroupPidEqual,\n                                             virCgroupPidCopy,\n                                             virCgroupPidPrintHuman,\n                                             NULL);\n\n    VIR_DEBUG(\"group=%p path=%s signum=%d\", group, group->path, signum);\n\n    for (i = 0; i < VIR_CGROUP_BACKEND_TYPE_LAST; i++) {\n        if (backends && backends[i] && backends[i]->available()) {\n            backendAvailable = true;\n            rc = backends[i]->killRecursive(group, signum, pids);\n            if (rc < 0) {\n                ret = -1;\n                goto cleanup;\n            }\n            if (rc > 0)\n                ret = rc;\n        }\n    }\n\n    if (!backends || !backendAvailable) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"no cgroup backend available\"));\n        goto cleanup;\n    }\n\n cleanup:\n    virHashFree(pids);\n    return ret;\n}"
  },
  {
    "function_name": "virCgroupKillRecursiveInternal",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "2510-2579",
    "snippet": "int\nvirCgroupKillRecursiveInternal(virCgroupPtr group,\n                               int signum,\n                               virHashTablePtr pids,\n                               int controller,\n                               const char *taskFile,\n                               bool dormdir)\n{\n    int ret = -1;\n    int rc;\n    bool killedAny = false;\n    g_autofree char *keypath = NULL;\n    DIR *dp = NULL;\n    virCgroupPtr subgroup = NULL;\n    struct dirent *ent;\n    int direrr;\n    VIR_DEBUG(\"group=%p path=%s signum=%d pids=%p\",\n              group, group->path, signum, pids);\n\n    if (virCgroupPathOfController(group, controller, \"\", &keypath) < 0)\n        return -1;\n\n    if ((rc = virCgroupKillInternal(group, signum, pids,\n                                    controller, taskFile)) < 0) {\n        goto cleanup;\n    }\n    if (rc == 1)\n        killedAny = true;\n\n    VIR_DEBUG(\"Iterate over children of %s (killedAny=%d)\", keypath, killedAny);\n    if ((rc = virDirOpenIfExists(&dp, keypath)) < 0)\n        goto cleanup;\n\n    if (rc == 0) {\n        VIR_DEBUG(\"Path %s does not exist, assuming done\", keypath);\n        killedAny = false;\n        goto done;\n    }\n\n    while ((direrr = virDirRead(dp, &ent, keypath)) > 0) {\n        if (ent->d_type != DT_DIR)\n            continue;\n\n        VIR_DEBUG(\"Process subdir %s\", ent->d_name);\n\n        if (virCgroupNew(-1, ent->d_name, group, -1, &subgroup) < 0)\n            goto cleanup;\n\n        if ((rc = virCgroupKillRecursiveInternal(subgroup, signum, pids,\n                                                 controller, taskFile, true)) < 0)\n            goto cleanup;\n        if (rc == 1)\n            killedAny = true;\n\n        if (dormdir)\n            virCgroupRemove(subgroup);\n\n        virCgroupFree(&subgroup);\n    }\n    if (direrr < 0)\n        goto cleanup;\n\n done:\n    ret = killedAny ? 1 : 0;\n\n cleanup:\n    virCgroupFree(&subgroup);\n    VIR_DIR_CLOSE(dp);\n    return ret;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_DIR_CLOSE",
          "args": [
            "dp"
          ],
          "line": 2577
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCgroupFree",
          "args": [
            "&subgroup"
          ],
          "line": 2576
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3544-3563",
          "snippet": "void\nvirCgroupFree(virCgroupPtr *group)\n{\n    size_t i;\n\n    if (*group == NULL)\n        return;\n\n    for (i = 0; i < VIR_CGROUP_CONTROLLER_LAST; i++) {\n        VIR_FREE((*group)->legacy[i].mountPoint);\n        VIR_FREE((*group)->legacy[i].linkPoint);\n        VIR_FREE((*group)->legacy[i].placement);\n    }\n\n    VIR_FREE((*group)->unified.mountPoint);\n    VIR_FREE((*group)->unified.placement);\n\n    VIR_FREE((*group)->path);\n    VIR_FREE(*group);\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nvoid\nvirCgroupFree(virCgroupPtr *group)\n{\n    size_t i;\n\n    if (*group == NULL)\n        return;\n\n    for (i = 0; i < VIR_CGROUP_CONTROLLER_LAST; i++) {\n        VIR_FREE((*group)->legacy[i].mountPoint);\n        VIR_FREE((*group)->legacy[i].linkPoint);\n        VIR_FREE((*group)->legacy[i].placement);\n    }\n\n    VIR_FREE((*group)->unified.mountPoint);\n    VIR_FREE((*group)->unified.placement);\n\n    VIR_FREE((*group)->path);\n    VIR_FREE(*group);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupRemove",
          "args": [
            "subgroup"
          ],
          "line": 2565
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupRemove",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3378-3384",
          "snippet": "int\nvirCgroupRemove(virCgroupPtr group G_GNUC_UNUSED)\n{\n    virReportSystemError(ENXIO, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupRemove(virCgroupPtr group G_GNUC_UNUSED)\n{\n    virReportSystemError(ENXIO, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupKillRecursiveInternal",
          "args": [
            "subgroup",
            "signum",
            "pids",
            "controller",
            "taskFile",
            "true"
          ],
          "line": 2558
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupKillRecursiveInternal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "2510-2579",
          "snippet": "int\nvirCgroupKillRecursiveInternal(virCgroupPtr group,\n                               int signum,\n                               virHashTablePtr pids,\n                               int controller,\n                               const char *taskFile,\n                               bool dormdir)\n{\n    int ret = -1;\n    int rc;\n    bool killedAny = false;\n    g_autofree char *keypath = NULL;\n    DIR *dp = NULL;\n    virCgroupPtr subgroup = NULL;\n    struct dirent *ent;\n    int direrr;\n    VIR_DEBUG(\"group=%p path=%s signum=%d pids=%p\",\n              group, group->path, signum, pids);\n\n    if (virCgroupPathOfController(group, controller, \"\", &keypath) < 0)\n        return -1;\n\n    if ((rc = virCgroupKillInternal(group, signum, pids,\n                                    controller, taskFile)) < 0) {\n        goto cleanup;\n    }\n    if (rc == 1)\n        killedAny = true;\n\n    VIR_DEBUG(\"Iterate over children of %s (killedAny=%d)\", keypath, killedAny);\n    if ((rc = virDirOpenIfExists(&dp, keypath)) < 0)\n        goto cleanup;\n\n    if (rc == 0) {\n        VIR_DEBUG(\"Path %s does not exist, assuming done\", keypath);\n        killedAny = false;\n        goto done;\n    }\n\n    while ((direrr = virDirRead(dp, &ent, keypath)) > 0) {\n        if (ent->d_type != DT_DIR)\n            continue;\n\n        VIR_DEBUG(\"Process subdir %s\", ent->d_name);\n\n        if (virCgroupNew(-1, ent->d_name, group, -1, &subgroup) < 0)\n            goto cleanup;\n\n        if ((rc = virCgroupKillRecursiveInternal(subgroup, signum, pids,\n                                                 controller, taskFile, true)) < 0)\n            goto cleanup;\n        if (rc == 1)\n            killedAny = true;\n\n        if (dormdir)\n            virCgroupRemove(subgroup);\n\n        virCgroupFree(&subgroup);\n    }\n    if (direrr < 0)\n        goto cleanup;\n\n done:\n    ret = killedAny ? 1 : 0;\n\n cleanup:\n    virCgroupFree(&subgroup);\n    VIR_DIR_CLOSE(dp);\n    return ret;\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupNew",
          "args": [
            "-1",
            "ent->d_name",
            "group",
            "-1",
            "&subgroup"
          ],
          "line": 2555
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupNewThread",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "2825-2835",
          "snippet": "int\nvirCgroupNewThread(virCgroupPtr domain G_GNUC_UNUSED,\n                   virCgroupThreadName nameval G_GNUC_UNUSED,\n                   int id G_GNUC_UNUSED,\n                   bool create G_GNUC_UNUSED,\n                   virCgroupPtr *group G_GNUC_UNUSED)\n{\n    virReportSystemError(ENXIO, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupNewThread(virCgroupPtr domain G_GNUC_UNUSED,\n                   virCgroupThreadName nameval G_GNUC_UNUSED,\n                   int id G_GNUC_UNUSED,\n                   bool create G_GNUC_UNUSED,\n                   virCgroupPtr *group G_GNUC_UNUSED)\n{\n    virReportSystemError(ENXIO, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Process subdir %s\"",
            "ent->d_name"
          ],
          "line": 2553
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDirRead",
          "args": [
            "dp",
            "&ent",
            "keypath"
          ],
          "line": 2549
        },
        "resolved": true,
        "details": {
          "function_name": "virDirRead",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "2940-2954",
          "snippet": "int virDirRead(DIR *dirp, struct dirent **ent, const char *name)\n{\n    do {\n        errno = 0;\n        *ent = readdir(dirp); /* exempt from syntax-check */\n        if (!*ent && errno) {\n            if (name)\n                virReportSystemError(errno, _(\"Unable to read directory '%s'\"),\n                                     name);\n            return -1;\n        }\n    } while (*ent && (STREQ((*ent)->d_name, \".\") ||\n                      STREQ((*ent)->d_name, \"..\")));\n    return !!*ent;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint virDirRead(DIR *dirp, struct dirent **ent, const char *name)\n{\n    do {\n        errno = 0;\n        *ent = readdir(dirp); /* exempt from syntax-check */\n        if (!*ent && errno) {\n            if (name)\n                virReportSystemError(errno, _(\"Unable to read directory '%s'\"),\n                                     name);\n            return -1;\n        }\n    } while (*ent && (STREQ((*ent)->d_name, \".\") ||\n                      STREQ((*ent)->d_name, \"..\")));\n    return !!*ent;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Path %s does not exist, assuming done\"",
            "keypath"
          ],
          "line": 2544
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDirOpenIfExists",
          "args": [
            "&dp",
            "keypath"
          ],
          "line": 2540
        },
        "resolved": true,
        "details": {
          "function_name": "virDirOpenIfExists",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "2898-2902",
          "snippet": "int\nvirDirOpenIfExists(DIR **dirp, const char *name)\n{\n    return virDirOpenInternal(dirp, name, true, false);\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirDirOpenIfExists(DIR **dirp, const char *name)\n{\n    return virDirOpenInternal(dirp, name, true, false);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Iterate over children of %s (killedAny=%d)\"",
            "keypath",
            "killedAny"
          ],
          "line": 2539
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCgroupKillInternal",
          "args": [
            "group",
            "signum",
            "pids",
            "controller",
            "taskFile"
          ],
          "line": 2532
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupKillInternal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "2402-2478",
          "snippet": "static int\nvirCgroupKillInternal(virCgroupPtr group,\n                      int signum,\n                      virHashTablePtr pids,\n                      int controller,\n                      const char *taskFile)\n{\n    int ret = -1;\n    bool killedAny = false;\n    g_autofree char *keypath = NULL;\n    bool done = false;\n    FILE *fp = NULL;\n    VIR_DEBUG(\"group=%p path=%s signum=%d pids=%p\",\n              group, group->path, signum, pids);\n\n    if (virCgroupPathOfController(group, controller, taskFile, &keypath) < 0)\n        return -1;\n\n    /* PIDs may be forking as we kill them, so loop\n     * until there are no new PIDs found\n     */\n    while (!done) {\n        done = true;\n        if (!(fp = fopen(keypath, \"r\"))) {\n            if (errno == ENOENT) {\n                VIR_DEBUG(\"No file %s, assuming done\", keypath);\n                killedAny = false;\n                goto done;\n            }\n\n            virReportSystemError(errno,\n                                 _(\"Failed to read %s\"),\n                                 keypath);\n            goto cleanup;\n        } else {\n            while (!feof(fp)) {\n                long pid_value;\n                if (fscanf(fp, \"%ld\", &pid_value) != 1) {\n                    if (feof(fp))\n                        break;\n                    virReportSystemError(errno,\n                                         _(\"Failed to read %s\"),\n                                         keypath);\n                    goto cleanup;\n                }\n                if (virHashLookup(pids, (void*)pid_value))\n                    continue;\n\n                VIR_DEBUG(\"pid=%ld\", pid_value);\n                /* Cgroups is a Linux concept, so this cast is safe.  */\n                if (kill((pid_t)pid_value, signum) < 0) {\n                    if (errno != ESRCH) {\n                        virReportSystemError(errno,\n                                             _(\"Failed to kill process %ld\"),\n                                             pid_value);\n                        goto cleanup;\n                    }\n                    /* Leave RC == 0 since we didn't kill one */\n                } else {\n                    killedAny = true;\n                    done = false;\n                }\n\n                ignore_value(virHashAddEntry(pids, (void*)pid_value, (void*)1));\n            }\n            VIR_FORCE_FCLOSE(fp);\n        }\n    }\n\n done:\n    ret = killedAny ? 1 : 0;\n\n cleanup:\n    VIR_FORCE_FCLOSE(fp);\n\n    return ret;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nstatic int\nvirCgroupKillInternal(virCgroupPtr group,\n                      int signum,\n                      virHashTablePtr pids,\n                      int controller,\n                      const char *taskFile)\n{\n    int ret = -1;\n    bool killedAny = false;\n    g_autofree char *keypath = NULL;\n    bool done = false;\n    FILE *fp = NULL;\n    VIR_DEBUG(\"group=%p path=%s signum=%d pids=%p\",\n              group, group->path, signum, pids);\n\n    if (virCgroupPathOfController(group, controller, taskFile, &keypath) < 0)\n        return -1;\n\n    /* PIDs may be forking as we kill them, so loop\n     * until there are no new PIDs found\n     */\n    while (!done) {\n        done = true;\n        if (!(fp = fopen(keypath, \"r\"))) {\n            if (errno == ENOENT) {\n                VIR_DEBUG(\"No file %s, assuming done\", keypath);\n                killedAny = false;\n                goto done;\n            }\n\n            virReportSystemError(errno,\n                                 _(\"Failed to read %s\"),\n                                 keypath);\n            goto cleanup;\n        } else {\n            while (!feof(fp)) {\n                long pid_value;\n                if (fscanf(fp, \"%ld\", &pid_value) != 1) {\n                    if (feof(fp))\n                        break;\n                    virReportSystemError(errno,\n                                         _(\"Failed to read %s\"),\n                                         keypath);\n                    goto cleanup;\n                }\n                if (virHashLookup(pids, (void*)pid_value))\n                    continue;\n\n                VIR_DEBUG(\"pid=%ld\", pid_value);\n                /* Cgroups is a Linux concept, so this cast is safe.  */\n                if (kill((pid_t)pid_value, signum) < 0) {\n                    if (errno != ESRCH) {\n                        virReportSystemError(errno,\n                                             _(\"Failed to kill process %ld\"),\n                                             pid_value);\n                        goto cleanup;\n                    }\n                    /* Leave RC == 0 since we didn't kill one */\n                } else {\n                    killedAny = true;\n                    done = false;\n                }\n\n                ignore_value(virHashAddEntry(pids, (void*)pid_value, (void*)1));\n            }\n            VIR_FORCE_FCLOSE(fp);\n        }\n    }\n\n done:\n    ret = killedAny ? 1 : 0;\n\n cleanup:\n    VIR_FORCE_FCLOSE(fp);\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupPathOfController",
          "args": [
            "group",
            "controller",
            "\"\"",
            "&keypath"
          ],
          "line": 2529
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupPathOfController",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "2907-2916",
          "snippet": "int\nvirCgroupPathOfController(virCgroupPtr group G_GNUC_UNUSED,\n                          unsigned int controller G_GNUC_UNUSED,\n                          const char *key G_GNUC_UNUSED,\n                          char **path G_GNUC_UNUSED)\n{\n    virReportSystemError(ENXIO, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupPathOfController(virCgroupPtr group G_GNUC_UNUSED,\n                          unsigned int controller G_GNUC_UNUSED,\n                          const char *key G_GNUC_UNUSED,\n                          char **path G_GNUC_UNUSED)\n{\n    virReportSystemError(ENXIO, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"group=%p path=%s signum=%d pids=%p\"",
            "group",
            "group->path",
            "signum",
            "pids"
          ],
          "line": 2526
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupKillRecursiveInternal(virCgroupPtr group,\n                               int signum,\n                               virHashTablePtr pids,\n                               int controller,\n                               const char *taskFile,\n                               bool dormdir)\n{\n    int ret = -1;\n    int rc;\n    bool killedAny = false;\n    g_autofree char *keypath = NULL;\n    DIR *dp = NULL;\n    virCgroupPtr subgroup = NULL;\n    struct dirent *ent;\n    int direrr;\n    VIR_DEBUG(\"group=%p path=%s signum=%d pids=%p\",\n              group, group->path, signum, pids);\n\n    if (virCgroupPathOfController(group, controller, \"\", &keypath) < 0)\n        return -1;\n\n    if ((rc = virCgroupKillInternal(group, signum, pids,\n                                    controller, taskFile)) < 0) {\n        goto cleanup;\n    }\n    if (rc == 1)\n        killedAny = true;\n\n    VIR_DEBUG(\"Iterate over children of %s (killedAny=%d)\", keypath, killedAny);\n    if ((rc = virDirOpenIfExists(&dp, keypath)) < 0)\n        goto cleanup;\n\n    if (rc == 0) {\n        VIR_DEBUG(\"Path %s does not exist, assuming done\", keypath);\n        killedAny = false;\n        goto done;\n    }\n\n    while ((direrr = virDirRead(dp, &ent, keypath)) > 0) {\n        if (ent->d_type != DT_DIR)\n            continue;\n\n        VIR_DEBUG(\"Process subdir %s\", ent->d_name);\n\n        if (virCgroupNew(-1, ent->d_name, group, -1, &subgroup) < 0)\n            goto cleanup;\n\n        if ((rc = virCgroupKillRecursiveInternal(subgroup, signum, pids,\n                                                 controller, taskFile, true)) < 0)\n            goto cleanup;\n        if (rc == 1)\n            killedAny = true;\n\n        if (dormdir)\n            virCgroupRemove(subgroup);\n\n        virCgroupFree(&subgroup);\n    }\n    if (direrr < 0)\n        goto cleanup;\n\n done:\n    ret = killedAny ? 1 : 0;\n\n cleanup:\n    virCgroupFree(&subgroup);\n    VIR_DIR_CLOSE(dp);\n    return ret;\n}"
  },
  {
    "function_name": "virCgroupPidPrintHuman",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "2503-2507",
    "snippet": "static char *\nvirCgroupPidPrintHuman(const void *name)\n{\n    return g_strdup_printf(\"%ld\", (const long)name);\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"%ld\"",
            "(const long)name"
          ],
          "line": 2506
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nstatic char *\nvirCgroupPidPrintHuman(const void *name)\n{\n    return g_strdup_printf(\"%ld\", (const long)name);\n}"
  },
  {
    "function_name": "virCgroupPidCopy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "2496-2500",
    "snippet": "static void *\nvirCgroupPidCopy(const void *name)\n{\n    return (void*)name;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nstatic void *\nvirCgroupPidCopy(const void *name)\n{\n    return (void*)name;\n}"
  },
  {
    "function_name": "virCgroupPidEqual",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "2489-2493",
    "snippet": "static bool\nvirCgroupPidEqual(const void *namea, const void *nameb)\n{\n    return namea == nameb;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nstatic bool\nvirCgroupPidEqual(const void *namea, const void *nameb)\n{\n    return namea == nameb;\n}"
  },
  {
    "function_name": "virCgroupPidCode",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "2481-2486",
    "snippet": "static uint32_t\nvirCgroupPidCode(const void *name, uint32_t seed)\n{\n    long pid_value = (long)(intptr_t)name;\n    return virHashCodeGen(&pid_value, sizeof(pid_value), seed);\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virHashCodeGen",
          "args": [
            "&pid_value",
            "sizeof(pid_value)",
            "seed"
          ],
          "line": 2485
        },
        "resolved": true,
        "details": {
          "function_name": "virHashCodeGen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhashcode.c",
          "lines": "63-125",
          "snippet": "uint32_t virHashCodeGen(const void *key, size_t len, uint32_t seed)\n{\n    const uint8_t *blocks;\n    const uint8_t *tail;\n    size_t nblocks;\n    uint32_t h1;\n    uint32_t k1;\n    uint32_t c1;\n    uint32_t c2;\n    size_t i;\n\n    blocks = (const uint8_t *)key;\n    nblocks = len / 4;\n    h1 = seed;\n    c1 = 0xcc9e2d51;\n    c2 = 0x1b873593;\n\n    /* body */\n\n    for (i = 0; i < nblocks; i++) {\n\n        k1 = getblock(blocks, i);\n\n        k1 *= c1;\n        k1 = rotl32(k1, 15);\n        k1 *= c2;\n\n        h1 ^= k1;\n        h1 = rotl32(h1, 13);\n        h1 = h1 * 5 + 0xe6546b64;\n    }\n\n    /* tail */\n\n    tail = (const uint8_t *)key + nblocks * 4;\n\n    k1 = 0;\n\n    switch (len & 3) {\n    case 3:\n        k1 ^= tail[2] << 16;\n        G_GNUC_FALLTHROUGH;\n    case 2:\n        k1 ^= tail[1] << 8;\n        G_GNUC_FALLTHROUGH;\n    case 1:\n        k1 ^= tail[0];\n        k1 *= c1;\n        k1 = rotl32(k1, 15);\n        k1 *= c2;\n        h1 ^= k1;\n        G_GNUC_FALLTHROUGH;\n    default:\n        break;\n    }\n\n    /* finalization */\n\n    h1 ^= len;\n    h1 = fmix(h1);\n\n    return h1;\n}",
          "includes": [
            "#include \"virhashcode.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virhashcode.h\"\n#include <config.h>\n\nuint32_t virHashCodeGen(const void *key, size_t len, uint32_t seed)\n{\n    const uint8_t *blocks;\n    const uint8_t *tail;\n    size_t nblocks;\n    uint32_t h1;\n    uint32_t k1;\n    uint32_t c1;\n    uint32_t c2;\n    size_t i;\n\n    blocks = (const uint8_t *)key;\n    nblocks = len / 4;\n    h1 = seed;\n    c1 = 0xcc9e2d51;\n    c2 = 0x1b873593;\n\n    /* body */\n\n    for (i = 0; i < nblocks; i++) {\n\n        k1 = getblock(blocks, i);\n\n        k1 *= c1;\n        k1 = rotl32(k1, 15);\n        k1 *= c2;\n\n        h1 ^= k1;\n        h1 = rotl32(h1, 13);\n        h1 = h1 * 5 + 0xe6546b64;\n    }\n\n    /* tail */\n\n    tail = (const uint8_t *)key + nblocks * 4;\n\n    k1 = 0;\n\n    switch (len & 3) {\n    case 3:\n        k1 ^= tail[2] << 16;\n        G_GNUC_FALLTHROUGH;\n    case 2:\n        k1 ^= tail[1] << 8;\n        G_GNUC_FALLTHROUGH;\n    case 1:\n        k1 ^= tail[0];\n        k1 *= c1;\n        k1 = rotl32(k1, 15);\n        k1 *= c2;\n        h1 ^= k1;\n        G_GNUC_FALLTHROUGH;\n    default:\n        break;\n    }\n\n    /* finalization */\n\n    h1 ^= len;\n    h1 = fmix(h1);\n\n    return h1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nstatic uint32_t\nvirCgroupPidCode(const void *name, uint32_t seed)\n{\n    long pid_value = (long)(intptr_t)name;\n    return virHashCodeGen(&pid_value, sizeof(pid_value), seed);\n}"
  },
  {
    "function_name": "virCgroupKillInternal",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "2402-2478",
    "snippet": "static int\nvirCgroupKillInternal(virCgroupPtr group,\n                      int signum,\n                      virHashTablePtr pids,\n                      int controller,\n                      const char *taskFile)\n{\n    int ret = -1;\n    bool killedAny = false;\n    g_autofree char *keypath = NULL;\n    bool done = false;\n    FILE *fp = NULL;\n    VIR_DEBUG(\"group=%p path=%s signum=%d pids=%p\",\n              group, group->path, signum, pids);\n\n    if (virCgroupPathOfController(group, controller, taskFile, &keypath) < 0)\n        return -1;\n\n    /* PIDs may be forking as we kill them, so loop\n     * until there are no new PIDs found\n     */\n    while (!done) {\n        done = true;\n        if (!(fp = fopen(keypath, \"r\"))) {\n            if (errno == ENOENT) {\n                VIR_DEBUG(\"No file %s, assuming done\", keypath);\n                killedAny = false;\n                goto done;\n            }\n\n            virReportSystemError(errno,\n                                 _(\"Failed to read %s\"),\n                                 keypath);\n            goto cleanup;\n        } else {\n            while (!feof(fp)) {\n                long pid_value;\n                if (fscanf(fp, \"%ld\", &pid_value) != 1) {\n                    if (feof(fp))\n                        break;\n                    virReportSystemError(errno,\n                                         _(\"Failed to read %s\"),\n                                         keypath);\n                    goto cleanup;\n                }\n                if (virHashLookup(pids, (void*)pid_value))\n                    continue;\n\n                VIR_DEBUG(\"pid=%ld\", pid_value);\n                /* Cgroups is a Linux concept, so this cast is safe.  */\n                if (kill((pid_t)pid_value, signum) < 0) {\n                    if (errno != ESRCH) {\n                        virReportSystemError(errno,\n                                             _(\"Failed to kill process %ld\"),\n                                             pid_value);\n                        goto cleanup;\n                    }\n                    /* Leave RC == 0 since we didn't kill one */\n                } else {\n                    killedAny = true;\n                    done = false;\n                }\n\n                ignore_value(virHashAddEntry(pids, (void*)pid_value, (void*)1));\n            }\n            VIR_FORCE_FCLOSE(fp);\n        }\n    }\n\n done:\n    ret = killedAny ? 1 : 0;\n\n cleanup:\n    VIR_FORCE_FCLOSE(fp);\n\n    return ret;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FORCE_FCLOSE",
          "args": [
            "fp"
          ],
          "line": 2475
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FORCE_FCLOSE",
          "args": [
            "fp"
          ],
          "line": 2467
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ignore_value",
          "args": [
            "virHashAddEntry(pids, (void*)pid_value, (void*)1)"
          ],
          "line": 2465
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virHashAddEntry",
          "args": [
            "pids",
            "(void*)pid_value",
            "(void*)1"
          ],
          "line": 2465
        },
        "resolved": true,
        "details": {
          "function_name": "virHashAddEntry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "404-408",
          "snippet": "int\nvirHashAddEntry(virHashTablePtr table, const void *name, void *userdata)\n{\n    return virHashAddOrUpdateEntry(table, name, userdata, false);\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint\nvirHashAddEntry(virHashTablePtr table, const void *name, void *userdata)\n{\n    return virHashAddOrUpdateEntry(table, name, userdata, false);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"Failed to kill process %ld\")",
            "pid_value"
          ],
          "line": 2454
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Failed to kill process %ld\""
          ],
          "line": 2455
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "kill",
          "args": [
            "(pid_t)pid_value",
            "signum"
          ],
          "line": 2452
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"pid=%ld\"",
            "pid_value"
          ],
          "line": 2450
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virHashLookup",
          "args": [
            "pids",
            "(void*)pid_value"
          ],
          "line": 2447
        },
        "resolved": true,
        "details": {
          "function_name": "virHashLookup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "473-482",
          "snippet": "void *\nvirHashLookup(const virHashTable *table, const void *name)\n{\n    virHashEntryPtr entry = virHashGetEntry(table, name);\n\n    if (!entry)\n        return NULL;\n\n    return entry->payload;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvoid *\nvirHashLookup(const virHashTable *table, const void *name)\n{\n    virHashEntryPtr entry = virHashGetEntry(table, name);\n\n    if (!entry)\n        return NULL;\n\n    return entry->payload;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"Failed to read %s\")",
            "keypath"
          ],
          "line": 2442
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "feof",
          "args": [
            "fp"
          ],
          "line": 2440
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fscanf",
          "args": [
            "fp",
            "\"%ld\"",
            "&pid_value"
          ],
          "line": 2439
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "feof",
          "args": [
            "fp"
          ],
          "line": 2437
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"Failed to read %s\")",
            "keypath"
          ],
          "line": 2432
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"No file %s, assuming done\"",
            "keypath"
          ],
          "line": 2427
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fopen",
          "args": [
            "keypath",
            "\"r\""
          ],
          "line": 2425
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCgroupPathOfController",
          "args": [
            "group",
            "controller",
            "taskFile",
            "&keypath"
          ],
          "line": 2417
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupPathOfController",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "2907-2916",
          "snippet": "int\nvirCgroupPathOfController(virCgroupPtr group G_GNUC_UNUSED,\n                          unsigned int controller G_GNUC_UNUSED,\n                          const char *key G_GNUC_UNUSED,\n                          char **path G_GNUC_UNUSED)\n{\n    virReportSystemError(ENXIO, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupPathOfController(virCgroupPtr group G_GNUC_UNUSED,\n                          unsigned int controller G_GNUC_UNUSED,\n                          const char *key G_GNUC_UNUSED,\n                          char **path G_GNUC_UNUSED)\n{\n    virReportSystemError(ENXIO, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"group=%p path=%s signum=%d pids=%p\"",
            "group",
            "group->path",
            "signum",
            "pids"
          ],
          "line": 2414
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nstatic int\nvirCgroupKillInternal(virCgroupPtr group,\n                      int signum,\n                      virHashTablePtr pids,\n                      int controller,\n                      const char *taskFile)\n{\n    int ret = -1;\n    bool killedAny = false;\n    g_autofree char *keypath = NULL;\n    bool done = false;\n    FILE *fp = NULL;\n    VIR_DEBUG(\"group=%p path=%s signum=%d pids=%p\",\n              group, group->path, signum, pids);\n\n    if (virCgroupPathOfController(group, controller, taskFile, &keypath) < 0)\n        return -1;\n\n    /* PIDs may be forking as we kill them, so loop\n     * until there are no new PIDs found\n     */\n    while (!done) {\n        done = true;\n        if (!(fp = fopen(keypath, \"r\"))) {\n            if (errno == ENOENT) {\n                VIR_DEBUG(\"No file %s, assuming done\", keypath);\n                killedAny = false;\n                goto done;\n            }\n\n            virReportSystemError(errno,\n                                 _(\"Failed to read %s\"),\n                                 keypath);\n            goto cleanup;\n        } else {\n            while (!feof(fp)) {\n                long pid_value;\n                if (fscanf(fp, \"%ld\", &pid_value) != 1) {\n                    if (feof(fp))\n                        break;\n                    virReportSystemError(errno,\n                                         _(\"Failed to read %s\"),\n                                         keypath);\n                    goto cleanup;\n                }\n                if (virHashLookup(pids, (void*)pid_value))\n                    continue;\n\n                VIR_DEBUG(\"pid=%ld\", pid_value);\n                /* Cgroups is a Linux concept, so this cast is safe.  */\n                if (kill((pid_t)pid_value, signum) < 0) {\n                    if (errno != ESRCH) {\n                        virReportSystemError(errno,\n                                             _(\"Failed to kill process %ld\"),\n                                             pid_value);\n                        goto cleanup;\n                    }\n                    /* Leave RC == 0 since we didn't kill one */\n                } else {\n                    killedAny = true;\n                    done = false;\n                }\n\n                ignore_value(virHashAddEntry(pids, (void*)pid_value, (void*)1));\n            }\n            VIR_FORCE_FCLOSE(fp);\n        }\n    }\n\n done:\n    ret = killedAny ? 1 : 0;\n\n cleanup:\n    VIR_FORCE_FCLOSE(fp);\n\n    return ret;\n}"
  },
  {
    "function_name": "virCgroupRemove",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "2382-2396",
    "snippet": "int\nvirCgroupRemove(virCgroupPtr group)\n{\n    size_t i;\n\n    for (i = 0; i < VIR_CGROUP_BACKEND_TYPE_LAST; i++) {\n        if (group->backends[i]) {\n            int rc = group->backends[i]->remove(group);\n            if (rc < 0)\n                return rc;\n        }\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "group->backends[i]->remove",
          "args": [
            "group"
          ],
          "line": 2389
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupRemove(virCgroupPtr group)\n{\n    size_t i;\n\n    for (i = 0; i < VIR_CGROUP_BACKEND_TYPE_LAST; i++) {\n        if (group->backends[i]) {\n            int rc = group->backends[i]->remove(group);\n            if (rc < 0)\n                return rc;\n        }\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virCgroupRemoveRecursively",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "2324-2367",
    "snippet": "int\nvirCgroupRemoveRecursively(char *grppath)\n{\n    DIR *grpdir;\n    struct dirent *ent;\n    int rc = 0;\n    int direrr;\n\n    if (virDirOpenQuiet(&grpdir, grppath) < 0) {\n        if (errno == ENOENT)\n            return 0;\n        rc = -errno;\n        VIR_ERROR(_(\"Unable to open %s (%d)\"), grppath, errno);\n        return rc;\n    }\n\n    /* This is best-effort cleanup: we want to log failures with just\n     * VIR_ERROR instead of normal virReportError */\n    while ((direrr = virDirRead(grpdir, &ent, NULL)) > 0) {\n        g_autofree char *path = NULL;\n\n        if (ent->d_type != DT_DIR) continue;\n\n        path = g_strdup_printf(\"%s/%s\", grppath, ent->d_name);\n\n        rc = virCgroupRemoveRecursively(path);\n        if (rc != 0)\n            break;\n    }\n    if (direrr < 0) {\n        rc = -errno;\n        VIR_ERROR(_(\"Failed to readdir for %s (%d)\"), grppath, errno);\n    }\n\n    VIR_DIR_CLOSE(grpdir);\n\n    VIR_DEBUG(\"Removing cgroup %s\", grppath);\n    if (rmdir(grppath) != 0 && errno != ENOENT) {\n        rc = -errno;\n        VIR_ERROR(_(\"Unable to remove %s (%d)\"), grppath, errno);\n    }\n\n    return rc;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_ERROR",
          "args": [
            "_(\"Unable to remove %s (%d)\")",
            "grppath",
            "errno"
          ],
          "line": 2363
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to remove %s (%d)\""
          ],
          "line": 2363
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "rmdir",
          "args": [
            "grppath"
          ],
          "line": 2361
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Removing cgroup %s\"",
            "grppath"
          ],
          "line": 2360
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DIR_CLOSE",
          "args": [
            "grpdir"
          ],
          "line": 2358
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_ERROR",
          "args": [
            "_(\"Failed to readdir for %s (%d)\")",
            "grppath",
            "errno"
          ],
          "line": 2355
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCgroupRemoveRecursively",
          "args": [
            "path"
          ],
          "line": 2349
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupRemoveRecursively",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "2324-2367",
          "snippet": "int\nvirCgroupRemoveRecursively(char *grppath)\n{\n    DIR *grpdir;\n    struct dirent *ent;\n    int rc = 0;\n    int direrr;\n\n    if (virDirOpenQuiet(&grpdir, grppath) < 0) {\n        if (errno == ENOENT)\n            return 0;\n        rc = -errno;\n        VIR_ERROR(_(\"Unable to open %s (%d)\"), grppath, errno);\n        return rc;\n    }\n\n    /* This is best-effort cleanup: we want to log failures with just\n     * VIR_ERROR instead of normal virReportError */\n    while ((direrr = virDirRead(grpdir, &ent, NULL)) > 0) {\n        g_autofree char *path = NULL;\n\n        if (ent->d_type != DT_DIR) continue;\n\n        path = g_strdup_printf(\"%s/%s\", grppath, ent->d_name);\n\n        rc = virCgroupRemoveRecursively(path);\n        if (rc != 0)\n            break;\n    }\n    if (direrr < 0) {\n        rc = -errno;\n        VIR_ERROR(_(\"Failed to readdir for %s (%d)\"), grppath, errno);\n    }\n\n    VIR_DIR_CLOSE(grpdir);\n\n    VIR_DEBUG(\"Removing cgroup %s\", grppath);\n    if (rmdir(grppath) != 0 && errno != ENOENT) {\n        rc = -errno;\n        VIR_ERROR(_(\"Unable to remove %s (%d)\"), grppath, errno);\n    }\n\n    return rc;\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "virDirRead",
          "args": [
            "grpdir",
            "&ent",
            "NULL"
          ],
          "line": 2342
        },
        "resolved": true,
        "details": {
          "function_name": "virDirRead",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "2940-2954",
          "snippet": "int virDirRead(DIR *dirp, struct dirent **ent, const char *name)\n{\n    do {\n        errno = 0;\n        *ent = readdir(dirp); /* exempt from syntax-check */\n        if (!*ent && errno) {\n            if (name)\n                virReportSystemError(errno, _(\"Unable to read directory '%s'\"),\n                                     name);\n            return -1;\n        }\n    } while (*ent && (STREQ((*ent)->d_name, \".\") ||\n                      STREQ((*ent)->d_name, \"..\")));\n    return !!*ent;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint virDirRead(DIR *dirp, struct dirent **ent, const char *name)\n{\n    do {\n        errno = 0;\n        *ent = readdir(dirp); /* exempt from syntax-check */\n        if (!*ent && errno) {\n            if (name)\n                virReportSystemError(errno, _(\"Unable to read directory '%s'\"),\n                                     name);\n            return -1;\n        }\n    } while (*ent && (STREQ((*ent)->d_name, \".\") ||\n                      STREQ((*ent)->d_name, \"..\")));\n    return !!*ent;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_ERROR",
          "args": [
            "_(\"Unable to open %s (%d)\")",
            "grppath",
            "errno"
          ],
          "line": 2336
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDirOpenQuiet",
          "args": [
            "&grpdir",
            "grppath"
          ],
          "line": 2332
        },
        "resolved": true,
        "details": {
          "function_name": "virDirOpenQuiet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "2914-2918",
          "snippet": "int\nvirDirOpenQuiet(DIR **dirp, const char *name)\n{\n    return virDirOpenInternal(dirp, name, false, true);\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirDirOpenQuiet(DIR **dirp, const char *name)\n{\n    return virDirOpenInternal(dirp, name, false, true);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupRemoveRecursively(char *grppath)\n{\n    DIR *grpdir;\n    struct dirent *ent;\n    int rc = 0;\n    int direrr;\n\n    if (virDirOpenQuiet(&grpdir, grppath) < 0) {\n        if (errno == ENOENT)\n            return 0;\n        rc = -errno;\n        VIR_ERROR(_(\"Unable to open %s (%d)\"), grppath, errno);\n        return rc;\n    }\n\n    /* This is best-effort cleanup: we want to log failures with just\n     * VIR_ERROR instead of normal virReportError */\n    while ((direrr = virDirRead(grpdir, &ent, NULL)) > 0) {\n        g_autofree char *path = NULL;\n\n        if (ent->d_type != DT_DIR) continue;\n\n        path = g_strdup_printf(\"%s/%s\", grppath, ent->d_name);\n\n        rc = virCgroupRemoveRecursively(path);\n        if (rc != 0)\n            break;\n    }\n    if (direrr < 0) {\n        rc = -errno;\n        VIR_ERROR(_(\"Failed to readdir for %s (%d)\"), grppath, errno);\n    }\n\n    VIR_DIR_CLOSE(grpdir);\n\n    VIR_DEBUG(\"Removing cgroup %s\", grppath);\n    if (rmdir(grppath) != 0 && errno != ENOENT) {\n        rc = -errno;\n        VIR_ERROR(_(\"Unable to remove %s (%d)\"), grppath, errno);\n    }\n\n    return rc;\n}"
  },
  {
    "function_name": "virCgroupGetCpuacctPercpuUsage",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "2316-2321",
    "snippet": "int\nvirCgroupGetCpuacctPercpuUsage(virCgroupPtr group, char **usage)\n{\n    VIR_CGROUP_BACKEND_CALL(group, VIR_CGROUP_CONTROLLER_CPUACCT,\n                            getCpuacctPercpuUsage, -1, usage);\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_CGROUP_BACKEND_CALL",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_CPUACCT",
            "getCpuacctPercpuUsage",
            "-1",
            "usage"
          ],
          "line": 2319
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetCpuacctPercpuUsage(virCgroupPtr group, char **usage)\n{\n    VIR_CGROUP_BACKEND_CALL(group, VIR_CGROUP_CONTROLLER_CPUACCT,\n                            getCpuacctPercpuUsage, -1, usage);\n}"
  },
  {
    "function_name": "virCgroupSetCpuCfsQuota",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "2308-2313",
    "snippet": "int\nvirCgroupSetCpuCfsQuota(virCgroupPtr group, long long cfs_quota)\n{\n    VIR_CGROUP_BACKEND_CALL(group, VIR_CGROUP_CONTROLLER_CPU,\n                            setCpuCfsQuota, -1, cfs_quota);\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_CGROUP_BACKEND_CALL",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_CPU",
            "setCpuCfsQuota",
            "-1",
            "cfs_quota"
          ],
          "line": 2311
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupSetCpuCfsQuota(virCgroupPtr group, long long cfs_quota)\n{\n    VIR_CGROUP_BACKEND_CALL(group, VIR_CGROUP_CONTROLLER_CPU,\n                            setCpuCfsQuota, -1, cfs_quota);\n}"
  },
  {
    "function_name": "virCgroupGetCpuCfsPeriod",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "2291-2296",
    "snippet": "int\nvirCgroupGetCpuCfsPeriod(virCgroupPtr group, unsigned long long *cfs_period)\n{\n    VIR_CGROUP_BACKEND_CALL(group, VIR_CGROUP_CONTROLLER_CPU,\n                            getCpuCfsPeriod, -1, cfs_period);\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_CGROUP_BACKEND_CALL",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_CPU",
            "getCpuCfsPeriod",
            "-1",
            "cfs_period"
          ],
          "line": 2294
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetCpuCfsPeriod(virCgroupPtr group, unsigned long long *cfs_period)\n{\n    VIR_CGROUP_BACKEND_CALL(group, VIR_CGROUP_CONTROLLER_CPU,\n                            getCpuCfsPeriod, -1, cfs_period);\n}"
  },
  {
    "function_name": "virCgroupSetCpuCfsPeriod",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "2275-2280",
    "snippet": "int\nvirCgroupSetCpuCfsPeriod(virCgroupPtr group, unsigned long long cfs_period)\n{\n    VIR_CGROUP_BACKEND_CALL(group, VIR_CGROUP_CONTROLLER_CPU,\n                            setCpuCfsPeriod, -1, cfs_period);\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_CGROUP_BACKEND_CALL",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_CPU",
            "setCpuCfsPeriod",
            "-1",
            "cfs_period"
          ],
          "line": 2278
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupSetCpuCfsPeriod(virCgroupPtr group, unsigned long long cfs_period)\n{\n    VIR_CGROUP_BACKEND_CALL(group, VIR_CGROUP_CONTROLLER_CPU,\n                            setCpuCfsPeriod, -1, cfs_period);\n}"
  },
  {
    "function_name": "virCgroupGetCpuShares",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "2259-2264",
    "snippet": "int\nvirCgroupGetCpuShares(virCgroupPtr group, unsigned long long *shares)\n{\n    VIR_CGROUP_BACKEND_CALL(group, VIR_CGROUP_CONTROLLER_CPU,\n                            getCpuShares, -1, shares);\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_CGROUP_BACKEND_CALL",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_CPU",
            "getCpuShares",
            "-1",
            "shares"
          ],
          "line": 2262
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetCpuShares(virCgroupPtr group, unsigned long long *shares)\n{\n    VIR_CGROUP_BACKEND_CALL(group, VIR_CGROUP_CONTROLLER_CPU,\n                            getCpuShares, -1, shares);\n}"
  },
  {
    "function_name": "virCgroupSetCpuShares",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "2251-2256",
    "snippet": "int\nvirCgroupSetCpuShares(virCgroupPtr group, unsigned long long shares)\n{\n    VIR_CGROUP_BACKEND_CALL(group, VIR_CGROUP_CONTROLLER_CPU,\n                            setCpuShares, -1, shares);\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_CGROUP_BACKEND_CALL",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_CPU",
            "setCpuShares",
            "-1",
            "shares"
          ],
          "line": 2254
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupSetCpuShares(virCgroupPtr group, unsigned long long shares)\n{\n    VIR_CGROUP_BACKEND_CALL(group, VIR_CGROUP_CONTROLLER_CPU,\n                            setCpuShares, -1, shares);\n}"
  },
  {
    "function_name": "virCgroupGetDomainTotalCpuStats",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "2202-2248",
    "snippet": "int\nvirCgroupGetDomainTotalCpuStats(virCgroupPtr group,\n                                virTypedParameterPtr params,\n                                int nparams)\n{\n    unsigned long long cpu_time;\n    int ret;\n\n    if (nparams == 0) /* return supported number of params */\n        return CGROUP_NB_TOTAL_CPU_STAT_PARAM;\n    /* entry 0 is cputime */\n    ret = virCgroupGetCpuacctUsage(group, &cpu_time);\n    if (ret < 0) {\n        virReportSystemError(-ret, \"%s\", _(\"unable to get cpu account\"));\n        return -1;\n    }\n\n    if (virTypedParameterAssign(&params[0], VIR_DOMAIN_CPU_STATS_CPUTIME,\n                                VIR_TYPED_PARAM_ULLONG, cpu_time) < 0)\n        return -1;\n\n    if (nparams > 1) {\n        unsigned long long user;\n        unsigned long long sys;\n\n        ret = virCgroupGetCpuacctStat(group, &user, &sys);\n        if (ret < 0) {\n            virReportSystemError(-ret, \"%s\", _(\"unable to get cpu account\"));\n            return -1;\n        }\n\n        if (virTypedParameterAssign(&params[1],\n                                    VIR_DOMAIN_CPU_STATS_USERTIME,\n                                    VIR_TYPED_PARAM_ULLONG, user) < 0)\n            return -1;\n        if (nparams > 2 &&\n            virTypedParameterAssign(&params[2],\n                                    VIR_DOMAIN_CPU_STATS_SYSTEMTIME,\n                                    VIR_TYPED_PARAM_ULLONG, sys) < 0)\n            return -1;\n\n        if (nparams > CGROUP_NB_TOTAL_CPU_STAT_PARAM)\n            nparams = CGROUP_NB_TOTAL_CPU_STAT_PARAM;\n    }\n\n    return nparams;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define CGROUP_NB_TOTAL_CPU_STAT_PARAM 3"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virTypedParameterAssign",
          "args": [
            "&params[2]",
            "VIR_DOMAIN_CPU_STATS_SYSTEMTIME",
            "VIR_TYPED_PARAM_ULLONG",
            "sys"
          ],
          "line": 2238
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParameterAssign",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam.c",
          "lines": "276-294",
          "snippet": "int\nvirTypedParameterAssign(virTypedParameterPtr param, const char *name,\n                        int type, ...)\n{\n    va_list ap;\n    int ret = -1;\n\n    if (virStrcpyStatic(param->field, name) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, _(\"Field name '%s' too long\"),\n                       name);\n        return -1;\n    }\n\n    va_start(ap, type);\n    ret = virTypedParameterAssignValueVArgs(param, type, ap, false);\n    va_end(ap);\n\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <stdarg.h>",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <stdarg.h>\n#include \"virtypedparam.h\"\n#include <config.h>\n\nint\nvirTypedParameterAssign(virTypedParameterPtr param, const char *name,\n                        int type, ...)\n{\n    va_list ap;\n    int ret = -1;\n\n    if (virStrcpyStatic(param->field, name) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, _(\"Field name '%s' too long\"),\n                       name);\n        return -1;\n    }\n\n    va_start(ap, type);\n    ret = virTypedParameterAssignValueVArgs(param, type, ap, false);\n    va_end(ap);\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "-ret",
            "\"%s\"",
            "_(\"unable to get cpu account\")"
          ],
          "line": 2229
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"unable to get cpu account\""
          ],
          "line": 2229
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupGetCpuacctStat",
          "args": [
            "group",
            "&user",
            "&sys"
          ],
          "line": 2227
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupGetCpuacctStat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3436-3444",
          "snippet": "int\nvirCgroupGetCpuacctStat(virCgroupPtr group G_GNUC_UNUSED,\n                        unsigned long long *user G_GNUC_UNUSED,\n                        unsigned long long *sys G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetCpuacctStat(virCgroupPtr group G_GNUC_UNUSED,\n                        unsigned long long *user G_GNUC_UNUSED,\n                        unsigned long long *sys G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "-ret",
            "\"%s\"",
            "_(\"unable to get cpu account\")"
          ],
          "line": 2215
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCgroupGetCpuacctUsage",
          "args": [
            "group",
            "&cpu_time"
          ],
          "line": 2213
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupGetCpuacctUsage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3416-3423",
          "snippet": "int\nvirCgroupGetCpuacctUsage(virCgroupPtr group G_GNUC_UNUSED,\n                         unsigned long long *usage G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetCpuacctUsage(virCgroupPtr group G_GNUC_UNUSED,\n                         unsigned long long *usage G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\n#define CGROUP_NB_TOTAL_CPU_STAT_PARAM 3\n\nint\nvirCgroupGetDomainTotalCpuStats(virCgroupPtr group,\n                                virTypedParameterPtr params,\n                                int nparams)\n{\n    unsigned long long cpu_time;\n    int ret;\n\n    if (nparams == 0) /* return supported number of params */\n        return CGROUP_NB_TOTAL_CPU_STAT_PARAM;\n    /* entry 0 is cputime */\n    ret = virCgroupGetCpuacctUsage(group, &cpu_time);\n    if (ret < 0) {\n        virReportSystemError(-ret, \"%s\", _(\"unable to get cpu account\"));\n        return -1;\n    }\n\n    if (virTypedParameterAssign(&params[0], VIR_DOMAIN_CPU_STATS_CPUTIME,\n                                VIR_TYPED_PARAM_ULLONG, cpu_time) < 0)\n        return -1;\n\n    if (nparams > 1) {\n        unsigned long long user;\n        unsigned long long sys;\n\n        ret = virCgroupGetCpuacctStat(group, &user, &sys);\n        if (ret < 0) {\n            virReportSystemError(-ret, \"%s\", _(\"unable to get cpu account\"));\n            return -1;\n        }\n\n        if (virTypedParameterAssign(&params[1],\n                                    VIR_DOMAIN_CPU_STATS_USERTIME,\n                                    VIR_TYPED_PARAM_ULLONG, user) < 0)\n            return -1;\n        if (nparams > 2 &&\n            virTypedParameterAssign(&params[2],\n                                    VIR_DOMAIN_CPU_STATS_SYSTEMTIME,\n                                    VIR_TYPED_PARAM_ULLONG, sys) < 0)\n            return -1;\n\n        if (nparams > CGROUP_NB_TOTAL_CPU_STAT_PARAM)\n            nparams = CGROUP_NB_TOTAL_CPU_STAT_PARAM;\n    }\n\n    return nparams;\n}"
  },
  {
    "function_name": "virCgroupGetPercpuStats",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "2099-2199",
    "snippet": "int\nvirCgroupGetPercpuStats(virCgroupPtr group,\n                        virTypedParameterPtr params,\n                        unsigned int nparams,\n                        int start_cpu,\n                        unsigned int ncpus,\n                        virBitmapPtr guestvcpus)\n{\n    int ret = -1;\n    size_t i;\n    int need_cpus, total_cpus;\n    char *pos;\n    g_autofree char *buf = NULL;\n    g_autofree unsigned long long *sum_cpu_time = NULL;\n    virTypedParameterPtr ent;\n    int param_idx;\n    unsigned long long cpu_time;\n    virBitmapPtr cpumap = NULL;\n\n    /* return the number of supported params */\n    if (nparams == 0 && ncpus != 0) {\n        if (!guestvcpus)\n            return CGROUP_NB_PER_CPU_STAT_PARAM;\n        else\n            return CGROUP_NB_PER_CPU_STAT_PARAM + 1;\n    }\n\n    /* To parse account file, we need to know how many cpus are present.  */\n    if (!(cpumap = virHostCPUGetPresentBitmap()))\n        return -1;\n\n    total_cpus = virBitmapSize(cpumap);\n\n    /* return total number of cpus */\n    if (ncpus == 0) {\n        ret = total_cpus;\n        goto cleanup;\n    }\n\n    if (start_cpu >= total_cpus) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"start_cpu %d larger than maximum of %d\"),\n                       start_cpu, total_cpus - 1);\n        goto cleanup;\n    }\n\n    /* we get percpu cputime accounting info. */\n    if (virCgroupGetCpuacctPercpuUsage(group, &buf))\n        goto cleanup;\n    pos = buf;\n\n    /* return percpu cputime in index 0 */\n    param_idx = 0;\n\n    /* number of cpus to compute */\n    need_cpus = MIN(total_cpus, start_cpu + ncpus);\n\n    for (i = 0; i < need_cpus; i++) {\n        if (!virBitmapIsBitSet(cpumap, i)) {\n            cpu_time = 0;\n        } else if (virStrToLong_ull(pos, &pos, 10, &cpu_time) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"cpuacct parse error\"));\n            goto cleanup;\n        }\n        if (i < start_cpu)\n            continue;\n        ent = &params[(i - start_cpu) * nparams + param_idx];\n        if (virTypedParameterAssign(ent, VIR_DOMAIN_CPU_STATS_CPUTIME,\n                                    VIR_TYPED_PARAM_ULLONG, cpu_time) < 0)\n            goto cleanup;\n    }\n\n    /* return percpu vcputime in index 1 */\n    param_idx = 1;\n\n    if (guestvcpus && param_idx < nparams) {\n        if (VIR_ALLOC_N(sum_cpu_time, need_cpus) < 0)\n            goto cleanup;\n        if (virCgroupGetPercpuVcpuSum(group, guestvcpus, sum_cpu_time,\n                                      need_cpus, cpumap) < 0)\n            goto cleanup;\n\n        for (i = start_cpu; i < need_cpus; i++) {\n            int idx = (i - start_cpu) * nparams + param_idx;\n            if (virTypedParameterAssign(&params[idx],\n                                        VIR_DOMAIN_CPU_STATS_VCPUTIME,\n                                        VIR_TYPED_PARAM_ULLONG,\n                                        sum_cpu_time[i]) < 0)\n                goto cleanup;\n        }\n\n        param_idx++;\n    }\n\n    ret = param_idx;\n\n cleanup:\n    virBitmapFree(cpumap);\n    return ret;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define CGROUP_NB_PER_CPU_STAT_PARAM   1"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virBitmapFree",
          "args": [
            "cpumap"
          ],
          "line": 2197
        },
        "resolved": true,
        "details": {
          "function_name": "virBitmapFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
          "lines": "128-135",
          "snippet": "void\nvirBitmapFree(virBitmapPtr bitmap)\n{\n    if (bitmap) {\n        VIR_FREE(bitmap->map);\n        VIR_FREE(bitmap);\n    }\n}",
          "includes": [
            "#include \"virerror.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbitmap.h\"",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\nvoid\nvirBitmapFree(virBitmapPtr bitmap)\n{\n    if (bitmap) {\n        VIR_FREE(bitmap->map);\n        VIR_FREE(bitmap);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virTypedParameterAssign",
          "args": [
            "&params[idx]",
            "VIR_DOMAIN_CPU_STATS_VCPUTIME",
            "VIR_TYPED_PARAM_ULLONG",
            "sum_cpu_time[i]"
          ],
          "line": 2184
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParameterAssign",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam.c",
          "lines": "276-294",
          "snippet": "int\nvirTypedParameterAssign(virTypedParameterPtr param, const char *name,\n                        int type, ...)\n{\n    va_list ap;\n    int ret = -1;\n\n    if (virStrcpyStatic(param->field, name) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, _(\"Field name '%s' too long\"),\n                       name);\n        return -1;\n    }\n\n    va_start(ap, type);\n    ret = virTypedParameterAssignValueVArgs(param, type, ap, false);\n    va_end(ap);\n\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <stdarg.h>",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <stdarg.h>\n#include \"virtypedparam.h\"\n#include <config.h>\n\nint\nvirTypedParameterAssign(virTypedParameterPtr param, const char *name,\n                        int type, ...)\n{\n    va_list ap;\n    int ret = -1;\n\n    if (virStrcpyStatic(param->field, name) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, _(\"Field name '%s' too long\"),\n                       name);\n        return -1;\n    }\n\n    va_start(ap, type);\n    ret = virTypedParameterAssignValueVArgs(param, type, ap, false);\n    va_end(ap);\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupGetPercpuVcpuSum",
          "args": [
            "group",
            "guestvcpus",
            "sum_cpu_time",
            "need_cpus",
            "cpumap"
          ],
          "line": 2178
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupGetPercpuVcpuSum",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "2033-2076",
          "snippet": "static int\nvirCgroupGetPercpuVcpuSum(virCgroupPtr group,\n                          virBitmapPtr guestvcpus,\n                          unsigned long long *sum_cpu_time,\n                          size_t nsum,\n                          virBitmapPtr cpumap)\n{\n    int ret = -1;\n    ssize_t i = -1;\n    virCgroupPtr group_vcpu = NULL;\n\n    while ((i = virBitmapNextSetBit(guestvcpus, i)) >= 0) {\n        g_autofree char *buf = NULL;\n        char *pos;\n        unsigned long long tmp;\n        ssize_t j;\n\n        if (virCgroupNewThread(group, VIR_CGROUP_THREAD_VCPU, i,\n                               false, &group_vcpu) < 0)\n            goto cleanup;\n\n        if (virCgroupGetCpuacctPercpuUsage(group_vcpu, &buf) < 0)\n            goto cleanup;\n\n        pos = buf;\n        for (j = virBitmapNextSetBit(cpumap, -1);\n             j >= 0 && j < nsum;\n             j = virBitmapNextSetBit(cpumap, j)) {\n            if (virStrToLong_ull(pos, &pos, 10, &tmp) < 0) {\n                virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                               _(\"cpuacct parse error\"));\n                goto cleanup;\n            }\n            sum_cpu_time[j] += tmp;\n        }\n\n        virCgroupFree(&group_vcpu);\n    }\n\n    ret = 0;\n cleanup:\n    virCgroupFree(&group_vcpu);\n    return ret;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nstatic int\nvirCgroupGetPercpuVcpuSum(virCgroupPtr group,\n                          virBitmapPtr guestvcpus,\n                          unsigned long long *sum_cpu_time,\n                          size_t nsum,\n                          virBitmapPtr cpumap)\n{\n    int ret = -1;\n    ssize_t i = -1;\n    virCgroupPtr group_vcpu = NULL;\n\n    while ((i = virBitmapNextSetBit(guestvcpus, i)) >= 0) {\n        g_autofree char *buf = NULL;\n        char *pos;\n        unsigned long long tmp;\n        ssize_t j;\n\n        if (virCgroupNewThread(group, VIR_CGROUP_THREAD_VCPU, i,\n                               false, &group_vcpu) < 0)\n            goto cleanup;\n\n        if (virCgroupGetCpuacctPercpuUsage(group_vcpu, &buf) < 0)\n            goto cleanup;\n\n        pos = buf;\n        for (j = virBitmapNextSetBit(cpumap, -1);\n             j >= 0 && j < nsum;\n             j = virBitmapNextSetBit(cpumap, j)) {\n            if (virStrToLong_ull(pos, &pos, 10, &tmp) < 0) {\n                virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                               _(\"cpuacct parse error\"));\n                goto cleanup;\n            }\n            sum_cpu_time[j] += tmp;\n        }\n\n        virCgroupFree(&group_vcpu);\n    }\n\n    ret = 0;\n cleanup:\n    virCgroupFree(&group_vcpu);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC_N",
          "args": [
            "sum_cpu_time",
            "need_cpus"
          ],
          "line": 2176
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"cpuacct parse error\")"
          ],
          "line": 2160
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"cpuacct parse error\""
          ],
          "line": 2161
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStrToLong_ull",
          "args": [
            "pos",
            "&pos",
            "10",
            "&cpu_time"
          ],
          "line": 2159
        },
        "resolved": true,
        "details": {
          "function_name": "virStrToLong_ullp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "568-586",
          "snippet": "int\nvirStrToLong_ullp(char const *s, char **end_ptr, int base,\n                  unsigned long long *result)\n{\n    unsigned long long val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtoull(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToLong_ullp(char const *s, char **end_ptr, int base,\n                  unsigned long long *result)\n{\n    unsigned long long val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtoull(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBitmapIsBitSet",
          "args": [
            "cpumap",
            "i"
          ],
          "line": 2157
        },
        "resolved": true,
        "details": {
          "function_name": "virBitmapIsBitSet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
          "lines": "298-306",
          "snippet": "bool\nvirBitmapIsBitSet(virBitmapPtr bitmap,\n                  size_t b)\n{\n    if (bitmap->nbits <= b)\n        return false;\n\n    return virBitmapIsSet(bitmap, b);\n}",
          "includes": [
            "#include \"virerror.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbitmap.h\"",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\nbool\nvirBitmapIsBitSet(virBitmapPtr bitmap,\n                  size_t b)\n{\n    if (bitmap->nbits <= b)\n        return false;\n\n    return virBitmapIsSet(bitmap, b);\n}"
        }
      },
      {
        "call_info": {
          "callee": "MIN",
          "args": [
            "total_cpus",
            "start_cpu + ncpus"
          ],
          "line": 2154
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCgroupGetCpuacctPercpuUsage",
          "args": [
            "group",
            "&buf"
          ],
          "line": 2146
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupGetCpuacctPercpuUsage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3426-3433",
          "snippet": "int\nvirCgroupGetCpuacctPercpuUsage(virCgroupPtr group G_GNUC_UNUSED,\n                               char **usage G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetCpuacctPercpuUsage(virCgroupPtr group G_GNUC_UNUSED,\n                               char **usage G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INVALID_ARG",
            "_(\"start_cpu %d larger than maximum of %d\")",
            "start_cpu",
            "total_cpus - 1"
          ],
          "line": 2139
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBitmapSize",
          "args": [
            "cpumap"
          ],
          "line": 2130
        },
        "resolved": true,
        "details": {
          "function_name": "virBitmapSize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
          "lines": "882-886",
          "snippet": "size_t\nvirBitmapSize(virBitmapPtr bitmap)\n{\n    return bitmap->nbits;\n}",
          "includes": [
            "#include \"virerror.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbitmap.h\"",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\nsize_t\nvirBitmapSize(virBitmapPtr bitmap)\n{\n    return bitmap->nbits;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHostCPUGetPresentBitmap",
          "args": [],
          "line": 2127
        },
        "resolved": true,
        "details": {
          "function_name": "virHostCPUGetPresentBitmap",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhostcpu.c",
          "lines": "1054-1068",
          "snippet": "virBitmapPtr\nvirHostCPUGetPresentBitmap(void)\n{\n#ifdef __linux__\n    virBitmapPtr ret = NULL;\n\n    virFileReadValueBitmap(&ret, \"%s/cpu/present\", SYSFS_SYSTEM_PATH);\n\n    return ret;\n#else\n    virReportError(VIR_ERR_NO_SUPPORT, \"%s\",\n                   _(\"node present CPU map not implemented on this platform\"));\n    return NULL;\n#endif\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virnuma.h\"",
            "#include \"virstring.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virfile.h\"",
            "#include \"virarch.h\"",
            "#include \"virerror.h\"",
            "#include \"virhostcpupriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/resource.h>",
            "# include <sys/sysctl.h>",
            "# include <sys/types.h>",
            "# include <sys/time.h>",
            "# include <linux/kvm.h>",
            "#include <unistd.h>",
            "# include <sys/ioctl.h>",
            "#include <fcntl.h>",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define SYSFS_SYSTEM_PATH \"/sys/devices/system\""
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virnuma.h\"\n#include \"virstring.h\"\n#include \"virtypedparam.h\"\n#include \"virfile.h\"\n#include \"virarch.h\"\n#include \"virerror.h\"\n#include \"virhostcpupriv.h\"\n#include \"viralloc.h\"\n# include <sys/resource.h>\n# include <sys/sysctl.h>\n# include <sys/types.h>\n# include <sys/time.h>\n# include <linux/kvm.h>\n#include <unistd.h>\n# include <sys/ioctl.h>\n#include <fcntl.h>\n#include <dirent.h>\n#include <config.h>\n\n#define SYSFS_SYSTEM_PATH \"/sys/devices/system\"\n\nvirBitmapPtr\nvirHostCPUGetPresentBitmap(void)\n{\n#ifdef __linux__\n    virBitmapPtr ret = NULL;\n\n    virFileReadValueBitmap(&ret, \"%s/cpu/present\", SYSFS_SYSTEM_PATH);\n\n    return ret;\n#else\n    virReportError(VIR_ERR_NO_SUPPORT, \"%s\",\n                   _(\"node present CPU map not implemented on this platform\"));\n    return NULL;\n#endif\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\n#define CGROUP_NB_PER_CPU_STAT_PARAM   1\n\nint\nvirCgroupGetPercpuStats(virCgroupPtr group,\n                        virTypedParameterPtr params,\n                        unsigned int nparams,\n                        int start_cpu,\n                        unsigned int ncpus,\n                        virBitmapPtr guestvcpus)\n{\n    int ret = -1;\n    size_t i;\n    int need_cpus, total_cpus;\n    char *pos;\n    g_autofree char *buf = NULL;\n    g_autofree unsigned long long *sum_cpu_time = NULL;\n    virTypedParameterPtr ent;\n    int param_idx;\n    unsigned long long cpu_time;\n    virBitmapPtr cpumap = NULL;\n\n    /* return the number of supported params */\n    if (nparams == 0 && ncpus != 0) {\n        if (!guestvcpus)\n            return CGROUP_NB_PER_CPU_STAT_PARAM;\n        else\n            return CGROUP_NB_PER_CPU_STAT_PARAM + 1;\n    }\n\n    /* To parse account file, we need to know how many cpus are present.  */\n    if (!(cpumap = virHostCPUGetPresentBitmap()))\n        return -1;\n\n    total_cpus = virBitmapSize(cpumap);\n\n    /* return total number of cpus */\n    if (ncpus == 0) {\n        ret = total_cpus;\n        goto cleanup;\n    }\n\n    if (start_cpu >= total_cpus) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"start_cpu %d larger than maximum of %d\"),\n                       start_cpu, total_cpus - 1);\n        goto cleanup;\n    }\n\n    /* we get percpu cputime accounting info. */\n    if (virCgroupGetCpuacctPercpuUsage(group, &buf))\n        goto cleanup;\n    pos = buf;\n\n    /* return percpu cputime in index 0 */\n    param_idx = 0;\n\n    /* number of cpus to compute */\n    need_cpus = MIN(total_cpus, start_cpu + ncpus);\n\n    for (i = 0; i < need_cpus; i++) {\n        if (!virBitmapIsBitSet(cpumap, i)) {\n            cpu_time = 0;\n        } else if (virStrToLong_ull(pos, &pos, 10, &cpu_time) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"cpuacct parse error\"));\n            goto cleanup;\n        }\n        if (i < start_cpu)\n            continue;\n        ent = &params[(i - start_cpu) * nparams + param_idx];\n        if (virTypedParameterAssign(ent, VIR_DOMAIN_CPU_STATS_CPUTIME,\n                                    VIR_TYPED_PARAM_ULLONG, cpu_time) < 0)\n            goto cleanup;\n    }\n\n    /* return percpu vcputime in index 1 */\n    param_idx = 1;\n\n    if (guestvcpus && param_idx < nparams) {\n        if (VIR_ALLOC_N(sum_cpu_time, need_cpus) < 0)\n            goto cleanup;\n        if (virCgroupGetPercpuVcpuSum(group, guestvcpus, sum_cpu_time,\n                                      need_cpus, cpumap) < 0)\n            goto cleanup;\n\n        for (i = start_cpu; i < need_cpus; i++) {\n            int idx = (i - start_cpu) * nparams + param_idx;\n            if (virTypedParameterAssign(&params[idx],\n                                        VIR_DOMAIN_CPU_STATS_VCPUTIME,\n                                        VIR_TYPED_PARAM_ULLONG,\n                                        sum_cpu_time[i]) < 0)\n                goto cleanup;\n        }\n\n        param_idx++;\n    }\n\n    ret = param_idx;\n\n cleanup:\n    virBitmapFree(cpumap);\n    return ret;\n}"
  },
  {
    "function_name": "virCgroupGetPercpuVcpuSum",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "2033-2076",
    "snippet": "static int\nvirCgroupGetPercpuVcpuSum(virCgroupPtr group,\n                          virBitmapPtr guestvcpus,\n                          unsigned long long *sum_cpu_time,\n                          size_t nsum,\n                          virBitmapPtr cpumap)\n{\n    int ret = -1;\n    ssize_t i = -1;\n    virCgroupPtr group_vcpu = NULL;\n\n    while ((i = virBitmapNextSetBit(guestvcpus, i)) >= 0) {\n        g_autofree char *buf = NULL;\n        char *pos;\n        unsigned long long tmp;\n        ssize_t j;\n\n        if (virCgroupNewThread(group, VIR_CGROUP_THREAD_VCPU, i,\n                               false, &group_vcpu) < 0)\n            goto cleanup;\n\n        if (virCgroupGetCpuacctPercpuUsage(group_vcpu, &buf) < 0)\n            goto cleanup;\n\n        pos = buf;\n        for (j = virBitmapNextSetBit(cpumap, -1);\n             j >= 0 && j < nsum;\n             j = virBitmapNextSetBit(cpumap, j)) {\n            if (virStrToLong_ull(pos, &pos, 10, &tmp) < 0) {\n                virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                               _(\"cpuacct parse error\"));\n                goto cleanup;\n            }\n            sum_cpu_time[j] += tmp;\n        }\n\n        virCgroupFree(&group_vcpu);\n    }\n\n    ret = 0;\n cleanup:\n    virCgroupFree(&group_vcpu);\n    return ret;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCgroupFree",
          "args": [
            "&group_vcpu"
          ],
          "line": 2074
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3544-3563",
          "snippet": "void\nvirCgroupFree(virCgroupPtr *group)\n{\n    size_t i;\n\n    if (*group == NULL)\n        return;\n\n    for (i = 0; i < VIR_CGROUP_CONTROLLER_LAST; i++) {\n        VIR_FREE((*group)->legacy[i].mountPoint);\n        VIR_FREE((*group)->legacy[i].linkPoint);\n        VIR_FREE((*group)->legacy[i].placement);\n    }\n\n    VIR_FREE((*group)->unified.mountPoint);\n    VIR_FREE((*group)->unified.placement);\n\n    VIR_FREE((*group)->path);\n    VIR_FREE(*group);\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nvoid\nvirCgroupFree(virCgroupPtr *group)\n{\n    size_t i;\n\n    if (*group == NULL)\n        return;\n\n    for (i = 0; i < VIR_CGROUP_CONTROLLER_LAST; i++) {\n        VIR_FREE((*group)->legacy[i].mountPoint);\n        VIR_FREE((*group)->legacy[i].linkPoint);\n        VIR_FREE((*group)->legacy[i].placement);\n    }\n\n    VIR_FREE((*group)->unified.mountPoint);\n    VIR_FREE((*group)->unified.placement);\n\n    VIR_FREE((*group)->path);\n    VIR_FREE(*group);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"cpuacct parse error\")"
          ],
          "line": 2062
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"cpuacct parse error\""
          ],
          "line": 2063
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStrToLong_ull",
          "args": [
            "pos",
            "&pos",
            "10",
            "&tmp"
          ],
          "line": 2061
        },
        "resolved": true,
        "details": {
          "function_name": "virStrToLong_ullp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "568-586",
          "snippet": "int\nvirStrToLong_ullp(char const *s, char **end_ptr, int base,\n                  unsigned long long *result)\n{\n    unsigned long long val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtoull(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToLong_ullp(char const *s, char **end_ptr, int base,\n                  unsigned long long *result)\n{\n    unsigned long long val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtoull(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBitmapNextSetBit",
          "args": [
            "cpumap",
            "j"
          ],
          "line": 2060
        },
        "resolved": true,
        "details": {
          "function_name": "virBitmapNextSetBit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
          "lines": "986-1014",
          "snippet": "ssize_t\nvirBitmapNextSetBit(virBitmapPtr bitmap,\n                    ssize_t pos)\n{\n    size_t nl;\n    size_t nb;\n    unsigned long bits;\n\n    if (pos < 0)\n        pos = -1;\n\n    pos++;\n\n    if (pos >= bitmap->nbits)\n        return -1;\n\n    nl = pos / VIR_BITMAP_BITS_PER_UNIT;\n    nb = pos % VIR_BITMAP_BITS_PER_UNIT;\n\n    bits = bitmap->map[nl] & ~((1UL << nb) - 1);\n\n    while (bits == 0 && ++nl < bitmap->map_len)\n        bits = bitmap->map[nl];\n\n    if (bits == 0)\n        return -1;\n\n    return __builtin_ffsl(bits) - 1 + nl * VIR_BITMAP_BITS_PER_UNIT;\n}",
          "includes": [
            "#include \"virerror.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbitmap.h\"",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define VIR_BITMAP_BITS_PER_UNIT  ((int) sizeof(unsigned long) * CHAR_BIT)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\n#define VIR_BITMAP_BITS_PER_UNIT  ((int) sizeof(unsigned long) * CHAR_BIT)\n\nssize_t\nvirBitmapNextSetBit(virBitmapPtr bitmap,\n                    ssize_t pos)\n{\n    size_t nl;\n    size_t nb;\n    unsigned long bits;\n\n    if (pos < 0)\n        pos = -1;\n\n    pos++;\n\n    if (pos >= bitmap->nbits)\n        return -1;\n\n    nl = pos / VIR_BITMAP_BITS_PER_UNIT;\n    nb = pos % VIR_BITMAP_BITS_PER_UNIT;\n\n    bits = bitmap->map[nl] & ~((1UL << nb) - 1);\n\n    while (bits == 0 && ++nl < bitmap->map_len)\n        bits = bitmap->map[nl];\n\n    if (bits == 0)\n        return -1;\n\n    return __builtin_ffsl(bits) - 1 + nl * VIR_BITMAP_BITS_PER_UNIT;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupGetCpuacctPercpuUsage",
          "args": [
            "group_vcpu",
            "&buf"
          ],
          "line": 2054
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupGetCpuacctPercpuUsage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3426-3433",
          "snippet": "int\nvirCgroupGetCpuacctPercpuUsage(virCgroupPtr group G_GNUC_UNUSED,\n                               char **usage G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetCpuacctPercpuUsage(virCgroupPtr group G_GNUC_UNUSED,\n                               char **usage G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupNewThread",
          "args": [
            "group",
            "VIR_CGROUP_THREAD_VCPU",
            "i",
            "false",
            "&group_vcpu"
          ],
          "line": 2050
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupNewThread",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "2825-2835",
          "snippet": "int\nvirCgroupNewThread(virCgroupPtr domain G_GNUC_UNUSED,\n                   virCgroupThreadName nameval G_GNUC_UNUSED,\n                   int id G_GNUC_UNUSED,\n                   bool create G_GNUC_UNUSED,\n                   virCgroupPtr *group G_GNUC_UNUSED)\n{\n    virReportSystemError(ENXIO, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupNewThread(virCgroupPtr domain G_GNUC_UNUSED,\n                   virCgroupThreadName nameval G_GNUC_UNUSED,\n                   int id G_GNUC_UNUSED,\n                   bool create G_GNUC_UNUSED,\n                   virCgroupPtr *group G_GNUC_UNUSED)\n{\n    virReportSystemError(ENXIO, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nstatic int\nvirCgroupGetPercpuVcpuSum(virCgroupPtr group,\n                          virBitmapPtr guestvcpus,\n                          unsigned long long *sum_cpu_time,\n                          size_t nsum,\n                          virBitmapPtr cpumap)\n{\n    int ret = -1;\n    ssize_t i = -1;\n    virCgroupPtr group_vcpu = NULL;\n\n    while ((i = virBitmapNextSetBit(guestvcpus, i)) >= 0) {\n        g_autofree char *buf = NULL;\n        char *pos;\n        unsigned long long tmp;\n        ssize_t j;\n\n        if (virCgroupNewThread(group, VIR_CGROUP_THREAD_VCPU, i,\n                               false, &group_vcpu) < 0)\n            goto cleanup;\n\n        if (virCgroupGetCpuacctPercpuUsage(group_vcpu, &buf) < 0)\n            goto cleanup;\n\n        pos = buf;\n        for (j = virBitmapNextSetBit(cpumap, -1);\n             j >= 0 && j < nsum;\n             j = virBitmapNextSetBit(cpumap, j)) {\n            if (virStrToLong_ull(pos, &pos, 10, &tmp) < 0) {\n                virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                               _(\"cpuacct parse error\"));\n                goto cleanup;\n            }\n            sum_cpu_time[j] += tmp;\n        }\n\n        virCgroupFree(&group_vcpu);\n    }\n\n    ret = 0;\n cleanup:\n    virCgroupFree(&group_vcpu);\n    return ret;\n}"
  },
  {
    "function_name": "virCgroupDenyDevicePath",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "1989-2016",
    "snippet": "int\nvirCgroupDenyDevicePath(virCgroupPtr group,\n                        const char *path,\n                        int perms,\n                        bool ignoreEacces)\n{\n    struct stat sb;\n\n    if (stat(path, &sb) < 0) {\n        if (errno == EACCES && ignoreEacces)\n            return 1;\n\n        virReportSystemError(errno,\n                             _(\"Path '%s' is not accessible\"),\n                             path);\n        return -1;\n    }\n\n    if (!S_ISCHR(sb.st_mode) && !S_ISBLK(sb.st_mode))\n        return 1;\n\n    VIR_CGROUP_BACKEND_CALL(group, VIR_CGROUP_CONTROLLER_DEVICES,\n                            denyDevice, -1,\n                            S_ISCHR(sb.st_mode) ? 'c' : 'b',\n                            major(sb.st_rdev),\n                            minor(sb.st_rdev),\n                            perms);\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_CGROUP_BACKEND_CALL",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_DEVICES",
            "denyDevice",
            "-1",
            "S_ISCHR(sb.st_mode) ? 'c' : 'b'",
            "major(sb.st_rdev)",
            "minor(sb.st_rdev)",
            "perms"
          ],
          "line": 2010
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "minor",
          "args": [
            "sb.st_rdev"
          ],
          "line": 2014
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "major",
          "args": [
            "sb.st_rdev"
          ],
          "line": 2013
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "S_ISCHR",
          "args": [
            "sb.st_mode"
          ],
          "line": 2012
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "S_ISBLK",
          "args": [
            "sb.st_mode"
          ],
          "line": 2007
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "S_ISCHR",
          "args": [
            "sb.st_mode"
          ],
          "line": 2007
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"Path '%s' is not accessible\")",
            "path"
          ],
          "line": 2001
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Path '%s' is not accessible\""
          ],
          "line": 2002
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "stat",
          "args": [
            "path",
            "&sb"
          ],
          "line": 1997
        },
        "resolved": true,
        "details": {
          "function_name": "profile_status",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_apparmor.c",
          "lines": "70-108",
          "snippet": "static int\nprofile_status(const char *str, const int check_enforcing)\n{\n    char *content = NULL;\n    char *tmp = NULL;\n    char *etmp = NULL;\n    int rc = -2;\n\n    /* create string that is '<str> \\0' for accurate matching */\n    tmp = g_strdup_printf(\"%s \", str);\n\n    if (check_enforcing != 0) {\n        /* create string that is '<str> (enforce)\\0' for accurate matching */\n        etmp = g_strdup_printf(\"%s (enforce)\", str);\n    }\n\n    if (virFileReadAll(APPARMOR_PROFILES_PATH, MAX_FILE_LEN, &content) < 0) {\n        virReportSystemError(errno,\n                             _(\"Failed to read AppArmor profiles list \"\n                             \"\\'%s\\'\"), APPARMOR_PROFILES_PATH);\n        goto cleanup;\n    }\n\n    if (strstr(content, tmp) != NULL)\n        rc = 0;\n    else\n        rc = -1; /* return -1 if not loaded */\n    if (check_enforcing != 0) {\n        if (rc == 0 && strstr(content, etmp) != NULL)\n            rc = 1;                 /* return '1' if loaded and enforcing */\n    }\n\n    VIR_FREE(content);\n cleanup:\n    VIR_FREE(tmp);\n    VIR_FREE(etmp);\n\n    return rc;\n}",
          "includes": [
            "#include \"virmdev.h\"",
            "#include \"virscsi.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"vircommand.h\"",
            "#include \"configmake.h\"",
            "#include \"virfile.h\"",
            "#include \"virscsivhost.h\"",
            "#include \"virusb.h\"",
            "#include \"virpci.h\"",
            "#include \"viruuid.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"security_apparmor.h\"",
            "#include \"internal.h\"",
            "#include <wait.h>",
            "#include <unistd.h>",
            "#include <sys/apparmor.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virmdev.h\"\n#include \"virscsi.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"configmake.h\"\n#include \"virfile.h\"\n#include \"virscsivhost.h\"\n#include \"virusb.h\"\n#include \"virpci.h\"\n#include \"viruuid.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"security_apparmor.h\"\n#include \"internal.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/apparmor.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nprofile_status(const char *str, const int check_enforcing)\n{\n    char *content = NULL;\n    char *tmp = NULL;\n    char *etmp = NULL;\n    int rc = -2;\n\n    /* create string that is '<str> \\0' for accurate matching */\n    tmp = g_strdup_printf(\"%s \", str);\n\n    if (check_enforcing != 0) {\n        /* create string that is '<str> (enforce)\\0' for accurate matching */\n        etmp = g_strdup_printf(\"%s (enforce)\", str);\n    }\n\n    if (virFileReadAll(APPARMOR_PROFILES_PATH, MAX_FILE_LEN, &content) < 0) {\n        virReportSystemError(errno,\n                             _(\"Failed to read AppArmor profiles list \"\n                             \"\\'%s\\'\"), APPARMOR_PROFILES_PATH);\n        goto cleanup;\n    }\n\n    if (strstr(content, tmp) != NULL)\n        rc = 0;\n    else\n        rc = -1; /* return -1 if not loaded */\n    if (check_enforcing != 0) {\n        if (rc == 0 && strstr(content, etmp) != NULL)\n            rc = 1;                 /* return '1' if loaded and enforcing */\n    }\n\n    VIR_FREE(content);\n cleanup:\n    VIR_FREE(tmp);\n    VIR_FREE(etmp);\n\n    return rc;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupDenyDevicePath(virCgroupPtr group,\n                        const char *path,\n                        int perms,\n                        bool ignoreEacces)\n{\n    struct stat sb;\n\n    if (stat(path, &sb) < 0) {\n        if (errno == EACCES && ignoreEacces)\n            return 1;\n\n        virReportSystemError(errno,\n                             _(\"Path '%s' is not accessible\"),\n                             path);\n        return -1;\n    }\n\n    if (!S_ISCHR(sb.st_mode) && !S_ISBLK(sb.st_mode))\n        return 1;\n\n    VIR_CGROUP_BACKEND_CALL(group, VIR_CGROUP_CONTROLLER_DEVICES,\n                            denyDevice, -1,\n                            S_ISCHR(sb.st_mode) ? 'c' : 'b',\n                            major(sb.st_rdev),\n                            minor(sb.st_rdev),\n                            perms);\n}"
  },
  {
    "function_name": "virCgroupDenyDevice",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "1966-1972",
    "snippet": "int\nvirCgroupDenyDevice(virCgroupPtr group, char type, int major, int minor,\n                    int perms)\n{\n    VIR_CGROUP_BACKEND_CALL(group, VIR_CGROUP_CONTROLLER_DEVICES,\n                            denyDevice, -1, type, major, minor, perms);\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_CGROUP_BACKEND_CALL",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_DEVICES",
            "denyDevice",
            "-1",
            "type",
            "major",
            "minor",
            "perms"
          ],
          "line": 1970
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupDenyDevice(virCgroupPtr group, char type, int major, int minor,\n                    int perms)\n{\n    VIR_CGROUP_BACKEND_CALL(group, VIR_CGROUP_CONTROLLER_DEVICES,\n                            denyDevice, -1, type, major, minor, perms);\n}"
  },
  {
    "function_name": "virCgroupAllowDevicePath",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "1925-1952",
    "snippet": "int\nvirCgroupAllowDevicePath(virCgroupPtr group,\n                         const char *path,\n                         int perms,\n                         bool ignoreEacces)\n{\n    struct stat sb;\n\n    if (stat(path, &sb) < 0) {\n        if (errno == EACCES && ignoreEacces)\n            return 1;\n\n        virReportSystemError(errno,\n                             _(\"Path '%s' is not accessible\"),\n                             path);\n        return -1;\n    }\n\n    if (!S_ISCHR(sb.st_mode) && !S_ISBLK(sb.st_mode))\n        return 1;\n\n    VIR_CGROUP_BACKEND_CALL(group, VIR_CGROUP_CONTROLLER_DEVICES,\n                            allowDevice, -1,\n                            S_ISCHR(sb.st_mode) ? 'c' : 'b',\n                            major(sb.st_rdev),\n                            minor(sb.st_rdev),\n                            perms);\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_CGROUP_BACKEND_CALL",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_DEVICES",
            "allowDevice",
            "-1",
            "S_ISCHR(sb.st_mode) ? 'c' : 'b'",
            "major(sb.st_rdev)",
            "minor(sb.st_rdev)",
            "perms"
          ],
          "line": 1946
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "minor",
          "args": [
            "sb.st_rdev"
          ],
          "line": 1950
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "major",
          "args": [
            "sb.st_rdev"
          ],
          "line": 1949
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "S_ISCHR",
          "args": [
            "sb.st_mode"
          ],
          "line": 1948
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "S_ISBLK",
          "args": [
            "sb.st_mode"
          ],
          "line": 1943
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "S_ISCHR",
          "args": [
            "sb.st_mode"
          ],
          "line": 1943
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"Path '%s' is not accessible\")",
            "path"
          ],
          "line": 1937
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Path '%s' is not accessible\""
          ],
          "line": 1938
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "stat",
          "args": [
            "path",
            "&sb"
          ],
          "line": 1933
        },
        "resolved": true,
        "details": {
          "function_name": "profile_status",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_apparmor.c",
          "lines": "70-108",
          "snippet": "static int\nprofile_status(const char *str, const int check_enforcing)\n{\n    char *content = NULL;\n    char *tmp = NULL;\n    char *etmp = NULL;\n    int rc = -2;\n\n    /* create string that is '<str> \\0' for accurate matching */\n    tmp = g_strdup_printf(\"%s \", str);\n\n    if (check_enforcing != 0) {\n        /* create string that is '<str> (enforce)\\0' for accurate matching */\n        etmp = g_strdup_printf(\"%s (enforce)\", str);\n    }\n\n    if (virFileReadAll(APPARMOR_PROFILES_PATH, MAX_FILE_LEN, &content) < 0) {\n        virReportSystemError(errno,\n                             _(\"Failed to read AppArmor profiles list \"\n                             \"\\'%s\\'\"), APPARMOR_PROFILES_PATH);\n        goto cleanup;\n    }\n\n    if (strstr(content, tmp) != NULL)\n        rc = 0;\n    else\n        rc = -1; /* return -1 if not loaded */\n    if (check_enforcing != 0) {\n        if (rc == 0 && strstr(content, etmp) != NULL)\n            rc = 1;                 /* return '1' if loaded and enforcing */\n    }\n\n    VIR_FREE(content);\n cleanup:\n    VIR_FREE(tmp);\n    VIR_FREE(etmp);\n\n    return rc;\n}",
          "includes": [
            "#include \"virmdev.h\"",
            "#include \"virscsi.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"vircommand.h\"",
            "#include \"configmake.h\"",
            "#include \"virfile.h\"",
            "#include \"virscsivhost.h\"",
            "#include \"virusb.h\"",
            "#include \"virpci.h\"",
            "#include \"viruuid.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"security_apparmor.h\"",
            "#include \"internal.h\"",
            "#include <wait.h>",
            "#include <unistd.h>",
            "#include <sys/apparmor.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virmdev.h\"\n#include \"virscsi.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"configmake.h\"\n#include \"virfile.h\"\n#include \"virscsivhost.h\"\n#include \"virusb.h\"\n#include \"virpci.h\"\n#include \"viruuid.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"security_apparmor.h\"\n#include \"internal.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/apparmor.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nprofile_status(const char *str, const int check_enforcing)\n{\n    char *content = NULL;\n    char *tmp = NULL;\n    char *etmp = NULL;\n    int rc = -2;\n\n    /* create string that is '<str> \\0' for accurate matching */\n    tmp = g_strdup_printf(\"%s \", str);\n\n    if (check_enforcing != 0) {\n        /* create string that is '<str> (enforce)\\0' for accurate matching */\n        etmp = g_strdup_printf(\"%s (enforce)\", str);\n    }\n\n    if (virFileReadAll(APPARMOR_PROFILES_PATH, MAX_FILE_LEN, &content) < 0) {\n        virReportSystemError(errno,\n                             _(\"Failed to read AppArmor profiles list \"\n                             \"\\'%s\\'\"), APPARMOR_PROFILES_PATH);\n        goto cleanup;\n    }\n\n    if (strstr(content, tmp) != NULL)\n        rc = 0;\n    else\n        rc = -1; /* return -1 if not loaded */\n    if (check_enforcing != 0) {\n        if (rc == 0 && strstr(content, etmp) != NULL)\n            rc = 1;                 /* return '1' if loaded and enforcing */\n    }\n\n    VIR_FREE(content);\n cleanup:\n    VIR_FREE(tmp);\n    VIR_FREE(etmp);\n\n    return rc;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupAllowDevicePath(virCgroupPtr group,\n                         const char *path,\n                         int perms,\n                         bool ignoreEacces)\n{\n    struct stat sb;\n\n    if (stat(path, &sb) < 0) {\n        if (errno == EACCES && ignoreEacces)\n            return 1;\n\n        virReportSystemError(errno,\n                             _(\"Path '%s' is not accessible\"),\n                             path);\n        return -1;\n    }\n\n    if (!S_ISCHR(sb.st_mode) && !S_ISBLK(sb.st_mode))\n        return 1;\n\n    VIR_CGROUP_BACKEND_CALL(group, VIR_CGROUP_CONTROLLER_DEVICES,\n                            allowDevice, -1,\n                            S_ISCHR(sb.st_mode) ? 'c' : 'b',\n                            major(sb.st_rdev),\n                            minor(sb.st_rdev),\n                            perms);\n}"
  },
  {
    "function_name": "virCgroupAllowDevice",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "1902-1908",
    "snippet": "int\nvirCgroupAllowDevice(virCgroupPtr group, char type, int major, int minor,\n                     int perms)\n{\n    VIR_CGROUP_BACKEND_CALL(group, VIR_CGROUP_CONTROLLER_DEVICES,\n                            allowDevice, -1, type, major, minor, perms);\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_CGROUP_BACKEND_CALL",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_DEVICES",
            "allowDevice",
            "-1",
            "type",
            "major",
            "minor",
            "perms"
          ],
          "line": 1906
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupAllowDevice(virCgroupPtr group, char type, int major, int minor,\n                     int perms)\n{\n    VIR_CGROUP_BACKEND_CALL(group, VIR_CGROUP_CONTROLLER_DEVICES,\n                            allowDevice, -1, type, major, minor, perms);\n}"
  },
  {
    "function_name": "virCgroupAllowAllDevices",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "1883-1888",
    "snippet": "int\nvirCgroupAllowAllDevices(virCgroupPtr group, int perms)\n{\n    VIR_CGROUP_BACKEND_CALL(group, VIR_CGROUP_CONTROLLER_DEVICES,\n                            allowAllDevices, -1, perms);\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_CGROUP_BACKEND_CALL",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_DEVICES",
            "allowAllDevices",
            "-1",
            "perms"
          ],
          "line": 1886
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupAllowAllDevices(virCgroupPtr group, int perms)\n{\n    VIR_CGROUP_BACKEND_CALL(group, VIR_CGROUP_CONTROLLER_DEVICES,\n                            allowAllDevices, -1, perms);\n}"
  },
  {
    "function_name": "virCgroupDenyAllDevices",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "1862-1867",
    "snippet": "int\nvirCgroupDenyAllDevices(virCgroupPtr group)\n{\n    VIR_CGROUP_BACKEND_CALL(group, VIR_CGROUP_CONTROLLER_DEVICES,\n                            denyAllDevices, -1);\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_CGROUP_BACKEND_CALL",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_DEVICES",
            "denyAllDevices",
            "-1"
          ],
          "line": 1865
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupDenyAllDevices(virCgroupPtr group)\n{\n    VIR_CGROUP_BACKEND_CALL(group, VIR_CGROUP_CONTROLLER_DEVICES,\n                            denyAllDevices, -1);\n}"
  },
  {
    "function_name": "virCgroupGetCpusetCpus",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "1847-1852",
    "snippet": "int\nvirCgroupGetCpusetCpus(virCgroupPtr group, char **cpus)\n{\n    VIR_CGROUP_BACKEND_CALL(group, VIR_CGROUP_CONTROLLER_CPUSET,\n                            getCpusetCpus, -1, cpus);\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_CGROUP_BACKEND_CALL",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_CPUSET",
            "getCpusetCpus",
            "-1",
            "cpus"
          ],
          "line": 1850
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetCpusetCpus(virCgroupPtr group, char **cpus)\n{\n    VIR_CGROUP_BACKEND_CALL(group, VIR_CGROUP_CONTROLLER_CPUSET,\n                            getCpusetCpus, -1, cpus);\n}"
  },
  {
    "function_name": "virCgroupSetCpusetCpus",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "1831-1836",
    "snippet": "int\nvirCgroupSetCpusetCpus(virCgroupPtr group, const char *cpus)\n{\n    VIR_CGROUP_BACKEND_CALL(group, VIR_CGROUP_CONTROLLER_CPUSET,\n                            setCpusetCpus, -1, cpus);\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_CGROUP_BACKEND_CALL",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_CPUSET",
            "setCpusetCpus",
            "-1",
            "cpus"
          ],
          "line": 1834
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupSetCpusetCpus(virCgroupPtr group, const char *cpus)\n{\n    VIR_CGROUP_BACKEND_CALL(group, VIR_CGROUP_CONTROLLER_CPUSET,\n                            setCpusetCpus, -1, cpus);\n}"
  },
  {
    "function_name": "virCgroupGetCpusetMemoryMigrate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "1815-1820",
    "snippet": "int\nvirCgroupGetCpusetMemoryMigrate(virCgroupPtr group, bool *migrate)\n{\n    VIR_CGROUP_BACKEND_CALL(group, VIR_CGROUP_CONTROLLER_CPUSET,\n                            getCpusetMemoryMigrate, -1, migrate);\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_CGROUP_BACKEND_CALL",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_CPUSET",
            "getCpusetMemoryMigrate",
            "-1",
            "migrate"
          ],
          "line": 1818
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetCpusetMemoryMigrate(virCgroupPtr group, bool *migrate)\n{\n    VIR_CGROUP_BACKEND_CALL(group, VIR_CGROUP_CONTROLLER_CPUSET,\n                            getCpusetMemoryMigrate, -1, migrate);\n}"
  },
  {
    "function_name": "virCgroupSetCpusetMemoryMigrate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "1799-1804",
    "snippet": "int\nvirCgroupSetCpusetMemoryMigrate(virCgroupPtr group, bool migrate)\n{\n    VIR_CGROUP_BACKEND_CALL(group, VIR_CGROUP_CONTROLLER_CPUSET,\n                            setCpusetMemoryMigrate, -1, migrate);\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_CGROUP_BACKEND_CALL",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_CPUSET",
            "setCpusetMemoryMigrate",
            "-1",
            "migrate"
          ],
          "line": 1802
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupSetCpusetMemoryMigrate(virCgroupPtr group, bool migrate)\n{\n    VIR_CGROUP_BACKEND_CALL(group, VIR_CGROUP_CONTROLLER_CPUSET,\n                            setCpusetMemoryMigrate, -1, migrate);\n}"
  },
  {
    "function_name": "virCgroupGetCpusetMems",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "1783-1788",
    "snippet": "int\nvirCgroupGetCpusetMems(virCgroupPtr group, char **mems)\n{\n    VIR_CGROUP_BACKEND_CALL(group, VIR_CGROUP_CONTROLLER_CPUSET,\n                            getCpusetMems, -1, mems);\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_CGROUP_BACKEND_CALL",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_CPUSET",
            "getCpusetMems",
            "-1",
            "mems"
          ],
          "line": 1786
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetCpusetMems(virCgroupPtr group, char **mems)\n{\n    VIR_CGROUP_BACKEND_CALL(group, VIR_CGROUP_CONTROLLER_CPUSET,\n                            getCpusetMems, -1, mems);\n}"
  },
  {
    "function_name": "virCgroupSetCpusetMems",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "1767-1772",
    "snippet": "int\nvirCgroupSetCpusetMems(virCgroupPtr group, const char *mems)\n{\n    VIR_CGROUP_BACKEND_CALL(group, VIR_CGROUP_CONTROLLER_CPUSET,\n                            setCpusetMems, -1, mems);\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_CGROUP_BACKEND_CALL",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_CPUSET",
            "setCpusetMems",
            "-1",
            "mems"
          ],
          "line": 1770
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupSetCpusetMems(virCgroupPtr group, const char *mems)\n{\n    VIR_CGROUP_BACKEND_CALL(group, VIR_CGROUP_CONTROLLER_CPUSET,\n                            setCpusetMems, -1, mems);\n}"
  },
  {
    "function_name": "virCgroupGetMemSwapUsage",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "1751-1756",
    "snippet": "int\nvirCgroupGetMemSwapUsage(virCgroupPtr group, unsigned long long *kb)\n{\n    VIR_CGROUP_BACKEND_CALL(group, VIR_CGROUP_CONTROLLER_MEMORY,\n                            getMemSwapUsage, -1, kb);\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_CGROUP_BACKEND_CALL",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_MEMORY",
            "getMemSwapUsage",
            "-1",
            "kb"
          ],
          "line": 1754
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetMemSwapUsage(virCgroupPtr group, unsigned long long *kb)\n{\n    VIR_CGROUP_BACKEND_CALL(group, VIR_CGROUP_CONTROLLER_MEMORY,\n                            getMemSwapUsage, -1, kb);\n}"
  },
  {
    "function_name": "virCgroupGetMemSwapHardLimit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "1735-1740",
    "snippet": "int\nvirCgroupGetMemSwapHardLimit(virCgroupPtr group, unsigned long long *kb)\n{\n    VIR_CGROUP_BACKEND_CALL(group, VIR_CGROUP_CONTROLLER_MEMORY,\n                            getMemSwapHardLimit, -1, kb);\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_CGROUP_BACKEND_CALL",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_MEMORY",
            "getMemSwapHardLimit",
            "-1",
            "kb"
          ],
          "line": 1738
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetMemSwapHardLimit(virCgroupPtr group, unsigned long long *kb)\n{\n    VIR_CGROUP_BACKEND_CALL(group, VIR_CGROUP_CONTROLLER_MEMORY,\n                            getMemSwapHardLimit, -1, kb);\n}"
  },
  {
    "function_name": "virCgroupSetMemSwapHardLimit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "1719-1724",
    "snippet": "int\nvirCgroupSetMemSwapHardLimit(virCgroupPtr group, unsigned long long kb)\n{\n    VIR_CGROUP_BACKEND_CALL(group, VIR_CGROUP_CONTROLLER_MEMORY,\n                            setMemSwapHardLimit, -1, kb);\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_CGROUP_BACKEND_CALL",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_MEMORY",
            "setMemSwapHardLimit",
            "-1",
            "kb"
          ],
          "line": 1722
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupSetMemSwapHardLimit(virCgroupPtr group, unsigned long long kb)\n{\n    VIR_CGROUP_BACKEND_CALL(group, VIR_CGROUP_CONTROLLER_MEMORY,\n                            setMemSwapHardLimit, -1, kb);\n}"
  },
  {
    "function_name": "virCgroupGetMemorySoftLimit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "1703-1708",
    "snippet": "int\nvirCgroupGetMemorySoftLimit(virCgroupPtr group, unsigned long long *kb)\n{\n    VIR_CGROUP_BACKEND_CALL(group, VIR_CGROUP_CONTROLLER_MEMORY,\n                            getMemorySoftLimit, -1, kb);\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_CGROUP_BACKEND_CALL",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_MEMORY",
            "getMemorySoftLimit",
            "-1",
            "kb"
          ],
          "line": 1706
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetMemorySoftLimit(virCgroupPtr group, unsigned long long *kb)\n{\n    VIR_CGROUP_BACKEND_CALL(group, VIR_CGROUP_CONTROLLER_MEMORY,\n                            getMemorySoftLimit, -1, kb);\n}"
  },
  {
    "function_name": "virCgroupSetMemorySoftLimit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "1687-1692",
    "snippet": "int\nvirCgroupSetMemorySoftLimit(virCgroupPtr group, unsigned long long kb)\n{\n    VIR_CGROUP_BACKEND_CALL(group, VIR_CGROUP_CONTROLLER_MEMORY,\n                            setMemorySoftLimit, -1, kb);\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_CGROUP_BACKEND_CALL",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_MEMORY",
            "setMemorySoftLimit",
            "-1",
            "kb"
          ],
          "line": 1690
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupSetMemorySoftLimit(virCgroupPtr group, unsigned long long kb)\n{\n    VIR_CGROUP_BACKEND_CALL(group, VIR_CGROUP_CONTROLLER_MEMORY,\n                            setMemorySoftLimit, -1, kb);\n}"
  },
  {
    "function_name": "virCgroupGetMemoryHardLimit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "1671-1676",
    "snippet": "int\nvirCgroupGetMemoryHardLimit(virCgroupPtr group, unsigned long long *kb)\n{\n    VIR_CGROUP_BACKEND_CALL(group, VIR_CGROUP_CONTROLLER_MEMORY,\n                            getMemoryHardLimit, -1, kb);\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_CGROUP_BACKEND_CALL",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_MEMORY",
            "getMemoryHardLimit",
            "-1",
            "kb"
          ],
          "line": 1674
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetMemoryHardLimit(virCgroupPtr group, unsigned long long *kb)\n{\n    VIR_CGROUP_BACKEND_CALL(group, VIR_CGROUP_CONTROLLER_MEMORY,\n                            getMemoryHardLimit, -1, kb);\n}"
  },
  {
    "function_name": "virCgroupSetMemoryHardLimit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "1655-1660",
    "snippet": "int\nvirCgroupSetMemoryHardLimit(virCgroupPtr group, unsigned long long kb)\n{\n    VIR_CGROUP_BACKEND_CALL(group, VIR_CGROUP_CONTROLLER_MEMORY,\n                            setMemoryHardLimit, -1, kb);\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_CGROUP_BACKEND_CALL",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_MEMORY",
            "setMemoryHardLimit",
            "-1",
            "kb"
          ],
          "line": 1658
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupSetMemoryHardLimit(virCgroupPtr group, unsigned long long kb)\n{\n    VIR_CGROUP_BACKEND_CALL(group, VIR_CGROUP_CONTROLLER_MEMORY,\n                            setMemoryHardLimit, -1, kb);\n}"
  },
  {
    "function_name": "virCgroupGetMemoryUsage",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "1639-1644",
    "snippet": "int\nvirCgroupGetMemoryUsage(virCgroupPtr group, unsigned long *kb)\n{\n    VIR_CGROUP_BACKEND_CALL(group, VIR_CGROUP_CONTROLLER_MEMORY,\n                            getMemoryUsage, -1, kb);\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_CGROUP_BACKEND_CALL",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_MEMORY",
            "getMemoryUsage",
            "-1",
            "kb"
          ],
          "line": 1642
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetMemoryUsage(virCgroupPtr group, unsigned long *kb)\n{\n    VIR_CGROUP_BACKEND_CALL(group, VIR_CGROUP_CONTROLLER_MEMORY,\n                            getMemoryUsage, -1, kb);\n}"
  },
  {
    "function_name": "virCgroupGetMemoryStat",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "1614-1628",
    "snippet": "int\nvirCgroupGetMemoryStat(virCgroupPtr group,\n                       unsigned long long *cache,\n                       unsigned long long *activeAnon,\n                       unsigned long long *inactiveAnon,\n                       unsigned long long *activeFile,\n                       unsigned long long *inactiveFile,\n                       unsigned long long *unevictable)\n{\n    VIR_CGROUP_BACKEND_CALL(group, VIR_CGROUP_CONTROLLER_MEMORY,\n                            getMemoryStat, -1, cache,\n                            activeAnon, inactiveAnon,\n                            activeFile, inactiveFile,\n                            unevictable);\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_CGROUP_BACKEND_CALL",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_MEMORY",
            "getMemoryStat",
            "-1",
            "cache",
            "activeAnon",
            "inactiveAnon",
            "activeFile",
            "inactiveFile",
            "unevictable"
          ],
          "line": 1623
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetMemoryStat(virCgroupPtr group,\n                       unsigned long long *cache,\n                       unsigned long long *activeAnon,\n                       unsigned long long *inactiveAnon,\n                       unsigned long long *activeFile,\n                       unsigned long long *inactiveFile,\n                       unsigned long long *unevictable)\n{\n    VIR_CGROUP_BACKEND_CALL(group, VIR_CGROUP_CONTROLLER_MEMORY,\n                            getMemoryStat, -1, cache,\n                            activeAnon, inactiveAnon,\n                            activeFile, inactiveFile,\n                            unevictable);\n}"
  },
  {
    "function_name": "virCgroupSetMemory",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "1593-1598",
    "snippet": "int\nvirCgroupSetMemory(virCgroupPtr group, unsigned long long kb)\n{\n    VIR_CGROUP_BACKEND_CALL(group, VIR_CGROUP_CONTROLLER_MEMORY,\n                            setMemory, -1, kb);\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_CGROUP_BACKEND_CALL",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_MEMORY",
            "setMemory",
            "-1",
            "kb"
          ],
          "line": 1596
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupSetMemory(virCgroupPtr group, unsigned long long kb)\n{\n    VIR_CGROUP_BACKEND_CALL(group, VIR_CGROUP_CONTROLLER_MEMORY,\n                            setMemory, -1, kb);\n}"
  },
  {
    "function_name": "virCgroupGetBlkioDeviceWeight",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "1575-1582",
    "snippet": "static int\nvirCgroupGetBlkioDeviceWeight(virCgroupPtr group,\n                              const char *path,\n                              unsigned int *weight)\n{\n    VIR_CGROUP_BACKEND_CALL(group, VIR_CGROUP_CONTROLLER_BLKIO,\n                            getBlkioDeviceWeight, -1, path, weight);\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_CGROUP_BACKEND_CALL",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_BLKIO",
            "getBlkioDeviceWeight",
            "-1",
            "path",
            "weight"
          ],
          "line": 1580
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nstatic int\nvirCgroupGetBlkioDeviceWeight(virCgroupPtr group,\n                              const char *path,\n                              unsigned int *weight)\n{\n    VIR_CGROUP_BACKEND_CALL(group, VIR_CGROUP_CONTROLLER_BLKIO,\n                            getBlkioDeviceWeight, -1, path, weight);\n}"
  },
  {
    "function_name": "virCgroupGetBlkioDeviceWriteBps",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "1558-1565",
    "snippet": "static int\nvirCgroupGetBlkioDeviceWriteBps(virCgroupPtr group,\n                                const char *path,\n                                unsigned long long *wbps)\n{\n    VIR_CGROUP_BACKEND_CALL(group, VIR_CGROUP_CONTROLLER_BLKIO,\n                            getBlkioDeviceWriteBps, -1, path, wbps);\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_CGROUP_BACKEND_CALL",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_BLKIO",
            "getBlkioDeviceWriteBps",
            "-1",
            "path",
            "wbps"
          ],
          "line": 1563
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nstatic int\nvirCgroupGetBlkioDeviceWriteBps(virCgroupPtr group,\n                                const char *path,\n                                unsigned long long *wbps)\n{\n    VIR_CGROUP_BACKEND_CALL(group, VIR_CGROUP_CONTROLLER_BLKIO,\n                            getBlkioDeviceWriteBps, -1, path, wbps);\n}"
  },
  {
    "function_name": "virCgroupGetBlkioDeviceReadBps",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "1541-1548",
    "snippet": "static int\nvirCgroupGetBlkioDeviceReadBps(virCgroupPtr group,\n                               const char *path,\n                               unsigned long long *rbps)\n{\n    VIR_CGROUP_BACKEND_CALL(group, VIR_CGROUP_CONTROLLER_BLKIO,\n                            getBlkioDeviceReadBps, -1, path, rbps);\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_CGROUP_BACKEND_CALL",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_BLKIO",
            "getBlkioDeviceReadBps",
            "-1",
            "path",
            "rbps"
          ],
          "line": 1546
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nstatic int\nvirCgroupGetBlkioDeviceReadBps(virCgroupPtr group,\n                               const char *path,\n                               unsigned long long *rbps)\n{\n    VIR_CGROUP_BACKEND_CALL(group, VIR_CGROUP_CONTROLLER_BLKIO,\n                            getBlkioDeviceReadBps, -1, path, rbps);\n}"
  },
  {
    "function_name": "virCgroupGetBlkioDeviceWriteIops",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "1524-1531",
    "snippet": "static int\nvirCgroupGetBlkioDeviceWriteIops(virCgroupPtr group,\n                                 const char *path,\n                                 unsigned int *wiops)\n{\n    VIR_CGROUP_BACKEND_CALL(group, VIR_CGROUP_CONTROLLER_BLKIO,\n                            getBlkioDeviceWriteIops, -1, path, wiops);\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_CGROUP_BACKEND_CALL",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_BLKIO",
            "getBlkioDeviceWriteIops",
            "-1",
            "path",
            "wiops"
          ],
          "line": 1529
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nstatic int\nvirCgroupGetBlkioDeviceWriteIops(virCgroupPtr group,\n                                 const char *path,\n                                 unsigned int *wiops)\n{\n    VIR_CGROUP_BACKEND_CALL(group, VIR_CGROUP_CONTROLLER_BLKIO,\n                            getBlkioDeviceWriteIops, -1, path, wiops);\n}"
  },
  {
    "function_name": "virCgroupGetBlkioDeviceReadIops",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "1507-1514",
    "snippet": "static int\nvirCgroupGetBlkioDeviceReadIops(virCgroupPtr group,\n                                const char *path,\n                                unsigned int *riops)\n{\n    VIR_CGROUP_BACKEND_CALL(group, VIR_CGROUP_CONTROLLER_BLKIO,\n                            getBlkioDeviceReadIops, -1, path, riops);\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_CGROUP_BACKEND_CALL",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_BLKIO",
            "getBlkioDeviceReadIops",
            "-1",
            "path",
            "riops"
          ],
          "line": 1512
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nstatic int\nvirCgroupGetBlkioDeviceReadIops(virCgroupPtr group,\n                                const char *path,\n                                unsigned int *riops)\n{\n    VIR_CGROUP_BACKEND_CALL(group, VIR_CGROUP_CONTROLLER_BLKIO,\n                            getBlkioDeviceReadIops, -1, path, riops);\n}"
  },
  {
    "function_name": "virCgroupSetBlkioDeviceWeight",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "1490-1497",
    "snippet": "static int\nvirCgroupSetBlkioDeviceWeight(virCgroupPtr group,\n                              const char *path,\n                              unsigned int weight)\n{\n    VIR_CGROUP_BACKEND_CALL(group, VIR_CGROUP_CONTROLLER_BLKIO,\n                            setBlkioDeviceWeight, -1, path, weight);\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_CGROUP_BACKEND_CALL",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_BLKIO",
            "setBlkioDeviceWeight",
            "-1",
            "path",
            "weight"
          ],
          "line": 1495
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nstatic int\nvirCgroupSetBlkioDeviceWeight(virCgroupPtr group,\n                              const char *path,\n                              unsigned int weight)\n{\n    VIR_CGROUP_BACKEND_CALL(group, VIR_CGROUP_CONTROLLER_BLKIO,\n                            setBlkioDeviceWeight, -1, path, weight);\n}"
  },
  {
    "function_name": "virCgroupSetBlkioDeviceWriteBps",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "1471-1478",
    "snippet": "static int\nvirCgroupSetBlkioDeviceWriteBps(virCgroupPtr group,\n                                const char *path,\n                                unsigned long long wbps)\n{\n    VIR_CGROUP_BACKEND_CALL(group, VIR_CGROUP_CONTROLLER_BLKIO,\n                            setBlkioDeviceWriteBps, -1, path, wbps);\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_CGROUP_BACKEND_CALL",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_BLKIO",
            "setBlkioDeviceWriteBps",
            "-1",
            "path",
            "wbps"
          ],
          "line": 1476
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nstatic int\nvirCgroupSetBlkioDeviceWriteBps(virCgroupPtr group,\n                                const char *path,\n                                unsigned long long wbps)\n{\n    VIR_CGROUP_BACKEND_CALL(group, VIR_CGROUP_CONTROLLER_BLKIO,\n                            setBlkioDeviceWriteBps, -1, path, wbps);\n}"
  },
  {
    "function_name": "virCgroupSetBlkioDeviceReadBps",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "1454-1461",
    "snippet": "static int\nvirCgroupSetBlkioDeviceReadBps(virCgroupPtr group,\n                               const char *path,\n                               unsigned long long rbps)\n{\n    VIR_CGROUP_BACKEND_CALL(group, VIR_CGROUP_CONTROLLER_BLKIO,\n                            setBlkioDeviceReadBps, -1, path, rbps);\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_CGROUP_BACKEND_CALL",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_BLKIO",
            "setBlkioDeviceReadBps",
            "-1",
            "path",
            "rbps"
          ],
          "line": 1459
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nstatic int\nvirCgroupSetBlkioDeviceReadBps(virCgroupPtr group,\n                               const char *path,\n                               unsigned long long rbps)\n{\n    VIR_CGROUP_BACKEND_CALL(group, VIR_CGROUP_CONTROLLER_BLKIO,\n                            setBlkioDeviceReadBps, -1, path, rbps);\n}"
  },
  {
    "function_name": "virCgroupSetBlkioDeviceWriteIops",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "1436-1443",
    "snippet": "static int\nvirCgroupSetBlkioDeviceWriteIops(virCgroupPtr group,\n                                 const char *path,\n                                 unsigned int wiops)\n{\n    VIR_CGROUP_BACKEND_CALL(group, VIR_CGROUP_CONTROLLER_BLKIO,\n                            setBlkioDeviceWriteIops, -1, path, wiops);\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_CGROUP_BACKEND_CALL",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_BLKIO",
            "setBlkioDeviceWriteIops",
            "-1",
            "path",
            "wiops"
          ],
          "line": 1441
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nstatic int\nvirCgroupSetBlkioDeviceWriteIops(virCgroupPtr group,\n                                 const char *path,\n                                 unsigned int wiops)\n{\n    VIR_CGROUP_BACKEND_CALL(group, VIR_CGROUP_CONTROLLER_BLKIO,\n                            setBlkioDeviceWriteIops, -1, path, wiops);\n}"
  },
  {
    "function_name": "virCgroupSetBlkioDeviceReadIops",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "1418-1425",
    "snippet": "static int\nvirCgroupSetBlkioDeviceReadIops(virCgroupPtr group,\n                                const char *path,\n                                unsigned int riops)\n{\n    VIR_CGROUP_BACKEND_CALL(group, VIR_CGROUP_CONTROLLER_BLKIO,\n                            setBlkioDeviceReadIops, -1, path, riops);\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_CGROUP_BACKEND_CALL",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_BLKIO",
            "setBlkioDeviceReadIops",
            "-1",
            "path",
            "riops"
          ],
          "line": 1423
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nstatic int\nvirCgroupSetBlkioDeviceReadIops(virCgroupPtr group,\n                                const char *path,\n                                unsigned int riops)\n{\n    VIR_CGROUP_BACKEND_CALL(group, VIR_CGROUP_CONTROLLER_BLKIO,\n                            setBlkioDeviceReadIops, -1, path, riops);\n}"
  },
  {
    "function_name": "virCgroupGetBlkioWeight",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "1403-1408",
    "snippet": "int\nvirCgroupGetBlkioWeight(virCgroupPtr group, unsigned int *weight)\n{\n    VIR_CGROUP_BACKEND_CALL(group, VIR_CGROUP_CONTROLLER_BLKIO,\n                            getBlkioWeight, -1, weight);\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_CGROUP_BACKEND_CALL",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_BLKIO",
            "getBlkioWeight",
            "-1",
            "weight"
          ],
          "line": 1406
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetBlkioWeight(virCgroupPtr group, unsigned int *weight)\n{\n    VIR_CGROUP_BACKEND_CALL(group, VIR_CGROUP_CONTROLLER_BLKIO,\n                            getBlkioWeight, -1, weight);\n}"
  },
  {
    "function_name": "virCgroupSetBlkioWeight",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "1387-1392",
    "snippet": "int\nvirCgroupSetBlkioWeight(virCgroupPtr group, unsigned int weight)\n{\n    VIR_CGROUP_BACKEND_CALL(group, VIR_CGROUP_CONTROLLER_BLKIO,\n                            setBlkioWeight, -1, weight);\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_CGROUP_BACKEND_CALL",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_BLKIO",
            "setBlkioWeight",
            "-1",
            "weight"
          ],
          "line": 1390
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupSetBlkioWeight(virCgroupPtr group, unsigned int weight)\n{\n    VIR_CGROUP_BACKEND_CALL(group, VIR_CGROUP_CONTROLLER_BLKIO,\n                            setBlkioWeight, -1, weight);\n}"
  },
  {
    "function_name": "virCgroupGetBlkioIoDeviceServiced",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "1364-1376",
    "snippet": "int\nvirCgroupGetBlkioIoDeviceServiced(virCgroupPtr group,\n                                  const char *path,\n                                  long long *bytes_read,\n                                  long long *bytes_write,\n                                  long long *requests_read,\n                                  long long *requests_write)\n{\n    VIR_CGROUP_BACKEND_CALL(group, VIR_CGROUP_CONTROLLER_BLKIO,\n                            getBlkioIoDeviceServiced, -1,\n                            path, bytes_read, bytes_write,\n                            requests_read, requests_write);\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_CGROUP_BACKEND_CALL",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_BLKIO",
            "getBlkioIoDeviceServiced",
            "-1",
            "path",
            "bytes_read",
            "bytes_write",
            "requests_read",
            "requests_write"
          ],
          "line": 1372
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetBlkioIoDeviceServiced(virCgroupPtr group,\n                                  const char *path,\n                                  long long *bytes_read,\n                                  long long *bytes_write,\n                                  long long *requests_read,\n                                  long long *requests_write)\n{\n    VIR_CGROUP_BACKEND_CALL(group, VIR_CGROUP_CONTROLLER_BLKIO,\n                            getBlkioIoDeviceServiced, -1,\n                            path, bytes_read, bytes_write,\n                            requests_read, requests_write);\n}"
  },
  {
    "function_name": "virCgroupGetBlkioIoServiced",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "1338-1349",
    "snippet": "int\nvirCgroupGetBlkioIoServiced(virCgroupPtr group,\n                            long long *bytes_read,\n                            long long *bytes_write,\n                            long long *requests_read,\n                            long long *requests_write)\n{\n    VIR_CGROUP_BACKEND_CALL(group, VIR_CGROUP_CONTROLLER_BLKIO,\n                            getBlkioIoServiced, -1,\n                            bytes_read, bytes_write,\n                            requests_read, requests_write);\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_CGROUP_BACKEND_CALL",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_BLKIO",
            "getBlkioIoServiced",
            "-1",
            "bytes_read",
            "bytes_write",
            "requests_read",
            "requests_write"
          ],
          "line": 1345
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetBlkioIoServiced(virCgroupPtr group,\n                            long long *bytes_read,\n                            long long *bytes_write,\n                            long long *requests_read,\n                            long long *requests_write)\n{\n    VIR_CGROUP_BACKEND_CALL(group, VIR_CGROUP_CONTROLLER_BLKIO,\n                            getBlkioIoServiced, -1,\n                            bytes_read, bytes_write,\n                            requests_read, requests_write);\n}"
  },
  {
    "function_name": "virCgroupPathOfController",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "1310-1324",
    "snippet": "int\nvirCgroupPathOfController(virCgroupPtr group,\n                          unsigned int controller,\n                          const char *key,\n                          char **path)\n{\n    if (controller >= VIR_CGROUP_CONTROLLER_LAST) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Invalid controller id '%d'\"), controller);\n        return -1;\n    }\n\n    VIR_CGROUP_BACKEND_CALL(group, controller, pathOfController, -1,\n                            controller, key, path);\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_CGROUP_BACKEND_CALL",
          "args": [
            "group",
            "controller",
            "pathOfController",
            "-1",
            "controller",
            "key",
            "path"
          ],
          "line": 1322
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Invalid controller id '%d'\")",
            "controller"
          ],
          "line": 1317
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Invalid controller id '%d'\""
          ],
          "line": 1318
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupPathOfController(virCgroupPtr group,\n                          unsigned int controller,\n                          const char *key,\n                          char **path)\n{\n    if (controller >= VIR_CGROUP_CONTROLLER_LAST) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Invalid controller id '%d'\"), controller);\n        return -1;\n    }\n\n    VIR_CGROUP_BACKEND_CALL(group, controller, pathOfController, -1,\n                            controller, key, path);\n}"
  },
  {
    "function_name": "virCgroupHasController",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "1289-1307",
    "snippet": "bool\nvirCgroupHasController(virCgroupPtr cgroup, int controller)\n{\n    size_t i;\n\n    if (!cgroup)\n        return false;\n    if (controller < 0 || controller >= VIR_CGROUP_CONTROLLER_LAST)\n        return false;\n\n    for (i = 0; i < VIR_CGROUP_BACKEND_TYPE_LAST; i++) {\n        if (cgroup->backends[i] &&\n            cgroup->backends[i]->hasController(cgroup, controller)) {\n            return true;\n        }\n    }\n\n    return false;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cgroup->backends[i]->hasController",
          "args": [
            "cgroup",
            "controller"
          ],
          "line": 1301
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nbool\nvirCgroupHasController(virCgroupPtr cgroup, int controller)\n{\n    size_t i;\n\n    if (!cgroup)\n        return false;\n    if (controller < 0 || controller >= VIR_CGROUP_CONTROLLER_LAST)\n        return false;\n\n    for (i = 0; i < VIR_CGROUP_BACKEND_TYPE_LAST; i++) {\n        if (cgroup->backends[i] &&\n            cgroup->backends[i]->hasController(cgroup, controller)) {\n            return true;\n        }\n    }\n\n    return false;\n}"
  },
  {
    "function_name": "virCgroupNewIgnoreError",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "1266-1277",
    "snippet": "bool\nvirCgroupNewIgnoreError(void)\n{\n    if (virLastErrorIsSystemErrno(ENXIO) ||\n        virLastErrorIsSystemErrno(EPERM) ||\n        virLastErrorIsSystemErrno(EACCES)) {\n        virResetLastError();\n        VIR_DEBUG(\"No cgroups present/configured/accessible, ignoring error\");\n        return true;\n    }\n    return false;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"No cgroups present/configured/accessible, ignoring error\""
          ],
          "line": 1273
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 1272
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLastErrorIsSystemErrno",
          "args": [
            "EACCES"
          ],
          "line": 1271
        },
        "resolved": true,
        "details": {
          "function_name": "virLastErrorIsSystemErrno",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "1432-1442",
          "snippet": "bool virLastErrorIsSystemErrno(int errnum)\n{\n    virErrorPtr err = virGetLastError();\n    if (!err)\n        return false;\n    if (err->code != VIR_ERR_SYSTEM_ERROR)\n        return false;\n    if (errnum != 0 && err->int1 != errnum)\n        return false;\n    return true;\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nbool virLastErrorIsSystemErrno(int errnum)\n{\n    virErrorPtr err = virGetLastError();\n    if (!err)\n        return false;\n    if (err->code != VIR_ERR_SYSTEM_ERROR)\n        return false;\n    if (errnum != 0 && err->int1 != errnum)\n        return false;\n    return true;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nbool\nvirCgroupNewIgnoreError(void)\n{\n    if (virLastErrorIsSystemErrno(ENXIO) ||\n        virLastErrorIsSystemErrno(EPERM) ||\n        virLastErrorIsSystemErrno(EACCES)) {\n        virResetLastError();\n        VIR_DEBUG(\"No cgroups present/configured/accessible, ignoring error\");\n        return true;\n    }\n    return false;\n}"
  },
  {
    "function_name": "virCgroupNewMachine",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "1222-1263",
    "snippet": "int\nvirCgroupNewMachine(const char *name,\n                    const char *drivername,\n                    const unsigned char *uuid,\n                    const char *rootdir,\n                    pid_t pidleader,\n                    bool isContainer,\n                    size_t nnicindexes,\n                    int *nicindexes,\n                    const char *partition,\n                    int controllers,\n                    unsigned int maxthreads,\n                    virCgroupPtr *group)\n{\n    int rv;\n\n    *group = NULL;\n\n    if ((rv = virCgroupNewMachineSystemd(name,\n                                         drivername,\n                                         uuid,\n                                         rootdir,\n                                         pidleader,\n                                         isContainer,\n                                         nnicindexes,\n                                         nicindexes,\n                                         partition,\n                                         controllers,\n                                         maxthreads,\n                                         group)) == 0)\n        return 0;\n\n    if (rv == -1)\n        return -1;\n\n    return virCgroupNewMachineManual(name,\n                                     drivername,\n                                     pidleader,\n                                     partition,\n                                     controllers,\n                                     group);\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCgroupNewMachineManual",
          "args": [
            "name",
            "drivername",
            "pidleader",
            "partition",
            "controllers",
            "group"
          ],
          "line": 1257
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupNewMachineManual",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "1175-1219",
          "snippet": "static int\nvirCgroupNewMachineManual(const char *name,\n                          const char *drivername,\n                          pid_t pidleader,\n                          const char *partition,\n                          int controllers,\n                          virCgroupPtr *group)\n{\n    virCgroupPtr parent = NULL;\n    int ret = -1;\n\n    VIR_DEBUG(\"Fallback to non-systemd setup\");\n    if (virCgroupNewPartition(partition,\n                              STREQ(partition, \"/machine\"),\n                              controllers,\n                              &parent) < 0) {\n        if (virCgroupNewIgnoreError())\n            goto done;\n\n        goto cleanup;\n    }\n\n    if (virCgroupNewDomainPartition(parent,\n                                    drivername,\n                                    name,\n                                    true,\n                                    group) < 0)\n        goto cleanup;\n\n    if (virCgroupAddProcess(*group, pidleader) < 0) {\n        virErrorPtr saved;\n\n        virErrorPreserveLast(&saved);\n        virCgroupRemove(*group);\n        virCgroupFree(group);\n        virErrorRestore(&saved);\n    }\n\n done:\n    ret = 0;\n\n cleanup:\n    virCgroupFree(&parent);\n    return ret;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nstatic int\nvirCgroupNewMachineManual(const char *name,\n                          const char *drivername,\n                          pid_t pidleader,\n                          const char *partition,\n                          int controllers,\n                          virCgroupPtr *group)\n{\n    virCgroupPtr parent = NULL;\n    int ret = -1;\n\n    VIR_DEBUG(\"Fallback to non-systemd setup\");\n    if (virCgroupNewPartition(partition,\n                              STREQ(partition, \"/machine\"),\n                              controllers,\n                              &parent) < 0) {\n        if (virCgroupNewIgnoreError())\n            goto done;\n\n        goto cleanup;\n    }\n\n    if (virCgroupNewDomainPartition(parent,\n                                    drivername,\n                                    name,\n                                    true,\n                                    group) < 0)\n        goto cleanup;\n\n    if (virCgroupAddProcess(*group, pidleader) < 0) {\n        virErrorPtr saved;\n\n        virErrorPreserveLast(&saved);\n        virCgroupRemove(*group);\n        virCgroupFree(group);\n        virErrorRestore(&saved);\n    }\n\n done:\n    ret = 0;\n\n cleanup:\n    virCgroupFree(&parent);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupNewMachineSystemd",
          "args": [
            "name",
            "drivername",
            "uuid",
            "rootdir",
            "pidleader",
            "isContainer",
            "nnicindexes",
            "nicindexes",
            "partition",
            "controllers",
            "maxthreads",
            "group"
          ],
          "line": 1240
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupNewMachineSystemd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "1093-1163",
          "snippet": "static int\nvirCgroupNewMachineSystemd(const char *name,\n                           const char *drivername,\n                           const unsigned char *uuid,\n                           const char *rootdir,\n                           pid_t pidleader,\n                           bool isContainer,\n                           size_t nnicindexes,\n                           int *nicindexes,\n                           const char *partition,\n                           int controllers,\n                           unsigned int maxthreads,\n                           virCgroupPtr *group)\n{\n    int rv;\n    virCgroupPtr init;\n    g_autofree char *path = NULL;\n    size_t i;\n\n    VIR_DEBUG(\"Trying to setup machine '%s' via systemd\", name);\n    if ((rv = virSystemdCreateMachine(name,\n                                      drivername,\n                                      uuid,\n                                      rootdir,\n                                      pidleader,\n                                      isContainer,\n                                      nnicindexes,\n                                      nicindexes,\n                                      partition,\n                                      maxthreads)) < 0)\n        return rv;\n\n    if (controllers != -1)\n        controllers |= (1 << VIR_CGROUP_CONTROLLER_SYSTEMD);\n\n    VIR_DEBUG(\"Detecting systemd placement\");\n    if (virCgroupNewDetect(pidleader,\n                           controllers,\n                           &init) < 0)\n        return -1;\n\n    for (i = 0; i < VIR_CGROUP_BACKEND_TYPE_LAST; i++) {\n        if (init->backends[i] &&\n            (path = init->backends[i]->stealPlacement(init))) {\n            break;\n        }\n    }\n    virCgroupFree(&init);\n\n    if (!path || STREQ(path, \"/\") || path[0] != '/') {\n        VIR_DEBUG(\"Systemd didn't setup its controller, path=%s\",\n                  NULLSTR(path));\n        return -2;\n    }\n\n    if (virCgroupEnableMissingControllers(path, pidleader,\n                                          controllers, group) < 0) {\n        return -1;\n    }\n\n    if (virCgroupAddProcess(*group, pidleader) < 0) {\n        virErrorPtr saved;\n\n        virErrorPreserveLast(&saved);\n        virCgroupRemove(*group);\n        virCgroupFree(group);\n        virErrorRestore(&saved);\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nstatic int\nvirCgroupNewMachineSystemd(const char *name,\n                           const char *drivername,\n                           const unsigned char *uuid,\n                           const char *rootdir,\n                           pid_t pidleader,\n                           bool isContainer,\n                           size_t nnicindexes,\n                           int *nicindexes,\n                           const char *partition,\n                           int controllers,\n                           unsigned int maxthreads,\n                           virCgroupPtr *group)\n{\n    int rv;\n    virCgroupPtr init;\n    g_autofree char *path = NULL;\n    size_t i;\n\n    VIR_DEBUG(\"Trying to setup machine '%s' via systemd\", name);\n    if ((rv = virSystemdCreateMachine(name,\n                                      drivername,\n                                      uuid,\n                                      rootdir,\n                                      pidleader,\n                                      isContainer,\n                                      nnicindexes,\n                                      nicindexes,\n                                      partition,\n                                      maxthreads)) < 0)\n        return rv;\n\n    if (controllers != -1)\n        controllers |= (1 << VIR_CGROUP_CONTROLLER_SYSTEMD);\n\n    VIR_DEBUG(\"Detecting systemd placement\");\n    if (virCgroupNewDetect(pidleader,\n                           controllers,\n                           &init) < 0)\n        return -1;\n\n    for (i = 0; i < VIR_CGROUP_BACKEND_TYPE_LAST; i++) {\n        if (init->backends[i] &&\n            (path = init->backends[i]->stealPlacement(init))) {\n            break;\n        }\n    }\n    virCgroupFree(&init);\n\n    if (!path || STREQ(path, \"/\") || path[0] != '/') {\n        VIR_DEBUG(\"Systemd didn't setup its controller, path=%s\",\n                  NULLSTR(path));\n        return -2;\n    }\n\n    if (virCgroupEnableMissingControllers(path, pidleader,\n                                          controllers, group) < 0) {\n        return -1;\n    }\n\n    if (virCgroupAddProcess(*group, pidleader) < 0) {\n        virErrorPtr saved;\n\n        virErrorPreserveLast(&saved);\n        virCgroupRemove(*group);\n        virCgroupFree(group);\n        virErrorRestore(&saved);\n    }\n\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupNewMachine(const char *name,\n                    const char *drivername,\n                    const unsigned char *uuid,\n                    const char *rootdir,\n                    pid_t pidleader,\n                    bool isContainer,\n                    size_t nnicindexes,\n                    int *nicindexes,\n                    const char *partition,\n                    int controllers,\n                    unsigned int maxthreads,\n                    virCgroupPtr *group)\n{\n    int rv;\n\n    *group = NULL;\n\n    if ((rv = virCgroupNewMachineSystemd(name,\n                                         drivername,\n                                         uuid,\n                                         rootdir,\n                                         pidleader,\n                                         isContainer,\n                                         nnicindexes,\n                                         nicindexes,\n                                         partition,\n                                         controllers,\n                                         maxthreads,\n                                         group)) == 0)\n        return 0;\n\n    if (rv == -1)\n        return -1;\n\n    return virCgroupNewMachineManual(name,\n                                     drivername,\n                                     pidleader,\n                                     partition,\n                                     controllers,\n                                     group);\n}"
  },
  {
    "function_name": "virCgroupNewMachineManual",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "1175-1219",
    "snippet": "static int\nvirCgroupNewMachineManual(const char *name,\n                          const char *drivername,\n                          pid_t pidleader,\n                          const char *partition,\n                          int controllers,\n                          virCgroupPtr *group)\n{\n    virCgroupPtr parent = NULL;\n    int ret = -1;\n\n    VIR_DEBUG(\"Fallback to non-systemd setup\");\n    if (virCgroupNewPartition(partition,\n                              STREQ(partition, \"/machine\"),\n                              controllers,\n                              &parent) < 0) {\n        if (virCgroupNewIgnoreError())\n            goto done;\n\n        goto cleanup;\n    }\n\n    if (virCgroupNewDomainPartition(parent,\n                                    drivername,\n                                    name,\n                                    true,\n                                    group) < 0)\n        goto cleanup;\n\n    if (virCgroupAddProcess(*group, pidleader) < 0) {\n        virErrorPtr saved;\n\n        virErrorPreserveLast(&saved);\n        virCgroupRemove(*group);\n        virCgroupFree(group);\n        virErrorRestore(&saved);\n    }\n\n done:\n    ret = 0;\n\n cleanup:\n    virCgroupFree(&parent);\n    return ret;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCgroupFree",
          "args": [
            "&parent"
          ],
          "line": 1217
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3544-3563",
          "snippet": "void\nvirCgroupFree(virCgroupPtr *group)\n{\n    size_t i;\n\n    if (*group == NULL)\n        return;\n\n    for (i = 0; i < VIR_CGROUP_CONTROLLER_LAST; i++) {\n        VIR_FREE((*group)->legacy[i].mountPoint);\n        VIR_FREE((*group)->legacy[i].linkPoint);\n        VIR_FREE((*group)->legacy[i].placement);\n    }\n\n    VIR_FREE((*group)->unified.mountPoint);\n    VIR_FREE((*group)->unified.placement);\n\n    VIR_FREE((*group)->path);\n    VIR_FREE(*group);\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nvoid\nvirCgroupFree(virCgroupPtr *group)\n{\n    size_t i;\n\n    if (*group == NULL)\n        return;\n\n    for (i = 0; i < VIR_CGROUP_CONTROLLER_LAST; i++) {\n        VIR_FREE((*group)->legacy[i].mountPoint);\n        VIR_FREE((*group)->legacy[i].linkPoint);\n        VIR_FREE((*group)->legacy[i].placement);\n    }\n\n    VIR_FREE((*group)->unified.mountPoint);\n    VIR_FREE((*group)->unified.placement);\n\n    VIR_FREE((*group)->path);\n    VIR_FREE(*group);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virErrorRestore",
          "args": [
            "&saved"
          ],
          "line": 1210
        },
        "resolved": true,
        "details": {
          "function_name": "virErrorRestore",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "445-457",
          "snippet": "void\nvirErrorRestore(virErrorPtr *savederr)\n{\n    int saved_errno = errno;\n\n    if (!*savederr)\n        return;\n\n    virSetError(*savederr);\n    virFreeError(*savederr);\n    *savederr = NULL;\n    errno = saved_errno;\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirErrorRestore(virErrorPtr *savederr)\n{\n    int saved_errno = errno;\n\n    if (!*savederr)\n        return;\n\n    virSetError(*savederr);\n    virFreeError(*savederr);\n    *savederr = NULL;\n    errno = saved_errno;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupRemove",
          "args": [
            "*group"
          ],
          "line": 1208
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupRemove",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3378-3384",
          "snippet": "int\nvirCgroupRemove(virCgroupPtr group G_GNUC_UNUSED)\n{\n    virReportSystemError(ENXIO, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupRemove(virCgroupPtr group G_GNUC_UNUSED)\n{\n    virReportSystemError(ENXIO, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virErrorPreserveLast",
          "args": [
            "&saved"
          ],
          "line": 1207
        },
        "resolved": true,
        "details": {
          "function_name": "virErrorPreserveLast",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "424-436",
          "snippet": "void\nvirErrorPreserveLast(virErrorPtr *saveerr)\n{\n    int saved_errno = errno;\n    virErrorPtr lasterr = virGetLastError();\n\n    *saveerr = NULL;\n\n    if (lasterr)\n        *saveerr = virErrorCopyNew(lasterr);\n\n    errno = saved_errno;\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirErrorPreserveLast(virErrorPtr *saveerr)\n{\n    int saved_errno = errno;\n    virErrorPtr lasterr = virGetLastError();\n\n    *saveerr = NULL;\n\n    if (lasterr)\n        *saveerr = virErrorCopyNew(lasterr);\n\n    errno = saved_errno;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupAddProcess",
          "args": [
            "*group",
            "pidleader"
          ],
          "line": 1204
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupAddProcess",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "2919-2926",
          "snippet": "int\nvirCgroupAddProcess(virCgroupPtr group G_GNUC_UNUSED,\n                    pid_t pid G_GNUC_UNUSED)\n{\n    virReportSystemError(ENXIO, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupAddProcess(virCgroupPtr group G_GNUC_UNUSED,\n                    pid_t pid G_GNUC_UNUSED)\n{\n    virReportSystemError(ENXIO, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupNewDomainPartition",
          "args": [
            "parent",
            "drivername",
            "name",
            "true",
            "group"
          ],
          "line": 1197
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupNewDomainPartition",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "2812-2822",
          "snippet": "int\nvirCgroupNewDomainPartition(virCgroupPtr partition G_GNUC_UNUSED,\n                            const char *driver G_GNUC_UNUSED,\n                            const char *name G_GNUC_UNUSED,\n                            bool create G_GNUC_UNUSED,\n                            virCgroupPtr *group G_GNUC_UNUSED)\n{\n    virReportSystemError(ENXIO, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupNewDomainPartition(virCgroupPtr partition G_GNUC_UNUSED,\n                            const char *driver G_GNUC_UNUSED,\n                            const char *name G_GNUC_UNUSED,\n                            bool create G_GNUC_UNUSED,\n                            virCgroupPtr *group G_GNUC_UNUSED)\n{\n    virReportSystemError(ENXIO, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupNewIgnoreError",
          "args": [],
          "line": 1191
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupNewIgnoreError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "2891-2896",
          "snippet": "bool\nvirCgroupNewIgnoreError(void)\n{\n    VIR_DEBUG(\"No cgroups present/configured/accessible, ignoring error\");\n    return true;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nbool\nvirCgroupNewIgnoreError(void)\n{\n    VIR_DEBUG(\"No cgroups present/configured/accessible, ignoring error\");\n    return true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupNewPartition",
          "args": [
            "partition",
            "STREQ(partition, \"/machine\")",
            "controllers",
            "&parent"
          ],
          "line": 1187
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupNewPartition",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "2791-2800",
          "snippet": "int\nvirCgroupNewPartition(const char *path G_GNUC_UNUSED,\n                      bool create G_GNUC_UNUSED,\n                      int controllers G_GNUC_UNUSED,\n                      virCgroupPtr *group G_GNUC_UNUSED)\n{\n    virReportSystemError(ENXIO, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupNewPartition(const char *path G_GNUC_UNUSED,\n                      bool create G_GNUC_UNUSED,\n                      int controllers G_GNUC_UNUSED,\n                      virCgroupPtr *group G_GNUC_UNUSED)\n{\n    virReportSystemError(ENXIO, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "partition",
            "\"/machine\""
          ],
          "line": 1188
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Fallback to non-systemd setup\""
          ],
          "line": 1186
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nstatic int\nvirCgroupNewMachineManual(const char *name,\n                          const char *drivername,\n                          pid_t pidleader,\n                          const char *partition,\n                          int controllers,\n                          virCgroupPtr *group)\n{\n    virCgroupPtr parent = NULL;\n    int ret = -1;\n\n    VIR_DEBUG(\"Fallback to non-systemd setup\");\n    if (virCgroupNewPartition(partition,\n                              STREQ(partition, \"/machine\"),\n                              controllers,\n                              &parent) < 0) {\n        if (virCgroupNewIgnoreError())\n            goto done;\n\n        goto cleanup;\n    }\n\n    if (virCgroupNewDomainPartition(parent,\n                                    drivername,\n                                    name,\n                                    true,\n                                    group) < 0)\n        goto cleanup;\n\n    if (virCgroupAddProcess(*group, pidleader) < 0) {\n        virErrorPtr saved;\n\n        virErrorPreserveLast(&saved);\n        virCgroupRemove(*group);\n        virCgroupFree(group);\n        virErrorRestore(&saved);\n    }\n\n done:\n    ret = 0;\n\n cleanup:\n    virCgroupFree(&parent);\n    return ret;\n}"
  },
  {
    "function_name": "virCgroupTerminateMachine",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "1169-1172",
    "snippet": "int virCgroupTerminateMachine(const char *name)\n{\n    return virSystemdTerminateMachine(name);\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virSystemdTerminateMachine",
          "args": [
            "name"
          ],
          "line": 1171
        },
        "resolved": true,
        "details": {
          "function_name": "virSystemdTerminateMachine",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsystemd.c",
          "lines": "453-507",
          "snippet": "int virSystemdTerminateMachine(const char *name)\n{\n    int ret;\n    DBusConnection *conn;\n    virError error;\n\n    if (!name)\n        return 0;\n\n    memset(&error, 0, sizeof(error));\n\n    if ((ret = virSystemdHasMachined()) < 0)\n        goto cleanup;\n\n    ret = -1;\n\n    if (!(conn = virDBusGetSystemBus()))\n        goto cleanup;\n\n    /*\n     * The systemd DBus API we're invoking has the\n     * following signature\n     *\n     * TerminateMachine(in  s name);\n     *\n     * @name a host unique name for the machine. shows up\n     * in 'ps' listing & similar\n     */\n\n    VIR_DEBUG(\"Attempting to terminate machine via systemd\");\n    if (virDBusCallMethod(conn,\n                          NULL,\n                          &error,\n                          \"org.freedesktop.machine1\",\n                          \"/org/freedesktop/machine1\",\n                          \"org.freedesktop.machine1.Manager\",\n                          \"TerminateMachine\",\n                          \"s\",\n                          name) < 0)\n        goto cleanup;\n\n    if (error.level == VIR_ERR_ERROR &&\n        STRNEQ_NULLABLE(\"org.freedesktop.machine1.NoSuchMachine\",\n                        error.str1)) {\n        virReportErrorObject(&error);\n        goto cleanup;\n    }\n\n    ret = 0;\n\n cleanup:\n    virResetError(&error);\n\n    return ret;\n}",
          "includes": [
            "#include \"virsocketaddr.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virdbus.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virsystemdpriv.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocketaddr.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virdbus.h\"\n#include \"virbuffer.h\"\n#include \"virsystemd.h\"\n#include \"virsystemdpriv.h\"\n#include <config.h>\n\nint virSystemdTerminateMachine(const char *name)\n{\n    int ret;\n    DBusConnection *conn;\n    virError error;\n\n    if (!name)\n        return 0;\n\n    memset(&error, 0, sizeof(error));\n\n    if ((ret = virSystemdHasMachined()) < 0)\n        goto cleanup;\n\n    ret = -1;\n\n    if (!(conn = virDBusGetSystemBus()))\n        goto cleanup;\n\n    /*\n     * The systemd DBus API we're invoking has the\n     * following signature\n     *\n     * TerminateMachine(in  s name);\n     *\n     * @name a host unique name for the machine. shows up\n     * in 'ps' listing & similar\n     */\n\n    VIR_DEBUG(\"Attempting to terminate machine via systemd\");\n    if (virDBusCallMethod(conn,\n                          NULL,\n                          &error,\n                          \"org.freedesktop.machine1\",\n                          \"/org/freedesktop/machine1\",\n                          \"org.freedesktop.machine1.Manager\",\n                          \"TerminateMachine\",\n                          \"s\",\n                          name) < 0)\n        goto cleanup;\n\n    if (error.level == VIR_ERR_ERROR &&\n        STRNEQ_NULLABLE(\"org.freedesktop.machine1.NoSuchMachine\",\n                        error.str1)) {\n        virReportErrorObject(&error);\n        goto cleanup;\n    }\n\n    ret = 0;\n\n cleanup:\n    virResetError(&error);\n\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint virCgroupTerminateMachine(const char *name)\n{\n    return virSystemdTerminateMachine(name);\n}"
  },
  {
    "function_name": "virCgroupNewMachineSystemd",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "1093-1163",
    "snippet": "static int\nvirCgroupNewMachineSystemd(const char *name,\n                           const char *drivername,\n                           const unsigned char *uuid,\n                           const char *rootdir,\n                           pid_t pidleader,\n                           bool isContainer,\n                           size_t nnicindexes,\n                           int *nicindexes,\n                           const char *partition,\n                           int controllers,\n                           unsigned int maxthreads,\n                           virCgroupPtr *group)\n{\n    int rv;\n    virCgroupPtr init;\n    g_autofree char *path = NULL;\n    size_t i;\n\n    VIR_DEBUG(\"Trying to setup machine '%s' via systemd\", name);\n    if ((rv = virSystemdCreateMachine(name,\n                                      drivername,\n                                      uuid,\n                                      rootdir,\n                                      pidleader,\n                                      isContainer,\n                                      nnicindexes,\n                                      nicindexes,\n                                      partition,\n                                      maxthreads)) < 0)\n        return rv;\n\n    if (controllers != -1)\n        controllers |= (1 << VIR_CGROUP_CONTROLLER_SYSTEMD);\n\n    VIR_DEBUG(\"Detecting systemd placement\");\n    if (virCgroupNewDetect(pidleader,\n                           controllers,\n                           &init) < 0)\n        return -1;\n\n    for (i = 0; i < VIR_CGROUP_BACKEND_TYPE_LAST; i++) {\n        if (init->backends[i] &&\n            (path = init->backends[i]->stealPlacement(init))) {\n            break;\n        }\n    }\n    virCgroupFree(&init);\n\n    if (!path || STREQ(path, \"/\") || path[0] != '/') {\n        VIR_DEBUG(\"Systemd didn't setup its controller, path=%s\",\n                  NULLSTR(path));\n        return -2;\n    }\n\n    if (virCgroupEnableMissingControllers(path, pidleader,\n                                          controllers, group) < 0) {\n        return -1;\n    }\n\n    if (virCgroupAddProcess(*group, pidleader) < 0) {\n        virErrorPtr saved;\n\n        virErrorPreserveLast(&saved);\n        virCgroupRemove(*group);\n        virCgroupFree(group);\n        virErrorRestore(&saved);\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virErrorRestore",
          "args": [
            "&saved"
          ],
          "line": 1159
        },
        "resolved": true,
        "details": {
          "function_name": "virErrorRestore",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "445-457",
          "snippet": "void\nvirErrorRestore(virErrorPtr *savederr)\n{\n    int saved_errno = errno;\n\n    if (!*savederr)\n        return;\n\n    virSetError(*savederr);\n    virFreeError(*savederr);\n    *savederr = NULL;\n    errno = saved_errno;\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirErrorRestore(virErrorPtr *savederr)\n{\n    int saved_errno = errno;\n\n    if (!*savederr)\n        return;\n\n    virSetError(*savederr);\n    virFreeError(*savederr);\n    *savederr = NULL;\n    errno = saved_errno;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupFree",
          "args": [
            "group"
          ],
          "line": 1158
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3544-3563",
          "snippet": "void\nvirCgroupFree(virCgroupPtr *group)\n{\n    size_t i;\n\n    if (*group == NULL)\n        return;\n\n    for (i = 0; i < VIR_CGROUP_CONTROLLER_LAST; i++) {\n        VIR_FREE((*group)->legacy[i].mountPoint);\n        VIR_FREE((*group)->legacy[i].linkPoint);\n        VIR_FREE((*group)->legacy[i].placement);\n    }\n\n    VIR_FREE((*group)->unified.mountPoint);\n    VIR_FREE((*group)->unified.placement);\n\n    VIR_FREE((*group)->path);\n    VIR_FREE(*group);\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nvoid\nvirCgroupFree(virCgroupPtr *group)\n{\n    size_t i;\n\n    if (*group == NULL)\n        return;\n\n    for (i = 0; i < VIR_CGROUP_CONTROLLER_LAST; i++) {\n        VIR_FREE((*group)->legacy[i].mountPoint);\n        VIR_FREE((*group)->legacy[i].linkPoint);\n        VIR_FREE((*group)->legacy[i].placement);\n    }\n\n    VIR_FREE((*group)->unified.mountPoint);\n    VIR_FREE((*group)->unified.placement);\n\n    VIR_FREE((*group)->path);\n    VIR_FREE(*group);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupRemove",
          "args": [
            "*group"
          ],
          "line": 1157
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupRemove",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3378-3384",
          "snippet": "int\nvirCgroupRemove(virCgroupPtr group G_GNUC_UNUSED)\n{\n    virReportSystemError(ENXIO, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupRemove(virCgroupPtr group G_GNUC_UNUSED)\n{\n    virReportSystemError(ENXIO, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virErrorPreserveLast",
          "args": [
            "&saved"
          ],
          "line": 1156
        },
        "resolved": true,
        "details": {
          "function_name": "virErrorPreserveLast",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "424-436",
          "snippet": "void\nvirErrorPreserveLast(virErrorPtr *saveerr)\n{\n    int saved_errno = errno;\n    virErrorPtr lasterr = virGetLastError();\n\n    *saveerr = NULL;\n\n    if (lasterr)\n        *saveerr = virErrorCopyNew(lasterr);\n\n    errno = saved_errno;\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirErrorPreserveLast(virErrorPtr *saveerr)\n{\n    int saved_errno = errno;\n    virErrorPtr lasterr = virGetLastError();\n\n    *saveerr = NULL;\n\n    if (lasterr)\n        *saveerr = virErrorCopyNew(lasterr);\n\n    errno = saved_errno;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupAddProcess",
          "args": [
            "*group",
            "pidleader"
          ],
          "line": 1153
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupAddProcess",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "2919-2926",
          "snippet": "int\nvirCgroupAddProcess(virCgroupPtr group G_GNUC_UNUSED,\n                    pid_t pid G_GNUC_UNUSED)\n{\n    virReportSystemError(ENXIO, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupAddProcess(virCgroupPtr group G_GNUC_UNUSED,\n                    pid_t pid G_GNUC_UNUSED)\n{\n    virReportSystemError(ENXIO, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupEnableMissingControllers",
          "args": [
            "path",
            "pidleader",
            "controllers",
            "group"
          ],
          "line": 1148
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupEnableMissingControllers",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "1038-1087",
          "snippet": "static int\nvirCgroupEnableMissingControllers(char *path,\n                                  pid_t pidleader,\n                                  int controllers,\n                                  virCgroupPtr *group)\n{\n    virCgroupPtr parent = NULL;\n    char *offset = path;\n    int ret = -1;\n\n    if (virCgroupNew(pidleader,\n                     \"/\",\n                     NULL,\n                     controllers,\n                     &parent) < 0)\n        return ret;\n\n    for (;;) {\n        virCgroupPtr tmp;\n        char *t = strchr(offset + 1, '/');\n        if (t)\n            *t = '\\0';\n\n        if (virCgroupNew(pidleader,\n                         path,\n                         parent,\n                         controllers,\n                         &tmp) < 0)\n            goto cleanup;\n\n        if (virCgroupMakeGroup(parent, tmp, true, VIR_CGROUP_SYSTEMD) < 0) {\n            virCgroupFree(&tmp);\n            goto cleanup;\n        }\n        if (t) {\n            *t = '/';\n            offset = t;\n            virCgroupFree(&parent);\n            parent = tmp;\n        } else {\n            *group = tmp;\n            break;\n        }\n    }\n\n    ret = 0;\n cleanup:\n    virCgroupFree(&parent);\n    return ret;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nstatic int\nvirCgroupEnableMissingControllers(char *path,\n                                  pid_t pidleader,\n                                  int controllers,\n                                  virCgroupPtr *group)\n{\n    virCgroupPtr parent = NULL;\n    char *offset = path;\n    int ret = -1;\n\n    if (virCgroupNew(pidleader,\n                     \"/\",\n                     NULL,\n                     controllers,\n                     &parent) < 0)\n        return ret;\n\n    for (;;) {\n        virCgroupPtr tmp;\n        char *t = strchr(offset + 1, '/');\n        if (t)\n            *t = '\\0';\n\n        if (virCgroupNew(pidleader,\n                         path,\n                         parent,\n                         controllers,\n                         &tmp) < 0)\n            goto cleanup;\n\n        if (virCgroupMakeGroup(parent, tmp, true, VIR_CGROUP_SYSTEMD) < 0) {\n            virCgroupFree(&tmp);\n            goto cleanup;\n        }\n        if (t) {\n            *t = '/';\n            offset = t;\n            virCgroupFree(&parent);\n            parent = tmp;\n        } else {\n            *group = tmp;\n            break;\n        }\n    }\n\n    ret = 0;\n cleanup:\n    virCgroupFree(&parent);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Systemd didn't setup its controller, path=%s\"",
            "NULLSTR(path)"
          ],
          "line": 1143
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "path"
          ],
          "line": 1144
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "path",
            "\"/\""
          ],
          "line": 1142
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "init->backends[i]->stealPlacement",
          "args": [
            "init"
          ],
          "line": 1136
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCgroupNewDetect",
          "args": [
            "pidleader",
            "controllers",
            "&init"
          ],
          "line": 1129
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupNewDetect",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "2838-2846",
          "snippet": "int\nvirCgroupNewDetect(pid_t pid G_GNUC_UNUSED,\n                   int controllers G_GNUC_UNUSED,\n                   virCgroupPtr *group G_GNUC_UNUSED)\n{\n    virReportSystemError(ENXIO, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupNewDetect(pid_t pid G_GNUC_UNUSED,\n                   int controllers G_GNUC_UNUSED,\n                   virCgroupPtr *group G_GNUC_UNUSED)\n{\n    virReportSystemError(ENXIO, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Detecting systemd placement\""
          ],
          "line": 1128
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virSystemdCreateMachine",
          "args": [
            "name",
            "drivername",
            "uuid",
            "rootdir",
            "pidleader",
            "isContainer",
            "nnicindexes",
            "nicindexes",
            "partition",
            "maxthreads"
          ],
          "line": 1113
        },
        "resolved": true,
        "details": {
          "function_name": "virSystemdCreateMachine",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsystemd.c",
          "lines": "266-451",
          "snippet": "int virSystemdCreateMachine(const char *name,\n                            const char *drivername,\n                            const unsigned char *uuid,\n                            const char *rootdir,\n                            pid_t pidleader,\n                            bool iscontainer,\n                            size_t nnicindexes,\n                            int *nicindexes,\n                            const char *partition,\n                            unsigned int maxthreads)\n{\n    int ret;\n    DBusConnection *conn;\n    char *creatorname = NULL;\n    char *slicename = NULL;\n    char *scopename = NULL;\n    static int hasCreateWithNetwork = 1;\n\n    if ((ret = virSystemdHasMachined()) < 0)\n        return ret;\n\n    if (!(conn = virDBusGetSystemBus()))\n        return -1;\n\n    ret = -1;\n\n    creatorname = g_strdup_printf(\"libvirt-%s\", drivername);\n\n    if (partition) {\n        if (!(slicename = virSystemdMakeSliceName(partition)))\n             goto cleanup;\n    } else {\n        slicename = g_strdup(\"\");\n    }\n\n    /*\n     * The systemd DBus APIs we're invoking have the\n     * following signature(s)\n     *\n     * CreateMachineWithNetwork(in  s name,\n     *                          in  ay id,\n     *                          in  s service,\n     *                          in  s class,\n     *                          in  u leader,\n     *                          in  s root_directory,\n     *                          in  ai nicindexes\n     *                          in  a(sv) scope_properties,\n     *                          out o path);\n     *\n     * CreateMachine(in  s name,\n     *               in  ay id,\n     *               in  s service,\n     *               in  s class,\n     *               in  u leader,\n     *               in  s root_directory,\n     *               in  a(sv) scope_properties,\n     *               out o path);\n     *\n     * @name a host unique name for the machine. shows up\n     * in 'ps' listing & similar\n     *\n     * @id: a UUID of the machine, ideally matching /etc/machine-id\n     * for containers\n     *\n     * @service: identifier of the client ie \"libvirt-lxc\"\n     *\n     * @class: either the string \"container\" or \"vm\" depending\n     * on the type of machine\n     *\n     * @leader: main PID of the machine, either the host emulator\n     * process, or the 'init' PID of the container\n     *\n     * @root_directory: the root directory of the container, if\n     * this is known & visible in the host filesystem, or empty string\n     *\n     * @nicindexes: list of network interface indexes for the\n     * host end of the VETH device pairs.\n     *\n     * @scope_properties:an array (not a dict!) of properties that are\n     * passed on to PID 1 when creating a scope unit for your machine.\n     * Will allow initial settings for the cgroup & similar.\n     *\n     * @path: a bus path returned for the machine object created, to\n     * allow further API calls to be made against the object.\n     *\n     */\n\n    VIR_DEBUG(\"Attempting to create machine via systemd\");\n    if (g_atomic_int_get(&hasCreateWithNetwork)) {\n        virError error;\n        memset(&error, 0, sizeof(error));\n\n        if (virDBusCallMethod(conn,\n                              NULL,\n                              &error,\n                              \"org.freedesktop.machine1\",\n                              \"/org/freedesktop/machine1\",\n                              \"org.freedesktop.machine1.Manager\",\n                              \"CreateMachineWithNetwork\",\n                              \"sayssusa&ia(sv)\",\n                              name,\n                              16,\n                              uuid[0], uuid[1], uuid[2], uuid[3],\n                              uuid[4], uuid[5], uuid[6], uuid[7],\n                              uuid[8], uuid[9], uuid[10], uuid[11],\n                              uuid[12], uuid[13], uuid[14], uuid[15],\n                              creatorname,\n                              iscontainer ? \"container\" : \"vm\",\n                              (unsigned int)pidleader,\n                              NULLSTR_EMPTY(rootdir),\n                              nnicindexes, nicindexes,\n                              3,\n                              \"Slice\", \"s\", slicename,\n                              \"After\", \"as\", 1, \"libvirtd.service\",\n                              \"Before\", \"as\", 1, \"virt-guest-shutdown.target\") < 0)\n            goto cleanup;\n\n        if (error.level == VIR_ERR_ERROR) {\n            if (virDBusErrorIsUnknownMethod(&error)) {\n                VIR_INFO(\"CreateMachineWithNetwork isn't supported, switching \"\n                         \"to legacy CreateMachine method for systemd-machined\");\n                virResetError(&error);\n                g_atomic_int_set(&hasCreateWithNetwork, 0);\n                /* Could re-structure without Using goto, but this\n                 * avoids another atomic read which would trigger\n                 * another memory barrier */\n                goto fallback;\n            }\n            virReportErrorObject(&error);\n            virResetError(&error);\n            goto cleanup;\n        }\n    } else {\n    fallback:\n        if (virDBusCallMethod(conn,\n                              NULL,\n                              NULL,\n                              \"org.freedesktop.machine1\",\n                              \"/org/freedesktop/machine1\",\n                              \"org.freedesktop.machine1.Manager\",\n                              \"CreateMachine\",\n                              \"sayssusa(sv)\",\n                              name,\n                              16,\n                              uuid[0], uuid[1], uuid[2], uuid[3],\n                              uuid[4], uuid[5], uuid[6], uuid[7],\n                              uuid[8], uuid[9], uuid[10], uuid[11],\n                              uuid[12], uuid[13], uuid[14], uuid[15],\n                              creatorname,\n                              iscontainer ? \"container\" : \"vm\",\n                              (unsigned int)pidleader,\n                              NULLSTR_EMPTY(rootdir),\n                              3,\n                              \"Slice\", \"s\", slicename,\n                              \"After\", \"as\", 1, \"libvirtd.service\",\n                              \"Before\", \"as\", 1, \"virt-guest-shutdown.target\") < 0)\n            goto cleanup;\n    }\n\n    if (maxthreads > 0) {\n        if (!(scopename = virSystemdMakeScopeName(name, drivername, false)))\n            goto cleanup;\n\n        if (virDBusCallMethod(conn,\n                              NULL,\n                              NULL,\n                              \"org.freedesktop.systemd1\",\n                              \"/org/freedesktop/systemd1\",\n                              \"org.freedesktop.systemd1.Manager\",\n                              \"SetUnitProperties\",\n                              \"sba(sv)\",\n                              scopename,\n                              true,\n                              1,\n                              \"TasksMax\", \"t\", (uint64_t)maxthreads) < 0)\n            goto cleanup;\n    }\n\n    ret = 0;\n\n cleanup:\n    VIR_FREE(creatorname);\n    VIR_FREE(slicename);\n    VIR_FREE(scopename);\n    return ret;\n}",
          "includes": [
            "#include \"virsocketaddr.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virdbus.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virsystemdpriv.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocketaddr.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virdbus.h\"\n#include \"virbuffer.h\"\n#include \"virsystemd.h\"\n#include \"virsystemdpriv.h\"\n#include <config.h>\n\nint virSystemdCreateMachine(const char *name,\n                            const char *drivername,\n                            const unsigned char *uuid,\n                            const char *rootdir,\n                            pid_t pidleader,\n                            bool iscontainer,\n                            size_t nnicindexes,\n                            int *nicindexes,\n                            const char *partition,\n                            unsigned int maxthreads)\n{\n    int ret;\n    DBusConnection *conn;\n    char *creatorname = NULL;\n    char *slicename = NULL;\n    char *scopename = NULL;\n    static int hasCreateWithNetwork = 1;\n\n    if ((ret = virSystemdHasMachined()) < 0)\n        return ret;\n\n    if (!(conn = virDBusGetSystemBus()))\n        return -1;\n\n    ret = -1;\n\n    creatorname = g_strdup_printf(\"libvirt-%s\", drivername);\n\n    if (partition) {\n        if (!(slicename = virSystemdMakeSliceName(partition)))\n             goto cleanup;\n    } else {\n        slicename = g_strdup(\"\");\n    }\n\n    /*\n     * The systemd DBus APIs we're invoking have the\n     * following signature(s)\n     *\n     * CreateMachineWithNetwork(in  s name,\n     *                          in  ay id,\n     *                          in  s service,\n     *                          in  s class,\n     *                          in  u leader,\n     *                          in  s root_directory,\n     *                          in  ai nicindexes\n     *                          in  a(sv) scope_properties,\n     *                          out o path);\n     *\n     * CreateMachine(in  s name,\n     *               in  ay id,\n     *               in  s service,\n     *               in  s class,\n     *               in  u leader,\n     *               in  s root_directory,\n     *               in  a(sv) scope_properties,\n     *               out o path);\n     *\n     * @name a host unique name for the machine. shows up\n     * in 'ps' listing & similar\n     *\n     * @id: a UUID of the machine, ideally matching /etc/machine-id\n     * for containers\n     *\n     * @service: identifier of the client ie \"libvirt-lxc\"\n     *\n     * @class: either the string \"container\" or \"vm\" depending\n     * on the type of machine\n     *\n     * @leader: main PID of the machine, either the host emulator\n     * process, or the 'init' PID of the container\n     *\n     * @root_directory: the root directory of the container, if\n     * this is known & visible in the host filesystem, or empty string\n     *\n     * @nicindexes: list of network interface indexes for the\n     * host end of the VETH device pairs.\n     *\n     * @scope_properties:an array (not a dict!) of properties that are\n     * passed on to PID 1 when creating a scope unit for your machine.\n     * Will allow initial settings for the cgroup & similar.\n     *\n     * @path: a bus path returned for the machine object created, to\n     * allow further API calls to be made against the object.\n     *\n     */\n\n    VIR_DEBUG(\"Attempting to create machine via systemd\");\n    if (g_atomic_int_get(&hasCreateWithNetwork)) {\n        virError error;\n        memset(&error, 0, sizeof(error));\n\n        if (virDBusCallMethod(conn,\n                              NULL,\n                              &error,\n                              \"org.freedesktop.machine1\",\n                              \"/org/freedesktop/machine1\",\n                              \"org.freedesktop.machine1.Manager\",\n                              \"CreateMachineWithNetwork\",\n                              \"sayssusa&ia(sv)\",\n                              name,\n                              16,\n                              uuid[0], uuid[1], uuid[2], uuid[3],\n                              uuid[4], uuid[5], uuid[6], uuid[7],\n                              uuid[8], uuid[9], uuid[10], uuid[11],\n                              uuid[12], uuid[13], uuid[14], uuid[15],\n                              creatorname,\n                              iscontainer ? \"container\" : \"vm\",\n                              (unsigned int)pidleader,\n                              NULLSTR_EMPTY(rootdir),\n                              nnicindexes, nicindexes,\n                              3,\n                              \"Slice\", \"s\", slicename,\n                              \"After\", \"as\", 1, \"libvirtd.service\",\n                              \"Before\", \"as\", 1, \"virt-guest-shutdown.target\") < 0)\n            goto cleanup;\n\n        if (error.level == VIR_ERR_ERROR) {\n            if (virDBusErrorIsUnknownMethod(&error)) {\n                VIR_INFO(\"CreateMachineWithNetwork isn't supported, switching \"\n                         \"to legacy CreateMachine method for systemd-machined\");\n                virResetError(&error);\n                g_atomic_int_set(&hasCreateWithNetwork, 0);\n                /* Could re-structure without Using goto, but this\n                 * avoids another atomic read which would trigger\n                 * another memory barrier */\n                goto fallback;\n            }\n            virReportErrorObject(&error);\n            virResetError(&error);\n            goto cleanup;\n        }\n    } else {\n    fallback:\n        if (virDBusCallMethod(conn,\n                              NULL,\n                              NULL,\n                              \"org.freedesktop.machine1\",\n                              \"/org/freedesktop/machine1\",\n                              \"org.freedesktop.machine1.Manager\",\n                              \"CreateMachine\",\n                              \"sayssusa(sv)\",\n                              name,\n                              16,\n                              uuid[0], uuid[1], uuid[2], uuid[3],\n                              uuid[4], uuid[5], uuid[6], uuid[7],\n                              uuid[8], uuid[9], uuid[10], uuid[11],\n                              uuid[12], uuid[13], uuid[14], uuid[15],\n                              creatorname,\n                              iscontainer ? \"container\" : \"vm\",\n                              (unsigned int)pidleader,\n                              NULLSTR_EMPTY(rootdir),\n                              3,\n                              \"Slice\", \"s\", slicename,\n                              \"After\", \"as\", 1, \"libvirtd.service\",\n                              \"Before\", \"as\", 1, \"virt-guest-shutdown.target\") < 0)\n            goto cleanup;\n    }\n\n    if (maxthreads > 0) {\n        if (!(scopename = virSystemdMakeScopeName(name, drivername, false)))\n            goto cleanup;\n\n        if (virDBusCallMethod(conn,\n                              NULL,\n                              NULL,\n                              \"org.freedesktop.systemd1\",\n                              \"/org/freedesktop/systemd1\",\n                              \"org.freedesktop.systemd1.Manager\",\n                              \"SetUnitProperties\",\n                              \"sba(sv)\",\n                              scopename,\n                              true,\n                              1,\n                              \"TasksMax\", \"t\", (uint64_t)maxthreads) < 0)\n            goto cleanup;\n    }\n\n    ret = 0;\n\n cleanup:\n    VIR_FREE(creatorname);\n    VIR_FREE(slicename);\n    VIR_FREE(scopename);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Trying to setup machine '%s' via systemd\"",
            "name"
          ],
          "line": 1112
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nstatic int\nvirCgroupNewMachineSystemd(const char *name,\n                           const char *drivername,\n                           const unsigned char *uuid,\n                           const char *rootdir,\n                           pid_t pidleader,\n                           bool isContainer,\n                           size_t nnicindexes,\n                           int *nicindexes,\n                           const char *partition,\n                           int controllers,\n                           unsigned int maxthreads,\n                           virCgroupPtr *group)\n{\n    int rv;\n    virCgroupPtr init;\n    g_autofree char *path = NULL;\n    size_t i;\n\n    VIR_DEBUG(\"Trying to setup machine '%s' via systemd\", name);\n    if ((rv = virSystemdCreateMachine(name,\n                                      drivername,\n                                      uuid,\n                                      rootdir,\n                                      pidleader,\n                                      isContainer,\n                                      nnicindexes,\n                                      nicindexes,\n                                      partition,\n                                      maxthreads)) < 0)\n        return rv;\n\n    if (controllers != -1)\n        controllers |= (1 << VIR_CGROUP_CONTROLLER_SYSTEMD);\n\n    VIR_DEBUG(\"Detecting systemd placement\");\n    if (virCgroupNewDetect(pidleader,\n                           controllers,\n                           &init) < 0)\n        return -1;\n\n    for (i = 0; i < VIR_CGROUP_BACKEND_TYPE_LAST; i++) {\n        if (init->backends[i] &&\n            (path = init->backends[i]->stealPlacement(init))) {\n            break;\n        }\n    }\n    virCgroupFree(&init);\n\n    if (!path || STREQ(path, \"/\") || path[0] != '/') {\n        VIR_DEBUG(\"Systemd didn't setup its controller, path=%s\",\n                  NULLSTR(path));\n        return -2;\n    }\n\n    if (virCgroupEnableMissingControllers(path, pidleader,\n                                          controllers, group) < 0) {\n        return -1;\n    }\n\n    if (virCgroupAddProcess(*group, pidleader) < 0) {\n        virErrorPtr saved;\n\n        virErrorPreserveLast(&saved);\n        virCgroupRemove(*group);\n        virCgroupFree(group);\n        virErrorRestore(&saved);\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virCgroupEnableMissingControllers",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "1038-1087",
    "snippet": "static int\nvirCgroupEnableMissingControllers(char *path,\n                                  pid_t pidleader,\n                                  int controllers,\n                                  virCgroupPtr *group)\n{\n    virCgroupPtr parent = NULL;\n    char *offset = path;\n    int ret = -1;\n\n    if (virCgroupNew(pidleader,\n                     \"/\",\n                     NULL,\n                     controllers,\n                     &parent) < 0)\n        return ret;\n\n    for (;;) {\n        virCgroupPtr tmp;\n        char *t = strchr(offset + 1, '/');\n        if (t)\n            *t = '\\0';\n\n        if (virCgroupNew(pidleader,\n                         path,\n                         parent,\n                         controllers,\n                         &tmp) < 0)\n            goto cleanup;\n\n        if (virCgroupMakeGroup(parent, tmp, true, VIR_CGROUP_SYSTEMD) < 0) {\n            virCgroupFree(&tmp);\n            goto cleanup;\n        }\n        if (t) {\n            *t = '/';\n            offset = t;\n            virCgroupFree(&parent);\n            parent = tmp;\n        } else {\n            *group = tmp;\n            break;\n        }\n    }\n\n    ret = 0;\n cleanup:\n    virCgroupFree(&parent);\n    return ret;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCgroupFree",
          "args": [
            "&parent"
          ],
          "line": 1085
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3544-3563",
          "snippet": "void\nvirCgroupFree(virCgroupPtr *group)\n{\n    size_t i;\n\n    if (*group == NULL)\n        return;\n\n    for (i = 0; i < VIR_CGROUP_CONTROLLER_LAST; i++) {\n        VIR_FREE((*group)->legacy[i].mountPoint);\n        VIR_FREE((*group)->legacy[i].linkPoint);\n        VIR_FREE((*group)->legacy[i].placement);\n    }\n\n    VIR_FREE((*group)->unified.mountPoint);\n    VIR_FREE((*group)->unified.placement);\n\n    VIR_FREE((*group)->path);\n    VIR_FREE(*group);\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nvoid\nvirCgroupFree(virCgroupPtr *group)\n{\n    size_t i;\n\n    if (*group == NULL)\n        return;\n\n    for (i = 0; i < VIR_CGROUP_CONTROLLER_LAST; i++) {\n        VIR_FREE((*group)->legacy[i].mountPoint);\n        VIR_FREE((*group)->legacy[i].linkPoint);\n        VIR_FREE((*group)->legacy[i].placement);\n    }\n\n    VIR_FREE((*group)->unified.mountPoint);\n    VIR_FREE((*group)->unified.placement);\n\n    VIR_FREE((*group)->path);\n    VIR_FREE(*group);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupMakeGroup",
          "args": [
            "parent",
            "tmp",
            "true",
            "VIR_CGROUP_SYSTEMD"
          ],
          "line": 1068
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupMakeGroup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "625-642",
          "snippet": "static int\nvirCgroupMakeGroup(virCgroupPtr parent,\n                   virCgroupPtr group,\n                   bool create,\n                   unsigned int flags)\n{\n    size_t i;\n\n    for (i = 0; i < VIR_CGROUP_BACKEND_TYPE_LAST; i++) {\n        if (group->backends[i] &&\n            group->backends[i]->makeGroup(parent, group, create, flags) < 0) {\n            virCgroupRemove(group);\n            return -1;\n        }\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nstatic int\nvirCgroupMakeGroup(virCgroupPtr parent,\n                   virCgroupPtr group,\n                   bool create,\n                   unsigned int flags)\n{\n    size_t i;\n\n    for (i = 0; i < VIR_CGROUP_BACKEND_TYPE_LAST; i++) {\n        if (group->backends[i] &&\n            group->backends[i]->makeGroup(parent, group, create, flags) < 0) {\n            virCgroupRemove(group);\n            return -1;\n        }\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupNew",
          "args": [
            "pidleader",
            "path",
            "parent",
            "controllers",
            "&tmp"
          ],
          "line": 1061
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupNewThread",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "2825-2835",
          "snippet": "int\nvirCgroupNewThread(virCgroupPtr domain G_GNUC_UNUSED,\n                   virCgroupThreadName nameval G_GNUC_UNUSED,\n                   int id G_GNUC_UNUSED,\n                   bool create G_GNUC_UNUSED,\n                   virCgroupPtr *group G_GNUC_UNUSED)\n{\n    virReportSystemError(ENXIO, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupNewThread(virCgroupPtr domain G_GNUC_UNUSED,\n                   virCgroupThreadName nameval G_GNUC_UNUSED,\n                   int id G_GNUC_UNUSED,\n                   bool create G_GNUC_UNUSED,\n                   virCgroupPtr *group G_GNUC_UNUSED)\n{\n    virReportSystemError(ENXIO, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "offset + 1",
            "'/'"
          ],
          "line": 1057
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nstatic int\nvirCgroupEnableMissingControllers(char *path,\n                                  pid_t pidleader,\n                                  int controllers,\n                                  virCgroupPtr *group)\n{\n    virCgroupPtr parent = NULL;\n    char *offset = path;\n    int ret = -1;\n\n    if (virCgroupNew(pidleader,\n                     \"/\",\n                     NULL,\n                     controllers,\n                     &parent) < 0)\n        return ret;\n\n    for (;;) {\n        virCgroupPtr tmp;\n        char *t = strchr(offset + 1, '/');\n        if (t)\n            *t = '\\0';\n\n        if (virCgroupNew(pidleader,\n                         path,\n                         parent,\n                         controllers,\n                         &tmp) < 0)\n            goto cleanup;\n\n        if (virCgroupMakeGroup(parent, tmp, true, VIR_CGROUP_SYSTEMD) < 0) {\n            virCgroupFree(&tmp);\n            goto cleanup;\n        }\n        if (t) {\n            *t = '/';\n            offset = t;\n            virCgroupFree(&parent);\n            parent = tmp;\n        } else {\n            *group = tmp;\n            break;\n        }\n    }\n\n    ret = 0;\n cleanup:\n    virCgroupFree(&parent);\n    return ret;\n}"
  },
  {
    "function_name": "virCgroupNewDetectMachine",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "1006-1035",
    "snippet": "int\nvirCgroupNewDetectMachine(const char *name,\n                          const char *drivername,\n                          pid_t pid,\n                          int controllers,\n                          char *machinename,\n                          virCgroupPtr *group)\n{\n    size_t i;\n\n    if (virCgroupNewDetect(pid, controllers, group) < 0) {\n        if (virCgroupNewIgnoreError())\n            return 0;\n        return -1;\n    }\n\n    for (i = 0; i < VIR_CGROUP_BACKEND_TYPE_LAST; i++) {\n        if ((*group)->backends[i] &&\n            !(*group)->backends[i]->validateMachineGroup(*group, name,\n                                                         drivername,\n                                                         machinename)) {\n            VIR_DEBUG(\"Failed to validate machine name for '%s' driver '%s'\",\n                      name, drivername);\n            virCgroupFree(group);\n            return 0;\n        }\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCgroupFree",
          "args": [
            "group"
          ],
          "line": 1029
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3544-3563",
          "snippet": "void\nvirCgroupFree(virCgroupPtr *group)\n{\n    size_t i;\n\n    if (*group == NULL)\n        return;\n\n    for (i = 0; i < VIR_CGROUP_CONTROLLER_LAST; i++) {\n        VIR_FREE((*group)->legacy[i].mountPoint);\n        VIR_FREE((*group)->legacy[i].linkPoint);\n        VIR_FREE((*group)->legacy[i].placement);\n    }\n\n    VIR_FREE((*group)->unified.mountPoint);\n    VIR_FREE((*group)->unified.placement);\n\n    VIR_FREE((*group)->path);\n    VIR_FREE(*group);\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nvoid\nvirCgroupFree(virCgroupPtr *group)\n{\n    size_t i;\n\n    if (*group == NULL)\n        return;\n\n    for (i = 0; i < VIR_CGROUP_CONTROLLER_LAST; i++) {\n        VIR_FREE((*group)->legacy[i].mountPoint);\n        VIR_FREE((*group)->legacy[i].linkPoint);\n        VIR_FREE((*group)->legacy[i].placement);\n    }\n\n    VIR_FREE((*group)->unified.mountPoint);\n    VIR_FREE((*group)->unified.placement);\n\n    VIR_FREE((*group)->path);\n    VIR_FREE(*group);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Failed to validate machine name for '%s' driver '%s'\"",
            "name",
            "drivername"
          ],
          "line": 1027
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "*group",
            "name",
            "drivername",
            "machinename"
          ],
          "line": 1024
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCgroupNewIgnoreError",
          "args": [],
          "line": 1017
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupNewIgnoreError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "2891-2896",
          "snippet": "bool\nvirCgroupNewIgnoreError(void)\n{\n    VIR_DEBUG(\"No cgroups present/configured/accessible, ignoring error\");\n    return true;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nbool\nvirCgroupNewIgnoreError(void)\n{\n    VIR_DEBUG(\"No cgroups present/configured/accessible, ignoring error\");\n    return true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupNewDetect",
          "args": [
            "pid",
            "controllers",
            "group"
          ],
          "line": 1016
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupNewDetect",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "2838-2846",
          "snippet": "int\nvirCgroupNewDetect(pid_t pid G_GNUC_UNUSED,\n                   int controllers G_GNUC_UNUSED,\n                   virCgroupPtr *group G_GNUC_UNUSED)\n{\n    virReportSystemError(ENXIO, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupNewDetect(pid_t pid G_GNUC_UNUSED,\n                   int controllers G_GNUC_UNUSED,\n                   virCgroupPtr *group G_GNUC_UNUSED)\n{\n    virReportSystemError(ENXIO, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupNewDetectMachine(const char *name,\n                          const char *drivername,\n                          pid_t pid,\n                          int controllers,\n                          char *machinename,\n                          virCgroupPtr *group)\n{\n    size_t i;\n\n    if (virCgroupNewDetect(pid, controllers, group) < 0) {\n        if (virCgroupNewIgnoreError())\n            return 0;\n        return -1;\n    }\n\n    for (i = 0; i < VIR_CGROUP_BACKEND_TYPE_LAST; i++) {\n        if ((*group)->backends[i] &&\n            !(*group)->backends[i]->validateMachineGroup(*group, name,\n                                                         drivername,\n                                                         machinename)) {\n            VIR_DEBUG(\"Failed to validate machine name for '%s' driver '%s'\",\n                      name, drivername);\n            virCgroupFree(group);\n            return 0;\n        }\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virCgroupNewDetect",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "994-1000",
    "snippet": "int\nvirCgroupNewDetect(pid_t pid,\n                   int controllers,\n                   virCgroupPtr *group)\n{\n    return virCgroupNew(pid, \"\", NULL, controllers, group);\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCgroupNew",
          "args": [
            "pid",
            "\"\"",
            "NULL",
            "controllers",
            "group"
          ],
          "line": 999
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupNewThread",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "2825-2835",
          "snippet": "int\nvirCgroupNewThread(virCgroupPtr domain G_GNUC_UNUSED,\n                   virCgroupThreadName nameval G_GNUC_UNUSED,\n                   int id G_GNUC_UNUSED,\n                   bool create G_GNUC_UNUSED,\n                   virCgroupPtr *group G_GNUC_UNUSED)\n{\n    virReportSystemError(ENXIO, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupNewThread(virCgroupPtr domain G_GNUC_UNUSED,\n                   virCgroupThreadName nameval G_GNUC_UNUSED,\n                   int id G_GNUC_UNUSED,\n                   bool create G_GNUC_UNUSED,\n                   virCgroupPtr *group G_GNUC_UNUSED)\n{\n    virReportSystemError(ENXIO, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupNewDetect(pid_t pid,\n                   int controllers,\n                   virCgroupPtr *group)\n{\n    return virCgroupNew(pid, \"\", NULL, controllers, group);\n}"
  },
  {
    "function_name": "virCgroupNewThread",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "952-991",
    "snippet": "int\nvirCgroupNewThread(virCgroupPtr domain,\n                   virCgroupThreadName nameval,\n                   int id,\n                   bool create,\n                   virCgroupPtr *group)\n{\n    g_autofree char *name = NULL;\n    int controllers;\n\n    switch (nameval) {\n    case VIR_CGROUP_THREAD_VCPU:\n        name = g_strdup_printf(\"vcpu%d\", id);\n        break;\n    case VIR_CGROUP_THREAD_EMULATOR:\n        name = g_strdup(\"emulator\");\n        break;\n    case VIR_CGROUP_THREAD_IOTHREAD:\n        name = g_strdup_printf(\"iothread%d\", id);\n        break;\n    case VIR_CGROUP_THREAD_LAST:\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"unexpected name value %d\"), nameval);\n        return -1;\n    }\n\n    controllers = ((1 << VIR_CGROUP_CONTROLLER_CPU) |\n                   (1 << VIR_CGROUP_CONTROLLER_CPUACCT) |\n                   (1 << VIR_CGROUP_CONTROLLER_CPUSET));\n\n    if (virCgroupNew(-1, name, domain, controllers, group) < 0)\n        return -1;\n\n    if (virCgroupMakeGroup(domain, *group, create, VIR_CGROUP_THREAD) < 0) {\n        virCgroupFree(group);\n        return -1;\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCgroupFree",
          "args": [
            "group"
          ],
          "line": 986
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3544-3563",
          "snippet": "void\nvirCgroupFree(virCgroupPtr *group)\n{\n    size_t i;\n\n    if (*group == NULL)\n        return;\n\n    for (i = 0; i < VIR_CGROUP_CONTROLLER_LAST; i++) {\n        VIR_FREE((*group)->legacy[i].mountPoint);\n        VIR_FREE((*group)->legacy[i].linkPoint);\n        VIR_FREE((*group)->legacy[i].placement);\n    }\n\n    VIR_FREE((*group)->unified.mountPoint);\n    VIR_FREE((*group)->unified.placement);\n\n    VIR_FREE((*group)->path);\n    VIR_FREE(*group);\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nvoid\nvirCgroupFree(virCgroupPtr *group)\n{\n    size_t i;\n\n    if (*group == NULL)\n        return;\n\n    for (i = 0; i < VIR_CGROUP_CONTROLLER_LAST; i++) {\n        VIR_FREE((*group)->legacy[i].mountPoint);\n        VIR_FREE((*group)->legacy[i].linkPoint);\n        VIR_FREE((*group)->legacy[i].placement);\n    }\n\n    VIR_FREE((*group)->unified.mountPoint);\n    VIR_FREE((*group)->unified.placement);\n\n    VIR_FREE((*group)->path);\n    VIR_FREE(*group);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupMakeGroup",
          "args": [
            "domain",
            "*group",
            "create",
            "VIR_CGROUP_THREAD"
          ],
          "line": 985
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupMakeGroup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "625-642",
          "snippet": "static int\nvirCgroupMakeGroup(virCgroupPtr parent,\n                   virCgroupPtr group,\n                   bool create,\n                   unsigned int flags)\n{\n    size_t i;\n\n    for (i = 0; i < VIR_CGROUP_BACKEND_TYPE_LAST; i++) {\n        if (group->backends[i] &&\n            group->backends[i]->makeGroup(parent, group, create, flags) < 0) {\n            virCgroupRemove(group);\n            return -1;\n        }\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nstatic int\nvirCgroupMakeGroup(virCgroupPtr parent,\n                   virCgroupPtr group,\n                   bool create,\n                   unsigned int flags)\n{\n    size_t i;\n\n    for (i = 0; i < VIR_CGROUP_BACKEND_TYPE_LAST; i++) {\n        if (group->backends[i] &&\n            group->backends[i]->makeGroup(parent, group, create, flags) < 0) {\n            virCgroupRemove(group);\n            return -1;\n        }\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupNew",
          "args": [
            "-1",
            "name",
            "domain",
            "controllers",
            "group"
          ],
          "line": 982
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupNewThread",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "2825-2835",
          "snippet": "int\nvirCgroupNewThread(virCgroupPtr domain G_GNUC_UNUSED,\n                   virCgroupThreadName nameval G_GNUC_UNUSED,\n                   int id G_GNUC_UNUSED,\n                   bool create G_GNUC_UNUSED,\n                   virCgroupPtr *group G_GNUC_UNUSED)\n{\n    virReportSystemError(ENXIO, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"unexpected name value %d\")",
            "nameval"
          ],
          "line": 973
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"unexpected name value %d\""
          ],
          "line": 974
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupNewThread(virCgroupPtr domain,\n                   virCgroupThreadName nameval,\n                   int id,\n                   bool create,\n                   virCgroupPtr *group)\n{\n    g_autofree char *name = NULL;\n    int controllers;\n\n    switch (nameval) {\n    case VIR_CGROUP_THREAD_VCPU:\n        name = g_strdup_printf(\"vcpu%d\", id);\n        break;\n    case VIR_CGROUP_THREAD_EMULATOR:\n        name = g_strdup(\"emulator\");\n        break;\n    case VIR_CGROUP_THREAD_IOTHREAD:\n        name = g_strdup_printf(\"iothread%d\", id);\n        break;\n    case VIR_CGROUP_THREAD_LAST:\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"unexpected name value %d\"), nameval);\n        return -1;\n    }\n\n    controllers = ((1 << VIR_CGROUP_CONTROLLER_CPU) |\n                   (1 << VIR_CGROUP_CONTROLLER_CPUACCT) |\n                   (1 << VIR_CGROUP_CONTROLLER_CPUSET));\n\n    if (virCgroupNew(-1, name, domain, controllers, group) < 0)\n        return -1;\n\n    if (virCgroupMakeGroup(domain, *group, create, VIR_CGROUP_THREAD) < 0) {\n        virCgroupFree(group);\n        return -1;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virCgroupNewDomainPartition",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "904-938",
    "snippet": "int\nvirCgroupNewDomainPartition(virCgroupPtr partition,\n                            const char *driver,\n                            const char *name,\n                            bool create,\n                            virCgroupPtr *group)\n{\n    g_autofree char *grpname = NULL;\n\n    grpname = g_strdup_printf(\"%s.libvirt-%s\", name, driver);\n\n    if (virCgroupPartitionEscape(&grpname) < 0)\n        return -1;\n\n    if (virCgroupNew(-1, grpname, partition, -1, group) < 0)\n        return -1;\n\n    /*\n     * Create a cgroup with memory.use_hierarchy enabled to\n     * surely account memory usage of lxc with ns subsystem\n     * enabled. (To be exact, memory and ns subsystems are\n     * enabled at the same time.)\n     *\n     * The reason why doing it here, not a upper group, say\n     * a group for driver, is to avoid overhead to track\n     * cumulative usage that we don't need.\n     */\n    if (virCgroupMakeGroup(partition, *group, create,\n                           VIR_CGROUP_MEM_HIERACHY) < 0) {\n        virCgroupFree(group);\n        return -1;\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCgroupFree",
          "args": [
            "group"
          ],
          "line": 933
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3544-3563",
          "snippet": "void\nvirCgroupFree(virCgroupPtr *group)\n{\n    size_t i;\n\n    if (*group == NULL)\n        return;\n\n    for (i = 0; i < VIR_CGROUP_CONTROLLER_LAST; i++) {\n        VIR_FREE((*group)->legacy[i].mountPoint);\n        VIR_FREE((*group)->legacy[i].linkPoint);\n        VIR_FREE((*group)->legacy[i].placement);\n    }\n\n    VIR_FREE((*group)->unified.mountPoint);\n    VIR_FREE((*group)->unified.placement);\n\n    VIR_FREE((*group)->path);\n    VIR_FREE(*group);\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nvoid\nvirCgroupFree(virCgroupPtr *group)\n{\n    size_t i;\n\n    if (*group == NULL)\n        return;\n\n    for (i = 0; i < VIR_CGROUP_CONTROLLER_LAST; i++) {\n        VIR_FREE((*group)->legacy[i].mountPoint);\n        VIR_FREE((*group)->legacy[i].linkPoint);\n        VIR_FREE((*group)->legacy[i].placement);\n    }\n\n    VIR_FREE((*group)->unified.mountPoint);\n    VIR_FREE((*group)->unified.placement);\n\n    VIR_FREE((*group)->path);\n    VIR_FREE(*group);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupMakeGroup",
          "args": [
            "partition",
            "*group",
            "create",
            "VIR_CGROUP_MEM_HIERACHY"
          ],
          "line": 931
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupMakeGroup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "625-642",
          "snippet": "static int\nvirCgroupMakeGroup(virCgroupPtr parent,\n                   virCgroupPtr group,\n                   bool create,\n                   unsigned int flags)\n{\n    size_t i;\n\n    for (i = 0; i < VIR_CGROUP_BACKEND_TYPE_LAST; i++) {\n        if (group->backends[i] &&\n            group->backends[i]->makeGroup(parent, group, create, flags) < 0) {\n            virCgroupRemove(group);\n            return -1;\n        }\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nstatic int\nvirCgroupMakeGroup(virCgroupPtr parent,\n                   virCgroupPtr group,\n                   bool create,\n                   unsigned int flags)\n{\n    size_t i;\n\n    for (i = 0; i < VIR_CGROUP_BACKEND_TYPE_LAST; i++) {\n        if (group->backends[i] &&\n            group->backends[i]->makeGroup(parent, group, create, flags) < 0) {\n            virCgroupRemove(group);\n            return -1;\n        }\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupNew",
          "args": [
            "-1",
            "grpname",
            "partition",
            "-1",
            "group"
          ],
          "line": 918
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupNewThread",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "2825-2835",
          "snippet": "int\nvirCgroupNewThread(virCgroupPtr domain G_GNUC_UNUSED,\n                   virCgroupThreadName nameval G_GNUC_UNUSED,\n                   int id G_GNUC_UNUSED,\n                   bool create G_GNUC_UNUSED,\n                   virCgroupPtr *group G_GNUC_UNUSED)\n{\n    virReportSystemError(ENXIO, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupNewThread(virCgroupPtr domain G_GNUC_UNUSED,\n                   virCgroupThreadName nameval G_GNUC_UNUSED,\n                   int id G_GNUC_UNUSED,\n                   bool create G_GNUC_UNUSED,\n                   virCgroupPtr *group G_GNUC_UNUSED)\n{\n    virReportSystemError(ENXIO, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupPartitionEscape",
          "args": [
            "&grpname"
          ],
          "line": 915
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupPartitionEscape",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "198-213",
          "snippet": "int\nvirCgroupPartitionEscape(char **path)\n{\n    int rc;\n    char *newstr = NULL;\n\n    if ((rc = virCgroupPartitionNeedsEscaping(*path)) <= 0)\n        return rc;\n\n    newstr = g_strdup_printf(\"_%s\", *path);\n\n    VIR_FREE(*path);\n    *path = newstr;\n\n    return 0;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupPartitionEscape(char **path)\n{\n    int rc;\n    char *newstr = NULL;\n\n    if ((rc = virCgroupPartitionNeedsEscaping(*path)) <= 0)\n        return rc;\n\n    newstr = g_strdup_printf(\"_%s\", *path);\n\n    VIR_FREE(*path);\n    *path = newstr;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"%s.libvirt-%s\"",
            "name",
            "driver"
          ],
          "line": 913
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupNewDomainPartition(virCgroupPtr partition,\n                            const char *driver,\n                            const char *name,\n                            bool create,\n                            virCgroupPtr *group)\n{\n    g_autofree char *grpname = NULL;\n\n    grpname = g_strdup_printf(\"%s.libvirt-%s\", name, driver);\n\n    if (virCgroupPartitionEscape(&grpname) < 0)\n        return -1;\n\n    if (virCgroupNew(-1, grpname, partition, -1, group) < 0)\n        return -1;\n\n    /*\n     * Create a cgroup with memory.use_hierarchy enabled to\n     * surely account memory usage of lxc with ns subsystem\n     * enabled. (To be exact, memory and ns subsystems are\n     * enabled at the same time.)\n     *\n     * The reason why doing it here, not a upper group, say\n     * a group for driver, is to avoid overhead to track\n     * cumulative usage that we don't need.\n     */\n    if (virCgroupMakeGroup(partition, *group, create,\n                           VIR_CGROUP_MEM_HIERACHY) < 0) {\n        virCgroupFree(group);\n        return -1;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virCgroupNewSelf",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "887-891",
    "snippet": "int\nvirCgroupNewSelf(virCgroupPtr *group)\n{\n    return virCgroupNewDetect(-1, -1, group);\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCgroupNewDetect",
          "args": [
            "-1",
            "-1",
            "group"
          ],
          "line": 890
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupNewDetect",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "2838-2846",
          "snippet": "int\nvirCgroupNewDetect(pid_t pid G_GNUC_UNUSED,\n                   int controllers G_GNUC_UNUSED,\n                   virCgroupPtr *group G_GNUC_UNUSED)\n{\n    virReportSystemError(ENXIO, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupNewDetect(pid_t pid G_GNUC_UNUSED,\n                   int controllers G_GNUC_UNUSED,\n                   virCgroupPtr *group G_GNUC_UNUSED)\n{\n    virReportSystemError(ENXIO, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupNewSelf(virCgroupPtr *group)\n{\n    return virCgroupNewDetect(-1, -1, group);\n}"
  },
  {
    "function_name": "virCgroupNewPartition",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "825-874",
    "snippet": "int\nvirCgroupNewPartition(const char *path,\n                      bool create,\n                      int controllers,\n                      virCgroupPtr *group)\n{\n    int ret = -1;\n    g_autofree char *parentPath = NULL;\n    g_autofree char *newPath = NULL;\n    virCgroupPtr parent = NULL;\n    VIR_DEBUG(\"path=%s create=%d controllers=%x\",\n              path, create, controllers);\n\n    if (path[0] != '/') {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Partition path '%s' must start with '/'\"),\n                       path);\n        return -1;\n    }\n\n    if (virCgroupSetPartitionSuffix(path, &newPath) < 0)\n        goto cleanup;\n\n    if (STRNEQ(newPath, \"/\")) {\n        char *tmp;\n        parentPath = g_strdup(newPath);\n\n        tmp = strrchr(parentPath, '/');\n        tmp++;\n        *tmp = '\\0';\n\n        if (virCgroupNew(-1, parentPath, NULL, controllers, &parent) < 0)\n            goto cleanup;\n    }\n\n    if (virCgroupNew(-1, newPath, parent, controllers, group) < 0)\n        goto cleanup;\n\n    if (parent) {\n        if (virCgroupMakeGroup(parent, *group, create, VIR_CGROUP_NONE) < 0)\n            goto cleanup;\n    }\n\n    ret = 0;\n cleanup:\n    if (ret != 0)\n        virCgroupFree(group);\n    virCgroupFree(&parent);\n    return ret;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCgroupFree",
          "args": [
            "&parent"
          ],
          "line": 872
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3544-3563",
          "snippet": "void\nvirCgroupFree(virCgroupPtr *group)\n{\n    size_t i;\n\n    if (*group == NULL)\n        return;\n\n    for (i = 0; i < VIR_CGROUP_CONTROLLER_LAST; i++) {\n        VIR_FREE((*group)->legacy[i].mountPoint);\n        VIR_FREE((*group)->legacy[i].linkPoint);\n        VIR_FREE((*group)->legacy[i].placement);\n    }\n\n    VIR_FREE((*group)->unified.mountPoint);\n    VIR_FREE((*group)->unified.placement);\n\n    VIR_FREE((*group)->path);\n    VIR_FREE(*group);\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nvoid\nvirCgroupFree(virCgroupPtr *group)\n{\n    size_t i;\n\n    if (*group == NULL)\n        return;\n\n    for (i = 0; i < VIR_CGROUP_CONTROLLER_LAST; i++) {\n        VIR_FREE((*group)->legacy[i].mountPoint);\n        VIR_FREE((*group)->legacy[i].linkPoint);\n        VIR_FREE((*group)->legacy[i].placement);\n    }\n\n    VIR_FREE((*group)->unified.mountPoint);\n    VIR_FREE((*group)->unified.placement);\n\n    VIR_FREE((*group)->path);\n    VIR_FREE(*group);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupMakeGroup",
          "args": [
            "parent",
            "*group",
            "create",
            "VIR_CGROUP_NONE"
          ],
          "line": 864
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupMakeGroup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "625-642",
          "snippet": "static int\nvirCgroupMakeGroup(virCgroupPtr parent,\n                   virCgroupPtr group,\n                   bool create,\n                   unsigned int flags)\n{\n    size_t i;\n\n    for (i = 0; i < VIR_CGROUP_BACKEND_TYPE_LAST; i++) {\n        if (group->backends[i] &&\n            group->backends[i]->makeGroup(parent, group, create, flags) < 0) {\n            virCgroupRemove(group);\n            return -1;\n        }\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nstatic int\nvirCgroupMakeGroup(virCgroupPtr parent,\n                   virCgroupPtr group,\n                   bool create,\n                   unsigned int flags)\n{\n    size_t i;\n\n    for (i = 0; i < VIR_CGROUP_BACKEND_TYPE_LAST; i++) {\n        if (group->backends[i] &&\n            group->backends[i]->makeGroup(parent, group, create, flags) < 0) {\n            virCgroupRemove(group);\n            return -1;\n        }\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupNew",
          "args": [
            "-1",
            "newPath",
            "parent",
            "controllers",
            "group"
          ],
          "line": 860
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupNewThread",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "2825-2835",
          "snippet": "int\nvirCgroupNewThread(virCgroupPtr domain G_GNUC_UNUSED,\n                   virCgroupThreadName nameval G_GNUC_UNUSED,\n                   int id G_GNUC_UNUSED,\n                   bool create G_GNUC_UNUSED,\n                   virCgroupPtr *group G_GNUC_UNUSED)\n{\n    virReportSystemError(ENXIO, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupNewThread(virCgroupPtr domain G_GNUC_UNUSED,\n                   virCgroupThreadName nameval G_GNUC_UNUSED,\n                   int id G_GNUC_UNUSED,\n                   bool create G_GNUC_UNUSED,\n                   virCgroupPtr *group G_GNUC_UNUSED)\n{\n    virReportSystemError(ENXIO, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strrchr",
          "args": [
            "parentPath",
            "'/'"
          ],
          "line": 852
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "newPath"
          ],
          "line": 850
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "STRNEQ",
          "args": [
            "newPath",
            "\"/\""
          ],
          "line": 848
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCgroupSetPartitionSuffix",
          "args": [
            "path",
            "&newPath"
          ],
          "line": 845
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupSetPartitionSuffix",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "768-811",
          "snippet": "static int\nvirCgroupSetPartitionSuffix(const char *path, char **res)\n{\n    char **tokens;\n    size_t i;\n    int ret = -1;\n\n    if (!(tokens = virStringSplit(path, \"/\", 0)))\n        return ret;\n\n    for (i = 0; tokens[i] != NULL; i++) {\n        /* Whitelist the 3 top level fixed dirs\n         * NB i == 0 is \"\", since we have leading '/'\n         */\n        if (i == 1 &&\n            (STREQ(tokens[i], \"machine\") ||\n             STREQ(tokens[i], \"system\") ||\n             STREQ(tokens[i], \"user\"))) {\n            continue;\n        }\n        /* If there is no suffix set already, then\n         * add \".partition\"\n         */\n        if (STRNEQ(tokens[i], \"\") &&\n            !strchr(tokens[i], '.')) {\n            if (VIR_REALLOC_N(tokens[i],\n                              strlen(tokens[i]) + strlen(\".partition\") + 1) < 0)\n                goto cleanup;\n            strcat(tokens[i], \".partition\");\n        }\n\n        if (virCgroupPartitionEscape(&(tokens[i])) < 0)\n            goto cleanup;\n    }\n\n    if (!(*res = virStringListJoin((const char **)tokens, \"/\")))\n        goto cleanup;\n\n    ret = 0;\n\n cleanup:\n    virStringListFree(tokens);\n    return ret;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nstatic int\nvirCgroupSetPartitionSuffix(const char *path, char **res)\n{\n    char **tokens;\n    size_t i;\n    int ret = -1;\n\n    if (!(tokens = virStringSplit(path, \"/\", 0)))\n        return ret;\n\n    for (i = 0; tokens[i] != NULL; i++) {\n        /* Whitelist the 3 top level fixed dirs\n         * NB i == 0 is \"\", since we have leading '/'\n         */\n        if (i == 1 &&\n            (STREQ(tokens[i], \"machine\") ||\n             STREQ(tokens[i], \"system\") ||\n             STREQ(tokens[i], \"user\"))) {\n            continue;\n        }\n        /* If there is no suffix set already, then\n         * add \".partition\"\n         */\n        if (STRNEQ(tokens[i], \"\") &&\n            !strchr(tokens[i], '.')) {\n            if (VIR_REALLOC_N(tokens[i],\n                              strlen(tokens[i]) + strlen(\".partition\") + 1) < 0)\n                goto cleanup;\n            strcat(tokens[i], \".partition\");\n        }\n\n        if (virCgroupPartitionEscape(&(tokens[i])) < 0)\n            goto cleanup;\n    }\n\n    if (!(*res = virStringListJoin((const char **)tokens, \"/\")))\n        goto cleanup;\n\n    ret = 0;\n\n cleanup:\n    virStringListFree(tokens);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Partition path '%s' must start with '/'\")",
            "path"
          ],
          "line": 839
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"path=%s create=%d controllers=%x\"",
            "path",
            "create",
            "controllers"
          ],
          "line": 835
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupNewPartition(const char *path,\n                      bool create,\n                      int controllers,\n                      virCgroupPtr *group)\n{\n    int ret = -1;\n    g_autofree char *parentPath = NULL;\n    g_autofree char *newPath = NULL;\n    virCgroupPtr parent = NULL;\n    VIR_DEBUG(\"path=%s create=%d controllers=%x\",\n              path, create, controllers);\n\n    if (path[0] != '/') {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Partition path '%s' must start with '/'\"),\n                       path);\n        return -1;\n    }\n\n    if (virCgroupSetPartitionSuffix(path, &newPath) < 0)\n        goto cleanup;\n\n    if (STRNEQ(newPath, \"/\")) {\n        char *tmp;\n        parentPath = g_strdup(newPath);\n\n        tmp = strrchr(parentPath, '/');\n        tmp++;\n        *tmp = '\\0';\n\n        if (virCgroupNew(-1, parentPath, NULL, controllers, &parent) < 0)\n            goto cleanup;\n    }\n\n    if (virCgroupNew(-1, newPath, parent, controllers, group) < 0)\n        goto cleanup;\n\n    if (parent) {\n        if (virCgroupMakeGroup(parent, *group, create, VIR_CGROUP_NONE) < 0)\n            goto cleanup;\n    }\n\n    ret = 0;\n cleanup:\n    if (ret != 0)\n        virCgroupFree(group);\n    virCgroupFree(&parent);\n    return ret;\n}"
  },
  {
    "function_name": "virCgroupSetPartitionSuffix",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "768-811",
    "snippet": "static int\nvirCgroupSetPartitionSuffix(const char *path, char **res)\n{\n    char **tokens;\n    size_t i;\n    int ret = -1;\n\n    if (!(tokens = virStringSplit(path, \"/\", 0)))\n        return ret;\n\n    for (i = 0; tokens[i] != NULL; i++) {\n        /* Whitelist the 3 top level fixed dirs\n         * NB i == 0 is \"\", since we have leading '/'\n         */\n        if (i == 1 &&\n            (STREQ(tokens[i], \"machine\") ||\n             STREQ(tokens[i], \"system\") ||\n             STREQ(tokens[i], \"user\"))) {\n            continue;\n        }\n        /* If there is no suffix set already, then\n         * add \".partition\"\n         */\n        if (STRNEQ(tokens[i], \"\") &&\n            !strchr(tokens[i], '.')) {\n            if (VIR_REALLOC_N(tokens[i],\n                              strlen(tokens[i]) + strlen(\".partition\") + 1) < 0)\n                goto cleanup;\n            strcat(tokens[i], \".partition\");\n        }\n\n        if (virCgroupPartitionEscape(&(tokens[i])) < 0)\n            goto cleanup;\n    }\n\n    if (!(*res = virStringListJoin((const char **)tokens, \"/\")))\n        goto cleanup;\n\n    ret = 0;\n\n cleanup:\n    virStringListFree(tokens);\n    return ret;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virStringListFree",
          "args": [
            "tokens"
          ],
          "line": 809
        },
        "resolved": true,
        "details": {
          "function_name": "virStringListFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "306-314",
          "snippet": "void virStringListFree(char **strings)\n{\n    char **tmp = strings;\n    while (tmp && *tmp) {\n        VIR_FREE(*tmp);\n        tmp++;\n    }\n    VIR_FREE(strings);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nvoid virStringListFree(char **strings)\n{\n    char **tmp = strings;\n    while (tmp && *tmp) {\n        VIR_FREE(*tmp);\n        tmp++;\n    }\n    VIR_FREE(strings);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStringListJoin",
          "args": [
            "(const char **)tokens",
            "\"/\""
          ],
          "line": 803
        },
        "resolved": true,
        "details": {
          "function_name": "virStringListJoin",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "147-162",
          "snippet": "char *virStringListJoin(const char **strings,\n                        const char *delim)\n{\n    char *ret;\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n    while (*strings) {\n        virBufferAdd(&buf, *strings, -1);\n        if (*(strings+1))\n            virBufferAdd(&buf, delim, -1);\n        strings++;\n    }\n    ret = virBufferContentAndReset(&buf);\n    if (!ret)\n        ret = g_strdup(\"\");\n    return ret;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nchar *virStringListJoin(const char **strings,\n                        const char *delim)\n{\n    char *ret;\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n    while (*strings) {\n        virBufferAdd(&buf, *strings, -1);\n        if (*(strings+1))\n            virBufferAdd(&buf, delim, -1);\n        strings++;\n    }\n    ret = virBufferContentAndReset(&buf);\n    if (!ret)\n        ret = g_strdup(\"\");\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupPartitionEscape",
          "args": [
            "&(tokens[i])"
          ],
          "line": 799
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupPartitionEscape",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "198-213",
          "snippet": "int\nvirCgroupPartitionEscape(char **path)\n{\n    int rc;\n    char *newstr = NULL;\n\n    if ((rc = virCgroupPartitionNeedsEscaping(*path)) <= 0)\n        return rc;\n\n    newstr = g_strdup_printf(\"_%s\", *path);\n\n    VIR_FREE(*path);\n    *path = newstr;\n\n    return 0;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupPartitionEscape(char **path)\n{\n    int rc;\n    char *newstr = NULL;\n\n    if ((rc = virCgroupPartitionNeedsEscaping(*path)) <= 0)\n        return rc;\n\n    newstr = g_strdup_printf(\"_%s\", *path);\n\n    VIR_FREE(*path);\n    *path = newstr;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strcat",
          "args": [
            "tokens[i]",
            "\".partition\""
          ],
          "line": 796
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_REALLOC_N",
          "args": [
            "tokens[i]",
            "strlen(tokens[i]) + strlen(\".partition\") + 1"
          ],
          "line": 793
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "\".partition\""
          ],
          "line": 794
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "tokens[i]"
          ],
          "line": 794
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "tokens[i]",
            "'.'"
          ],
          "line": 792
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STRNEQ",
          "args": [
            "tokens[i]",
            "\"\""
          ],
          "line": 791
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "tokens[i]",
            "\"user\""
          ],
          "line": 785
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "tokens[i]",
            "\"system\""
          ],
          "line": 784
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "tokens[i]",
            "\"machine\""
          ],
          "line": 783
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStringSplit",
          "args": [
            "path",
            "\"/\"",
            "0"
          ],
          "line": 775
        },
        "resolved": true,
        "details": {
          "function_name": "virStringSplit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "126-132",
          "snippet": "char **\nvirStringSplit(const char *string,\n               const char *delim,\n               size_t max_tokens)\n{\n    return virStringSplitCount(string, delim, max_tokens, NULL);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nchar **\nvirStringSplit(const char *string,\n               const char *delim,\n               size_t max_tokens)\n{\n    return virStringSplitCount(string, delim, max_tokens, NULL);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nstatic int\nvirCgroupSetPartitionSuffix(const char *path, char **res)\n{\n    char **tokens;\n    size_t i;\n    int ret = -1;\n\n    if (!(tokens = virStringSplit(path, \"/\", 0)))\n        return ret;\n\n    for (i = 0; tokens[i] != NULL; i++) {\n        /* Whitelist the 3 top level fixed dirs\n         * NB i == 0 is \"\", since we have leading '/'\n         */\n        if (i == 1 &&\n            (STREQ(tokens[i], \"machine\") ||\n             STREQ(tokens[i], \"system\") ||\n             STREQ(tokens[i], \"user\"))) {\n            continue;\n        }\n        /* If there is no suffix set already, then\n         * add \".partition\"\n         */\n        if (STRNEQ(tokens[i], \"\") &&\n            !strchr(tokens[i], '.')) {\n            if (VIR_REALLOC_N(tokens[i],\n                              strlen(tokens[i]) + strlen(\".partition\") + 1) < 0)\n                goto cleanup;\n            strcat(tokens[i], \".partition\");\n        }\n\n        if (virCgroupPartitionEscape(&(tokens[i])) < 0)\n            goto cleanup;\n    }\n\n    if (!(*res = virStringListJoin((const char **)tokens, \"/\")))\n        goto cleanup;\n\n    ret = 0;\n\n cleanup:\n    virStringListFree(tokens);\n    return ret;\n}"
  },
  {
    "function_name": "virCgroupAddThread",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "760-765",
    "snippet": "int\nvirCgroupAddThread(virCgroupPtr group,\n                   pid_t pid)\n{\n    return virCgroupAddTaskInternal(group, pid, VIR_CGROUP_TASK_THREAD);\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCgroupAddTaskInternal",
          "args": [
            "group",
            "pid",
            "VIR_CGROUP_TASK_THREAD"
          ],
          "line": 764
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupAddTaskInternal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "695-710",
          "snippet": "static int\nvirCgroupAddTaskInternal(virCgroupPtr group,\n                         pid_t pid,\n                         unsigned int flags)\n{\n    size_t i;\n\n    for (i = 0; i < VIR_CGROUP_BACKEND_TYPE_LAST; i++) {\n        if (group->backends[i] &&\n            group->backends[i]->addTask(group, pid, flags) < 0) {\n            return -1;\n        }\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nstatic int\nvirCgroupAddTaskInternal(virCgroupPtr group,\n                         pid_t pid,\n                         unsigned int flags)\n{\n    size_t i;\n\n    for (i = 0; i < VIR_CGROUP_BACKEND_TYPE_LAST; i++) {\n        if (group->backends[i] &&\n            group->backends[i]->addTask(group, pid, flags) < 0) {\n            return -1;\n        }\n    }\n\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupAddThread(virCgroupPtr group,\n                   pid_t pid)\n{\n    return virCgroupAddTaskInternal(group, pid, VIR_CGROUP_TASK_THREAD);\n}"
  },
  {
    "function_name": "virCgroupAddMachineProcess",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "741-747",
    "snippet": "int\nvirCgroupAddMachineProcess(virCgroupPtr group, pid_t pid)\n{\n    return virCgroupAddTaskInternal(group, pid,\n                                    VIR_CGROUP_TASK_PROCESS |\n                                    VIR_CGROUP_TASK_SYSTEMD);\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCgroupAddTaskInternal",
          "args": [
            "group",
            "pid",
            "VIR_CGROUP_TASK_PROCESS |\n                                    VIR_CGROUP_TASK_SYSTEMD"
          ],
          "line": 744
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupAddTaskInternal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "695-710",
          "snippet": "static int\nvirCgroupAddTaskInternal(virCgroupPtr group,\n                         pid_t pid,\n                         unsigned int flags)\n{\n    size_t i;\n\n    for (i = 0; i < VIR_CGROUP_BACKEND_TYPE_LAST; i++) {\n        if (group->backends[i] &&\n            group->backends[i]->addTask(group, pid, flags) < 0) {\n            return -1;\n        }\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nstatic int\nvirCgroupAddTaskInternal(virCgroupPtr group,\n                         pid_t pid,\n                         unsigned int flags)\n{\n    size_t i;\n\n    for (i = 0; i < VIR_CGROUP_BACKEND_TYPE_LAST; i++) {\n        if (group->backends[i] &&\n            group->backends[i]->addTask(group, pid, flags) < 0) {\n            return -1;\n        }\n    }\n\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupAddMachineProcess(virCgroupPtr group, pid_t pid)\n{\n    return virCgroupAddTaskInternal(group, pid,\n                                    VIR_CGROUP_TASK_PROCESS |\n                                    VIR_CGROUP_TASK_SYSTEMD);\n}"
  },
  {
    "function_name": "virCgroupAddProcess",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "724-728",
    "snippet": "int\nvirCgroupAddProcess(virCgroupPtr group, pid_t pid)\n{\n    return virCgroupAddTaskInternal(group, pid, VIR_CGROUP_TASK_PROCESS);\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCgroupAddTaskInternal",
          "args": [
            "group",
            "pid",
            "VIR_CGROUP_TASK_PROCESS"
          ],
          "line": 727
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupAddTaskInternal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "695-710",
          "snippet": "static int\nvirCgroupAddTaskInternal(virCgroupPtr group,\n                         pid_t pid,\n                         unsigned int flags)\n{\n    size_t i;\n\n    for (i = 0; i < VIR_CGROUP_BACKEND_TYPE_LAST; i++) {\n        if (group->backends[i] &&\n            group->backends[i]->addTask(group, pid, flags) < 0) {\n            return -1;\n        }\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nstatic int\nvirCgroupAddTaskInternal(virCgroupPtr group,\n                         pid_t pid,\n                         unsigned int flags)\n{\n    size_t i;\n\n    for (i = 0; i < VIR_CGROUP_BACKEND_TYPE_LAST; i++) {\n        if (group->backends[i] &&\n            group->backends[i]->addTask(group, pid, flags) < 0) {\n            return -1;\n        }\n    }\n\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupAddProcess(virCgroupPtr group, pid_t pid)\n{\n    return virCgroupAddTaskInternal(group, pid, VIR_CGROUP_TASK_PROCESS);\n}"
  },
  {
    "function_name": "virCgroupAddTaskInternal",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "695-710",
    "snippet": "static int\nvirCgroupAddTaskInternal(virCgroupPtr group,\n                         pid_t pid,\n                         unsigned int flags)\n{\n    size_t i;\n\n    for (i = 0; i < VIR_CGROUP_BACKEND_TYPE_LAST; i++) {\n        if (group->backends[i] &&\n            group->backends[i]->addTask(group, pid, flags) < 0) {\n            return -1;\n        }\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "group->backends[i]->addTask",
          "args": [
            "group",
            "pid",
            "flags"
          ],
          "line": 704
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nstatic int\nvirCgroupAddTaskInternal(virCgroupPtr group,\n                         pid_t pid,\n                         unsigned int flags)\n{\n    size_t i;\n\n    for (i = 0; i < VIR_CGROUP_BACKEND_TYPE_LAST; i++) {\n        if (group->backends[i] &&\n            group->backends[i]->addTask(group, pid, flags) < 0) {\n            return -1;\n        }\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virCgroupNew",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "661-692",
    "snippet": "int\nvirCgroupNew(pid_t pid,\n             const char *path,\n             virCgroupPtr parent,\n             int controllers,\n             virCgroupPtr *group)\n{\n    VIR_DEBUG(\"pid=%lld path=%s parent=%p controllers=%d group=%p\",\n              (long long) pid, path, parent, controllers, group);\n    *group = NULL;\n\n    if (VIR_ALLOC((*group)) < 0)\n        goto error;\n\n    if (path[0] == '/' || !parent) {\n        (*group)->path = g_strdup(path);\n    } else {\n        (*group)->path = g_strdup_printf(\"%s%s%s\", parent->path,\n                                         STREQ(parent->path, \"\") ? \"\" : \"/\", path);\n    }\n\n    if (virCgroupDetect(*group, pid, controllers, path, parent) < 0)\n        goto error;\n\n    return 0;\n\n error:\n    virCgroupFree(group);\n    *group = NULL;\n\n    return -1;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCgroupFree",
          "args": [
            "group"
          ],
          "line": 688
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3544-3563",
          "snippet": "void\nvirCgroupFree(virCgroupPtr *group)\n{\n    size_t i;\n\n    if (*group == NULL)\n        return;\n\n    for (i = 0; i < VIR_CGROUP_CONTROLLER_LAST; i++) {\n        VIR_FREE((*group)->legacy[i].mountPoint);\n        VIR_FREE((*group)->legacy[i].linkPoint);\n        VIR_FREE((*group)->legacy[i].placement);\n    }\n\n    VIR_FREE((*group)->unified.mountPoint);\n    VIR_FREE((*group)->unified.placement);\n\n    VIR_FREE((*group)->path);\n    VIR_FREE(*group);\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nvoid\nvirCgroupFree(virCgroupPtr *group)\n{\n    size_t i;\n\n    if (*group == NULL)\n        return;\n\n    for (i = 0; i < VIR_CGROUP_CONTROLLER_LAST; i++) {\n        VIR_FREE((*group)->legacy[i].mountPoint);\n        VIR_FREE((*group)->legacy[i].linkPoint);\n        VIR_FREE((*group)->legacy[i].placement);\n    }\n\n    VIR_FREE((*group)->unified.mountPoint);\n    VIR_FREE((*group)->unified.placement);\n\n    VIR_FREE((*group)->path);\n    VIR_FREE(*group);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupDetect",
          "args": [
            "*group",
            "pid",
            "controllers",
            "path",
            "parent"
          ],
          "line": 682
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupDetect",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "335-420",
          "snippet": "static int\nvirCgroupDetect(virCgroupPtr group,\n                pid_t pid,\n                int controllers,\n                const char *path,\n                virCgroupPtr parent)\n{\n    size_t i;\n    bool backendAvailable = false;\n    int controllersAvailable = 0;\n    virCgroupBackendPtr *backends = virCgroupBackendGetAll();\n\n    VIR_DEBUG(\"group=%p controllers=%d path=%s parent=%p\",\n              group, controllers, path, parent);\n\n    if (!backends)\n        return -1;\n\n    for (i = 0; i < VIR_CGROUP_BACKEND_TYPE_LAST; i++) {\n        if (backends[i] && backends[i]->available()) {\n            group->backends[i] = backends[i];\n            backendAvailable = true;\n        }\n    }\n\n    if (!backendAvailable) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"no cgroup backend available\"));\n        return -1;\n    }\n\n    if (parent) {\n        for (i = 0; i < VIR_CGROUP_BACKEND_TYPE_LAST; i++) {\n            if (group->backends[i] &&\n                group->backends[i]->copyMounts(group, parent) < 0) {\n                return -1;\n            }\n        }\n    } else {\n        if (virCgroupDetectMounts(group) < 0)\n            return -1;\n    }\n\n    /* In some cases we can copy part of the placement info\n     * based on the parent cgroup...\n     */\n    if (parent || path[0] == '/') {\n        for (i = 0; i < VIR_CGROUP_BACKEND_TYPE_LAST; i++) {\n            if (group->backends[i] &&\n                group->backends[i]->copyPlacement(group, path, parent) < 0) {\n                return -1;\n            }\n        }\n    }\n\n    /* ... but use /proc/cgroups to fill in the rest */\n    if (virCgroupDetectPlacement(group, pid, path) < 0)\n        return -1;\n\n    /* Check that for every mounted controller, we found our placement */\n    for (i = 0; i < VIR_CGROUP_BACKEND_TYPE_LAST; i++) {\n        if (group->backends[i] &&\n            group->backends[i]->validatePlacement(group, pid) < 0) {\n            return -1;\n        }\n    }\n\n    for (i = 0; i < VIR_CGROUP_BACKEND_TYPE_LAST; i++) {\n        if (group->backends[i]) {\n            int rc = group->backends[i]->detectControllers(group, controllers, parent,\n                                                           controllersAvailable);\n            if (rc < 0)\n                return -1;\n            controllersAvailable |= rc;\n        }\n    }\n\n    /* Check that at least 1 controller is available */\n    if (controllersAvailable == 0) {\n        virReportSystemError(ENXIO, \"%s\",\n                             _(\"At least one cgroup controller is required\"));\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nstatic int\nvirCgroupDetect(virCgroupPtr group,\n                pid_t pid,\n                int controllers,\n                const char *path,\n                virCgroupPtr parent)\n{\n    size_t i;\n    bool backendAvailable = false;\n    int controllersAvailable = 0;\n    virCgroupBackendPtr *backends = virCgroupBackendGetAll();\n\n    VIR_DEBUG(\"group=%p controllers=%d path=%s parent=%p\",\n              group, controllers, path, parent);\n\n    if (!backends)\n        return -1;\n\n    for (i = 0; i < VIR_CGROUP_BACKEND_TYPE_LAST; i++) {\n        if (backends[i] && backends[i]->available()) {\n            group->backends[i] = backends[i];\n            backendAvailable = true;\n        }\n    }\n\n    if (!backendAvailable) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"no cgroup backend available\"));\n        return -1;\n    }\n\n    if (parent) {\n        for (i = 0; i < VIR_CGROUP_BACKEND_TYPE_LAST; i++) {\n            if (group->backends[i] &&\n                group->backends[i]->copyMounts(group, parent) < 0) {\n                return -1;\n            }\n        }\n    } else {\n        if (virCgroupDetectMounts(group) < 0)\n            return -1;\n    }\n\n    /* In some cases we can copy part of the placement info\n     * based on the parent cgroup...\n     */\n    if (parent || path[0] == '/') {\n        for (i = 0; i < VIR_CGROUP_BACKEND_TYPE_LAST; i++) {\n            if (group->backends[i] &&\n                group->backends[i]->copyPlacement(group, path, parent) < 0) {\n                return -1;\n            }\n        }\n    }\n\n    /* ... but use /proc/cgroups to fill in the rest */\n    if (virCgroupDetectPlacement(group, pid, path) < 0)\n        return -1;\n\n    /* Check that for every mounted controller, we found our placement */\n    for (i = 0; i < VIR_CGROUP_BACKEND_TYPE_LAST; i++) {\n        if (group->backends[i] &&\n            group->backends[i]->validatePlacement(group, pid) < 0) {\n            return -1;\n        }\n    }\n\n    for (i = 0; i < VIR_CGROUP_BACKEND_TYPE_LAST; i++) {\n        if (group->backends[i]) {\n            int rc = group->backends[i]->detectControllers(group, controllers, parent,\n                                                           controllersAvailable);\n            if (rc < 0)\n                return -1;\n            controllersAvailable |= rc;\n        }\n    }\n\n    /* Check that at least 1 controller is available */\n    if (controllersAvailable == 0) {\n        virReportSystemError(ENXIO, \"%s\",\n                             _(\"At least one cgroup controller is required\"));\n        return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"%s%s%s\"",
            "parent->path",
            "STREQ(parent->path, \"\") ? \"\" : \"/\"",
            "path"
          ],
          "line": 678
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "parent->path",
            "\"\""
          ],
          "line": 679
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC",
          "args": [
            "(*group)"
          ],
          "line": 672
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"pid=%lld path=%s parent=%p controllers=%d group=%p\"",
            "(long long) pid",
            "path",
            "parent",
            "controllers",
            "group"
          ],
          "line": 668
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupNew(pid_t pid,\n             const char *path,\n             virCgroupPtr parent,\n             int controllers,\n             virCgroupPtr *group)\n{\n    VIR_DEBUG(\"pid=%lld path=%s parent=%p controllers=%d group=%p\",\n              (long long) pid, path, parent, controllers, group);\n    *group = NULL;\n\n    if (VIR_ALLOC((*group)) < 0)\n        goto error;\n\n    if (path[0] == '/' || !parent) {\n        (*group)->path = g_strdup(path);\n    } else {\n        (*group)->path = g_strdup_printf(\"%s%s%s\", parent->path,\n                                         STREQ(parent->path, \"\") ? \"\" : \"/\", path);\n    }\n\n    if (virCgroupDetect(*group, pid, controllers, path, parent) < 0)\n        goto error;\n\n    return 0;\n\n error:\n    virCgroupFree(group);\n    *group = NULL;\n\n    return -1;\n}"
  },
  {
    "function_name": "virCgroupMakeGroup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "625-642",
    "snippet": "static int\nvirCgroupMakeGroup(virCgroupPtr parent,\n                   virCgroupPtr group,\n                   bool create,\n                   unsigned int flags)\n{\n    size_t i;\n\n    for (i = 0; i < VIR_CGROUP_BACKEND_TYPE_LAST; i++) {\n        if (group->backends[i] &&\n            group->backends[i]->makeGroup(parent, group, create, flags) < 0) {\n            virCgroupRemove(group);\n            return -1;\n        }\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCgroupRemove",
          "args": [
            "group"
          ],
          "line": 636
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupRemove",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3378-3384",
          "snippet": "int\nvirCgroupRemove(virCgroupPtr group G_GNUC_UNUSED)\n{\n    virReportSystemError(ENXIO, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupRemove(virCgroupPtr group G_GNUC_UNUSED)\n{\n    virReportSystemError(ENXIO, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "group->backends[i]->makeGroup",
          "args": [
            "parent",
            "group",
            "create",
            "flags"
          ],
          "line": 635
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nstatic int\nvirCgroupMakeGroup(virCgroupPtr parent,\n                   virCgroupPtr group,\n                   bool create,\n                   unsigned int flags)\n{\n    size_t i;\n\n    for (i = 0; i < VIR_CGROUP_BACKEND_TYPE_LAST; i++) {\n        if (group->backends[i] &&\n            group->backends[i]->makeGroup(parent, group, create, flags) < 0) {\n            virCgroupRemove(group);\n            return -1;\n        }\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virCgroupGetValueU64",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "603-622",
    "snippet": "int\nvirCgroupGetValueU64(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     unsigned long long int *value)\n{\n    g_autofree char *strval = NULL;\n\n    if (virCgroupGetValueStr(group, controller, key, &strval) < 0)\n        return -1;\n\n    if (virStrToLong_ull(strval, NULL, 10, value) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Unable to parse '%s' as an integer\"),\n                       strval);\n        return -1;\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Unable to parse '%s' as an integer\")",
            "strval"
          ],
          "line": 615
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to parse '%s' as an integer\""
          ],
          "line": 616
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStrToLong_ull",
          "args": [
            "strval",
            "NULL",
            "10",
            "value"
          ],
          "line": 614
        },
        "resolved": true,
        "details": {
          "function_name": "virStrToLong_ullp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "568-586",
          "snippet": "int\nvirStrToLong_ullp(char const *s, char **end_ptr, int base,\n                  unsigned long long *result)\n{\n    unsigned long long val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtoull(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToLong_ullp(char const *s, char **end_ptr, int base,\n                  unsigned long long *result)\n{\n    unsigned long long val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtoull(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupGetValueStr",
          "args": [
            "group",
            "controller",
            "key",
            "&strval"
          ],
          "line": 611
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupGetValueStr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "514-526",
          "snippet": "int\nvirCgroupGetValueStr(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     char **value)\n{\n    g_autofree char *keypath = NULL;\n\n    if (virCgroupPathOfController(group, controller, key, &keypath) < 0)\n        return -1;\n\n    return virCgroupGetValueRaw(keypath, value);\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetValueStr(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     char **value)\n{\n    g_autofree char *keypath = NULL;\n\n    if (virCgroupPathOfController(group, controller, key, &keypath) < 0)\n        return -1;\n\n    return virCgroupGetValueRaw(keypath, value);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetValueU64(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     unsigned long long int *value)\n{\n    g_autofree char *strval = NULL;\n\n    if (virCgroupGetValueStr(group, controller, key, &strval) < 0)\n        return -1;\n\n    if (virStrToLong_ull(strval, NULL, 10, value) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Unable to parse '%s' as an integer\"),\n                       strval);\n        return -1;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virCgroupGetValueI64",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "581-600",
    "snippet": "int\nvirCgroupGetValueI64(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     long long int *value)\n{\n    g_autofree char *strval = NULL;\n\n    if (virCgroupGetValueStr(group, controller, key, &strval) < 0)\n        return -1;\n\n    if (virStrToLong_ll(strval, NULL, 10, value) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Unable to parse '%s' as an integer\"),\n                       strval);\n        return -1;\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Unable to parse '%s' as an integer\")",
            "strval"
          ],
          "line": 593
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to parse '%s' as an integer\""
          ],
          "line": 594
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStrToLong_ll",
          "args": [
            "strval",
            "NULL",
            "10",
            "value"
          ],
          "line": 592
        },
        "resolved": true,
        "details": {
          "function_name": "virStrToLong_ll",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "526-542",
          "snippet": "int\nvirStrToLong_ll(char const *s, char **end_ptr, int base, long long *result)\n{\n    long long val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtoll(s, &p, base); /* exempt from syntax-check */\n    err = (errno || (!end_ptr && *p) || p == s);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToLong_ll(char const *s, char **end_ptr, int base, long long *result)\n{\n    long long val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtoll(s, &p, base); /* exempt from syntax-check */\n    err = (errno || (!end_ptr && *p) || p == s);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupGetValueStr",
          "args": [
            "group",
            "controller",
            "key",
            "&strval"
          ],
          "line": 589
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupGetValueStr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "514-526",
          "snippet": "int\nvirCgroupGetValueStr(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     char **value)\n{\n    g_autofree char *keypath = NULL;\n\n    if (virCgroupPathOfController(group, controller, key, &keypath) < 0)\n        return -1;\n\n    return virCgroupGetValueRaw(keypath, value);\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetValueStr(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     char **value)\n{\n    g_autofree char *keypath = NULL;\n\n    if (virCgroupPathOfController(group, controller, key, &keypath) < 0)\n        return -1;\n\n    return virCgroupGetValueRaw(keypath, value);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetValueI64(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     long long int *value)\n{\n    g_autofree char *strval = NULL;\n\n    if (virCgroupGetValueStr(group, controller, key, &strval) < 0)\n        return -1;\n\n    if (virStrToLong_ll(strval, NULL, 10, value) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Unable to parse '%s' as an integer\"),\n                       strval);\n        return -1;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virCgroupSetValueI64",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "567-578",
    "snippet": "int\nvirCgroupSetValueI64(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     long long int value)\n{\n    g_autofree char *strval = NULL;\n\n    strval = g_strdup_printf(\"%lld\", value);\n\n    return virCgroupSetValueStr(group, controller, key, strval);\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCgroupSetValueStr",
          "args": [
            "group",
            "controller",
            "key",
            "strval"
          ],
          "line": 577
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupSetValueStr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "499-511",
          "snippet": "int\nvirCgroupSetValueStr(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     const char *value)\n{\n    g_autofree char *keypath = NULL;\n\n    if (virCgroupPathOfController(group, controller, key, &keypath) < 0)\n        return -1;\n\n    return virCgroupSetValueRaw(keypath, value);\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupSetValueStr(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     const char *value)\n{\n    g_autofree char *keypath = NULL;\n\n    if (virCgroupPathOfController(group, controller, key, &keypath) < 0)\n        return -1;\n\n    return virCgroupSetValueRaw(keypath, value);\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"%lld\"",
            "value"
          ],
          "line": 575
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupSetValueI64(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     long long int value)\n{\n    g_autofree char *strval = NULL;\n\n    strval = g_strdup_printf(\"%lld\", value);\n\n    return virCgroupSetValueStr(group, controller, key, strval);\n}"
  },
  {
    "function_name": "virCgroupSetValueU64",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "553-564",
    "snippet": "int\nvirCgroupSetValueU64(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     unsigned long long int value)\n{\n    g_autofree char *strval = NULL;\n\n    strval = g_strdup_printf(\"%llu\", value);\n\n    return virCgroupSetValueStr(group, controller, key, strval);\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCgroupSetValueStr",
          "args": [
            "group",
            "controller",
            "key",
            "strval"
          ],
          "line": 563
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupSetValueStr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "499-511",
          "snippet": "int\nvirCgroupSetValueStr(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     const char *value)\n{\n    g_autofree char *keypath = NULL;\n\n    if (virCgroupPathOfController(group, controller, key, &keypath) < 0)\n        return -1;\n\n    return virCgroupSetValueRaw(keypath, value);\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupSetValueStr(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     const char *value)\n{\n    g_autofree char *keypath = NULL;\n\n    if (virCgroupPathOfController(group, controller, key, &keypath) < 0)\n        return -1;\n\n    return virCgroupSetValueRaw(keypath, value);\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"%llu\"",
            "value"
          ],
          "line": 561
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupSetValueU64(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     unsigned long long int value)\n{\n    g_autofree char *strval = NULL;\n\n    strval = g_strdup_printf(\"%llu\", value);\n\n    return virCgroupSetValueStr(group, controller, key, strval);\n}"
  },
  {
    "function_name": "virCgroupGetValueForBlkDev",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "529-550",
    "snippet": "int\nvirCgroupGetValueForBlkDev(const char *str,\n                           const char *path,\n                           char **value)\n{\n    g_autofree char *prefix = NULL;\n    char **lines = NULL;\n    int ret = -1;\n\n    if (!(prefix = virCgroupGetBlockDevString(path)))\n        goto error;\n\n    if (!(lines = virStringSplit(str, \"\\n\", -1)))\n        goto error;\n\n    *value = g_strdup(virStringListGetFirstWithPrefix(lines, prefix));\n\n    ret = 0;\n error:\n    virStringListFree(lines);\n    return ret;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virStringListFree",
          "args": [
            "lines"
          ],
          "line": 548
        },
        "resolved": true,
        "details": {
          "function_name": "virStringListFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "306-314",
          "snippet": "void virStringListFree(char **strings)\n{\n    char **tmp = strings;\n    while (tmp && *tmp) {\n        VIR_FREE(*tmp);\n        tmp++;\n    }\n    VIR_FREE(strings);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nvoid virStringListFree(char **strings)\n{\n    char **tmp = strings;\n    while (tmp && *tmp) {\n        VIR_FREE(*tmp);\n        tmp++;\n    }\n    VIR_FREE(strings);\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "virStringListGetFirstWithPrefix(lines, prefix)"
          ],
          "line": 544
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStringListGetFirstWithPrefix",
          "args": [
            "lines",
            "prefix"
          ],
          "line": 544
        },
        "resolved": true,
        "details": {
          "function_name": "virStringListGetFirstWithPrefix",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "367-383",
          "snippet": "char *\nvirStringListGetFirstWithPrefix(char **strings,\n                                const char *prefix)\n{\n    size_t i = 0;\n\n    if (!strings)\n        return NULL;\n\n    while (strings[i]) {\n        if (STRPREFIX(strings[i], prefix))\n            return strings[i] + strlen(prefix);\n        i++;\n    }\n\n    return NULL;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nchar *\nvirStringListGetFirstWithPrefix(char **strings,\n                                const char *prefix)\n{\n    size_t i = 0;\n\n    if (!strings)\n        return NULL;\n\n    while (strings[i]) {\n        if (STRPREFIX(strings[i], prefix))\n            return strings[i] + strlen(prefix);\n        i++;\n    }\n\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStringSplit",
          "args": [
            "str",
            "\"\\n\"",
            "-1"
          ],
          "line": 541
        },
        "resolved": true,
        "details": {
          "function_name": "virStringSplit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "126-132",
          "snippet": "char **\nvirStringSplit(const char *string,\n               const char *delim,\n               size_t max_tokens)\n{\n    return virStringSplitCount(string, delim, max_tokens, NULL);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nchar **\nvirStringSplit(const char *string,\n               const char *delim,\n               size_t max_tokens)\n{\n    return virStringSplitCount(string, delim, max_tokens, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupGetBlockDevString",
          "args": [
            "path"
          ],
          "line": 538
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupGetBlockDevString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "423-448",
          "snippet": "char *\nvirCgroupGetBlockDevString(const char *path)\n{\n    char *ret = NULL;\n    struct stat sb;\n\n    if (stat(path, &sb) < 0) {\n        virReportSystemError(errno,\n                             _(\"Path '%s' is not accessible\"),\n                             path);\n        return NULL;\n    }\n\n    if (!S_ISBLK(sb.st_mode)) {\n        virReportSystemError(EINVAL,\n                             _(\"Path '%s' must be a block device\"),\n                             path);\n        return NULL;\n    }\n\n    /* Automatically append space after the string since all callers\n     * use it anyway */\n    ret = g_strdup_printf(\"%d:%d \", major(sb.st_rdev), minor(sb.st_rdev));\n\n    return ret;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nchar *\nvirCgroupGetBlockDevString(const char *path)\n{\n    char *ret = NULL;\n    struct stat sb;\n\n    if (stat(path, &sb) < 0) {\n        virReportSystemError(errno,\n                             _(\"Path '%s' is not accessible\"),\n                             path);\n        return NULL;\n    }\n\n    if (!S_ISBLK(sb.st_mode)) {\n        virReportSystemError(EINVAL,\n                             _(\"Path '%s' must be a block device\"),\n                             path);\n        return NULL;\n    }\n\n    /* Automatically append space after the string since all callers\n     * use it anyway */\n    ret = g_strdup_printf(\"%d:%d \", major(sb.st_rdev), minor(sb.st_rdev));\n\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetValueForBlkDev(const char *str,\n                           const char *path,\n                           char **value)\n{\n    g_autofree char *prefix = NULL;\n    char **lines = NULL;\n    int ret = -1;\n\n    if (!(prefix = virCgroupGetBlockDevString(path)))\n        goto error;\n\n    if (!(lines = virStringSplit(str, \"\\n\", -1)))\n        goto error;\n\n    *value = g_strdup(virStringListGetFirstWithPrefix(lines, prefix));\n\n    ret = 0;\n error:\n    virStringListFree(lines);\n    return ret;\n}"
  },
  {
    "function_name": "virCgroupGetValueStr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "514-526",
    "snippet": "int\nvirCgroupGetValueStr(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     char **value)\n{\n    g_autofree char *keypath = NULL;\n\n    if (virCgroupPathOfController(group, controller, key, &keypath) < 0)\n        return -1;\n\n    return virCgroupGetValueRaw(keypath, value);\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCgroupGetValueRaw",
          "args": [
            "keypath",
            "value"
          ],
          "line": 525
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupGetValueRaw",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "475-496",
          "snippet": "int\nvirCgroupGetValueRaw(const char *path,\n                     char **value)\n{\n    int rc;\n\n    *value = NULL;\n\n    VIR_DEBUG(\"Get value %s\", path);\n\n    if ((rc = virFileReadAll(path, 1024*1024, value)) < 0) {\n        virReportSystemError(errno,\n                             _(\"Unable to read from '%s'\"), path);\n        return -1;\n    }\n\n    /* Terminated with '\\n' has sometimes harmful effects to the caller */\n    if (rc > 0 && (*value)[rc - 1] == '\\n')\n        (*value)[rc - 1] = '\\0';\n\n    return 0;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetValueRaw(const char *path,\n                     char **value)\n{\n    int rc;\n\n    *value = NULL;\n\n    VIR_DEBUG(\"Get value %s\", path);\n\n    if ((rc = virFileReadAll(path, 1024*1024, value)) < 0) {\n        virReportSystemError(errno,\n                             _(\"Unable to read from '%s'\"), path);\n        return -1;\n    }\n\n    /* Terminated with '\\n' has sometimes harmful effects to the caller */\n    if (rc > 0 && (*value)[rc - 1] == '\\n')\n        (*value)[rc - 1] = '\\0';\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupPathOfController",
          "args": [
            "group",
            "controller",
            "key",
            "&keypath"
          ],
          "line": 522
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupPathOfController",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "2907-2916",
          "snippet": "int\nvirCgroupPathOfController(virCgroupPtr group G_GNUC_UNUSED,\n                          unsigned int controller G_GNUC_UNUSED,\n                          const char *key G_GNUC_UNUSED,\n                          char **path G_GNUC_UNUSED)\n{\n    virReportSystemError(ENXIO, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupPathOfController(virCgroupPtr group G_GNUC_UNUSED,\n                          unsigned int controller G_GNUC_UNUSED,\n                          const char *key G_GNUC_UNUSED,\n                          char **path G_GNUC_UNUSED)\n{\n    virReportSystemError(ENXIO, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetValueStr(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     char **value)\n{\n    g_autofree char *keypath = NULL;\n\n    if (virCgroupPathOfController(group, controller, key, &keypath) < 0)\n        return -1;\n\n    return virCgroupGetValueRaw(keypath, value);\n}"
  },
  {
    "function_name": "virCgroupSetValueStr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "499-511",
    "snippet": "int\nvirCgroupSetValueStr(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     const char *value)\n{\n    g_autofree char *keypath = NULL;\n\n    if (virCgroupPathOfController(group, controller, key, &keypath) < 0)\n        return -1;\n\n    return virCgroupSetValueRaw(keypath, value);\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCgroupSetValueRaw",
          "args": [
            "keypath",
            "value"
          ],
          "line": 510
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupSetValueRaw",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "451-472",
          "snippet": "int\nvirCgroupSetValueRaw(const char *path,\n                     const char *value)\n{\n    char *tmp;\n\n    VIR_DEBUG(\"Set value '%s' to '%s'\", path, value);\n    if (virFileWriteStr(path, value, 0) < 0) {\n        if (errno == EINVAL &&\n            (tmp = strrchr(path, '/'))) {\n            virReportSystemError(errno,\n                                 _(\"Invalid value '%s' for '%s'\"),\n                                 value, tmp + 1);\n            return -1;\n        }\n        virReportSystemError(errno,\n                             _(\"Unable to write to '%s'\"), path);\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupSetValueRaw(const char *path,\n                     const char *value)\n{\n    char *tmp;\n\n    VIR_DEBUG(\"Set value '%s' to '%s'\", path, value);\n    if (virFileWriteStr(path, value, 0) < 0) {\n        if (errno == EINVAL &&\n            (tmp = strrchr(path, '/'))) {\n            virReportSystemError(errno,\n                                 _(\"Invalid value '%s' for '%s'\"),\n                                 value, tmp + 1);\n            return -1;\n        }\n        virReportSystemError(errno,\n                             _(\"Unable to write to '%s'\"), path);\n        return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupPathOfController",
          "args": [
            "group",
            "controller",
            "key",
            "&keypath"
          ],
          "line": 507
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupPathOfController",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "2907-2916",
          "snippet": "int\nvirCgroupPathOfController(virCgroupPtr group G_GNUC_UNUSED,\n                          unsigned int controller G_GNUC_UNUSED,\n                          const char *key G_GNUC_UNUSED,\n                          char **path G_GNUC_UNUSED)\n{\n    virReportSystemError(ENXIO, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupPathOfController(virCgroupPtr group G_GNUC_UNUSED,\n                          unsigned int controller G_GNUC_UNUSED,\n                          const char *key G_GNUC_UNUSED,\n                          char **path G_GNUC_UNUSED)\n{\n    virReportSystemError(ENXIO, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupSetValueStr(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     const char *value)\n{\n    g_autofree char *keypath = NULL;\n\n    if (virCgroupPathOfController(group, controller, key, &keypath) < 0)\n        return -1;\n\n    return virCgroupSetValueRaw(keypath, value);\n}"
  },
  {
    "function_name": "virCgroupGetValueRaw",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "475-496",
    "snippet": "int\nvirCgroupGetValueRaw(const char *path,\n                     char **value)\n{\n    int rc;\n\n    *value = NULL;\n\n    VIR_DEBUG(\"Get value %s\", path);\n\n    if ((rc = virFileReadAll(path, 1024*1024, value)) < 0) {\n        virReportSystemError(errno,\n                             _(\"Unable to read from '%s'\"), path);\n        return -1;\n    }\n\n    /* Terminated with '\\n' has sometimes harmful effects to the caller */\n    if (rc > 0 && (*value)[rc - 1] == '\\n')\n        (*value)[rc - 1] = '\\0';\n\n    return 0;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"Unable to read from '%s'\")",
            "path"
          ],
          "line": 486
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to read from '%s'\""
          ],
          "line": 487
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virFileReadAll",
          "args": [
            "path",
            "1024*1024",
            "value"
          ],
          "line": 485
        },
        "resolved": true,
        "details": {
          "function_name": "virFileReadAllQuiet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1459-1472",
          "snippet": "int\nvirFileReadAllQuiet(const char *path, int maxlen, char **buf)\n{\n    int fd = open(path, O_RDONLY);\n    if (fd < 0)\n        return -errno;\n\n    int len = virFileReadLimFD(fd, maxlen, buf);\n    VIR_FORCE_CLOSE(fd);\n    if (len < 0)\n        return -errno;\n\n    return len;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileReadAllQuiet(const char *path, int maxlen, char **buf)\n{\n    int fd = open(path, O_RDONLY);\n    if (fd < 0)\n        return -errno;\n\n    int len = virFileReadLimFD(fd, maxlen, buf);\n    VIR_FORCE_CLOSE(fd);\n    if (len < 0)\n        return -errno;\n\n    return len;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Get value %s\"",
            "path"
          ],
          "line": 483
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetValueRaw(const char *path,\n                     char **value)\n{\n    int rc;\n\n    *value = NULL;\n\n    VIR_DEBUG(\"Get value %s\", path);\n\n    if ((rc = virFileReadAll(path, 1024*1024, value)) < 0) {\n        virReportSystemError(errno,\n                             _(\"Unable to read from '%s'\"), path);\n        return -1;\n    }\n\n    /* Terminated with '\\n' has sometimes harmful effects to the caller */\n    if (rc > 0 && (*value)[rc - 1] == '\\n')\n        (*value)[rc - 1] = '\\0';\n\n    return 0;\n}"
  },
  {
    "function_name": "virCgroupSetValueRaw",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "451-472",
    "snippet": "int\nvirCgroupSetValueRaw(const char *path,\n                     const char *value)\n{\n    char *tmp;\n\n    VIR_DEBUG(\"Set value '%s' to '%s'\", path, value);\n    if (virFileWriteStr(path, value, 0) < 0) {\n        if (errno == EINVAL &&\n            (tmp = strrchr(path, '/'))) {\n            virReportSystemError(errno,\n                                 _(\"Invalid value '%s' for '%s'\"),\n                                 value, tmp + 1);\n            return -1;\n        }\n        virReportSystemError(errno,\n                             _(\"Unable to write to '%s'\"), path);\n        return -1;\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"Unable to write to '%s'\")",
            "path"
          ],
          "line": 466
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to write to '%s'\""
          ],
          "line": 467
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"Invalid value '%s' for '%s'\")",
            "value",
            "tmp + 1"
          ],
          "line": 461
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strrchr",
          "args": [
            "path",
            "'/'"
          ],
          "line": 460
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virFileWriteStr",
          "args": [
            "path",
            "value",
            "0"
          ],
          "line": 458
        },
        "resolved": true,
        "details": {
          "function_name": "virFileWriteStr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1502-1524",
          "snippet": "int\nvirFileWriteStr(const char *path, const char *str, mode_t mode)\n{\n    int fd;\n\n    if (mode)\n        fd = open(path, O_WRONLY|O_TRUNC|O_CREAT, mode);\n    else\n        fd = open(path, O_WRONLY|O_TRUNC);\n    if (fd == -1)\n        return -1;\n\n    if (safewrite(fd, str, strlen(str)) < 0) {\n        VIR_FORCE_CLOSE(fd);\n        return -1;\n    }\n\n    /* Use errno from failed close only if there was no write error.  */\n    if (VIR_CLOSE(fd) != 0)\n        return -1;\n\n    return 0;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileWriteStr(const char *path, const char *str, mode_t mode)\n{\n    int fd;\n\n    if (mode)\n        fd = open(path, O_WRONLY|O_TRUNC|O_CREAT, mode);\n    else\n        fd = open(path, O_WRONLY|O_TRUNC);\n    if (fd == -1)\n        return -1;\n\n    if (safewrite(fd, str, strlen(str)) < 0) {\n        VIR_FORCE_CLOSE(fd);\n        return -1;\n    }\n\n    /* Use errno from failed close only if there was no write error.  */\n    if (VIR_CLOSE(fd) != 0)\n        return -1;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Set value '%s' to '%s'\"",
            "path",
            "value"
          ],
          "line": 457
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupSetValueRaw(const char *path,\n                     const char *value)\n{\n    char *tmp;\n\n    VIR_DEBUG(\"Set value '%s' to '%s'\", path, value);\n    if (virFileWriteStr(path, value, 0) < 0) {\n        if (errno == EINVAL &&\n            (tmp = strrchr(path, '/'))) {\n            virReportSystemError(errno,\n                                 _(\"Invalid value '%s' for '%s'\"),\n                                 value, tmp + 1);\n            return -1;\n        }\n        virReportSystemError(errno,\n                             _(\"Unable to write to '%s'\"), path);\n        return -1;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virCgroupGetBlockDevString",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "423-448",
    "snippet": "char *\nvirCgroupGetBlockDevString(const char *path)\n{\n    char *ret = NULL;\n    struct stat sb;\n\n    if (stat(path, &sb) < 0) {\n        virReportSystemError(errno,\n                             _(\"Path '%s' is not accessible\"),\n                             path);\n        return NULL;\n    }\n\n    if (!S_ISBLK(sb.st_mode)) {\n        virReportSystemError(EINVAL,\n                             _(\"Path '%s' must be a block device\"),\n                             path);\n        return NULL;\n    }\n\n    /* Automatically append space after the string since all callers\n     * use it anyway */\n    ret = g_strdup_printf(\"%d:%d \", major(sb.st_rdev), minor(sb.st_rdev));\n\n    return ret;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"%d:%d \"",
            "major(sb.st_rdev)",
            "minor(sb.st_rdev)"
          ],
          "line": 445
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "minor",
          "args": [
            "sb.st_rdev"
          ],
          "line": 445
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "major",
          "args": [
            "sb.st_rdev"
          ],
          "line": 445
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "EINVAL",
            "_(\"Path '%s' must be a block device\")",
            "path"
          ],
          "line": 437
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "S_ISBLK",
          "args": [
            "sb.st_mode"
          ],
          "line": 436
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"Path '%s' is not accessible\")",
            "path"
          ],
          "line": 430
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "stat",
          "args": [
            "path",
            "&sb"
          ],
          "line": 429
        },
        "resolved": true,
        "details": {
          "function_name": "profile_status",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_apparmor.c",
          "lines": "70-108",
          "snippet": "static int\nprofile_status(const char *str, const int check_enforcing)\n{\n    char *content = NULL;\n    char *tmp = NULL;\n    char *etmp = NULL;\n    int rc = -2;\n\n    /* create string that is '<str> \\0' for accurate matching */\n    tmp = g_strdup_printf(\"%s \", str);\n\n    if (check_enforcing != 0) {\n        /* create string that is '<str> (enforce)\\0' for accurate matching */\n        etmp = g_strdup_printf(\"%s (enforce)\", str);\n    }\n\n    if (virFileReadAll(APPARMOR_PROFILES_PATH, MAX_FILE_LEN, &content) < 0) {\n        virReportSystemError(errno,\n                             _(\"Failed to read AppArmor profiles list \"\n                             \"\\'%s\\'\"), APPARMOR_PROFILES_PATH);\n        goto cleanup;\n    }\n\n    if (strstr(content, tmp) != NULL)\n        rc = 0;\n    else\n        rc = -1; /* return -1 if not loaded */\n    if (check_enforcing != 0) {\n        if (rc == 0 && strstr(content, etmp) != NULL)\n            rc = 1;                 /* return '1' if loaded and enforcing */\n    }\n\n    VIR_FREE(content);\n cleanup:\n    VIR_FREE(tmp);\n    VIR_FREE(etmp);\n\n    return rc;\n}",
          "includes": [
            "#include \"virmdev.h\"",
            "#include \"virscsi.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"vircommand.h\"",
            "#include \"configmake.h\"",
            "#include \"virfile.h\"",
            "#include \"virscsivhost.h\"",
            "#include \"virusb.h\"",
            "#include \"virpci.h\"",
            "#include \"viruuid.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"security_apparmor.h\"",
            "#include \"internal.h\"",
            "#include <wait.h>",
            "#include <unistd.h>",
            "#include <sys/apparmor.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virmdev.h\"\n#include \"virscsi.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"configmake.h\"\n#include \"virfile.h\"\n#include \"virscsivhost.h\"\n#include \"virusb.h\"\n#include \"virpci.h\"\n#include \"viruuid.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"security_apparmor.h\"\n#include \"internal.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/apparmor.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nprofile_status(const char *str, const int check_enforcing)\n{\n    char *content = NULL;\n    char *tmp = NULL;\n    char *etmp = NULL;\n    int rc = -2;\n\n    /* create string that is '<str> \\0' for accurate matching */\n    tmp = g_strdup_printf(\"%s \", str);\n\n    if (check_enforcing != 0) {\n        /* create string that is '<str> (enforce)\\0' for accurate matching */\n        etmp = g_strdup_printf(\"%s (enforce)\", str);\n    }\n\n    if (virFileReadAll(APPARMOR_PROFILES_PATH, MAX_FILE_LEN, &content) < 0) {\n        virReportSystemError(errno,\n                             _(\"Failed to read AppArmor profiles list \"\n                             \"\\'%s\\'\"), APPARMOR_PROFILES_PATH);\n        goto cleanup;\n    }\n\n    if (strstr(content, tmp) != NULL)\n        rc = 0;\n    else\n        rc = -1; /* return -1 if not loaded */\n    if (check_enforcing != 0) {\n        if (rc == 0 && strstr(content, etmp) != NULL)\n            rc = 1;                 /* return '1' if loaded and enforcing */\n    }\n\n    VIR_FREE(content);\n cleanup:\n    VIR_FREE(tmp);\n    VIR_FREE(etmp);\n\n    return rc;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nchar *\nvirCgroupGetBlockDevString(const char *path)\n{\n    char *ret = NULL;\n    struct stat sb;\n\n    if (stat(path, &sb) < 0) {\n        virReportSystemError(errno,\n                             _(\"Path '%s' is not accessible\"),\n                             path);\n        return NULL;\n    }\n\n    if (!S_ISBLK(sb.st_mode)) {\n        virReportSystemError(EINVAL,\n                             _(\"Path '%s' must be a block device\"),\n                             path);\n        return NULL;\n    }\n\n    /* Automatically append space after the string since all callers\n     * use it anyway */\n    ret = g_strdup_printf(\"%d:%d \", major(sb.st_rdev), minor(sb.st_rdev));\n\n    return ret;\n}"
  },
  {
    "function_name": "virCgroupDetect",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "335-420",
    "snippet": "static int\nvirCgroupDetect(virCgroupPtr group,\n                pid_t pid,\n                int controllers,\n                const char *path,\n                virCgroupPtr parent)\n{\n    size_t i;\n    bool backendAvailable = false;\n    int controllersAvailable = 0;\n    virCgroupBackendPtr *backends = virCgroupBackendGetAll();\n\n    VIR_DEBUG(\"group=%p controllers=%d path=%s parent=%p\",\n              group, controllers, path, parent);\n\n    if (!backends)\n        return -1;\n\n    for (i = 0; i < VIR_CGROUP_BACKEND_TYPE_LAST; i++) {\n        if (backends[i] && backends[i]->available()) {\n            group->backends[i] = backends[i];\n            backendAvailable = true;\n        }\n    }\n\n    if (!backendAvailable) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"no cgroup backend available\"));\n        return -1;\n    }\n\n    if (parent) {\n        for (i = 0; i < VIR_CGROUP_BACKEND_TYPE_LAST; i++) {\n            if (group->backends[i] &&\n                group->backends[i]->copyMounts(group, parent) < 0) {\n                return -1;\n            }\n        }\n    } else {\n        if (virCgroupDetectMounts(group) < 0)\n            return -1;\n    }\n\n    /* In some cases we can copy part of the placement info\n     * based on the parent cgroup...\n     */\n    if (parent || path[0] == '/') {\n        for (i = 0; i < VIR_CGROUP_BACKEND_TYPE_LAST; i++) {\n            if (group->backends[i] &&\n                group->backends[i]->copyPlacement(group, path, parent) < 0) {\n                return -1;\n            }\n        }\n    }\n\n    /* ... but use /proc/cgroups to fill in the rest */\n    if (virCgroupDetectPlacement(group, pid, path) < 0)\n        return -1;\n\n    /* Check that for every mounted controller, we found our placement */\n    for (i = 0; i < VIR_CGROUP_BACKEND_TYPE_LAST; i++) {\n        if (group->backends[i] &&\n            group->backends[i]->validatePlacement(group, pid) < 0) {\n            return -1;\n        }\n    }\n\n    for (i = 0; i < VIR_CGROUP_BACKEND_TYPE_LAST; i++) {\n        if (group->backends[i]) {\n            int rc = group->backends[i]->detectControllers(group, controllers, parent,\n                                                           controllersAvailable);\n            if (rc < 0)\n                return -1;\n            controllersAvailable |= rc;\n        }\n    }\n\n    /* Check that at least 1 controller is available */\n    if (controllersAvailable == 0) {\n        virReportSystemError(ENXIO, \"%s\",\n                             _(\"At least one cgroup controller is required\"));\n        return -1;\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENXIO",
            "\"%s\"",
            "_(\"At least one cgroup controller is required\")"
          ],
          "line": 414
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"At least one cgroup controller is required\""
          ],
          "line": 415
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "group->backends[i]->detectControllers",
          "args": [
            "group",
            "controllers",
            "parent",
            "controllersAvailable"
          ],
          "line": 404
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "group->backends[i]->validatePlacement",
          "args": [
            "group",
            "pid"
          ],
          "line": 397
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCgroupDetectPlacement",
          "args": [
            "group",
            "pid",
            "path"
          ],
          "line": 391
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupDetectPlacement",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "276-332",
          "snippet": "static int\nvirCgroupDetectPlacement(virCgroupPtr group,\n                         pid_t pid,\n                         const char *path)\n{\n    FILE *mapping  = NULL;\n    char line[1024];\n    int ret = -1;\n    g_autofree char *procfile = NULL;\n\n    VIR_DEBUG(\"Detecting placement for pid %lld path %s\",\n              (long long) pid, path);\n    if (pid == -1) {\n        procfile = g_strdup(\"/proc/self/cgroup\");\n    } else {\n        procfile = g_strdup_printf(\"/proc/%lld/cgroup\", (long long)pid);\n    }\n\n    mapping = fopen(procfile, \"r\");\n    if (mapping == NULL) {\n        virReportSystemError(errno,\n                             _(\"Unable to open '%s'\"),\n                             procfile);\n        goto cleanup;\n    }\n\n    while (fgets(line, sizeof(line), mapping) != NULL) {\n        size_t i;\n        char *controllers = strchr(line, ':');\n        char *selfpath = controllers ? strchr(controllers + 1, ':') : NULL;\n        char *nl = selfpath ? strchr(selfpath, '\\n') : NULL;\n\n        if (!controllers || !selfpath)\n            continue;\n\n        if (nl)\n            *nl = '\\0';\n\n        *selfpath = '\\0';\n        controllers++;\n        selfpath++;\n\n        for (i = 0; i < VIR_CGROUP_BACKEND_TYPE_LAST; i++) {\n            if (group->backends[i] &&\n                group->backends[i]->detectPlacement(group, path, controllers,\n                                                    selfpath) < 0) {\n                goto cleanup;\n            }\n        }\n    }\n\n    ret = 0;\n\n cleanup:\n    VIR_FORCE_FCLOSE(mapping);\n    return ret;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nstatic int\nvirCgroupDetectPlacement(virCgroupPtr group,\n                         pid_t pid,\n                         const char *path)\n{\n    FILE *mapping  = NULL;\n    char line[1024];\n    int ret = -1;\n    g_autofree char *procfile = NULL;\n\n    VIR_DEBUG(\"Detecting placement for pid %lld path %s\",\n              (long long) pid, path);\n    if (pid == -1) {\n        procfile = g_strdup(\"/proc/self/cgroup\");\n    } else {\n        procfile = g_strdup_printf(\"/proc/%lld/cgroup\", (long long)pid);\n    }\n\n    mapping = fopen(procfile, \"r\");\n    if (mapping == NULL) {\n        virReportSystemError(errno,\n                             _(\"Unable to open '%s'\"),\n                             procfile);\n        goto cleanup;\n    }\n\n    while (fgets(line, sizeof(line), mapping) != NULL) {\n        size_t i;\n        char *controllers = strchr(line, ':');\n        char *selfpath = controllers ? strchr(controllers + 1, ':') : NULL;\n        char *nl = selfpath ? strchr(selfpath, '\\n') : NULL;\n\n        if (!controllers || !selfpath)\n            continue;\n\n        if (nl)\n            *nl = '\\0';\n\n        *selfpath = '\\0';\n        controllers++;\n        selfpath++;\n\n        for (i = 0; i < VIR_CGROUP_BACKEND_TYPE_LAST; i++) {\n            if (group->backends[i] &&\n                group->backends[i]->detectPlacement(group, path, controllers,\n                                                    selfpath) < 0) {\n                goto cleanup;\n            }\n        }\n    }\n\n    ret = 0;\n\n cleanup:\n    VIR_FORCE_FCLOSE(mapping);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "group->backends[i]->copyPlacement",
          "args": [
            "group",
            "path",
            "parent"
          ],
          "line": 384
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCgroupDetectMounts",
          "args": [
            "group"
          ],
          "line": 374
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupDetectMounts",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "220-251",
          "snippet": "static int\nvirCgroupDetectMounts(virCgroupPtr group)\n{\n    FILE *mounts = NULL;\n    struct mntent entry;\n    char buf[CGROUP_MAX_VAL];\n    int ret = -1;\n    size_t i;\n\n    mounts = fopen(\"/proc/mounts\", \"r\");\n    if (mounts == NULL) {\n        virReportSystemError(errno, \"%s\", _(\"Unable to open /proc/mounts\"));\n        return -1;\n    }\n\n    while (getmntent_r(mounts, &entry, buf, sizeof(buf)) != NULL) {\n        for (i = 0; i < VIR_CGROUP_BACKEND_TYPE_LAST; i++) {\n            if (group->backends[i] &&\n                group->backends[i]->detectMounts(group,\n                                                 entry.mnt_type,\n                                                 entry.mnt_opts,\n                                                 entry.mnt_dir) < 0) {\n                goto cleanup;\n            }\n        }\n    }\n\n    ret = 0;\n cleanup:\n    VIR_FORCE_FCLOSE(mounts);\n    return ret;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nstatic int\nvirCgroupDetectMounts(virCgroupPtr group)\n{\n    FILE *mounts = NULL;\n    struct mntent entry;\n    char buf[CGROUP_MAX_VAL];\n    int ret = -1;\n    size_t i;\n\n    mounts = fopen(\"/proc/mounts\", \"r\");\n    if (mounts == NULL) {\n        virReportSystemError(errno, \"%s\", _(\"Unable to open /proc/mounts\"));\n        return -1;\n    }\n\n    while (getmntent_r(mounts, &entry, buf, sizeof(buf)) != NULL) {\n        for (i = 0; i < VIR_CGROUP_BACKEND_TYPE_LAST; i++) {\n            if (group->backends[i] &&\n                group->backends[i]->detectMounts(group,\n                                                 entry.mnt_type,\n                                                 entry.mnt_opts,\n                                                 entry.mnt_dir) < 0) {\n                goto cleanup;\n            }\n        }\n    }\n\n    ret = 0;\n cleanup:\n    VIR_FORCE_FCLOSE(mounts);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "group->backends[i]->copyMounts",
          "args": [
            "group",
            "parent"
          ],
          "line": 369
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"no cgroup backend available\")"
          ],
          "line": 361
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "backends[i]->available",
          "args": [],
          "line": 354
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"group=%p controllers=%d path=%s parent=%p\"",
            "group",
            "controllers",
            "path",
            "parent"
          ],
          "line": 347
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCgroupBackendGetAll",
          "args": [],
          "line": 345
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupBackendGetAll",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupbackend.c",
          "lines": "64-73",
          "snippet": "virCgroupBackendPtr *\nvirCgroupBackendGetAll(void)\n{\n    if (virOnce(&virCgroupBackendOnce, virCgroupBackendOnceInit) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Failed to initialize cgroup backend.\"));\n        return NULL;\n    }\n    return virCgroupBackends;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupv2.h\"",
            "#include \"vircgroupv1.h\"",
            "#include \"vircgrouppriv.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virOnceControl virCgroupBackendOnce = VIR_ONCE_CONTROL_INITIALIZER;",
            "static virCgroupBackendPtr virCgroupBackends[VIR_CGROUP_BACKEND_TYPE_LAST] = { 0 };"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"vircgroupv2.h\"\n#include \"vircgroupv1.h\"\n#include \"vircgrouppriv.h\"\n#include \"vircgroupbackend.h\"\n#include <config.h>\n\nstatic virOnceControl virCgroupBackendOnce = VIR_ONCE_CONTROL_INITIALIZER;\nstatic virCgroupBackendPtr virCgroupBackends[VIR_CGROUP_BACKEND_TYPE_LAST] = { 0 };\n\nvirCgroupBackendPtr *\nvirCgroupBackendGetAll(void)\n{\n    if (virOnce(&virCgroupBackendOnce, virCgroupBackendOnceInit) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Failed to initialize cgroup backend.\"));\n        return NULL;\n    }\n    return virCgroupBackends;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nstatic int\nvirCgroupDetect(virCgroupPtr group,\n                pid_t pid,\n                int controllers,\n                const char *path,\n                virCgroupPtr parent)\n{\n    size_t i;\n    bool backendAvailable = false;\n    int controllersAvailable = 0;\n    virCgroupBackendPtr *backends = virCgroupBackendGetAll();\n\n    VIR_DEBUG(\"group=%p controllers=%d path=%s parent=%p\",\n              group, controllers, path, parent);\n\n    if (!backends)\n        return -1;\n\n    for (i = 0; i < VIR_CGROUP_BACKEND_TYPE_LAST; i++) {\n        if (backends[i] && backends[i]->available()) {\n            group->backends[i] = backends[i];\n            backendAvailable = true;\n        }\n    }\n\n    if (!backendAvailable) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"no cgroup backend available\"));\n        return -1;\n    }\n\n    if (parent) {\n        for (i = 0; i < VIR_CGROUP_BACKEND_TYPE_LAST; i++) {\n            if (group->backends[i] &&\n                group->backends[i]->copyMounts(group, parent) < 0) {\n                return -1;\n            }\n        }\n    } else {\n        if (virCgroupDetectMounts(group) < 0)\n            return -1;\n    }\n\n    /* In some cases we can copy part of the placement info\n     * based on the parent cgroup...\n     */\n    if (parent || path[0] == '/') {\n        for (i = 0; i < VIR_CGROUP_BACKEND_TYPE_LAST; i++) {\n            if (group->backends[i] &&\n                group->backends[i]->copyPlacement(group, path, parent) < 0) {\n                return -1;\n            }\n        }\n    }\n\n    /* ... but use /proc/cgroups to fill in the rest */\n    if (virCgroupDetectPlacement(group, pid, path) < 0)\n        return -1;\n\n    /* Check that for every mounted controller, we found our placement */\n    for (i = 0; i < VIR_CGROUP_BACKEND_TYPE_LAST; i++) {\n        if (group->backends[i] &&\n            group->backends[i]->validatePlacement(group, pid) < 0) {\n            return -1;\n        }\n    }\n\n    for (i = 0; i < VIR_CGROUP_BACKEND_TYPE_LAST; i++) {\n        if (group->backends[i]) {\n            int rc = group->backends[i]->detectControllers(group, controllers, parent,\n                                                           controllersAvailable);\n            if (rc < 0)\n                return -1;\n            controllersAvailable |= rc;\n        }\n    }\n\n    /* Check that at least 1 controller is available */\n    if (controllersAvailable == 0) {\n        virReportSystemError(ENXIO, \"%s\",\n                             _(\"At least one cgroup controller is required\"));\n        return -1;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virCgroupDetectPlacement",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "276-332",
    "snippet": "static int\nvirCgroupDetectPlacement(virCgroupPtr group,\n                         pid_t pid,\n                         const char *path)\n{\n    FILE *mapping  = NULL;\n    char line[1024];\n    int ret = -1;\n    g_autofree char *procfile = NULL;\n\n    VIR_DEBUG(\"Detecting placement for pid %lld path %s\",\n              (long long) pid, path);\n    if (pid == -1) {\n        procfile = g_strdup(\"/proc/self/cgroup\");\n    } else {\n        procfile = g_strdup_printf(\"/proc/%lld/cgroup\", (long long)pid);\n    }\n\n    mapping = fopen(procfile, \"r\");\n    if (mapping == NULL) {\n        virReportSystemError(errno,\n                             _(\"Unable to open '%s'\"),\n                             procfile);\n        goto cleanup;\n    }\n\n    while (fgets(line, sizeof(line), mapping) != NULL) {\n        size_t i;\n        char *controllers = strchr(line, ':');\n        char *selfpath = controllers ? strchr(controllers + 1, ':') : NULL;\n        char *nl = selfpath ? strchr(selfpath, '\\n') : NULL;\n\n        if (!controllers || !selfpath)\n            continue;\n\n        if (nl)\n            *nl = '\\0';\n\n        *selfpath = '\\0';\n        controllers++;\n        selfpath++;\n\n        for (i = 0; i < VIR_CGROUP_BACKEND_TYPE_LAST; i++) {\n            if (group->backends[i] &&\n                group->backends[i]->detectPlacement(group, path, controllers,\n                                                    selfpath) < 0) {\n                goto cleanup;\n            }\n        }\n    }\n\n    ret = 0;\n\n cleanup:\n    VIR_FORCE_FCLOSE(mapping);\n    return ret;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FORCE_FCLOSE",
          "args": [
            "mapping"
          ],
          "line": 330
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "group->backends[i]->detectPlacement",
          "args": [
            "group",
            "path",
            "controllers",
            "selfpath"
          ],
          "line": 320
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "selfpath",
            "'\\n'"
          ],
          "line": 306
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "controllers + 1",
            "':'"
          ],
          "line": 305
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "line",
            "':'"
          ],
          "line": 304
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fgets",
          "args": [
            "line",
            "sizeof(line)",
            "mapping"
          ],
          "line": 302
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"Unable to open '%s'\")",
            "procfile"
          ],
          "line": 296
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to open '%s'\""
          ],
          "line": 297
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "fopen",
          "args": [
            "procfile",
            "\"r\""
          ],
          "line": 294
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Detecting placement for pid %lld path %s\"",
            "(long long) pid",
            "path"
          ],
          "line": 286
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nstatic int\nvirCgroupDetectPlacement(virCgroupPtr group,\n                         pid_t pid,\n                         const char *path)\n{\n    FILE *mapping  = NULL;\n    char line[1024];\n    int ret = -1;\n    g_autofree char *procfile = NULL;\n\n    VIR_DEBUG(\"Detecting placement for pid %lld path %s\",\n              (long long) pid, path);\n    if (pid == -1) {\n        procfile = g_strdup(\"/proc/self/cgroup\");\n    } else {\n        procfile = g_strdup_printf(\"/proc/%lld/cgroup\", (long long)pid);\n    }\n\n    mapping = fopen(procfile, \"r\");\n    if (mapping == NULL) {\n        virReportSystemError(errno,\n                             _(\"Unable to open '%s'\"),\n                             procfile);\n        goto cleanup;\n    }\n\n    while (fgets(line, sizeof(line), mapping) != NULL) {\n        size_t i;\n        char *controllers = strchr(line, ':');\n        char *selfpath = controllers ? strchr(controllers + 1, ':') : NULL;\n        char *nl = selfpath ? strchr(selfpath, '\\n') : NULL;\n\n        if (!controllers || !selfpath)\n            continue;\n\n        if (nl)\n            *nl = '\\0';\n\n        *selfpath = '\\0';\n        controllers++;\n        selfpath++;\n\n        for (i = 0; i < VIR_CGROUP_BACKEND_TYPE_LAST; i++) {\n            if (group->backends[i] &&\n                group->backends[i]->detectPlacement(group, path, controllers,\n                                                    selfpath) < 0) {\n                goto cleanup;\n            }\n        }\n    }\n\n    ret = 0;\n\n cleanup:\n    VIR_FORCE_FCLOSE(mapping);\n    return ret;\n}"
  },
  {
    "function_name": "virCgroupDetectMounts",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "220-251",
    "snippet": "static int\nvirCgroupDetectMounts(virCgroupPtr group)\n{\n    FILE *mounts = NULL;\n    struct mntent entry;\n    char buf[CGROUP_MAX_VAL];\n    int ret = -1;\n    size_t i;\n\n    mounts = fopen(\"/proc/mounts\", \"r\");\n    if (mounts == NULL) {\n        virReportSystemError(errno, \"%s\", _(\"Unable to open /proc/mounts\"));\n        return -1;\n    }\n\n    while (getmntent_r(mounts, &entry, buf, sizeof(buf)) != NULL) {\n        for (i = 0; i < VIR_CGROUP_BACKEND_TYPE_LAST; i++) {\n            if (group->backends[i] &&\n                group->backends[i]->detectMounts(group,\n                                                 entry.mnt_type,\n                                                 entry.mnt_opts,\n                                                 entry.mnt_dir) < 0) {\n                goto cleanup;\n            }\n        }\n    }\n\n    ret = 0;\n cleanup:\n    VIR_FORCE_FCLOSE(mounts);\n    return ret;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FORCE_FCLOSE",
          "args": [
            "mounts"
          ],
          "line": 249
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "group->backends[i]->detectMounts",
          "args": [
            "group",
            "entry.mnt_type",
            "entry.mnt_opts",
            "entry.mnt_dir"
          ],
          "line": 238
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getmntent_r",
          "args": [
            "mounts",
            "&entry",
            "buf",
            "sizeof(buf)"
          ],
          "line": 235
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "\"%s\"",
            "_(\"Unable to open /proc/mounts\")"
          ],
          "line": 231
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to open /proc/mounts\""
          ],
          "line": 231
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "fopen",
          "args": [
            "\"/proc/mounts\"",
            "\"r\""
          ],
          "line": 229
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nstatic int\nvirCgroupDetectMounts(virCgroupPtr group)\n{\n    FILE *mounts = NULL;\n    struct mntent entry;\n    char buf[CGROUP_MAX_VAL];\n    int ret = -1;\n    size_t i;\n\n    mounts = fopen(\"/proc/mounts\", \"r\");\n    if (mounts == NULL) {\n        virReportSystemError(errno, \"%s\", _(\"Unable to open /proc/mounts\"));\n        return -1;\n    }\n\n    while (getmntent_r(mounts, &entry, buf, sizeof(buf)) != NULL) {\n        for (i = 0; i < VIR_CGROUP_BACKEND_TYPE_LAST; i++) {\n            if (group->backends[i] &&\n                group->backends[i]->detectMounts(group,\n                                                 entry.mnt_type,\n                                                 entry.mnt_opts,\n                                                 entry.mnt_dir) < 0) {\n                goto cleanup;\n            }\n        }\n    }\n\n    ret = 0;\n cleanup:\n    VIR_FORCE_FCLOSE(mounts);\n    return ret;\n}"
  },
  {
    "function_name": "virCgroupPartitionEscape",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "198-213",
    "snippet": "int\nvirCgroupPartitionEscape(char **path)\n{\n    int rc;\n    char *newstr = NULL;\n\n    if ((rc = virCgroupPartitionNeedsEscaping(*path)) <= 0)\n        return rc;\n\n    newstr = g_strdup_printf(\"_%s\", *path);\n\n    VIR_FREE(*path);\n    *path = newstr;\n\n    return 0;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "*path"
          ],
          "line": 209
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"_%s\"",
            "*path"
          ],
          "line": 207
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupPartitionNeedsEscaping",
          "args": [
            "*path"
          ],
          "line": 204
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupPartitionNeedsEscaping",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "124-195",
          "snippet": "static int\nvirCgroupPartitionNeedsEscaping(const char *path)\n{\n    FILE *fp = NULL;\n    int ret = 0;\n    g_autofree char *line = NULL;\n    size_t buflen;\n\n    /* If it starts with 'cgroup.' or a '_' of any\n     * of the controller names from /proc/cgroups,\n     * then we must prefix a '_'\n     */\n    if (STRPREFIX(path, \"cgroup.\"))\n        return 1;\n\n    if (path[0] == '_' ||\n        path[0] == '.')\n        return 1;\n\n    if (!(fp = fopen(\"/proc/cgroups\", \"r\"))) {\n        /* The API contract is that we return ENXIO\n         * if cgroups are not available on a host */\n        if (errno == ENOENT)\n            errno = ENXIO;\n        virReportSystemError(errno, \"%s\",\n                             _(\"Cannot open /proc/cgroups\"));\n        return -1;\n    }\n\n    /*\n     * Data looks like this:\n     * #subsys_name hierarchy num_cgroups enabled\n     * cpuset  2 4  1\n     * cpu     3 48 1\n     * cpuacct 3 48 1\n     * memory  4 4  1\n     * devices 5 4  1\n     * freezer 6 4  1\n     * net_cls 7 1  1\n     */\n    while (getline(&line, &buflen, fp) > 0) {\n        char *tmp;\n        size_t len;\n\n        if (STRPREFIX(line, \"#subsys_name\"))\n            continue;\n\n        tmp = strchr(line, ' ');\n        if (tmp) {\n            *tmp = '\\0';\n            len = tmp - line;\n        } else {\n            len = strlen(line);\n        }\n\n        if (STRPREFIX(path, line) &&\n            path[len] == '.') {\n            ret = 1;\n            goto cleanup;\n        }\n    }\n\n    if (ferror(fp)) {\n        virReportSystemError(errno, \"%s\",\n                             _(\"Error while reading /proc/cgroups\"));\n        goto cleanup;\n    }\n\n cleanup:\n    VIR_FORCE_FCLOSE(fp);\n    return ret;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nstatic int\nvirCgroupPartitionNeedsEscaping(const char *path)\n{\n    FILE *fp = NULL;\n    int ret = 0;\n    g_autofree char *line = NULL;\n    size_t buflen;\n\n    /* If it starts with 'cgroup.' or a '_' of any\n     * of the controller names from /proc/cgroups,\n     * then we must prefix a '_'\n     */\n    if (STRPREFIX(path, \"cgroup.\"))\n        return 1;\n\n    if (path[0] == '_' ||\n        path[0] == '.')\n        return 1;\n\n    if (!(fp = fopen(\"/proc/cgroups\", \"r\"))) {\n        /* The API contract is that we return ENXIO\n         * if cgroups are not available on a host */\n        if (errno == ENOENT)\n            errno = ENXIO;\n        virReportSystemError(errno, \"%s\",\n                             _(\"Cannot open /proc/cgroups\"));\n        return -1;\n    }\n\n    /*\n     * Data looks like this:\n     * #subsys_name hierarchy num_cgroups enabled\n     * cpuset  2 4  1\n     * cpu     3 48 1\n     * cpuacct 3 48 1\n     * memory  4 4  1\n     * devices 5 4  1\n     * freezer 6 4  1\n     * net_cls 7 1  1\n     */\n    while (getline(&line, &buflen, fp) > 0) {\n        char *tmp;\n        size_t len;\n\n        if (STRPREFIX(line, \"#subsys_name\"))\n            continue;\n\n        tmp = strchr(line, ' ');\n        if (tmp) {\n            *tmp = '\\0';\n            len = tmp - line;\n        } else {\n            len = strlen(line);\n        }\n\n        if (STRPREFIX(path, line) &&\n            path[len] == '.') {\n            ret = 1;\n            goto cleanup;\n        }\n    }\n\n    if (ferror(fp)) {\n        virReportSystemError(errno, \"%s\",\n                             _(\"Error while reading /proc/cgroups\"));\n        goto cleanup;\n    }\n\n cleanup:\n    VIR_FORCE_FCLOSE(fp);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupPartitionEscape(char **path)\n{\n    int rc;\n    char *newstr = NULL;\n\n    if ((rc = virCgroupPartitionNeedsEscaping(*path)) <= 0)\n        return rc;\n\n    newstr = g_strdup_printf(\"_%s\", *path);\n\n    VIR_FREE(*path);\n    *path = newstr;\n\n    return 0;\n}"
  },
  {
    "function_name": "virCgroupPartitionNeedsEscaping",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "124-195",
    "snippet": "static int\nvirCgroupPartitionNeedsEscaping(const char *path)\n{\n    FILE *fp = NULL;\n    int ret = 0;\n    g_autofree char *line = NULL;\n    size_t buflen;\n\n    /* If it starts with 'cgroup.' or a '_' of any\n     * of the controller names from /proc/cgroups,\n     * then we must prefix a '_'\n     */\n    if (STRPREFIX(path, \"cgroup.\"))\n        return 1;\n\n    if (path[0] == '_' ||\n        path[0] == '.')\n        return 1;\n\n    if (!(fp = fopen(\"/proc/cgroups\", \"r\"))) {\n        /* The API contract is that we return ENXIO\n         * if cgroups are not available on a host */\n        if (errno == ENOENT)\n            errno = ENXIO;\n        virReportSystemError(errno, \"%s\",\n                             _(\"Cannot open /proc/cgroups\"));\n        return -1;\n    }\n\n    /*\n     * Data looks like this:\n     * #subsys_name hierarchy num_cgroups enabled\n     * cpuset  2 4  1\n     * cpu     3 48 1\n     * cpuacct 3 48 1\n     * memory  4 4  1\n     * devices 5 4  1\n     * freezer 6 4  1\n     * net_cls 7 1  1\n     */\n    while (getline(&line, &buflen, fp) > 0) {\n        char *tmp;\n        size_t len;\n\n        if (STRPREFIX(line, \"#subsys_name\"))\n            continue;\n\n        tmp = strchr(line, ' ');\n        if (tmp) {\n            *tmp = '\\0';\n            len = tmp - line;\n        } else {\n            len = strlen(line);\n        }\n\n        if (STRPREFIX(path, line) &&\n            path[len] == '.') {\n            ret = 1;\n            goto cleanup;\n        }\n    }\n\n    if (ferror(fp)) {\n        virReportSystemError(errno, \"%s\",\n                             _(\"Error while reading /proc/cgroups\"));\n        goto cleanup;\n    }\n\n cleanup:\n    VIR_FORCE_FCLOSE(fp);\n    return ret;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FORCE_FCLOSE",
          "args": [
            "fp"
          ],
          "line": 193
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "\"%s\"",
            "_(\"Error while reading /proc/cgroups\")"
          ],
          "line": 187
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Error while reading /proc/cgroups\""
          ],
          "line": 188
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ferror",
          "args": [
            "fp"
          ],
          "line": 186
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STRPREFIX",
          "args": [
            "path",
            "line"
          ],
          "line": 179
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "line"
          ],
          "line": 176
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "line",
            "' '"
          ],
          "line": 171
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STRPREFIX",
          "args": [
            "line",
            "\"#subsys_name\""
          ],
          "line": 168
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getline",
          "args": [
            "&line",
            "&buflen",
            "fp"
          ],
          "line": 164
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "\"%s\"",
            "_(\"Cannot open /proc/cgroups\")"
          ],
          "line": 148
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fopen",
          "args": [
            "\"/proc/cgroups\"",
            "\"r\""
          ],
          "line": 143
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STRPREFIX",
          "args": [
            "path",
            "\"cgroup.\""
          ],
          "line": 136
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nstatic int\nvirCgroupPartitionNeedsEscaping(const char *path)\n{\n    FILE *fp = NULL;\n    int ret = 0;\n    g_autofree char *line = NULL;\n    size_t buflen;\n\n    /* If it starts with 'cgroup.' or a '_' of any\n     * of the controller names from /proc/cgroups,\n     * then we must prefix a '_'\n     */\n    if (STRPREFIX(path, \"cgroup.\"))\n        return 1;\n\n    if (path[0] == '_' ||\n        path[0] == '.')\n        return 1;\n\n    if (!(fp = fopen(\"/proc/cgroups\", \"r\"))) {\n        /* The API contract is that we return ENXIO\n         * if cgroups are not available on a host */\n        if (errno == ENOENT)\n            errno = ENXIO;\n        virReportSystemError(errno, \"%s\",\n                             _(\"Cannot open /proc/cgroups\"));\n        return -1;\n    }\n\n    /*\n     * Data looks like this:\n     * #subsys_name hierarchy num_cgroups enabled\n     * cpuset  2 4  1\n     * cpu     3 48 1\n     * cpuacct 3 48 1\n     * memory  4 4  1\n     * devices 5 4  1\n     * freezer 6 4  1\n     * net_cls 7 1  1\n     */\n    while (getline(&line, &buflen, fp) > 0) {\n        char *tmp;\n        size_t len;\n\n        if (STRPREFIX(line, \"#subsys_name\"))\n            continue;\n\n        tmp = strchr(line, ' ');\n        if (tmp) {\n            *tmp = '\\0';\n            len = tmp - line;\n        } else {\n            len = strlen(line);\n        }\n\n        if (STRPREFIX(path, line) &&\n            path[len] == '.') {\n            ret = 1;\n            goto cleanup;\n        }\n    }\n\n    if (ferror(fp)) {\n        virReportSystemError(errno, \"%s\",\n                             _(\"Error while reading /proc/cgroups\"));\n        goto cleanup;\n    }\n\n cleanup:\n    VIR_FORCE_FCLOSE(fp);\n    return ret;\n}"
  },
  {
    "function_name": "virCgroupAvailable",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "106-121",
    "snippet": "bool\nvirCgroupAvailable(void)\n{\n    size_t i;\n    virCgroupBackendPtr *backends = virCgroupBackendGetAll();\n\n    if (!backends)\n        return false;\n\n    for (i = 0; i < VIR_CGROUP_BACKEND_TYPE_LAST; i++) {\n        if (backends[i] && backends[i]->available())\n            return true;\n    }\n\n    return false;\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "backends[i]->available",
          "args": [],
          "line": 116
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCgroupBackendGetAll",
          "args": [],
          "line": 110
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupBackendGetAll",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupbackend.c",
          "lines": "64-73",
          "snippet": "virCgroupBackendPtr *\nvirCgroupBackendGetAll(void)\n{\n    if (virOnce(&virCgroupBackendOnce, virCgroupBackendOnceInit) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Failed to initialize cgroup backend.\"));\n        return NULL;\n    }\n    return virCgroupBackends;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupv2.h\"",
            "#include \"vircgroupv1.h\"",
            "#include \"vircgrouppriv.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virOnceControl virCgroupBackendOnce = VIR_ONCE_CONTROL_INITIALIZER;",
            "static virCgroupBackendPtr virCgroupBackends[VIR_CGROUP_BACKEND_TYPE_LAST] = { 0 };"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"vircgroupv2.h\"\n#include \"vircgroupv1.h\"\n#include \"vircgrouppriv.h\"\n#include \"vircgroupbackend.h\"\n#include <config.h>\n\nstatic virOnceControl virCgroupBackendOnce = VIR_ONCE_CONTROL_INITIALIZER;\nstatic virCgroupBackendPtr virCgroupBackends[VIR_CGROUP_BACKEND_TYPE_LAST] = { 0 };\n\nvirCgroupBackendPtr *\nvirCgroupBackendGetAll(void)\n{\n    if (virOnce(&virCgroupBackendOnce, virCgroupBackendOnceInit) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Failed to initialize cgroup backend.\"));\n        return NULL;\n    }\n    return virCgroupBackends;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nbool\nvirCgroupAvailable(void)\n{\n    size_t i;\n    virCgroupBackendPtr *backends = virCgroupBackendGetAll();\n\n    if (!backends)\n        return false;\n\n    for (i = 0; i < VIR_CGROUP_BACKEND_TYPE_LAST; i++) {\n        if (backends[i] && backends[i]->available())\n            return true;\n    }\n\n    return false;\n}"
  },
  {
    "function_name": "virCgroupGetDevicePermsString",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
    "lines": "74-102",
    "snippet": "const char *\nvirCgroupGetDevicePermsString(int perms)\n{\n    if (perms & VIR_CGROUP_DEVICE_READ) {\n        if (perms & VIR_CGROUP_DEVICE_WRITE) {\n            if (perms & VIR_CGROUP_DEVICE_MKNOD)\n                return \"rwm\";\n            else\n                return \"rw\";\n        } else {\n            if (perms & VIR_CGROUP_DEVICE_MKNOD)\n                return \"rm\";\n            else\n                return \"r\";\n        }\n    } else {\n        if (perms & VIR_CGROUP_DEVICE_WRITE) {\n            if (perms & VIR_CGROUP_DEVICE_MKNOD)\n                return \"wm\";\n            else\n                return \"w\";\n        } else {\n            if (perms & VIR_CGROUP_DEVICE_MKNOD)\n                return \"m\";\n            else\n                return \"\";\n        }\n    }\n}",
    "includes": [
      "#include \"virthread.h\"",
      "#include \"virhostcpu.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virhashcode.h\"",
      "#include \"virhash.h\"",
      "#include \"virfile.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"viralloc.h\"",
      "#include \"virutil.h\"",
      "#include \"vircgrouppriv.h\"",
      "# include <unistd.h>",
      "# include <dirent.h>",
      "# include <signal.h>",
      "# include <sys/types.h>",
      "# include <sys/sysmacros.h>",
      "# include <sys/stat.h>",
      "# include <fcntl.h>",
      "# include <sys/mount.h>",
      "# include <mntent.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nconst char *\nvirCgroupGetDevicePermsString(int perms)\n{\n    if (perms & VIR_CGROUP_DEVICE_READ) {\n        if (perms & VIR_CGROUP_DEVICE_WRITE) {\n            if (perms & VIR_CGROUP_DEVICE_MKNOD)\n                return \"rwm\";\n            else\n                return \"rw\";\n        } else {\n            if (perms & VIR_CGROUP_DEVICE_MKNOD)\n                return \"rm\";\n            else\n                return \"r\";\n        }\n    } else {\n        if (perms & VIR_CGROUP_DEVICE_WRITE) {\n            if (perms & VIR_CGROUP_DEVICE_MKNOD)\n                return \"wm\";\n            else\n                return \"w\";\n        } else {\n            if (perms & VIR_CGROUP_DEVICE_MKNOD)\n                return \"m\";\n            else\n                return \"\";\n        }\n    }\n}"
  }
]