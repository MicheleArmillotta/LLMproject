[
  {
    "function_name": "virDomainBackupGetXMLDesc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "12708-12733",
    "snippet": "char *\nvirDomainBackupGetXMLDesc(virDomainPtr domain,\n                          unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"flags=0x%x\", flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, NULL);\n    conn = domain->conn;\n\n    if (conn->driver->domainBackupGetXMLDesc) {\n        char *ret;\n        ret = conn->driver->domainBackupGetXMLDesc(domain, flags);\n        if (!ret)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n error:\n    virDispatchError(conn);\n    return NULL;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "conn"
          ],
          "line": 12731
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 12729
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainBackupGetXMLDesc",
          "args": [
            "domain",
            "flags"
          ],
          "line": 12723
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "domain",
            "NULL"
          ],
          "line": 12718
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 12716
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "domain",
            "\"flags=0x%x\"",
            "flags"
          ],
          "line": 12714
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nchar *\nvirDomainBackupGetXMLDesc(virDomainPtr domain,\n                          unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"flags=0x%x\", flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, NULL);\n    conn = domain->conn;\n\n    if (conn->driver->domainBackupGetXMLDesc) {\n        char *ret;\n        ret = conn->driver->domainBackupGetXMLDesc(domain, flags);\n        if (!ret)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n error:\n    virDispatchError(conn);\n    return NULL;\n}"
  },
  {
    "function_name": "virDomainBackupBegin",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "12658-12690",
    "snippet": "int\nvirDomainBackupBegin(virDomainPtr domain,\n                     const char *backupXML,\n                     const char *checkpointXML,\n                     unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"backupXML=%s, checkpointXML=%s, flags=0x%x\",\n                     NULLSTR(backupXML), NULLSTR(checkpointXML), flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    virCheckNonNullArgGoto(backupXML, error);\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->driver->domainBackupBegin) {\n        int ret;\n        ret = conn->driver->domainBackupBegin(domain, backupXML, checkpointXML,\n                                              flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n error:\n    virDispatchError(conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "conn"
          ],
          "line": 12688
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 12686
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainBackupBegin",
          "args": [
            "domain",
            "backupXML",
            "checkpointXML",
            "flags"
          ],
          "line": 12679
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "conn->flags",
            "error"
          ],
          "line": 12675
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "backupXML",
            "error"
          ],
          "line": 12674
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "domain",
            "-1"
          ],
          "line": 12671
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 12669
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "domain",
            "\"backupXML=%s, checkpointXML=%s, flags=0x%x\"",
            "NULLSTR(backupXML)",
            "NULLSTR(checkpointXML)",
            "flags"
          ],
          "line": 12666
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "checkpointXML"
          ],
          "line": 12667
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "backupXML"
          ],
          "line": 12667
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainBackupBegin(virDomainPtr domain,\n                     const char *backupXML,\n                     const char *checkpointXML,\n                     unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"backupXML=%s, checkpointXML=%s, flags=0x%x\",\n                     NULLSTR(backupXML), NULLSTR(checkpointXML), flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    virCheckNonNullArgGoto(backupXML, error);\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->driver->domainBackupBegin) {\n        int ret;\n        ret = conn->driver->domainBackupBegin(domain, backupXML, checkpointXML,\n                                              flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n error:\n    virDispatchError(conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainAgentSetResponseTimeout",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "12564-12590",
    "snippet": "int\nvirDomainAgentSetResponseTimeout(virDomainPtr domain,\n                                 int timeout,\n                                 unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"timeout=%i, flags=0x%x\",\n                     timeout, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    if (conn->driver->domainAgentSetResponseTimeout) {\n        if (conn->driver->domainAgentSetResponseTimeout(domain, timeout, flags) < 0)\n            goto error;\n        return 0;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "conn"
          ],
          "line": 12588
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 12585
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainAgentSetResponseTimeout",
          "args": [
            "domain",
            "timeout",
            "flags"
          ],
          "line": 12580
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "domain",
            "-1"
          ],
          "line": 12576
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 12574
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "domain",
            "\"timeout=%i, flags=0x%x\"",
            "timeout",
            "flags"
          ],
          "line": 12571
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainAgentSetResponseTimeout(virDomainPtr domain,\n                                 int timeout,\n                                 unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"timeout=%i, flags=0x%x\",\n                     timeout, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    if (conn->driver->domainAgentSetResponseTimeout) {\n        if (conn->driver->domainAgentSetResponseTimeout(domain, timeout, flags) < 0)\n            goto error;\n        return 0;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainGetLaunchSecurityInfo",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "12507-12541",
    "snippet": "int virDomainGetLaunchSecurityInfo(virDomainPtr domain,\n                                   virTypedParameterPtr *params,\n                                   int *nparams,\n                                   unsigned int flags)\n{\n    virConnectPtr conn = domain->conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"params=%p, nparams=%p flags=0x%x\",\n                     params, nparams, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    virCheckNonNullArgGoto(params, error);\n    virCheckNonNullArgGoto(nparams, error);\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (VIR_DRV_SUPPORTS_FEATURE(domain->conn->driver, domain->conn,\n                                 VIR_DRV_FEATURE_TYPED_PARAM_STRING))\n        flags |= VIR_TYPED_PARAM_STRING_OKAY;\n\n    if (conn->driver->domainGetLaunchSecurityInfo) {\n        int ret;\n        ret = conn->driver->domainGetLaunchSecurityInfo(domain, params,\n                                                        nparams, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "domain->conn"
          ],
          "line": 12539
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 12536
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainGetLaunchSecurityInfo",
          "args": [
            "domain",
            "params",
            "nparams",
            "flags"
          ],
          "line": 12530
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DRV_SUPPORTS_FEATURE",
          "args": [
            "domain->conn->driver",
            "domain->conn",
            "VIR_DRV_FEATURE_TYPED_PARAM_STRING"
          ],
          "line": 12524
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "conn->flags",
            "error"
          ],
          "line": 12522
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "nparams",
            "error"
          ],
          "line": 12521
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "params",
            "error"
          ],
          "line": 12520
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "domain",
            "-1"
          ],
          "line": 12519
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 12517
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "domain",
            "\"params=%p, nparams=%p flags=0x%x\"",
            "params",
            "nparams",
            "flags"
          ],
          "line": 12514
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint virDomainGetLaunchSecurityInfo(virDomainPtr domain,\n                                   virTypedParameterPtr *params,\n                                   int *nparams,\n                                   unsigned int flags)\n{\n    virConnectPtr conn = domain->conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"params=%p, nparams=%p flags=0x%x\",\n                     params, nparams, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    virCheckNonNullArgGoto(params, error);\n    virCheckNonNullArgGoto(nparams, error);\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (VIR_DRV_SUPPORTS_FEATURE(domain->conn->driver, domain->conn,\n                                 VIR_DRV_FEATURE_TYPED_PARAM_STRING))\n        flags |= VIR_TYPED_PARAM_STRING_OKAY;\n\n    if (conn->driver->domainGetLaunchSecurityInfo) {\n        int ret;\n        ret = conn->driver->domainGetLaunchSecurityInfo(domain, params,\n                                                        nparams, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainSetLifecycleAction",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "12452-12493",
    "snippet": "int virDomainSetLifecycleAction(virDomainPtr domain,\n                                unsigned int type,\n                                unsigned int action,\n                                unsigned int flags)\n{\n    VIR_DOMAIN_DEBUG(domain, \"type='%u' action='%u' flags='0x%x'\",\n                     type, action, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    virCheckReadOnlyGoto(domain->conn->flags, error);\n\n    if (type >= VIR_DOMAIN_LIFECYCLE_LAST) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"invalid lifecycle type '%u'\"), type);\n        goto error;\n    }\n\n    if (action >= VIR_DOMAIN_LIFECYCLE_ACTION_LAST) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"invalid lifecycle action '%u'\"), action);\n        goto error;\n    }\n\n    if (domain->conn->driver->domainSetLifecycleAction) {\n        int ret;\n        ret = domain->conn->driver->domainSetLifecycleAction(domain,\n                                                             type,\n                                                             action,\n                                                             flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "domain->conn"
          ],
          "line": 12491
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 12488
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "domain->conn->driver->domainSetLifecycleAction",
          "args": [
            "domain",
            "type",
            "action",
            "flags"
          ],
          "line": 12479
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INVALID_ARG",
            "_(\"invalid lifecycle action '%u'\")",
            "action"
          ],
          "line": 12472
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"invalid lifecycle action '%u'\""
          ],
          "line": 12473
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INVALID_ARG",
            "_(\"invalid lifecycle type '%u'\")",
            "type"
          ],
          "line": 12466
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "domain->conn->flags",
            "error"
          ],
          "line": 12463
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "domain",
            "-1"
          ],
          "line": 12462
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 12460
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "domain",
            "\"type='%u' action='%u' flags='0x%x'\"",
            "type",
            "action",
            "flags"
          ],
          "line": 12457
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint virDomainSetLifecycleAction(virDomainPtr domain,\n                                unsigned int type,\n                                unsigned int action,\n                                unsigned int flags)\n{\n    VIR_DOMAIN_DEBUG(domain, \"type='%u' action='%u' flags='0x%x'\",\n                     type, action, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    virCheckReadOnlyGoto(domain->conn->flags, error);\n\n    if (type >= VIR_DOMAIN_LIFECYCLE_LAST) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"invalid lifecycle type '%u'\"), type);\n        goto error;\n    }\n\n    if (action >= VIR_DOMAIN_LIFECYCLE_ACTION_LAST) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"invalid lifecycle action '%u'\"), action);\n        goto error;\n    }\n\n    if (domain->conn->driver->domainSetLifecycleAction) {\n        int ret;\n        ret = domain->conn->driver->domainSetLifecycleAction(domain,\n                                                             type,\n                                                             action,\n                                                             flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainSetBlockThreshold",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "12403-12433",
    "snippet": "int\nvirDomainSetBlockThreshold(virDomainPtr domain,\n                           const char *dev,\n                           unsigned long long threshold,\n                           unsigned int flags)\n{\n    VIR_DOMAIN_DEBUG(domain, \"dev='%s' threshold=%llu flags=0x%x\",\n                     NULLSTR(dev), threshold, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    virCheckReadOnlyGoto(domain->conn->flags, error);\n\n    virCheckNonNullArgGoto(dev, error);\n\n    if (domain->conn->driver->domainSetBlockThreshold) {\n        int ret;\n        ret = domain->conn->driver->domainSetBlockThreshold(domain, dev,\n                                                            threshold, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "domain->conn"
          ],
          "line": 12431
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 12428
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "domain->conn->driver->domainSetBlockThreshold",
          "args": [
            "domain",
            "dev",
            "threshold",
            "flags"
          ],
          "line": 12421
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "dev",
            "error"
          ],
          "line": 12417
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "domain->conn->flags",
            "error"
          ],
          "line": 12415
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "domain",
            "-1"
          ],
          "line": 12414
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 12412
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "domain",
            "\"dev='%s' threshold=%llu flags=0x%x\"",
            "NULLSTR(dev)",
            "threshold",
            "flags"
          ],
          "line": 12409
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "dev"
          ],
          "line": 12410
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainSetBlockThreshold(virDomainPtr domain,\n                           const char *dev,\n                           unsigned long long threshold,\n                           unsigned int flags)\n{\n    VIR_DOMAIN_DEBUG(domain, \"dev='%s' threshold=%llu flags=0x%x\",\n                     NULLSTR(dev), threshold, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    virCheckReadOnlyGoto(domain->conn->flags, error);\n\n    virCheckNonNullArgGoto(dev, error);\n\n    if (domain->conn->driver->domainSetBlockThreshold) {\n        int ret;\n        ret = domain->conn->driver->domainSetBlockThreshold(domain, dev,\n                                                            threshold, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainGetGuestInfo",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "12346-12378",
    "snippet": "int virDomainGetGuestInfo(virDomainPtr domain,\n                          unsigned int types,\n                          virTypedParameterPtr *params,\n                          int *nparams,\n                          unsigned int flags)\n{\n    VIR_DOMAIN_DEBUG(domain, \"types=0x%x, params=%p, nparams=%p, flags=0x%x\",\n                     types, params, nparams, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    virCheckReadOnlyGoto(domain->conn->flags, error);\n\n    virCheckNonNullArgGoto(params, error);\n    virCheckNonNullArgGoto(nparams, error);\n\n    if (domain->conn->driver->domainGetGuestInfo) {\n        int ret;\n        ret = domain->conn->driver->domainGetGuestInfo(domain, types,\n                                                       params, nparams, flags);\n\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "domain->conn"
          ],
          "line": 12376
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 12373
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "domain->conn->driver->domainGetGuestInfo",
          "args": [
            "domain",
            "types",
            "params",
            "nparams",
            "flags"
          ],
          "line": 12365
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "nparams",
            "error"
          ],
          "line": 12361
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "params",
            "error"
          ],
          "line": 12360
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "domain->conn->flags",
            "error"
          ],
          "line": 12358
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "domain",
            "-1"
          ],
          "line": 12357
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 12355
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "domain",
            "\"types=0x%x, params=%p, nparams=%p, flags=0x%x\"",
            "types",
            "params",
            "nparams",
            "flags"
          ],
          "line": 12352
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint virDomainGetGuestInfo(virDomainPtr domain,\n                          unsigned int types,\n                          virTypedParameterPtr *params,\n                          int *nparams,\n                          unsigned int flags)\n{\n    VIR_DOMAIN_DEBUG(domain, \"types=0x%x, params=%p, nparams=%p, flags=0x%x\",\n                     types, params, nparams, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    virCheckReadOnlyGoto(domain->conn->flags, error);\n\n    virCheckNonNullArgGoto(params, error);\n    virCheckNonNullArgGoto(nparams, error);\n\n    if (domain->conn->driver->domainGetGuestInfo) {\n        int ret;\n        ret = domain->conn->driver->domainGetGuestInfo(domain, types,\n                                                       params, nparams, flags);\n\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainSetVcpu",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "12224-12253",
    "snippet": "int\nvirDomainSetVcpu(virDomainPtr domain,\n                 const char *vcpumap,\n                 int state,\n                 unsigned int flags)\n{\n    VIR_DOMAIN_DEBUG(domain, \"vcpumap='%s' state=%i flags=0x%x\",\n                     NULLSTR(vcpumap), state, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    virCheckReadOnlyGoto(domain->conn->flags, error);\n\n    virCheckNonNullArgGoto(vcpumap, error);\n\n    if (domain->conn->driver->domainSetVcpu) {\n        int ret;\n        ret = domain->conn->driver->domainSetVcpu(domain, vcpumap, state, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "domain->conn"
          ],
          "line": 12251
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 12248
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "domain->conn->driver->domainSetVcpu",
          "args": [
            "domain",
            "vcpumap",
            "state",
            "flags"
          ],
          "line": 12242
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "vcpumap",
            "error"
          ],
          "line": 12238
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "domain->conn->flags",
            "error"
          ],
          "line": 12236
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "domain",
            "-1"
          ],
          "line": 12235
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 12233
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "domain",
            "\"vcpumap='%s' state=%i flags=0x%x\"",
            "NULLSTR(vcpumap)",
            "state",
            "flags"
          ],
          "line": 12230
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "vcpumap"
          ],
          "line": 12231
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainSetVcpu(virDomainPtr domain,\n                 const char *vcpumap,\n                 int state,\n                 unsigned int flags)\n{\n    VIR_DOMAIN_DEBUG(domain, \"vcpumap='%s' state=%i flags=0x%x\",\n                     NULLSTR(vcpumap), state, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    virCheckReadOnlyGoto(domain->conn->flags, error);\n\n    virCheckNonNullArgGoto(vcpumap, error);\n\n    if (domain->conn->driver->domainSetVcpu) {\n        int ret;\n        ret = domain->conn->driver->domainSetVcpu(domain, vcpumap, state, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainSetGuestVcpus",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "12175-12205",
    "snippet": "int\nvirDomainSetGuestVcpus(virDomainPtr domain,\n                       const char *cpumap,\n                       int state,\n                       unsigned int flags)\n{\n    VIR_DOMAIN_DEBUG(domain, \"cpumap='%s' state=%d flags=0x%x\",\n                     NULLSTR(cpumap), state, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    virCheckReadOnlyGoto(domain->conn->flags, error);\n\n    virCheckNonNullArgGoto(cpumap, error);\n\n    if (domain->conn->driver->domainSetGuestVcpus) {\n        int ret;\n        ret = domain->conn->driver->domainSetGuestVcpus(domain, cpumap, state,\n                                                        flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "domain->conn"
          ],
          "line": 12203
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 12200
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "domain->conn->driver->domainSetGuestVcpus",
          "args": [
            "domain",
            "cpumap",
            "state",
            "flags"
          ],
          "line": 12193
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "cpumap",
            "error"
          ],
          "line": 12189
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "domain->conn->flags",
            "error"
          ],
          "line": 12187
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "domain",
            "-1"
          ],
          "line": 12186
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 12184
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "domain",
            "\"cpumap='%s' state=%d flags=0x%x\"",
            "NULLSTR(cpumap)",
            "state",
            "flags"
          ],
          "line": 12181
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "cpumap"
          ],
          "line": 12182
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainSetGuestVcpus(virDomainPtr domain,\n                       const char *cpumap,\n                       int state,\n                       unsigned int flags)\n{\n    VIR_DOMAIN_DEBUG(domain, \"cpumap='%s' state=%d flags=0x%x\",\n                     NULLSTR(cpumap), state, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    virCheckReadOnlyGoto(domain->conn->flags, error);\n\n    virCheckNonNullArgGoto(cpumap, error);\n\n    if (domain->conn->driver->domainSetGuestVcpus) {\n        int ret;\n        ret = domain->conn->driver->domainSetGuestVcpus(domain, cpumap, state,\n                                                        flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainGetGuestVcpus",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "12117-12148",
    "snippet": "int\nvirDomainGetGuestVcpus(virDomainPtr domain,\n                       virTypedParameterPtr *params,\n                       unsigned int *nparams,\n                       unsigned int flags)\n{\n    VIR_DOMAIN_DEBUG(domain, \"params=%p, nparams=%p, flags=0x%x\",\n                     params, nparams, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    virCheckReadOnlyGoto(domain->conn->flags, error);\n\n    virCheckNonNullArgGoto(params, error);\n    virCheckNonNullArgGoto(nparams, error);\n\n    if (domain->conn->driver->domainGetGuestVcpus) {\n        int ret;\n        ret = domain->conn->driver->domainGetGuestVcpus(domain, params, nparams,\n                                                        flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "domain->conn"
          ],
          "line": 12146
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 12143
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "domain->conn->driver->domainGetGuestVcpus",
          "args": [
            "domain",
            "params",
            "nparams",
            "flags"
          ],
          "line": 12136
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "nparams",
            "error"
          ],
          "line": 12132
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "params",
            "error"
          ],
          "line": 12131
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "domain->conn->flags",
            "error"
          ],
          "line": 12129
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "domain",
            "-1"
          ],
          "line": 12128
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 12126
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "domain",
            "\"params=%p, nparams=%p, flags=0x%x\"",
            "params",
            "nparams",
            "flags"
          ],
          "line": 12123
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainGetGuestVcpus(virDomainPtr domain,\n                       virTypedParameterPtr *params,\n                       unsigned int *nparams,\n                       unsigned int flags)\n{\n    VIR_DOMAIN_DEBUG(domain, \"params=%p, nparams=%p, flags=0x%x\",\n                     params, nparams, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    virCheckReadOnlyGoto(domain->conn->flags, error);\n\n    virCheckNonNullArgGoto(params, error);\n    virCheckNonNullArgGoto(nparams, error);\n\n    if (domain->conn->driver->domainGetGuestVcpus) {\n        int ret;\n        ret = domain->conn->driver->domainGetGuestVcpus(domain, params, nparams,\n                                                        flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainInterfaceFree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "12074-12090",
    "snippet": "void\nvirDomainInterfaceFree(virDomainInterfacePtr iface)\n{\n    size_t i;\n\n    if (!iface)\n        return;\n\n    VIR_FREE(iface->name);\n    VIR_FREE(iface->hwaddr);\n\n    for (i = 0; i < iface->naddrs; i++)\n        VIR_FREE(iface->addrs[i].addr);\n    VIR_FREE(iface->addrs);\n\n    VIR_FREE(iface);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "iface"
          ],
          "line": 12089
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "iface->addrs"
          ],
          "line": 12087
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "iface->addrs[i].addr"
          ],
          "line": 12086
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "iface->hwaddr"
          ],
          "line": 12083
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "iface->name"
          ],
          "line": 12082
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nvoid\nvirDomainInterfaceFree(virDomainInterfacePtr iface)\n{\n    size_t i;\n\n    if (!iface)\n        return;\n\n    VIR_FREE(iface->name);\n    VIR_FREE(iface->hwaddr);\n\n    for (i = 0; i < iface->naddrs; i++)\n        VIR_FREE(iface->addrs[i].addr);\n    VIR_FREE(iface->addrs);\n\n    VIR_FREE(iface);\n}"
  },
  {
    "function_name": "virDomainInterfaceAddresses",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "12033-12063",
    "snippet": "int\nvirDomainInterfaceAddresses(virDomainPtr dom,\n                            virDomainInterfacePtr **ifaces,\n                            unsigned int source,\n                            unsigned int flags)\n{\n    VIR_DOMAIN_DEBUG(dom, \"ifaces=%p, source=%d, flags=0x%x\", ifaces, source, flags);\n\n    virResetLastError();\n\n    if (ifaces)\n        *ifaces = NULL;\n    virCheckDomainReturn(dom, -1);\n    virCheckNonNullArgGoto(ifaces, error);\n    if (source == VIR_DOMAIN_INTERFACE_ADDRESSES_SRC_AGENT)\n        virCheckReadOnlyGoto(dom->conn->flags, error);\n\n    if (dom->conn->driver->domainInterfaceAddresses) {\n        int ret;\n        ret = dom->conn->driver->domainInterfaceAddresses(dom, ifaces, source, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportError(VIR_ERR_NO_SUPPORT, __FUNCTION__);\n\n error:\n    virDispatchError(dom->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "dom->conn"
          ],
          "line": 12061
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_NO_SUPPORT",
            "__FUNCTION__"
          ],
          "line": 12058
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dom->conn->driver->domainInterfaceAddresses",
          "args": [
            "dom",
            "ifaces",
            "source",
            "flags"
          ],
          "line": 12052
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "dom->conn->flags",
            "error"
          ],
          "line": 12048
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "ifaces",
            "error"
          ],
          "line": 12046
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "dom",
            "-1"
          ],
          "line": 12045
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 12041
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "dom",
            "\"ifaces=%p, source=%d, flags=0x%x\"",
            "ifaces",
            "source",
            "flags"
          ],
          "line": 12039
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainInterfaceAddresses(virDomainPtr dom,\n                            virDomainInterfacePtr **ifaces,\n                            unsigned int source,\n                            unsigned int flags)\n{\n    VIR_DOMAIN_DEBUG(dom, \"ifaces=%p, source=%d, flags=0x%x\", ifaces, source, flags);\n\n    virResetLastError();\n\n    if (ifaces)\n        *ifaces = NULL;\n    virCheckDomainReturn(dom, -1);\n    virCheckNonNullArgGoto(ifaces, error);\n    if (source == VIR_DOMAIN_INTERFACE_ADDRESSES_SRC_AGENT)\n        virCheckReadOnlyGoto(dom->conn->flags, error);\n\n    if (dom->conn->driver->domainInterfaceAddresses) {\n        int ret;\n        ret = dom->conn->driver->domainInterfaceAddresses(dom, ifaces, source, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportError(VIR_ERR_NO_SUPPORT, __FUNCTION__);\n\n error:\n    virDispatchError(dom->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainFSInfoFree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "11941-11958",
    "snippet": "void\nvirDomainFSInfoFree(virDomainFSInfoPtr info)\n{\n    size_t i;\n\n    if (!info)\n        return;\n\n    g_free(info->mountpoint);\n    g_free(info->name);\n    g_free(info->fstype);\n\n    for (i = 0; i < info->ndevAlias; i++)\n        g_free(info->devAlias[i]);\n    g_free(info->devAlias);\n\n    g_free(info);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_free",
          "args": [
            "info"
          ],
          "line": 11957
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_free",
          "args": [
            "info->devAlias"
          ],
          "line": 11955
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_free",
          "args": [
            "info->devAlias[i]"
          ],
          "line": 11954
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_free",
          "args": [
            "info->fstype"
          ],
          "line": 11951
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_free",
          "args": [
            "info->name"
          ],
          "line": 11950
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_free",
          "args": [
            "info->mountpoint"
          ],
          "line": 11949
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nvoid\nvirDomainFSInfoFree(virDomainFSInfoPtr info)\n{\n    size_t i;\n\n    if (!info)\n        return;\n\n    g_free(info->mountpoint);\n    g_free(info->name);\n    g_free(info->fstype);\n\n    for (i = 0; i < info->ndevAlias; i++)\n        g_free(info->devAlias[i]);\n    g_free(info->devAlias);\n\n    g_free(info);\n}"
  },
  {
    "function_name": "virDomainGetFSInfo",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "11906-11932",
    "snippet": "int\nvirDomainGetFSInfo(virDomainPtr dom,\n                   virDomainFSInfoPtr **info,\n                   unsigned int flags)\n{\n    VIR_DOMAIN_DEBUG(dom, \"info=%p, flags=0x%x\", info, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(dom, -1);\n    virCheckReadOnlyGoto(dom->conn->flags, error);\n    virCheckNonNullArgGoto(info, error);\n    *info = NULL;\n\n    if (dom->conn->driver->domainGetFSInfo) {\n        int ret = dom->conn->driver->domainGetFSInfo(dom, info, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(dom->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "dom->conn"
          ],
          "line": 11930
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 11927
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dom->conn->driver->domainGetFSInfo",
          "args": [
            "dom",
            "info",
            "flags"
          ],
          "line": 11921
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "info",
            "error"
          ],
          "line": 11917
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "dom->conn->flags",
            "error"
          ],
          "line": 11916
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "dom",
            "-1"
          ],
          "line": 11915
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 11913
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "dom",
            "\"info=%p, flags=0x%x\"",
            "info",
            "flags"
          ],
          "line": 11911
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainGetFSInfo(virDomainPtr dom,\n                   virDomainFSInfoPtr **info,\n                   unsigned int flags)\n{\n    VIR_DOMAIN_DEBUG(dom, \"info=%p, flags=0x%x\", info, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(dom, -1);\n    virCheckReadOnlyGoto(dom->conn->flags, error);\n    virCheckNonNullArgGoto(info, error);\n    *info = NULL;\n\n    if (dom->conn->driver->domainGetFSInfo) {\n        int ret = dom->conn->driver->domainGetFSInfo(dom, info, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(dom->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainStatsRecordListFree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "11874-11889",
    "snippet": "void\nvirDomainStatsRecordListFree(virDomainStatsRecordPtr *stats)\n{\n    virDomainStatsRecordPtr *next;\n\n    if (!stats)\n        return;\n\n    for (next = stats; *next; next++) {\n        virTypedParamsFree((*next)->params, (*next)->nparams);\n        virDomainFree((*next)->dom);\n        VIR_FREE(*next);\n    }\n\n    VIR_FREE(stats);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "stats"
          ],
          "line": 11888
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "*next"
          ],
          "line": 11885
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainFree",
          "args": [
            "(*next)->dom"
          ],
          "line": 11884
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
          "lines": "559-570",
          "snippet": "int\nvirDomainFree(virDomainPtr domain)\n{\n    VIR_DOMAIN_DEBUG(domain);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n\n    virObjectUnref(domain);\n    return 0;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainFree(virDomainPtr domain)\n{\n    VIR_DOMAIN_DEBUG(domain);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n\n    virObjectUnref(domain);\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virTypedParamsFree",
          "args": [
            "(*next)->params",
            "(*next)->nparams"
          ],
          "line": 11883
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParamsFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam-public.c",
          "lines": "878-884",
          "snippet": "void\nvirTypedParamsFree(virTypedParameterPtr params,\n                   int nparams)\n{\n    virTypedParamsClear(params, nparams);\n    VIR_FREE(params);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtypedparam.h\"\n#include <config.h>\n\nvoid\nvirTypedParamsFree(virTypedParameterPtr params,\n                   int nparams)\n{\n    virTypedParamsClear(params, nparams);\n    VIR_FREE(params);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nvoid\nvirDomainStatsRecordListFree(virDomainStatsRecordPtr *stats)\n{\n    virDomainStatsRecordPtr *next;\n\n    if (!stats)\n        return;\n\n    for (next = stats; *next; next++) {\n        virTypedParamsFree((*next)->params, (*next)->nparams);\n        virDomainFree((*next)->dom);\n        VIR_FREE(*next);\n    }\n\n    VIR_FREE(stats);\n}"
  },
  {
    "function_name": "virDomainListGetStats",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "11807-11864",
    "snippet": "int\nvirDomainListGetStats(virDomainPtr *doms,\n                      unsigned int stats,\n                      virDomainStatsRecordPtr **retStats,\n                      unsigned int flags)\n{\n    virConnectPtr conn = NULL;\n    virDomainPtr *nextdom = doms;\n    unsigned int ndoms = 0;\n    int ret = -1;\n\n    VIR_DEBUG(\"doms=%p, stats=0x%x, retStats=%p, flags=0x%x\",\n              doms, stats, retStats, flags);\n\n    virResetLastError();\n\n    virCheckNonNullArgGoto(doms, cleanup);\n    virCheckNonNullArgGoto(retStats, cleanup);\n\n    if (!*doms) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"doms array in %s must contain at least one domain\"),\n                       __FUNCTION__);\n        goto cleanup;\n    }\n\n    conn = doms[0]->conn;\n    virCheckConnectReturn(conn, -1);\n\n    if (!conn->driver->connectGetAllDomainStats) {\n        virReportUnsupportedError();\n        goto cleanup;\n    }\n\n    while (*nextdom) {\n        virDomainPtr dom = *nextdom;\n\n        virCheckDomainGoto(dom, cleanup);\n\n        if (dom->conn != conn) {\n            virReportError(VIR_ERR_INVALID_ARG, \"%s\",\n                           _(\"domains in 'doms' array must belong to a \"\n                             \"single connection\"));\n            goto cleanup;\n        }\n\n        ndoms++;\n        nextdom++;\n    }\n\n    ret = conn->driver->connectGetAllDomainStats(conn, doms, ndoms,\n                                                 stats, retStats, flags);\n\n cleanup:\n    if (ret < 0)\n        virDispatchError(conn);\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "conn"
          ],
          "line": 11862
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "conn->driver->connectGetAllDomainStats",
          "args": [
            "conn",
            "doms",
            "ndoms",
            "stats",
            "retStats",
            "flags"
          ],
          "line": 11857
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INVALID_ARG",
            "\"%s\"",
            "_(\"domains in 'doms' array must belong to a \"\n                             \"single connection\")"
          ],
          "line": 11847
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"domains in 'doms' array must belong to a \"\n                             \"single connection\""
          ],
          "line": 11848
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckDomainGoto",
          "args": [
            "dom",
            "cleanup"
          ],
          "line": 11844
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 11837
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckConnectReturn",
          "args": [
            "conn",
            "-1"
          ],
          "line": 11834
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INVALID_ARG",
            "_(\"doms array in %s must contain at least one domain\")",
            "__FUNCTION__"
          ],
          "line": 11827
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "retStats",
            "cleanup"
          ],
          "line": 11824
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "doms",
            "cleanup"
          ],
          "line": 11823
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 11821
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"doms=%p, stats=0x%x, retStats=%p, flags=0x%x\"",
            "doms",
            "stats",
            "retStats",
            "flags"
          ],
          "line": 11818
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainListGetStats(virDomainPtr *doms,\n                      unsigned int stats,\n                      virDomainStatsRecordPtr **retStats,\n                      unsigned int flags)\n{\n    virConnectPtr conn = NULL;\n    virDomainPtr *nextdom = doms;\n    unsigned int ndoms = 0;\n    int ret = -1;\n\n    VIR_DEBUG(\"doms=%p, stats=0x%x, retStats=%p, flags=0x%x\",\n              doms, stats, retStats, flags);\n\n    virResetLastError();\n\n    virCheckNonNullArgGoto(doms, cleanup);\n    virCheckNonNullArgGoto(retStats, cleanup);\n\n    if (!*doms) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"doms array in %s must contain at least one domain\"),\n                       __FUNCTION__);\n        goto cleanup;\n    }\n\n    conn = doms[0]->conn;\n    virCheckConnectReturn(conn, -1);\n\n    if (!conn->driver->connectGetAllDomainStats) {\n        virReportUnsupportedError();\n        goto cleanup;\n    }\n\n    while (*nextdom) {\n        virDomainPtr dom = *nextdom;\n\n        virCheckDomainGoto(dom, cleanup);\n\n        if (dom->conn != conn) {\n            virReportError(VIR_ERR_INVALID_ARG, \"%s\",\n                           _(\"domains in 'doms' array must belong to a \"\n                             \"single connection\"));\n            goto cleanup;\n        }\n\n        ndoms++;\n        nextdom++;\n    }\n\n    ret = conn->driver->connectGetAllDomainStats(conn, doms, ndoms,\n                                                 stats, retStats, flags);\n\n cleanup:\n    if (ret < 0)\n        virDispatchError(conn);\n    return ret;\n}"
  },
  {
    "function_name": "virConnectGetAllDomainStats",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "11728-11757",
    "snippet": "int\nvirConnectGetAllDomainStats(virConnectPtr conn,\n                            unsigned int stats,\n                            virDomainStatsRecordPtr **retStats,\n                            unsigned int flags)\n{\n    int ret = -1;\n\n    VIR_DEBUG(\"conn=%p, stats=0x%x, retStats=%p, flags=0x%x\",\n              conn, stats, retStats, flags);\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, -1);\n    virCheckNonNullArgGoto(retStats, cleanup);\n\n    if (!conn->driver->connectGetAllDomainStats) {\n        virReportUnsupportedError();\n        goto cleanup;\n    }\n\n    ret = conn->driver->connectGetAllDomainStats(conn, NULL, 0, stats,\n                                                 retStats, flags);\n\n cleanup:\n    if (ret < 0)\n        virDispatchError(conn);\n\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "conn"
          ],
          "line": 11754
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "conn->driver->connectGetAllDomainStats",
          "args": [
            "conn",
            "NULL",
            "0",
            "stats",
            "retStats",
            "flags"
          ],
          "line": 11749
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 11745
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "retStats",
            "cleanup"
          ],
          "line": 11742
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckConnectReturn",
          "args": [
            "conn",
            "-1"
          ],
          "line": 11741
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 11739
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"conn=%p, stats=0x%x, retStats=%p, flags=0x%x\"",
            "conn",
            "stats",
            "retStats",
            "flags"
          ],
          "line": 11736
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirConnectGetAllDomainStats(virConnectPtr conn,\n                            unsigned int stats,\n                            virDomainStatsRecordPtr **retStats,\n                            unsigned int flags)\n{\n    int ret = -1;\n\n    VIR_DEBUG(\"conn=%p, stats=0x%x, retStats=%p, flags=0x%x\",\n              conn, stats, retStats, flags);\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, -1);\n    virCheckNonNullArgGoto(retStats, cleanup);\n\n    if (!conn->driver->connectGetAllDomainStats) {\n        virReportUnsupportedError();\n        goto cleanup;\n    }\n\n    ret = conn->driver->connectGetAllDomainStats(conn, NULL, 0, stats,\n                                                 retStats, flags);\n\n cleanup:\n    if (ret < 0)\n        virDispatchError(conn);\n\n    return ret;\n}"
  },
  {
    "function_name": "virConnectGetDomainCapabilities",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "11387-11421",
    "snippet": "char *\nvirConnectGetDomainCapabilities(virConnectPtr conn,\n                                const char *emulatorbin,\n                                const char *arch,\n                                const char *machine,\n                                const char *virttype,\n                                unsigned int flags)\n{\n    VIR_DEBUG(\"conn=%p, emulatorbin=%s, arch=%s, \"\n              \"machine=%s, virttype=%s, flags=0x%x\",\n              conn, NULLSTR(emulatorbin), NULLSTR(arch),\n              NULLSTR(machine), NULLSTR(virttype), flags);\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, NULL);\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->driver->connectGetDomainCapabilities) {\n        char *ret;\n        ret = conn->driver->connectGetDomainCapabilities(conn, emulatorbin,\n                                                         arch, machine,\n                                                         virttype, flags);\n        if (!ret)\n            goto error;\n        VIR_DEBUG(\"conn=%p, ret=%s\", conn, ret);\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return NULL;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "conn"
          ],
          "line": 11419
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 11416
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"conn=%p, ret=%s\"",
            "conn",
            "ret"
          ],
          "line": 11412
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->connectGetDomainCapabilities",
          "args": [
            "conn",
            "emulatorbin",
            "arch",
            "machine",
            "virttype",
            "flags"
          ],
          "line": 11407
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "conn->flags",
            "error"
          ],
          "line": 11403
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckConnectReturn",
          "args": [
            "conn",
            "NULL"
          ],
          "line": 11402
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 11400
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"conn=%p, emulatorbin=%s, arch=%s, \"\n              \"machine=%s, virttype=%s, flags=0x%x\"",
            "conn",
            "NULLSTR(emulatorbin)",
            "NULLSTR(arch)",
            "NULLSTR(machine)",
            "NULLSTR(virttype)",
            "flags"
          ],
          "line": 11395
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "virttype"
          ],
          "line": 11398
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "machine"
          ],
          "line": 11398
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "arch"
          ],
          "line": 11397
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "emulatorbin"
          ],
          "line": 11397
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nchar *\nvirConnectGetDomainCapabilities(virConnectPtr conn,\n                                const char *emulatorbin,\n                                const char *arch,\n                                const char *machine,\n                                const char *virttype,\n                                unsigned int flags)\n{\n    VIR_DEBUG(\"conn=%p, emulatorbin=%s, arch=%s, \"\n              \"machine=%s, virttype=%s, flags=0x%x\",\n              conn, NULLSTR(emulatorbin), NULLSTR(arch),\n              NULLSTR(machine), NULLSTR(virttype), flags);\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, NULL);\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->driver->connectGetDomainCapabilities) {\n        char *ret;\n        ret = conn->driver->connectGetDomainCapabilities(conn, emulatorbin,\n                                                         arch, machine,\n                                                         virttype, flags);\n        if (!ret)\n            goto error;\n        VIR_DEBUG(\"conn=%p, ret=%s\", conn, ret);\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return NULL;\n}"
  },
  {
    "function_name": "virDomainSetUserPassword",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "11337-11366",
    "snippet": "int\nvirDomainSetUserPassword(virDomainPtr dom,\n                         const char *user,\n                         const char *password,\n                         unsigned int flags)\n{\n    VIR_DOMAIN_DEBUG(dom, \"user=%s, password=%s, flags=0x%x\",\n                     NULLSTR(user), NULLSTR(password), flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(dom, -1);\n    virCheckReadOnlyGoto(dom->conn->flags, error);\n    virCheckNonNullArgGoto(user, error);\n    virCheckNonNullArgGoto(password, error);\n\n    if (dom->conn->driver->domainSetUserPassword) {\n        int ret = dom->conn->driver->domainSetUserPassword(dom, user, password,\n                                                           flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(dom->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "dom->conn"
          ],
          "line": 11364
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 11361
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dom->conn->driver->domainSetUserPassword",
          "args": [
            "dom",
            "user",
            "password",
            "flags"
          ],
          "line": 11354
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "password",
            "error"
          ],
          "line": 11351
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "user",
            "error"
          ],
          "line": 11350
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "dom->conn->flags",
            "error"
          ],
          "line": 11349
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "dom",
            "-1"
          ],
          "line": 11348
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 11346
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "dom",
            "\"user=%s, password=%s, flags=0x%x\"",
            "NULLSTR(user)",
            "NULLSTR(password)",
            "flags"
          ],
          "line": 11343
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "password"
          ],
          "line": 11344
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "user"
          ],
          "line": 11344
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainSetUserPassword(virDomainPtr dom,\n                         const char *user,\n                         const char *password,\n                         unsigned int flags)\n{\n    VIR_DOMAIN_DEBUG(dom, \"user=%s, password=%s, flags=0x%x\",\n                     NULLSTR(user), NULLSTR(password), flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(dom, -1);\n    virCheckReadOnlyGoto(dom->conn->flags, error);\n    virCheckNonNullArgGoto(user, error);\n    virCheckNonNullArgGoto(password, error);\n\n    if (dom->conn->driver->domainSetUserPassword) {\n        int ret = dom->conn->driver->domainSetUserPassword(dom, user, password,\n                                                           flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(dom->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainSetTime",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "11291-11318",
    "snippet": "int\nvirDomainSetTime(virDomainPtr dom,\n                 long long seconds,\n                 unsigned int nseconds,\n                 unsigned int flags)\n{\n    VIR_DOMAIN_DEBUG(dom, \"seconds=%lld, nseconds=%u, flags=0x%x\",\n                     seconds, nseconds, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(dom, -1);\n    virCheckReadOnlyGoto(dom->conn->flags, error);\n\n    if (dom->conn->driver->domainSetTime) {\n        int ret = dom->conn->driver->domainSetTime(dom, seconds,\n                                                   nseconds, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(dom->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "dom->conn"
          ],
          "line": 11316
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 11313
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dom->conn->driver->domainSetTime",
          "args": [
            "dom",
            "seconds",
            "nseconds",
            "flags"
          ],
          "line": 11306
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "dom->conn->flags",
            "error"
          ],
          "line": 11303
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "dom",
            "-1"
          ],
          "line": 11302
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 11300
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "dom",
            "\"seconds=%lld, nseconds=%u, flags=0x%x\"",
            "seconds",
            "nseconds",
            "flags"
          ],
          "line": 11297
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainSetTime(virDomainPtr dom,\n                 long long seconds,\n                 unsigned int nseconds,\n                 unsigned int flags)\n{\n    VIR_DOMAIN_DEBUG(dom, \"seconds=%lld, nseconds=%u, flags=0x%x\",\n                     seconds, nseconds, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(dom, -1);\n    virCheckReadOnlyGoto(dom->conn->flags, error);\n\n    if (dom->conn->driver->domainSetTime) {\n        int ret = dom->conn->driver->domainSetTime(dom, seconds,\n                                                   nseconds, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(dom->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainGetTime",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "11241-11268",
    "snippet": "int\nvirDomainGetTime(virDomainPtr dom,\n                 long long *seconds,\n                 unsigned int *nseconds,\n                 unsigned int flags)\n{\n    VIR_DOMAIN_DEBUG(dom, \"seconds=%p, nseconds=%p, flags=0x%x\",\n                     seconds, nseconds, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(dom, -1);\n    virCheckReadOnlyGoto(dom->conn->flags, error);\n\n    if (dom->conn->driver->domainGetTime) {\n        int ret = dom->conn->driver->domainGetTime(dom, seconds,\n                                                   nseconds, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(dom->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "dom->conn"
          ],
          "line": 11266
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 11263
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dom->conn->driver->domainGetTime",
          "args": [
            "dom",
            "seconds",
            "nseconds",
            "flags"
          ],
          "line": 11256
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "dom->conn->flags",
            "error"
          ],
          "line": 11253
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "dom",
            "-1"
          ],
          "line": 11252
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 11250
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "dom",
            "\"seconds=%p, nseconds=%p, flags=0x%x\"",
            "seconds",
            "nseconds",
            "flags"
          ],
          "line": 11247
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainGetTime(virDomainPtr dom,\n                 long long *seconds,\n                 unsigned int *nseconds,\n                 unsigned int flags)\n{\n    VIR_DOMAIN_DEBUG(dom, \"seconds=%p, nseconds=%p, flags=0x%x\",\n                     seconds, nseconds, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(dom, -1);\n    virCheckReadOnlyGoto(dom->conn->flags, error);\n\n    if (dom->conn->driver->domainGetTime) {\n        int ret = dom->conn->driver->domainGetTime(dom, seconds,\n                                                   nseconds, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(dom->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainFSThaw",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "11196-11223",
    "snippet": "int\nvirDomainFSThaw(virDomainPtr dom,\n                const char **mountpoints,\n                unsigned int nmountpoints,\n                unsigned int flags)\n{\n    VIR_DOMAIN_DEBUG(dom, \"flags=0x%x\", flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(dom, -1);\n    virCheckReadOnlyGoto(dom->conn->flags, error);\n    virCheckNonNullArrayArgGoto(mountpoints, nmountpoints, error);\n\n    if (dom->conn->driver->domainFSThaw) {\n        int ret = dom->conn->driver->domainFSThaw(\n            dom, mountpoints, nmountpoints, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(dom->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "dom->conn"
          ],
          "line": 11221
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 11218
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dom->conn->driver->domainFSThaw",
          "args": [
            "dom",
            "mountpoints",
            "nmountpoints",
            "flags"
          ],
          "line": 11211
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArrayArgGoto",
          "args": [
            "mountpoints",
            "nmountpoints",
            "error"
          ],
          "line": 11208
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "dom->conn->flags",
            "error"
          ],
          "line": 11207
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "dom",
            "-1"
          ],
          "line": 11206
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 11204
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "dom",
            "\"flags=0x%x\"",
            "flags"
          ],
          "line": 11202
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainFSThaw(virDomainPtr dom,\n                const char **mountpoints,\n                unsigned int nmountpoints,\n                unsigned int flags)\n{\n    VIR_DOMAIN_DEBUG(dom, \"flags=0x%x\", flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(dom, -1);\n    virCheckReadOnlyGoto(dom->conn->flags, error);\n    virCheckNonNullArrayArgGoto(mountpoints, nmountpoints, error);\n\n    if (dom->conn->driver->domainFSThaw) {\n        int ret = dom->conn->driver->domainFSThaw(\n            dom, mountpoints, nmountpoints, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(dom->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainFSFreeze",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "11153-11181",
    "snippet": "int\nvirDomainFSFreeze(virDomainPtr dom,\n                  const char **mountpoints,\n                  unsigned int nmountpoints,\n                  unsigned int flags)\n{\n    VIR_DOMAIN_DEBUG(dom, \"mountpoints=%p, nmountpoints=%d, flags=0x%x\",\n                     mountpoints, nmountpoints, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(dom, -1);\n    virCheckReadOnlyGoto(dom->conn->flags, error);\n    virCheckNonNullArrayArgGoto(mountpoints, nmountpoints, error);\n\n    if (dom->conn->driver->domainFSFreeze) {\n        int ret = dom->conn->driver->domainFSFreeze(\n            dom, mountpoints, nmountpoints, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(dom->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "dom->conn"
          ],
          "line": 11179
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 11176
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dom->conn->driver->domainFSFreeze",
          "args": [
            "dom",
            "mountpoints",
            "nmountpoints",
            "flags"
          ],
          "line": 11169
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArrayArgGoto",
          "args": [
            "mountpoints",
            "nmountpoints",
            "error"
          ],
          "line": 11166
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "dom->conn->flags",
            "error"
          ],
          "line": 11165
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "dom",
            "-1"
          ],
          "line": 11164
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 11162
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "dom",
            "\"mountpoints=%p, nmountpoints=%d, flags=0x%x\"",
            "mountpoints",
            "nmountpoints",
            "flags"
          ],
          "line": 11159
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainFSFreeze(virDomainPtr dom,\n                  const char **mountpoints,\n                  unsigned int nmountpoints,\n                  unsigned int flags)\n{\n    VIR_DOMAIN_DEBUG(dom, \"mountpoints=%p, nmountpoints=%d, flags=0x%x\",\n                     mountpoints, nmountpoints, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(dom, -1);\n    virCheckReadOnlyGoto(dom->conn->flags, error);\n    virCheckNonNullArrayArgGoto(mountpoints, nmountpoints, error);\n\n    if (dom->conn->driver->domainFSFreeze) {\n        int ret = dom->conn->driver->domainFSFreeze(\n            dom, mountpoints, nmountpoints, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(dom->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainFSTrim",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "11109-11136",
    "snippet": "int\nvirDomainFSTrim(virDomainPtr dom,\n                const char *mountPoint,\n                unsigned long long minimum,\n                unsigned int flags)\n{\n    VIR_DOMAIN_DEBUG(dom, \"mountPoint=%s, minimum=%llu, flags=0x%x\",\n                     mountPoint, minimum, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(dom, -1);\n    virCheckReadOnlyGoto(dom->conn->flags, error);\n\n    if (dom->conn->driver->domainFSTrim) {\n        int ret = dom->conn->driver->domainFSTrim(dom, mountPoint,\n                                                  minimum, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(dom->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "dom->conn"
          ],
          "line": 11134
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 11131
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dom->conn->driver->domainFSTrim",
          "args": [
            "dom",
            "mountPoint",
            "minimum",
            "flags"
          ],
          "line": 11124
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "dom->conn->flags",
            "error"
          ],
          "line": 11121
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "dom",
            "-1"
          ],
          "line": 11120
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 11118
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "dom",
            "\"mountPoint=%s, minimum=%llu, flags=0x%x\"",
            "mountPoint",
            "minimum",
            "flags"
          ],
          "line": 11115
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainFSTrim(virDomainPtr dom,\n                const char *mountPoint,\n                unsigned long long minimum,\n                unsigned int flags)\n{\n    VIR_DOMAIN_DEBUG(dom, \"mountPoint=%s, minimum=%llu, flags=0x%x\",\n                     mountPoint, minimum, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(dom, -1);\n    virCheckReadOnlyGoto(dom->conn->flags, error);\n\n    if (dom->conn->driver->domainFSTrim) {\n        int ret = dom->conn->driver->domainFSTrim(dom, mountPoint,\n                                                  minimum, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(dom->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainGetHostname",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "11060-11087",
    "snippet": "char *\nvirDomainGetHostname(virDomainPtr domain, unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"flags=0x%x\", flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, NULL);\n    conn = domain->conn;\n\n    virCheckReadOnlyGoto(domain->conn->flags, error);\n\n    if (conn->driver->domainGetHostname) {\n        char *ret;\n        ret = conn->driver->domainGetHostname(domain, flags);\n        if (!ret)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return NULL;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "domain->conn"
          ],
          "line": 11085
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 11082
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainGetHostname",
          "args": [
            "domain",
            "flags"
          ],
          "line": 11076
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "domain->conn->flags",
            "error"
          ],
          "line": 11072
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "domain",
            "NULL"
          ],
          "line": 11069
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 11067
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "domain",
            "\"flags=0x%x\"",
            "flags"
          ],
          "line": 11065
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nchar *\nvirDomainGetHostname(virDomainPtr domain, unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"flags=0x%x\", flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, NULL);\n    conn = domain->conn;\n\n    virCheckReadOnlyGoto(domain->conn->flags, error);\n\n    if (conn->driver->domainGetHostname) {\n        char *ret;\n        ret = conn->driver->domainGetHostname(domain, flags);\n        if (!ret)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return NULL;\n}"
  },
  {
    "function_name": "virDomainGetDiskErrors",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "11015-11043",
    "snippet": "int\nvirDomainGetDiskErrors(virDomainPtr dom,\n                       virDomainDiskErrorPtr errors,\n                       unsigned int maxerrors,\n                       unsigned int flags)\n{\n    VIR_DOMAIN_DEBUG(dom, \"errors=%p, maxerrors=%u, flags=0x%x\",\n                     errors, maxerrors, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(dom, -1);\n\n    virCheckNonNullArrayArgGoto(errors, maxerrors, error);\n\n    if (dom->conn->driver->domainGetDiskErrors) {\n        int ret = dom->conn->driver->domainGetDiskErrors(dom, errors,\n                                                         maxerrors, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(dom->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "dom->conn"
          ],
          "line": 11041
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 11038
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dom->conn->driver->domainGetDiskErrors",
          "args": [
            "dom",
            "errors",
            "maxerrors",
            "flags"
          ],
          "line": 11031
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArrayArgGoto",
          "args": [
            "errors",
            "maxerrors",
            "error"
          ],
          "line": 11028
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "dom",
            "-1"
          ],
          "line": 11026
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 11024
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "dom",
            "\"errors=%p, maxerrors=%u, flags=0x%x\"",
            "errors",
            "maxerrors",
            "flags"
          ],
          "line": 11021
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainGetDiskErrors(virDomainPtr dom,\n                       virDomainDiskErrorPtr errors,\n                       unsigned int maxerrors,\n                       unsigned int flags)\n{\n    VIR_DOMAIN_DEBUG(dom, \"errors=%p, maxerrors=%u, flags=0x%x\",\n                     errors, maxerrors, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(dom, -1);\n\n    virCheckNonNullArrayArgGoto(errors, maxerrors, error);\n\n    if (dom->conn->driver->domainGetDiskErrors) {\n        int ret = dom->conn->driver->domainGetDiskErrors(dom, errors,\n                                                         maxerrors, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(dom->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainGetCPUStats",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "10919-10984",
    "snippet": "int\nvirDomainGetCPUStats(virDomainPtr domain,\n                     virTypedParameterPtr params,\n                     unsigned int nparams,\n                     int start_cpu,\n                     unsigned int ncpus,\n                     unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain,\n                     \"params=%p, nparams=%d, start_cpu=%d, ncpus=%u, flags=0x%x\",\n                     params, nparams, start_cpu, ncpus, flags);\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    /* Special cases:\n     * start_cpu must be non-negative, or else -1\n     * if start_cpu is -1, ncpus must be 1\n     * params == NULL must match nparams == 0\n     * ncpus must be non-zero unless params == NULL\n     * nparams * ncpus must not overflow (RPC may restrict it even more)\n     */\n    if (start_cpu == -1) {\n        if (ncpus != 1) {\n            virReportInvalidArg(start_cpu, \"%s\",\n                                _(\"ncpus must be 1 when start_cpu is -1\"));\n            goto error;\n        }\n    } else {\n        virCheckNonNegativeArgGoto(start_cpu, error);\n    }\n    if (nparams)\n        virCheckNonNullArgGoto(params, error);\n    else\n        virCheckNullArgGoto(params, error);\n    if (ncpus == 0)\n        virCheckNullArgGoto(params, error);\n\n    if (nparams && ncpus > UINT_MAX / nparams) {\n        virReportError(VIR_ERR_OVERFLOW, _(\"input too large: %u * %u\"),\n                       nparams, ncpus);\n        goto error;\n    }\n    if (VIR_DRV_SUPPORTS_FEATURE(domain->conn->driver, domain->conn,\n                                 VIR_DRV_FEATURE_TYPED_PARAM_STRING))\n        flags |= VIR_TYPED_PARAM_STRING_OKAY;\n\n    if (conn->driver->domainGetCPUStats) {\n        int ret;\n\n        ret = conn->driver->domainGetCPUStats(domain, params, nparams,\n                                              start_cpu, ncpus, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "domain->conn"
          ],
          "line": 10982
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 10979
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainGetCPUStats",
          "args": [
            "domain",
            "params",
            "nparams",
            "start_cpu",
            "ncpus",
            "flags"
          ],
          "line": 10972
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DRV_SUPPORTS_FEATURE",
          "args": [
            "domain->conn->driver",
            "domain->conn",
            "VIR_DRV_FEATURE_TYPED_PARAM_STRING"
          ],
          "line": 10965
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OVERFLOW",
            "_(\"input too large: %u * %u\")",
            "nparams",
            "ncpus"
          ],
          "line": 10961
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"input too large: %u * %u\""
          ],
          "line": 10961
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckNullArgGoto",
          "args": [
            "params",
            "error"
          ],
          "line": 10958
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNullArgGoto",
          "args": [
            "params",
            "error"
          ],
          "line": 10956
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "params",
            "error"
          ],
          "line": 10954
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNegativeArgGoto",
          "args": [
            "start_cpu",
            "error"
          ],
          "line": 10951
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportInvalidArg",
          "args": [
            "start_cpu",
            "\"%s\"",
            "_(\"ncpus must be 1 when start_cpu is -1\")"
          ],
          "line": 10946
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "domain",
            "-1"
          ],
          "line": 10934
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 10932
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "domain",
            "\"params=%p, nparams=%d, start_cpu=%d, ncpus=%u, flags=0x%x\"",
            "params",
            "nparams",
            "start_cpu",
            "ncpus",
            "flags"
          ],
          "line": 10929
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainGetCPUStats(virDomainPtr domain,\n                     virTypedParameterPtr params,\n                     unsigned int nparams,\n                     int start_cpu,\n                     unsigned int ncpus,\n                     unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain,\n                     \"params=%p, nparams=%d, start_cpu=%d, ncpus=%u, flags=0x%x\",\n                     params, nparams, start_cpu, ncpus, flags);\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    /* Special cases:\n     * start_cpu must be non-negative, or else -1\n     * if start_cpu is -1, ncpus must be 1\n     * params == NULL must match nparams == 0\n     * ncpus must be non-zero unless params == NULL\n     * nparams * ncpus must not overflow (RPC may restrict it even more)\n     */\n    if (start_cpu == -1) {\n        if (ncpus != 1) {\n            virReportInvalidArg(start_cpu, \"%s\",\n                                _(\"ncpus must be 1 when start_cpu is -1\"));\n            goto error;\n        }\n    } else {\n        virCheckNonNegativeArgGoto(start_cpu, error);\n    }\n    if (nparams)\n        virCheckNonNullArgGoto(params, error);\n    else\n        virCheckNullArgGoto(params, error);\n    if (ncpus == 0)\n        virCheckNullArgGoto(params, error);\n\n    if (nparams && ncpus > UINT_MAX / nparams) {\n        virReportError(VIR_ERR_OVERFLOW, _(\"input too large: %u * %u\"),\n                       nparams, ncpus);\n        goto error;\n    }\n    if (VIR_DRV_SUPPORTS_FEATURE(domain->conn->driver, domain->conn,\n                                 VIR_DRV_FEATURE_TYPED_PARAM_STRING))\n        flags |= VIR_TYPED_PARAM_STRING_OKAY;\n\n    if (conn->driver->domainGetCPUStats) {\n        int ret;\n\n        ret = conn->driver->domainGetCPUStats(domain, params, nparams,\n                                              start_cpu, ncpus, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainGetBlockIoTune",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "10794-10840",
    "snippet": "int\nvirDomainGetBlockIoTune(virDomainPtr dom,\n                        const char *disk,\n                        virTypedParameterPtr params,\n                        int *nparams,\n                        unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(dom, \"disk=%s, params=%p, nparams=%d, flags=0x%x\",\n                     NULLSTR(disk), params, (nparams) ? *nparams : -1, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(dom, -1);\n\n    virCheckNonNullArgGoto(nparams, error);\n    virCheckNonNegativeArgGoto(*nparams, error);\n    if (*nparams != 0) {\n        virCheckNonNullArgGoto(params, error);\n        virCheckNonNullArgGoto(disk, error);\n    }\n\n    if (VIR_DRV_SUPPORTS_FEATURE(dom->conn->driver, dom->conn,\n                                 VIR_DRV_FEATURE_TYPED_PARAM_STRING))\n        flags |= VIR_TYPED_PARAM_STRING_OKAY;\n\n    VIR_EXCLUSIVE_FLAGS_GOTO(VIR_DOMAIN_AFFECT_LIVE,\n                             VIR_DOMAIN_AFFECT_CONFIG,\n                             error);\n\n    conn = dom->conn;\n\n    if (conn->driver->domainGetBlockIoTune) {\n        int ret;\n        ret = conn->driver->domainGetBlockIoTune(dom, disk, params, nparams, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(dom->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "dom->conn"
          ],
          "line": 10838
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 10835
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainGetBlockIoTune",
          "args": [
            "dom",
            "disk",
            "params",
            "nparams",
            "flags"
          ],
          "line": 10829
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_EXCLUSIVE_FLAGS_GOTO",
          "args": [
            "VIR_DOMAIN_AFFECT_LIVE",
            "VIR_DOMAIN_AFFECT_CONFIG",
            "error"
          ],
          "line": 10821
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DRV_SUPPORTS_FEATURE",
          "args": [
            "dom->conn->driver",
            "dom->conn",
            "VIR_DRV_FEATURE_TYPED_PARAM_STRING"
          ],
          "line": 10817
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "disk",
            "error"
          ],
          "line": 10814
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "params",
            "error"
          ],
          "line": 10813
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNegativeArgGoto",
          "args": [
            "*nparams",
            "error"
          ],
          "line": 10811
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "nparams",
            "error"
          ],
          "line": 10810
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "dom",
            "-1"
          ],
          "line": 10808
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 10806
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "dom",
            "\"disk=%s, params=%p, nparams=%d, flags=0x%x\"",
            "NULLSTR(disk)",
            "params",
            "(nparams) ? *nparams : -1",
            "flags"
          ],
          "line": 10803
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "disk"
          ],
          "line": 10804
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainGetBlockIoTune(virDomainPtr dom,\n                        const char *disk,\n                        virTypedParameterPtr params,\n                        int *nparams,\n                        unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(dom, \"disk=%s, params=%p, nparams=%d, flags=0x%x\",\n                     NULLSTR(disk), params, (nparams) ? *nparams : -1, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(dom, -1);\n\n    virCheckNonNullArgGoto(nparams, error);\n    virCheckNonNegativeArgGoto(*nparams, error);\n    if (*nparams != 0) {\n        virCheckNonNullArgGoto(params, error);\n        virCheckNonNullArgGoto(disk, error);\n    }\n\n    if (VIR_DRV_SUPPORTS_FEATURE(dom->conn->driver, dom->conn,\n                                 VIR_DRV_FEATURE_TYPED_PARAM_STRING))\n        flags |= VIR_TYPED_PARAM_STRING_OKAY;\n\n    VIR_EXCLUSIVE_FLAGS_GOTO(VIR_DOMAIN_AFFECT_LIVE,\n                             VIR_DOMAIN_AFFECT_CONFIG,\n                             error);\n\n    conn = dom->conn;\n\n    if (conn->driver->domainGetBlockIoTune) {\n        int ret;\n        ret = conn->driver->domainGetBlockIoTune(dom, disk, params, nparams, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(dom->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainSetBlockIoTune",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "10719-10758",
    "snippet": "int\nvirDomainSetBlockIoTune(virDomainPtr dom,\n                        const char *disk,\n                        virTypedParameterPtr params,\n                        int nparams,\n                        unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(dom, \"disk=%s, params=%p, nparams=%d, flags=0x%x\",\n                     disk, params, nparams, flags);\n    VIR_TYPED_PARAMS_DEBUG(params, nparams);\n\n    virResetLastError();\n\n    virCheckDomainReturn(dom, -1);\n    conn = dom->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n    virCheckNonNullArgGoto(disk, error);\n    virCheckPositiveArgGoto(nparams, error);\n    virCheckNonNullArgGoto(params, error);\n\n    if (virTypedParameterValidateSet(dom->conn, params, nparams) < 0)\n        goto error;\n\n    if (conn->driver->domainSetBlockIoTune) {\n        int ret;\n        ret = conn->driver->domainSetBlockIoTune(dom, disk, params, nparams, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(dom->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "dom->conn"
          ],
          "line": 10756
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 10753
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainSetBlockIoTune",
          "args": [
            "dom",
            "disk",
            "params",
            "nparams",
            "flags"
          ],
          "line": 10747
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virTypedParameterValidateSet",
          "args": [
            "dom->conn",
            "params",
            "nparams"
          ],
          "line": 10742
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParameterValidateSet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt.c",
          "lines": "1288-1325",
          "snippet": "int\nvirTypedParameterValidateSet(virConnectPtr conn,\n                             virTypedParameterPtr params,\n                             int nparams)\n{\n    bool string_okay;\n    size_t i;\n\n    string_okay = VIR_DRV_SUPPORTS_FEATURE(conn->driver,\n                                           conn,\n                                           VIR_DRV_FEATURE_TYPED_PARAM_STRING);\n    for (i = 0; i < nparams; i++) {\n        if (strnlen(params[i].field, VIR_TYPED_PARAM_FIELD_LENGTH) ==\n            VIR_TYPED_PARAM_FIELD_LENGTH) {\n            virReportInvalidArg(params,\n                                _(\"string parameter name '%.*s' too long\"),\n                                VIR_TYPED_PARAM_FIELD_LENGTH,\n                                params[i].field);\n            return -1;\n        }\n        if (params[i].type == VIR_TYPED_PARAM_STRING) {\n            if (string_okay) {\n                if (!params[i].value.s) {\n                    virReportInvalidArg(params,\n                                        _(\"NULL string parameter '%s'\"),\n                                        params[i].field);\n                    return -1;\n                }\n            } else {\n                virReportInvalidArg(params,\n                                    _(\"string parameter '%s' unsupported\"),\n                                    params[i].field);\n                return -1;\n            }\n        }\n    }\n    return 0;\n}",
          "includes": [
            "#include \"access/viraccessmanager.h\"",
            "# include \"bhyve/bhyve_driver.h\"",
            "# include \"hyperv/hyperv_driver.h\"",
            "# include \"esx/esx_driver.h\"",
            "# include \"vmware/vmware_driver.h\"",
            "# include \"openvz/openvz_driver.h\"",
            "# include \"remote/remote_driver.h\"",
            "# include \"test/test_driver.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"viruri.h\"",
            "#include \"virrandom.h\"",
            "#include \"virfile.h\"",
            "#include \"virevent.h\"",
            "#include \"vircommand.h\"",
            "#include \"rpc/virnettlscontext.h\"",
            "#include \"virconf.h\"",
            "#include \"configmake.h\"",
            "#include \"viralloc.h\"",
            "#include \"viruuid.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <curl/curl.h>",
            "#include <libxml/xpath.h>",
            "#include <libxml/parser.h>",
            "#include <gio/gnetworking.h>",
            "#include <time.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"access/viraccessmanager.h\"\n# include \"bhyve/bhyve_driver.h\"\n# include \"hyperv/hyperv_driver.h\"\n# include \"esx/esx_driver.h\"\n# include \"vmware/vmware_driver.h\"\n# include \"openvz/openvz_driver.h\"\n# include \"remote/remote_driver.h\"\n# include \"test/test_driver.h\"\n#include \"virtypedparam.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"viruri.h\"\n#include \"virrandom.h\"\n#include \"virfile.h\"\n#include \"virevent.h\"\n#include \"vircommand.h\"\n#include \"rpc/virnettlscontext.h\"\n#include \"virconf.h\"\n#include \"configmake.h\"\n#include \"viralloc.h\"\n#include \"viruuid.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <curl/curl.h>\n#include <libxml/xpath.h>\n#include <libxml/parser.h>\n#include <gio/gnetworking.h>\n#include <time.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nint\nvirTypedParameterValidateSet(virConnectPtr conn,\n                             virTypedParameterPtr params,\n                             int nparams)\n{\n    bool string_okay;\n    size_t i;\n\n    string_okay = VIR_DRV_SUPPORTS_FEATURE(conn->driver,\n                                           conn,\n                                           VIR_DRV_FEATURE_TYPED_PARAM_STRING);\n    for (i = 0; i < nparams; i++) {\n        if (strnlen(params[i].field, VIR_TYPED_PARAM_FIELD_LENGTH) ==\n            VIR_TYPED_PARAM_FIELD_LENGTH) {\n            virReportInvalidArg(params,\n                                _(\"string parameter name '%.*s' too long\"),\n                                VIR_TYPED_PARAM_FIELD_LENGTH,\n                                params[i].field);\n            return -1;\n        }\n        if (params[i].type == VIR_TYPED_PARAM_STRING) {\n            if (string_okay) {\n                if (!params[i].value.s) {\n                    virReportInvalidArg(params,\n                                        _(\"NULL string parameter '%s'\"),\n                                        params[i].field);\n                    return -1;\n                }\n            } else {\n                virReportInvalidArg(params,\n                                    _(\"string parameter '%s' unsupported\"),\n                                    params[i].field);\n                return -1;\n            }\n        }\n    }\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "params",
            "error"
          ],
          "line": 10740
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckPositiveArgGoto",
          "args": [
            "nparams",
            "error"
          ],
          "line": 10739
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "disk",
            "error"
          ],
          "line": 10738
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "conn->flags",
            "error"
          ],
          "line": 10737
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "dom",
            "-1"
          ],
          "line": 10734
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 10732
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_TYPED_PARAMS_DEBUG",
          "args": [
            "params",
            "nparams"
          ],
          "line": 10730
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "dom",
            "\"disk=%s, params=%p, nparams=%d, flags=0x%x\"",
            "disk",
            "params",
            "nparams",
            "flags"
          ],
          "line": 10728
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainSetBlockIoTune(virDomainPtr dom,\n                        const char *disk,\n                        virTypedParameterPtr params,\n                        int nparams,\n                        unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(dom, \"disk=%s, params=%p, nparams=%d, flags=0x%x\",\n                     disk, params, nparams, flags);\n    VIR_TYPED_PARAMS_DEBUG(params, nparams);\n\n    virResetLastError();\n\n    virCheckDomainReturn(dom, -1);\n    conn = dom->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n    virCheckNonNullArgGoto(disk, error);\n    virCheckPositiveArgGoto(nparams, error);\n    virCheckNonNullArgGoto(params, error);\n\n    if (virTypedParameterValidateSet(dom->conn, params, nparams) < 0)\n        goto error;\n\n    if (conn->driver->domainSetBlockIoTune) {\n        int ret;\n        ret = conn->driver->domainSetBlockIoTune(dom, disk, params, nparams, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(dom->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainOpenGraphicsFD",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "10663-10696",
    "snippet": "int\nvirDomainOpenGraphicsFD(virDomainPtr dom,\n                        unsigned int idx,\n                        unsigned int flags)\n{\n    VIR_DOMAIN_DEBUG(dom, \"idx=%u, flags=0x%x\", idx, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(dom, -1);\n\n    virCheckReadOnlyGoto(dom->conn->flags, error);\n\n    if (!VIR_DRV_SUPPORTS_FEATURE(dom->conn->driver, dom->conn,\n                                  VIR_DRV_FEATURE_FD_PASSING)) {\n        virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED, \"%s\",\n                       _(\"fd passing is not supported by this connection\"));\n        goto error;\n    }\n\n    if (dom->conn->driver->domainOpenGraphicsFD) {\n        int ret;\n        ret = dom->conn->driver->domainOpenGraphicsFD(dom, idx, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(dom->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "dom->conn"
          ],
          "line": 10694
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 10691
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dom->conn->driver->domainOpenGraphicsFD",
          "args": [
            "dom",
            "idx",
            "flags"
          ],
          "line": 10685
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_ARGUMENT_UNSUPPORTED",
            "\"%s\"",
            "_(\"fd passing is not supported by this connection\")"
          ],
          "line": 10678
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"fd passing is not supported by this connection\""
          ],
          "line": 10679
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DRV_SUPPORTS_FEATURE",
          "args": [
            "dom->conn->driver",
            "dom->conn",
            "VIR_DRV_FEATURE_FD_PASSING"
          ],
          "line": 10676
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "dom->conn->flags",
            "error"
          ],
          "line": 10674
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "dom",
            "-1"
          ],
          "line": 10672
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 10670
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "dom",
            "\"idx=%u, flags=0x%x\"",
            "idx",
            "flags"
          ],
          "line": 10668
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainOpenGraphicsFD(virDomainPtr dom,\n                        unsigned int idx,\n                        unsigned int flags)\n{\n    VIR_DOMAIN_DEBUG(dom, \"idx=%u, flags=0x%x\", idx, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(dom, -1);\n\n    virCheckReadOnlyGoto(dom->conn->flags, error);\n\n    if (!VIR_DRV_SUPPORTS_FEATURE(dom->conn->driver, dom->conn,\n                                  VIR_DRV_FEATURE_FD_PASSING)) {\n        virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED, \"%s\",\n                       _(\"fd passing is not supported by this connection\"));\n        goto error;\n    }\n\n    if (dom->conn->driver->domainOpenGraphicsFD) {\n        int ret;\n        ret = dom->conn->driver->domainOpenGraphicsFD(dom, idx, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(dom->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainOpenGraphics",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "10587-10639",
    "snippet": "int\nvirDomainOpenGraphics(virDomainPtr dom,\n                      unsigned int idx,\n                      int fd,\n                      unsigned int flags)\n{\n    struct stat sb;\n    VIR_DOMAIN_DEBUG(dom, \"idx=%u, fd=%d, flags=0x%x\",\n                     idx, fd, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(dom, -1);\n    virCheckNonNegativeArgGoto(fd, error);\n\n    if (fstat(fd, &sb) < 0) {\n        virReportSystemError(errno,\n                             _(\"Unable to access file descriptor %d\"), fd);\n        goto error;\n    }\n\n#ifndef WIN32\n    if (!S_ISSOCK(sb.st_mode)) {\n        virReportInvalidArg(fd,\n                            _(\"fd %d must be a socket\"),\n                            fd);\n        goto error;\n    }\n#endif /* !WIN32 */\n\n    virCheckReadOnlyGoto(dom->conn->flags, error);\n\n    if (!VIR_DRV_SUPPORTS_FEATURE(dom->conn->driver, dom->conn,\n                                  VIR_DRV_FEATURE_FD_PASSING)) {\n        virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED, \"%s\",\n                       _(\"fd passing is not supported by this connection\"));\n        goto error;\n    }\n\n    if (dom->conn->driver->domainOpenGraphics) {\n        int ret;\n        ret = dom->conn->driver->domainOpenGraphics(dom, idx, fd, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(dom->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "dom->conn"
          ],
          "line": 10637
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 10634
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dom->conn->driver->domainOpenGraphics",
          "args": [
            "dom",
            "idx",
            "fd",
            "flags"
          ],
          "line": 10628
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_ARGUMENT_UNSUPPORTED",
            "\"%s\"",
            "_(\"fd passing is not supported by this connection\")"
          ],
          "line": 10621
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"fd passing is not supported by this connection\""
          ],
          "line": 10622
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DRV_SUPPORTS_FEATURE",
          "args": [
            "dom->conn->driver",
            "dom->conn",
            "VIR_DRV_FEATURE_FD_PASSING"
          ],
          "line": 10619
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "dom->conn->flags",
            "error"
          ],
          "line": 10617
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportInvalidArg",
          "args": [
            "fd",
            "_(\"fd %d must be a socket\")",
            "fd"
          ],
          "line": 10610
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "S_ISSOCK",
          "args": [
            "sb.st_mode"
          ],
          "line": 10609
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"Unable to access file descriptor %d\")",
            "fd"
          ],
          "line": 10603
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fstat",
          "args": [
            "fd",
            "&sb"
          ],
          "line": 10602
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNegativeArgGoto",
          "args": [
            "fd",
            "error"
          ],
          "line": 10600
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "dom",
            "-1"
          ],
          "line": 10599
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 10597
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "dom",
            "\"idx=%u, fd=%d, flags=0x%x\"",
            "idx",
            "fd",
            "flags"
          ],
          "line": 10594
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainOpenGraphics(virDomainPtr dom,\n                      unsigned int idx,\n                      int fd,\n                      unsigned int flags)\n{\n    struct stat sb;\n    VIR_DOMAIN_DEBUG(dom, \"idx=%u, fd=%d, flags=0x%x\",\n                     idx, fd, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(dom, -1);\n    virCheckNonNegativeArgGoto(fd, error);\n\n    if (fstat(fd, &sb) < 0) {\n        virReportSystemError(errno,\n                             _(\"Unable to access file descriptor %d\"), fd);\n        goto error;\n    }\n\n#ifndef WIN32\n    if (!S_ISSOCK(sb.st_mode)) {\n        virReportInvalidArg(fd,\n                            _(\"fd %d must be a socket\"),\n                            fd);\n        goto error;\n    }\n#endif /* !WIN32 */\n\n    virCheckReadOnlyGoto(dom->conn->flags, error);\n\n    if (!VIR_DRV_SUPPORTS_FEATURE(dom->conn->driver, dom->conn,\n                                  VIR_DRV_FEATURE_FD_PASSING)) {\n        virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED, \"%s\",\n                       _(\"fd passing is not supported by this connection\"));\n        goto error;\n    }\n\n    if (dom->conn->driver->domainOpenGraphics) {\n        int ret;\n        ret = dom->conn->driver->domainOpenGraphics(dom, idx, fd, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(dom->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainBlockCommit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "10528-10560",
    "snippet": "int\nvirDomainBlockCommit(virDomainPtr dom, const char *disk,\n                     const char *base, const char *top,\n                     unsigned long bandwidth, unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(dom, \"disk=%s, base=%s, top=%s, bandwidth=%lu, flags=0x%x\",\n                     disk, NULLSTR(base), NULLSTR(top), bandwidth, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(dom, -1);\n    conn = dom->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n    virCheckNonNullArgGoto(disk, error);\n\n    if (conn->driver->domainBlockCommit) {\n        int ret;\n        ret = conn->driver->domainBlockCommit(dom, disk, base, top, bandwidth,\n                                              flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(dom->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "dom->conn"
          ],
          "line": 10558
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 10555
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainBlockCommit",
          "args": [
            "dom",
            "disk",
            "base",
            "top",
            "bandwidth",
            "flags"
          ],
          "line": 10548
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "disk",
            "error"
          ],
          "line": 10544
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "conn->flags",
            "error"
          ],
          "line": 10543
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "dom",
            "-1"
          ],
          "line": 10540
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 10538
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "dom",
            "\"disk=%s, base=%s, top=%s, bandwidth=%lu, flags=0x%x\"",
            "disk",
            "NULLSTR(base)",
            "NULLSTR(top)",
            "bandwidth",
            "flags"
          ],
          "line": 10535
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "top"
          ],
          "line": 10536
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "base"
          ],
          "line": 10536
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainBlockCommit(virDomainPtr dom, const char *disk,\n                     const char *base, const char *top,\n                     unsigned long bandwidth, unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(dom, \"disk=%s, base=%s, top=%s, bandwidth=%lu, flags=0x%x\",\n                     disk, NULLSTR(base), NULLSTR(top), bandwidth, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(dom, -1);\n    conn = dom->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n    virCheckNonNullArgGoto(disk, error);\n\n    if (conn->driver->domainBlockCommit) {\n        int ret;\n        ret = conn->driver->domainBlockCommit(dom, disk, base, top, bandwidth,\n                                              flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(dom->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainBlockCopy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "10382-10422",
    "snippet": "int\nvirDomainBlockCopy(virDomainPtr dom, const char *disk,\n                   const char *destxml,\n                   virTypedParameterPtr params,\n                   int nparams,\n                   unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(dom,\n                     \"disk=%s, destxml=%s, params=%p, nparams=%d, flags=0x%x\",\n                     disk, destxml, params, nparams, flags);\n    VIR_TYPED_PARAMS_DEBUG(params, nparams);\n\n    virResetLastError();\n\n    virCheckDomainReturn(dom, -1);\n    conn = dom->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n    virCheckNonNullArgGoto(disk, error);\n    virCheckNonNullArgGoto(destxml, error);\n    virCheckNonNegativeArgGoto(nparams, error);\n    if (nparams)\n        virCheckNonNullArgGoto(params, error);\n\n    if (conn->driver->domainBlockCopy) {\n        int ret;\n        ret = conn->driver->domainBlockCopy(dom, disk, destxml,\n                                            params, nparams, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(dom->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "dom->conn"
          ],
          "line": 10420
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 10417
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainBlockCopy",
          "args": [
            "dom",
            "disk",
            "destxml",
            "params",
            "nparams",
            "flags"
          ],
          "line": 10410
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "params",
            "error"
          ],
          "line": 10406
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNegativeArgGoto",
          "args": [
            "nparams",
            "error"
          ],
          "line": 10404
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "destxml",
            "error"
          ],
          "line": 10403
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "disk",
            "error"
          ],
          "line": 10402
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "conn->flags",
            "error"
          ],
          "line": 10401
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "dom",
            "-1"
          ],
          "line": 10398
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 10396
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_TYPED_PARAMS_DEBUG",
          "args": [
            "params",
            "nparams"
          ],
          "line": 10394
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "dom",
            "\"disk=%s, destxml=%s, params=%p, nparams=%d, flags=0x%x\"",
            "disk",
            "destxml",
            "params",
            "nparams",
            "flags"
          ],
          "line": 10391
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainBlockCopy(virDomainPtr dom, const char *disk,\n                   const char *destxml,\n                   virTypedParameterPtr params,\n                   int nparams,\n                   unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(dom,\n                     \"disk=%s, destxml=%s, params=%p, nparams=%d, flags=0x%x\",\n                     disk, destxml, params, nparams, flags);\n    VIR_TYPED_PARAMS_DEBUG(params, nparams);\n\n    virResetLastError();\n\n    virCheckDomainReturn(dom, -1);\n    conn = dom->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n    virCheckNonNullArgGoto(disk, error);\n    virCheckNonNullArgGoto(destxml, error);\n    virCheckNonNegativeArgGoto(nparams, error);\n    if (nparams)\n        virCheckNonNullArgGoto(params, error);\n\n    if (conn->driver->domainBlockCopy) {\n        int ret;\n        ret = conn->driver->domainBlockCopy(dom, disk, destxml,\n                                            params, nparams, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(dom->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainBlockRebase",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "10258-10301",
    "snippet": "int\nvirDomainBlockRebase(virDomainPtr dom, const char *disk,\n                     const char *base, unsigned long bandwidth,\n                     unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(dom, \"disk=%s, base=%s, bandwidth=%lu, flags=0x%x\",\n                     disk, NULLSTR(base), bandwidth, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(dom, -1);\n    conn = dom->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n    virCheckNonNullArgGoto(disk, error);\n\n    if (flags & VIR_DOMAIN_BLOCK_REBASE_COPY) {\n        virCheckNonNullArgGoto(base, error);\n    } else if (flags & (VIR_DOMAIN_BLOCK_REBASE_SHALLOW |\n                        VIR_DOMAIN_BLOCK_REBASE_REUSE_EXT |\n                        VIR_DOMAIN_BLOCK_REBASE_COPY_RAW |\n                        VIR_DOMAIN_BLOCK_REBASE_COPY_DEV)) {\n        virReportInvalidArg(flags, \"%s\",\n                            _(\"use of flags requires a copy job\"));\n        goto error;\n    }\n\n    if (conn->driver->domainBlockRebase) {\n        int ret;\n        ret = conn->driver->domainBlockRebase(dom, disk, base, bandwidth,\n                                              flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(dom->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "dom->conn"
          ],
          "line": 10299
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 10296
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainBlockRebase",
          "args": [
            "dom",
            "disk",
            "base",
            "bandwidth",
            "flags"
          ],
          "line": 10289
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportInvalidArg",
          "args": [
            "flags",
            "\"%s\"",
            "_(\"use of flags requires a copy job\")"
          ],
          "line": 10282
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"use of flags requires a copy job\""
          ],
          "line": 10283
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "base",
            "error"
          ],
          "line": 10277
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "disk",
            "error"
          ],
          "line": 10274
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "conn->flags",
            "error"
          ],
          "line": 10273
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "dom",
            "-1"
          ],
          "line": 10270
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 10268
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "dom",
            "\"disk=%s, base=%s, bandwidth=%lu, flags=0x%x\"",
            "disk",
            "NULLSTR(base)",
            "bandwidth",
            "flags"
          ],
          "line": 10265
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "base"
          ],
          "line": 10266
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainBlockRebase(virDomainPtr dom, const char *disk,\n                     const char *base, unsigned long bandwidth,\n                     unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(dom, \"disk=%s, base=%s, bandwidth=%lu, flags=0x%x\",\n                     disk, NULLSTR(base), bandwidth, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(dom, -1);\n    conn = dom->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n    virCheckNonNullArgGoto(disk, error);\n\n    if (flags & VIR_DOMAIN_BLOCK_REBASE_COPY) {\n        virCheckNonNullArgGoto(base, error);\n    } else if (flags & (VIR_DOMAIN_BLOCK_REBASE_SHALLOW |\n                        VIR_DOMAIN_BLOCK_REBASE_REUSE_EXT |\n                        VIR_DOMAIN_BLOCK_REBASE_COPY_RAW |\n                        VIR_DOMAIN_BLOCK_REBASE_COPY_DEV)) {\n        virReportInvalidArg(flags, \"%s\",\n                            _(\"use of flags requires a copy job\"));\n        goto error;\n    }\n\n    if (conn->driver->domainBlockRebase) {\n        int ret;\n        ret = conn->driver->domainBlockRebase(dom, disk, base, bandwidth,\n                                              flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(dom->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainBlockPull",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "10114-10144",
    "snippet": "int\nvirDomainBlockPull(virDomainPtr dom, const char *disk,\n                   unsigned long bandwidth, unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(dom, \"disk=%s, bandwidth=%lu, flags=0x%x\",\n                     disk, bandwidth, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(dom, -1);\n    conn = dom->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n    virCheckNonNullArgGoto(disk, error);\n\n    if (conn->driver->domainBlockPull) {\n        int ret;\n        ret = conn->driver->domainBlockPull(dom, disk, bandwidth, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(dom->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "dom->conn"
          ],
          "line": 10142
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 10139
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainBlockPull",
          "args": [
            "dom",
            "disk",
            "bandwidth",
            "flags"
          ],
          "line": 10133
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "disk",
            "error"
          ],
          "line": 10129
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "conn->flags",
            "error"
          ],
          "line": 10128
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "dom",
            "-1"
          ],
          "line": 10125
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 10123
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "dom",
            "\"disk=%s, bandwidth=%lu, flags=0x%x\"",
            "disk",
            "bandwidth",
            "flags"
          ],
          "line": 10120
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainBlockPull(virDomainPtr dom, const char *disk,\n                   unsigned long bandwidth, unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(dom, \"disk=%s, bandwidth=%lu, flags=0x%x\",\n                     disk, bandwidth, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(dom, -1);\n    conn = dom->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n    virCheckNonNullArgGoto(disk, error);\n\n    if (conn->driver->domainBlockPull) {\n        int ret;\n        ret = conn->driver->domainBlockPull(dom, disk, bandwidth, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(dom->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainBlockJobSetSpeed",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "10040-10070",
    "snippet": "int\nvirDomainBlockJobSetSpeed(virDomainPtr dom, const char *disk,\n                          unsigned long bandwidth, unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(dom, \"disk=%s, bandwidth=%lu, flags=0x%x\",\n                     disk, bandwidth, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(dom, -1);\n    conn = dom->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n    virCheckNonNullArgGoto(disk, error);\n\n    if (conn->driver->domainBlockJobSetSpeed) {\n        int ret;\n        ret = conn->driver->domainBlockJobSetSpeed(dom, disk, bandwidth, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(dom->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "dom->conn"
          ],
          "line": 10068
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 10065
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainBlockJobSetSpeed",
          "args": [
            "dom",
            "disk",
            "bandwidth",
            "flags"
          ],
          "line": 10059
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "disk",
            "error"
          ],
          "line": 10055
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "conn->flags",
            "error"
          ],
          "line": 10054
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "dom",
            "-1"
          ],
          "line": 10051
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 10049
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "dom",
            "\"disk=%s, bandwidth=%lu, flags=0x%x\"",
            "disk",
            "bandwidth",
            "flags"
          ],
          "line": 10046
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainBlockJobSetSpeed(virDomainPtr dom, const char *disk,\n                          unsigned long bandwidth, unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(dom, \"disk=%s, bandwidth=%lu, flags=0x%x\",\n                     disk, bandwidth, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(dom, -1);\n    conn = dom->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n    virCheckNonNullArgGoto(disk, error);\n\n    if (conn->driver->domainBlockJobSetSpeed) {\n        int ret;\n        ret = conn->driver->domainBlockJobSetSpeed(dom, disk, bandwidth, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(dom->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainGetBlockJobInfo",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "9977-10009",
    "snippet": "int\nvirDomainGetBlockJobInfo(virDomainPtr dom, const char *disk,\n                         virDomainBlockJobInfoPtr info, unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(dom, \"disk=%s, info=%p, flags=0x%x\", disk, info, flags);\n\n    virResetLastError();\n\n    if (info)\n        memset(info, 0, sizeof(*info));\n\n    virCheckDomainReturn(dom, -1);\n    conn = dom->conn;\n\n    virCheckNonNullArgGoto(disk, error);\n    virCheckNonNullArgGoto(info, error);\n\n    if (conn->driver->domainGetBlockJobInfo) {\n        int ret;\n        ret = conn->driver->domainGetBlockJobInfo(dom, disk, info, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(dom->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "dom->conn"
          ],
          "line": 10007
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 10004
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainGetBlockJobInfo",
          "args": [
            "dom",
            "disk",
            "info",
            "flags"
          ],
          "line": 9998
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "info",
            "error"
          ],
          "line": 9994
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "disk",
            "error"
          ],
          "line": 9993
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "dom",
            "-1"
          ],
          "line": 9990
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "info",
            "0",
            "sizeof(*info)"
          ],
          "line": 9988
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 9985
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "dom",
            "\"disk=%s, info=%p, flags=0x%x\"",
            "disk",
            "info",
            "flags"
          ],
          "line": 9983
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainGetBlockJobInfo(virDomainPtr dom, const char *disk,\n                         virDomainBlockJobInfoPtr info, unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(dom, \"disk=%s, info=%p, flags=0x%x\", disk, info, flags);\n\n    virResetLastError();\n\n    if (info)\n        memset(info, 0, sizeof(*info));\n\n    virCheckDomainReturn(dom, -1);\n    conn = dom->conn;\n\n    virCheckNonNullArgGoto(disk, error);\n    virCheckNonNullArgGoto(info, error);\n\n    if (conn->driver->domainGetBlockJobInfo) {\n        int ret;\n        ret = conn->driver->domainGetBlockJobInfo(dom, disk, info, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(dom->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainBlockJobAbort",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "9911-9940",
    "snippet": "int\nvirDomainBlockJobAbort(virDomainPtr dom, const char *disk,\n                       unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(dom, \"disk=%s, flags=0x%x\", disk, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(dom, -1);\n    conn = dom->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n    virCheckNonNullArgGoto(disk, error);\n\n    if (conn->driver->domainBlockJobAbort) {\n        int ret;\n        ret = conn->driver->domainBlockJobAbort(dom, disk, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(dom->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "dom->conn"
          ],
          "line": 9938
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 9935
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainBlockJobAbort",
          "args": [
            "dom",
            "disk",
            "flags"
          ],
          "line": 9929
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "disk",
            "error"
          ],
          "line": 9925
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "conn->flags",
            "error"
          ],
          "line": 9924
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "dom",
            "-1"
          ],
          "line": 9921
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 9919
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "dom",
            "\"disk=%s, flags=0x%x\"",
            "disk",
            "flags"
          ],
          "line": 9917
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainBlockJobAbort(virDomainPtr dom, const char *disk,\n                       unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(dom, \"disk=%s, flags=0x%x\", disk, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(dom, -1);\n    conn = dom->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n    virCheckNonNullArgGoto(disk, error);\n\n    if (conn->driver->domainBlockJobAbort) {\n        int ret;\n        ret = conn->driver->domainBlockJobAbort(dom, disk, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(dom->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainSetPerfEvents",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "9828-9865",
    "snippet": "int virDomainSetPerfEvents(virDomainPtr domain,\n                           virTypedParameterPtr params,\n                           int nparams,\n                           unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"params=%p, nparams=%d flags=0x%x\",\n                     params, nparams, flags);\n    VIR_TYPED_PARAMS_DEBUG(params, nparams);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n    virCheckNonNullArgGoto(params, error);\n    virCheckPositiveArgGoto(nparams, error);\n\n    if (virTypedParameterValidateSet(conn, params, nparams) < 0)\n        goto error;\n\n    if (conn->driver->domainSetPerfEvents) {\n        int ret;\n        ret = conn->driver->domainSetPerfEvents(domain, params,\n                                                nparams, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "domain->conn"
          ],
          "line": 9863
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 9860
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainSetPerfEvents",
          "args": [
            "domain",
            "params",
            "nparams",
            "flags"
          ],
          "line": 9853
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virTypedParameterValidateSet",
          "args": [
            "conn",
            "params",
            "nparams"
          ],
          "line": 9848
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParameterValidateSet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt.c",
          "lines": "1288-1325",
          "snippet": "int\nvirTypedParameterValidateSet(virConnectPtr conn,\n                             virTypedParameterPtr params,\n                             int nparams)\n{\n    bool string_okay;\n    size_t i;\n\n    string_okay = VIR_DRV_SUPPORTS_FEATURE(conn->driver,\n                                           conn,\n                                           VIR_DRV_FEATURE_TYPED_PARAM_STRING);\n    for (i = 0; i < nparams; i++) {\n        if (strnlen(params[i].field, VIR_TYPED_PARAM_FIELD_LENGTH) ==\n            VIR_TYPED_PARAM_FIELD_LENGTH) {\n            virReportInvalidArg(params,\n                                _(\"string parameter name '%.*s' too long\"),\n                                VIR_TYPED_PARAM_FIELD_LENGTH,\n                                params[i].field);\n            return -1;\n        }\n        if (params[i].type == VIR_TYPED_PARAM_STRING) {\n            if (string_okay) {\n                if (!params[i].value.s) {\n                    virReportInvalidArg(params,\n                                        _(\"NULL string parameter '%s'\"),\n                                        params[i].field);\n                    return -1;\n                }\n            } else {\n                virReportInvalidArg(params,\n                                    _(\"string parameter '%s' unsupported\"),\n                                    params[i].field);\n                return -1;\n            }\n        }\n    }\n    return 0;\n}",
          "includes": [
            "#include \"access/viraccessmanager.h\"",
            "# include \"bhyve/bhyve_driver.h\"",
            "# include \"hyperv/hyperv_driver.h\"",
            "# include \"esx/esx_driver.h\"",
            "# include \"vmware/vmware_driver.h\"",
            "# include \"openvz/openvz_driver.h\"",
            "# include \"remote/remote_driver.h\"",
            "# include \"test/test_driver.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"viruri.h\"",
            "#include \"virrandom.h\"",
            "#include \"virfile.h\"",
            "#include \"virevent.h\"",
            "#include \"vircommand.h\"",
            "#include \"rpc/virnettlscontext.h\"",
            "#include \"virconf.h\"",
            "#include \"configmake.h\"",
            "#include \"viralloc.h\"",
            "#include \"viruuid.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <curl/curl.h>",
            "#include <libxml/xpath.h>",
            "#include <libxml/parser.h>",
            "#include <gio/gnetworking.h>",
            "#include <time.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"access/viraccessmanager.h\"\n# include \"bhyve/bhyve_driver.h\"\n# include \"hyperv/hyperv_driver.h\"\n# include \"esx/esx_driver.h\"\n# include \"vmware/vmware_driver.h\"\n# include \"openvz/openvz_driver.h\"\n# include \"remote/remote_driver.h\"\n# include \"test/test_driver.h\"\n#include \"virtypedparam.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"viruri.h\"\n#include \"virrandom.h\"\n#include \"virfile.h\"\n#include \"virevent.h\"\n#include \"vircommand.h\"\n#include \"rpc/virnettlscontext.h\"\n#include \"virconf.h\"\n#include \"configmake.h\"\n#include \"viralloc.h\"\n#include \"viruuid.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <curl/curl.h>\n#include <libxml/xpath.h>\n#include <libxml/parser.h>\n#include <gio/gnetworking.h>\n#include <time.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nint\nvirTypedParameterValidateSet(virConnectPtr conn,\n                             virTypedParameterPtr params,\n                             int nparams)\n{\n    bool string_okay;\n    size_t i;\n\n    string_okay = VIR_DRV_SUPPORTS_FEATURE(conn->driver,\n                                           conn,\n                                           VIR_DRV_FEATURE_TYPED_PARAM_STRING);\n    for (i = 0; i < nparams; i++) {\n        if (strnlen(params[i].field, VIR_TYPED_PARAM_FIELD_LENGTH) ==\n            VIR_TYPED_PARAM_FIELD_LENGTH) {\n            virReportInvalidArg(params,\n                                _(\"string parameter name '%.*s' too long\"),\n                                VIR_TYPED_PARAM_FIELD_LENGTH,\n                                params[i].field);\n            return -1;\n        }\n        if (params[i].type == VIR_TYPED_PARAM_STRING) {\n            if (string_okay) {\n                if (!params[i].value.s) {\n                    virReportInvalidArg(params,\n                                        _(\"NULL string parameter '%s'\"),\n                                        params[i].field);\n                    return -1;\n                }\n            } else {\n                virReportInvalidArg(params,\n                                    _(\"string parameter '%s' unsupported\"),\n                                    params[i].field);\n                return -1;\n            }\n        }\n    }\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckPositiveArgGoto",
          "args": [
            "nparams",
            "error"
          ],
          "line": 9846
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "params",
            "error"
          ],
          "line": 9845
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "conn->flags",
            "error"
          ],
          "line": 9844
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "domain",
            "-1"
          ],
          "line": 9841
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 9839
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_TYPED_PARAMS_DEBUG",
          "args": [
            "params",
            "nparams"
          ],
          "line": 9837
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "domain",
            "\"params=%p, nparams=%d flags=0x%x\"",
            "params",
            "nparams",
            "flags"
          ],
          "line": 9835
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint virDomainSetPerfEvents(virDomainPtr domain,\n                           virTypedParameterPtr params,\n                           int nparams,\n                           unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"params=%p, nparams=%d flags=0x%x\",\n                     params, nparams, flags);\n    VIR_TYPED_PARAMS_DEBUG(params, nparams);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n    virCheckNonNullArgGoto(params, error);\n    virCheckPositiveArgGoto(nparams, error);\n\n    if (virTypedParameterValidateSet(conn, params, nparams) < 0)\n        goto error;\n\n    if (conn->driver->domainSetPerfEvents) {\n        int ret;\n        ret = conn->driver->domainSetPerfEvents(domain, params,\n                                                nparams, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainGetPerfEvents",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "9778-9809",
    "snippet": "int virDomainGetPerfEvents(virDomainPtr domain,\n                           virTypedParameterPtr *params,\n                           int *nparams,\n                           unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"params=%p, nparams=%p flags=0x%x\",\n                     params, nparams, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    virCheckNonNullArgGoto(params, error);\n    virCheckNonNullArgGoto(nparams, error);\n\n    conn = domain->conn;\n\n    if (conn->driver->domainGetPerfEvents) {\n        int ret;\n        ret = conn->driver->domainGetPerfEvents(domain, params,\n                                                nparams, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "domain->conn"
          ],
          "line": 9807
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 9804
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainGetPerfEvents",
          "args": [
            "domain",
            "params",
            "nparams",
            "flags"
          ],
          "line": 9798
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "nparams",
            "error"
          ],
          "line": 9792
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "params",
            "error"
          ],
          "line": 9791
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "domain",
            "-1"
          ],
          "line": 9790
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 9788
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "domain",
            "\"params=%p, nparams=%p flags=0x%x\"",
            "params",
            "nparams",
            "flags"
          ],
          "line": 9785
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint virDomainGetPerfEvents(virDomainPtr domain,\n                           virTypedParameterPtr *params,\n                           int *nparams,\n                           unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"params=%p, nparams=%p flags=0x%x\",\n                     params, nparams, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    virCheckNonNullArgGoto(params, error);\n    virCheckNonNullArgGoto(nparams, error);\n\n    conn = domain->conn;\n\n    if (conn->driver->domainGetPerfEvents) {\n        int ret;\n        ret = conn->driver->domainGetPerfEvents(domain, params,\n                                                nparams, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainOpenChannel",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "9721-9760",
    "snippet": "int\nvirDomainOpenChannel(virDomainPtr dom,\n                     const char *name,\n                     virStreamPtr st,\n                     unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(dom, \"name=%s, st=%p, flags=0x%x\",\n                     NULLSTR(name), st, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(dom, -1);\n    conn = dom->conn;\n\n    virCheckStreamGoto(st, error);\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn != st->conn) {\n        virReportInvalidArg(st,\n                            _(\"stream must match connection of domain '%s'\"),\n                            dom->name);\n        goto error;\n    }\n\n    if (conn->driver->domainOpenChannel) {\n        int ret;\n        ret = conn->driver->domainOpenChannel(dom, name, st, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "conn"
          ],
          "line": 9758
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 9755
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainOpenChannel",
          "args": [
            "dom",
            "name",
            "st",
            "flags"
          ],
          "line": 9749
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportInvalidArg",
          "args": [
            "st",
            "_(\"stream must match connection of domain '%s'\")",
            "dom->name"
          ],
          "line": 9741
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"stream must match connection of domain '%s'\""
          ],
          "line": 9742
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "conn->flags",
            "error"
          ],
          "line": 9738
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckStreamGoto",
          "args": [
            "st",
            "error"
          ],
          "line": 9737
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "dom",
            "-1"
          ],
          "line": 9734
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 9732
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "dom",
            "\"name=%s, st=%p, flags=0x%x\"",
            "NULLSTR(name)",
            "st",
            "flags"
          ],
          "line": 9729
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "name"
          ],
          "line": 9730
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainOpenChannel(virDomainPtr dom,\n                     const char *name,\n                     virStreamPtr st,\n                     unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(dom, \"name=%s, st=%p, flags=0x%x\",\n                     NULLSTR(name), st, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(dom, -1);\n    conn = dom->conn;\n\n    virCheckStreamGoto(st, error);\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn != st->conn) {\n        virReportInvalidArg(st,\n                            _(\"stream must match connection of domain '%s'\"),\n                            dom->name);\n        goto error;\n    }\n\n    if (conn->driver->domainOpenChannel) {\n        int ret;\n        ret = conn->driver->domainOpenChannel(dom, name, st, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainOpenConsole",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "9657-9696",
    "snippet": "int\nvirDomainOpenConsole(virDomainPtr dom,\n                     const char *dev_name,\n                     virStreamPtr st,\n                     unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(dom, \"dev_name=%s, st=%p, flags=0x%x\",\n                     NULLSTR(dev_name), st, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(dom, -1);\n    conn = dom->conn;\n\n    virCheckStreamGoto(st, error);\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn != st->conn) {\n        virReportInvalidArg(st,\n                            _(\"stream must match connection of domain '%s'\"),\n                            dom->name);\n        goto error;\n    }\n\n    if (conn->driver->domainOpenConsole) {\n        int ret;\n        ret = conn->driver->domainOpenConsole(dom, dev_name, st, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "conn"
          ],
          "line": 9694
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 9691
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainOpenConsole",
          "args": [
            "dom",
            "dev_name",
            "st",
            "flags"
          ],
          "line": 9685
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportInvalidArg",
          "args": [
            "st",
            "_(\"stream must match connection of domain '%s'\")",
            "dom->name"
          ],
          "line": 9677
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"stream must match connection of domain '%s'\""
          ],
          "line": 9678
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "conn->flags",
            "error"
          ],
          "line": 9674
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckStreamGoto",
          "args": [
            "st",
            "error"
          ],
          "line": 9673
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "dom",
            "-1"
          ],
          "line": 9670
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 9668
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "dom",
            "\"dev_name=%s, st=%p, flags=0x%x\"",
            "NULLSTR(dev_name)",
            "st",
            "flags"
          ],
          "line": 9665
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "dev_name"
          ],
          "line": 9666
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainOpenConsole(virDomainPtr dom,\n                     const char *dev_name,\n                     virStreamPtr st,\n                     unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(dom, \"dev_name=%s, st=%p, flags=0x%x\",\n                     NULLSTR(dev_name), st, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(dom, -1);\n    conn = dom->conn;\n\n    virCheckStreamGoto(st, error);\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn != st->conn) {\n        virReportInvalidArg(st,\n                            _(\"stream must match connection of domain '%s'\"),\n                            dom->name);\n        goto error;\n    }\n\n    if (conn->driver->domainOpenConsole) {\n        int ret;\n        ret = conn->driver->domainOpenConsole(dom, dev_name, st, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainManagedSaveDefineXML",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "9592-9624",
    "snippet": "int\nvirDomainManagedSaveDefineXML(virDomainPtr domain, const char *dxml,\n                              unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"flags=0x%x\", flags);\n\n    virResetLastError();\n\n    VIR_EXCLUSIVE_FLAGS_GOTO(VIR_DOMAIN_SAVE_RUNNING,\n                             VIR_DOMAIN_SAVE_PAUSED,\n                             error);\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->driver->domainManagedSaveDefineXML) {\n        int ret;\n        ret = conn->driver->domainManagedSaveDefineXML(domain, dxml, flags);\n\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "domain->conn"
          ],
          "line": 9622
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 9619
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainManagedSaveDefineXML",
          "args": [
            "domain",
            "dxml",
            "flags"
          ],
          "line": 9612
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "conn->flags",
            "error"
          ],
          "line": 9608
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "domain",
            "-1"
          ],
          "line": 9606
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_EXCLUSIVE_FLAGS_GOTO",
          "args": [
            "VIR_DOMAIN_SAVE_RUNNING",
            "VIR_DOMAIN_SAVE_PAUSED",
            "error"
          ],
          "line": 9602
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 9600
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "domain",
            "\"flags=0x%x\"",
            "flags"
          ],
          "line": 9598
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainManagedSaveDefineXML(virDomainPtr domain, const char *dxml,\n                              unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"flags=0x%x\", flags);\n\n    virResetLastError();\n\n    VIR_EXCLUSIVE_FLAGS_GOTO(VIR_DOMAIN_SAVE_RUNNING,\n                             VIR_DOMAIN_SAVE_PAUSED,\n                             error);\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->driver->domainManagedSaveDefineXML) {\n        int ret;\n        ret = conn->driver->domainManagedSaveDefineXML(domain, dxml, flags);\n\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainManagedSaveGetXMLDesc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "9534-9566",
    "snippet": "char *\nvirDomainManagedSaveGetXMLDesc(virDomainPtr domain, unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"flags=0x%x\", flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, NULL);\n    conn = domain->conn;\n\n    if ((conn->flags & VIR_CONNECT_RO) &&\n        (flags & VIR_DOMAIN_SAVE_IMAGE_XML_SECURE)) {\n        virReportError(VIR_ERR_OPERATION_DENIED, \"%s\",\n                       _(\"virDomainManagedSaveGetXMLDesc with secure flag\"));\n        goto error;\n    }\n\n    if (conn->driver->domainManagedSaveGetXMLDesc) {\n        char *ret;\n        ret = conn->driver->domainManagedSaveGetXMLDesc(domain, flags);\n        if (!ret)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return NULL;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "domain->conn"
          ],
          "line": 9564
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 9561
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainManagedSaveGetXMLDesc",
          "args": [
            "domain",
            "flags"
          ],
          "line": 9555
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_DENIED",
            "\"%s\"",
            "_(\"virDomainManagedSaveGetXMLDesc with secure flag\")"
          ],
          "line": 9548
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"virDomainManagedSaveGetXMLDesc with secure flag\""
          ],
          "line": 9549
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "domain",
            "NULL"
          ],
          "line": 9543
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 9541
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "domain",
            "\"flags=0x%x\"",
            "flags"
          ],
          "line": 9539
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nchar *\nvirDomainManagedSaveGetXMLDesc(virDomainPtr domain, unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"flags=0x%x\", flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, NULL);\n    conn = domain->conn;\n\n    if ((conn->flags & VIR_CONNECT_RO) &&\n        (flags & VIR_DOMAIN_SAVE_IMAGE_XML_SECURE)) {\n        virReportError(VIR_ERR_OPERATION_DENIED, \"%s\",\n                       _(\"virDomainManagedSaveGetXMLDesc with secure flag\"));\n        goto error;\n    }\n\n    if (conn->driver->domainManagedSaveGetXMLDesc) {\n        char *ret;\n        ret = conn->driver->domainManagedSaveGetXMLDesc(domain, flags);\n        if (!ret)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return NULL;\n}"
  },
  {
    "function_name": "virDomainManagedSaveRemove",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "9488-9516",
    "snippet": "int\nvirDomainManagedSaveRemove(virDomainPtr dom, unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(dom, \"flags=0x%x\", flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(dom, -1);\n    conn = dom->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->driver->domainManagedSaveRemove) {\n        int ret;\n\n        ret = conn->driver->domainManagedSaveRemove(dom, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "conn"
          ],
          "line": 9514
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 9511
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainManagedSaveRemove",
          "args": [
            "dom",
            "flags"
          ],
          "line": 9505
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "conn->flags",
            "error"
          ],
          "line": 9500
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "dom",
            "-1"
          ],
          "line": 9497
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 9495
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "dom",
            "\"flags=0x%x\"",
            "flags"
          ],
          "line": 9493
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainManagedSaveRemove(virDomainPtr dom, unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(dom, \"flags=0x%x\", flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(dom, -1);\n    conn = dom->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->driver->domainManagedSaveRemove) {\n        int ret;\n\n        ret = conn->driver->domainManagedSaveRemove(dom, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainHasManagedSaveImage",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "9450-9476",
    "snippet": "int\nvirDomainHasManagedSaveImage(virDomainPtr dom, unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(dom, \"flags=0x%x\", flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(dom, -1);\n    conn = dom->conn;\n\n    if (conn->driver->domainHasManagedSaveImage) {\n        int ret;\n\n        ret = conn->driver->domainHasManagedSaveImage(dom, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "conn"
          ],
          "line": 9474
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 9471
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainHasManagedSaveImage",
          "args": [
            "dom",
            "flags"
          ],
          "line": 9465
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "dom",
            "-1"
          ],
          "line": 9459
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 9457
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "dom",
            "\"flags=0x%x\"",
            "flags"
          ],
          "line": 9455
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainHasManagedSaveImage(virDomainPtr dom, unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(dom, \"flags=0x%x\", flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(dom, -1);\n    conn = dom->conn;\n\n    if (conn->driver->domainHasManagedSaveImage) {\n        int ret;\n\n        ret = conn->driver->domainHasManagedSaveImage(dom, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainManagedSave",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "9403-9435",
    "snippet": "int\nvirDomainManagedSave(virDomainPtr dom, unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(dom, \"flags=0x%x\", flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(dom, -1);\n    conn = dom->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    VIR_EXCLUSIVE_FLAGS_GOTO(VIR_DOMAIN_SAVE_RUNNING,\n                             VIR_DOMAIN_SAVE_PAUSED,\n                             error);\n\n    if (conn->driver->domainManagedSave) {\n        int ret;\n\n        ret = conn->driver->domainManagedSave(dom, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "conn"
          ],
          "line": 9433
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 9430
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainManagedSave",
          "args": [
            "dom",
            "flags"
          ],
          "line": 9424
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_EXCLUSIVE_FLAGS_GOTO",
          "args": [
            "VIR_DOMAIN_SAVE_RUNNING",
            "VIR_DOMAIN_SAVE_PAUSED",
            "error"
          ],
          "line": 9417
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "conn->flags",
            "error"
          ],
          "line": 9415
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "dom",
            "-1"
          ],
          "line": 9412
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 9410
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "dom",
            "\"flags=0x%x\"",
            "flags"
          ],
          "line": 9408
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainManagedSave(virDomainPtr dom, unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(dom, \"flags=0x%x\", flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(dom, -1);\n    conn = dom->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    VIR_EXCLUSIVE_FLAGS_GOTO(VIR_DOMAIN_SAVE_RUNNING,\n                             VIR_DOMAIN_SAVE_PAUSED,\n                             error);\n\n    if (conn->driver->domainManagedSave) {\n        int ret;\n\n        ret = conn->driver->domainManagedSave(dom, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return -1;\n}"
  },
  {
    "function_name": "virConnectDomainEventDeregisterAny",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "9348-9371",
    "snippet": "int\nvirConnectDomainEventDeregisterAny(virConnectPtr conn,\n                                   int callbackID)\n{\n    VIR_DEBUG(\"conn=%p, callbackID=%d\", conn, callbackID);\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, -1);\n    virCheckNonNegativeArgGoto(callbackID, error);\n\n    if (conn->driver && conn->driver->connectDomainEventDeregisterAny) {\n        int ret;\n        ret = conn->driver->connectDomainEventDeregisterAny(conn, callbackID);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n error:\n    virDispatchError(conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "conn"
          ],
          "line": 9369
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 9367
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->connectDomainEventDeregisterAny",
          "args": [
            "conn",
            "callbackID"
          ],
          "line": 9361
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNegativeArgGoto",
          "args": [
            "callbackID",
            "error"
          ],
          "line": 9357
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckConnectReturn",
          "args": [
            "conn",
            "-1"
          ],
          "line": 9356
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 9354
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"conn=%p, callbackID=%d\"",
            "conn",
            "callbackID"
          ],
          "line": 9352
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirConnectDomainEventDeregisterAny(virConnectPtr conn,\n                                   int callbackID)\n{\n    VIR_DEBUG(\"conn=%p, callbackID=%d\", conn, callbackID);\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, -1);\n    virCheckNonNegativeArgGoto(callbackID, error);\n\n    if (conn->driver && conn->driver->connectDomainEventDeregisterAny) {\n        int ret;\n        ret = conn->driver->connectDomainEventDeregisterAny(conn, callbackID);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n error:\n    virDispatchError(conn);\n    return -1;\n}"
  },
  {
    "function_name": "virConnectDomainEventRegisterAny",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "9290-9334",
    "snippet": "int\nvirConnectDomainEventRegisterAny(virConnectPtr conn,\n                                 virDomainPtr dom,\n                                 int eventID,\n                                 virConnectDomainEventGenericCallback cb,\n                                 void *opaque,\n                                 virFreeCallback freecb)\n{\n    VIR_DOMAIN_DEBUG(dom, \"conn=%p, eventID=%d, cb=%p, opaque=%p, freecb=%p\",\n                     conn, eventID, cb, opaque, freecb);\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, -1);\n    if (dom) {\n        virCheckDomainGoto(dom, error);\n        if (dom->conn != conn) {\n            virReportInvalidArg(dom,\n                                _(\"domain '%s' must match connection\"),\n                                dom->name);\n            goto error;\n        }\n    }\n    virCheckNonNullArgGoto(cb, error);\n    virCheckNonNegativeArgGoto(eventID, error);\n    if (eventID >= VIR_DOMAIN_EVENT_ID_LAST) {\n        virReportInvalidArg(eventID,\n                            _(\"eventID must be less than %d\"),\n                            VIR_DOMAIN_EVENT_ID_LAST);\n        goto error;\n    }\n\n    if (conn->driver && conn->driver->connectDomainEventRegisterAny) {\n        int ret;\n        ret = conn->driver->connectDomainEventRegisterAny(conn, dom, eventID, cb, opaque, freecb);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n error:\n    virDispatchError(conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "conn"
          ],
          "line": 9332
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 9330
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->connectDomainEventRegisterAny",
          "args": [
            "conn",
            "dom",
            "eventID",
            "cb",
            "opaque",
            "freecb"
          ],
          "line": 9324
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportInvalidArg",
          "args": [
            "eventID",
            "_(\"eventID must be less than %d\")",
            "VIR_DOMAIN_EVENT_ID_LAST"
          ],
          "line": 9316
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"eventID must be less than %d\""
          ],
          "line": 9317
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckNonNegativeArgGoto",
          "args": [
            "eventID",
            "error"
          ],
          "line": 9314
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "cb",
            "error"
          ],
          "line": 9313
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportInvalidArg",
          "args": [
            "dom",
            "_(\"domain '%s' must match connection\")",
            "dom->name"
          ],
          "line": 9307
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainGoto",
          "args": [
            "dom",
            "error"
          ],
          "line": 9305
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckConnectReturn",
          "args": [
            "conn",
            "-1"
          ],
          "line": 9303
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 9301
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "dom",
            "\"conn=%p, eventID=%d, cb=%p, opaque=%p, freecb=%p\"",
            "conn",
            "eventID",
            "cb",
            "opaque",
            "freecb"
          ],
          "line": 9298
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirConnectDomainEventRegisterAny(virConnectPtr conn,\n                                 virDomainPtr dom,\n                                 int eventID,\n                                 virConnectDomainEventGenericCallback cb,\n                                 void *opaque,\n                                 virFreeCallback freecb)\n{\n    VIR_DOMAIN_DEBUG(dom, \"conn=%p, eventID=%d, cb=%p, opaque=%p, freecb=%p\",\n                     conn, eventID, cb, opaque, freecb);\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, -1);\n    if (dom) {\n        virCheckDomainGoto(dom, error);\n        if (dom->conn != conn) {\n            virReportInvalidArg(dom,\n                                _(\"domain '%s' must match connection\"),\n                                dom->name);\n            goto error;\n        }\n    }\n    virCheckNonNullArgGoto(cb, error);\n    virCheckNonNegativeArgGoto(eventID, error);\n    if (eventID >= VIR_DOMAIN_EVENT_ID_LAST) {\n        virReportInvalidArg(eventID,\n                            _(\"eventID must be less than %d\"),\n                            VIR_DOMAIN_EVENT_ID_LAST);\n        goto error;\n    }\n\n    if (conn->driver && conn->driver->connectDomainEventRegisterAny) {\n        int ret;\n        ret = conn->driver->connectDomainEventRegisterAny(conn, dom, eventID, cb, opaque, freecb);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n error:\n    virDispatchError(conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainMigrateStartPostCopy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "9227-9252",
    "snippet": "int\nvirDomainMigrateStartPostCopy(virDomainPtr domain,\n                              unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->driver->domainMigrateStartPostCopy) {\n        if (conn->driver->domainMigrateStartPostCopy(domain, flags) < 0)\n            goto error;\n        return 0;\n    }\n\n    virReportUnsupportedError();\n error:\n    virDispatchError(conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "conn"
          ],
          "line": 9250
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 9248
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainMigrateStartPostCopy",
          "args": [
            "domain",
            "flags"
          ],
          "line": 9243
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "conn->flags",
            "error"
          ],
          "line": 9240
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "domain",
            "-1"
          ],
          "line": 9237
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 9235
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "domain"
          ],
          "line": 9233
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainMigrateStartPostCopy(virDomainPtr domain,\n                              unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->driver->domainMigrateStartPostCopy) {\n        if (conn->driver->domainMigrateStartPostCopy(domain, flags) < 0)\n            goto error;\n        return 0;\n    }\n\n    virReportUnsupportedError();\n error:\n    virDispatchError(conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainMigrateGetMaxSpeed",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "9134-9161",
    "snippet": "int\nvirDomainMigrateGetMaxSpeed(virDomainPtr domain,\n                            unsigned long *bandwidth,\n                            unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"bandwidth = %p, flags=0x%x\", bandwidth, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    virCheckNonNullArgGoto(bandwidth, error);\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->driver->domainMigrateGetMaxSpeed) {\n        if (conn->driver->domainMigrateGetMaxSpeed(domain, bandwidth, flags) < 0)\n            goto error;\n        return 0;\n    }\n\n    virReportUnsupportedError();\n error:\n    virDispatchError(conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "conn"
          ],
          "line": 9159
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 9157
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainMigrateGetMaxSpeed",
          "args": [
            "domain",
            "bandwidth",
            "flags"
          ],
          "line": 9152
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "conn->flags",
            "error"
          ],
          "line": 9149
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "bandwidth",
            "error"
          ],
          "line": 9148
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "domain",
            "-1"
          ],
          "line": 9145
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 9143
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "domain",
            "\"bandwidth = %p, flags=0x%x\"",
            "bandwidth",
            "flags"
          ],
          "line": 9141
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainMigrateGetMaxSpeed(virDomainPtr domain,\n                            unsigned long *bandwidth,\n                            unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"bandwidth = %p, flags=0x%x\", bandwidth, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    virCheckNonNullArgGoto(bandwidth, error);\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->driver->domainMigrateGetMaxSpeed) {\n        if (conn->driver->domainMigrateGetMaxSpeed(domain, bandwidth, flags) < 0)\n            goto error;\n        return 0;\n    }\n\n    virReportUnsupportedError();\n error:\n    virDispatchError(conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainMigrateSetMaxSpeed",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "9091-9117",
    "snippet": "int\nvirDomainMigrateSetMaxSpeed(virDomainPtr domain,\n                            unsigned long bandwidth,\n                            unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"bandwidth=%lu, flags=0x%x\", bandwidth, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->driver->domainMigrateSetMaxSpeed) {\n        if (conn->driver->domainMigrateSetMaxSpeed(domain, bandwidth, flags) < 0)\n            goto error;\n        return 0;\n    }\n\n    virReportUnsupportedError();\n error:\n    virDispatchError(conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "conn"
          ],
          "line": 9115
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 9113
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainMigrateSetMaxSpeed",
          "args": [
            "domain",
            "bandwidth",
            "flags"
          ],
          "line": 9108
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "conn->flags",
            "error"
          ],
          "line": 9105
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "domain",
            "-1"
          ],
          "line": 9102
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 9100
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "domain",
            "\"bandwidth=%lu, flags=0x%x\"",
            "bandwidth",
            "flags"
          ],
          "line": 9098
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainMigrateSetMaxSpeed(virDomainPtr domain,\n                            unsigned long bandwidth,\n                            unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"bandwidth=%lu, flags=0x%x\", bandwidth, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->driver->domainMigrateSetMaxSpeed) {\n        if (conn->driver->domainMigrateSetMaxSpeed(domain, bandwidth, flags) < 0)\n            goto error;\n        return 0;\n    }\n\n    virReportUnsupportedError();\n error:\n    virDispatchError(conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainMigrateSetCompressionCache",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "9047-9074",
    "snippet": "int\nvirDomainMigrateSetCompressionCache(virDomainPtr domain,\n                                    unsigned long long cacheSize,\n                                    unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"cacheSize=%llu, flags=0x%x\", cacheSize, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->driver->domainMigrateSetCompressionCache) {\n        if (conn->driver->domainMigrateSetCompressionCache(domain, cacheSize,\n                                                           flags) < 0)\n            goto error;\n        return 0;\n    }\n\n    virReportUnsupportedError();\n error:\n    virDispatchError(conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "conn"
          ],
          "line": 9072
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 9070
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainMigrateSetCompressionCache",
          "args": [
            "domain",
            "cacheSize",
            "flags"
          ],
          "line": 9064
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "conn->flags",
            "error"
          ],
          "line": 9061
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "domain",
            "-1"
          ],
          "line": 9058
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 9056
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "domain",
            "\"cacheSize=%llu, flags=0x%x\"",
            "cacheSize",
            "flags"
          ],
          "line": 9054
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainMigrateSetCompressionCache(virDomainPtr domain,\n                                    unsigned long long cacheSize,\n                                    unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"cacheSize=%llu, flags=0x%x\", cacheSize, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->driver->domainMigrateSetCompressionCache) {\n        if (conn->driver->domainMigrateSetCompressionCache(domain, cacheSize,\n                                                           flags) < 0)\n            goto error;\n        return 0;\n    }\n\n    virReportUnsupportedError();\n error:\n    virDispatchError(conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainMigrateGetCompressionCache",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "9003-9030",
    "snippet": "int\nvirDomainMigrateGetCompressionCache(virDomainPtr domain,\n                                    unsigned long long *cacheSize,\n                                    unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"cacheSize=%p, flags=0x%x\", cacheSize, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    virCheckNonNullArgGoto(cacheSize, error);\n\n    if (conn->driver->domainMigrateGetCompressionCache) {\n        if (conn->driver->domainMigrateGetCompressionCache(domain, cacheSize,\n                                                           flags) < 0)\n            goto error;\n        return 0;\n    }\n\n    virReportUnsupportedError();\n error:\n    virDispatchError(conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "conn"
          ],
          "line": 9028
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 9026
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainMigrateGetCompressionCache",
          "args": [
            "domain",
            "cacheSize",
            "flags"
          ],
          "line": 9020
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "cacheSize",
            "error"
          ],
          "line": 9017
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "domain",
            "-1"
          ],
          "line": 9014
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 9012
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "domain",
            "\"cacheSize=%p, flags=0x%x\"",
            "cacheSize",
            "flags"
          ],
          "line": 9010
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainMigrateGetCompressionCache(virDomainPtr domain,\n                                    unsigned long long *cacheSize,\n                                    unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"cacheSize=%p, flags=0x%x\", cacheSize, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    virCheckNonNullArgGoto(cacheSize, error);\n\n    if (conn->driver->domainMigrateGetCompressionCache) {\n        if (conn->driver->domainMigrateGetCompressionCache(domain, cacheSize,\n                                                           flags) < 0)\n            goto error;\n        return 0;\n    }\n\n    virReportUnsupportedError();\n error:\n    virDispatchError(conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainMigrateGetMaxDowntime",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "8963-8989",
    "snippet": "int\nvirDomainMigrateGetMaxDowntime(virDomainPtr domain,\n                               unsigned long long *downtime,\n                               unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"downtime = %p, flags=0x%x\", downtime, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    virCheckNonNullArgGoto(downtime, error);\n\n    if (conn->driver->domainMigrateGetMaxDowntime) {\n        if (conn->driver->domainMigrateGetMaxDowntime(domain, downtime, flags) < 0)\n            goto error;\n        return 0;\n    }\n\n    virReportUnsupportedError();\n error:\n    virDispatchError(conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "conn"
          ],
          "line": 8987
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 8985
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainMigrateGetMaxDowntime",
          "args": [
            "domain",
            "downtime",
            "flags"
          ],
          "line": 8980
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "downtime",
            "error"
          ],
          "line": 8977
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "domain",
            "-1"
          ],
          "line": 8974
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 8972
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "domain",
            "\"downtime = %p, flags=0x%x\"",
            "downtime",
            "flags"
          ],
          "line": 8970
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainMigrateGetMaxDowntime(virDomainPtr domain,\n                               unsigned long long *downtime,\n                               unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"downtime = %p, flags=0x%x\", downtime, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    virCheckNonNullArgGoto(downtime, error);\n\n    if (conn->driver->domainMigrateGetMaxDowntime) {\n        if (conn->driver->domainMigrateGetMaxDowntime(domain, downtime, flags) < 0)\n            goto error;\n        return 0;\n    }\n\n    virReportUnsupportedError();\n error:\n    virDispatchError(conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainMigrateSetMaxDowntime",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "8922-8948",
    "snippet": "int\nvirDomainMigrateSetMaxDowntime(virDomainPtr domain,\n                               unsigned long long downtime,\n                               unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"downtime=%llu, flags=0x%x\", downtime, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->driver->domainMigrateSetMaxDowntime) {\n        if (conn->driver->domainMigrateSetMaxDowntime(domain, downtime, flags) < 0)\n            goto error;\n        return 0;\n    }\n\n    virReportUnsupportedError();\n error:\n    virDispatchError(conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "conn"
          ],
          "line": 8946
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 8944
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainMigrateSetMaxDowntime",
          "args": [
            "domain",
            "downtime",
            "flags"
          ],
          "line": 8939
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "conn->flags",
            "error"
          ],
          "line": 8936
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "domain",
            "-1"
          ],
          "line": 8933
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 8931
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "domain",
            "\"downtime=%llu, flags=0x%x\"",
            "downtime",
            "flags"
          ],
          "line": 8929
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainMigrateSetMaxDowntime(virDomainPtr domain,\n                               unsigned long long downtime,\n                               unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"downtime=%llu, flags=0x%x\", downtime, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->driver->domainMigrateSetMaxDowntime) {\n        if (conn->driver->domainMigrateSetMaxDowntime(domain, downtime, flags) < 0)\n            goto error;\n        return 0;\n    }\n\n    virReportUnsupportedError();\n error:\n    virDispatchError(conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainAbortJob",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "8880-8907",
    "snippet": "int\nvirDomainAbortJob(virDomainPtr domain)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->driver->domainAbortJob) {\n        int ret;\n        ret = conn->driver->domainAbortJob(domain);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "conn"
          ],
          "line": 8905
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 8902
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainAbortJob",
          "args": [
            "domain"
          ],
          "line": 8896
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "conn->flags",
            "error"
          ],
          "line": 8892
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "domain",
            "-1"
          ],
          "line": 8889
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 8887
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "domain"
          ],
          "line": 8885
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainAbortJob(virDomainPtr domain)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->driver->domainAbortJob) {\n        int ret;\n        ret = conn->driver->domainAbortJob(domain);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainGetJobStats",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "8828-8866",
    "snippet": "int\nvirDomainGetJobStats(virDomainPtr domain,\n                     int *type,\n                     virTypedParameterPtr *params,\n                     int *nparams,\n                     unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"type=%p, params=%p, nparams=%p, flags=0x%x\",\n                     type, params, nparams, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    virCheckNonNullArgGoto(type, error);\n    virCheckNonNullArgGoto(params, error);\n    virCheckNonNullArgGoto(nparams, error);\n    VIR_REQUIRE_FLAG_GOTO(VIR_DOMAIN_JOB_STATS_KEEP_COMPLETED,\n                          VIR_DOMAIN_JOB_STATS_COMPLETED,\n                          error);\n\n    conn = domain->conn;\n\n    if (conn->driver->domainGetJobStats) {\n        int ret;\n        ret = conn->driver->domainGetJobStats(domain, type, params,\n                                              nparams, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "domain->conn"
          ],
          "line": 8864
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 8861
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainGetJobStats",
          "args": [
            "domain",
            "type",
            "params",
            "nparams",
            "flags"
          ],
          "line": 8854
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_REQUIRE_FLAG_GOTO",
          "args": [
            "VIR_DOMAIN_JOB_STATS_KEEP_COMPLETED",
            "VIR_DOMAIN_JOB_STATS_COMPLETED",
            "error"
          ],
          "line": 8846
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "nparams",
            "error"
          ],
          "line": 8845
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "params",
            "error"
          ],
          "line": 8844
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "type",
            "error"
          ],
          "line": 8843
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "domain",
            "-1"
          ],
          "line": 8842
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 8840
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "domain",
            "\"type=%p, params=%p, nparams=%p, flags=0x%x\"",
            "type",
            "params",
            "nparams",
            "flags"
          ],
          "line": 8837
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainGetJobStats(virDomainPtr domain,\n                     int *type,\n                     virTypedParameterPtr *params,\n                     int *nparams,\n                     unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"type=%p, params=%p, nparams=%p, flags=0x%x\",\n                     type, params, nparams, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    virCheckNonNullArgGoto(type, error);\n    virCheckNonNullArgGoto(params, error);\n    virCheckNonNullArgGoto(nparams, error);\n    VIR_REQUIRE_FLAG_GOTO(VIR_DOMAIN_JOB_STATS_KEEP_COMPLETED,\n                          VIR_DOMAIN_JOB_STATS_COMPLETED,\n                          error);\n\n    conn = domain->conn;\n\n    if (conn->driver->domainGetJobStats) {\n        int ret;\n        ret = conn->driver->domainGetJobStats(domain, type, params,\n                                              nparams, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainGetJobInfo",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "8764-8794",
    "snippet": "int\nvirDomainGetJobInfo(virDomainPtr domain, virDomainJobInfoPtr info)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"info=%p\", info);\n\n    virResetLastError();\n\n    if (info)\n        memset(info, 0, sizeof(*info));\n\n    virCheckDomainReturn(domain, -1);\n    virCheckNonNullArgGoto(info, error);\n\n    conn = domain->conn;\n\n    if (conn->driver->domainGetJobInfo) {\n        int ret;\n        ret = conn->driver->domainGetJobInfo(domain, info);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "domain->conn"
          ],
          "line": 8792
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 8789
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainGetJobInfo",
          "args": [
            "domain",
            "info"
          ],
          "line": 8783
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "info",
            "error"
          ],
          "line": 8777
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "domain",
            "-1"
          ],
          "line": 8776
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "info",
            "0",
            "sizeof(*info)"
          ],
          "line": 8774
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 8771
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "domain",
            "\"info=%p\"",
            "info"
          ],
          "line": 8769
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainGetJobInfo(virDomainPtr domain, virDomainJobInfoPtr info)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"info=%p\", info);\n\n    virResetLastError();\n\n    if (info)\n        memset(info, 0, sizeof(*info));\n\n    virCheckDomainReturn(domain, -1);\n    virCheckNonNullArgGoto(info, error);\n\n    conn = domain->conn;\n\n    if (conn->driver->domainGetJobInfo) {\n        int ret;\n        ret = conn->driver->domainGetJobInfo(domain, info);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainIsUpdated",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "8727-8748",
    "snippet": "int\nvirDomainIsUpdated(virDomainPtr dom)\n{\n    VIR_DOMAIN_DEBUG(dom);\n\n    virResetLastError();\n\n    virCheckDomainReturn(dom, -1);\n\n    if (dom->conn->driver->domainIsUpdated) {\n        int ret;\n        ret = dom->conn->driver->domainIsUpdated(dom);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n error:\n    virDispatchError(dom->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "dom->conn"
          ],
          "line": 8746
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 8744
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dom->conn->driver->domainIsUpdated",
          "args": [
            "dom"
          ],
          "line": 8738
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "dom",
            "-1"
          ],
          "line": 8734
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 8732
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "dom"
          ],
          "line": 8730
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainIsUpdated(virDomainPtr dom)\n{\n    VIR_DOMAIN_DEBUG(dom);\n\n    virResetLastError();\n\n    virCheckDomainReturn(dom, -1);\n\n    if (dom->conn->driver->domainIsUpdated) {\n        int ret;\n        ret = dom->conn->driver->domainIsUpdated(dom);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n error:\n    virDispatchError(dom->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainRename",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "8694-8717",
    "snippet": "int\nvirDomainRename(virDomainPtr dom,\n                const char *new_name,\n                unsigned int flags)\n{\n    VIR_DEBUG(\"dom=%p, new_name=%s\", dom, NULLSTR(new_name));\n\n    virResetLastError();\n    virCheckDomainReturn(dom, -1);\n    virCheckNonEmptyStringArgGoto(new_name, error);\n    virCheckReadOnlyGoto(dom->conn->flags, error);\n\n    if (dom->conn->driver->domainRename) {\n        int ret = dom->conn->driver->domainRename(dom, new_name, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n error:\n    virDispatchError(dom->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "dom->conn"
          ],
          "line": 8715
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 8713
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dom->conn->driver->domainRename",
          "args": [
            "dom",
            "new_name",
            "flags"
          ],
          "line": 8707
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "dom->conn->flags",
            "error"
          ],
          "line": 8704
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonEmptyStringArgGoto",
          "args": [
            "new_name",
            "error"
          ],
          "line": 8703
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "dom",
            "-1"
          ],
          "line": 8702
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 8701
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"dom=%p, new_name=%s\"",
            "dom",
            "NULLSTR(new_name)"
          ],
          "line": 8699
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "new_name"
          ],
          "line": 8699
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainRename(virDomainPtr dom,\n                const char *new_name,\n                unsigned int flags)\n{\n    VIR_DEBUG(\"dom=%p, new_name=%s\", dom, NULLSTR(new_name));\n\n    virResetLastError();\n    virCheckDomainReturn(dom, -1);\n    virCheckNonEmptyStringArgGoto(new_name, error);\n    virCheckReadOnlyGoto(dom->conn->flags, error);\n\n    if (dom->conn->driver->domainRename) {\n        int ret = dom->conn->driver->domainRename(dom, new_name, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n error:\n    virDispatchError(dom->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainIsPersistent",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "8654-8675",
    "snippet": "int\nvirDomainIsPersistent(virDomainPtr dom)\n{\n    VIR_DOMAIN_DEBUG(dom);\n\n    virResetLastError();\n\n    virCheckDomainReturn(dom, -1);\n\n    if (dom->conn->driver->domainIsPersistent) {\n        int ret;\n        ret = dom->conn->driver->domainIsPersistent(dom);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n error:\n    virDispatchError(dom->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "dom->conn"
          ],
          "line": 8673
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 8671
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dom->conn->driver->domainIsPersistent",
          "args": [
            "dom"
          ],
          "line": 8665
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "dom",
            "-1"
          ],
          "line": 8661
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 8659
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "dom"
          ],
          "line": 8657
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainIsPersistent(virDomainPtr dom)\n{\n    VIR_DOMAIN_DEBUG(dom);\n\n    virResetLastError();\n\n    virCheckDomainReturn(dom, -1);\n\n    if (dom->conn->driver->domainIsPersistent) {\n        int ret;\n        ret = dom->conn->driver->domainIsPersistent(dom);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n error:\n    virDispatchError(dom->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainIsActive",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "8621-8642",
    "snippet": "int\nvirDomainIsActive(virDomainPtr dom)\n{\n    VIR_DEBUG(\"dom=%p\", dom);\n\n    virResetLastError();\n\n    virCheckDomainReturn(dom, -1);\n\n    if (dom->conn->driver->domainIsActive) {\n        int ret;\n        ret = dom->conn->driver->domainIsActive(dom);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n error:\n    virDispatchError(dom->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "dom->conn"
          ],
          "line": 8640
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 8638
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dom->conn->driver->domainIsActive",
          "args": [
            "dom"
          ],
          "line": 8632
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "dom",
            "-1"
          ],
          "line": 8628
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 8626
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"dom=%p\"",
            "dom"
          ],
          "line": 8624
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainIsActive(virDomainPtr dom)\n{\n    VIR_DEBUG(\"dom=%p\", dom);\n\n    virResetLastError();\n\n    virCheckDomainReturn(dom, -1);\n\n    if (dom->conn->driver->domainIsActive) {\n        int ret;\n        ret = dom->conn->driver->domainIsActive(dom);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n error:\n    virDispatchError(dom->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virConnectDomainEventDeregister",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "8587-8610",
    "snippet": "int\nvirConnectDomainEventDeregister(virConnectPtr conn,\n                                virConnectDomainEventCallback cb)\n{\n    VIR_DEBUG(\"conn=%p, cb=%p\", conn, cb);\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, -1);\n    virCheckNonNullArgGoto(cb, error);\n\n    if (conn->driver && conn->driver->connectDomainEventDeregister) {\n        int ret;\n        ret = conn->driver->connectDomainEventDeregister(conn, cb);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n error:\n    virDispatchError(conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "conn"
          ],
          "line": 8608
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 8606
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->connectDomainEventDeregister",
          "args": [
            "conn",
            "cb"
          ],
          "line": 8600
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "cb",
            "error"
          ],
          "line": 8596
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckConnectReturn",
          "args": [
            "conn",
            "-1"
          ],
          "line": 8595
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 8593
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"conn=%p, cb=%p\"",
            "conn",
            "cb"
          ],
          "line": 8591
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirConnectDomainEventDeregister(virConnectPtr conn,\n                                virConnectDomainEventCallback cb)\n{\n    VIR_DEBUG(\"conn=%p, cb=%p\", conn, cb);\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, -1);\n    virCheckNonNullArgGoto(cb, error);\n\n    if (conn->driver && conn->driver->connectDomainEventDeregister) {\n        int ret;\n        ret = conn->driver->connectDomainEventDeregister(conn, cb);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n error:\n    virDispatchError(conn);\n    return -1;\n}"
  },
  {
    "function_name": "virConnectDomainEventRegister",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "8544-8568",
    "snippet": "int\nvirConnectDomainEventRegister(virConnectPtr conn,\n                              virConnectDomainEventCallback cb,\n                              void *opaque,\n                              virFreeCallback freecb)\n{\n    VIR_DEBUG(\"conn=%p, cb=%p, opaque=%p, freecb=%p\", conn, cb, opaque, freecb);\n    virResetLastError();\n\n    virCheckConnectReturn(conn, -1);\n    virCheckNonNullArgGoto(cb, error);\n\n    if (conn->driver && conn->driver->connectDomainEventRegister) {\n        int ret;\n        ret = conn->driver->connectDomainEventRegister(conn, cb, opaque, freecb);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n error:\n    virDispatchError(conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "conn"
          ],
          "line": 8566
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 8564
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->connectDomainEventRegister",
          "args": [
            "conn",
            "cb",
            "opaque",
            "freecb"
          ],
          "line": 8558
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "cb",
            "error"
          ],
          "line": 8554
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckConnectReturn",
          "args": [
            "conn",
            "-1"
          ],
          "line": 8553
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 8551
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"conn=%p, cb=%p, opaque=%p, freecb=%p\"",
            "conn",
            "cb",
            "opaque",
            "freecb"
          ],
          "line": 8550
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirConnectDomainEventRegister(virConnectPtr conn,\n                              virConnectDomainEventCallback cb,\n                              void *opaque,\n                              virFreeCallback freecb)\n{\n    VIR_DEBUG(\"conn=%p, cb=%p, opaque=%p, freecb=%p\", conn, cb, opaque, freecb);\n    virResetLastError();\n\n    virCheckConnectReturn(conn, -1);\n    virCheckNonNullArgGoto(cb, error);\n\n    if (conn->driver && conn->driver->connectDomainEventRegister) {\n        int ret;\n        ret = conn->driver->connectDomainEventRegister(conn, cb, opaque, freecb);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n error:\n    virDispatchError(conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainDetachDeviceAlias",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "8484-8514",
    "snippet": "int\nvirDomainDetachDeviceAlias(virDomainPtr domain,\n                           const char *alias,\n                           unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"alias=%s, flags=0x%x\", alias, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    virCheckNonNullArgGoto(alias, error);\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->driver->domainDetachDeviceAlias) {\n        int ret;\n        ret = conn->driver->domainDetachDeviceAlias(domain, alias, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "domain->conn"
          ],
          "line": 8512
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 8509
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainDetachDeviceAlias",
          "args": [
            "domain",
            "alias",
            "flags"
          ],
          "line": 8503
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "conn->flags",
            "error"
          ],
          "line": 8499
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "alias",
            "error"
          ],
          "line": 8498
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "domain",
            "-1"
          ],
          "line": 8495
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 8493
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "domain",
            "\"alias=%s, flags=0x%x\"",
            "alias",
            "flags"
          ],
          "line": 8491
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainDetachDeviceAlias(virDomainPtr domain,\n                           const char *alias,\n                           unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"alias=%s, flags=0x%x\", alias, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    virCheckNonNullArgGoto(alias, error);\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->driver->domainDetachDeviceAlias) {\n        int ret;\n        ret = conn->driver->domainDetachDeviceAlias(domain, alias, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainUpdateDeviceFlags",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "8430-8459",
    "snippet": "int\nvirDomainUpdateDeviceFlags(virDomainPtr domain,\n                           const char *xml, unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"xml=%s, flags=0x%x\", xml, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    virCheckNonNullArgGoto(xml, error);\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->driver->domainUpdateDeviceFlags) {\n        int ret;\n        ret = conn->driver->domainUpdateDeviceFlags(domain, xml, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "domain->conn"
          ],
          "line": 8457
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 8454
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainUpdateDeviceFlags",
          "args": [
            "domain",
            "xml",
            "flags"
          ],
          "line": 8448
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "conn->flags",
            "error"
          ],
          "line": 8444
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "xml",
            "error"
          ],
          "line": 8443
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "domain",
            "-1"
          ],
          "line": 8440
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 8438
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "domain",
            "\"xml=%s, flags=0x%x\"",
            "xml",
            "flags"
          ],
          "line": 8436
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainUpdateDeviceFlags(virDomainPtr domain,\n                           const char *xml, unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"xml=%s, flags=0x%x\", xml, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    virCheckNonNullArgGoto(xml, error);\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->driver->domainUpdateDeviceFlags) {\n        int ret;\n        ret = conn->driver->domainUpdateDeviceFlags(domain, xml, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainDetachDeviceFlags",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "8366-8395",
    "snippet": "int\nvirDomainDetachDeviceFlags(virDomainPtr domain,\n                           const char *xml, unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"xml=%s, flags=0x%x\", xml, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    virCheckNonNullArgGoto(xml, error);\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->driver->domainDetachDeviceFlags) {\n        int ret;\n        ret = conn->driver->domainDetachDeviceFlags(domain, xml, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "domain->conn"
          ],
          "line": 8393
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 8390
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainDetachDeviceFlags",
          "args": [
            "domain",
            "xml",
            "flags"
          ],
          "line": 8384
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "conn->flags",
            "error"
          ],
          "line": 8380
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "xml",
            "error"
          ],
          "line": 8379
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "domain",
            "-1"
          ],
          "line": 8376
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 8374
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "domain",
            "\"xml=%s, flags=0x%x\"",
            "xml",
            "flags"
          ],
          "line": 8372
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainDetachDeviceFlags(virDomainPtr domain,\n                           const char *xml, unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"xml=%s, flags=0x%x\", xml, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    virCheckNonNullArgGoto(xml, error);\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->driver->domainDetachDeviceFlags) {\n        int ret;\n        ret = conn->driver->domainDetachDeviceFlags(domain, xml, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainDetachDevice",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "8284-8312",
    "snippet": "int\nvirDomainDetachDevice(virDomainPtr domain, const char *xml)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"xml=%s\", xml);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    virCheckNonNullArgGoto(xml, error);\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->driver->domainDetachDevice) {\n        int ret;\n        ret = conn->driver->domainDetachDevice(domain, xml);\n         if (ret < 0)\n             goto error;\n         return ret;\n     }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "domain->conn"
          ],
          "line": 8310
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 8307
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainDetachDevice",
          "args": [
            "domain",
            "xml"
          ],
          "line": 8301
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "conn->flags",
            "error"
          ],
          "line": 8297
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "xml",
            "error"
          ],
          "line": 8296
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "domain",
            "-1"
          ],
          "line": 8293
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 8291
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "domain",
            "\"xml=%s\"",
            "xml"
          ],
          "line": 8289
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainDetachDevice(virDomainPtr domain, const char *xml)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"xml=%s\", xml);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    virCheckNonNullArgGoto(xml, error);\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->driver->domainDetachDevice) {\n        int ret;\n        ret = conn->driver->domainDetachDevice(domain, xml);\n         if (ret < 0)\n             goto error;\n         return ret;\n     }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainAttachDeviceFlags",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "8240-8269",
    "snippet": "int\nvirDomainAttachDeviceFlags(virDomainPtr domain,\n                           const char *xml, unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"xml=%s, flags=0x%x\", xml, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    virCheckNonNullArgGoto(xml, error);\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->driver->domainAttachDeviceFlags) {\n        int ret;\n        ret = conn->driver->domainAttachDeviceFlags(domain, xml, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "domain->conn"
          ],
          "line": 8267
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 8264
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainAttachDeviceFlags",
          "args": [
            "domain",
            "xml",
            "flags"
          ],
          "line": 8258
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "conn->flags",
            "error"
          ],
          "line": 8254
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "xml",
            "error"
          ],
          "line": 8253
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "domain",
            "-1"
          ],
          "line": 8250
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 8248
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "domain",
            "\"xml=%s, flags=0x%x\"",
            "xml",
            "flags"
          ],
          "line": 8246
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainAttachDeviceFlags(virDomainPtr domain,\n                           const char *xml, unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"xml=%s, flags=0x%x\", xml, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    virCheckNonNullArgGoto(xml, error);\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->driver->domainAttachDeviceFlags) {\n        int ret;\n        ret = conn->driver->domainAttachDeviceFlags(domain, xml, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainAttachDevice",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "8181-8209",
    "snippet": "int\nvirDomainAttachDevice(virDomainPtr domain, const char *xml)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"xml=%s\", xml);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    virCheckNonNullArgGoto(xml, error);\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->driver->domainAttachDevice) {\n       int ret;\n       ret = conn->driver->domainAttachDevice(domain, xml);\n       if (ret < 0)\n          goto error;\n       return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "domain->conn"
          ],
          "line": 8207
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 8204
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainAttachDevice",
          "args": [
            "domain",
            "xml"
          ],
          "line": 8198
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "conn->flags",
            "error"
          ],
          "line": 8194
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "xml",
            "error"
          ],
          "line": 8193
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "domain",
            "-1"
          ],
          "line": 8190
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 8188
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "domain",
            "\"xml=%s\"",
            "xml"
          ],
          "line": 8186
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainAttachDevice(virDomainPtr domain, const char *xml)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"xml=%s\", xml);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    virCheckNonNullArgGoto(xml, error);\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->driver->domainAttachDevice) {\n       int ret;\n       ret = conn->driver->domainAttachDevice(domain, xml);\n       if (ret < 0)\n          goto error;\n       return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainGetMetadata",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "8114-8160",
    "snippet": "char *\nvirDomainGetMetadata(virDomainPtr domain,\n                     int type,\n                     const char *uri,\n                     unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"type=%d, uri='%s', flags=0x%x\",\n                     type, NULLSTR(uri), flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, NULL);\n\n    VIR_EXCLUSIVE_FLAGS_GOTO(VIR_DOMAIN_AFFECT_LIVE,\n                             VIR_DOMAIN_AFFECT_CONFIG,\n                             error);\n\n    switch (type) {\n    case VIR_DOMAIN_METADATA_TITLE:\n    case VIR_DOMAIN_METADATA_DESCRIPTION:\n        virCheckNullArgGoto(uri, error);\n        break;\n    case VIR_DOMAIN_METADATA_ELEMENT:\n        virCheckNonNullArgGoto(uri, error);\n        break;\n    default:\n        /* For future expansion */\n        break;\n    }\n\n    conn = domain->conn;\n\n    if (conn->driver->domainGetMetadata) {\n        char *ret;\n        if (!(ret = conn->driver->domainGetMetadata(domain, type, uri, flags)))\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return NULL;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "domain->conn"
          ],
          "line": 8158
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 8155
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainGetMetadata",
          "args": [
            "domain",
            "type",
            "uri",
            "flags"
          ],
          "line": 8150
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "uri",
            "error"
          ],
          "line": 8139
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNullArgGoto",
          "args": [
            "uri",
            "error"
          ],
          "line": 8136
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_EXCLUSIVE_FLAGS_GOTO",
          "args": [
            "VIR_DOMAIN_AFFECT_LIVE",
            "VIR_DOMAIN_AFFECT_CONFIG",
            "error"
          ],
          "line": 8129
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "domain",
            "NULL"
          ],
          "line": 8127
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 8125
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "domain",
            "\"type=%d, uri='%s', flags=0x%x\"",
            "type",
            "NULLSTR(uri)",
            "flags"
          ],
          "line": 8122
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "uri"
          ],
          "line": 8123
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nchar *\nvirDomainGetMetadata(virDomainPtr domain,\n                     int type,\n                     const char *uri,\n                     unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"type=%d, uri='%s', flags=0x%x\",\n                     type, NULLSTR(uri), flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, NULL);\n\n    VIR_EXCLUSIVE_FLAGS_GOTO(VIR_DOMAIN_AFFECT_LIVE,\n                             VIR_DOMAIN_AFFECT_CONFIG,\n                             error);\n\n    switch (type) {\n    case VIR_DOMAIN_METADATA_TITLE:\n    case VIR_DOMAIN_METADATA_DESCRIPTION:\n        virCheckNullArgGoto(uri, error);\n        break;\n    case VIR_DOMAIN_METADATA_ELEMENT:\n        virCheckNonNullArgGoto(uri, error);\n        break;\n    default:\n        /* For future expansion */\n        break;\n    }\n\n    conn = domain->conn;\n\n    if (conn->driver->domainGetMetadata) {\n        char *ret;\n        if (!(ret = conn->driver->domainGetMetadata(domain, type, uri, flags)))\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return NULL;\n}"
  },
  {
    "function_name": "virDomainSetMetadata",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "8029-8088",
    "snippet": "int\nvirDomainSetMetadata(virDomainPtr domain,\n                     int type,\n                     const char *metadata,\n                     const char *key,\n                     const char *uri,\n                     unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain,\n                     \"type=%d, metadata='%s', key='%s', uri='%s', flags=0x%x\",\n                     type, NULLSTR(metadata), NULLSTR(key), NULLSTR(uri),\n                     flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    switch (type) {\n    case VIR_DOMAIN_METADATA_TITLE:\n        if (metadata && strchr(metadata, '\\n')) {\n            virReportInvalidArg(metadata, \"%s\",\n                                _(\"metadata title can't contain \"\n                                  \"newlines\"));\n            goto error;\n        }\n        G_GNUC_FALLTHROUGH;\n    case VIR_DOMAIN_METADATA_DESCRIPTION:\n        virCheckNullArgGoto(uri, error);\n        virCheckNullArgGoto(key, error);\n        break;\n    case VIR_DOMAIN_METADATA_ELEMENT:\n        virCheckNonNullArgGoto(uri, error);\n        if (metadata)\n            virCheckNonNullArgGoto(key, error);\n        break;\n    default:\n        /* For future expansion */\n        break;\n    }\n\n    if (conn->driver->domainSetMetadata) {\n        int ret;\n        ret = conn->driver->domainSetMetadata(domain, type, metadata, key, uri,\n                                              flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "domain->conn"
          ],
          "line": 8086
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 8083
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainSetMetadata",
          "args": [
            "domain",
            "type",
            "metadata",
            "key",
            "uri",
            "flags"
          ],
          "line": 8076
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "key",
            "error"
          ],
          "line": 8067
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "uri",
            "error"
          ],
          "line": 8065
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNullArgGoto",
          "args": [
            "key",
            "error"
          ],
          "line": 8062
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNullArgGoto",
          "args": [
            "uri",
            "error"
          ],
          "line": 8061
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportInvalidArg",
          "args": [
            "metadata",
            "\"%s\"",
            "_(\"metadata title can't contain \"\n                                  \"newlines\")"
          ],
          "line": 8054
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"metadata title can't contain \"\n                                  \"newlines\""
          ],
          "line": 8055
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "metadata",
            "'\\n'"
          ],
          "line": 8053
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "conn->flags",
            "error"
          ],
          "line": 8049
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "domain",
            "-1"
          ],
          "line": 8046
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 8044
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "domain",
            "\"type=%d, metadata='%s', key='%s', uri='%s', flags=0x%x\"",
            "type",
            "NULLSTR(metadata)",
            "NULLSTR(key)",
            "NULLSTR(uri)",
            "flags"
          ],
          "line": 8039
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "uri"
          ],
          "line": 8041
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "key"
          ],
          "line": 8041
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "metadata"
          ],
          "line": 8041
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainSetMetadata(virDomainPtr domain,\n                     int type,\n                     const char *metadata,\n                     const char *key,\n                     const char *uri,\n                     unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain,\n                     \"type=%d, metadata='%s', key='%s', uri='%s', flags=0x%x\",\n                     type, NULLSTR(metadata), NULLSTR(key), NULLSTR(uri),\n                     flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    switch (type) {\n    case VIR_DOMAIN_METADATA_TITLE:\n        if (metadata && strchr(metadata, '\\n')) {\n            virReportInvalidArg(metadata, \"%s\",\n                                _(\"metadata title can't contain \"\n                                  \"newlines\"));\n            goto error;\n        }\n        G_GNUC_FALLTHROUGH;\n    case VIR_DOMAIN_METADATA_DESCRIPTION:\n        virCheckNullArgGoto(uri, error);\n        virCheckNullArgGoto(key, error);\n        break;\n    case VIR_DOMAIN_METADATA_ELEMENT:\n        virCheckNonNullArgGoto(uri, error);\n        if (metadata)\n            virCheckNonNullArgGoto(key, error);\n        break;\n    default:\n        /* For future expansion */\n        break;\n    }\n\n    if (conn->driver->domainSetMetadata) {\n        int ret;\n        ret = conn->driver->domainSetMetadata(domain, type, metadata, key, uri,\n                                              flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainGetSecurityLabelList",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "7967-7996",
    "snippet": "int\nvirDomainGetSecurityLabelList(virDomainPtr domain,\n                              virSecurityLabelPtr* seclabels)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"seclabels=%p\", seclabels);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n\n    virCheckNonNullArgGoto(seclabels, error);\n\n    conn = domain->conn;\n\n    if (conn->driver->domainGetSecurityLabelList) {\n        int ret;\n        ret = conn->driver->domainGetSecurityLabelList(domain, seclabels);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "domain->conn"
          ],
          "line": 7994
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 7991
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainGetSecurityLabelList",
          "args": [
            "domain",
            "seclabels"
          ],
          "line": 7985
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "seclabels",
            "error"
          ],
          "line": 7979
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "domain",
            "-1"
          ],
          "line": 7977
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 7975
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "domain",
            "\"seclabels=%p\"",
            "seclabels"
          ],
          "line": 7973
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainGetSecurityLabelList(virDomainPtr domain,\n                              virSecurityLabelPtr* seclabels)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"seclabels=%p\", seclabels);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n\n    virCheckNonNullArgGoto(seclabels, error);\n\n    conn = domain->conn;\n\n    if (conn->driver->domainGetSecurityLabelList) {\n        int ret;\n        ret = conn->driver->domainGetSecurityLabelList(domain, seclabels);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainGetSecurityLabel",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "7925-7952",
    "snippet": "int\nvirDomainGetSecurityLabel(virDomainPtr domain, virSecurityLabelPtr seclabel)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"seclabel=%p\", seclabel);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    virCheckNonNullArgGoto(seclabel, error);\n\n    if (conn->driver->domainGetSecurityLabel) {\n        int ret;\n        ret = conn->driver->domainGetSecurityLabel(domain, seclabel);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "domain->conn"
          ],
          "line": 7950
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 7947
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainGetSecurityLabel",
          "args": [
            "domain",
            "seclabel"
          ],
          "line": 7941
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "seclabel",
            "error"
          ],
          "line": 7937
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "domain",
            "-1"
          ],
          "line": 7934
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 7932
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "domain",
            "\"seclabel=%p\"",
            "seclabel"
          ],
          "line": 7930
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainGetSecurityLabel(virDomainPtr domain, virSecurityLabelPtr seclabel)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"seclabel=%p\", seclabel);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    virCheckNonNullArgGoto(seclabel, error);\n\n    if (conn->driver->domainGetSecurityLabel) {\n        int ret;\n        ret = conn->driver->domainGetSecurityLabel(domain, seclabel);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainSetIOThreadParams",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "7872-7911",
    "snippet": "int\nvirDomainSetIOThreadParams(virDomainPtr domain,\n                           unsigned int iothread_id,\n                           virTypedParameterPtr params,\n                           int nparams,\n                           unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"iothread_id=%u, params=%p, nparams=%d, flags=0x%x\",\n                     iothread_id, params, nparams, flags);\n    VIR_TYPED_PARAMS_DEBUG(params, nparams);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n    virCheckNonNullArgGoto(params, error);\n    virCheckPositiveArgGoto(nparams, error);\n\n    if (virTypedParameterValidateSet(conn, params, nparams) < 0)\n        goto error;\n\n    if (conn->driver->domainSetIOThreadParams) {\n        int ret;\n        ret = conn->driver->domainSetIOThreadParams(domain, iothread_id,\n                                                    params, nparams, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "domain->conn"
          ],
          "line": 7909
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 7906
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainSetIOThreadParams",
          "args": [
            "domain",
            "iothread_id",
            "params",
            "nparams",
            "flags"
          ],
          "line": 7899
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virTypedParameterValidateSet",
          "args": [
            "conn",
            "params",
            "nparams"
          ],
          "line": 7894
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParameterValidateSet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt.c",
          "lines": "1288-1325",
          "snippet": "int\nvirTypedParameterValidateSet(virConnectPtr conn,\n                             virTypedParameterPtr params,\n                             int nparams)\n{\n    bool string_okay;\n    size_t i;\n\n    string_okay = VIR_DRV_SUPPORTS_FEATURE(conn->driver,\n                                           conn,\n                                           VIR_DRV_FEATURE_TYPED_PARAM_STRING);\n    for (i = 0; i < nparams; i++) {\n        if (strnlen(params[i].field, VIR_TYPED_PARAM_FIELD_LENGTH) ==\n            VIR_TYPED_PARAM_FIELD_LENGTH) {\n            virReportInvalidArg(params,\n                                _(\"string parameter name '%.*s' too long\"),\n                                VIR_TYPED_PARAM_FIELD_LENGTH,\n                                params[i].field);\n            return -1;\n        }\n        if (params[i].type == VIR_TYPED_PARAM_STRING) {\n            if (string_okay) {\n                if (!params[i].value.s) {\n                    virReportInvalidArg(params,\n                                        _(\"NULL string parameter '%s'\"),\n                                        params[i].field);\n                    return -1;\n                }\n            } else {\n                virReportInvalidArg(params,\n                                    _(\"string parameter '%s' unsupported\"),\n                                    params[i].field);\n                return -1;\n            }\n        }\n    }\n    return 0;\n}",
          "includes": [
            "#include \"access/viraccessmanager.h\"",
            "# include \"bhyve/bhyve_driver.h\"",
            "# include \"hyperv/hyperv_driver.h\"",
            "# include \"esx/esx_driver.h\"",
            "# include \"vmware/vmware_driver.h\"",
            "# include \"openvz/openvz_driver.h\"",
            "# include \"remote/remote_driver.h\"",
            "# include \"test/test_driver.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"viruri.h\"",
            "#include \"virrandom.h\"",
            "#include \"virfile.h\"",
            "#include \"virevent.h\"",
            "#include \"vircommand.h\"",
            "#include \"rpc/virnettlscontext.h\"",
            "#include \"virconf.h\"",
            "#include \"configmake.h\"",
            "#include \"viralloc.h\"",
            "#include \"viruuid.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <curl/curl.h>",
            "#include <libxml/xpath.h>",
            "#include <libxml/parser.h>",
            "#include <gio/gnetworking.h>",
            "#include <time.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"access/viraccessmanager.h\"\n# include \"bhyve/bhyve_driver.h\"\n# include \"hyperv/hyperv_driver.h\"\n# include \"esx/esx_driver.h\"\n# include \"vmware/vmware_driver.h\"\n# include \"openvz/openvz_driver.h\"\n# include \"remote/remote_driver.h\"\n# include \"test/test_driver.h\"\n#include \"virtypedparam.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"viruri.h\"\n#include \"virrandom.h\"\n#include \"virfile.h\"\n#include \"virevent.h\"\n#include \"vircommand.h\"\n#include \"rpc/virnettlscontext.h\"\n#include \"virconf.h\"\n#include \"configmake.h\"\n#include \"viralloc.h\"\n#include \"viruuid.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <curl/curl.h>\n#include <libxml/xpath.h>\n#include <libxml/parser.h>\n#include <gio/gnetworking.h>\n#include <time.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nint\nvirTypedParameterValidateSet(virConnectPtr conn,\n                             virTypedParameterPtr params,\n                             int nparams)\n{\n    bool string_okay;\n    size_t i;\n\n    string_okay = VIR_DRV_SUPPORTS_FEATURE(conn->driver,\n                                           conn,\n                                           VIR_DRV_FEATURE_TYPED_PARAM_STRING);\n    for (i = 0; i < nparams; i++) {\n        if (strnlen(params[i].field, VIR_TYPED_PARAM_FIELD_LENGTH) ==\n            VIR_TYPED_PARAM_FIELD_LENGTH) {\n            virReportInvalidArg(params,\n                                _(\"string parameter name '%.*s' too long\"),\n                                VIR_TYPED_PARAM_FIELD_LENGTH,\n                                params[i].field);\n            return -1;\n        }\n        if (params[i].type == VIR_TYPED_PARAM_STRING) {\n            if (string_okay) {\n                if (!params[i].value.s) {\n                    virReportInvalidArg(params,\n                                        _(\"NULL string parameter '%s'\"),\n                                        params[i].field);\n                    return -1;\n                }\n            } else {\n                virReportInvalidArg(params,\n                                    _(\"string parameter '%s' unsupported\"),\n                                    params[i].field);\n                return -1;\n            }\n        }\n    }\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckPositiveArgGoto",
          "args": [
            "nparams",
            "error"
          ],
          "line": 7892
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "params",
            "error"
          ],
          "line": 7891
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "conn->flags",
            "error"
          ],
          "line": 7890
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "domain",
            "-1"
          ],
          "line": 7887
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 7885
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_TYPED_PARAMS_DEBUG",
          "args": [
            "params",
            "nparams"
          ],
          "line": 7883
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "domain",
            "\"iothread_id=%u, params=%p, nparams=%d, flags=0x%x\"",
            "iothread_id",
            "params",
            "nparams",
            "flags"
          ],
          "line": 7881
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainSetIOThreadParams(virDomainPtr domain,\n                           unsigned int iothread_id,\n                           virTypedParameterPtr params,\n                           int nparams,\n                           unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"iothread_id=%u, params=%p, nparams=%d, flags=0x%x\",\n                     iothread_id, params, nparams, flags);\n    VIR_TYPED_PARAMS_DEBUG(params, nparams);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n    virCheckNonNullArgGoto(params, error);\n    virCheckPositiveArgGoto(nparams, error);\n\n    if (virTypedParameterValidateSet(conn, params, nparams) < 0)\n        goto error;\n\n    if (conn->driver->domainSetIOThreadParams) {\n        int ret;\n        ret = conn->driver->domainSetIOThreadParams(domain, iothread_id,\n                                                    params, nparams, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainDelIOThread",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "7811-7841",
    "snippet": "int\nvirDomainDelIOThread(virDomainPtr domain,\n                     unsigned int iothread_id,\n                     unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"iothread_id=%u, flags=0x%x\", iothread_id, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    virCheckReadOnlyGoto(domain->conn->flags, error);\n    virCheckNonZeroArgGoto(iothread_id, error);\n\n    conn = domain->conn;\n\n    if (conn->driver->domainDelIOThread) {\n        int ret;\n        ret = conn->driver->domainDelIOThread(domain, iothread_id, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "domain->conn"
          ],
          "line": 7839
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 7836
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainDelIOThread",
          "args": [
            "domain",
            "iothread_id",
            "flags"
          ],
          "line": 7830
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonZeroArgGoto",
          "args": [
            "iothread_id",
            "error"
          ],
          "line": 7824
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "domain->conn->flags",
            "error"
          ],
          "line": 7823
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "domain",
            "-1"
          ],
          "line": 7822
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 7820
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "domain",
            "\"iothread_id=%u, flags=0x%x\"",
            "iothread_id",
            "flags"
          ],
          "line": 7818
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainDelIOThread(virDomainPtr domain,\n                     unsigned int iothread_id,\n                     unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"iothread_id=%u, flags=0x%x\", iothread_id, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    virCheckReadOnlyGoto(domain->conn->flags, error);\n    virCheckNonZeroArgGoto(iothread_id, error);\n\n    conn = domain->conn;\n\n    if (conn->driver->domainDelIOThread) {\n        int ret;\n        ret = conn->driver->domainDelIOThread(domain, iothread_id, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainAddIOThread",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "7752-7782",
    "snippet": "int\nvirDomainAddIOThread(virDomainPtr domain,\n                     unsigned int iothread_id,\n                     unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"iothread_id=%u, flags=0x%x\",\n                     iothread_id, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    virCheckReadOnlyGoto(domain->conn->flags, error);\n\n    conn = domain->conn;\n\n    if (conn->driver->domainAddIOThread) {\n        int ret;\n        ret = conn->driver->domainAddIOThread(domain, iothread_id, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "domain->conn"
          ],
          "line": 7780
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 7777
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainAddIOThread",
          "args": [
            "domain",
            "iothread_id",
            "flags"
          ],
          "line": 7771
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "domain->conn->flags",
            "error"
          ],
          "line": 7765
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "domain",
            "-1"
          ],
          "line": 7764
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 7762
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "domain",
            "\"iothread_id=%u, flags=0x%x\"",
            "iothread_id",
            "flags"
          ],
          "line": 7759
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainAddIOThread(virDomainPtr domain,\n                     unsigned int iothread_id,\n                     unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"iothread_id=%u, flags=0x%x\",\n                     iothread_id, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    virCheckReadOnlyGoto(domain->conn->flags, error);\n\n    conn = domain->conn;\n\n    if (conn->driver->domainAddIOThread) {\n        int ret;\n        ret = conn->driver->domainAddIOThread(domain, iothread_id, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainPinIOThread",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "7688-7723",
    "snippet": "int\nvirDomainPinIOThread(virDomainPtr domain,\n                     unsigned int iothread_id,\n                     unsigned char *cpumap,\n                     int maplen,\n                     unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"iothread_id=%u, cpumap=%p, maplen=%d\",\n                     iothread_id, cpumap, maplen);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n    virCheckNonNullArgGoto(cpumap, error);\n    virCheckPositiveArgGoto(maplen, error);\n\n    if (conn->driver->domainPinIOThread) {\n        int ret;\n        ret = conn->driver->domainPinIOThread(domain, iothread_id,\n                                              cpumap, maplen, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "domain->conn"
          ],
          "line": 7721
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 7718
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainPinIOThread",
          "args": [
            "domain",
            "iothread_id",
            "cpumap",
            "maplen",
            "flags"
          ],
          "line": 7711
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckPositiveArgGoto",
          "args": [
            "maplen",
            "error"
          ],
          "line": 7707
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "cpumap",
            "error"
          ],
          "line": 7706
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "conn->flags",
            "error"
          ],
          "line": 7705
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "domain",
            "-1"
          ],
          "line": 7702
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 7700
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "domain",
            "\"iothread_id=%u, cpumap=%p, maplen=%d\"",
            "iothread_id",
            "cpumap",
            "maplen"
          ],
          "line": 7697
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainPinIOThread(virDomainPtr domain,\n                     unsigned int iothread_id,\n                     unsigned char *cpumap,\n                     int maplen,\n                     unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"iothread_id=%u, cpumap=%p, maplen=%d\",\n                     iothread_id, cpumap, maplen);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n    virCheckNonNullArgGoto(cpumap, error);\n    virCheckPositiveArgGoto(maplen, error);\n\n    if (conn->driver->domainPinIOThread) {\n        int ret;\n        ret = conn->driver->domainPinIOThread(domain, iothread_id,\n                                              cpumap, maplen, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainIOThreadInfoFree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "7645-7653",
    "snippet": "void\nvirDomainIOThreadInfoFree(virDomainIOThreadInfoPtr info)\n{\n    if (!info)\n        return;\n\n    VIR_FREE(info->cpumap);\n    VIR_FREE(info);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "info"
          ],
          "line": 7652
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "info->cpumap"
          ],
          "line": 7651
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nvoid\nvirDomainIOThreadInfoFree(virDomainIOThreadInfoPtr info)\n{\n    if (!info)\n        return;\n\n    VIR_FREE(info->cpumap);\n    VIR_FREE(info);\n}"
  },
  {
    "function_name": "virDomainGetIOThreadInfo",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "7606-7636",
    "snippet": "int\nvirDomainGetIOThreadInfo(virDomainPtr dom,\n                         virDomainIOThreadInfoPtr **info,\n                         unsigned int flags)\n{\n    VIR_DOMAIN_DEBUG(dom, \"info=%p flags=0x%x\", info, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(dom, -1);\n    virCheckNonNullArgGoto(info, error);\n    *info = NULL;\n\n    VIR_EXCLUSIVE_FLAGS_GOTO(VIR_DOMAIN_AFFECT_LIVE,\n                             VIR_DOMAIN_AFFECT_CONFIG,\n                             error);\n\n    if (dom->conn->driver->domainGetIOThreadInfo) {\n        int ret;\n        ret = dom->conn->driver->domainGetIOThreadInfo(dom, info, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(dom->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "dom->conn"
          ],
          "line": 7634
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 7631
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dom->conn->driver->domainGetIOThreadInfo",
          "args": [
            "dom",
            "info",
            "flags"
          ],
          "line": 7625
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_EXCLUSIVE_FLAGS_GOTO",
          "args": [
            "VIR_DOMAIN_AFFECT_LIVE",
            "VIR_DOMAIN_AFFECT_CONFIG",
            "error"
          ],
          "line": 7619
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "info",
            "error"
          ],
          "line": 7616
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "dom",
            "-1"
          ],
          "line": 7615
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 7613
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "dom",
            "\"info=%p flags=0x%x\"",
            "info",
            "flags"
          ],
          "line": 7611
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainGetIOThreadInfo(virDomainPtr dom,\n                         virDomainIOThreadInfoPtr **info,\n                         unsigned int flags)\n{\n    VIR_DOMAIN_DEBUG(dom, \"info=%p flags=0x%x\", info, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(dom, -1);\n    virCheckNonNullArgGoto(info, error);\n    *info = NULL;\n\n    VIR_EXCLUSIVE_FLAGS_GOTO(VIR_DOMAIN_AFFECT_LIVE,\n                             VIR_DOMAIN_AFFECT_CONFIG,\n                             error);\n\n    if (dom->conn->driver->domainGetIOThreadInfo) {\n        int ret;\n        ret = dom->conn->driver->domainGetIOThreadInfo(dom, info, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(dom->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainGetMaxVcpus",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "7562-7587",
    "snippet": "int\nvirDomainGetMaxVcpus(virDomainPtr domain)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    if (conn->driver->domainGetMaxVcpus) {\n        int ret;\n        ret = conn->driver->domainGetMaxVcpus(domain);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "domain->conn"
          ],
          "line": 7585
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 7582
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainGetMaxVcpus",
          "args": [
            "domain"
          ],
          "line": 7576
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "domain",
            "-1"
          ],
          "line": 7571
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 7569
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "domain"
          ],
          "line": 7567
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainGetMaxVcpus(virDomainPtr domain)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    if (conn->driver->domainGetMaxVcpus) {\n        int ret;\n        ret = conn->driver->domainGetMaxVcpus(domain);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainGetVcpus",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "7503-7547",
    "snippet": "int\nvirDomainGetVcpus(virDomainPtr domain, virVcpuInfoPtr info, int maxinfo,\n                  unsigned char *cpumaps, int maplen)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"info=%p, maxinfo=%d, cpumaps=%p, maplen=%d\",\n                     info, maxinfo, cpumaps, maplen);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    virCheckNonNullArgGoto(info, error);\n    virCheckPositiveArgGoto(maxinfo, error);\n\n    /* Ensure that domainGetVcpus (aka remoteDomainGetVcpus) does not\n       try to memcpy anything into a NULL pointer.  */\n    if (cpumaps)\n        virCheckPositiveArgGoto(maplen, error);\n    else\n        virCheckZeroArgGoto(maplen, error);\n\n    if (cpumaps && VIR_INT_MULTIPLY_OVERFLOW(maxinfo, maplen)) {\n        virReportError(VIR_ERR_OVERFLOW, _(\"input too large: %d * %d\"),\n                       maxinfo, maplen);\n        goto error;\n    }\n\n    conn = domain->conn;\n\n    if (conn->driver->domainGetVcpus) {\n        int ret;\n        ret = conn->driver->domainGetVcpus(domain, info, maxinfo,\n                                           cpumaps, maplen);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "domain->conn"
          ],
          "line": 7545
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 7542
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainGetVcpus",
          "args": [
            "domain",
            "info",
            "maxinfo",
            "cpumaps",
            "maplen"
          ],
          "line": 7535
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OVERFLOW",
            "_(\"input too large: %d * %d\")",
            "maxinfo",
            "maplen"
          ],
          "line": 7526
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"input too large: %d * %d\""
          ],
          "line": 7526
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_INT_MULTIPLY_OVERFLOW",
          "args": [
            "maxinfo",
            "maplen"
          ],
          "line": 7525
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckZeroArgGoto",
          "args": [
            "maplen",
            "error"
          ],
          "line": 7523
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckPositiveArgGoto",
          "args": [
            "maplen",
            "error"
          ],
          "line": 7521
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckPositiveArgGoto",
          "args": [
            "maxinfo",
            "error"
          ],
          "line": 7516
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "info",
            "error"
          ],
          "line": 7515
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "domain",
            "-1"
          ],
          "line": 7514
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 7512
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "domain",
            "\"info=%p, maxinfo=%d, cpumaps=%p, maplen=%d\"",
            "info",
            "maxinfo",
            "cpumaps",
            "maplen"
          ],
          "line": 7509
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainGetVcpus(virDomainPtr domain, virVcpuInfoPtr info, int maxinfo,\n                  unsigned char *cpumaps, int maplen)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"info=%p, maxinfo=%d, cpumaps=%p, maplen=%d\",\n                     info, maxinfo, cpumaps, maplen);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    virCheckNonNullArgGoto(info, error);\n    virCheckPositiveArgGoto(maxinfo, error);\n\n    /* Ensure that domainGetVcpus (aka remoteDomainGetVcpus) does not\n       try to memcpy anything into a NULL pointer.  */\n    if (cpumaps)\n        virCheckPositiveArgGoto(maplen, error);\n    else\n        virCheckZeroArgGoto(maplen, error);\n\n    if (cpumaps && VIR_INT_MULTIPLY_OVERFLOW(maxinfo, maplen)) {\n        virReportError(VIR_ERR_OVERFLOW, _(\"input too large: %d * %d\"),\n                       maxinfo, maplen);\n        goto error;\n    }\n\n    conn = domain->conn;\n\n    if (conn->driver->domainGetVcpus) {\n        int ret;\n        ret = conn->driver->domainGetVcpus(domain, info, maxinfo,\n                                           cpumaps, maplen);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainGetEmulatorPinInfo",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "7438-7474",
    "snippet": "int\nvirDomainGetEmulatorPinInfo(virDomainPtr domain, unsigned char *cpumap,\n                            int maplen, unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"cpumap=%p, maplen=%d, flags=0x%x\",\n                     cpumap, maplen, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n\n    virCheckNonNullArgGoto(cpumap, error);\n    virCheckPositiveArgGoto(maplen, error);\n\n    VIR_EXCLUSIVE_FLAGS_GOTO(VIR_DOMAIN_AFFECT_LIVE,\n                             VIR_DOMAIN_AFFECT_CONFIG,\n                             error);\n\n    conn = domain->conn;\n\n    if (conn->driver->domainGetEmulatorPinInfo) {\n        int ret;\n        ret = conn->driver->domainGetEmulatorPinInfo(domain, cpumap,\n                                                     maplen, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "domain->conn"
          ],
          "line": 7472
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 7469
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainGetEmulatorPinInfo",
          "args": [
            "domain",
            "cpumap",
            "maplen",
            "flags"
          ],
          "line": 7462
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_EXCLUSIVE_FLAGS_GOTO",
          "args": [
            "VIR_DOMAIN_AFFECT_LIVE",
            "VIR_DOMAIN_AFFECT_CONFIG",
            "error"
          ],
          "line": 7454
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckPositiveArgGoto",
          "args": [
            "maplen",
            "error"
          ],
          "line": 7452
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "cpumap",
            "error"
          ],
          "line": 7451
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "domain",
            "-1"
          ],
          "line": 7449
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 7447
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "domain",
            "\"cpumap=%p, maplen=%d, flags=0x%x\"",
            "cpumap",
            "maplen",
            "flags"
          ],
          "line": 7444
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainGetEmulatorPinInfo(virDomainPtr domain, unsigned char *cpumap,\n                            int maplen, unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"cpumap=%p, maplen=%d, flags=0x%x\",\n                     cpumap, maplen, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n\n    virCheckNonNullArgGoto(cpumap, error);\n    virCheckPositiveArgGoto(maplen, error);\n\n    VIR_EXCLUSIVE_FLAGS_GOTO(VIR_DOMAIN_AFFECT_LIVE,\n                             VIR_DOMAIN_AFFECT_CONFIG,\n                             error);\n\n    conn = domain->conn;\n\n    if (conn->driver->domainGetEmulatorPinInfo) {\n        int ret;\n        ret = conn->driver->domainGetEmulatorPinInfo(domain, cpumap,\n                                                     maplen, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainPinEmulator",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "7383-7415",
    "snippet": "int\nvirDomainPinEmulator(virDomainPtr domain, unsigned char *cpumap,\n                     int maplen, unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"cpumap=%p, maplen=%d, flags=0x%x\",\n                     cpumap, maplen, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    virCheckNonNullArgGoto(cpumap, error);\n    virCheckPositiveArgGoto(maplen, error);\n\n    if (conn->driver->domainPinEmulator) {\n        int ret;\n        ret = conn->driver->domainPinEmulator(domain, cpumap, maplen, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "domain->conn"
          ],
          "line": 7413
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 7410
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainPinEmulator",
          "args": [
            "domain",
            "cpumap",
            "maplen",
            "flags"
          ],
          "line": 7404
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckPositiveArgGoto",
          "args": [
            "maplen",
            "error"
          ],
          "line": 7400
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "cpumap",
            "error"
          ],
          "line": 7399
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "conn->flags",
            "error"
          ],
          "line": 7397
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "domain",
            "-1"
          ],
          "line": 7394
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 7392
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "domain",
            "\"cpumap=%p, maplen=%d, flags=0x%x\"",
            "cpumap",
            "maplen",
            "flags"
          ],
          "line": 7389
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainPinEmulator(virDomainPtr domain, unsigned char *cpumap,\n                     int maplen, unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"cpumap=%p, maplen=%d, flags=0x%x\",\n                     cpumap, maplen, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    virCheckNonNullArgGoto(cpumap, error);\n    virCheckPositiveArgGoto(maplen, error);\n\n    if (conn->driver->domainPinEmulator) {\n        int ret;\n        ret = conn->driver->domainPinEmulator(domain, cpumap, maplen, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainGetVcpuPinInfo",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "7306-7348",
    "snippet": "int\nvirDomainGetVcpuPinInfo(virDomainPtr domain, int ncpumaps,\n                        unsigned char *cpumaps, int maplen, unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"ncpumaps=%d, cpumaps=%p, maplen=%d, flags=0x%x\",\n                     ncpumaps, cpumaps, maplen, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    virCheckNonNullArrayArgGoto(cpumaps, ncpumaps, error);\n    virCheckPositiveArgGoto(ncpumaps, error);\n    virCheckPositiveArgGoto(maplen, error);\n\n    if (VIR_INT_MULTIPLY_OVERFLOW(ncpumaps, maplen)) {\n        virReportError(VIR_ERR_OVERFLOW, _(\"input too large: %d * %d\"),\n                       ncpumaps, maplen);\n        goto error;\n    }\n\n    VIR_EXCLUSIVE_FLAGS_GOTO(VIR_DOMAIN_AFFECT_LIVE,\n                             VIR_DOMAIN_AFFECT_CONFIG,\n                             error);\n\n    if (conn->driver->domainGetVcpuPinInfo) {\n        int ret;\n        ret = conn->driver->domainGetVcpuPinInfo(domain, ncpumaps,\n                                                 cpumaps, maplen, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "domain->conn"
          ],
          "line": 7346
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 7343
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainGetVcpuPinInfo",
          "args": [
            "domain",
            "ncpumaps",
            "cpumaps",
            "maplen",
            "flags"
          ],
          "line": 7336
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_EXCLUSIVE_FLAGS_GOTO",
          "args": [
            "VIR_DOMAIN_AFFECT_LIVE",
            "VIR_DOMAIN_AFFECT_CONFIG",
            "error"
          ],
          "line": 7330
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OVERFLOW",
            "_(\"input too large: %d * %d\")",
            "ncpumaps",
            "maplen"
          ],
          "line": 7325
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"input too large: %d * %d\""
          ],
          "line": 7325
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_INT_MULTIPLY_OVERFLOW",
          "args": [
            "ncpumaps",
            "maplen"
          ],
          "line": 7324
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckPositiveArgGoto",
          "args": [
            "maplen",
            "error"
          ],
          "line": 7322
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckPositiveArgGoto",
          "args": [
            "ncpumaps",
            "error"
          ],
          "line": 7321
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArrayArgGoto",
          "args": [
            "cpumaps",
            "ncpumaps",
            "error"
          ],
          "line": 7320
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "domain",
            "-1"
          ],
          "line": 7317
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 7315
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "domain",
            "\"ncpumaps=%d, cpumaps=%p, maplen=%d, flags=0x%x\"",
            "ncpumaps",
            "cpumaps",
            "maplen",
            "flags"
          ],
          "line": 7312
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainGetVcpuPinInfo(virDomainPtr domain, int ncpumaps,\n                        unsigned char *cpumaps, int maplen, unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"ncpumaps=%d, cpumaps=%p, maplen=%d, flags=0x%x\",\n                     ncpumaps, cpumaps, maplen, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    virCheckNonNullArrayArgGoto(cpumaps, ncpumaps, error);\n    virCheckPositiveArgGoto(ncpumaps, error);\n    virCheckPositiveArgGoto(maplen, error);\n\n    if (VIR_INT_MULTIPLY_OVERFLOW(ncpumaps, maplen)) {\n        virReportError(VIR_ERR_OVERFLOW, _(\"input too large: %d * %d\"),\n                       ncpumaps, maplen);\n        goto error;\n    }\n\n    VIR_EXCLUSIVE_FLAGS_GOTO(VIR_DOMAIN_AFFECT_LIVE,\n                             VIR_DOMAIN_AFFECT_CONFIG,\n                             error);\n\n    if (conn->driver->domainGetVcpuPinInfo) {\n        int ret;\n        ret = conn->driver->domainGetVcpuPinInfo(domain, ncpumaps,\n                                                 cpumaps, maplen, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainPinVcpuFlags",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "7248-7279",
    "snippet": "int\nvirDomainPinVcpuFlags(virDomainPtr domain, unsigned int vcpu,\n                      unsigned char *cpumap, int maplen, unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"vcpu=%u, cpumap=%p, maplen=%d, flags=0x%x\",\n                     vcpu, cpumap, maplen, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n    virCheckNonNullArgGoto(cpumap, error);\n    virCheckPositiveArgGoto(maplen, error);\n\n    if (conn->driver->domainPinVcpuFlags) {\n        int ret;\n        ret = conn->driver->domainPinVcpuFlags(domain, vcpu, cpumap, maplen, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "domain->conn"
          ],
          "line": 7277
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 7274
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainPinVcpuFlags",
          "args": [
            "domain",
            "vcpu",
            "cpumap",
            "maplen",
            "flags"
          ],
          "line": 7268
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckPositiveArgGoto",
          "args": [
            "maplen",
            "error"
          ],
          "line": 7264
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "cpumap",
            "error"
          ],
          "line": 7263
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "conn->flags",
            "error"
          ],
          "line": 7262
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "domain",
            "-1"
          ],
          "line": 7259
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 7257
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "domain",
            "\"vcpu=%u, cpumap=%p, maplen=%d, flags=0x%x\"",
            "vcpu",
            "cpumap",
            "maplen",
            "flags"
          ],
          "line": 7254
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainPinVcpuFlags(virDomainPtr domain, unsigned int vcpu,\n                      unsigned char *cpumap, int maplen, unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"vcpu=%u, cpumap=%p, maplen=%d, flags=0x%x\",\n                     vcpu, cpumap, maplen, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n    virCheckNonNullArgGoto(cpumap, error);\n    virCheckPositiveArgGoto(maplen, error);\n\n    if (conn->driver->domainPinVcpuFlags) {\n        int ret;\n        ret = conn->driver->domainPinVcpuFlags(domain, vcpu, cpumap, maplen, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainPinVcpu",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "7181-7212",
    "snippet": "int\nvirDomainPinVcpu(virDomainPtr domain, unsigned int vcpu,\n                 unsigned char *cpumap, int maplen)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"vcpu=%u, cpumap=%p, maplen=%d\",\n                     vcpu, cpumap, maplen);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n    virCheckNonNullArgGoto(cpumap, error);\n    virCheckPositiveArgGoto(maplen, error);\n\n    if (conn->driver->domainPinVcpu) {\n        int ret;\n        ret = conn->driver->domainPinVcpu(domain, vcpu, cpumap, maplen);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "domain->conn"
          ],
          "line": 7210
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 7207
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainPinVcpu",
          "args": [
            "domain",
            "vcpu",
            "cpumap",
            "maplen"
          ],
          "line": 7201
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckPositiveArgGoto",
          "args": [
            "maplen",
            "error"
          ],
          "line": 7197
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "cpumap",
            "error"
          ],
          "line": 7196
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "conn->flags",
            "error"
          ],
          "line": 7195
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "domain",
            "-1"
          ],
          "line": 7192
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 7190
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "domain",
            "\"vcpu=%u, cpumap=%p, maplen=%d\"",
            "vcpu",
            "cpumap",
            "maplen"
          ],
          "line": 7187
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainPinVcpu(virDomainPtr domain, unsigned int vcpu,\n                 unsigned char *cpumap, int maplen)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"vcpu=%u, cpumap=%p, maplen=%d\",\n                     vcpu, cpumap, maplen);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n    virCheckNonNullArgGoto(cpumap, error);\n    virCheckPositiveArgGoto(maplen, error);\n\n    if (conn->driver->domainPinVcpu) {\n        int ret;\n        ret = conn->driver->domainPinVcpu(domain, vcpu, cpumap, maplen);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainGetVcpusFlags",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "7125-7157",
    "snippet": "int\nvirDomainGetVcpusFlags(virDomainPtr domain, unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"flags=0x%x\", flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    if (flags & VIR_DOMAIN_VCPU_GUEST)\n        virCheckReadOnlyGoto(conn->flags, error);\n\n    VIR_EXCLUSIVE_FLAGS_GOTO(VIR_DOMAIN_AFFECT_LIVE,\n                             VIR_DOMAIN_AFFECT_CONFIG,\n                             error);\n\n    if (conn->driver->domainGetVcpusFlags) {\n        int ret;\n        ret = conn->driver->domainGetVcpusFlags(domain, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "domain->conn"
          ],
          "line": 7155
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 7152
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainGetVcpusFlags",
          "args": [
            "domain",
            "flags"
          ],
          "line": 7146
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_EXCLUSIVE_FLAGS_GOTO",
          "args": [
            "VIR_DOMAIN_AFFECT_LIVE",
            "VIR_DOMAIN_AFFECT_CONFIG",
            "error"
          ],
          "line": 7140
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "conn->flags",
            "error"
          ],
          "line": 7138
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "domain",
            "-1"
          ],
          "line": 7134
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 7132
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "domain",
            "\"flags=0x%x\"",
            "flags"
          ],
          "line": 7130
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainGetVcpusFlags(virDomainPtr domain, unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"flags=0x%x\", flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    if (flags & VIR_DOMAIN_VCPU_GUEST)\n        virCheckReadOnlyGoto(conn->flags, error);\n\n    VIR_EXCLUSIVE_FLAGS_GOTO(VIR_DOMAIN_AFFECT_LIVE,\n                             VIR_DOMAIN_AFFECT_CONFIG,\n                             error);\n\n    if (conn->driver->domainGetVcpusFlags) {\n        int ret;\n        ret = conn->driver->domainGetVcpusFlags(domain, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainSetVcpusFlags",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "7056-7094",
    "snippet": "int\nvirDomainSetVcpusFlags(virDomainPtr domain, unsigned int nvcpus,\n                       unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"nvcpus=%u, flags=0x%x\", nvcpus, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    virCheckReadOnlyGoto(domain->conn->flags, error);\n\n    VIR_REQUIRE_FLAG_GOTO(VIR_DOMAIN_VCPU_MAXIMUM,\n                          VIR_DOMAIN_AFFECT_CONFIG,\n                          error);\n\n    VIR_EXCLUSIVE_FLAGS_GOTO(VIR_DOMAIN_VCPU_GUEST,\n                             VIR_DOMAIN_AFFECT_CONFIG,\n                             error);\n\n    virCheckNonZeroArgGoto(nvcpus, error);\n\n    conn = domain->conn;\n\n    if (conn->driver->domainSetVcpusFlags) {\n        int ret;\n        ret = conn->driver->domainSetVcpusFlags(domain, nvcpus, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "domain->conn"
          ],
          "line": 7092
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 7089
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainSetVcpusFlags",
          "args": [
            "domain",
            "nvcpus",
            "flags"
          ],
          "line": 7083
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonZeroArgGoto",
          "args": [
            "nvcpus",
            "error"
          ],
          "line": 7077
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_EXCLUSIVE_FLAGS_GOTO",
          "args": [
            "VIR_DOMAIN_VCPU_GUEST",
            "VIR_DOMAIN_AFFECT_CONFIG",
            "error"
          ],
          "line": 7073
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_REQUIRE_FLAG_GOTO",
          "args": [
            "VIR_DOMAIN_VCPU_MAXIMUM",
            "VIR_DOMAIN_AFFECT_CONFIG",
            "error"
          ],
          "line": 7069
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "domain->conn->flags",
            "error"
          ],
          "line": 7067
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "domain",
            "-1"
          ],
          "line": 7066
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 7064
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "domain",
            "\"nvcpus=%u, flags=0x%x\"",
            "nvcpus",
            "flags"
          ],
          "line": 7062
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainSetVcpusFlags(virDomainPtr domain, unsigned int nvcpus,\n                       unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"nvcpus=%u, flags=0x%x\", nvcpus, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    virCheckReadOnlyGoto(domain->conn->flags, error);\n\n    VIR_REQUIRE_FLAG_GOTO(VIR_DOMAIN_VCPU_MAXIMUM,\n                          VIR_DOMAIN_AFFECT_CONFIG,\n                          error);\n\n    VIR_EXCLUSIVE_FLAGS_GOTO(VIR_DOMAIN_VCPU_GUEST,\n                             VIR_DOMAIN_AFFECT_CONFIG,\n                             error);\n\n    virCheckNonZeroArgGoto(nvcpus, error);\n\n    conn = domain->conn;\n\n    if (conn->driver->domainSetVcpusFlags) {\n        int ret;\n        ret = conn->driver->domainSetVcpusFlags(domain, nvcpus, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainSetVcpus",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "6985-7013",
    "snippet": "int\nvirDomainSetVcpus(virDomainPtr domain, unsigned int nvcpus)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"nvcpus=%u\", nvcpus);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n    virCheckNonZeroArgGoto(nvcpus, error);\n\n    if (conn->driver->domainSetVcpus) {\n        int ret;\n        ret = conn->driver->domainSetVcpus(domain, nvcpus);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "domain->conn"
          ],
          "line": 7011
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 7008
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainSetVcpus",
          "args": [
            "domain",
            "nvcpus"
          ],
          "line": 7002
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonZeroArgGoto",
          "args": [
            "nvcpus",
            "error"
          ],
          "line": 6998
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "conn->flags",
            "error"
          ],
          "line": 6997
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "domain",
            "-1"
          ],
          "line": 6994
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 6992
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "domain",
            "\"nvcpus=%u\"",
            "nvcpus"
          ],
          "line": 6990
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainSetVcpus(virDomainPtr domain, unsigned int nvcpus)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"nvcpus=%u\", nvcpus);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n    virCheckNonZeroArgGoto(nvcpus, error);\n\n    if (conn->driver->domainSetVcpus) {\n        int ret;\n        ret = conn->driver->domainSetVcpus(domain, nvcpus);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainSendProcessSignal",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "6928-6962",
    "snippet": "int\nvirDomainSendProcessSignal(virDomainPtr domain,\n                           long long pid_value,\n                           unsigned int signum,\n                           unsigned int flags)\n{\n    virConnectPtr conn;\n    VIR_DOMAIN_DEBUG(domain, \"pid=%lld, signum=%u flags=0x%x\",\n                     pid_value, signum, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    virCheckNonZeroArgGoto(pid_value, error);\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->driver->domainSendProcessSignal) {\n        int ret;\n        ret = conn->driver->domainSendProcessSignal(domain,\n                                                    pid_value,\n                                                    signum,\n                                                    flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "domain->conn"
          ],
          "line": 6960
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 6957
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainSendProcessSignal",
          "args": [
            "domain",
            "pid_value",
            "signum",
            "flags"
          ],
          "line": 6948
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "conn->flags",
            "error"
          ],
          "line": 6944
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonZeroArgGoto",
          "args": [
            "pid_value",
            "error"
          ],
          "line": 6943
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "domain",
            "-1"
          ],
          "line": 6940
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 6938
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "domain",
            "\"pid=%lld, signum=%u flags=0x%x\"",
            "pid_value",
            "signum",
            "flags"
          ],
          "line": 6935
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainSendProcessSignal(virDomainPtr domain,\n                           long long pid_value,\n                           unsigned int signum,\n                           unsigned int flags)\n{\n    virConnectPtr conn;\n    VIR_DOMAIN_DEBUG(domain, \"pid=%lld, signum=%u flags=0x%x\",\n                     pid_value, signum, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    virCheckNonZeroArgGoto(pid_value, error);\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->driver->domainSendProcessSignal) {\n        int ret;\n        ret = conn->driver->domainSendProcessSignal(domain,\n                                                    pid_value,\n                                                    signum,\n                                                    flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainSendKey",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "6843-6892",
    "snippet": "int\nvirDomainSendKey(virDomainPtr domain,\n                 unsigned int codeset,\n                 unsigned int holdtime,\n                 unsigned int *keycodes,\n                 int nkeycodes,\n                 unsigned int flags)\n{\n    virConnectPtr conn;\n    VIR_DOMAIN_DEBUG(domain, \"codeset=%u, holdtime=%u, nkeycodes=%u, flags=0x%x\",\n                     codeset, holdtime, nkeycodes, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n    virCheckNonNullArgGoto(keycodes, error);\n    virCheckPositiveArgGoto(nkeycodes, error);\n\n    if (codeset >= VIR_KEYCODE_SET_LAST) {\n        virReportInvalidArg(codeset,\n                            _(\"Unsupported codeset '%d'\"),\n                            codeset);\n        goto error;\n    }\n\n    if (nkeycodes > VIR_DOMAIN_SEND_KEY_MAX_KEYS) {\n        virReportInvalidArg(nkeycodes,\n                            _(\"nkeycodes must be <= %d\"),\n                            VIR_DOMAIN_SEND_KEY_MAX_KEYS);\n        goto error;\n    }\n\n    if (conn->driver->domainSendKey) {\n        int ret;\n        ret = conn->driver->domainSendKey(domain, codeset, holdtime,\n                                          keycodes, nkeycodes, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "domain->conn"
          ],
          "line": 6890
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 6887
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainSendKey",
          "args": [
            "domain",
            "codeset",
            "holdtime",
            "keycodes",
            "nkeycodes",
            "flags"
          ],
          "line": 6880
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportInvalidArg",
          "args": [
            "nkeycodes",
            "_(\"nkeycodes must be <= %d\")",
            "VIR_DOMAIN_SEND_KEY_MAX_KEYS"
          ],
          "line": 6872
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"nkeycodes must be <= %d\""
          ],
          "line": 6873
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportInvalidArg",
          "args": [
            "codeset",
            "_(\"Unsupported codeset '%d'\")",
            "codeset"
          ],
          "line": 6865
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckPositiveArgGoto",
          "args": [
            "nkeycodes",
            "error"
          ],
          "line": 6862
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "keycodes",
            "error"
          ],
          "line": 6861
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "conn->flags",
            "error"
          ],
          "line": 6860
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "domain",
            "-1"
          ],
          "line": 6857
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 6855
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "domain",
            "\"codeset=%u, holdtime=%u, nkeycodes=%u, flags=0x%x\"",
            "codeset",
            "holdtime",
            "nkeycodes",
            "flags"
          ],
          "line": 6852
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainSendKey(virDomainPtr domain,\n                 unsigned int codeset,\n                 unsigned int holdtime,\n                 unsigned int *keycodes,\n                 int nkeycodes,\n                 unsigned int flags)\n{\n    virConnectPtr conn;\n    VIR_DOMAIN_DEBUG(domain, \"codeset=%u, holdtime=%u, nkeycodes=%u, flags=0x%x\",\n                     codeset, holdtime, nkeycodes, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n    virCheckNonNullArgGoto(keycodes, error);\n    virCheckPositiveArgGoto(nkeycodes, error);\n\n    if (codeset >= VIR_KEYCODE_SET_LAST) {\n        virReportInvalidArg(codeset,\n                            _(\"Unsupported codeset '%d'\"),\n                            codeset);\n        goto error;\n    }\n\n    if (nkeycodes > VIR_DOMAIN_SEND_KEY_MAX_KEYS) {\n        virReportInvalidArg(nkeycodes,\n                            _(\"nkeycodes must be <= %d\"),\n                            VIR_DOMAIN_SEND_KEY_MAX_KEYS);\n        goto error;\n    }\n\n    if (conn->driver->domainSendKey) {\n        int ret;\n        ret = conn->driver->domainSendKey(domain, codeset, holdtime,\n                                          keycodes, nkeycodes, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainInjectNMI",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "6801-6827",
    "snippet": "int\nvirDomainInjectNMI(virDomainPtr domain, unsigned int flags)\n{\n    virConnectPtr conn;\n    VIR_DOMAIN_DEBUG(domain, \"flags=0x%x\", flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->driver->domainInjectNMI) {\n        int ret;\n        ret = conn->driver->domainInjectNMI(domain, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "domain->conn"
          ],
          "line": 6825
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 6822
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainInjectNMI",
          "args": [
            "domain",
            "flags"
          ],
          "line": 6816
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "conn->flags",
            "error"
          ],
          "line": 6812
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "domain",
            "-1"
          ],
          "line": 6809
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 6807
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "domain",
            "\"flags=0x%x\"",
            "flags"
          ],
          "line": 6805
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainInjectNMI(virDomainPtr domain, unsigned int flags)\n{\n    virConnectPtr conn;\n    VIR_DOMAIN_DEBUG(domain, \"flags=0x%x\", flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->driver->domainInjectNMI) {\n        int ret;\n        ret = conn->driver->domainInjectNMI(domain, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainSetAutostart",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "6761-6789",
    "snippet": "int\nvirDomainSetAutostart(virDomainPtr domain,\n                      int autostart)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"autostart=%d\", autostart);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->driver->domainSetAutostart) {\n        int ret;\n        ret = conn->driver->domainSetAutostart(domain, autostart);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "domain->conn"
          ],
          "line": 6787
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 6784
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainSetAutostart",
          "args": [
            "domain",
            "autostart"
          ],
          "line": 6778
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "conn->flags",
            "error"
          ],
          "line": 6774
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "domain",
            "-1"
          ],
          "line": 6771
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 6769
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "domain",
            "\"autostart=%d\"",
            "autostart"
          ],
          "line": 6767
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainSetAutostart(virDomainPtr domain,\n                      int autostart)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"autostart=%d\", autostart);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->driver->domainSetAutostart) {\n        int ret;\n        ret = conn->driver->domainSetAutostart(domain, autostart);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainGetAutostart",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "6720-6748",
    "snippet": "int\nvirDomainGetAutostart(virDomainPtr domain,\n                      int *autostart)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"autostart=%p\", autostart);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    virCheckNonNullArgGoto(autostart, error);\n\n    conn = domain->conn;\n\n    if (conn->driver->domainGetAutostart) {\n        int ret;\n        ret = conn->driver->domainGetAutostart(domain, autostart);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "domain->conn"
          ],
          "line": 6746
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 6743
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainGetAutostart",
          "args": [
            "domain",
            "autostart"
          ],
          "line": 6737
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "autostart",
            "error"
          ],
          "line": 6731
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "domain",
            "-1"
          ],
          "line": 6730
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 6728
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "domain",
            "\"autostart=%p\"",
            "autostart"
          ],
          "line": 6726
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainGetAutostart(virDomainPtr domain,\n                      int *autostart)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"autostart=%p\", autostart);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    virCheckNonNullArgGoto(autostart, error);\n\n    conn = domain->conn;\n\n    if (conn->driver->domainGetAutostart) {\n        int ret;\n        ret = conn->driver->domainGetAutostart(domain, autostart);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainCreateWithFiles",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "6675-6706",
    "snippet": "int\nvirDomainCreateWithFiles(virDomainPtr domain, unsigned int nfiles,\n                         int *files, unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"nfiles=%u, files=%p, flags=0x%x\",\n                     nfiles, files, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->driver->domainCreateWithFiles) {\n        int ret;\n        ret = conn->driver->domainCreateWithFiles(domain,\n                                                  nfiles, files,\n                                                  flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "domain->conn"
          ],
          "line": 6704
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 6701
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainCreateWithFiles",
          "args": [
            "domain",
            "nfiles",
            "files",
            "flags"
          ],
          "line": 6693
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "conn->flags",
            "error"
          ],
          "line": 6689
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "domain",
            "-1"
          ],
          "line": 6686
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 6684
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "domain",
            "\"nfiles=%u, files=%p, flags=0x%x\"",
            "nfiles",
            "files",
            "flags"
          ],
          "line": 6681
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainCreateWithFiles(virDomainPtr domain, unsigned int nfiles,\n                         int *files, unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"nfiles=%u, files=%p, flags=0x%x\",\n                     nfiles, files, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->driver->domainCreateWithFiles) {\n        int ret;\n        ret = conn->driver->domainCreateWithFiles(domain,\n                                                  nfiles, files,\n                                                  flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainCreateWithFlags",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "6603-6630",
    "snippet": "int\nvirDomainCreateWithFlags(virDomainPtr domain, unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"flags=0x%x\", flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->driver->domainCreateWithFlags) {\n        int ret;\n        ret = conn->driver->domainCreateWithFlags(domain, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "domain->conn"
          ],
          "line": 6628
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 6625
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainCreateWithFlags",
          "args": [
            "domain",
            "flags"
          ],
          "line": 6619
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "conn->flags",
            "error"
          ],
          "line": 6615
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "domain",
            "-1"
          ],
          "line": 6612
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 6610
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "domain",
            "\"flags=0x%x\"",
            "flags"
          ],
          "line": 6608
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainCreateWithFlags(virDomainPtr domain, unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"flags=0x%x\", flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->driver->domainCreateWithFlags) {\n        int ret;\n        ret = conn->driver->domainCreateWithFlags(domain, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainCreate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "6539-6566",
    "snippet": "int\nvirDomainCreate(virDomainPtr domain)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->driver->domainCreate) {\n        int ret;\n        ret = conn->driver->domainCreate(domain);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "domain->conn"
          ],
          "line": 6564
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 6561
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainCreate",
          "args": [
            "domain"
          ],
          "line": 6555
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "conn->flags",
            "error"
          ],
          "line": 6551
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "domain",
            "-1"
          ],
          "line": 6548
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 6546
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "domain"
          ],
          "line": 6544
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainCreate(virDomainPtr domain)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->driver->domainCreate) {\n        int ret;\n        ret = conn->driver->domainCreate(domain);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virConnectListAllDomains",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "6498-6525",
    "snippet": "int\nvirConnectListAllDomains(virConnectPtr conn,\n                         virDomainPtr **domains,\n                         unsigned int flags)\n{\n    VIR_DEBUG(\"conn=%p, domains=%p, flags=0x%x\", conn, domains, flags);\n\n    virResetLastError();\n\n    if (domains)\n        *domains = NULL;\n\n    virCheckConnectReturn(conn, -1);\n\n    if (conn->driver->connectListAllDomains) {\n        int ret;\n        ret = conn->driver->connectListAllDomains(conn, domains, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "conn"
          ],
          "line": 6523
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 6520
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->connectListAllDomains",
          "args": [
            "conn",
            "domains",
            "flags"
          ],
          "line": 6514
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckConnectReturn",
          "args": [
            "conn",
            "-1"
          ],
          "line": 6510
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 6505
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"conn=%p, domains=%p, flags=0x%x\"",
            "conn",
            "domains",
            "flags"
          ],
          "line": 6503
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirConnectListAllDomains(virConnectPtr conn,\n                         virDomainPtr **domains,\n                         unsigned int flags)\n{\n    VIR_DEBUG(\"conn=%p, domains=%p, flags=0x%x\", conn, domains, flags);\n\n    virResetLastError();\n\n    if (domains)\n        *domains = NULL;\n\n    virCheckConnectReturn(conn, -1);\n\n    if (conn->driver->connectListAllDomains) {\n        int ret;\n        ret = conn->driver->connectListAllDomains(conn, domains, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return -1;\n}"
  },
  {
    "function_name": "virConnectListDefinedDomains",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "6399-6424",
    "snippet": "int\nvirConnectListDefinedDomains(virConnectPtr conn, char **const names,\n                             int maxnames)\n{\n    VIR_DEBUG(\"conn=%p, names=%p, maxnames=%d\", conn, names, maxnames);\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, -1);\n    virCheckNonNullArrayArgGoto(names, maxnames, error);\n    virCheckNonNegativeArgGoto(maxnames, error);\n\n    if (conn->driver->connectListDefinedDomains) {\n        int ret;\n        ret = conn->driver->connectListDefinedDomains(conn, names, maxnames);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "conn"
          ],
          "line": 6422
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 6419
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->connectListDefinedDomains",
          "args": [
            "conn",
            "names",
            "maxnames"
          ],
          "line": 6413
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNegativeArgGoto",
          "args": [
            "maxnames",
            "error"
          ],
          "line": 6409
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArrayArgGoto",
          "args": [
            "names",
            "maxnames",
            "error"
          ],
          "line": 6408
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckConnectReturn",
          "args": [
            "conn",
            "-1"
          ],
          "line": 6407
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 6405
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"conn=%p, names=%p, maxnames=%d\"",
            "conn",
            "names",
            "maxnames"
          ],
          "line": 6403
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirConnectListDefinedDomains(virConnectPtr conn, char **const names,\n                             int maxnames)\n{\n    VIR_DEBUG(\"conn=%p, names=%p, maxnames=%d\", conn, names, maxnames);\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, -1);\n    virCheckNonNullArrayArgGoto(names, maxnames, error);\n    virCheckNonNegativeArgGoto(maxnames, error);\n\n    if (conn->driver->connectListDefinedDomains) {\n        int ret;\n        ret = conn->driver->connectListDefinedDomains(conn, names, maxnames);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return -1;\n}"
  },
  {
    "function_name": "virConnectNumOfDefinedDomains",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "6356-6378",
    "snippet": "int\nvirConnectNumOfDefinedDomains(virConnectPtr conn)\n{\n    VIR_DEBUG(\"conn=%p\", conn);\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, -1);\n\n    if (conn->driver->connectNumOfDefinedDomains) {\n        int ret;\n        ret = conn->driver->connectNumOfDefinedDomains(conn);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "conn"
          ],
          "line": 6376
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 6373
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->connectNumOfDefinedDomains",
          "args": [
            "conn"
          ],
          "line": 6367
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckConnectReturn",
          "args": [
            "conn",
            "-1"
          ],
          "line": 6363
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 6361
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"conn=%p\"",
            "conn"
          ],
          "line": 6359
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirConnectNumOfDefinedDomains(virConnectPtr conn)\n{\n    VIR_DEBUG(\"conn=%p\", conn);\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, -1);\n\n    if (conn->driver->connectNumOfDefinedDomains) {\n        int ret;\n        ret = conn->driver->connectNumOfDefinedDomains(conn);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainUndefineFlags",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "6317-6345",
    "snippet": "int\nvirDomainUndefineFlags(virDomainPtr domain,\n                       unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"flags=0x%x\", flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->driver->domainUndefineFlags) {\n        int ret;\n        ret = conn->driver->domainUndefineFlags(domain, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "domain->conn"
          ],
          "line": 6343
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 6340
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainUndefineFlags",
          "args": [
            "domain",
            "flags"
          ],
          "line": 6334
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "conn->flags",
            "error"
          ],
          "line": 6330
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "domain",
            "-1"
          ],
          "line": 6327
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 6325
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "domain",
            "\"flags=0x%x\"",
            "flags"
          ],
          "line": 6323
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainUndefineFlags(virDomainPtr domain,\n                       unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"flags=0x%x\", flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->driver->domainUndefineFlags) {\n        int ret;\n        ret = conn->driver->domainUndefineFlags(domain, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainUndefine",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "6248-6275",
    "snippet": "int\nvirDomainUndefine(virDomainPtr domain)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->driver->domainUndefine) {\n        int ret;\n        ret = conn->driver->domainUndefine(domain);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "domain->conn"
          ],
          "line": 6273
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 6270
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainUndefine",
          "args": [
            "domain"
          ],
          "line": 6264
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "conn->flags",
            "error"
          ],
          "line": 6260
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "domain",
            "-1"
          ],
          "line": 6257
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 6255
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "domain"
          ],
          "line": 6253
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainUndefine(virDomainPtr domain)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->driver->domainUndefine) {\n        int ret;\n        ret = conn->driver->domainUndefine(domain);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainDefineXMLFlags",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "6205-6229",
    "snippet": "virDomainPtr\nvirDomainDefineXMLFlags(virConnectPtr conn, const char *xml, unsigned int flags)\n{\n    VIR_DEBUG(\"conn=%p, xml=%s flags=0x%x\", conn, NULLSTR(xml), flags);\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, NULL);\n    virCheckReadOnlyGoto(conn->flags, error);\n    virCheckNonNullArgGoto(xml, error);\n\n    if (conn->driver->domainDefineXMLFlags) {\n        virDomainPtr ret;\n        ret = conn->driver->domainDefineXMLFlags(conn, xml, flags);\n        if (!ret)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return NULL;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "conn"
          ],
          "line": 6227
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 6224
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainDefineXMLFlags",
          "args": [
            "conn",
            "xml",
            "flags"
          ],
          "line": 6218
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "xml",
            "error"
          ],
          "line": 6214
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "conn->flags",
            "error"
          ],
          "line": 6213
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckConnectReturn",
          "args": [
            "conn",
            "NULL"
          ],
          "line": 6212
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 6210
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"conn=%p, xml=%s flags=0x%x\"",
            "conn",
            "NULLSTR(xml)",
            "flags"
          ],
          "line": 6208
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "xml"
          ],
          "line": 6208
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nvirDomainPtr\nvirDomainDefineXMLFlags(virConnectPtr conn, const char *xml, unsigned int flags)\n{\n    VIR_DEBUG(\"conn=%p, xml=%s flags=0x%x\", conn, NULLSTR(xml), flags);\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, NULL);\n    virCheckReadOnlyGoto(conn->flags, error);\n    virCheckNonNullArgGoto(xml, error);\n\n    if (conn->driver->domainDefineXMLFlags) {\n        virDomainPtr ret;\n        ret = conn->driver->domainDefineXMLFlags(conn, xml, flags);\n        if (!ret)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return NULL;\n}"
  },
  {
    "function_name": "virDomainDefineXML",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "6162-6186",
    "snippet": "virDomainPtr\nvirDomainDefineXML(virConnectPtr conn, const char *xml)\n{\n    VIR_DEBUG(\"conn=%p, xml=%s\", conn, NULLSTR(xml));\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, NULL);\n    virCheckReadOnlyGoto(conn->flags, error);\n    virCheckNonNullArgGoto(xml, error);\n\n    if (conn->driver->domainDefineXML) {\n        virDomainPtr ret;\n        ret = conn->driver->domainDefineXML(conn, xml);\n        if (!ret)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return NULL;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "conn"
          ],
          "line": 6184
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 6181
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainDefineXML",
          "args": [
            "conn",
            "xml"
          ],
          "line": 6175
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "xml",
            "error"
          ],
          "line": 6171
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "conn->flags",
            "error"
          ],
          "line": 6170
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckConnectReturn",
          "args": [
            "conn",
            "NULL"
          ],
          "line": 6169
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 6167
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"conn=%p, xml=%s\"",
            "conn",
            "NULLSTR(xml)"
          ],
          "line": 6165
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "xml"
          ],
          "line": 6165
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nvirDomainPtr\nvirDomainDefineXML(virConnectPtr conn, const char *xml)\n{\n    VIR_DEBUG(\"conn=%p, xml=%s\", conn, NULLSTR(xml));\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, NULL);\n    virCheckReadOnlyGoto(conn->flags, error);\n    virCheckNonNullArgGoto(xml, error);\n\n    if (conn->driver->domainDefineXML) {\n        virDomainPtr ret;\n        ret = conn->driver->domainDefineXML(conn, xml);\n        if (!ret)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return NULL;\n}"
  },
  {
    "function_name": "virDomainGetBlockInfo",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "6112-6144",
    "snippet": "int\nvirDomainGetBlockInfo(virDomainPtr domain, const char *disk,\n                      virDomainBlockInfoPtr info, unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"info=%p, flags=0x%x\", info, flags);\n\n    virResetLastError();\n\n    if (info)\n        memset(info, 0, sizeof(*info));\n\n    virCheckDomainReturn(domain, -1);\n    virCheckNonEmptyStringArgGoto(disk, error);\n    virCheckNonNullArgGoto(info, error);\n\n    conn = domain->conn;\n\n    if (conn->driver->domainGetBlockInfo) {\n        int ret;\n        ret = conn->driver->domainGetBlockInfo(domain, disk, info, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "domain->conn"
          ],
          "line": 6142
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 6139
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainGetBlockInfo",
          "args": [
            "domain",
            "disk",
            "info",
            "flags"
          ],
          "line": 6133
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "info",
            "error"
          ],
          "line": 6127
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonEmptyStringArgGoto",
          "args": [
            "disk",
            "error"
          ],
          "line": 6126
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "domain",
            "-1"
          ],
          "line": 6125
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "info",
            "0",
            "sizeof(*info)"
          ],
          "line": 6123
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 6120
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "domain",
            "\"info=%p, flags=0x%x\"",
            "info",
            "flags"
          ],
          "line": 6118
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainGetBlockInfo(virDomainPtr domain, const char *disk,\n                      virDomainBlockInfoPtr info, unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"info=%p, flags=0x%x\", info, flags);\n\n    virResetLastError();\n\n    if (info)\n        memset(info, 0, sizeof(*info));\n\n    virCheckDomainReturn(domain, -1);\n    virCheckNonEmptyStringArgGoto(disk, error);\n    virCheckNonNullArgGoto(info, error);\n\n    conn = domain->conn;\n\n    if (conn->driver->domainGetBlockInfo) {\n        int ret;\n        ret = conn->driver->domainGetBlockInfo(domain, disk, info, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainMemoryPeek",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "5976-6038",
    "snippet": "int\nvirDomainMemoryPeek(virDomainPtr dom,\n                    unsigned long long start,\n                    size_t size,\n                    void *buffer,\n                    unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(dom, \"start=%lld, size=%zi, buffer=%p, flags=0x%x\",\n                     start, size, buffer, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(dom, -1);\n    conn = dom->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    /* Note on access to physical memory: A VIR_MEMORY_PHYSICAL flag is\n     * a possibility.  However it isn't really useful unless the caller\n     * can also access registers, particularly CR3 on x86 in order to\n     * get the Page Table Directory.  Since registers are different on\n     * every architecture, that would imply another call to get the\n     * machine registers.\n     *\n     * The QEMU driver handles VIR_MEMORY_VIRTUAL, mapping it\n     * to the qemu 'memsave' command which does the virtual to physical\n     * mapping inside qemu.\n     *\n     * The QEMU driver also handles VIR_MEMORY_PHYSICAL, mapping it\n     * to the qemu 'pmemsave' command.\n     *\n     * At time of writing there is no Xen driver.  However the Xen\n     * hypervisor only lets you map physical pages from other domains,\n     * and so the Xen driver would have to do the virtual to physical\n     * mapping by chasing 2, 3 or 4-level page tables from the PTD.\n     * There is example code in libxc (xc_translate_foreign_address)\n     * which does this, although we cannot copy this code directly\n     * because of incompatible licensing.\n     */\n\n    VIR_EXCLUSIVE_FLAGS_GOTO(VIR_MEMORY_VIRTUAL, VIR_MEMORY_PHYSICAL, error);\n\n    /* Allow size == 0 as an access test. */\n    if (size > 0)\n        virCheckNonNullArgGoto(buffer, error);\n\n    if (conn->driver->domainMemoryPeek) {\n        int ret;\n        ret = conn->driver->domainMemoryPeek(dom, start, size,\n                                             buffer, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(dom->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "dom->conn"
          ],
          "line": 6036
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 6033
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainMemoryPeek",
          "args": [
            "dom",
            "start",
            "size",
            "buffer",
            "flags"
          ],
          "line": 6026
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "buffer",
            "error"
          ],
          "line": 6022
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_EXCLUSIVE_FLAGS_GOTO",
          "args": [
            "VIR_MEMORY_VIRTUAL",
            "VIR_MEMORY_PHYSICAL",
            "error"
          ],
          "line": 6018
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "conn->flags",
            "error"
          ],
          "line": 5993
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "dom",
            "-1"
          ],
          "line": 5990
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 5988
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "dom",
            "\"start=%lld, size=%zi, buffer=%p, flags=0x%x\"",
            "start",
            "size",
            "buffer",
            "flags"
          ],
          "line": 5985
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainMemoryPeek(virDomainPtr dom,\n                    unsigned long long start,\n                    size_t size,\n                    void *buffer,\n                    unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(dom, \"start=%lld, size=%zi, buffer=%p, flags=0x%x\",\n                     start, size, buffer, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(dom, -1);\n    conn = dom->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    /* Note on access to physical memory: A VIR_MEMORY_PHYSICAL flag is\n     * a possibility.  However it isn't really useful unless the caller\n     * can also access registers, particularly CR3 on x86 in order to\n     * get the Page Table Directory.  Since registers are different on\n     * every architecture, that would imply another call to get the\n     * machine registers.\n     *\n     * The QEMU driver handles VIR_MEMORY_VIRTUAL, mapping it\n     * to the qemu 'memsave' command which does the virtual to physical\n     * mapping inside qemu.\n     *\n     * The QEMU driver also handles VIR_MEMORY_PHYSICAL, mapping it\n     * to the qemu 'pmemsave' command.\n     *\n     * At time of writing there is no Xen driver.  However the Xen\n     * hypervisor only lets you map physical pages from other domains,\n     * and so the Xen driver would have to do the virtual to physical\n     * mapping by chasing 2, 3 or 4-level page tables from the PTD.\n     * There is example code in libxc (xc_translate_foreign_address)\n     * which does this, although we cannot copy this code directly\n     * because of incompatible licensing.\n     */\n\n    VIR_EXCLUSIVE_FLAGS_GOTO(VIR_MEMORY_VIRTUAL, VIR_MEMORY_PHYSICAL, error);\n\n    /* Allow size == 0 as an access test. */\n    if (size > 0)\n        virCheckNonNullArgGoto(buffer, error);\n\n    if (conn->driver->domainMemoryPeek) {\n        int ret;\n        ret = conn->driver->domainMemoryPeek(dom, start, size,\n                                             buffer, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(dom->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainBlockResize",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "5908-5939",
    "snippet": "int\nvirDomainBlockResize(virDomainPtr dom,\n                     const char *disk,\n                     unsigned long long size,\n                     unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(dom, \"disk=%s, size=%llu, flags=0x%x\", disk, size, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(dom, -1);\n    conn = dom->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n    virCheckNonNullArgGoto(disk, error);\n\n    if (conn->driver->domainBlockResize) {\n        int ret;\n        ret = conn->driver->domainBlockResize(dom, disk, size, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(dom->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "dom->conn"
          ],
          "line": 5937
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 5934
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainBlockResize",
          "args": [
            "dom",
            "disk",
            "size",
            "flags"
          ],
          "line": 5928
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "disk",
            "error"
          ],
          "line": 5924
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "conn->flags",
            "error"
          ],
          "line": 5923
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "dom",
            "-1"
          ],
          "line": 5920
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 5918
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "dom",
            "\"disk=%s, size=%llu, flags=0x%x\"",
            "disk",
            "size",
            "flags"
          ],
          "line": 5916
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainBlockResize(virDomainPtr dom,\n                     const char *disk,\n                     unsigned long long size,\n                     unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(dom, \"disk=%s, size=%llu, flags=0x%x\", disk, size, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(dom, -1);\n    conn = dom->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n    virCheckNonNullArgGoto(disk, error);\n\n    if (conn->driver->domainBlockResize) {\n        int ret;\n        ret = conn->driver->domainBlockResize(dom, disk, size, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(dom->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainBlockPeek",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "5839-5878",
    "snippet": "int\nvirDomainBlockPeek(virDomainPtr dom,\n                   const char *disk,\n                   unsigned long long offset,\n                   size_t size,\n                   void *buffer,\n                   unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(dom, \"disk=%s, offset=%lld, size=%zi, buffer=%p, flags=0x%x\",\n                     disk, offset, size, buffer, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(dom, -1);\n    conn = dom->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n    virCheckNonEmptyStringArgGoto(disk, error);\n\n    /* Allow size == 0 as an access test. */\n    if (size > 0)\n        virCheckNonNullArgGoto(buffer, error);\n\n    if (conn->driver->domainBlockPeek) {\n        int ret;\n        ret = conn->driver->domainBlockPeek(dom, disk, offset, size,\n                                            buffer, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(dom->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "dom->conn"
          ],
          "line": 5876
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 5873
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainBlockPeek",
          "args": [
            "dom",
            "disk",
            "offset",
            "size",
            "buffer",
            "flags"
          ],
          "line": 5866
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "buffer",
            "error"
          ],
          "line": 5862
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonEmptyStringArgGoto",
          "args": [
            "disk",
            "error"
          ],
          "line": 5858
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "conn->flags",
            "error"
          ],
          "line": 5857
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "dom",
            "-1"
          ],
          "line": 5854
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 5852
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "dom",
            "\"disk=%s, offset=%lld, size=%zi, buffer=%p, flags=0x%x\"",
            "disk",
            "offset",
            "size",
            "buffer",
            "flags"
          ],
          "line": 5849
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainBlockPeek(virDomainPtr dom,\n                   const char *disk,\n                   unsigned long long offset,\n                   size_t size,\n                   void *buffer,\n                   unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(dom, \"disk=%s, offset=%lld, size=%zi, buffer=%p, flags=0x%x\",\n                     disk, offset, size, buffer, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(dom, -1);\n    conn = dom->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n    virCheckNonEmptyStringArgGoto(disk, error);\n\n    /* Allow size == 0 as an access test. */\n    if (size > 0)\n        virCheckNonNullArgGoto(buffer, error);\n\n    if (conn->driver->domainBlockPeek) {\n        int ret;\n        ret = conn->driver->domainBlockPeek(dom, disk, offset, size,\n                                            buffer, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(dom->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainMemoryStats",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "5758-5792",
    "snippet": "int\nvirDomainMemoryStats(virDomainPtr dom, virDomainMemoryStatPtr stats,\n                     unsigned int nr_stats, unsigned int flags)\n{\n    virConnectPtr conn;\n    unsigned long nr_stats_ret = 0;\n\n    VIR_DOMAIN_DEBUG(dom, \"stats=%p, nr_stats=%u, flags=0x%x\",\n                     stats, nr_stats, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(dom, -1);\n\n    if (!stats || nr_stats == 0)\n        return 0;\n\n    if (nr_stats > VIR_DOMAIN_MEMORY_STAT_NR)\n        nr_stats = VIR_DOMAIN_MEMORY_STAT_NR;\n\n    conn = dom->conn;\n    if (conn->driver->domainMemoryStats) {\n        nr_stats_ret = conn->driver->domainMemoryStats(dom, stats, nr_stats,\n                                                       flags);\n        if (nr_stats_ret == -1)\n            goto error;\n        return nr_stats_ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(dom->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "dom->conn"
          ],
          "line": 5790
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 5787
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainMemoryStats",
          "args": [
            "dom",
            "stats",
            "nr_stats",
            "flags"
          ],
          "line": 5780
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "dom",
            "-1"
          ],
          "line": 5770
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 5768
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "dom",
            "\"stats=%p, nr_stats=%u, flags=0x%x\"",
            "stats",
            "nr_stats",
            "flags"
          ],
          "line": 5765
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainMemoryStats(virDomainPtr dom, virDomainMemoryStatPtr stats,\n                     unsigned int nr_stats, unsigned int flags)\n{\n    virConnectPtr conn;\n    unsigned long nr_stats_ret = 0;\n\n    VIR_DOMAIN_DEBUG(dom, \"stats=%p, nr_stats=%u, flags=0x%x\",\n                     stats, nr_stats, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(dom, -1);\n\n    if (!stats || nr_stats == 0)\n        return 0;\n\n    if (nr_stats > VIR_DOMAIN_MEMORY_STAT_NR)\n        nr_stats = VIR_DOMAIN_MEMORY_STAT_NR;\n\n    conn = dom->conn;\n    if (conn->driver->domainMemoryStats) {\n        nr_stats_ret = conn->driver->domainMemoryStats(dom, stats, nr_stats,\n                                                       flags);\n        if (nr_stats_ret == -1)\n            goto error;\n        return nr_stats_ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(dom->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainGetInterfaceParameters",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "5672-5711",
    "snippet": "int\nvirDomainGetInterfaceParameters(virDomainPtr domain,\n                                const char *device,\n                                virTypedParameterPtr params,\n                                int *nparams, unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"device=%s, params=%p, nparams=%d, flags=0x%x\",\n                     device, params, (nparams) ? *nparams : -1, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    virCheckNonNullArgGoto(nparams, error);\n    virCheckNonNegativeArgGoto(*nparams, error);\n    if (*nparams != 0)\n        virCheckNonNullArgGoto(params, error);\n\n    if (VIR_DRV_SUPPORTS_FEATURE(domain->conn->driver, domain->conn,\n                                 VIR_DRV_FEATURE_TYPED_PARAM_STRING))\n        flags |= VIR_TYPED_PARAM_STRING_OKAY;\n\n    conn = domain->conn;\n\n    if (conn->driver->domainGetInterfaceParameters) {\n        int ret;\n        ret = conn->driver->domainGetInterfaceParameters(domain, device,\n                                                         params, nparams,\n                                                         flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "domain->conn"
          ],
          "line": 5709
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 5706
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainGetInterfaceParameters",
          "args": [
            "domain",
            "device",
            "params",
            "nparams",
            "flags"
          ],
          "line": 5699
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DRV_SUPPORTS_FEATURE",
          "args": [
            "domain->conn->driver",
            "domain->conn",
            "VIR_DRV_FEATURE_TYPED_PARAM_STRING"
          ],
          "line": 5691
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "params",
            "error"
          ],
          "line": 5689
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNegativeArgGoto",
          "args": [
            "*nparams",
            "error"
          ],
          "line": 5687
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "nparams",
            "error"
          ],
          "line": 5686
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "domain",
            "-1"
          ],
          "line": 5685
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 5683
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "domain",
            "\"device=%s, params=%p, nparams=%d, flags=0x%x\"",
            "device",
            "params",
            "(nparams) ? *nparams : -1",
            "flags"
          ],
          "line": 5680
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainGetInterfaceParameters(virDomainPtr domain,\n                                const char *device,\n                                virTypedParameterPtr params,\n                                int *nparams, unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"device=%s, params=%p, nparams=%d, flags=0x%x\",\n                     device, params, (nparams) ? *nparams : -1, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    virCheckNonNullArgGoto(nparams, error);\n    virCheckNonNegativeArgGoto(*nparams, error);\n    if (*nparams != 0)\n        virCheckNonNullArgGoto(params, error);\n\n    if (VIR_DRV_SUPPORTS_FEATURE(domain->conn->driver, domain->conn,\n                                 VIR_DRV_FEATURE_TYPED_PARAM_STRING))\n        flags |= VIR_TYPED_PARAM_STRING_OKAY;\n\n    conn = domain->conn;\n\n    if (conn->driver->domainGetInterfaceParameters) {\n        int ret;\n        ret = conn->driver->domainGetInterfaceParameters(domain, device,\n                                                         params, nparams,\n                                                         flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainSetInterfaceParameters",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "5604-5643",
    "snippet": "int\nvirDomainSetInterfaceParameters(virDomainPtr domain,\n                                const char *device,\n                                virTypedParameterPtr params,\n                                int nparams, unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"device=%s, params=%p, nparams=%d, flags=0x%x\",\n                     device, params, nparams, flags);\n    VIR_TYPED_PARAMS_DEBUG(params, nparams);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n    virCheckNonNullArgGoto(params, error);\n    virCheckPositiveArgGoto(nparams, error);\n\n    if (virTypedParameterValidateSet(conn, params, nparams) < 0)\n        goto error;\n\n    if (conn->driver->domainSetInterfaceParameters) {\n        int ret;\n        ret = conn->driver->domainSetInterfaceParameters(domain, device,\n                                                         params, nparams,\n                                                         flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "domain->conn"
          ],
          "line": 5641
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 5638
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainSetInterfaceParameters",
          "args": [
            "domain",
            "device",
            "params",
            "nparams",
            "flags"
          ],
          "line": 5630
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virTypedParameterValidateSet",
          "args": [
            "conn",
            "params",
            "nparams"
          ],
          "line": 5625
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParameterValidateSet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt.c",
          "lines": "1288-1325",
          "snippet": "int\nvirTypedParameterValidateSet(virConnectPtr conn,\n                             virTypedParameterPtr params,\n                             int nparams)\n{\n    bool string_okay;\n    size_t i;\n\n    string_okay = VIR_DRV_SUPPORTS_FEATURE(conn->driver,\n                                           conn,\n                                           VIR_DRV_FEATURE_TYPED_PARAM_STRING);\n    for (i = 0; i < nparams; i++) {\n        if (strnlen(params[i].field, VIR_TYPED_PARAM_FIELD_LENGTH) ==\n            VIR_TYPED_PARAM_FIELD_LENGTH) {\n            virReportInvalidArg(params,\n                                _(\"string parameter name '%.*s' too long\"),\n                                VIR_TYPED_PARAM_FIELD_LENGTH,\n                                params[i].field);\n            return -1;\n        }\n        if (params[i].type == VIR_TYPED_PARAM_STRING) {\n            if (string_okay) {\n                if (!params[i].value.s) {\n                    virReportInvalidArg(params,\n                                        _(\"NULL string parameter '%s'\"),\n                                        params[i].field);\n                    return -1;\n                }\n            } else {\n                virReportInvalidArg(params,\n                                    _(\"string parameter '%s' unsupported\"),\n                                    params[i].field);\n                return -1;\n            }\n        }\n    }\n    return 0;\n}",
          "includes": [
            "#include \"access/viraccessmanager.h\"",
            "# include \"bhyve/bhyve_driver.h\"",
            "# include \"hyperv/hyperv_driver.h\"",
            "# include \"esx/esx_driver.h\"",
            "# include \"vmware/vmware_driver.h\"",
            "# include \"openvz/openvz_driver.h\"",
            "# include \"remote/remote_driver.h\"",
            "# include \"test/test_driver.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"viruri.h\"",
            "#include \"virrandom.h\"",
            "#include \"virfile.h\"",
            "#include \"virevent.h\"",
            "#include \"vircommand.h\"",
            "#include \"rpc/virnettlscontext.h\"",
            "#include \"virconf.h\"",
            "#include \"configmake.h\"",
            "#include \"viralloc.h\"",
            "#include \"viruuid.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <curl/curl.h>",
            "#include <libxml/xpath.h>",
            "#include <libxml/parser.h>",
            "#include <gio/gnetworking.h>",
            "#include <time.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"access/viraccessmanager.h\"\n# include \"bhyve/bhyve_driver.h\"\n# include \"hyperv/hyperv_driver.h\"\n# include \"esx/esx_driver.h\"\n# include \"vmware/vmware_driver.h\"\n# include \"openvz/openvz_driver.h\"\n# include \"remote/remote_driver.h\"\n# include \"test/test_driver.h\"\n#include \"virtypedparam.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"viruri.h\"\n#include \"virrandom.h\"\n#include \"virfile.h\"\n#include \"virevent.h\"\n#include \"vircommand.h\"\n#include \"rpc/virnettlscontext.h\"\n#include \"virconf.h\"\n#include \"configmake.h\"\n#include \"viralloc.h\"\n#include \"viruuid.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <curl/curl.h>\n#include <libxml/xpath.h>\n#include <libxml/parser.h>\n#include <gio/gnetworking.h>\n#include <time.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nint\nvirTypedParameterValidateSet(virConnectPtr conn,\n                             virTypedParameterPtr params,\n                             int nparams)\n{\n    bool string_okay;\n    size_t i;\n\n    string_okay = VIR_DRV_SUPPORTS_FEATURE(conn->driver,\n                                           conn,\n                                           VIR_DRV_FEATURE_TYPED_PARAM_STRING);\n    for (i = 0; i < nparams; i++) {\n        if (strnlen(params[i].field, VIR_TYPED_PARAM_FIELD_LENGTH) ==\n            VIR_TYPED_PARAM_FIELD_LENGTH) {\n            virReportInvalidArg(params,\n                                _(\"string parameter name '%.*s' too long\"),\n                                VIR_TYPED_PARAM_FIELD_LENGTH,\n                                params[i].field);\n            return -1;\n        }\n        if (params[i].type == VIR_TYPED_PARAM_STRING) {\n            if (string_okay) {\n                if (!params[i].value.s) {\n                    virReportInvalidArg(params,\n                                        _(\"NULL string parameter '%s'\"),\n                                        params[i].field);\n                    return -1;\n                }\n            } else {\n                virReportInvalidArg(params,\n                                    _(\"string parameter '%s' unsupported\"),\n                                    params[i].field);\n                return -1;\n            }\n        }\n    }\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckPositiveArgGoto",
          "args": [
            "nparams",
            "error"
          ],
          "line": 5623
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "params",
            "error"
          ],
          "line": 5622
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "conn->flags",
            "error"
          ],
          "line": 5621
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "domain",
            "-1"
          ],
          "line": 5618
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 5616
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_TYPED_PARAMS_DEBUG",
          "args": [
            "params",
            "nparams"
          ],
          "line": 5614
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "domain",
            "\"device=%s, params=%p, nparams=%d, flags=0x%x\"",
            "device",
            "params",
            "nparams",
            "flags"
          ],
          "line": 5612
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainSetInterfaceParameters(virDomainPtr domain,\n                                const char *device,\n                                virTypedParameterPtr params,\n                                int nparams, unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"device=%s, params=%p, nparams=%d, flags=0x%x\",\n                     device, params, nparams, flags);\n    VIR_TYPED_PARAMS_DEBUG(params, nparams);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n    virCheckNonNullArgGoto(params, error);\n    virCheckPositiveArgGoto(nparams, error);\n\n    if (virTypedParameterValidateSet(conn, params, nparams) < 0)\n        goto error;\n\n    if (conn->driver->domainSetInterfaceParameters) {\n        int ret;\n        ret = conn->driver->domainSetInterfaceParameters(domain, device,\n                                                         params, nparams,\n                                                         flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainInterfaceStats",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "5544-5582",
    "snippet": "int\nvirDomainInterfaceStats(virDomainPtr dom, const char *device,\n                        virDomainInterfaceStatsPtr stats, size_t size)\n{\n    virConnectPtr conn;\n    virDomainInterfaceStatsStruct stats2 = { -1, -1, -1, -1,\n                                             -1, -1, -1, -1 };\n\n    VIR_DOMAIN_DEBUG(dom, \"device=%s, stats=%p, size=%zi\",\n                     device, stats, size);\n\n    virResetLastError();\n\n    virCheckDomainReturn(dom, -1);\n    virCheckNonNullArgGoto(device, error);\n    virCheckNonNullArgGoto(stats, error);\n    if (size > sizeof(stats2)) {\n        virReportInvalidArg(size,\n                            _(\"size must not exceed %zu\"),\n                            sizeof(stats2));\n        goto error;\n    }\n\n    conn = dom->conn;\n\n    if (conn->driver->domainInterfaceStats) {\n        if (conn->driver->domainInterfaceStats(dom, device, &stats2) == -1)\n            goto error;\n\n        memcpy(stats, &stats2, size);\n        return 0;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(dom->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "dom->conn"
          ],
          "line": 5580
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 5577
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "stats",
            "&stats2",
            "size"
          ],
          "line": 5573
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainInterfaceStats",
          "args": [
            "dom",
            "device",
            "&stats2"
          ],
          "line": 5570
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportInvalidArg",
          "args": [
            "size",
            "_(\"size must not exceed %zu\")",
            "sizeof(stats2)"
          ],
          "line": 5561
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"size must not exceed %zu\""
          ],
          "line": 5562
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "stats",
            "error"
          ],
          "line": 5559
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "device",
            "error"
          ],
          "line": 5558
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "dom",
            "-1"
          ],
          "line": 5557
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 5555
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "dom",
            "\"device=%s, stats=%p, size=%zi\"",
            "device",
            "stats",
            "size"
          ],
          "line": 5552
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainInterfaceStats(virDomainPtr dom, const char *device,\n                        virDomainInterfaceStatsPtr stats, size_t size)\n{\n    virConnectPtr conn;\n    virDomainInterfaceStatsStruct stats2 = { -1, -1, -1, -1,\n                                             -1, -1, -1, -1 };\n\n    VIR_DOMAIN_DEBUG(dom, \"device=%s, stats=%p, size=%zi\",\n                     device, stats, size);\n\n    virResetLastError();\n\n    virCheckDomainReturn(dom, -1);\n    virCheckNonNullArgGoto(device, error);\n    virCheckNonNullArgGoto(stats, error);\n    if (size > sizeof(stats2)) {\n        virReportInvalidArg(size,\n                            _(\"size must not exceed %zu\"),\n                            sizeof(stats2));\n        goto error;\n    }\n\n    conn = dom->conn;\n\n    if (conn->driver->domainInterfaceStats) {\n        if (conn->driver->domainInterfaceStats(dom, device, &stats2) == -1)\n            goto error;\n\n        memcpy(stats, &stats2, size);\n        return 0;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(dom->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainBlockStatsFlags",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "5479-5517",
    "snippet": "int\nvirDomainBlockStatsFlags(virDomainPtr dom,\n                         const char *disk,\n                         virTypedParameterPtr params,\n                         int *nparams,\n                         unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(dom, \"disk=%s, params=%p, nparams=%d, flags=0x%x\",\n                     disk, params, nparams ? *nparams : -1, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(dom, -1);\n    virCheckNonNullArgGoto(disk, error);\n    virCheckNonNullArgGoto(nparams, error);\n    virCheckNonNegativeArgGoto(*nparams, error);\n    if (*nparams != 0)\n        virCheckNonNullArgGoto(params, error);\n\n    if (VIR_DRV_SUPPORTS_FEATURE(dom->conn->driver, dom->conn,\n                                 VIR_DRV_FEATURE_TYPED_PARAM_STRING))\n        flags |= VIR_TYPED_PARAM_STRING_OKAY;\n    conn = dom->conn;\n\n    if (conn->driver->domainBlockStatsFlags) {\n        int ret;\n        ret = conn->driver->domainBlockStatsFlags(dom, disk, params, nparams, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(dom->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "dom->conn"
          ],
          "line": 5515
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 5512
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainBlockStatsFlags",
          "args": [
            "dom",
            "disk",
            "params",
            "nparams",
            "flags"
          ],
          "line": 5507
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DRV_SUPPORTS_FEATURE",
          "args": [
            "dom->conn->driver",
            "dom->conn",
            "VIR_DRV_FEATURE_TYPED_PARAM_STRING"
          ],
          "line": 5500
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "params",
            "error"
          ],
          "line": 5498
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNegativeArgGoto",
          "args": [
            "*nparams",
            "error"
          ],
          "line": 5496
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "nparams",
            "error"
          ],
          "line": 5495
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "disk",
            "error"
          ],
          "line": 5494
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "dom",
            "-1"
          ],
          "line": 5493
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 5491
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "dom",
            "\"disk=%s, params=%p, nparams=%d, flags=0x%x\"",
            "disk",
            "params",
            "nparams ? *nparams : -1",
            "flags"
          ],
          "line": 5488
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainBlockStatsFlags(virDomainPtr dom,\n                         const char *disk,\n                         virTypedParameterPtr params,\n                         int *nparams,\n                         unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(dom, \"disk=%s, params=%p, nparams=%d, flags=0x%x\",\n                     disk, params, nparams ? *nparams : -1, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(dom, -1);\n    virCheckNonNullArgGoto(disk, error);\n    virCheckNonNullArgGoto(nparams, error);\n    virCheckNonNegativeArgGoto(*nparams, error);\n    if (*nparams != 0)\n        virCheckNonNullArgGoto(params, error);\n\n    if (VIR_DRV_SUPPORTS_FEATURE(dom->conn->driver, dom->conn,\n                                 VIR_DRV_FEATURE_TYPED_PARAM_STRING))\n        flags |= VIR_TYPED_PARAM_STRING_OKAY;\n    conn = dom->conn;\n\n    if (conn->driver->domainBlockStatsFlags) {\n        int ret;\n        ret = conn->driver->domainBlockStatsFlags(dom, disk, params, nparams, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(dom->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainBlockStats",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "5402-5437",
    "snippet": "int\nvirDomainBlockStats(virDomainPtr dom, const char *disk,\n                    virDomainBlockStatsPtr stats, size_t size)\n{\n    virConnectPtr conn;\n    virDomainBlockStatsStruct stats2 = { -1, -1, -1, -1, -1 };\n\n    VIR_DOMAIN_DEBUG(dom, \"disk=%s, stats=%p, size=%zi\", disk, stats, size);\n\n    virResetLastError();\n\n    virCheckDomainReturn(dom, -1);\n    virCheckNonNullArgGoto(disk, error);\n    virCheckNonNullArgGoto(stats, error);\n    if (size > sizeof(stats2)) {\n        virReportInvalidArg(size,\n                            _(\"size must not exceed %zu\"),\n                            sizeof(stats2));\n        goto error;\n    }\n    conn = dom->conn;\n\n    if (conn->driver->domainBlockStats) {\n        if (conn->driver->domainBlockStats(dom, disk, &stats2) == -1)\n            goto error;\n\n        memcpy(stats, &stats2, size);\n        return 0;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(dom->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "dom->conn"
          ],
          "line": 5435
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 5432
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "stats",
            "&stats2",
            "size"
          ],
          "line": 5428
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainBlockStats",
          "args": [
            "dom",
            "disk",
            "&stats2"
          ],
          "line": 5425
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportInvalidArg",
          "args": [
            "size",
            "_(\"size must not exceed %zu\")",
            "sizeof(stats2)"
          ],
          "line": 5417
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"size must not exceed %zu\""
          ],
          "line": 5418
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "stats",
            "error"
          ],
          "line": 5415
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "disk",
            "error"
          ],
          "line": 5414
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "dom",
            "-1"
          ],
          "line": 5413
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 5411
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "dom",
            "\"disk=%s, stats=%p, size=%zi\"",
            "disk",
            "stats",
            "size"
          ],
          "line": 5409
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainBlockStats(virDomainPtr dom, const char *disk,\n                    virDomainBlockStatsPtr stats, size_t size)\n{\n    virConnectPtr conn;\n    virDomainBlockStatsStruct stats2 = { -1, -1, -1, -1, -1 };\n\n    VIR_DOMAIN_DEBUG(dom, \"disk=%s, stats=%p, size=%zi\", disk, stats, size);\n\n    virResetLastError();\n\n    virCheckDomainReturn(dom, -1);\n    virCheckNonNullArgGoto(disk, error);\n    virCheckNonNullArgGoto(stats, error);\n    if (size > sizeof(stats2)) {\n        virReportInvalidArg(size,\n                            _(\"size must not exceed %zu\"),\n                            sizeof(stats2));\n        goto error;\n    }\n    conn = dom->conn;\n\n    if (conn->driver->domainBlockStats) {\n        if (conn->driver->domainBlockStats(dom, disk, &stats2) == -1)\n            goto error;\n\n        memcpy(stats, &stats2, size);\n        return 0;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(dom->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainSetSchedulerParametersFlags",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "5331-5371",
    "snippet": "int\nvirDomainSetSchedulerParametersFlags(virDomainPtr domain,\n                                     virTypedParameterPtr params,\n                                     int nparams,\n                                     unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"params=%p, nparams=%d, flags=0x%x\",\n                     params, nparams, flags);\n    VIR_TYPED_PARAMS_DEBUG(params, nparams);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n    virCheckNonNullArgGoto(params, error);\n    virCheckNonNegativeArgGoto(nparams, error);\n\n    if (virTypedParameterValidateSet(conn, params, nparams) < 0)\n        goto error;\n\n    if (conn->driver->domainSetSchedulerParametersFlags) {\n        int ret;\n        ret = conn->driver->domainSetSchedulerParametersFlags(domain,\n                                                              params,\n                                                              nparams,\n                                                              flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "domain->conn"
          ],
          "line": 5369
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 5366
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainSetSchedulerParametersFlags",
          "args": [
            "domain",
            "params",
            "nparams",
            "flags"
          ],
          "line": 5357
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virTypedParameterValidateSet",
          "args": [
            "conn",
            "params",
            "nparams"
          ],
          "line": 5352
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParameterValidateSet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt.c",
          "lines": "1288-1325",
          "snippet": "int\nvirTypedParameterValidateSet(virConnectPtr conn,\n                             virTypedParameterPtr params,\n                             int nparams)\n{\n    bool string_okay;\n    size_t i;\n\n    string_okay = VIR_DRV_SUPPORTS_FEATURE(conn->driver,\n                                           conn,\n                                           VIR_DRV_FEATURE_TYPED_PARAM_STRING);\n    for (i = 0; i < nparams; i++) {\n        if (strnlen(params[i].field, VIR_TYPED_PARAM_FIELD_LENGTH) ==\n            VIR_TYPED_PARAM_FIELD_LENGTH) {\n            virReportInvalidArg(params,\n                                _(\"string parameter name '%.*s' too long\"),\n                                VIR_TYPED_PARAM_FIELD_LENGTH,\n                                params[i].field);\n            return -1;\n        }\n        if (params[i].type == VIR_TYPED_PARAM_STRING) {\n            if (string_okay) {\n                if (!params[i].value.s) {\n                    virReportInvalidArg(params,\n                                        _(\"NULL string parameter '%s'\"),\n                                        params[i].field);\n                    return -1;\n                }\n            } else {\n                virReportInvalidArg(params,\n                                    _(\"string parameter '%s' unsupported\"),\n                                    params[i].field);\n                return -1;\n            }\n        }\n    }\n    return 0;\n}",
          "includes": [
            "#include \"access/viraccessmanager.h\"",
            "# include \"bhyve/bhyve_driver.h\"",
            "# include \"hyperv/hyperv_driver.h\"",
            "# include \"esx/esx_driver.h\"",
            "# include \"vmware/vmware_driver.h\"",
            "# include \"openvz/openvz_driver.h\"",
            "# include \"remote/remote_driver.h\"",
            "# include \"test/test_driver.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"viruri.h\"",
            "#include \"virrandom.h\"",
            "#include \"virfile.h\"",
            "#include \"virevent.h\"",
            "#include \"vircommand.h\"",
            "#include \"rpc/virnettlscontext.h\"",
            "#include \"virconf.h\"",
            "#include \"configmake.h\"",
            "#include \"viralloc.h\"",
            "#include \"viruuid.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <curl/curl.h>",
            "#include <libxml/xpath.h>",
            "#include <libxml/parser.h>",
            "#include <gio/gnetworking.h>",
            "#include <time.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"access/viraccessmanager.h\"\n# include \"bhyve/bhyve_driver.h\"\n# include \"hyperv/hyperv_driver.h\"\n# include \"esx/esx_driver.h\"\n# include \"vmware/vmware_driver.h\"\n# include \"openvz/openvz_driver.h\"\n# include \"remote/remote_driver.h\"\n# include \"test/test_driver.h\"\n#include \"virtypedparam.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"viruri.h\"\n#include \"virrandom.h\"\n#include \"virfile.h\"\n#include \"virevent.h\"\n#include \"vircommand.h\"\n#include \"rpc/virnettlscontext.h\"\n#include \"virconf.h\"\n#include \"configmake.h\"\n#include \"viralloc.h\"\n#include \"viruuid.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <curl/curl.h>\n#include <libxml/xpath.h>\n#include <libxml/parser.h>\n#include <gio/gnetworking.h>\n#include <time.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nint\nvirTypedParameterValidateSet(virConnectPtr conn,\n                             virTypedParameterPtr params,\n                             int nparams)\n{\n    bool string_okay;\n    size_t i;\n\n    string_okay = VIR_DRV_SUPPORTS_FEATURE(conn->driver,\n                                           conn,\n                                           VIR_DRV_FEATURE_TYPED_PARAM_STRING);\n    for (i = 0; i < nparams; i++) {\n        if (strnlen(params[i].field, VIR_TYPED_PARAM_FIELD_LENGTH) ==\n            VIR_TYPED_PARAM_FIELD_LENGTH) {\n            virReportInvalidArg(params,\n                                _(\"string parameter name '%.*s' too long\"),\n                                VIR_TYPED_PARAM_FIELD_LENGTH,\n                                params[i].field);\n            return -1;\n        }\n        if (params[i].type == VIR_TYPED_PARAM_STRING) {\n            if (string_okay) {\n                if (!params[i].value.s) {\n                    virReportInvalidArg(params,\n                                        _(\"NULL string parameter '%s'\"),\n                                        params[i].field);\n                    return -1;\n                }\n            } else {\n                virReportInvalidArg(params,\n                                    _(\"string parameter '%s' unsupported\"),\n                                    params[i].field);\n                return -1;\n            }\n        }\n    }\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckNonNegativeArgGoto",
          "args": [
            "nparams",
            "error"
          ],
          "line": 5350
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "params",
            "error"
          ],
          "line": 5349
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "conn->flags",
            "error"
          ],
          "line": 5348
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "domain",
            "-1"
          ],
          "line": 5345
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 5343
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_TYPED_PARAMS_DEBUG",
          "args": [
            "params",
            "nparams"
          ],
          "line": 5341
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "domain",
            "\"params=%p, nparams=%d, flags=0x%x\"",
            "params",
            "nparams",
            "flags"
          ],
          "line": 5339
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainSetSchedulerParametersFlags(virDomainPtr domain,\n                                     virTypedParameterPtr params,\n                                     int nparams,\n                                     unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"params=%p, nparams=%d, flags=0x%x\",\n                     params, nparams, flags);\n    VIR_TYPED_PARAMS_DEBUG(params, nparams);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n    virCheckNonNullArgGoto(params, error);\n    virCheckNonNegativeArgGoto(nparams, error);\n\n    if (virTypedParameterValidateSet(conn, params, nparams) < 0)\n        goto error;\n\n    if (conn->driver->domainSetSchedulerParametersFlags) {\n        int ret;\n        ret = conn->driver->domainSetSchedulerParametersFlags(domain,\n                                                              params,\n                                                              nparams,\n                                                              flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainSetSchedulerParameters",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "5277-5311",
    "snippet": "int\nvirDomainSetSchedulerParameters(virDomainPtr domain,\n                                virTypedParameterPtr params, int nparams)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"params=%p, nparams=%d\", params, nparams);\n    VIR_TYPED_PARAMS_DEBUG(params, nparams);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n    virCheckNonNullArgGoto(params, error);\n    virCheckNonNegativeArgGoto(nparams, error);\n\n    if (virTypedParameterValidateSet(conn, params, nparams) < 0)\n        goto error;\n\n    if (conn->driver->domainSetSchedulerParameters) {\n        int ret;\n        ret = conn->driver->domainSetSchedulerParameters(domain, params, nparams);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "domain->conn"
          ],
          "line": 5309
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 5306
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainSetSchedulerParameters",
          "args": [
            "domain",
            "params",
            "nparams"
          ],
          "line": 5300
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virTypedParameterValidateSet",
          "args": [
            "conn",
            "params",
            "nparams"
          ],
          "line": 5295
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParameterValidateSet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt.c",
          "lines": "1288-1325",
          "snippet": "int\nvirTypedParameterValidateSet(virConnectPtr conn,\n                             virTypedParameterPtr params,\n                             int nparams)\n{\n    bool string_okay;\n    size_t i;\n\n    string_okay = VIR_DRV_SUPPORTS_FEATURE(conn->driver,\n                                           conn,\n                                           VIR_DRV_FEATURE_TYPED_PARAM_STRING);\n    for (i = 0; i < nparams; i++) {\n        if (strnlen(params[i].field, VIR_TYPED_PARAM_FIELD_LENGTH) ==\n            VIR_TYPED_PARAM_FIELD_LENGTH) {\n            virReportInvalidArg(params,\n                                _(\"string parameter name '%.*s' too long\"),\n                                VIR_TYPED_PARAM_FIELD_LENGTH,\n                                params[i].field);\n            return -1;\n        }\n        if (params[i].type == VIR_TYPED_PARAM_STRING) {\n            if (string_okay) {\n                if (!params[i].value.s) {\n                    virReportInvalidArg(params,\n                                        _(\"NULL string parameter '%s'\"),\n                                        params[i].field);\n                    return -1;\n                }\n            } else {\n                virReportInvalidArg(params,\n                                    _(\"string parameter '%s' unsupported\"),\n                                    params[i].field);\n                return -1;\n            }\n        }\n    }\n    return 0;\n}",
          "includes": [
            "#include \"access/viraccessmanager.h\"",
            "# include \"bhyve/bhyve_driver.h\"",
            "# include \"hyperv/hyperv_driver.h\"",
            "# include \"esx/esx_driver.h\"",
            "# include \"vmware/vmware_driver.h\"",
            "# include \"openvz/openvz_driver.h\"",
            "# include \"remote/remote_driver.h\"",
            "# include \"test/test_driver.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"viruri.h\"",
            "#include \"virrandom.h\"",
            "#include \"virfile.h\"",
            "#include \"virevent.h\"",
            "#include \"vircommand.h\"",
            "#include \"rpc/virnettlscontext.h\"",
            "#include \"virconf.h\"",
            "#include \"configmake.h\"",
            "#include \"viralloc.h\"",
            "#include \"viruuid.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <curl/curl.h>",
            "#include <libxml/xpath.h>",
            "#include <libxml/parser.h>",
            "#include <gio/gnetworking.h>",
            "#include <time.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"access/viraccessmanager.h\"\n# include \"bhyve/bhyve_driver.h\"\n# include \"hyperv/hyperv_driver.h\"\n# include \"esx/esx_driver.h\"\n# include \"vmware/vmware_driver.h\"\n# include \"openvz/openvz_driver.h\"\n# include \"remote/remote_driver.h\"\n# include \"test/test_driver.h\"\n#include \"virtypedparam.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"viruri.h\"\n#include \"virrandom.h\"\n#include \"virfile.h\"\n#include \"virevent.h\"\n#include \"vircommand.h\"\n#include \"rpc/virnettlscontext.h\"\n#include \"virconf.h\"\n#include \"configmake.h\"\n#include \"viralloc.h\"\n#include \"viruuid.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <curl/curl.h>\n#include <libxml/xpath.h>\n#include <libxml/parser.h>\n#include <gio/gnetworking.h>\n#include <time.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nint\nvirTypedParameterValidateSet(virConnectPtr conn,\n                             virTypedParameterPtr params,\n                             int nparams)\n{\n    bool string_okay;\n    size_t i;\n\n    string_okay = VIR_DRV_SUPPORTS_FEATURE(conn->driver,\n                                           conn,\n                                           VIR_DRV_FEATURE_TYPED_PARAM_STRING);\n    for (i = 0; i < nparams; i++) {\n        if (strnlen(params[i].field, VIR_TYPED_PARAM_FIELD_LENGTH) ==\n            VIR_TYPED_PARAM_FIELD_LENGTH) {\n            virReportInvalidArg(params,\n                                _(\"string parameter name '%.*s' too long\"),\n                                VIR_TYPED_PARAM_FIELD_LENGTH,\n                                params[i].field);\n            return -1;\n        }\n        if (params[i].type == VIR_TYPED_PARAM_STRING) {\n            if (string_okay) {\n                if (!params[i].value.s) {\n                    virReportInvalidArg(params,\n                                        _(\"NULL string parameter '%s'\"),\n                                        params[i].field);\n                    return -1;\n                }\n            } else {\n                virReportInvalidArg(params,\n                                    _(\"string parameter '%s' unsupported\"),\n                                    params[i].field);\n                return -1;\n            }\n        }\n    }\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckNonNegativeArgGoto",
          "args": [
            "nparams",
            "error"
          ],
          "line": 5293
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "params",
            "error"
          ],
          "line": 5292
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "conn->flags",
            "error"
          ],
          "line": 5291
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "domain",
            "-1"
          ],
          "line": 5288
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 5286
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_TYPED_PARAMS_DEBUG",
          "args": [
            "params",
            "nparams"
          ],
          "line": 5284
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "domain",
            "\"params=%p, nparams=%d\"",
            "params",
            "nparams"
          ],
          "line": 5283
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainSetSchedulerParameters(virDomainPtr domain,\n                                virTypedParameterPtr params, int nparams)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"params=%p, nparams=%d\", params, nparams);\n    VIR_TYPED_PARAMS_DEBUG(params, nparams);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n    virCheckNonNullArgGoto(params, error);\n    virCheckNonNegativeArgGoto(nparams, error);\n\n    if (virTypedParameterValidateSet(conn, params, nparams) < 0)\n        goto error;\n\n    if (conn->driver->domainSetSchedulerParameters) {\n        int ret;\n        ret = conn->driver->domainSetSchedulerParameters(domain, params, nparams);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainGetSchedulerParametersFlags",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "5217-5259",
    "snippet": "int\nvirDomainGetSchedulerParametersFlags(virDomainPtr domain,\n                                     virTypedParameterPtr params, int *nparams,\n                                     unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"params=%p, nparams=%p, flags=0x%x\",\n                     params, nparams, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n\n    virCheckNonNullArgGoto(params, error);\n    virCheckNonNullArgGoto(nparams, error);\n    virCheckPositiveArgGoto(*nparams, error);\n\n    if (VIR_DRV_SUPPORTS_FEATURE(domain->conn->driver, domain->conn,\n                                 VIR_DRV_FEATURE_TYPED_PARAM_STRING))\n        flags |= VIR_TYPED_PARAM_STRING_OKAY;\n\n    VIR_EXCLUSIVE_FLAGS_GOTO(VIR_DOMAIN_AFFECT_LIVE,\n                             VIR_DOMAIN_AFFECT_CONFIG,\n                             error);\n\n    conn = domain->conn;\n\n    if (conn->driver->domainGetSchedulerParametersFlags) {\n        int ret;\n        ret = conn->driver->domainGetSchedulerParametersFlags(domain, params,\n                                                              nparams, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "domain->conn"
          ],
          "line": 5257
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 5254
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainGetSchedulerParametersFlags",
          "args": [
            "domain",
            "params",
            "nparams",
            "flags"
          ],
          "line": 5247
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_EXCLUSIVE_FLAGS_GOTO",
          "args": [
            "VIR_DOMAIN_AFFECT_LIVE",
            "VIR_DOMAIN_AFFECT_CONFIG",
            "error"
          ],
          "line": 5239
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DRV_SUPPORTS_FEATURE",
          "args": [
            "domain->conn->driver",
            "domain->conn",
            "VIR_DRV_FEATURE_TYPED_PARAM_STRING"
          ],
          "line": 5235
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckPositiveArgGoto",
          "args": [
            "*nparams",
            "error"
          ],
          "line": 5233
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "nparams",
            "error"
          ],
          "line": 5232
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "params",
            "error"
          ],
          "line": 5231
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "domain",
            "-1"
          ],
          "line": 5229
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 5227
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "domain",
            "\"params=%p, nparams=%p, flags=0x%x\"",
            "params",
            "nparams",
            "flags"
          ],
          "line": 5224
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainGetSchedulerParametersFlags(virDomainPtr domain,\n                                     virTypedParameterPtr params, int *nparams,\n                                     unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"params=%p, nparams=%p, flags=0x%x\",\n                     params, nparams, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n\n    virCheckNonNullArgGoto(params, error);\n    virCheckNonNullArgGoto(nparams, error);\n    virCheckPositiveArgGoto(*nparams, error);\n\n    if (VIR_DRV_SUPPORTS_FEATURE(domain->conn->driver, domain->conn,\n                                 VIR_DRV_FEATURE_TYPED_PARAM_STRING))\n        flags |= VIR_TYPED_PARAM_STRING_OKAY;\n\n    VIR_EXCLUSIVE_FLAGS_GOTO(VIR_DOMAIN_AFFECT_LIVE,\n                             VIR_DOMAIN_AFFECT_CONFIG,\n                             error);\n\n    conn = domain->conn;\n\n    if (conn->driver->domainGetSchedulerParametersFlags) {\n        int ret;\n        ret = conn->driver->domainGetSchedulerParametersFlags(domain, params,\n                                                              nparams, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainGetSchedulerParameters",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "5152-5183",
    "snippet": "int\nvirDomainGetSchedulerParameters(virDomainPtr domain,\n                                virTypedParameterPtr params, int *nparams)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"params=%p, nparams=%p\", params, nparams);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n\n    virCheckNonNullArgGoto(params, error);\n    virCheckNonNullArgGoto(nparams, error);\n    virCheckPositiveArgGoto(*nparams, error);\n\n    conn = domain->conn;\n\n    if (conn->driver->domainGetSchedulerParameters) {\n        int ret;\n        ret = conn->driver->domainGetSchedulerParameters(domain, params, nparams);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "domain->conn"
          ],
          "line": 5181
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 5178
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainGetSchedulerParameters",
          "args": [
            "domain",
            "params",
            "nparams"
          ],
          "line": 5172
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckPositiveArgGoto",
          "args": [
            "*nparams",
            "error"
          ],
          "line": 5166
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "nparams",
            "error"
          ],
          "line": 5165
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "params",
            "error"
          ],
          "line": 5164
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "domain",
            "-1"
          ],
          "line": 5162
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 5160
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "domain",
            "\"params=%p, nparams=%p\"",
            "params",
            "nparams"
          ],
          "line": 5158
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainGetSchedulerParameters(virDomainPtr domain,\n                                virTypedParameterPtr params, int *nparams)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"params=%p, nparams=%p\", params, nparams);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n\n    virCheckNonNullArgGoto(params, error);\n    virCheckNonNullArgGoto(nparams, error);\n    virCheckPositiveArgGoto(*nparams, error);\n\n    conn = domain->conn;\n\n    if (conn->driver->domainGetSchedulerParameters) {\n        int ret;\n        ret = conn->driver->domainGetSchedulerParameters(domain, params, nparams);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainGetSchedulerType",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "5104-5129",
    "snippet": "char *\nvirDomainGetSchedulerType(virDomainPtr domain, int *nparams)\n{\n    virConnectPtr conn;\n    char *schedtype;\n\n    VIR_DOMAIN_DEBUG(domain, \"nparams=%p\", nparams);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, NULL);\n    conn = domain->conn;\n\n    if (conn->driver->domainGetSchedulerType) {\n        schedtype = conn->driver->domainGetSchedulerType(domain, nparams);\n        if (!schedtype)\n            goto error;\n        return schedtype;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return NULL;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "domain->conn"
          ],
          "line": 5127
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 5124
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainGetSchedulerType",
          "args": [
            "domain",
            "nparams"
          ],
          "line": 5118
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "domain",
            "NULL"
          ],
          "line": 5114
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 5112
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "domain",
            "\"nparams=%p\"",
            "nparams"
          ],
          "line": 5110
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nchar *\nvirDomainGetSchedulerType(virDomainPtr domain, int *nparams)\n{\n    virConnectPtr conn;\n    char *schedtype;\n\n    VIR_DOMAIN_DEBUG(domain, \"nparams=%p\", nparams);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, NULL);\n    conn = domain->conn;\n\n    if (conn->driver->domainGetSchedulerType) {\n        schedtype = conn->driver->domainGetSchedulerType(domain, nparams);\n        if (!schedtype)\n            goto error;\n        return schedtype;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return NULL;\n}"
  },
  {
    "function_name": "virDomainMigrateConfirm3Params",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "5053-5091",
    "snippet": "int\nvirDomainMigrateConfirm3Params(virDomainPtr domain,\n                               virTypedParameterPtr params,\n                               int nparams,\n                               const char *cookiein,\n                               int cookieinlen,\n                               unsigned int flags,\n                               int cancelled)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"params=%p, nparams=%d, cookiein=%p, \"\n                     \"cookieinlen=%d, flags=0x%x, cancelled=%d\",\n                     params, nparams, cookiein, cookieinlen, flags, cancelled);\n    VIR_TYPED_PARAMS_DEBUG(params, nparams);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->driver->domainMigrateConfirm3Params) {\n        int ret;\n        ret = conn->driver->domainMigrateConfirm3Params(\n                domain, params, nparams,\n                cookiein, cookieinlen, flags, cancelled);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "domain->conn"
          ],
          "line": 5089
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 5086
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainMigrateConfirm3Params",
          "args": [
            "domain",
            "params",
            "nparams",
            "cookiein",
            "cookieinlen",
            "flags",
            "cancelled"
          ],
          "line": 5078
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "conn->flags",
            "error"
          ],
          "line": 5074
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "domain",
            "-1"
          ],
          "line": 5071
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 5069
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_TYPED_PARAMS_DEBUG",
          "args": [
            "params",
            "nparams"
          ],
          "line": 5067
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "domain",
            "\"params=%p, nparams=%d, cookiein=%p, \"\n                     \"cookieinlen=%d, flags=0x%x, cancelled=%d\"",
            "params",
            "nparams",
            "cookiein",
            "cookieinlen",
            "flags",
            "cancelled"
          ],
          "line": 5064
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainMigrateConfirm3Params(virDomainPtr domain,\n                               virTypedParameterPtr params,\n                               int nparams,\n                               const char *cookiein,\n                               int cookieinlen,\n                               unsigned int flags,\n                               int cancelled)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"params=%p, nparams=%d, cookiein=%p, \"\n                     \"cookieinlen=%d, flags=0x%x, cancelled=%d\",\n                     params, nparams, cookiein, cookieinlen, flags, cancelled);\n    VIR_TYPED_PARAMS_DEBUG(params, nparams);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->driver->domainMigrateConfirm3Params) {\n        int ret;\n        ret = conn->driver->domainMigrateConfirm3Params(\n                domain, params, nparams,\n                cookiein, cookieinlen, flags, cancelled);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainMigrateFinish3Params",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "5009-5046",
    "snippet": "virDomainPtr\nvirDomainMigrateFinish3Params(virConnectPtr dconn,\n                              virTypedParameterPtr params,\n                              int nparams,\n                              const char *cookiein,\n                              int cookieinlen,\n                              char **cookieout,\n                              int *cookieoutlen,\n                              unsigned int flags,\n                              int cancelled)\n{\n    VIR_DEBUG(\"dconn=%p, params=%p, nparams=%d, cookiein=%p, cookieinlen=%d, \"\n              \"cookieout=%p, cookieoutlen=%p, flags=0x%x, cancelled=%d\",\n              dconn, params, nparams, cookiein, cookieinlen, cookieout,\n              cookieoutlen, flags, cancelled);\n    VIR_TYPED_PARAMS_DEBUG(params, nparams);\n\n    virResetLastError();\n\n    virCheckConnectReturn(dconn, NULL);\n    virCheckReadOnlyGoto(dconn->flags, error);\n\n    if (dconn->driver->domainMigrateFinish3Params) {\n        virDomainPtr ret;\n        ret = dconn->driver->domainMigrateFinish3Params(\n                dconn, params, nparams, cookiein, cookieinlen,\n                cookieout, cookieoutlen, flags, cancelled);\n        if (!ret && !cancelled)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(dconn);\n    return NULL;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "dconn"
          ],
          "line": 5044
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 5041
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dconn->driver->domainMigrateFinish3Params",
          "args": [
            "dconn",
            "params",
            "nparams",
            "cookiein",
            "cookieinlen",
            "cookieout",
            "cookieoutlen",
            "flags",
            "cancelled"
          ],
          "line": 5033
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "dconn->flags",
            "error"
          ],
          "line": 5029
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckConnectReturn",
          "args": [
            "dconn",
            "NULL"
          ],
          "line": 5028
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 5026
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_TYPED_PARAMS_DEBUG",
          "args": [
            "params",
            "nparams"
          ],
          "line": 5024
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"dconn=%p, params=%p, nparams=%d, cookiein=%p, cookieinlen=%d, \"\n              \"cookieout=%p, cookieoutlen=%p, flags=0x%x, cancelled=%d\"",
            "dconn",
            "params",
            "nparams",
            "cookiein",
            "cookieinlen",
            "cookieout",
            "cookieoutlen",
            "flags",
            "cancelled"
          ],
          "line": 5020
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nvirDomainPtr\nvirDomainMigrateFinish3Params(virConnectPtr dconn,\n                              virTypedParameterPtr params,\n                              int nparams,\n                              const char *cookiein,\n                              int cookieinlen,\n                              char **cookieout,\n                              int *cookieoutlen,\n                              unsigned int flags,\n                              int cancelled)\n{\n    VIR_DEBUG(\"dconn=%p, params=%p, nparams=%d, cookiein=%p, cookieinlen=%d, \"\n              \"cookieout=%p, cookieoutlen=%p, flags=0x%x, cancelled=%d\",\n              dconn, params, nparams, cookiein, cookieinlen, cookieout,\n              cookieoutlen, flags, cancelled);\n    VIR_TYPED_PARAMS_DEBUG(params, nparams);\n\n    virResetLastError();\n\n    virCheckConnectReturn(dconn, NULL);\n    virCheckReadOnlyGoto(dconn->flags, error);\n\n    if (dconn->driver->domainMigrateFinish3Params) {\n        virDomainPtr ret;\n        ret = dconn->driver->domainMigrateFinish3Params(\n                dconn, params, nparams, cookiein, cookieinlen,\n                cookieout, cookieoutlen, flags, cancelled);\n        if (!ret && !cancelled)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(dconn);\n    return NULL;\n}"
  },
  {
    "function_name": "virDomainMigratePerform3Params",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "4961-5002",
    "snippet": "int\nvirDomainMigratePerform3Params(virDomainPtr domain,\n                               const char *dconnuri,\n                               virTypedParameterPtr params,\n                               int nparams,\n                               const char *cookiein,\n                               int cookieinlen,\n                               char **cookieout,\n                               int *cookieoutlen,\n                               unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"dconnuri=%s, params=%p, nparams=%d, cookiein=%p, \"\n                     \"cookieinlen=%d, cookieout=%p, cookieoutlen=%p, flags=0x%x\",\n                     NULLSTR(dconnuri), params, nparams, cookiein,\n                     cookieinlen, cookieout, cookieoutlen, flags);\n    VIR_TYPED_PARAMS_DEBUG(params, nparams);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->driver->domainMigratePerform3Params) {\n        int ret;\n        ret = conn->driver->domainMigratePerform3Params(\n                domain, dconnuri, params, nparams, cookiein, cookieinlen,\n                cookieout, cookieoutlen, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "domain->conn"
          ],
          "line": 5000
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 4997
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainMigratePerform3Params",
          "args": [
            "domain",
            "dconnuri",
            "params",
            "nparams",
            "cookiein",
            "cookieinlen",
            "cookieout",
            "cookieoutlen",
            "flags"
          ],
          "line": 4989
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "conn->flags",
            "error"
          ],
          "line": 4985
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "domain",
            "-1"
          ],
          "line": 4982
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 4980
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_TYPED_PARAMS_DEBUG",
          "args": [
            "params",
            "nparams"
          ],
          "line": 4978
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "domain",
            "\"dconnuri=%s, params=%p, nparams=%d, cookiein=%p, \"\n                     \"cookieinlen=%d, cookieout=%p, cookieoutlen=%p, flags=0x%x\"",
            "NULLSTR(dconnuri)",
            "params",
            "nparams",
            "cookiein",
            "cookieinlen",
            "cookieout",
            "cookieoutlen",
            "flags"
          ],
          "line": 4974
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "dconnuri"
          ],
          "line": 4976
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainMigratePerform3Params(virDomainPtr domain,\n                               const char *dconnuri,\n                               virTypedParameterPtr params,\n                               int nparams,\n                               const char *cookiein,\n                               int cookieinlen,\n                               char **cookieout,\n                               int *cookieoutlen,\n                               unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"dconnuri=%s, params=%p, nparams=%d, cookiein=%p, \"\n                     \"cookieinlen=%d, cookieout=%p, cookieoutlen=%p, flags=0x%x\",\n                     NULLSTR(dconnuri), params, nparams, cookiein,\n                     cookieinlen, cookieout, cookieoutlen, flags);\n    VIR_TYPED_PARAMS_DEBUG(params, nparams);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->driver->domainMigratePerform3Params) {\n        int ret;\n        ret = conn->driver->domainMigratePerform3Params(\n                domain, dconnuri, params, nparams, cookiein, cookieinlen,\n                cookieout, cookieoutlen, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainMigratePrepareTunnel3Params",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "4911-4954",
    "snippet": "int\nvirDomainMigratePrepareTunnel3Params(virConnectPtr conn,\n                                     virStreamPtr st,\n                                     virTypedParameterPtr params,\n                                     int nparams,\n                                     const char *cookiein,\n                                     int cookieinlen,\n                                     char **cookieout,\n                                     int *cookieoutlen,\n                                     unsigned int flags)\n{\n    VIR_DEBUG(\"conn=%p, stream=%p, params=%p, nparams=%d, cookiein=%p, \"\n              \"cookieinlen=%d, cookieout=%p, cookieoutlen=%p, flags=0x%x\",\n              conn, st, params, nparams, cookiein, cookieinlen,\n              cookieout, cookieoutlen, flags);\n    VIR_TYPED_PARAMS_DEBUG(params, nparams);\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, -1);\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn != st->conn) {\n        virReportInvalidArg(conn, \"%s\",\n                            _(\"conn must match stream connection\"));\n        goto error;\n    }\n\n    if (conn->driver->domainMigratePrepareTunnel3Params) {\n        int rv;\n        rv = conn->driver->domainMigratePrepareTunnel3Params(\n                conn, st, params, nparams, cookiein, cookieinlen,\n                cookieout, cookieoutlen, flags);\n        if (rv < 0)\n            goto error;\n        return rv;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "conn"
          ],
          "line": 4952
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 4949
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainMigratePrepareTunnel3Params",
          "args": [
            "conn",
            "st",
            "params",
            "nparams",
            "cookiein",
            "cookieinlen",
            "cookieout",
            "cookieoutlen",
            "flags"
          ],
          "line": 4941
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportInvalidArg",
          "args": [
            "conn",
            "\"%s\"",
            "_(\"conn must match stream connection\")"
          ],
          "line": 4934
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"conn must match stream connection\""
          ],
          "line": 4935
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "conn->flags",
            "error"
          ],
          "line": 4931
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckConnectReturn",
          "args": [
            "conn",
            "-1"
          ],
          "line": 4930
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 4928
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_TYPED_PARAMS_DEBUG",
          "args": [
            "params",
            "nparams"
          ],
          "line": 4926
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"conn=%p, stream=%p, params=%p, nparams=%d, cookiein=%p, \"\n              \"cookieinlen=%d, cookieout=%p, cookieoutlen=%p, flags=0x%x\"",
            "conn",
            "st",
            "params",
            "nparams",
            "cookiein",
            "cookieinlen",
            "cookieout",
            "cookieoutlen",
            "flags"
          ],
          "line": 4922
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainMigratePrepareTunnel3Params(virConnectPtr conn,\n                                     virStreamPtr st,\n                                     virTypedParameterPtr params,\n                                     int nparams,\n                                     const char *cookiein,\n                                     int cookieinlen,\n                                     char **cookieout,\n                                     int *cookieoutlen,\n                                     unsigned int flags)\n{\n    VIR_DEBUG(\"conn=%p, stream=%p, params=%p, nparams=%d, cookiein=%p, \"\n              \"cookieinlen=%d, cookieout=%p, cookieoutlen=%p, flags=0x%x\",\n              conn, st, params, nparams, cookiein, cookieinlen,\n              cookieout, cookieoutlen, flags);\n    VIR_TYPED_PARAMS_DEBUG(params, nparams);\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, -1);\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn != st->conn) {\n        virReportInvalidArg(conn, \"%s\",\n                            _(\"conn must match stream connection\"));\n        goto error;\n    }\n\n    if (conn->driver->domainMigratePrepareTunnel3Params) {\n        int rv;\n        rv = conn->driver->domainMigratePrepareTunnel3Params(\n                conn, st, params, nparams, cookiein, cookieinlen,\n                cookieout, cookieoutlen, flags);\n        if (rv < 0)\n            goto error;\n        return rv;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainMigratePrepare3Params",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "4866-4904",
    "snippet": "int\nvirDomainMigratePrepare3Params(virConnectPtr dconn,\n                               virTypedParameterPtr params,\n                               int nparams,\n                               const char *cookiein,\n                               int cookieinlen,\n                               char **cookieout,\n                               int *cookieoutlen,\n                               char **uri_out,\n                               unsigned int flags)\n{\n    VIR_DEBUG(\"dconn=%p, params=%p, nparams=%d, cookiein=%p, cookieinlen=%d, \"\n              \"cookieout=%p, cookieoutlen=%p, uri_out=%p, flags=0x%x\",\n              dconn, params, nparams, cookiein, cookieinlen,\n              cookieout, cookieoutlen, uri_out, flags);\n    VIR_TYPED_PARAMS_DEBUG(params, nparams);\n\n    virResetLastError();\n\n    virCheckConnectReturn(dconn, -1);\n    virCheckReadOnlyGoto(dconn->flags, error);\n\n    if (dconn->driver->domainMigratePrepare3Params) {\n        int ret;\n        ret = dconn->driver->domainMigratePrepare3Params(dconn, params, nparams,\n                                                         cookiein, cookieinlen,\n                                                         cookieout, cookieoutlen,\n                                                         uri_out, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(dconn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "dconn"
          ],
          "line": 4902
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 4899
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dconn->driver->domainMigratePrepare3Params",
          "args": [
            "dconn",
            "params",
            "nparams",
            "cookiein",
            "cookieinlen",
            "cookieout",
            "cookieoutlen",
            "uri_out",
            "flags"
          ],
          "line": 4890
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "dconn->flags",
            "error"
          ],
          "line": 4886
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckConnectReturn",
          "args": [
            "dconn",
            "-1"
          ],
          "line": 4885
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 4883
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_TYPED_PARAMS_DEBUG",
          "args": [
            "params",
            "nparams"
          ],
          "line": 4881
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"dconn=%p, params=%p, nparams=%d, cookiein=%p, cookieinlen=%d, \"\n              \"cookieout=%p, cookieoutlen=%p, uri_out=%p, flags=0x%x\"",
            "dconn",
            "params",
            "nparams",
            "cookiein",
            "cookieinlen",
            "cookieout",
            "cookieoutlen",
            "uri_out",
            "flags"
          ],
          "line": 4877
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainMigratePrepare3Params(virConnectPtr dconn,\n                               virTypedParameterPtr params,\n                               int nparams,\n                               const char *cookiein,\n                               int cookieinlen,\n                               char **cookieout,\n                               int *cookieoutlen,\n                               char **uri_out,\n                               unsigned int flags)\n{\n    VIR_DEBUG(\"dconn=%p, params=%p, nparams=%d, cookiein=%p, cookieinlen=%d, \"\n              \"cookieout=%p, cookieoutlen=%p, uri_out=%p, flags=0x%x\",\n              dconn, params, nparams, cookiein, cookieinlen,\n              cookieout, cookieoutlen, uri_out, flags);\n    VIR_TYPED_PARAMS_DEBUG(params, nparams);\n\n    virResetLastError();\n\n    virCheckConnectReturn(dconn, -1);\n    virCheckReadOnlyGoto(dconn->flags, error);\n\n    if (dconn->driver->domainMigratePrepare3Params) {\n        int ret;\n        ret = dconn->driver->domainMigratePrepare3Params(dconn, params, nparams,\n                                                         cookiein, cookieinlen,\n                                                         cookieout, cookieoutlen,\n                                                         uri_out, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(dconn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainMigrateBegin3Params",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "4821-4859",
    "snippet": "char *\nvirDomainMigrateBegin3Params(virDomainPtr domain,\n                             virTypedParameterPtr params,\n                             int nparams,\n                             char **cookieout,\n                             int *cookieoutlen,\n                             unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"params=%p, nparams=%d, \"\n                     \"cookieout=%p, cookieoutlen=%p, flags=0x%x\",\n                     params, nparams, cookieout, cookieoutlen, flags);\n    VIR_TYPED_PARAMS_DEBUG(params, nparams);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, NULL);\n    conn = domain->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->driver->domainMigrateBegin3Params) {\n        char *xml;\n        xml = conn->driver->domainMigrateBegin3Params(domain, params, nparams,\n                                                      cookieout, cookieoutlen,\n                                                      flags);\n        VIR_DEBUG(\"xml %s\", NULLSTR(xml));\n        if (!xml)\n            goto error;\n        return xml;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return NULL;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "domain->conn"
          ],
          "line": 4857
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 4854
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"xml %s\"",
            "NULLSTR(xml)"
          ],
          "line": 4848
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "xml"
          ],
          "line": 4848
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainMigrateBegin3Params",
          "args": [
            "domain",
            "params",
            "nparams",
            "cookieout",
            "cookieoutlen",
            "flags"
          ],
          "line": 4845
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "conn->flags",
            "error"
          ],
          "line": 4841
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "domain",
            "NULL"
          ],
          "line": 4838
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 4836
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_TYPED_PARAMS_DEBUG",
          "args": [
            "params",
            "nparams"
          ],
          "line": 4834
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "domain",
            "\"params=%p, nparams=%d, \"\n                     \"cookieout=%p, cookieoutlen=%p, flags=0x%x\"",
            "params",
            "nparams",
            "cookieout",
            "cookieoutlen",
            "flags"
          ],
          "line": 4831
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nchar *\nvirDomainMigrateBegin3Params(virDomainPtr domain,\n                             virTypedParameterPtr params,\n                             int nparams,\n                             char **cookieout,\n                             int *cookieoutlen,\n                             unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"params=%p, nparams=%d, \"\n                     \"cookieout=%p, cookieoutlen=%p, flags=0x%x\",\n                     params, nparams, cookieout, cookieoutlen, flags);\n    VIR_TYPED_PARAMS_DEBUG(params, nparams);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, NULL);\n    conn = domain->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->driver->domainMigrateBegin3Params) {\n        char *xml;\n        xml = conn->driver->domainMigrateBegin3Params(domain, params, nparams,\n                                                      cookieout, cookieoutlen,\n                                                      flags);\n        VIR_DEBUG(\"xml %s\", NULLSTR(xml));\n        if (!xml)\n            goto error;\n        return xml;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return NULL;\n}"
  },
  {
    "function_name": "virDomainMigrateConfirm3",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "4779-4814",
    "snippet": "int\nvirDomainMigrateConfirm3(virDomainPtr domain,\n                         const char *cookiein,\n                         int cookieinlen,\n                         unsigned long flags,\n                         int cancelled)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain,\n                     \"cookiein=%p, cookieinlen=%d, flags=0x%lx, cancelled=%d\",\n                     cookiein, cookieinlen, flags, cancelled);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->driver->domainMigrateConfirm3) {\n        int ret;\n        ret = conn->driver->domainMigrateConfirm3(domain,\n                                                  cookiein, cookieinlen,\n                                                  flags, cancelled);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "domain->conn"
          ],
          "line": 4812
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 4809
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainMigrateConfirm3",
          "args": [
            "domain",
            "cookiein",
            "cookieinlen",
            "flags",
            "cancelled"
          ],
          "line": 4801
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "conn->flags",
            "error"
          ],
          "line": 4797
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "domain",
            "-1"
          ],
          "line": 4794
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 4792
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "domain",
            "\"cookiein=%p, cookieinlen=%d, flags=0x%lx, cancelled=%d\"",
            "cookiein",
            "cookieinlen",
            "flags",
            "cancelled"
          ],
          "line": 4788
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainMigrateConfirm3(virDomainPtr domain,\n                         const char *cookiein,\n                         int cookieinlen,\n                         unsigned long flags,\n                         int cancelled)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain,\n                     \"cookiein=%p, cookieinlen=%d, flags=0x%lx, cancelled=%d\",\n                     cookiein, cookieinlen, flags, cancelled);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->driver->domainMigrateConfirm3) {\n        int ret;\n        ret = conn->driver->domainMigrateConfirm3(domain,\n                                                  cookiein, cookieinlen,\n                                                  flags, cancelled);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainMigrateFinish3",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "4733-4772",
    "snippet": "virDomainPtr\nvirDomainMigrateFinish3(virConnectPtr dconn,\n                        const char *dname,\n                        const char *cookiein,\n                        int cookieinlen,\n                        char **cookieout,\n                        int *cookieoutlen,\n                        const char *dconnuri,\n                        const char *uri,\n                        unsigned long flags,\n                        int cancelled)\n{\n    VIR_DEBUG(\"dconn=%p, dname=%s, cookiein=%p, cookieinlen=%d, cookieout=%p,\"\n              \"cookieoutlen=%p, dconnuri=%s, uri=%s, flags=0x%lx, retcode=%d\",\n              dconn, NULLSTR(dname), cookiein, cookieinlen, cookieout,\n              cookieoutlen, NULLSTR(dconnuri), NULLSTR(uri), flags, cancelled);\n\n    virResetLastError();\n\n    virCheckConnectReturn(dconn, NULL);\n    virCheckReadOnlyGoto(dconn->flags, error);\n\n    if (dconn->driver->domainMigrateFinish3) {\n        virDomainPtr ret;\n        ret = dconn->driver->domainMigrateFinish3(dconn, dname,\n                                                  cookiein, cookieinlen,\n                                                  cookieout, cookieoutlen,\n                                                  dconnuri, uri, flags,\n                                                  cancelled);\n        if (!ret && !cancelled)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(dconn);\n    return NULL;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "dconn"
          ],
          "line": 4770
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 4767
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dconn->driver->domainMigrateFinish3",
          "args": [
            "dconn",
            "dname",
            "cookiein",
            "cookieinlen",
            "cookieout",
            "cookieoutlen",
            "dconnuri",
            "uri",
            "flags",
            "cancelled"
          ],
          "line": 4757
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "dconn->flags",
            "error"
          ],
          "line": 4753
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckConnectReturn",
          "args": [
            "dconn",
            "NULL"
          ],
          "line": 4752
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 4750
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"dconn=%p, dname=%s, cookiein=%p, cookieinlen=%d, cookieout=%p,\"\n              \"cookieoutlen=%p, dconnuri=%s, uri=%s, flags=0x%lx, retcode=%d\"",
            "dconn",
            "NULLSTR(dname)",
            "cookiein",
            "cookieinlen",
            "cookieout",
            "cookieoutlen",
            "NULLSTR(dconnuri)",
            "NULLSTR(uri)",
            "flags",
            "cancelled"
          ],
          "line": 4745
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "uri"
          ],
          "line": 4748
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "dconnuri"
          ],
          "line": 4748
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "dname"
          ],
          "line": 4747
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nvirDomainPtr\nvirDomainMigrateFinish3(virConnectPtr dconn,\n                        const char *dname,\n                        const char *cookiein,\n                        int cookieinlen,\n                        char **cookieout,\n                        int *cookieoutlen,\n                        const char *dconnuri,\n                        const char *uri,\n                        unsigned long flags,\n                        int cancelled)\n{\n    VIR_DEBUG(\"dconn=%p, dname=%s, cookiein=%p, cookieinlen=%d, cookieout=%p,\"\n              \"cookieoutlen=%p, dconnuri=%s, uri=%s, flags=0x%lx, retcode=%d\",\n              dconn, NULLSTR(dname), cookiein, cookieinlen, cookieout,\n              cookieoutlen, NULLSTR(dconnuri), NULLSTR(uri), flags, cancelled);\n\n    virResetLastError();\n\n    virCheckConnectReturn(dconn, NULL);\n    virCheckReadOnlyGoto(dconn->flags, error);\n\n    if (dconn->driver->domainMigrateFinish3) {\n        virDomainPtr ret;\n        ret = dconn->driver->domainMigrateFinish3(dconn, dname,\n                                                  cookiein, cookieinlen,\n                                                  cookieout, cookieoutlen,\n                                                  dconnuri, uri, flags,\n                                                  cancelled);\n        if (!ret && !cancelled)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(dconn);\n    return NULL;\n}"
  },
  {
    "function_name": "virDomainMigratePerform3",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "4680-4726",
    "snippet": "int\nvirDomainMigratePerform3(virDomainPtr domain,\n                         const char *xmlin,\n                         const char *cookiein,\n                         int cookieinlen,\n                         char **cookieout,\n                         int *cookieoutlen,\n                         const char *dconnuri,\n                         const char *uri,\n                         unsigned long flags,\n                         const char *dname,\n                         unsigned long bandwidth)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"xmlin=%s cookiein=%p, cookieinlen=%d, \"\n                     \"cookieout=%p, cookieoutlen=%p, dconnuri=%s, \"\n                     \"uri=%s, flags=0x%lx, dname=%s, bandwidth=%lu\",\n                     NULLSTR(xmlin), cookiein, cookieinlen,\n                     cookieout, cookieoutlen, NULLSTR(dconnuri),\n                     NULLSTR(uri), flags, NULLSTR(dname), bandwidth);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->driver->domainMigratePerform3) {\n        int ret;\n        ret = conn->driver->domainMigratePerform3(domain, xmlin,\n                                                  cookiein, cookieinlen,\n                                                  cookieout, cookieoutlen,\n                                                  dconnuri, uri,\n                                                  flags, dname, bandwidth);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "domain->conn"
          ],
          "line": 4724
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 4721
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainMigratePerform3",
          "args": [
            "domain",
            "xmlin",
            "cookiein",
            "cookieinlen",
            "cookieout",
            "cookieoutlen",
            "dconnuri",
            "uri",
            "flags",
            "dname",
            "bandwidth"
          ],
          "line": 4711
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "conn->flags",
            "error"
          ],
          "line": 4707
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "domain",
            "-1"
          ],
          "line": 4704
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 4702
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "domain",
            "\"xmlin=%s cookiein=%p, cookieinlen=%d, \"\n                     \"cookieout=%p, cookieoutlen=%p, dconnuri=%s, \"\n                     \"uri=%s, flags=0x%lx, dname=%s, bandwidth=%lu\"",
            "NULLSTR(xmlin)",
            "cookiein",
            "cookieinlen",
            "cookieout",
            "cookieoutlen",
            "NULLSTR(dconnuri)",
            "NULLSTR(uri)",
            "flags",
            "NULLSTR(dname)",
            "bandwidth"
          ],
          "line": 4695
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "dname"
          ],
          "line": 4700
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "uri"
          ],
          "line": 4700
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "dconnuri"
          ],
          "line": 4699
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "xmlin"
          ],
          "line": 4698
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainMigratePerform3(virDomainPtr domain,\n                         const char *xmlin,\n                         const char *cookiein,\n                         int cookieinlen,\n                         char **cookieout,\n                         int *cookieoutlen,\n                         const char *dconnuri,\n                         const char *uri,\n                         unsigned long flags,\n                         const char *dname,\n                         unsigned long bandwidth)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"xmlin=%s cookiein=%p, cookieinlen=%d, \"\n                     \"cookieout=%p, cookieoutlen=%p, dconnuri=%s, \"\n                     \"uri=%s, flags=0x%lx, dname=%s, bandwidth=%lu\",\n                     NULLSTR(xmlin), cookiein, cookieinlen,\n                     cookieout, cookieoutlen, NULLSTR(dconnuri),\n                     NULLSTR(uri), flags, NULLSTR(dname), bandwidth);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->driver->domainMigratePerform3) {\n        int ret;\n        ret = conn->driver->domainMigratePerform3(domain, xmlin,\n                                                  cookiein, cookieinlen,\n                                                  cookieout, cookieoutlen,\n                                                  dconnuri, uri,\n                                                  flags, dname, bandwidth);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainMigratePrepareTunnel3",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "4628-4673",
    "snippet": "int\nvirDomainMigratePrepareTunnel3(virConnectPtr conn,\n                               virStreamPtr st,\n                               const char *cookiein,\n                               int cookieinlen,\n                               char **cookieout,\n                               int *cookieoutlen,\n                               unsigned long flags,\n                               const char *dname,\n                               unsigned long bandwidth,\n                               const char *dom_xml)\n{\n    VIR_DEBUG(\"conn=%p, stream=%p, cookiein=%p, cookieinlen=%d, cookieout=%p, \"\n              \"cookieoutlen=%p, flags=0x%lx, dname=%s, bandwidth=%lu, \"\n              \"dom_xml=%s\",\n              conn, st, cookiein, cookieinlen, cookieout, cookieoutlen, flags,\n              NULLSTR(dname), bandwidth, NULLSTR(dom_xml));\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, -1);\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn != st->conn) {\n        virReportInvalidArg(conn, \"%s\",\n                            _(\"conn must match stream connection\"));\n        goto error;\n    }\n\n    if (conn->driver->domainMigratePrepareTunnel3) {\n        int rv = conn->driver->domainMigratePrepareTunnel3(conn, st,\n                                                           cookiein, cookieinlen,\n                                                           cookieout, cookieoutlen,\n                                                           flags, dname,\n                                                           bandwidth, dom_xml);\n        if (rv < 0)\n            goto error;\n        return rv;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "conn"
          ],
          "line": 4671
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 4668
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainMigratePrepareTunnel3",
          "args": [
            "conn",
            "st",
            "cookiein",
            "cookieinlen",
            "cookieout",
            "cookieoutlen",
            "flags",
            "dname",
            "bandwidth",
            "dom_xml"
          ],
          "line": 4658
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportInvalidArg",
          "args": [
            "conn",
            "\"%s\"",
            "_(\"conn must match stream connection\")"
          ],
          "line": 4652
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"conn must match stream connection\""
          ],
          "line": 4653
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "conn->flags",
            "error"
          ],
          "line": 4649
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckConnectReturn",
          "args": [
            "conn",
            "-1"
          ],
          "line": 4648
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 4646
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"conn=%p, stream=%p, cookiein=%p, cookieinlen=%d, cookieout=%p, \"\n              \"cookieoutlen=%p, flags=0x%lx, dname=%s, bandwidth=%lu, \"\n              \"dom_xml=%s\"",
            "conn",
            "st",
            "cookiein",
            "cookieinlen",
            "cookieout",
            "cookieoutlen",
            "flags",
            "NULLSTR(dname)",
            "bandwidth",
            "NULLSTR(dom_xml)"
          ],
          "line": 4640
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "dom_xml"
          ],
          "line": 4644
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "dname"
          ],
          "line": 4644
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainMigratePrepareTunnel3(virConnectPtr conn,\n                               virStreamPtr st,\n                               const char *cookiein,\n                               int cookieinlen,\n                               char **cookieout,\n                               int *cookieoutlen,\n                               unsigned long flags,\n                               const char *dname,\n                               unsigned long bandwidth,\n                               const char *dom_xml)\n{\n    VIR_DEBUG(\"conn=%p, stream=%p, cookiein=%p, cookieinlen=%d, cookieout=%p, \"\n              \"cookieoutlen=%p, flags=0x%lx, dname=%s, bandwidth=%lu, \"\n              \"dom_xml=%s\",\n              conn, st, cookiein, cookieinlen, cookieout, cookieoutlen, flags,\n              NULLSTR(dname), bandwidth, NULLSTR(dom_xml));\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, -1);\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn != st->conn) {\n        virReportInvalidArg(conn, \"%s\",\n                            _(\"conn must match stream connection\"));\n        goto error;\n    }\n\n    if (conn->driver->domainMigratePrepareTunnel3) {\n        int rv = conn->driver->domainMigratePrepareTunnel3(conn, st,\n                                                           cookiein, cookieinlen,\n                                                           cookieout, cookieoutlen,\n                                                           flags, dname,\n                                                           bandwidth, dom_xml);\n        if (rv < 0)\n            goto error;\n        return rv;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainMigratePrepare3",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "4579-4621",
    "snippet": "int\nvirDomainMigratePrepare3(virConnectPtr dconn,\n                         const char *cookiein,\n                         int cookieinlen,\n                         char **cookieout,\n                         int *cookieoutlen,\n                         const char *uri_in,\n                         char **uri_out,\n                         unsigned long flags,\n                         const char *dname,\n                         unsigned long bandwidth,\n                         const char *dom_xml)\n{\n    VIR_DEBUG(\"dconn=%p, cookiein=%p, cookieinlen=%d, cookieout=%p, \"\n              \"cookieoutlen=%p, uri_in=%s, uri_out=%p, flags=0x%lx, dname=%s, \"\n              \"bandwidth=%lu, dom_xml=%s\",\n              dconn, cookiein, cookieinlen, cookieout, cookieoutlen, NULLSTR(uri_in),\n              uri_out, flags, NULLSTR(dname), bandwidth, NULLSTR(dom_xml));\n\n    virResetLastError();\n\n    virCheckConnectReturn(dconn, -1);\n    virCheckReadOnlyGoto(dconn->flags, error);\n\n    if (dconn->driver->domainMigratePrepare3) {\n        int ret;\n        ret = dconn->driver->domainMigratePrepare3(dconn,\n                                                   cookiein, cookieinlen,\n                                                   cookieout, cookieoutlen,\n                                                   uri_in, uri_out,\n                                                   flags, dname, bandwidth,\n                                                   dom_xml);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(dconn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "dconn"
          ],
          "line": 4619
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 4616
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dconn->driver->domainMigratePrepare3",
          "args": [
            "dconn",
            "cookiein",
            "cookieinlen",
            "cookieout",
            "cookieoutlen",
            "uri_in",
            "uri_out",
            "flags",
            "dname",
            "bandwidth",
            "dom_xml"
          ],
          "line": 4605
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "dconn->flags",
            "error"
          ],
          "line": 4601
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckConnectReturn",
          "args": [
            "dconn",
            "-1"
          ],
          "line": 4600
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 4598
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"dconn=%p, cookiein=%p, cookieinlen=%d, cookieout=%p, \"\n              \"cookieoutlen=%p, uri_in=%s, uri_out=%p, flags=0x%lx, dname=%s, \"\n              \"bandwidth=%lu, dom_xml=%s\"",
            "dconn",
            "cookiein",
            "cookieinlen",
            "cookieout",
            "cookieoutlen",
            "NULLSTR(uri_in)",
            "uri_out",
            "flags",
            "NULLSTR(dname)",
            "bandwidth",
            "NULLSTR(dom_xml)"
          ],
          "line": 4592
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "dom_xml"
          ],
          "line": 4596
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "dname"
          ],
          "line": 4596
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "uri_in"
          ],
          "line": 4595
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainMigratePrepare3(virConnectPtr dconn,\n                         const char *cookiein,\n                         int cookieinlen,\n                         char **cookieout,\n                         int *cookieoutlen,\n                         const char *uri_in,\n                         char **uri_out,\n                         unsigned long flags,\n                         const char *dname,\n                         unsigned long bandwidth,\n                         const char *dom_xml)\n{\n    VIR_DEBUG(\"dconn=%p, cookiein=%p, cookieinlen=%d, cookieout=%p, \"\n              \"cookieoutlen=%p, uri_in=%s, uri_out=%p, flags=0x%lx, dname=%s, \"\n              \"bandwidth=%lu, dom_xml=%s\",\n              dconn, cookiein, cookieinlen, cookieout, cookieoutlen, NULLSTR(uri_in),\n              uri_out, flags, NULLSTR(dname), bandwidth, NULLSTR(dom_xml));\n\n    virResetLastError();\n\n    virCheckConnectReturn(dconn, -1);\n    virCheckReadOnlyGoto(dconn->flags, error);\n\n    if (dconn->driver->domainMigratePrepare3) {\n        int ret;\n        ret = dconn->driver->domainMigratePrepare3(dconn,\n                                                   cookiein, cookieinlen,\n                                                   cookieout, cookieoutlen,\n                                                   uri_in, uri_out,\n                                                   flags, dname, bandwidth,\n                                                   dom_xml);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(dconn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainMigrateBegin3",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "4533-4572",
    "snippet": "char *\nvirDomainMigrateBegin3(virDomainPtr domain,\n                       const char *xmlin,\n                       char **cookieout,\n                       int *cookieoutlen,\n                       unsigned long flags,\n                       const char *dname,\n                       unsigned long bandwidth)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"xmlin=%s cookieout=%p, cookieoutlen=%p, \"\n                     \"flags=0x%lx, dname=%s, bandwidth=%lu\",\n                     NULLSTR(xmlin), cookieout, cookieoutlen, flags,\n                     NULLSTR(dname), bandwidth);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, NULL);\n    conn = domain->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->driver->domainMigrateBegin3) {\n        char *xml;\n        xml = conn->driver->domainMigrateBegin3(domain, xmlin,\n                                                cookieout, cookieoutlen,\n                                                flags, dname, bandwidth);\n        VIR_DEBUG(\"xml %s\", NULLSTR(xml));\n        if (!xml)\n            goto error;\n        return xml;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return NULL;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "domain->conn"
          ],
          "line": 4570
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 4567
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"xml %s\"",
            "NULLSTR(xml)"
          ],
          "line": 4561
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "xml"
          ],
          "line": 4561
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainMigrateBegin3",
          "args": [
            "domain",
            "xmlin",
            "cookieout",
            "cookieoutlen",
            "flags",
            "dname",
            "bandwidth"
          ],
          "line": 4558
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "conn->flags",
            "error"
          ],
          "line": 4554
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "domain",
            "NULL"
          ],
          "line": 4551
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 4549
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "domain",
            "\"xmlin=%s cookieout=%p, cookieoutlen=%p, \"\n                     \"flags=0x%lx, dname=%s, bandwidth=%lu\"",
            "NULLSTR(xmlin)",
            "cookieout",
            "cookieoutlen",
            "flags",
            "NULLSTR(dname)",
            "bandwidth"
          ],
          "line": 4544
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "dname"
          ],
          "line": 4547
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "xmlin"
          ],
          "line": 4546
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nchar *\nvirDomainMigrateBegin3(virDomainPtr domain,\n                       const char *xmlin,\n                       char **cookieout,\n                       int *cookieoutlen,\n                       unsigned long flags,\n                       const char *dname,\n                       unsigned long bandwidth)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"xmlin=%s cookieout=%p, cookieoutlen=%p, \"\n                     \"flags=0x%lx, dname=%s, bandwidth=%lu\",\n                     NULLSTR(xmlin), cookieout, cookieoutlen, flags,\n                     NULLSTR(dname), bandwidth);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, NULL);\n    conn = domain->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->driver->domainMigrateBegin3) {\n        char *xml;\n        xml = conn->driver->domainMigrateBegin3(domain, xmlin,\n                                                cookieout, cookieoutlen,\n                                                flags, dname, bandwidth);\n        VIR_DEBUG(\"xml %s\", NULLSTR(xml));\n        if (!xml)\n            goto error;\n        return xml;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return NULL;\n}"
  },
  {
    "function_name": "virDomainMigratePrepareTunnel",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "4489-4526",
    "snippet": "int\nvirDomainMigratePrepareTunnel(virConnectPtr conn,\n                              virStreamPtr st,\n                              unsigned long flags,\n                              const char *dname,\n                              unsigned long bandwidth,\n                              const char *dom_xml)\n{\n    VIR_DEBUG(\"conn=%p, stream=%p, flags=0x%lx, dname=%s, \"\n              \"bandwidth=%lu, dom_xml=%s\", conn, st, flags,\n              NULLSTR(dname), bandwidth, NULLSTR(dom_xml));\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, -1);\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn != st->conn) {\n        virReportInvalidArg(conn, \"%s\",\n                            _(\"conn must match stream connection\"));\n        goto error;\n    }\n\n    if (conn->driver->domainMigratePrepareTunnel) {\n        int rv = conn->driver->domainMigratePrepareTunnel(conn, st,\n                                                          flags, dname,\n                                                          bandwidth, dom_xml);\n        if (rv < 0)\n            goto error;\n        return rv;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "conn"
          ],
          "line": 4524
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 4521
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainMigratePrepareTunnel",
          "args": [
            "conn",
            "st",
            "flags",
            "dname",
            "bandwidth",
            "dom_xml"
          ],
          "line": 4513
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportInvalidArg",
          "args": [
            "conn",
            "\"%s\"",
            "_(\"conn must match stream connection\")"
          ],
          "line": 4507
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"conn must match stream connection\""
          ],
          "line": 4508
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "conn->flags",
            "error"
          ],
          "line": 4504
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckConnectReturn",
          "args": [
            "conn",
            "-1"
          ],
          "line": 4503
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 4501
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"conn=%p, stream=%p, flags=0x%lx, dname=%s, \"\n              \"bandwidth=%lu, dom_xml=%s\"",
            "conn",
            "st",
            "flags",
            "NULLSTR(dname)",
            "bandwidth",
            "NULLSTR(dom_xml)"
          ],
          "line": 4497
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "dom_xml"
          ],
          "line": 4499
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "dname"
          ],
          "line": 4499
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainMigratePrepareTunnel(virConnectPtr conn,\n                              virStreamPtr st,\n                              unsigned long flags,\n                              const char *dname,\n                              unsigned long bandwidth,\n                              const char *dom_xml)\n{\n    VIR_DEBUG(\"conn=%p, stream=%p, flags=0x%lx, dname=%s, \"\n              \"bandwidth=%lu, dom_xml=%s\", conn, st, flags,\n              NULLSTR(dname), bandwidth, NULLSTR(dom_xml));\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, -1);\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn != st->conn) {\n        virReportInvalidArg(conn, \"%s\",\n                            _(\"conn must match stream connection\"));\n        goto error;\n    }\n\n    if (conn->driver->domainMigratePrepareTunnel) {\n        int rv = conn->driver->domainMigratePrepareTunnel(conn, st,\n                                                          flags, dname,\n                                                          bandwidth, dom_xml);\n        if (rv < 0)\n            goto error;\n        return rv;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainMigrateFinish2",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "4448-4482",
    "snippet": "virDomainPtr\nvirDomainMigrateFinish2(virConnectPtr dconn,\n                        const char *dname,\n                        const char *cookie,\n                        int cookielen,\n                        const char *uri,\n                        unsigned long flags,\n                        int retcode)\n{\n    VIR_DEBUG(\"dconn=%p, dname=%s, cookie=%p, cookielen=%d, uri=%s, \"\n              \"flags=0x%lx, retcode=%d\", dconn, NULLSTR(dname), cookie,\n              cookielen, NULLSTR(uri), flags, retcode);\n\n    virResetLastError();\n\n    virCheckConnectReturn(dconn, NULL);\n    virCheckReadOnlyGoto(dconn->flags, error);\n\n    if (dconn->driver->domainMigrateFinish2) {\n        virDomainPtr ret;\n        ret = dconn->driver->domainMigrateFinish2(dconn, dname,\n                                                  cookie, cookielen,\n                                                  uri, flags,\n                                                  retcode);\n        if (!ret && !retcode)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(dconn);\n    return NULL;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "dconn"
          ],
          "line": 4480
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 4477
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dconn->driver->domainMigrateFinish2",
          "args": [
            "dconn",
            "dname",
            "cookie",
            "cookielen",
            "uri",
            "flags",
            "retcode"
          ],
          "line": 4468
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "dconn->flags",
            "error"
          ],
          "line": 4464
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckConnectReturn",
          "args": [
            "dconn",
            "NULL"
          ],
          "line": 4463
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 4461
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"dconn=%p, dname=%s, cookie=%p, cookielen=%d, uri=%s, \"\n              \"flags=0x%lx, retcode=%d\"",
            "dconn",
            "NULLSTR(dname)",
            "cookie",
            "cookielen",
            "NULLSTR(uri)",
            "flags",
            "retcode"
          ],
          "line": 4457
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "uri"
          ],
          "line": 4459
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "dname"
          ],
          "line": 4458
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nvirDomainPtr\nvirDomainMigrateFinish2(virConnectPtr dconn,\n                        const char *dname,\n                        const char *cookie,\n                        int cookielen,\n                        const char *uri,\n                        unsigned long flags,\n                        int retcode)\n{\n    VIR_DEBUG(\"dconn=%p, dname=%s, cookie=%p, cookielen=%d, uri=%s, \"\n              \"flags=0x%lx, retcode=%d\", dconn, NULLSTR(dname), cookie,\n              cookielen, NULLSTR(uri), flags, retcode);\n\n    virResetLastError();\n\n    virCheckConnectReturn(dconn, NULL);\n    virCheckReadOnlyGoto(dconn->flags, error);\n\n    if (dconn->driver->domainMigrateFinish2) {\n        virDomainPtr ret;\n        ret = dconn->driver->domainMigrateFinish2(dconn, dname,\n                                                  cookie, cookielen,\n                                                  uri, flags,\n                                                  retcode);\n        if (!ret && !retcode)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(dconn);\n    return NULL;\n}"
  },
  {
    "function_name": "virDomainMigratePrepare2",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "4404-4441",
    "snippet": "int\nvirDomainMigratePrepare2(virConnectPtr dconn,\n                         char **cookie,\n                         int *cookielen,\n                         const char *uri_in,\n                         char **uri_out,\n                         unsigned long flags,\n                         const char *dname,\n                         unsigned long bandwidth,\n                         const char *dom_xml)\n{\n    VIR_DEBUG(\"dconn=%p, cookie=%p, cookielen=%p, uri_in=%s, uri_out=%p,\"\n              \"flags=0x%lx, dname=%s, bandwidth=%lu, dom_xml=%s\", dconn,\n              cookie, cookielen, NULLSTR(uri_in), uri_out, flags, NULLSTR(dname),\n              bandwidth, NULLSTR(dom_xml));\n\n    virResetLastError();\n\n    virCheckConnectReturn(dconn, -1);\n    virCheckReadOnlyGoto(dconn->flags, error);\n\n    if (dconn->driver->domainMigratePrepare2) {\n        int ret;\n        ret = dconn->driver->domainMigratePrepare2(dconn, cookie, cookielen,\n                                                   uri_in, uri_out,\n                                                   flags, dname, bandwidth,\n                                                   dom_xml);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(dconn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "dconn"
          ],
          "line": 4439
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 4436
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dconn->driver->domainMigratePrepare2",
          "args": [
            "dconn",
            "cookie",
            "cookielen",
            "uri_in",
            "uri_out",
            "flags",
            "dname",
            "bandwidth",
            "dom_xml"
          ],
          "line": 4427
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "dconn->flags",
            "error"
          ],
          "line": 4423
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckConnectReturn",
          "args": [
            "dconn",
            "-1"
          ],
          "line": 4422
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 4420
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"dconn=%p, cookie=%p, cookielen=%p, uri_in=%s, uri_out=%p,\"\n              \"flags=0x%lx, dname=%s, bandwidth=%lu, dom_xml=%s\"",
            "dconn",
            "cookie",
            "cookielen",
            "NULLSTR(uri_in)",
            "uri_out",
            "flags",
            "NULLSTR(dname)",
            "bandwidth",
            "NULLSTR(dom_xml)"
          ],
          "line": 4415
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "dom_xml"
          ],
          "line": 4418
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "dname"
          ],
          "line": 4417
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "uri_in"
          ],
          "line": 4417
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainMigratePrepare2(virConnectPtr dconn,\n                         char **cookie,\n                         int *cookielen,\n                         const char *uri_in,\n                         char **uri_out,\n                         unsigned long flags,\n                         const char *dname,\n                         unsigned long bandwidth,\n                         const char *dom_xml)\n{\n    VIR_DEBUG(\"dconn=%p, cookie=%p, cookielen=%p, uri_in=%s, uri_out=%p,\"\n              \"flags=0x%lx, dname=%s, bandwidth=%lu, dom_xml=%s\", dconn,\n              cookie, cookielen, NULLSTR(uri_in), uri_out, flags, NULLSTR(dname),\n              bandwidth, NULLSTR(dom_xml));\n\n    virResetLastError();\n\n    virCheckConnectReturn(dconn, -1);\n    virCheckReadOnlyGoto(dconn->flags, error);\n\n    if (dconn->driver->domainMigratePrepare2) {\n        int ret;\n        ret = dconn->driver->domainMigratePrepare2(dconn, cookie, cookielen,\n                                                   uri_in, uri_out,\n                                                   flags, dname, bandwidth,\n                                                   dom_xml);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(dconn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainMigrateFinish",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "4365-4397",
    "snippet": "virDomainPtr\nvirDomainMigrateFinish(virConnectPtr dconn,\n                       const char *dname,\n                       const char *cookie,\n                       int cookielen,\n                       const char *uri,\n                       unsigned long flags)\n{\n    VIR_DEBUG(\"dconn=%p, dname=%s, cookie=%p, cookielen=%d, uri=%s, \"\n              \"flags=0x%lx\", dconn, NULLSTR(dname), cookie, cookielen,\n              NULLSTR(uri), flags);\n\n    virResetLastError();\n\n    virCheckConnectReturn(dconn, NULL);\n    virCheckReadOnlyGoto(dconn->flags, error);\n\n    if (dconn->driver->domainMigrateFinish) {\n        virDomainPtr ret;\n        ret = dconn->driver->domainMigrateFinish(dconn, dname,\n                                                 cookie, cookielen,\n                                                 uri, flags);\n        if (!ret)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(dconn);\n    return NULL;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "dconn"
          ],
          "line": 4395
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 4392
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dconn->driver->domainMigrateFinish",
          "args": [
            "dconn",
            "dname",
            "cookie",
            "cookielen",
            "uri",
            "flags"
          ],
          "line": 4384
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "dconn->flags",
            "error"
          ],
          "line": 4380
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckConnectReturn",
          "args": [
            "dconn",
            "NULL"
          ],
          "line": 4379
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 4377
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"dconn=%p, dname=%s, cookie=%p, cookielen=%d, uri=%s, \"\n              \"flags=0x%lx\"",
            "dconn",
            "NULLSTR(dname)",
            "cookie",
            "cookielen",
            "NULLSTR(uri)",
            "flags"
          ],
          "line": 4373
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "uri"
          ],
          "line": 4375
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "dname"
          ],
          "line": 4374
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nvirDomainPtr\nvirDomainMigrateFinish(virConnectPtr dconn,\n                       const char *dname,\n                       const char *cookie,\n                       int cookielen,\n                       const char *uri,\n                       unsigned long flags)\n{\n    VIR_DEBUG(\"dconn=%p, dname=%s, cookie=%p, cookielen=%d, uri=%s, \"\n              \"flags=0x%lx\", dconn, NULLSTR(dname), cookie, cookielen,\n              NULLSTR(uri), flags);\n\n    virResetLastError();\n\n    virCheckConnectReturn(dconn, NULL);\n    virCheckReadOnlyGoto(dconn->flags, error);\n\n    if (dconn->driver->domainMigrateFinish) {\n        virDomainPtr ret;\n        ret = dconn->driver->domainMigrateFinish(dconn, dname,\n                                                 cookie, cookielen,\n                                                 uri, flags);\n        if (!ret)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(dconn);\n    return NULL;\n}"
  },
  {
    "function_name": "virDomainMigratePerform",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "4321-4358",
    "snippet": "int\nvirDomainMigratePerform(virDomainPtr domain,\n                        const char *cookie,\n                        int cookielen,\n                        const char *uri,\n                        unsigned long flags,\n                        const char *dname,\n                        unsigned long bandwidth)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"cookie=%p, cookielen=%d, uri=%s, flags=0x%lx, \"\n                     \"dname=%s, bandwidth=%lu\", cookie, cookielen, uri, flags,\n                     NULLSTR(dname), bandwidth);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->driver->domainMigratePerform) {\n        int ret;\n        ret = conn->driver->domainMigratePerform(domain, cookie, cookielen,\n                                                 uri,\n                                                 flags, dname, bandwidth);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "domain->conn"
          ],
          "line": 4356
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 4353
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainMigratePerform",
          "args": [
            "domain",
            "cookie",
            "cookielen",
            "uri",
            "flags",
            "dname",
            "bandwidth"
          ],
          "line": 4345
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "conn->flags",
            "error"
          ],
          "line": 4341
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "domain",
            "-1"
          ],
          "line": 4338
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 4336
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "domain",
            "\"cookie=%p, cookielen=%d, uri=%s, flags=0x%lx, \"\n                     \"dname=%s, bandwidth=%lu\"",
            "cookie",
            "cookielen",
            "uri",
            "flags",
            "NULLSTR(dname)",
            "bandwidth"
          ],
          "line": 4332
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "dname"
          ],
          "line": 4334
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainMigratePerform(virDomainPtr domain,\n                        const char *cookie,\n                        int cookielen,\n                        const char *uri,\n                        unsigned long flags,\n                        const char *dname,\n                        unsigned long bandwidth)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"cookie=%p, cookielen=%d, uri=%s, flags=0x%lx, \"\n                     \"dname=%s, bandwidth=%lu\", cookie, cookielen, uri, flags,\n                     NULLSTR(dname), bandwidth);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->driver->domainMigratePerform) {\n        int ret;\n        ret = conn->driver->domainMigratePerform(domain, cookie, cookielen,\n                                                 uri,\n                                                 flags, dname, bandwidth);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainMigratePrepare",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "4280-4314",
    "snippet": "int\nvirDomainMigratePrepare(virConnectPtr dconn,\n                        char **cookie,\n                        int *cookielen,\n                        const char *uri_in,\n                        char **uri_out,\n                        unsigned long flags,\n                        const char *dname,\n                        unsigned long bandwidth)\n{\n    VIR_DEBUG(\"dconn=%p, cookie=%p, cookielen=%p, uri_in=%s, uri_out=%p, \"\n              \"flags=0x%lx, dname=%s, bandwidth=%lu\", dconn, cookie, cookielen,\n              NULLSTR(uri_in), uri_out, flags, NULLSTR(dname), bandwidth);\n\n    virResetLastError();\n\n    virCheckConnectReturn(dconn, -1);\n    virCheckReadOnlyGoto(dconn->flags, error);\n\n    if (dconn->driver->domainMigratePrepare) {\n        int ret;\n        ret = dconn->driver->domainMigratePrepare(dconn, cookie, cookielen,\n                                                  uri_in, uri_out,\n                                                  flags, dname, bandwidth);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(dconn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "dconn"
          ],
          "line": 4312
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 4309
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dconn->driver->domainMigratePrepare",
          "args": [
            "dconn",
            "cookie",
            "cookielen",
            "uri_in",
            "uri_out",
            "flags",
            "dname",
            "bandwidth"
          ],
          "line": 4301
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "dconn->flags",
            "error"
          ],
          "line": 4297
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckConnectReturn",
          "args": [
            "dconn",
            "-1"
          ],
          "line": 4296
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 4294
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"dconn=%p, cookie=%p, cookielen=%p, uri_in=%s, uri_out=%p, \"\n              \"flags=0x%lx, dname=%s, bandwidth=%lu\"",
            "dconn",
            "cookie",
            "cookielen",
            "NULLSTR(uri_in)",
            "uri_out",
            "flags",
            "NULLSTR(dname)",
            "bandwidth"
          ],
          "line": 4290
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "dname"
          ],
          "line": 4292
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "uri_in"
          ],
          "line": 4292
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainMigratePrepare(virConnectPtr dconn,\n                        char **cookie,\n                        int *cookielen,\n                        const char *uri_in,\n                        char **uri_out,\n                        unsigned long flags,\n                        const char *dname,\n                        unsigned long bandwidth)\n{\n    VIR_DEBUG(\"dconn=%p, cookie=%p, cookielen=%p, uri_in=%s, uri_out=%p, \"\n              \"flags=0x%lx, dname=%s, bandwidth=%lu\", dconn, cookie, cookielen,\n              NULLSTR(uri_in), uri_out, flags, NULLSTR(dname), bandwidth);\n\n    virResetLastError();\n\n    virCheckConnectReturn(dconn, -1);\n    virCheckReadOnlyGoto(dconn->flags, error);\n\n    if (dconn->driver->domainMigratePrepare) {\n        int ret;\n        ret = dconn->driver->domainMigratePrepare(dconn, cookie, cookielen,\n                                                  uri_in, uri_out,\n                                                  flags, dname, bandwidth);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(dconn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainMigrateToURI3",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "4235-4273",
    "snippet": "int\nvirDomainMigrateToURI3(virDomainPtr domain,\n                       const char *dconnuri,\n                       virTypedParameterPtr params,\n                       unsigned int nparams,\n                       unsigned int flags)\n{\n    VIR_DOMAIN_DEBUG(domain, \"dconnuri=%s, params=%p, nparms=%u flags=0x%x\",\n                     NULLSTR(dconnuri), params, nparams, flags);\n    VIR_TYPED_PARAMS_DEBUG(params, nparams);\n\n    virResetLastError();\n\n    /* First checkout the source */\n    virCheckDomainReturn(domain, -1);\n    virCheckReadOnlyGoto(domain->conn->flags, error);\n\n    VIR_EXCLUSIVE_FLAGS_GOTO(VIR_MIGRATE_TUNNELLED,\n                             VIR_MIGRATE_PARALLEL,\n                             error);\n\n    if (virDomainMigrateUnmanagedCheckCompat(domain, flags) < 0)\n        goto error;\n\n    if (flags & VIR_MIGRATE_PEER2PEER)\n        virCheckNonNullArgGoto(dconnuri, error);\n    else\n        dconnuri = NULL;\n\n    if (virDomainMigrateUnmanagedParams(domain, dconnuri,\n                                        params, nparams, flags) < 0)\n        goto error;\n\n    return 0;\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "domain->conn"
          ],
          "line": 4271
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainMigrateUnmanagedParams",
          "args": [
            "domain",
            "dconnuri",
            "params",
            "nparams",
            "flags"
          ],
          "line": 4264
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainMigrateUnmanagedParams",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
          "lines": "3412-3456",
          "snippet": "static int\nvirDomainMigrateUnmanagedParams(virDomainPtr domain,\n                                const char *dconnuri,\n                                virTypedParameterPtr params,\n                                int nparams,\n                                unsigned int flags)\n{\n    VIR_DOMAIN_DEBUG(domain, \"dconnuri=%s, params=%p, nparams=%d, flags=0x%x\",\n                     NULLSTR(dconnuri), params, nparams, flags);\n    VIR_TYPED_PARAMS_DEBUG(params, nparams);\n\n    if ((flags & VIR_MIGRATE_PEER2PEER) &&\n        virDomainMigrateCheckNotLocal(dconnuri) < 0)\n        return -1;\n\n    if ((flags & VIR_MIGRATE_PEER2PEER) &&\n        VIR_DRV_SUPPORTS_FEATURE(domain->conn->driver, domain->conn,\n                                 VIR_DRV_FEATURE_MIGRATION_PARAMS)) {\n        VIR_DEBUG(\"Using migration protocol 3 with extensible parameters\");\n        if (!domain->conn->driver->domainMigratePerform3Params) {\n            virReportUnsupportedError();\n            return -1;\n        }\n        return domain->conn->driver->domainMigratePerform3Params\n                (domain, dconnuri, params, nparams,\n                 NULL, 0, NULL, NULL, flags);\n    } else if (VIR_DRV_SUPPORTS_FEATURE(domain->conn->driver, domain->conn,\n                                        VIR_DRV_FEATURE_MIGRATION_V3)) {\n        VIR_DEBUG(\"Using migration protocol 3\");\n        if (!domain->conn->driver->domainMigratePerform3) {\n            virReportUnsupportedError();\n            return -1;\n        }\n        return virDomainMigrateUnmanagedProto3(domain, dconnuri,\n                                               params, nparams, flags);\n    } else {\n        VIR_DEBUG(\"Using migration protocol 2\");\n        if (!domain->conn->driver->domainMigratePerform) {\n            virReportUnsupportedError();\n            return -1;\n        }\n        return virDomainMigrateUnmanagedProto2(domain, dconnuri,\n                                               params, nparams, flags);\n    }\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nstatic int\nvirDomainMigrateUnmanagedParams(virDomainPtr domain,\n                                const char *dconnuri,\n                                virTypedParameterPtr params,\n                                int nparams,\n                                unsigned int flags)\n{\n    VIR_DOMAIN_DEBUG(domain, \"dconnuri=%s, params=%p, nparams=%d, flags=0x%x\",\n                     NULLSTR(dconnuri), params, nparams, flags);\n    VIR_TYPED_PARAMS_DEBUG(params, nparams);\n\n    if ((flags & VIR_MIGRATE_PEER2PEER) &&\n        virDomainMigrateCheckNotLocal(dconnuri) < 0)\n        return -1;\n\n    if ((flags & VIR_MIGRATE_PEER2PEER) &&\n        VIR_DRV_SUPPORTS_FEATURE(domain->conn->driver, domain->conn,\n                                 VIR_DRV_FEATURE_MIGRATION_PARAMS)) {\n        VIR_DEBUG(\"Using migration protocol 3 with extensible parameters\");\n        if (!domain->conn->driver->domainMigratePerform3Params) {\n            virReportUnsupportedError();\n            return -1;\n        }\n        return domain->conn->driver->domainMigratePerform3Params\n                (domain, dconnuri, params, nparams,\n                 NULL, 0, NULL, NULL, flags);\n    } else if (VIR_DRV_SUPPORTS_FEATURE(domain->conn->driver, domain->conn,\n                                        VIR_DRV_FEATURE_MIGRATION_V3)) {\n        VIR_DEBUG(\"Using migration protocol 3\");\n        if (!domain->conn->driver->domainMigratePerform3) {\n            virReportUnsupportedError();\n            return -1;\n        }\n        return virDomainMigrateUnmanagedProto3(domain, dconnuri,\n                                               params, nparams, flags);\n    } else {\n        VIR_DEBUG(\"Using migration protocol 2\");\n        if (!domain->conn->driver->domainMigratePerform) {\n            virReportUnsupportedError();\n            return -1;\n        }\n        return virDomainMigrateUnmanagedProto2(domain, dconnuri,\n                                               params, nparams, flags);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "dconnuri",
            "error"
          ],
          "line": 4260
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainMigrateUnmanagedCheckCompat",
          "args": [
            "domain",
            "flags"
          ],
          "line": 4256
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainMigrateUnmanagedCheckCompat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
          "lines": "4012-4048",
          "snippet": "static\nint virDomainMigrateUnmanagedCheckCompat(virDomainPtr domain,\n                                         unsigned int flags)\n{\n    VIR_EXCLUSIVE_FLAGS_RET(VIR_MIGRATE_NON_SHARED_DISK,\n                            VIR_MIGRATE_NON_SHARED_INC,\n                            -1);\n\n    if (flags & VIR_MIGRATE_OFFLINE &&\n        !VIR_DRV_SUPPORTS_FEATURE(domain->conn->driver, domain->conn,\n                                  VIR_DRV_FEATURE_MIGRATION_OFFLINE)) {\n        virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED, \"%s\",\n                       _(\"offline migration is not supported by \"\n                         \"the source host\"));\n        return -1;\n    }\n\n    if (flags & VIR_MIGRATE_PEER2PEER) {\n        if (!VIR_DRV_SUPPORTS_FEATURE(domain->conn->driver, domain->conn,\n                                      VIR_DRV_FEATURE_MIGRATION_P2P)) {\n            virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED, \"%s\",\n                           _(\"p2p migration is not supported by \"\n                             \"the source host\"));\n            return -1;\n        }\n    } else {\n        if (!VIR_DRV_SUPPORTS_FEATURE(domain->conn->driver, domain->conn,\n                                      VIR_DRV_FEATURE_MIGRATION_DIRECT)) {\n            virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED, \"%s\",\n                           _(\"direct migration is not supported by \"\n                             \"the source host\"));\n            return -1;\n        }\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nstatic\nint virDomainMigrateUnmanagedCheckCompat(virDomainPtr domain,\n                                         unsigned int flags)\n{\n    VIR_EXCLUSIVE_FLAGS_RET(VIR_MIGRATE_NON_SHARED_DISK,\n                            VIR_MIGRATE_NON_SHARED_INC,\n                            -1);\n\n    if (flags & VIR_MIGRATE_OFFLINE &&\n        !VIR_DRV_SUPPORTS_FEATURE(domain->conn->driver, domain->conn,\n                                  VIR_DRV_FEATURE_MIGRATION_OFFLINE)) {\n        virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED, \"%s\",\n                       _(\"offline migration is not supported by \"\n                         \"the source host\"));\n        return -1;\n    }\n\n    if (flags & VIR_MIGRATE_PEER2PEER) {\n        if (!VIR_DRV_SUPPORTS_FEATURE(domain->conn->driver, domain->conn,\n                                      VIR_DRV_FEATURE_MIGRATION_P2P)) {\n            virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED, \"%s\",\n                           _(\"p2p migration is not supported by \"\n                             \"the source host\"));\n            return -1;\n        }\n    } else {\n        if (!VIR_DRV_SUPPORTS_FEATURE(domain->conn->driver, domain->conn,\n                                      VIR_DRV_FEATURE_MIGRATION_DIRECT)) {\n            virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED, \"%s\",\n                           _(\"direct migration is not supported by \"\n                             \"the source host\"));\n            return -1;\n        }\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_EXCLUSIVE_FLAGS_GOTO",
          "args": [
            "VIR_MIGRATE_TUNNELLED",
            "VIR_MIGRATE_PARALLEL",
            "error"
          ],
          "line": 4252
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "domain->conn->flags",
            "error"
          ],
          "line": 4250
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "domain",
            "-1"
          ],
          "line": 4249
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 4246
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_TYPED_PARAMS_DEBUG",
          "args": [
            "params",
            "nparams"
          ],
          "line": 4244
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "domain",
            "\"dconnuri=%s, params=%p, nparms=%u flags=0x%x\"",
            "NULLSTR(dconnuri)",
            "params",
            "nparams",
            "flags"
          ],
          "line": 4242
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "dconnuri"
          ],
          "line": 4243
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainMigrateToURI3(virDomainPtr domain,\n                       const char *dconnuri,\n                       virTypedParameterPtr params,\n                       unsigned int nparams,\n                       unsigned int flags)\n{\n    VIR_DOMAIN_DEBUG(domain, \"dconnuri=%s, params=%p, nparms=%u flags=0x%x\",\n                     NULLSTR(dconnuri), params, nparams, flags);\n    VIR_TYPED_PARAMS_DEBUG(params, nparams);\n\n    virResetLastError();\n\n    /* First checkout the source */\n    virCheckDomainReturn(domain, -1);\n    virCheckReadOnlyGoto(domain->conn->flags, error);\n\n    VIR_EXCLUSIVE_FLAGS_GOTO(VIR_MIGRATE_TUNNELLED,\n                             VIR_MIGRATE_PARALLEL,\n                             error);\n\n    if (virDomainMigrateUnmanagedCheckCompat(domain, flags) < 0)\n        goto error;\n\n    if (flags & VIR_MIGRATE_PEER2PEER)\n        virCheckNonNullArgGoto(dconnuri, error);\n    else\n        dconnuri = NULL;\n\n    if (virDomainMigrateUnmanagedParams(domain, dconnuri,\n                                        params, nparams, flags) < 0)\n        goto error;\n\n    return 0;\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainMigrateToURI2",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "4155-4196",
    "snippet": "int\nvirDomainMigrateToURI2(virDomainPtr domain,\n                       const char *dconnuri,\n                       const char *miguri,\n                       const char *dxml,\n                       unsigned long flags,\n                       const char *dname,\n                       unsigned long bandwidth)\n{\n    VIR_DOMAIN_DEBUG(domain, \"dconnuri=%s, miguri=%s, dxml=%s, \"\n                     \"flags=0x%lx, dname=%s, bandwidth=%lu\",\n                     NULLSTR(dconnuri), NULLSTR(miguri), NULLSTR(dxml),\n                     flags, NULLSTR(dname), bandwidth);\n\n    virResetLastError();\n\n    /* First checkout the source */\n    virCheckDomainReturn(domain, -1);\n    virCheckReadOnlyGoto(domain->conn->flags, error);\n\n    VIR_EXCLUSIVE_FLAGS_GOTO(VIR_MIGRATE_TUNNELLED,\n                             VIR_MIGRATE_PARALLEL,\n                             error);\n\n    if (virDomainMigrateUnmanagedCheckCompat(domain, flags) < 0)\n        goto error;\n\n    if (flags & VIR_MIGRATE_PEER2PEER)\n        virCheckNonNullArgGoto(dconnuri, error);\n    else\n        dconnuri = NULL;\n\n    if (virDomainMigrateUnmanaged(domain, dxml, flags,\n                                  dname, dconnuri, miguri, bandwidth) < 0)\n        goto error;\n\n    return 0;\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "domain->conn"
          ],
          "line": 4194
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainMigrateUnmanaged",
          "args": [
            "domain",
            "dxml",
            "flags",
            "dname",
            "dconnuri",
            "miguri",
            "bandwidth"
          ],
          "line": 4187
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainMigrateUnmanaged",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
          "lines": "3459-3496",
          "snippet": "static int\nvirDomainMigrateUnmanaged(virDomainPtr domain,\n                          const char *xmlin,\n                          unsigned int flags,\n                          const char *dname,\n                          const char *dconnuri,\n                          const char *miguri,\n                          unsigned long long bandwidth)\n{\n    int ret = -1;\n    virTypedParameterPtr params = NULL;\n    int nparams = 0;\n    int maxparams = 0;\n\n    if (miguri &&\n        virTypedParamsAddString(&params, &nparams, &maxparams,\n                                VIR_MIGRATE_PARAM_URI, miguri) < 0)\n        goto cleanup;\n    if (dname &&\n        virTypedParamsAddString(&params, &nparams, &maxparams,\n                                VIR_MIGRATE_PARAM_DEST_NAME, dname) < 0)\n        goto cleanup;\n    if (xmlin &&\n        virTypedParamsAddString(&params, &nparams, &maxparams,\n                                VIR_MIGRATE_PARAM_DEST_XML, xmlin) < 0)\n        goto cleanup;\n    if (virTypedParamsAddULLong(&params, &nparams, &maxparams,\n                                VIR_MIGRATE_PARAM_BANDWIDTH, bandwidth) < 0)\n        goto cleanup;\n\n    ret = virDomainMigrateUnmanagedParams(domain, dconnuri, params,\n                                          nparams, flags);\n\n cleanup:\n    virTypedParamsFree(params, nparams);\n\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nstatic int\nvirDomainMigrateUnmanaged(virDomainPtr domain,\n                          const char *xmlin,\n                          unsigned int flags,\n                          const char *dname,\n                          const char *dconnuri,\n                          const char *miguri,\n                          unsigned long long bandwidth)\n{\n    int ret = -1;\n    virTypedParameterPtr params = NULL;\n    int nparams = 0;\n    int maxparams = 0;\n\n    if (miguri &&\n        virTypedParamsAddString(&params, &nparams, &maxparams,\n                                VIR_MIGRATE_PARAM_URI, miguri) < 0)\n        goto cleanup;\n    if (dname &&\n        virTypedParamsAddString(&params, &nparams, &maxparams,\n                                VIR_MIGRATE_PARAM_DEST_NAME, dname) < 0)\n        goto cleanup;\n    if (xmlin &&\n        virTypedParamsAddString(&params, &nparams, &maxparams,\n                                VIR_MIGRATE_PARAM_DEST_XML, xmlin) < 0)\n        goto cleanup;\n    if (virTypedParamsAddULLong(&params, &nparams, &maxparams,\n                                VIR_MIGRATE_PARAM_BANDWIDTH, bandwidth) < 0)\n        goto cleanup;\n\n    ret = virDomainMigrateUnmanagedParams(domain, dconnuri, params,\n                                          nparams, flags);\n\n cleanup:\n    virTypedParamsFree(params, nparams);\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "dconnuri",
            "error"
          ],
          "line": 4183
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainMigrateUnmanagedCheckCompat",
          "args": [
            "domain",
            "flags"
          ],
          "line": 4179
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainMigrateUnmanagedCheckCompat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
          "lines": "4012-4048",
          "snippet": "static\nint virDomainMigrateUnmanagedCheckCompat(virDomainPtr domain,\n                                         unsigned int flags)\n{\n    VIR_EXCLUSIVE_FLAGS_RET(VIR_MIGRATE_NON_SHARED_DISK,\n                            VIR_MIGRATE_NON_SHARED_INC,\n                            -1);\n\n    if (flags & VIR_MIGRATE_OFFLINE &&\n        !VIR_DRV_SUPPORTS_FEATURE(domain->conn->driver, domain->conn,\n                                  VIR_DRV_FEATURE_MIGRATION_OFFLINE)) {\n        virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED, \"%s\",\n                       _(\"offline migration is not supported by \"\n                         \"the source host\"));\n        return -1;\n    }\n\n    if (flags & VIR_MIGRATE_PEER2PEER) {\n        if (!VIR_DRV_SUPPORTS_FEATURE(domain->conn->driver, domain->conn,\n                                      VIR_DRV_FEATURE_MIGRATION_P2P)) {\n            virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED, \"%s\",\n                           _(\"p2p migration is not supported by \"\n                             \"the source host\"));\n            return -1;\n        }\n    } else {\n        if (!VIR_DRV_SUPPORTS_FEATURE(domain->conn->driver, domain->conn,\n                                      VIR_DRV_FEATURE_MIGRATION_DIRECT)) {\n            virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED, \"%s\",\n                           _(\"direct migration is not supported by \"\n                             \"the source host\"));\n            return -1;\n        }\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nstatic\nint virDomainMigrateUnmanagedCheckCompat(virDomainPtr domain,\n                                         unsigned int flags)\n{\n    VIR_EXCLUSIVE_FLAGS_RET(VIR_MIGRATE_NON_SHARED_DISK,\n                            VIR_MIGRATE_NON_SHARED_INC,\n                            -1);\n\n    if (flags & VIR_MIGRATE_OFFLINE &&\n        !VIR_DRV_SUPPORTS_FEATURE(domain->conn->driver, domain->conn,\n                                  VIR_DRV_FEATURE_MIGRATION_OFFLINE)) {\n        virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED, \"%s\",\n                       _(\"offline migration is not supported by \"\n                         \"the source host\"));\n        return -1;\n    }\n\n    if (flags & VIR_MIGRATE_PEER2PEER) {\n        if (!VIR_DRV_SUPPORTS_FEATURE(domain->conn->driver, domain->conn,\n                                      VIR_DRV_FEATURE_MIGRATION_P2P)) {\n            virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED, \"%s\",\n                           _(\"p2p migration is not supported by \"\n                             \"the source host\"));\n            return -1;\n        }\n    } else {\n        if (!VIR_DRV_SUPPORTS_FEATURE(domain->conn->driver, domain->conn,\n                                      VIR_DRV_FEATURE_MIGRATION_DIRECT)) {\n            virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED, \"%s\",\n                           _(\"direct migration is not supported by \"\n                             \"the source host\"));\n            return -1;\n        }\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_EXCLUSIVE_FLAGS_GOTO",
          "args": [
            "VIR_MIGRATE_TUNNELLED",
            "VIR_MIGRATE_PARALLEL",
            "error"
          ],
          "line": 4175
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "domain->conn->flags",
            "error"
          ],
          "line": 4173
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "domain",
            "-1"
          ],
          "line": 4172
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 4169
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "domain",
            "\"dconnuri=%s, miguri=%s, dxml=%s, \"\n                     \"flags=0x%lx, dname=%s, bandwidth=%lu\"",
            "NULLSTR(dconnuri)",
            "NULLSTR(miguri)",
            "NULLSTR(dxml)",
            "flags",
            "NULLSTR(dname)",
            "bandwidth"
          ],
          "line": 4164
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "dname"
          ],
          "line": 4167
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "dxml"
          ],
          "line": 4166
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "miguri"
          ],
          "line": 4166
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "dconnuri"
          ],
          "line": 4166
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainMigrateToURI2(virDomainPtr domain,\n                       const char *dconnuri,\n                       const char *miguri,\n                       const char *dxml,\n                       unsigned long flags,\n                       const char *dname,\n                       unsigned long bandwidth)\n{\n    VIR_DOMAIN_DEBUG(domain, \"dconnuri=%s, miguri=%s, dxml=%s, \"\n                     \"flags=0x%lx, dname=%s, bandwidth=%lu\",\n                     NULLSTR(dconnuri), NULLSTR(miguri), NULLSTR(dxml),\n                     flags, NULLSTR(dname), bandwidth);\n\n    virResetLastError();\n\n    /* First checkout the source */\n    virCheckDomainReturn(domain, -1);\n    virCheckReadOnlyGoto(domain->conn->flags, error);\n\n    VIR_EXCLUSIVE_FLAGS_GOTO(VIR_MIGRATE_TUNNELLED,\n                             VIR_MIGRATE_PARALLEL,\n                             error);\n\n    if (virDomainMigrateUnmanagedCheckCompat(domain, flags) < 0)\n        goto error;\n\n    if (flags & VIR_MIGRATE_PEER2PEER)\n        virCheckNonNullArgGoto(dconnuri, error);\n    else\n        dconnuri = NULL;\n\n    if (virDomainMigrateUnmanaged(domain, dxml, flags,\n                                  dname, dconnuri, miguri, bandwidth) < 0)\n        goto error;\n\n    return 0;\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainMigrateToURI",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "4079-4120",
    "snippet": "int\nvirDomainMigrateToURI(virDomainPtr domain,\n                      const char *duri,\n                      unsigned long flags,\n                      const char *dname,\n                      unsigned long bandwidth)\n{\n    const char *dconnuri = NULL;\n    const char *miguri = NULL;\n\n    VIR_DOMAIN_DEBUG(domain, \"duri=%p, flags=0x%lx, dname=%s, bandwidth=%lu\",\n                     NULLSTR(duri), flags, NULLSTR(dname), bandwidth);\n\n    virResetLastError();\n\n    /* First checkout the source */\n    virCheckDomainReturn(domain, -1);\n    virCheckReadOnlyGoto(domain->conn->flags, error);\n    virCheckNonNullArgGoto(duri, error);\n\n    VIR_EXCLUSIVE_FLAGS_GOTO(VIR_MIGRATE_TUNNELLED,\n                             VIR_MIGRATE_PARALLEL,\n                             error);\n\n    if (virDomainMigrateUnmanagedCheckCompat(domain, flags) < 0)\n        goto error;\n\n    if (flags & VIR_MIGRATE_PEER2PEER)\n        dconnuri = duri;\n    else\n        miguri = duri;\n\n    if (virDomainMigrateUnmanaged(domain, NULL, flags,\n                                  dname, dconnuri, miguri, bandwidth) < 0)\n        goto error;\n\n    return 0;\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "domain->conn"
          ],
          "line": 4118
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainMigrateUnmanaged",
          "args": [
            "domain",
            "NULL",
            "flags",
            "dname",
            "dconnuri",
            "miguri",
            "bandwidth"
          ],
          "line": 4111
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainMigrateUnmanaged",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
          "lines": "3459-3496",
          "snippet": "static int\nvirDomainMigrateUnmanaged(virDomainPtr domain,\n                          const char *xmlin,\n                          unsigned int flags,\n                          const char *dname,\n                          const char *dconnuri,\n                          const char *miguri,\n                          unsigned long long bandwidth)\n{\n    int ret = -1;\n    virTypedParameterPtr params = NULL;\n    int nparams = 0;\n    int maxparams = 0;\n\n    if (miguri &&\n        virTypedParamsAddString(&params, &nparams, &maxparams,\n                                VIR_MIGRATE_PARAM_URI, miguri) < 0)\n        goto cleanup;\n    if (dname &&\n        virTypedParamsAddString(&params, &nparams, &maxparams,\n                                VIR_MIGRATE_PARAM_DEST_NAME, dname) < 0)\n        goto cleanup;\n    if (xmlin &&\n        virTypedParamsAddString(&params, &nparams, &maxparams,\n                                VIR_MIGRATE_PARAM_DEST_XML, xmlin) < 0)\n        goto cleanup;\n    if (virTypedParamsAddULLong(&params, &nparams, &maxparams,\n                                VIR_MIGRATE_PARAM_BANDWIDTH, bandwidth) < 0)\n        goto cleanup;\n\n    ret = virDomainMigrateUnmanagedParams(domain, dconnuri, params,\n                                          nparams, flags);\n\n cleanup:\n    virTypedParamsFree(params, nparams);\n\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nstatic int\nvirDomainMigrateUnmanaged(virDomainPtr domain,\n                          const char *xmlin,\n                          unsigned int flags,\n                          const char *dname,\n                          const char *dconnuri,\n                          const char *miguri,\n                          unsigned long long bandwidth)\n{\n    int ret = -1;\n    virTypedParameterPtr params = NULL;\n    int nparams = 0;\n    int maxparams = 0;\n\n    if (miguri &&\n        virTypedParamsAddString(&params, &nparams, &maxparams,\n                                VIR_MIGRATE_PARAM_URI, miguri) < 0)\n        goto cleanup;\n    if (dname &&\n        virTypedParamsAddString(&params, &nparams, &maxparams,\n                                VIR_MIGRATE_PARAM_DEST_NAME, dname) < 0)\n        goto cleanup;\n    if (xmlin &&\n        virTypedParamsAddString(&params, &nparams, &maxparams,\n                                VIR_MIGRATE_PARAM_DEST_XML, xmlin) < 0)\n        goto cleanup;\n    if (virTypedParamsAddULLong(&params, &nparams, &maxparams,\n                                VIR_MIGRATE_PARAM_BANDWIDTH, bandwidth) < 0)\n        goto cleanup;\n\n    ret = virDomainMigrateUnmanagedParams(domain, dconnuri, params,\n                                          nparams, flags);\n\n cleanup:\n    virTypedParamsFree(params, nparams);\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainMigrateUnmanagedCheckCompat",
          "args": [
            "domain",
            "flags"
          ],
          "line": 4103
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainMigrateUnmanagedCheckCompat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
          "lines": "4012-4048",
          "snippet": "static\nint virDomainMigrateUnmanagedCheckCompat(virDomainPtr domain,\n                                         unsigned int flags)\n{\n    VIR_EXCLUSIVE_FLAGS_RET(VIR_MIGRATE_NON_SHARED_DISK,\n                            VIR_MIGRATE_NON_SHARED_INC,\n                            -1);\n\n    if (flags & VIR_MIGRATE_OFFLINE &&\n        !VIR_DRV_SUPPORTS_FEATURE(domain->conn->driver, domain->conn,\n                                  VIR_DRV_FEATURE_MIGRATION_OFFLINE)) {\n        virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED, \"%s\",\n                       _(\"offline migration is not supported by \"\n                         \"the source host\"));\n        return -1;\n    }\n\n    if (flags & VIR_MIGRATE_PEER2PEER) {\n        if (!VIR_DRV_SUPPORTS_FEATURE(domain->conn->driver, domain->conn,\n                                      VIR_DRV_FEATURE_MIGRATION_P2P)) {\n            virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED, \"%s\",\n                           _(\"p2p migration is not supported by \"\n                             \"the source host\"));\n            return -1;\n        }\n    } else {\n        if (!VIR_DRV_SUPPORTS_FEATURE(domain->conn->driver, domain->conn,\n                                      VIR_DRV_FEATURE_MIGRATION_DIRECT)) {\n            virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED, \"%s\",\n                           _(\"direct migration is not supported by \"\n                             \"the source host\"));\n            return -1;\n        }\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nstatic\nint virDomainMigrateUnmanagedCheckCompat(virDomainPtr domain,\n                                         unsigned int flags)\n{\n    VIR_EXCLUSIVE_FLAGS_RET(VIR_MIGRATE_NON_SHARED_DISK,\n                            VIR_MIGRATE_NON_SHARED_INC,\n                            -1);\n\n    if (flags & VIR_MIGRATE_OFFLINE &&\n        !VIR_DRV_SUPPORTS_FEATURE(domain->conn->driver, domain->conn,\n                                  VIR_DRV_FEATURE_MIGRATION_OFFLINE)) {\n        virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED, \"%s\",\n                       _(\"offline migration is not supported by \"\n                         \"the source host\"));\n        return -1;\n    }\n\n    if (flags & VIR_MIGRATE_PEER2PEER) {\n        if (!VIR_DRV_SUPPORTS_FEATURE(domain->conn->driver, domain->conn,\n                                      VIR_DRV_FEATURE_MIGRATION_P2P)) {\n            virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED, \"%s\",\n                           _(\"p2p migration is not supported by \"\n                             \"the source host\"));\n            return -1;\n        }\n    } else {\n        if (!VIR_DRV_SUPPORTS_FEATURE(domain->conn->driver, domain->conn,\n                                      VIR_DRV_FEATURE_MIGRATION_DIRECT)) {\n            virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED, \"%s\",\n                           _(\"direct migration is not supported by \"\n                             \"the source host\"));\n            return -1;\n        }\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_EXCLUSIVE_FLAGS_GOTO",
          "args": [
            "VIR_MIGRATE_TUNNELLED",
            "VIR_MIGRATE_PARALLEL",
            "error"
          ],
          "line": 4099
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "duri",
            "error"
          ],
          "line": 4097
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "domain->conn->flags",
            "error"
          ],
          "line": 4096
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "domain",
            "-1"
          ],
          "line": 4095
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 4092
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "domain",
            "\"duri=%p, flags=0x%lx, dname=%s, bandwidth=%lu\"",
            "NULLSTR(duri)",
            "flags",
            "NULLSTR(dname)",
            "bandwidth"
          ],
          "line": 4089
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "dname"
          ],
          "line": 4090
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "duri"
          ],
          "line": 4090
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainMigrateToURI(virDomainPtr domain,\n                      const char *duri,\n                      unsigned long flags,\n                      const char *dname,\n                      unsigned long bandwidth)\n{\n    const char *dconnuri = NULL;\n    const char *miguri = NULL;\n\n    VIR_DOMAIN_DEBUG(domain, \"duri=%p, flags=0x%lx, dname=%s, bandwidth=%lu\",\n                     NULLSTR(duri), flags, NULLSTR(dname), bandwidth);\n\n    virResetLastError();\n\n    /* First checkout the source */\n    virCheckDomainReturn(domain, -1);\n    virCheckReadOnlyGoto(domain->conn->flags, error);\n    virCheckNonNullArgGoto(duri, error);\n\n    VIR_EXCLUSIVE_FLAGS_GOTO(VIR_MIGRATE_TUNNELLED,\n                             VIR_MIGRATE_PARALLEL,\n                             error);\n\n    if (virDomainMigrateUnmanagedCheckCompat(domain, flags) < 0)\n        goto error;\n\n    if (flags & VIR_MIGRATE_PEER2PEER)\n        dconnuri = duri;\n    else\n        miguri = duri;\n\n    if (virDomainMigrateUnmanaged(domain, NULL, flags,\n                                  dname, dconnuri, miguri, bandwidth) < 0)\n        goto error;\n\n    return 0;\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainMigrateUnmanagedCheckCompat",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "4012-4048",
    "snippet": "static\nint virDomainMigrateUnmanagedCheckCompat(virDomainPtr domain,\n                                         unsigned int flags)\n{\n    VIR_EXCLUSIVE_FLAGS_RET(VIR_MIGRATE_NON_SHARED_DISK,\n                            VIR_MIGRATE_NON_SHARED_INC,\n                            -1);\n\n    if (flags & VIR_MIGRATE_OFFLINE &&\n        !VIR_DRV_SUPPORTS_FEATURE(domain->conn->driver, domain->conn,\n                                  VIR_DRV_FEATURE_MIGRATION_OFFLINE)) {\n        virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED, \"%s\",\n                       _(\"offline migration is not supported by \"\n                         \"the source host\"));\n        return -1;\n    }\n\n    if (flags & VIR_MIGRATE_PEER2PEER) {\n        if (!VIR_DRV_SUPPORTS_FEATURE(domain->conn->driver, domain->conn,\n                                      VIR_DRV_FEATURE_MIGRATION_P2P)) {\n            virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED, \"%s\",\n                           _(\"p2p migration is not supported by \"\n                             \"the source host\"));\n            return -1;\n        }\n    } else {\n        if (!VIR_DRV_SUPPORTS_FEATURE(domain->conn->driver, domain->conn,\n                                      VIR_DRV_FEATURE_MIGRATION_DIRECT)) {\n            virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED, \"%s\",\n                           _(\"direct migration is not supported by \"\n                             \"the source host\"));\n            return -1;\n        }\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_ARGUMENT_UNSUPPORTED",
            "\"%s\"",
            "_(\"direct migration is not supported by \"\n                             \"the source host\")"
          ],
          "line": 4040
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"direct migration is not supported by \"\n                             \"the source host\""
          ],
          "line": 4041
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DRV_SUPPORTS_FEATURE",
          "args": [
            "domain->conn->driver",
            "domain->conn",
            "VIR_DRV_FEATURE_MIGRATION_DIRECT"
          ],
          "line": 4038
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_ARGUMENT_UNSUPPORTED",
            "\"%s\"",
            "_(\"p2p migration is not supported by \"\n                             \"the source host\")"
          ],
          "line": 4032
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DRV_SUPPORTS_FEATURE",
          "args": [
            "domain->conn->driver",
            "domain->conn",
            "VIR_DRV_FEATURE_MIGRATION_P2P"
          ],
          "line": 4030
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_ARGUMENT_UNSUPPORTED",
            "\"%s\"",
            "_(\"offline migration is not supported by \"\n                         \"the source host\")"
          ],
          "line": 4023
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DRV_SUPPORTS_FEATURE",
          "args": [
            "domain->conn->driver",
            "domain->conn",
            "VIR_DRV_FEATURE_MIGRATION_OFFLINE"
          ],
          "line": 4021
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_EXCLUSIVE_FLAGS_RET",
          "args": [
            "VIR_MIGRATE_NON_SHARED_DISK",
            "VIR_MIGRATE_NON_SHARED_INC",
            "-1"
          ],
          "line": 4016
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nstatic\nint virDomainMigrateUnmanagedCheckCompat(virDomainPtr domain,\n                                         unsigned int flags)\n{\n    VIR_EXCLUSIVE_FLAGS_RET(VIR_MIGRATE_NON_SHARED_DISK,\n                            VIR_MIGRATE_NON_SHARED_INC,\n                            -1);\n\n    if (flags & VIR_MIGRATE_OFFLINE &&\n        !VIR_DRV_SUPPORTS_FEATURE(domain->conn->driver, domain->conn,\n                                  VIR_DRV_FEATURE_MIGRATION_OFFLINE)) {\n        virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED, \"%s\",\n                       _(\"offline migration is not supported by \"\n                         \"the source host\"));\n        return -1;\n    }\n\n    if (flags & VIR_MIGRATE_PEER2PEER) {\n        if (!VIR_DRV_SUPPORTS_FEATURE(domain->conn->driver, domain->conn,\n                                      VIR_DRV_FEATURE_MIGRATION_P2P)) {\n            virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED, \"%s\",\n                           _(\"p2p migration is not supported by \"\n                             \"the source host\"));\n            return -1;\n        }\n    } else {\n        if (!VIR_DRV_SUPPORTS_FEATURE(domain->conn->driver, domain->conn,\n                                      VIR_DRV_FEATURE_MIGRATION_DIRECT)) {\n            virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED, \"%s\",\n                           _(\"direct migration is not supported by \"\n                             \"the source host\"));\n            return -1;\n        }\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virDomainMigrate3",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "3852-4009",
    "snippet": "virDomainPtr\nvirDomainMigrate3(virDomainPtr domain,\n                  virConnectPtr dconn,\n                  virTypedParameterPtr params,\n                  unsigned int nparams,\n                  unsigned int flags)\n{\n    virDomainPtr ddomain = NULL;\n    const char *compatParams[] = { VIR_MIGRATE_PARAM_URI,\n                                   VIR_MIGRATE_PARAM_DEST_NAME,\n                                   VIR_MIGRATE_PARAM_DEST_XML,\n                                   VIR_MIGRATE_PARAM_BANDWIDTH };\n    const char *uri = NULL;\n    const char *dname = NULL;\n    const char *dxml = NULL;\n    unsigned long long bandwidth = 0;\n\n    VIR_DOMAIN_DEBUG(domain, \"dconn=%p, params=%p, nparms=%u flags=0x%x\",\n                     dconn, params, nparams, flags);\n    VIR_TYPED_PARAMS_DEBUG(params, nparams);\n\n    virResetLastError();\n\n    /* First checkout the source */\n    virCheckDomainReturn(domain, NULL);\n    virCheckReadOnlyGoto(domain->conn->flags, error);\n\n    /* Now checkout the destination */\n    virCheckReadOnlyGoto(dconn->flags, error);\n\n    VIR_EXCLUSIVE_FLAGS_GOTO(VIR_MIGRATE_NON_SHARED_DISK,\n                             VIR_MIGRATE_NON_SHARED_INC,\n                             error);\n\n    if (flags & VIR_MIGRATE_PEER2PEER) {\n        virReportInvalidArg(flags, \"%s\",\n                            _(\"use virDomainMigrateToURI3 for peer-to-peer \"\n                              \"migration\"));\n        goto error;\n    }\n    if (flags & VIR_MIGRATE_TUNNELLED) {\n        virReportInvalidArg(flags, \"%s\",\n                            _(\"cannot perform tunnelled migration \"\n                              \"without using peer2peer flag\"));\n        goto error;\n    }\n\n    if (flags & VIR_MIGRATE_OFFLINE) {\n        if (!VIR_DRV_SUPPORTS_FEATURE(domain->conn->driver, domain->conn,\n                                      VIR_DRV_FEATURE_MIGRATION_OFFLINE)) {\n            virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED, \"%s\",\n                           _(\"offline migration is not supported by \"\n                             \"the source host\"));\n            goto error;\n        }\n        if (!VIR_DRV_SUPPORTS_FEATURE(dconn->driver, dconn,\n                                      VIR_DRV_FEATURE_MIGRATION_OFFLINE)) {\n            virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED, \"%s\",\n                           _(\"offline migration is not supported by \"\n                             \"the destination host\"));\n            goto error;\n        }\n    }\n\n    /* Change protection requires support only on source side, and\n     * is only needed in v3 migration, which automatically re-adds\n     * the flag for just the source side.  We mask it out to allow\n     * migration from newer source to an older destination that\n     * rejects the flag.  */\n    if (flags & VIR_MIGRATE_CHANGE_PROTECTION &&\n        !VIR_DRV_SUPPORTS_FEATURE(domain->conn->driver, domain->conn,\n                                  VIR_DRV_FEATURE_MIGRATE_CHANGE_PROTECTION)) {\n        virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED, \"%s\",\n                       _(\"cannot enforce change protection\"));\n        goto error;\n    }\n    flags &= ~VIR_MIGRATE_CHANGE_PROTECTION;\n\n    /* Prefer extensible API but fall back to older migration APIs if params\n     * only contains parameters which were supported by the older API. */\n    if (VIR_DRV_SUPPORTS_FEATURE(domain->conn->driver, domain->conn,\n                                 VIR_DRV_FEATURE_MIGRATION_PARAMS) &&\n        VIR_DRV_SUPPORTS_FEATURE(dconn->driver, dconn,\n                                 VIR_DRV_FEATURE_MIGRATION_PARAMS)) {\n        VIR_DEBUG(\"Using migration protocol 3 with extensible parameters\");\n        ddomain = virDomainMigrateVersion3Params(domain, dconn, params,\n                                                 nparams, flags);\n        goto done;\n    }\n\n    if (!virTypedParamsCheck(params, nparams, compatParams,\n                             G_N_ELEMENTS(compatParams))) {\n        virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED, \"%s\",\n                       _(\"Migration APIs with extensible parameters are not \"\n                         \"supported but extended parameters were passed\"));\n        goto error;\n    }\n\n    if (virTypedParamsGetString(params, nparams,\n                                VIR_MIGRATE_PARAM_URI, &uri) < 0 ||\n        virTypedParamsGetString(params, nparams,\n                                VIR_MIGRATE_PARAM_DEST_NAME, &dname) < 0 ||\n        virTypedParamsGetString(params, nparams,\n                                VIR_MIGRATE_PARAM_DEST_XML, &dxml) < 0 ||\n        virTypedParamsGetULLong(params, nparams,\n                                VIR_MIGRATE_PARAM_BANDWIDTH, &bandwidth) < 0) {\n        goto error;\n    }\n\n    if (VIR_DRV_SUPPORTS_FEATURE(domain->conn->driver, domain->conn,\n                                 VIR_DRV_FEATURE_MIGRATION_V3) &&\n        VIR_DRV_SUPPORTS_FEATURE(dconn->driver, dconn,\n                                 VIR_DRV_FEATURE_MIGRATION_V3)) {\n        VIR_DEBUG(\"Using migration protocol 3\");\n        ddomain = virDomainMigrateVersion3(domain, dconn, dxml, flags,\n                                           dname, uri, bandwidth);\n    } else if (VIR_DRV_SUPPORTS_FEATURE(domain->conn->driver, domain->conn,\n                                        VIR_DRV_FEATURE_MIGRATION_V2) &&\n               VIR_DRV_SUPPORTS_FEATURE(dconn->driver, dconn,\n                                      VIR_DRV_FEATURE_MIGRATION_V2)) {\n        VIR_DEBUG(\"Using migration protocol 2\");\n        if (dxml) {\n            virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED, \"%s\",\n                           _(\"Unable to change target guest XML during \"\n                             \"migration\"));\n            goto error;\n        }\n        ddomain = virDomainMigrateVersion2(domain, dconn, flags,\n                                           dname, uri, bandwidth);\n    } else if (VIR_DRV_SUPPORTS_FEATURE(domain->conn->driver, domain->conn,\n                                        VIR_DRV_FEATURE_MIGRATION_V1) &&\n               VIR_DRV_SUPPORTS_FEATURE(dconn->driver, dconn,\n                                        VIR_DRV_FEATURE_MIGRATION_V1)) {\n        VIR_DEBUG(\"Using migration protocol 1\");\n        if (dxml) {\n            virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED, \"%s\",\n                           _(\"Unable to change target guest XML during \"\n                             \"migration\"));\n            goto error;\n        }\n        ddomain = virDomainMigrateVersion1(domain, dconn, flags,\n                                           dname, uri, bandwidth);\n    } else {\n        /* This driver does not support any migration method */\n        virReportUnsupportedError();\n        goto error;\n    }\n\n done:\n    if (ddomain == NULL)\n        goto error;\n\n    return ddomain;\n\n error:\n    virDispatchError(domain->conn);\n    return NULL;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "domain->conn"
          ],
          "line": 4007
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 3996
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainMigrateVersion1",
          "args": [
            "domain",
            "dconn",
            "flags",
            "dname",
            "uri",
            "bandwidth"
          ],
          "line": 3992
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainMigrateVersion1",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
          "lines": "2721-2794",
          "snippet": "static virDomainPtr\nvirDomainMigrateVersion1(virDomainPtr domain,\n                         virConnectPtr dconn,\n                         unsigned long flags,\n                         const char *dname,\n                         const char *uri,\n                         unsigned long bandwidth)\n{\n    virDomainPtr ddomain = NULL;\n    char *uri_out = NULL;\n    char *cookie = NULL;\n    int cookielen = 0, ret;\n    virDomainInfo info;\n    unsigned int destflags;\n\n    VIR_DOMAIN_DEBUG(domain,\n                     \"dconn=%p, flags=0x%lx, dname=%s, uri=%s, bandwidth=%lu\",\n                     dconn, flags, NULLSTR(dname), NULLSTR(uri), bandwidth);\n\n    ret = virDomainGetInfo(domain, &info);\n    if (ret == 0 && info.state == VIR_DOMAIN_PAUSED)\n        flags |= VIR_MIGRATE_PAUSED;\n\n    destflags = flags & ~(VIR_MIGRATE_ABORT_ON_ERROR |\n                          VIR_MIGRATE_AUTO_CONVERGE);\n\n    /* Prepare the migration.\n     *\n     * The destination host may return a cookie, or leave cookie as\n     * NULL.\n     *\n     * The destination host MUST set uri_out if uri_in is NULL.\n     *\n     * If uri_in is non-NULL, then the destination host may modify\n     * the URI by setting uri_out.  If it does not wish to modify\n     * the URI, it should leave uri_out as NULL.\n     */\n    if (dconn->driver->domainMigratePrepare\n        (dconn, &cookie, &cookielen, uri, &uri_out, destflags, dname,\n         bandwidth) == -1)\n        goto done;\n\n    if (uri == NULL && uri_out == NULL) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"domainMigratePrepare did not set uri\"));\n        goto done;\n    }\n    if (uri_out)\n        uri = uri_out; /* Did domainMigratePrepare change URI? */\n\n    /* Perform the migration.  The driver isn't supposed to return\n     * until the migration is complete.\n     */\n    if (domain->conn->driver->domainMigratePerform\n        (domain, cookie, cookielen, uri, flags, dname, bandwidth) == -1)\n        goto done;\n\n    /* Get the destination domain and return it or error.\n     * 'domain' no longer actually exists at this point\n     * (or so we hope), but we still use the object in memory\n     * in order to get the name.\n     */\n    dname = dname ? dname : domain->name;\n    if (dconn->driver->domainMigrateFinish)\n        ddomain = dconn->driver->domainMigrateFinish\n            (dconn, dname, cookie, cookielen, uri, destflags);\n    else\n        ddomain = virDomainLookupByName(dconn, dname);\n\n done:\n    VIR_FREE(uri_out);\n    VIR_FREE(cookie);\n    return ddomain;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nstatic virDomainPtr\nvirDomainMigrateVersion1(virDomainPtr domain,\n                         virConnectPtr dconn,\n                         unsigned long flags,\n                         const char *dname,\n                         const char *uri,\n                         unsigned long bandwidth)\n{\n    virDomainPtr ddomain = NULL;\n    char *uri_out = NULL;\n    char *cookie = NULL;\n    int cookielen = 0, ret;\n    virDomainInfo info;\n    unsigned int destflags;\n\n    VIR_DOMAIN_DEBUG(domain,\n                     \"dconn=%p, flags=0x%lx, dname=%s, uri=%s, bandwidth=%lu\",\n                     dconn, flags, NULLSTR(dname), NULLSTR(uri), bandwidth);\n\n    ret = virDomainGetInfo(domain, &info);\n    if (ret == 0 && info.state == VIR_DOMAIN_PAUSED)\n        flags |= VIR_MIGRATE_PAUSED;\n\n    destflags = flags & ~(VIR_MIGRATE_ABORT_ON_ERROR |\n                          VIR_MIGRATE_AUTO_CONVERGE);\n\n    /* Prepare the migration.\n     *\n     * The destination host may return a cookie, or leave cookie as\n     * NULL.\n     *\n     * The destination host MUST set uri_out if uri_in is NULL.\n     *\n     * If uri_in is non-NULL, then the destination host may modify\n     * the URI by setting uri_out.  If it does not wish to modify\n     * the URI, it should leave uri_out as NULL.\n     */\n    if (dconn->driver->domainMigratePrepare\n        (dconn, &cookie, &cookielen, uri, &uri_out, destflags, dname,\n         bandwidth) == -1)\n        goto done;\n\n    if (uri == NULL && uri_out == NULL) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"domainMigratePrepare did not set uri\"));\n        goto done;\n    }\n    if (uri_out)\n        uri = uri_out; /* Did domainMigratePrepare change URI? */\n\n    /* Perform the migration.  The driver isn't supposed to return\n     * until the migration is complete.\n     */\n    if (domain->conn->driver->domainMigratePerform\n        (domain, cookie, cookielen, uri, flags, dname, bandwidth) == -1)\n        goto done;\n\n    /* Get the destination domain and return it or error.\n     * 'domain' no longer actually exists at this point\n     * (or so we hope), but we still use the object in memory\n     * in order to get the name.\n     */\n    dname = dname ? dname : domain->name;\n    if (dconn->driver->domainMigrateFinish)\n        ddomain = dconn->driver->domainMigrateFinish\n            (dconn, dname, cookie, cookielen, uri, destflags);\n    else\n        ddomain = virDomainLookupByName(dconn, dname);\n\n done:\n    VIR_FREE(uri_out);\n    VIR_FREE(cookie);\n    return ddomain;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_ARGUMENT_UNSUPPORTED",
            "\"%s\"",
            "_(\"Unable to change target guest XML during \"\n                             \"migration\")"
          ],
          "line": 3987
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to change target guest XML during \"\n                             \"migration\""
          ],
          "line": 3988
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Using migration protocol 1\""
          ],
          "line": 3985
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DRV_SUPPORTS_FEATURE",
          "args": [
            "dconn->driver",
            "dconn",
            "VIR_DRV_FEATURE_MIGRATION_V1"
          ],
          "line": 3983
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DRV_SUPPORTS_FEATURE",
          "args": [
            "domain->conn->driver",
            "domain->conn",
            "VIR_DRV_FEATURE_MIGRATION_V1"
          ],
          "line": 3981
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainMigrateVersion2",
          "args": [
            "domain",
            "dconn",
            "flags",
            "dname",
            "uri",
            "bandwidth"
          ],
          "line": 3979
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainMigrateVersion2",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
          "lines": "2816-2930",
          "snippet": "static virDomainPtr\nvirDomainMigrateVersion2(virDomainPtr domain,\n                         virConnectPtr dconn,\n                         unsigned long flags,\n                         const char *dname,\n                         const char *uri,\n                         unsigned long bandwidth)\n{\n    virDomainPtr ddomain = NULL;\n    char *uri_out = NULL;\n    char *cookie = NULL;\n    char *dom_xml = NULL;\n    int cookielen = 0, ret;\n    virDomainInfo info;\n    virErrorPtr orig_err = NULL;\n    unsigned int getxml_flags = 0;\n    int cancelled;\n    unsigned long destflags;\n\n    VIR_DOMAIN_DEBUG(domain,\n                     \"dconn=%p, flags=0x%lx, dname=%s, uri=%s, bandwidth=%lu\",\n                     dconn, flags, NULLSTR(dname), NULLSTR(uri), bandwidth);\n\n    /* Prepare the migration.\n     *\n     * The destination host may return a cookie, or leave cookie as\n     * NULL.\n     *\n     * The destination host MUST set uri_out if uri_in is NULL.\n     *\n     * If uri_in is non-NULL, then the destination host may modify\n     * the URI by setting uri_out.  If it does not wish to modify\n     * the URI, it should leave uri_out as NULL.\n     */\n\n    /* In version 2 of the protocol, the prepare step is slightly\n     * different.  We fetch the domain XML of the source domain\n     * and pass it to Prepare2.\n     */\n    if (!domain->conn->driver->domainGetXMLDesc) {\n        virReportUnsupportedError();\n        return NULL;\n    }\n\n    if (VIR_DRV_SUPPORTS_FEATURE(domain->conn->driver, domain->conn,\n                                 VIR_DRV_FEATURE_XML_MIGRATABLE)) {\n        getxml_flags |= VIR_DOMAIN_XML_MIGRATABLE;\n    } else {\n        getxml_flags |= VIR_DOMAIN_XML_SECURE | VIR_DOMAIN_XML_UPDATE_CPU;\n    }\n\n    dom_xml = domain->conn->driver->domainGetXMLDesc(domain, getxml_flags);\n    if (!dom_xml)\n        return NULL;\n\n    ret = virDomainGetInfo(domain, &info);\n    if (ret == 0 && info.state == VIR_DOMAIN_PAUSED)\n        flags |= VIR_MIGRATE_PAUSED;\n\n    destflags = flags & ~(VIR_MIGRATE_ABORT_ON_ERROR |\n                          VIR_MIGRATE_AUTO_CONVERGE);\n\n    VIR_DEBUG(\"Prepare2 %p flags=0x%lx\", dconn, destflags);\n    ret = dconn->driver->domainMigratePrepare2\n        (dconn, &cookie, &cookielen, uri, &uri_out, destflags, dname,\n         bandwidth, dom_xml);\n    VIR_FREE(dom_xml);\n    if (ret == -1)\n        goto done;\n\n    if (uri == NULL && uri_out == NULL) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"domainMigratePrepare2 did not set uri\"));\n        cancelled = 1;\n        /* Make sure Finish doesn't overwrite the error */\n        virErrorPreserveLast(&orig_err);\n        goto finish;\n    }\n    if (uri_out)\n        uri = uri_out; /* Did domainMigratePrepare2 change URI? */\n\n    /* Perform the migration.  The driver isn't supposed to return\n     * until the migration is complete.\n     */\n    VIR_DEBUG(\"Perform %p\", domain->conn);\n    ret = domain->conn->driver->domainMigratePerform\n        (domain, cookie, cookielen, uri, flags, dname, bandwidth);\n\n    /* Perform failed. Make sure Finish doesn't overwrite the error */\n    if (ret < 0)\n        virErrorPreserveLast(&orig_err);\n\n    /* If Perform returns < 0, then we need to cancel the VM\n     * startup on the destination\n     */\n    cancelled = ret < 0 ? 1 : 0;\n\n finish:\n    /* In version 2 of the migration protocol, we pass the\n     * status code from the sender to the destination host,\n     * so it can do any cleanup if the migration failed.\n     */\n    dname = dname ? dname : domain->name;\n    VIR_DEBUG(\"Finish2 %p ret=%d\", dconn, ret);\n    ddomain = dconn->driver->domainMigrateFinish2\n        (dconn, dname, cookie, cookielen, uri, destflags, cancelled);\n    if (cancelled && ddomain)\n        VIR_ERROR(_(\"finish step ignored that migration was cancelled\"));\n\n done:\n    virErrorRestore(&orig_err);\n    VIR_FREE(uri_out);\n    VIR_FREE(cookie);\n    return ddomain;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nstatic virDomainPtr\nvirDomainMigrateVersion2(virDomainPtr domain,\n                         virConnectPtr dconn,\n                         unsigned long flags,\n                         const char *dname,\n                         const char *uri,\n                         unsigned long bandwidth)\n{\n    virDomainPtr ddomain = NULL;\n    char *uri_out = NULL;\n    char *cookie = NULL;\n    char *dom_xml = NULL;\n    int cookielen = 0, ret;\n    virDomainInfo info;\n    virErrorPtr orig_err = NULL;\n    unsigned int getxml_flags = 0;\n    int cancelled;\n    unsigned long destflags;\n\n    VIR_DOMAIN_DEBUG(domain,\n                     \"dconn=%p, flags=0x%lx, dname=%s, uri=%s, bandwidth=%lu\",\n                     dconn, flags, NULLSTR(dname), NULLSTR(uri), bandwidth);\n\n    /* Prepare the migration.\n     *\n     * The destination host may return a cookie, or leave cookie as\n     * NULL.\n     *\n     * The destination host MUST set uri_out if uri_in is NULL.\n     *\n     * If uri_in is non-NULL, then the destination host may modify\n     * the URI by setting uri_out.  If it does not wish to modify\n     * the URI, it should leave uri_out as NULL.\n     */\n\n    /* In version 2 of the protocol, the prepare step is slightly\n     * different.  We fetch the domain XML of the source domain\n     * and pass it to Prepare2.\n     */\n    if (!domain->conn->driver->domainGetXMLDesc) {\n        virReportUnsupportedError();\n        return NULL;\n    }\n\n    if (VIR_DRV_SUPPORTS_FEATURE(domain->conn->driver, domain->conn,\n                                 VIR_DRV_FEATURE_XML_MIGRATABLE)) {\n        getxml_flags |= VIR_DOMAIN_XML_MIGRATABLE;\n    } else {\n        getxml_flags |= VIR_DOMAIN_XML_SECURE | VIR_DOMAIN_XML_UPDATE_CPU;\n    }\n\n    dom_xml = domain->conn->driver->domainGetXMLDesc(domain, getxml_flags);\n    if (!dom_xml)\n        return NULL;\n\n    ret = virDomainGetInfo(domain, &info);\n    if (ret == 0 && info.state == VIR_DOMAIN_PAUSED)\n        flags |= VIR_MIGRATE_PAUSED;\n\n    destflags = flags & ~(VIR_MIGRATE_ABORT_ON_ERROR |\n                          VIR_MIGRATE_AUTO_CONVERGE);\n\n    VIR_DEBUG(\"Prepare2 %p flags=0x%lx\", dconn, destflags);\n    ret = dconn->driver->domainMigratePrepare2\n        (dconn, &cookie, &cookielen, uri, &uri_out, destflags, dname,\n         bandwidth, dom_xml);\n    VIR_FREE(dom_xml);\n    if (ret == -1)\n        goto done;\n\n    if (uri == NULL && uri_out == NULL) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"domainMigratePrepare2 did not set uri\"));\n        cancelled = 1;\n        /* Make sure Finish doesn't overwrite the error */\n        virErrorPreserveLast(&orig_err);\n        goto finish;\n    }\n    if (uri_out)\n        uri = uri_out; /* Did domainMigratePrepare2 change URI? */\n\n    /* Perform the migration.  The driver isn't supposed to return\n     * until the migration is complete.\n     */\n    VIR_DEBUG(\"Perform %p\", domain->conn);\n    ret = domain->conn->driver->domainMigratePerform\n        (domain, cookie, cookielen, uri, flags, dname, bandwidth);\n\n    /* Perform failed. Make sure Finish doesn't overwrite the error */\n    if (ret < 0)\n        virErrorPreserveLast(&orig_err);\n\n    /* If Perform returns < 0, then we need to cancel the VM\n     * startup on the destination\n     */\n    cancelled = ret < 0 ? 1 : 0;\n\n finish:\n    /* In version 2 of the migration protocol, we pass the\n     * status code from the sender to the destination host,\n     * so it can do any cleanup if the migration failed.\n     */\n    dname = dname ? dname : domain->name;\n    VIR_DEBUG(\"Finish2 %p ret=%d\", dconn, ret);\n    ddomain = dconn->driver->domainMigrateFinish2\n        (dconn, dname, cookie, cookielen, uri, destflags, cancelled);\n    if (cancelled && ddomain)\n        VIR_ERROR(_(\"finish step ignored that migration was cancelled\"));\n\n done:\n    virErrorRestore(&orig_err);\n    VIR_FREE(uri_out);\n    VIR_FREE(cookie);\n    return ddomain;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_ARGUMENT_UNSUPPORTED",
            "\"%s\"",
            "_(\"Unable to change target guest XML during \"\n                             \"migration\")"
          ],
          "line": 3974
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Using migration protocol 2\""
          ],
          "line": 3972
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DRV_SUPPORTS_FEATURE",
          "args": [
            "dconn->driver",
            "dconn",
            "VIR_DRV_FEATURE_MIGRATION_V2"
          ],
          "line": 3970
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DRV_SUPPORTS_FEATURE",
          "args": [
            "domain->conn->driver",
            "domain->conn",
            "VIR_DRV_FEATURE_MIGRATION_V2"
          ],
          "line": 3968
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainMigrateVersion3",
          "args": [
            "domain",
            "dconn",
            "dxml",
            "flags",
            "dname",
            "uri",
            "bandwidth"
          ],
          "line": 3966
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainMigrateVersion3",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
          "lines": "3260-3271",
          "snippet": "static virDomainPtr\nvirDomainMigrateVersion3(virDomainPtr domain,\n                         virConnectPtr dconn,\n                         const char *xmlin,\n                         unsigned long flags,\n                         const char *dname,\n                         const char *uri,\n                         unsigned long bandwidth)\n{\n    return virDomainMigrateVersion3Full(domain, dconn, xmlin, dname, uri,\n                                        bandwidth, NULL, 0, false, flags);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nstatic virDomainPtr\nvirDomainMigrateVersion3(virDomainPtr domain,\n                         virConnectPtr dconn,\n                         const char *xmlin,\n                         unsigned long flags,\n                         const char *dname,\n                         const char *uri,\n                         unsigned long bandwidth)\n{\n    return virDomainMigrateVersion3Full(domain, dconn, xmlin, dname, uri,\n                                        bandwidth, NULL, 0, false, flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Using migration protocol 3\""
          ],
          "line": 3965
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DRV_SUPPORTS_FEATURE",
          "args": [
            "dconn->driver",
            "dconn",
            "VIR_DRV_FEATURE_MIGRATION_V3"
          ],
          "line": 3963
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DRV_SUPPORTS_FEATURE",
          "args": [
            "domain->conn->driver",
            "domain->conn",
            "VIR_DRV_FEATURE_MIGRATION_V3"
          ],
          "line": 3961
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virTypedParamsGetULLong",
          "args": [
            "params",
            "nparams",
            "VIR_MIGRATE_PARAM_BANDWIDTH",
            "&bandwidth"
          ],
          "line": 3956
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParamsGetULLong",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam-public.c",
          "lines": "288-306",
          "snippet": "int\nvirTypedParamsGetULLong(virTypedParameterPtr params,\n                        int nparams,\n                        const char *name,\n                        unsigned long long *value)\n{\n    virTypedParameterPtr param;\n\n    virResetLastError();\n\n    if (!(param = virTypedParamsGet(params, nparams, name)))\n        return 0;\n\n    VIR_TYPED_PARAM_CHECK_TYPE(VIR_TYPED_PARAM_ULLONG);\n    if (value)\n        *value = param->value.ul;\n\n    return 1;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtypedparam.h\"\n#include <config.h>\n\nint\nvirTypedParamsGetULLong(virTypedParameterPtr params,\n                        int nparams,\n                        const char *name,\n                        unsigned long long *value)\n{\n    virTypedParameterPtr param;\n\n    virResetLastError();\n\n    if (!(param = virTypedParamsGet(params, nparams, name)))\n        return 0;\n\n    VIR_TYPED_PARAM_CHECK_TYPE(VIR_TYPED_PARAM_ULLONG);\n    if (value)\n        *value = param->value.ul;\n\n    return 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virTypedParamsGetString",
          "args": [
            "params",
            "nparams",
            "VIR_MIGRATE_PARAM_DEST_XML",
            "&dxml"
          ],
          "line": 3954
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParamsGetStringList",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam.c",
          "lines": "432-467",
          "snippet": "int\nvirTypedParamsGetStringList(virTypedParameterPtr params,\n                            int nparams,\n                            const char *name,\n                            const char ***values)\n{\n    size_t i, n;\n    int nfiltered;\n    virTypedParameterPtr *filtered = NULL;\n\n    virCheckNonNullArgGoto(values, error);\n    *values = NULL;\n\n    nfiltered = virTypedParamsFilter(params, nparams, name, &filtered);\n\n    if (nfiltered < 0)\n        goto error;\n\n    if (nfiltered &&\n        VIR_ALLOC_N(*values, nfiltered) < 0)\n        goto error;\n\n    for (n = 0, i = 0; i < nfiltered; i++) {\n        if (filtered[i]->type == VIR_TYPED_PARAM_STRING)\n            (*values)[n++] = filtered[i]->value.s;\n    }\n\n    VIR_FREE(filtered);\n    return n;\n\n error:\n    if (values)\n        VIR_FREE(*values);\n    VIR_FREE(filtered);\n    return -1;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <stdarg.h>",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <stdarg.h>\n#include \"virtypedparam.h\"\n#include <config.h>\n\nint\nvirTypedParamsGetStringList(virTypedParameterPtr params,\n                            int nparams,\n                            const char *name,\n                            const char ***values)\n{\n    size_t i, n;\n    int nfiltered;\n    virTypedParameterPtr *filtered = NULL;\n\n    virCheckNonNullArgGoto(values, error);\n    *values = NULL;\n\n    nfiltered = virTypedParamsFilter(params, nparams, name, &filtered);\n\n    if (nfiltered < 0)\n        goto error;\n\n    if (nfiltered &&\n        VIR_ALLOC_N(*values, nfiltered) < 0)\n        goto error;\n\n    for (n = 0, i = 0; i < nfiltered; i++) {\n        if (filtered[i]->type == VIR_TYPED_PARAM_STRING)\n            (*values)[n++] = filtered[i]->value.s;\n    }\n\n    VIR_FREE(filtered);\n    return n;\n\n error:\n    if (values)\n        VIR_FREE(*values);\n    VIR_FREE(filtered);\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_ARGUMENT_UNSUPPORTED",
            "\"%s\"",
            "_(\"Migration APIs with extensible parameters are not \"\n                         \"supported but extended parameters were passed\")"
          ],
          "line": 3944
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virTypedParamsCheck",
          "args": [
            "params",
            "nparams",
            "compatParams",
            "G_N_ELEMENTS(compatParams)"
          ],
          "line": 3942
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParamsCheck",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam.c",
          "lines": "148-169",
          "snippet": "bool\nvirTypedParamsCheck(virTypedParameterPtr params,\n                    int nparams,\n                    const char **names,\n                    int nnames)\n{\n    size_t i, j;\n\n    for (i = 0; i < nparams; i++) {\n        bool found = false;\n        for (j = 0; j < nnames; j++) {\n            if (STREQ(params[i].field, names[j])) {\n                found = true;\n                break;\n            }\n        }\n        if (!found)\n            return false;\n    }\n\n    return true;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <stdarg.h>",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <stdarg.h>\n#include \"virtypedparam.h\"\n#include <config.h>\n\nbool\nvirTypedParamsCheck(virTypedParameterPtr params,\n                    int nparams,\n                    const char **names,\n                    int nnames)\n{\n    size_t i, j;\n\n    for (i = 0; i < nparams; i++) {\n        bool found = false;\n        for (j = 0; j < nnames; j++) {\n            if (STREQ(params[i].field, names[j])) {\n                found = true;\n                break;\n            }\n        }\n        if (!found)\n            return false;\n    }\n\n    return true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "G_N_ELEMENTS",
          "args": [
            "compatParams"
          ],
          "line": 3943
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainMigrateVersion3Params",
          "args": [
            "domain",
            "dconn",
            "params",
            "nparams",
            "flags"
          ],
          "line": 3937
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainMigrateVersion3Params",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
          "lines": "3274-3283",
          "snippet": "static virDomainPtr\nvirDomainMigrateVersion3Params(virDomainPtr domain,\n                               virConnectPtr dconn,\n                               virTypedParameterPtr params,\n                               int nparams,\n                               unsigned int flags)\n{\n    return virDomainMigrateVersion3Full(domain, dconn, NULL, NULL, NULL, 0,\n                                        params, nparams, true, flags);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nstatic virDomainPtr\nvirDomainMigrateVersion3Params(virDomainPtr domain,\n                               virConnectPtr dconn,\n                               virTypedParameterPtr params,\n                               int nparams,\n                               unsigned int flags)\n{\n    return virDomainMigrateVersion3Full(domain, dconn, NULL, NULL, NULL, 0,\n                                        params, nparams, true, flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Using migration protocol 3 with extensible parameters\""
          ],
          "line": 3936
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DRV_SUPPORTS_FEATURE",
          "args": [
            "dconn->driver",
            "dconn",
            "VIR_DRV_FEATURE_MIGRATION_PARAMS"
          ],
          "line": 3934
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DRV_SUPPORTS_FEATURE",
          "args": [
            "domain->conn->driver",
            "domain->conn",
            "VIR_DRV_FEATURE_MIGRATION_PARAMS"
          ],
          "line": 3932
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_ARGUMENT_UNSUPPORTED",
            "\"%s\"",
            "_(\"cannot enforce change protection\")"
          ],
          "line": 3924
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DRV_SUPPORTS_FEATURE",
          "args": [
            "domain->conn->driver",
            "domain->conn",
            "VIR_DRV_FEATURE_MIGRATE_CHANGE_PROTECTION"
          ],
          "line": 3922
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_ARGUMENT_UNSUPPORTED",
            "\"%s\"",
            "_(\"offline migration is not supported by \"\n                             \"the destination host\")"
          ],
          "line": 3909
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DRV_SUPPORTS_FEATURE",
          "args": [
            "dconn->driver",
            "dconn",
            "VIR_DRV_FEATURE_MIGRATION_OFFLINE"
          ],
          "line": 3907
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_ARGUMENT_UNSUPPORTED",
            "\"%s\"",
            "_(\"offline migration is not supported by \"\n                             \"the source host\")"
          ],
          "line": 3902
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DRV_SUPPORTS_FEATURE",
          "args": [
            "domain->conn->driver",
            "domain->conn",
            "VIR_DRV_FEATURE_MIGRATION_OFFLINE"
          ],
          "line": 3900
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportInvalidArg",
          "args": [
            "flags",
            "\"%s\"",
            "_(\"cannot perform tunnelled migration \"\n                              \"without using peer2peer flag\")"
          ],
          "line": 3893
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportInvalidArg",
          "args": [
            "flags",
            "\"%s\"",
            "_(\"use virDomainMigrateToURI3 for peer-to-peer \"\n                              \"migration\")"
          ],
          "line": 3887
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_EXCLUSIVE_FLAGS_GOTO",
          "args": [
            "VIR_MIGRATE_NON_SHARED_DISK",
            "VIR_MIGRATE_NON_SHARED_INC",
            "error"
          ],
          "line": 3882
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "dconn->flags",
            "error"
          ],
          "line": 3880
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "domain->conn->flags",
            "error"
          ],
          "line": 3877
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "domain",
            "NULL"
          ],
          "line": 3876
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 3873
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_TYPED_PARAMS_DEBUG",
          "args": [
            "params",
            "nparams"
          ],
          "line": 3871
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "domain",
            "\"dconn=%p, params=%p, nparms=%u flags=0x%x\"",
            "dconn",
            "params",
            "nparams",
            "flags"
          ],
          "line": 3869
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nvirDomainPtr\nvirDomainMigrate3(virDomainPtr domain,\n                  virConnectPtr dconn,\n                  virTypedParameterPtr params,\n                  unsigned int nparams,\n                  unsigned int flags)\n{\n    virDomainPtr ddomain = NULL;\n    const char *compatParams[] = { VIR_MIGRATE_PARAM_URI,\n                                   VIR_MIGRATE_PARAM_DEST_NAME,\n                                   VIR_MIGRATE_PARAM_DEST_XML,\n                                   VIR_MIGRATE_PARAM_BANDWIDTH };\n    const char *uri = NULL;\n    const char *dname = NULL;\n    const char *dxml = NULL;\n    unsigned long long bandwidth = 0;\n\n    VIR_DOMAIN_DEBUG(domain, \"dconn=%p, params=%p, nparms=%u flags=0x%x\",\n                     dconn, params, nparams, flags);\n    VIR_TYPED_PARAMS_DEBUG(params, nparams);\n\n    virResetLastError();\n\n    /* First checkout the source */\n    virCheckDomainReturn(domain, NULL);\n    virCheckReadOnlyGoto(domain->conn->flags, error);\n\n    /* Now checkout the destination */\n    virCheckReadOnlyGoto(dconn->flags, error);\n\n    VIR_EXCLUSIVE_FLAGS_GOTO(VIR_MIGRATE_NON_SHARED_DISK,\n                             VIR_MIGRATE_NON_SHARED_INC,\n                             error);\n\n    if (flags & VIR_MIGRATE_PEER2PEER) {\n        virReportInvalidArg(flags, \"%s\",\n                            _(\"use virDomainMigrateToURI3 for peer-to-peer \"\n                              \"migration\"));\n        goto error;\n    }\n    if (flags & VIR_MIGRATE_TUNNELLED) {\n        virReportInvalidArg(flags, \"%s\",\n                            _(\"cannot perform tunnelled migration \"\n                              \"without using peer2peer flag\"));\n        goto error;\n    }\n\n    if (flags & VIR_MIGRATE_OFFLINE) {\n        if (!VIR_DRV_SUPPORTS_FEATURE(domain->conn->driver, domain->conn,\n                                      VIR_DRV_FEATURE_MIGRATION_OFFLINE)) {\n            virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED, \"%s\",\n                           _(\"offline migration is not supported by \"\n                             \"the source host\"));\n            goto error;\n        }\n        if (!VIR_DRV_SUPPORTS_FEATURE(dconn->driver, dconn,\n                                      VIR_DRV_FEATURE_MIGRATION_OFFLINE)) {\n            virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED, \"%s\",\n                           _(\"offline migration is not supported by \"\n                             \"the destination host\"));\n            goto error;\n        }\n    }\n\n    /* Change protection requires support only on source side, and\n     * is only needed in v3 migration, which automatically re-adds\n     * the flag for just the source side.  We mask it out to allow\n     * migration from newer source to an older destination that\n     * rejects the flag.  */\n    if (flags & VIR_MIGRATE_CHANGE_PROTECTION &&\n        !VIR_DRV_SUPPORTS_FEATURE(domain->conn->driver, domain->conn,\n                                  VIR_DRV_FEATURE_MIGRATE_CHANGE_PROTECTION)) {\n        virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED, \"%s\",\n                       _(\"cannot enforce change protection\"));\n        goto error;\n    }\n    flags &= ~VIR_MIGRATE_CHANGE_PROTECTION;\n\n    /* Prefer extensible API but fall back to older migration APIs if params\n     * only contains parameters which were supported by the older API. */\n    if (VIR_DRV_SUPPORTS_FEATURE(domain->conn->driver, domain->conn,\n                                 VIR_DRV_FEATURE_MIGRATION_PARAMS) &&\n        VIR_DRV_SUPPORTS_FEATURE(dconn->driver, dconn,\n                                 VIR_DRV_FEATURE_MIGRATION_PARAMS)) {\n        VIR_DEBUG(\"Using migration protocol 3 with extensible parameters\");\n        ddomain = virDomainMigrateVersion3Params(domain, dconn, params,\n                                                 nparams, flags);\n        goto done;\n    }\n\n    if (!virTypedParamsCheck(params, nparams, compatParams,\n                             G_N_ELEMENTS(compatParams))) {\n        virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED, \"%s\",\n                       _(\"Migration APIs with extensible parameters are not \"\n                         \"supported but extended parameters were passed\"));\n        goto error;\n    }\n\n    if (virTypedParamsGetString(params, nparams,\n                                VIR_MIGRATE_PARAM_URI, &uri) < 0 ||\n        virTypedParamsGetString(params, nparams,\n                                VIR_MIGRATE_PARAM_DEST_NAME, &dname) < 0 ||\n        virTypedParamsGetString(params, nparams,\n                                VIR_MIGRATE_PARAM_DEST_XML, &dxml) < 0 ||\n        virTypedParamsGetULLong(params, nparams,\n                                VIR_MIGRATE_PARAM_BANDWIDTH, &bandwidth) < 0) {\n        goto error;\n    }\n\n    if (VIR_DRV_SUPPORTS_FEATURE(domain->conn->driver, domain->conn,\n                                 VIR_DRV_FEATURE_MIGRATION_V3) &&\n        VIR_DRV_SUPPORTS_FEATURE(dconn->driver, dconn,\n                                 VIR_DRV_FEATURE_MIGRATION_V3)) {\n        VIR_DEBUG(\"Using migration protocol 3\");\n        ddomain = virDomainMigrateVersion3(domain, dconn, dxml, flags,\n                                           dname, uri, bandwidth);\n    } else if (VIR_DRV_SUPPORTS_FEATURE(domain->conn->driver, domain->conn,\n                                        VIR_DRV_FEATURE_MIGRATION_V2) &&\n               VIR_DRV_SUPPORTS_FEATURE(dconn->driver, dconn,\n                                      VIR_DRV_FEATURE_MIGRATION_V2)) {\n        VIR_DEBUG(\"Using migration protocol 2\");\n        if (dxml) {\n            virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED, \"%s\",\n                           _(\"Unable to change target guest XML during \"\n                             \"migration\"));\n            goto error;\n        }\n        ddomain = virDomainMigrateVersion2(domain, dconn, flags,\n                                           dname, uri, bandwidth);\n    } else if (VIR_DRV_SUPPORTS_FEATURE(domain->conn->driver, domain->conn,\n                                        VIR_DRV_FEATURE_MIGRATION_V1) &&\n               VIR_DRV_SUPPORTS_FEATURE(dconn->driver, dconn,\n                                        VIR_DRV_FEATURE_MIGRATION_V1)) {\n        VIR_DEBUG(\"Using migration protocol 1\");\n        if (dxml) {\n            virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED, \"%s\",\n                           _(\"Unable to change target guest XML during \"\n                             \"migration\"));\n            goto error;\n        }\n        ddomain = virDomainMigrateVersion1(domain, dconn, flags,\n                                           dname, uri, bandwidth);\n    } else {\n        /* This driver does not support any migration method */\n        virReportUnsupportedError();\n        goto error;\n    }\n\n done:\n    if (ddomain == NULL)\n        goto error;\n\n    return ddomain;\n\n error:\n    virDispatchError(domain->conn);\n    return NULL;\n}"
  },
  {
    "function_name": "virDomainMigrate2",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "3680-3818",
    "snippet": "virDomainPtr\nvirDomainMigrate2(virDomainPtr domain,\n                  virConnectPtr dconn,\n                  const char *dxml,\n                  unsigned long flags,\n                  const char *dname,\n                  const char *uri,\n                  unsigned long bandwidth)\n{\n    virDomainPtr ddomain = NULL;\n\n    VIR_DOMAIN_DEBUG(domain,\n                     \"dconn=%p, flags=0x%lx, dname=%s, uri=%s, bandwidth=%lu\",\n                     dconn, flags, NULLSTR(dname), NULLSTR(uri), bandwidth);\n\n    virResetLastError();\n\n    /* First checkout the source */\n    virCheckDomainReturn(domain, NULL);\n    virCheckReadOnlyGoto(domain->conn->flags, error);\n\n    /* Now checkout the destination */\n    virCheckConnectGoto(dconn, error);\n    virCheckReadOnlyGoto(dconn->flags, error);\n\n    VIR_EXCLUSIVE_FLAGS_GOTO(VIR_MIGRATE_NON_SHARED_DISK,\n                             VIR_MIGRATE_NON_SHARED_INC,\n                             error);\n\n    VIR_EXCLUSIVE_FLAGS_GOTO(VIR_MIGRATE_TUNNELLED,\n                             VIR_MIGRATE_PARALLEL,\n                             error);\n\n    if (flags & VIR_MIGRATE_OFFLINE) {\n        if (!VIR_DRV_SUPPORTS_FEATURE(domain->conn->driver, domain->conn,\n                                      VIR_DRV_FEATURE_MIGRATION_OFFLINE)) {\n            virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED, \"%s\",\n                           _(\"offline migration is not supported by \"\n                             \"the source host\"));\n            goto error;\n        }\n        if (!VIR_DRV_SUPPORTS_FEATURE(dconn->driver, dconn,\n                                      VIR_DRV_FEATURE_MIGRATION_OFFLINE)) {\n            virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED, \"%s\",\n                           _(\"offline migration is not supported by \"\n                             \"the destination host\"));\n            goto error;\n        }\n    }\n\n    if (flags & VIR_MIGRATE_PEER2PEER) {\n        if (VIR_DRV_SUPPORTS_FEATURE(domain->conn->driver, domain->conn,\n                                     VIR_DRV_FEATURE_MIGRATION_P2P)) {\n            char *dstURI = virConnectGetURI(dconn);\n            if (!dstURI)\n                return NULL;\n\n            VIR_DEBUG(\"Using peer2peer migration\");\n            if (virDomainMigrateUnmanaged(domain, dxml, flags, dname,\n                                          dstURI, uri, bandwidth) < 0) {\n                VIR_FREE(dstURI);\n                goto error;\n            }\n            VIR_FREE(dstURI);\n\n            ddomain = virDomainLookupByName(dconn, dname ? dname : domain->name);\n        } else {\n            /* This driver does not support peer to peer migration */\n            virReportUnsupportedError();\n            goto error;\n        }\n    } else {\n        /* Change protection requires support only on source side, and\n         * is only needed in v3 migration, which automatically re-adds\n         * the flag for just the source side.  We mask it out for\n         * non-peer2peer to allow migration from newer source to an\n         * older destination that rejects the flag.  */\n        if (flags & VIR_MIGRATE_CHANGE_PROTECTION &&\n            !VIR_DRV_SUPPORTS_FEATURE(domain->conn->driver, domain->conn,\n                                      VIR_DRV_FEATURE_MIGRATE_CHANGE_PROTECTION)) {\n            virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED, \"%s\",\n                           _(\"cannot enforce change protection\"));\n            goto error;\n        }\n        flags &= ~VIR_MIGRATE_CHANGE_PROTECTION;\n        if (flags & VIR_MIGRATE_TUNNELLED) {\n            virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                           _(\"cannot perform tunnelled migration without using peer2peer flag\"));\n            goto error;\n        }\n\n        /* Check that migration is supported by both drivers. */\n        if (VIR_DRV_SUPPORTS_FEATURE(domain->conn->driver, domain->conn,\n                                     VIR_DRV_FEATURE_MIGRATION_V3) &&\n            VIR_DRV_SUPPORTS_FEATURE(dconn->driver, dconn,\n                                     VIR_DRV_FEATURE_MIGRATION_V3)) {\n            VIR_DEBUG(\"Using migration protocol 3\");\n            ddomain = virDomainMigrateVersion3(domain, dconn, dxml,\n                                               flags, dname, uri, bandwidth);\n        } else if (VIR_DRV_SUPPORTS_FEATURE(domain->conn->driver, domain->conn,\n                                            VIR_DRV_FEATURE_MIGRATION_V2) &&\n                   VIR_DRV_SUPPORTS_FEATURE(dconn->driver, dconn,\n                                          VIR_DRV_FEATURE_MIGRATION_V2)) {\n            VIR_DEBUG(\"Using migration protocol 2\");\n            if (dxml) {\n                virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED, \"%s\",\n                               _(\"Unable to change target guest XML during migration\"));\n                goto error;\n            }\n            ddomain = virDomainMigrateVersion2(domain, dconn, flags,\n                                               dname, uri, bandwidth);\n        } else if (VIR_DRV_SUPPORTS_FEATURE(domain->conn->driver, domain->conn,\n                                            VIR_DRV_FEATURE_MIGRATION_V1) &&\n                   VIR_DRV_SUPPORTS_FEATURE(dconn->driver, dconn,\n                                            VIR_DRV_FEATURE_MIGRATION_V1)) {\n            VIR_DEBUG(\"Using migration protocol 1\");\n            if (dxml) {\n                virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED, \"%s\",\n                               _(\"Unable to change target guest XML during migration\"));\n                goto error;\n            }\n            ddomain = virDomainMigrateVersion1(domain, dconn, flags,\n                                               dname, uri, bandwidth);\n        } else {\n            /* This driver does not support any migration method */\n            virReportUnsupportedError();\n            goto error;\n        }\n    }\n\n    if (ddomain == NULL)\n        goto error;\n\n    return ddomain;\n\n error:\n    virDispatchError(domain->conn);\n    return NULL;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "domain->conn"
          ],
          "line": 3816
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 3805
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainMigrateVersion1",
          "args": [
            "domain",
            "dconn",
            "flags",
            "dname",
            "uri",
            "bandwidth"
          ],
          "line": 3801
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainMigrateVersion1",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
          "lines": "2721-2794",
          "snippet": "static virDomainPtr\nvirDomainMigrateVersion1(virDomainPtr domain,\n                         virConnectPtr dconn,\n                         unsigned long flags,\n                         const char *dname,\n                         const char *uri,\n                         unsigned long bandwidth)\n{\n    virDomainPtr ddomain = NULL;\n    char *uri_out = NULL;\n    char *cookie = NULL;\n    int cookielen = 0, ret;\n    virDomainInfo info;\n    unsigned int destflags;\n\n    VIR_DOMAIN_DEBUG(domain,\n                     \"dconn=%p, flags=0x%lx, dname=%s, uri=%s, bandwidth=%lu\",\n                     dconn, flags, NULLSTR(dname), NULLSTR(uri), bandwidth);\n\n    ret = virDomainGetInfo(domain, &info);\n    if (ret == 0 && info.state == VIR_DOMAIN_PAUSED)\n        flags |= VIR_MIGRATE_PAUSED;\n\n    destflags = flags & ~(VIR_MIGRATE_ABORT_ON_ERROR |\n                          VIR_MIGRATE_AUTO_CONVERGE);\n\n    /* Prepare the migration.\n     *\n     * The destination host may return a cookie, or leave cookie as\n     * NULL.\n     *\n     * The destination host MUST set uri_out if uri_in is NULL.\n     *\n     * If uri_in is non-NULL, then the destination host may modify\n     * the URI by setting uri_out.  If it does not wish to modify\n     * the URI, it should leave uri_out as NULL.\n     */\n    if (dconn->driver->domainMigratePrepare\n        (dconn, &cookie, &cookielen, uri, &uri_out, destflags, dname,\n         bandwidth) == -1)\n        goto done;\n\n    if (uri == NULL && uri_out == NULL) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"domainMigratePrepare did not set uri\"));\n        goto done;\n    }\n    if (uri_out)\n        uri = uri_out; /* Did domainMigratePrepare change URI? */\n\n    /* Perform the migration.  The driver isn't supposed to return\n     * until the migration is complete.\n     */\n    if (domain->conn->driver->domainMigratePerform\n        (domain, cookie, cookielen, uri, flags, dname, bandwidth) == -1)\n        goto done;\n\n    /* Get the destination domain and return it or error.\n     * 'domain' no longer actually exists at this point\n     * (or so we hope), but we still use the object in memory\n     * in order to get the name.\n     */\n    dname = dname ? dname : domain->name;\n    if (dconn->driver->domainMigrateFinish)\n        ddomain = dconn->driver->domainMigrateFinish\n            (dconn, dname, cookie, cookielen, uri, destflags);\n    else\n        ddomain = virDomainLookupByName(dconn, dname);\n\n done:\n    VIR_FREE(uri_out);\n    VIR_FREE(cookie);\n    return ddomain;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nstatic virDomainPtr\nvirDomainMigrateVersion1(virDomainPtr domain,\n                         virConnectPtr dconn,\n                         unsigned long flags,\n                         const char *dname,\n                         const char *uri,\n                         unsigned long bandwidth)\n{\n    virDomainPtr ddomain = NULL;\n    char *uri_out = NULL;\n    char *cookie = NULL;\n    int cookielen = 0, ret;\n    virDomainInfo info;\n    unsigned int destflags;\n\n    VIR_DOMAIN_DEBUG(domain,\n                     \"dconn=%p, flags=0x%lx, dname=%s, uri=%s, bandwidth=%lu\",\n                     dconn, flags, NULLSTR(dname), NULLSTR(uri), bandwidth);\n\n    ret = virDomainGetInfo(domain, &info);\n    if (ret == 0 && info.state == VIR_DOMAIN_PAUSED)\n        flags |= VIR_MIGRATE_PAUSED;\n\n    destflags = flags & ~(VIR_MIGRATE_ABORT_ON_ERROR |\n                          VIR_MIGRATE_AUTO_CONVERGE);\n\n    /* Prepare the migration.\n     *\n     * The destination host may return a cookie, or leave cookie as\n     * NULL.\n     *\n     * The destination host MUST set uri_out if uri_in is NULL.\n     *\n     * If uri_in is non-NULL, then the destination host may modify\n     * the URI by setting uri_out.  If it does not wish to modify\n     * the URI, it should leave uri_out as NULL.\n     */\n    if (dconn->driver->domainMigratePrepare\n        (dconn, &cookie, &cookielen, uri, &uri_out, destflags, dname,\n         bandwidth) == -1)\n        goto done;\n\n    if (uri == NULL && uri_out == NULL) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"domainMigratePrepare did not set uri\"));\n        goto done;\n    }\n    if (uri_out)\n        uri = uri_out; /* Did domainMigratePrepare change URI? */\n\n    /* Perform the migration.  The driver isn't supposed to return\n     * until the migration is complete.\n     */\n    if (domain->conn->driver->domainMigratePerform\n        (domain, cookie, cookielen, uri, flags, dname, bandwidth) == -1)\n        goto done;\n\n    /* Get the destination domain and return it or error.\n     * 'domain' no longer actually exists at this point\n     * (or so we hope), but we still use the object in memory\n     * in order to get the name.\n     */\n    dname = dname ? dname : domain->name;\n    if (dconn->driver->domainMigrateFinish)\n        ddomain = dconn->driver->domainMigrateFinish\n            (dconn, dname, cookie, cookielen, uri, destflags);\n    else\n        ddomain = virDomainLookupByName(dconn, dname);\n\n done:\n    VIR_FREE(uri_out);\n    VIR_FREE(cookie);\n    return ddomain;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_ARGUMENT_UNSUPPORTED",
            "\"%s\"",
            "_(\"Unable to change target guest XML during migration\")"
          ],
          "line": 3797
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to change target guest XML during migration\""
          ],
          "line": 3798
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Using migration protocol 1\""
          ],
          "line": 3795
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DRV_SUPPORTS_FEATURE",
          "args": [
            "dconn->driver",
            "dconn",
            "VIR_DRV_FEATURE_MIGRATION_V1"
          ],
          "line": 3793
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DRV_SUPPORTS_FEATURE",
          "args": [
            "domain->conn->driver",
            "domain->conn",
            "VIR_DRV_FEATURE_MIGRATION_V1"
          ],
          "line": 3791
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainMigrateVersion2",
          "args": [
            "domain",
            "dconn",
            "flags",
            "dname",
            "uri",
            "bandwidth"
          ],
          "line": 3789
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainMigrateVersion2",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
          "lines": "2816-2930",
          "snippet": "static virDomainPtr\nvirDomainMigrateVersion2(virDomainPtr domain,\n                         virConnectPtr dconn,\n                         unsigned long flags,\n                         const char *dname,\n                         const char *uri,\n                         unsigned long bandwidth)\n{\n    virDomainPtr ddomain = NULL;\n    char *uri_out = NULL;\n    char *cookie = NULL;\n    char *dom_xml = NULL;\n    int cookielen = 0, ret;\n    virDomainInfo info;\n    virErrorPtr orig_err = NULL;\n    unsigned int getxml_flags = 0;\n    int cancelled;\n    unsigned long destflags;\n\n    VIR_DOMAIN_DEBUG(domain,\n                     \"dconn=%p, flags=0x%lx, dname=%s, uri=%s, bandwidth=%lu\",\n                     dconn, flags, NULLSTR(dname), NULLSTR(uri), bandwidth);\n\n    /* Prepare the migration.\n     *\n     * The destination host may return a cookie, or leave cookie as\n     * NULL.\n     *\n     * The destination host MUST set uri_out if uri_in is NULL.\n     *\n     * If uri_in is non-NULL, then the destination host may modify\n     * the URI by setting uri_out.  If it does not wish to modify\n     * the URI, it should leave uri_out as NULL.\n     */\n\n    /* In version 2 of the protocol, the prepare step is slightly\n     * different.  We fetch the domain XML of the source domain\n     * and pass it to Prepare2.\n     */\n    if (!domain->conn->driver->domainGetXMLDesc) {\n        virReportUnsupportedError();\n        return NULL;\n    }\n\n    if (VIR_DRV_SUPPORTS_FEATURE(domain->conn->driver, domain->conn,\n                                 VIR_DRV_FEATURE_XML_MIGRATABLE)) {\n        getxml_flags |= VIR_DOMAIN_XML_MIGRATABLE;\n    } else {\n        getxml_flags |= VIR_DOMAIN_XML_SECURE | VIR_DOMAIN_XML_UPDATE_CPU;\n    }\n\n    dom_xml = domain->conn->driver->domainGetXMLDesc(domain, getxml_flags);\n    if (!dom_xml)\n        return NULL;\n\n    ret = virDomainGetInfo(domain, &info);\n    if (ret == 0 && info.state == VIR_DOMAIN_PAUSED)\n        flags |= VIR_MIGRATE_PAUSED;\n\n    destflags = flags & ~(VIR_MIGRATE_ABORT_ON_ERROR |\n                          VIR_MIGRATE_AUTO_CONVERGE);\n\n    VIR_DEBUG(\"Prepare2 %p flags=0x%lx\", dconn, destflags);\n    ret = dconn->driver->domainMigratePrepare2\n        (dconn, &cookie, &cookielen, uri, &uri_out, destflags, dname,\n         bandwidth, dom_xml);\n    VIR_FREE(dom_xml);\n    if (ret == -1)\n        goto done;\n\n    if (uri == NULL && uri_out == NULL) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"domainMigratePrepare2 did not set uri\"));\n        cancelled = 1;\n        /* Make sure Finish doesn't overwrite the error */\n        virErrorPreserveLast(&orig_err);\n        goto finish;\n    }\n    if (uri_out)\n        uri = uri_out; /* Did domainMigratePrepare2 change URI? */\n\n    /* Perform the migration.  The driver isn't supposed to return\n     * until the migration is complete.\n     */\n    VIR_DEBUG(\"Perform %p\", domain->conn);\n    ret = domain->conn->driver->domainMigratePerform\n        (domain, cookie, cookielen, uri, flags, dname, bandwidth);\n\n    /* Perform failed. Make sure Finish doesn't overwrite the error */\n    if (ret < 0)\n        virErrorPreserveLast(&orig_err);\n\n    /* If Perform returns < 0, then we need to cancel the VM\n     * startup on the destination\n     */\n    cancelled = ret < 0 ? 1 : 0;\n\n finish:\n    /* In version 2 of the migration protocol, we pass the\n     * status code from the sender to the destination host,\n     * so it can do any cleanup if the migration failed.\n     */\n    dname = dname ? dname : domain->name;\n    VIR_DEBUG(\"Finish2 %p ret=%d\", dconn, ret);\n    ddomain = dconn->driver->domainMigrateFinish2\n        (dconn, dname, cookie, cookielen, uri, destflags, cancelled);\n    if (cancelled && ddomain)\n        VIR_ERROR(_(\"finish step ignored that migration was cancelled\"));\n\n done:\n    virErrorRestore(&orig_err);\n    VIR_FREE(uri_out);\n    VIR_FREE(cookie);\n    return ddomain;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nstatic virDomainPtr\nvirDomainMigrateVersion2(virDomainPtr domain,\n                         virConnectPtr dconn,\n                         unsigned long flags,\n                         const char *dname,\n                         const char *uri,\n                         unsigned long bandwidth)\n{\n    virDomainPtr ddomain = NULL;\n    char *uri_out = NULL;\n    char *cookie = NULL;\n    char *dom_xml = NULL;\n    int cookielen = 0, ret;\n    virDomainInfo info;\n    virErrorPtr orig_err = NULL;\n    unsigned int getxml_flags = 0;\n    int cancelled;\n    unsigned long destflags;\n\n    VIR_DOMAIN_DEBUG(domain,\n                     \"dconn=%p, flags=0x%lx, dname=%s, uri=%s, bandwidth=%lu\",\n                     dconn, flags, NULLSTR(dname), NULLSTR(uri), bandwidth);\n\n    /* Prepare the migration.\n     *\n     * The destination host may return a cookie, or leave cookie as\n     * NULL.\n     *\n     * The destination host MUST set uri_out if uri_in is NULL.\n     *\n     * If uri_in is non-NULL, then the destination host may modify\n     * the URI by setting uri_out.  If it does not wish to modify\n     * the URI, it should leave uri_out as NULL.\n     */\n\n    /* In version 2 of the protocol, the prepare step is slightly\n     * different.  We fetch the domain XML of the source domain\n     * and pass it to Prepare2.\n     */\n    if (!domain->conn->driver->domainGetXMLDesc) {\n        virReportUnsupportedError();\n        return NULL;\n    }\n\n    if (VIR_DRV_SUPPORTS_FEATURE(domain->conn->driver, domain->conn,\n                                 VIR_DRV_FEATURE_XML_MIGRATABLE)) {\n        getxml_flags |= VIR_DOMAIN_XML_MIGRATABLE;\n    } else {\n        getxml_flags |= VIR_DOMAIN_XML_SECURE | VIR_DOMAIN_XML_UPDATE_CPU;\n    }\n\n    dom_xml = domain->conn->driver->domainGetXMLDesc(domain, getxml_flags);\n    if (!dom_xml)\n        return NULL;\n\n    ret = virDomainGetInfo(domain, &info);\n    if (ret == 0 && info.state == VIR_DOMAIN_PAUSED)\n        flags |= VIR_MIGRATE_PAUSED;\n\n    destflags = flags & ~(VIR_MIGRATE_ABORT_ON_ERROR |\n                          VIR_MIGRATE_AUTO_CONVERGE);\n\n    VIR_DEBUG(\"Prepare2 %p flags=0x%lx\", dconn, destflags);\n    ret = dconn->driver->domainMigratePrepare2\n        (dconn, &cookie, &cookielen, uri, &uri_out, destflags, dname,\n         bandwidth, dom_xml);\n    VIR_FREE(dom_xml);\n    if (ret == -1)\n        goto done;\n\n    if (uri == NULL && uri_out == NULL) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"domainMigratePrepare2 did not set uri\"));\n        cancelled = 1;\n        /* Make sure Finish doesn't overwrite the error */\n        virErrorPreserveLast(&orig_err);\n        goto finish;\n    }\n    if (uri_out)\n        uri = uri_out; /* Did domainMigratePrepare2 change URI? */\n\n    /* Perform the migration.  The driver isn't supposed to return\n     * until the migration is complete.\n     */\n    VIR_DEBUG(\"Perform %p\", domain->conn);\n    ret = domain->conn->driver->domainMigratePerform\n        (domain, cookie, cookielen, uri, flags, dname, bandwidth);\n\n    /* Perform failed. Make sure Finish doesn't overwrite the error */\n    if (ret < 0)\n        virErrorPreserveLast(&orig_err);\n\n    /* If Perform returns < 0, then we need to cancel the VM\n     * startup on the destination\n     */\n    cancelled = ret < 0 ? 1 : 0;\n\n finish:\n    /* In version 2 of the migration protocol, we pass the\n     * status code from the sender to the destination host,\n     * so it can do any cleanup if the migration failed.\n     */\n    dname = dname ? dname : domain->name;\n    VIR_DEBUG(\"Finish2 %p ret=%d\", dconn, ret);\n    ddomain = dconn->driver->domainMigrateFinish2\n        (dconn, dname, cookie, cookielen, uri, destflags, cancelled);\n    if (cancelled && ddomain)\n        VIR_ERROR(_(\"finish step ignored that migration was cancelled\"));\n\n done:\n    virErrorRestore(&orig_err);\n    VIR_FREE(uri_out);\n    VIR_FREE(cookie);\n    return ddomain;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_ARGUMENT_UNSUPPORTED",
            "\"%s\"",
            "_(\"Unable to change target guest XML during migration\")"
          ],
          "line": 3785
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Using migration protocol 2\""
          ],
          "line": 3783
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DRV_SUPPORTS_FEATURE",
          "args": [
            "dconn->driver",
            "dconn",
            "VIR_DRV_FEATURE_MIGRATION_V2"
          ],
          "line": 3781
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DRV_SUPPORTS_FEATURE",
          "args": [
            "domain->conn->driver",
            "domain->conn",
            "VIR_DRV_FEATURE_MIGRATION_V2"
          ],
          "line": 3779
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainMigrateVersion3",
          "args": [
            "domain",
            "dconn",
            "dxml",
            "flags",
            "dname",
            "uri",
            "bandwidth"
          ],
          "line": 3777
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainMigrateVersion3",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
          "lines": "3260-3271",
          "snippet": "static virDomainPtr\nvirDomainMigrateVersion3(virDomainPtr domain,\n                         virConnectPtr dconn,\n                         const char *xmlin,\n                         unsigned long flags,\n                         const char *dname,\n                         const char *uri,\n                         unsigned long bandwidth)\n{\n    return virDomainMigrateVersion3Full(domain, dconn, xmlin, dname, uri,\n                                        bandwidth, NULL, 0, false, flags);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nstatic virDomainPtr\nvirDomainMigrateVersion3(virDomainPtr domain,\n                         virConnectPtr dconn,\n                         const char *xmlin,\n                         unsigned long flags,\n                         const char *dname,\n                         const char *uri,\n                         unsigned long bandwidth)\n{\n    return virDomainMigrateVersion3Full(domain, dconn, xmlin, dname, uri,\n                                        bandwidth, NULL, 0, false, flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Using migration protocol 3\""
          ],
          "line": 3776
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DRV_SUPPORTS_FEATURE",
          "args": [
            "dconn->driver",
            "dconn",
            "VIR_DRV_FEATURE_MIGRATION_V3"
          ],
          "line": 3774
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DRV_SUPPORTS_FEATURE",
          "args": [
            "domain->conn->driver",
            "domain->conn",
            "VIR_DRV_FEATURE_MIGRATION_V3"
          ],
          "line": 3772
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_INVALID",
            "\"%s\"",
            "_(\"cannot perform tunnelled migration without using peer2peer flag\")"
          ],
          "line": 3766
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_ARGUMENT_UNSUPPORTED",
            "\"%s\"",
            "_(\"cannot enforce change protection\")"
          ],
          "line": 3760
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DRV_SUPPORTS_FEATURE",
          "args": [
            "domain->conn->driver",
            "domain->conn",
            "VIR_DRV_FEATURE_MIGRATE_CHANGE_PROTECTION"
          ],
          "line": 3758
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 3748
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainLookupByName",
          "args": [
            "dconn",
            "dname ? dname : domain->name"
          ],
          "line": 3745
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainLookupByName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
          "lines": "410-433",
          "snippet": "virDomainPtr\nvirDomainLookupByName(virConnectPtr conn, const char *name)\n{\n    VIR_DEBUG(\"conn=%p, name=%s\", conn, NULLSTR(name));\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, NULL);\n    virCheckNonNullArgGoto(name, error);\n\n    if (conn->driver->domainLookupByName) {\n        virDomainPtr dom;\n        dom = conn->driver->domainLookupByName(conn, name);\n        if (!dom)\n            goto error;\n        return dom;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return NULL;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nvirDomainPtr\nvirDomainLookupByName(virConnectPtr conn, const char *name)\n{\n    VIR_DEBUG(\"conn=%p, name=%s\", conn, NULLSTR(name));\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, NULL);\n    virCheckNonNullArgGoto(name, error);\n\n    if (conn->driver->domainLookupByName) {\n        virDomainPtr dom;\n        dom = conn->driver->domainLookupByName(conn, name);\n        if (!dom)\n            goto error;\n        return dom;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "dstURI"
          ],
          "line": 3743
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "dstURI"
          ],
          "line": 3740
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainMigrateUnmanaged",
          "args": [
            "domain",
            "dxml",
            "flags",
            "dname",
            "dstURI",
            "uri",
            "bandwidth"
          ],
          "line": 3738
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainMigrateUnmanaged",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
          "lines": "3459-3496",
          "snippet": "static int\nvirDomainMigrateUnmanaged(virDomainPtr domain,\n                          const char *xmlin,\n                          unsigned int flags,\n                          const char *dname,\n                          const char *dconnuri,\n                          const char *miguri,\n                          unsigned long long bandwidth)\n{\n    int ret = -1;\n    virTypedParameterPtr params = NULL;\n    int nparams = 0;\n    int maxparams = 0;\n\n    if (miguri &&\n        virTypedParamsAddString(&params, &nparams, &maxparams,\n                                VIR_MIGRATE_PARAM_URI, miguri) < 0)\n        goto cleanup;\n    if (dname &&\n        virTypedParamsAddString(&params, &nparams, &maxparams,\n                                VIR_MIGRATE_PARAM_DEST_NAME, dname) < 0)\n        goto cleanup;\n    if (xmlin &&\n        virTypedParamsAddString(&params, &nparams, &maxparams,\n                                VIR_MIGRATE_PARAM_DEST_XML, xmlin) < 0)\n        goto cleanup;\n    if (virTypedParamsAddULLong(&params, &nparams, &maxparams,\n                                VIR_MIGRATE_PARAM_BANDWIDTH, bandwidth) < 0)\n        goto cleanup;\n\n    ret = virDomainMigrateUnmanagedParams(domain, dconnuri, params,\n                                          nparams, flags);\n\n cleanup:\n    virTypedParamsFree(params, nparams);\n\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nstatic int\nvirDomainMigrateUnmanaged(virDomainPtr domain,\n                          const char *xmlin,\n                          unsigned int flags,\n                          const char *dname,\n                          const char *dconnuri,\n                          const char *miguri,\n                          unsigned long long bandwidth)\n{\n    int ret = -1;\n    virTypedParameterPtr params = NULL;\n    int nparams = 0;\n    int maxparams = 0;\n\n    if (miguri &&\n        virTypedParamsAddString(&params, &nparams, &maxparams,\n                                VIR_MIGRATE_PARAM_URI, miguri) < 0)\n        goto cleanup;\n    if (dname &&\n        virTypedParamsAddString(&params, &nparams, &maxparams,\n                                VIR_MIGRATE_PARAM_DEST_NAME, dname) < 0)\n        goto cleanup;\n    if (xmlin &&\n        virTypedParamsAddString(&params, &nparams, &maxparams,\n                                VIR_MIGRATE_PARAM_DEST_XML, xmlin) < 0)\n        goto cleanup;\n    if (virTypedParamsAddULLong(&params, &nparams, &maxparams,\n                                VIR_MIGRATE_PARAM_BANDWIDTH, bandwidth) < 0)\n        goto cleanup;\n\n    ret = virDomainMigrateUnmanagedParams(domain, dconnuri, params,\n                                          nparams, flags);\n\n cleanup:\n    virTypedParamsFree(params, nparams);\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Using peer2peer migration\""
          ],
          "line": 3737
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virConnectGetURI",
          "args": [
            "dconn"
          ],
          "line": 3733
        },
        "resolved": true,
        "details": {
          "function_name": "virConnectGetURI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-host.c",
          "lines": "299-317",
          "snippet": "char *\nvirConnectGetURI(virConnectPtr conn)\n{\n    char *name;\n    VIR_DEBUG(\"conn=%p\", conn);\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, NULL);\n\n    if (!(name = virURIFormat(conn->uri)))\n        goto error;\n\n    return name;\n\n error:\n    virDispatchError(conn);\n    return NULL;\n}",
          "includes": [
            "#include \"virtypedparam.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nchar *\nvirConnectGetURI(virConnectPtr conn)\n{\n    char *name;\n    VIR_DEBUG(\"conn=%p\", conn);\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, NULL);\n\n    if (!(name = virURIFormat(conn->uri)))\n        goto error;\n\n    return name;\n\n error:\n    virDispatchError(conn);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DRV_SUPPORTS_FEATURE",
          "args": [
            "domain->conn->driver",
            "domain->conn",
            "VIR_DRV_FEATURE_MIGRATION_P2P"
          ],
          "line": 3731
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_ARGUMENT_UNSUPPORTED",
            "\"%s\"",
            "_(\"offline migration is not supported by \"\n                             \"the destination host\")"
          ],
          "line": 3723
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DRV_SUPPORTS_FEATURE",
          "args": [
            "dconn->driver",
            "dconn",
            "VIR_DRV_FEATURE_MIGRATION_OFFLINE"
          ],
          "line": 3721
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_ARGUMENT_UNSUPPORTED",
            "\"%s\"",
            "_(\"offline migration is not supported by \"\n                             \"the source host\")"
          ],
          "line": 3716
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DRV_SUPPORTS_FEATURE",
          "args": [
            "domain->conn->driver",
            "domain->conn",
            "VIR_DRV_FEATURE_MIGRATION_OFFLINE"
          ],
          "line": 3714
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_EXCLUSIVE_FLAGS_GOTO",
          "args": [
            "VIR_MIGRATE_TUNNELLED",
            "VIR_MIGRATE_PARALLEL",
            "error"
          ],
          "line": 3709
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_EXCLUSIVE_FLAGS_GOTO",
          "args": [
            "VIR_MIGRATE_NON_SHARED_DISK",
            "VIR_MIGRATE_NON_SHARED_INC",
            "error"
          ],
          "line": 3705
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "dconn->flags",
            "error"
          ],
          "line": 3703
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckConnectGoto",
          "args": [
            "dconn",
            "error"
          ],
          "line": 3702
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "domain->conn->flags",
            "error"
          ],
          "line": 3699
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "domain",
            "NULL"
          ],
          "line": 3698
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 3695
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "domain",
            "\"dconn=%p, flags=0x%lx, dname=%s, uri=%s, bandwidth=%lu\"",
            "dconn",
            "flags",
            "NULLSTR(dname)",
            "NULLSTR(uri)",
            "bandwidth"
          ],
          "line": 3691
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "uri"
          ],
          "line": 3693
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "dname"
          ],
          "line": 3693
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nvirDomainPtr\nvirDomainMigrate2(virDomainPtr domain,\n                  virConnectPtr dconn,\n                  const char *dxml,\n                  unsigned long flags,\n                  const char *dname,\n                  const char *uri,\n                  unsigned long bandwidth)\n{\n    virDomainPtr ddomain = NULL;\n\n    VIR_DOMAIN_DEBUG(domain,\n                     \"dconn=%p, flags=0x%lx, dname=%s, uri=%s, bandwidth=%lu\",\n                     dconn, flags, NULLSTR(dname), NULLSTR(uri), bandwidth);\n\n    virResetLastError();\n\n    /* First checkout the source */\n    virCheckDomainReturn(domain, NULL);\n    virCheckReadOnlyGoto(domain->conn->flags, error);\n\n    /* Now checkout the destination */\n    virCheckConnectGoto(dconn, error);\n    virCheckReadOnlyGoto(dconn->flags, error);\n\n    VIR_EXCLUSIVE_FLAGS_GOTO(VIR_MIGRATE_NON_SHARED_DISK,\n                             VIR_MIGRATE_NON_SHARED_INC,\n                             error);\n\n    VIR_EXCLUSIVE_FLAGS_GOTO(VIR_MIGRATE_TUNNELLED,\n                             VIR_MIGRATE_PARALLEL,\n                             error);\n\n    if (flags & VIR_MIGRATE_OFFLINE) {\n        if (!VIR_DRV_SUPPORTS_FEATURE(domain->conn->driver, domain->conn,\n                                      VIR_DRV_FEATURE_MIGRATION_OFFLINE)) {\n            virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED, \"%s\",\n                           _(\"offline migration is not supported by \"\n                             \"the source host\"));\n            goto error;\n        }\n        if (!VIR_DRV_SUPPORTS_FEATURE(dconn->driver, dconn,\n                                      VIR_DRV_FEATURE_MIGRATION_OFFLINE)) {\n            virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED, \"%s\",\n                           _(\"offline migration is not supported by \"\n                             \"the destination host\"));\n            goto error;\n        }\n    }\n\n    if (flags & VIR_MIGRATE_PEER2PEER) {\n        if (VIR_DRV_SUPPORTS_FEATURE(domain->conn->driver, domain->conn,\n                                     VIR_DRV_FEATURE_MIGRATION_P2P)) {\n            char *dstURI = virConnectGetURI(dconn);\n            if (!dstURI)\n                return NULL;\n\n            VIR_DEBUG(\"Using peer2peer migration\");\n            if (virDomainMigrateUnmanaged(domain, dxml, flags, dname,\n                                          dstURI, uri, bandwidth) < 0) {\n                VIR_FREE(dstURI);\n                goto error;\n            }\n            VIR_FREE(dstURI);\n\n            ddomain = virDomainLookupByName(dconn, dname ? dname : domain->name);\n        } else {\n            /* This driver does not support peer to peer migration */\n            virReportUnsupportedError();\n            goto error;\n        }\n    } else {\n        /* Change protection requires support only on source side, and\n         * is only needed in v3 migration, which automatically re-adds\n         * the flag for just the source side.  We mask it out for\n         * non-peer2peer to allow migration from newer source to an\n         * older destination that rejects the flag.  */\n        if (flags & VIR_MIGRATE_CHANGE_PROTECTION &&\n            !VIR_DRV_SUPPORTS_FEATURE(domain->conn->driver, domain->conn,\n                                      VIR_DRV_FEATURE_MIGRATE_CHANGE_PROTECTION)) {\n            virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED, \"%s\",\n                           _(\"cannot enforce change protection\"));\n            goto error;\n        }\n        flags &= ~VIR_MIGRATE_CHANGE_PROTECTION;\n        if (flags & VIR_MIGRATE_TUNNELLED) {\n            virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                           _(\"cannot perform tunnelled migration without using peer2peer flag\"));\n            goto error;\n        }\n\n        /* Check that migration is supported by both drivers. */\n        if (VIR_DRV_SUPPORTS_FEATURE(domain->conn->driver, domain->conn,\n                                     VIR_DRV_FEATURE_MIGRATION_V3) &&\n            VIR_DRV_SUPPORTS_FEATURE(dconn->driver, dconn,\n                                     VIR_DRV_FEATURE_MIGRATION_V3)) {\n            VIR_DEBUG(\"Using migration protocol 3\");\n            ddomain = virDomainMigrateVersion3(domain, dconn, dxml,\n                                               flags, dname, uri, bandwidth);\n        } else if (VIR_DRV_SUPPORTS_FEATURE(domain->conn->driver, domain->conn,\n                                            VIR_DRV_FEATURE_MIGRATION_V2) &&\n                   VIR_DRV_SUPPORTS_FEATURE(dconn->driver, dconn,\n                                          VIR_DRV_FEATURE_MIGRATION_V2)) {\n            VIR_DEBUG(\"Using migration protocol 2\");\n            if (dxml) {\n                virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED, \"%s\",\n                               _(\"Unable to change target guest XML during migration\"));\n                goto error;\n            }\n            ddomain = virDomainMigrateVersion2(domain, dconn, flags,\n                                               dname, uri, bandwidth);\n        } else if (VIR_DRV_SUPPORTS_FEATURE(domain->conn->driver, domain->conn,\n                                            VIR_DRV_FEATURE_MIGRATION_V1) &&\n                   VIR_DRV_SUPPORTS_FEATURE(dconn->driver, dconn,\n                                            VIR_DRV_FEATURE_MIGRATION_V1)) {\n            VIR_DEBUG(\"Using migration protocol 1\");\n            if (dxml) {\n                virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED, \"%s\",\n                               _(\"Unable to change target guest XML during migration\"));\n                goto error;\n            }\n            ddomain = virDomainMigrateVersion1(domain, dconn, flags,\n                                               dname, uri, bandwidth);\n        } else {\n            /* This driver does not support any migration method */\n            virReportUnsupportedError();\n            goto error;\n        }\n    }\n\n    if (ddomain == NULL)\n        goto error;\n\n    return ddomain;\n\n error:\n    virDispatchError(domain->conn);\n    return NULL;\n}"
  },
  {
    "function_name": "virDomainMigrate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "3522-3652",
    "snippet": "virDomainPtr\nvirDomainMigrate(virDomainPtr domain,\n                 virConnectPtr dconn,\n                 unsigned long flags,\n                 const char *dname,\n                 const char *uri,\n                 unsigned long bandwidth)\n{\n    virDomainPtr ddomain = NULL;\n\n    VIR_DOMAIN_DEBUG(domain,\n                     \"dconn=%p, flags=0x%lx, dname=%s, uri=%s, bandwidth=%lu\",\n                     dconn, flags, NULLSTR(dname), NULLSTR(uri), bandwidth);\n\n    virResetLastError();\n\n    /* First checkout the source */\n    virCheckDomainReturn(domain, NULL);\n    virCheckReadOnlyGoto(domain->conn->flags, error);\n\n    /* Now checkout the destination */\n    virCheckConnectGoto(dconn, error);\n    virCheckReadOnlyGoto(dconn->flags, error);\n\n    VIR_EXCLUSIVE_FLAGS_GOTO(VIR_MIGRATE_NON_SHARED_DISK,\n                             VIR_MIGRATE_NON_SHARED_INC,\n                             error);\n\n    VIR_EXCLUSIVE_FLAGS_GOTO(VIR_MIGRATE_TUNNELLED,\n                             VIR_MIGRATE_PARALLEL,\n                             error);\n\n    if (flags & VIR_MIGRATE_OFFLINE) {\n        if (!VIR_DRV_SUPPORTS_FEATURE(domain->conn->driver, domain->conn,\n                                      VIR_DRV_FEATURE_MIGRATION_OFFLINE)) {\n            virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED, \"%s\",\n                           _(\"offline migration is not supported by \"\n                             \"the source host\"));\n            goto error;\n        }\n        if (!VIR_DRV_SUPPORTS_FEATURE(dconn->driver, dconn,\n                                      VIR_DRV_FEATURE_MIGRATION_OFFLINE)) {\n            virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED, \"%s\",\n                           _(\"offline migration is not supported by \"\n                             \"the destination host\"));\n            goto error;\n        }\n    }\n\n    if (flags & VIR_MIGRATE_PEER2PEER) {\n        if (VIR_DRV_SUPPORTS_FEATURE(domain->conn->driver, domain->conn,\n                                     VIR_DRV_FEATURE_MIGRATION_P2P)) {\n            char *dstURI = NULL;\n            if (uri == NULL) {\n                dstURI = virConnectGetURI(dconn);\n                if (!dstURI)\n                    return NULL;\n            }\n\n            VIR_DEBUG(\"Using peer2peer migration\");\n            if (virDomainMigrateUnmanaged(domain, NULL, flags, dname,\n                                          uri ? uri : dstURI, NULL, bandwidth) < 0) {\n                VIR_FREE(dstURI);\n                goto error;\n            }\n            VIR_FREE(dstURI);\n\n            ddomain = virDomainLookupByName(dconn, dname ? dname : domain->name);\n        } else {\n            /* This driver does not support peer to peer migration */\n            virReportUnsupportedError();\n            goto error;\n        }\n    } else {\n        /* Change protection requires support only on source side, and\n         * is only needed in v3 migration, which automatically re-adds\n         * the flag for just the source side.  We mask it out for\n         * non-peer2peer to allow migration from newer source to an\n         * older destination that rejects the flag.  */\n        if (flags & VIR_MIGRATE_CHANGE_PROTECTION &&\n            !VIR_DRV_SUPPORTS_FEATURE(domain->conn->driver, domain->conn,\n                                      VIR_DRV_FEATURE_MIGRATE_CHANGE_PROTECTION)) {\n            virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED, \"%s\",\n                           _(\"cannot enforce change protection\"));\n            goto error;\n        }\n        flags &= ~VIR_MIGRATE_CHANGE_PROTECTION;\n        if (flags & VIR_MIGRATE_TUNNELLED) {\n            virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                           _(\"cannot perform tunnelled migration without using peer2peer flag\"));\n            goto error;\n        }\n\n        /* Check that migration is supported by both drivers. */\n        if (VIR_DRV_SUPPORTS_FEATURE(domain->conn->driver, domain->conn,\n                                     VIR_DRV_FEATURE_MIGRATION_V3) &&\n            VIR_DRV_SUPPORTS_FEATURE(dconn->driver, dconn,\n                                     VIR_DRV_FEATURE_MIGRATION_V3)) {\n            VIR_DEBUG(\"Using migration protocol 3\");\n            ddomain = virDomainMigrateVersion3(domain, dconn, NULL,\n                                               flags, dname, uri, bandwidth);\n        } else if (VIR_DRV_SUPPORTS_FEATURE(domain->conn->driver, domain->conn,\n                                            VIR_DRV_FEATURE_MIGRATION_V2) &&\n                   VIR_DRV_SUPPORTS_FEATURE(dconn->driver, dconn,\n                                          VIR_DRV_FEATURE_MIGRATION_V2)) {\n            VIR_DEBUG(\"Using migration protocol 2\");\n            ddomain = virDomainMigrateVersion2(domain, dconn, flags,\n                                               dname, uri, bandwidth);\n        } else if (VIR_DRV_SUPPORTS_FEATURE(domain->conn->driver, domain->conn,\n                                            VIR_DRV_FEATURE_MIGRATION_V1) &&\n                   VIR_DRV_SUPPORTS_FEATURE(dconn->driver, dconn,\n                                            VIR_DRV_FEATURE_MIGRATION_V1)) {\n            VIR_DEBUG(\"Using migration protocol 1\");\n            ddomain = virDomainMigrateVersion1(domain, dconn, flags,\n                                               dname, uri, bandwidth);\n        } else {\n            /* This driver does not support any migration method */\n            virReportUnsupportedError();\n            goto error;\n        }\n    }\n\n    if (ddomain == NULL)\n        goto error;\n\n    return ddomain;\n\n error:\n    virDispatchError(domain->conn);\n    return NULL;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "domain->conn"
          ],
          "line": 3650
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 3639
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainMigrateVersion1",
          "args": [
            "domain",
            "dconn",
            "flags",
            "dname",
            "uri",
            "bandwidth"
          ],
          "line": 3635
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainMigrateVersion1",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
          "lines": "2721-2794",
          "snippet": "static virDomainPtr\nvirDomainMigrateVersion1(virDomainPtr domain,\n                         virConnectPtr dconn,\n                         unsigned long flags,\n                         const char *dname,\n                         const char *uri,\n                         unsigned long bandwidth)\n{\n    virDomainPtr ddomain = NULL;\n    char *uri_out = NULL;\n    char *cookie = NULL;\n    int cookielen = 0, ret;\n    virDomainInfo info;\n    unsigned int destflags;\n\n    VIR_DOMAIN_DEBUG(domain,\n                     \"dconn=%p, flags=0x%lx, dname=%s, uri=%s, bandwidth=%lu\",\n                     dconn, flags, NULLSTR(dname), NULLSTR(uri), bandwidth);\n\n    ret = virDomainGetInfo(domain, &info);\n    if (ret == 0 && info.state == VIR_DOMAIN_PAUSED)\n        flags |= VIR_MIGRATE_PAUSED;\n\n    destflags = flags & ~(VIR_MIGRATE_ABORT_ON_ERROR |\n                          VIR_MIGRATE_AUTO_CONVERGE);\n\n    /* Prepare the migration.\n     *\n     * The destination host may return a cookie, or leave cookie as\n     * NULL.\n     *\n     * The destination host MUST set uri_out if uri_in is NULL.\n     *\n     * If uri_in is non-NULL, then the destination host may modify\n     * the URI by setting uri_out.  If it does not wish to modify\n     * the URI, it should leave uri_out as NULL.\n     */\n    if (dconn->driver->domainMigratePrepare\n        (dconn, &cookie, &cookielen, uri, &uri_out, destflags, dname,\n         bandwidth) == -1)\n        goto done;\n\n    if (uri == NULL && uri_out == NULL) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"domainMigratePrepare did not set uri\"));\n        goto done;\n    }\n    if (uri_out)\n        uri = uri_out; /* Did domainMigratePrepare change URI? */\n\n    /* Perform the migration.  The driver isn't supposed to return\n     * until the migration is complete.\n     */\n    if (domain->conn->driver->domainMigratePerform\n        (domain, cookie, cookielen, uri, flags, dname, bandwidth) == -1)\n        goto done;\n\n    /* Get the destination domain and return it or error.\n     * 'domain' no longer actually exists at this point\n     * (or so we hope), but we still use the object in memory\n     * in order to get the name.\n     */\n    dname = dname ? dname : domain->name;\n    if (dconn->driver->domainMigrateFinish)\n        ddomain = dconn->driver->domainMigrateFinish\n            (dconn, dname, cookie, cookielen, uri, destflags);\n    else\n        ddomain = virDomainLookupByName(dconn, dname);\n\n done:\n    VIR_FREE(uri_out);\n    VIR_FREE(cookie);\n    return ddomain;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nstatic virDomainPtr\nvirDomainMigrateVersion1(virDomainPtr domain,\n                         virConnectPtr dconn,\n                         unsigned long flags,\n                         const char *dname,\n                         const char *uri,\n                         unsigned long bandwidth)\n{\n    virDomainPtr ddomain = NULL;\n    char *uri_out = NULL;\n    char *cookie = NULL;\n    int cookielen = 0, ret;\n    virDomainInfo info;\n    unsigned int destflags;\n\n    VIR_DOMAIN_DEBUG(domain,\n                     \"dconn=%p, flags=0x%lx, dname=%s, uri=%s, bandwidth=%lu\",\n                     dconn, flags, NULLSTR(dname), NULLSTR(uri), bandwidth);\n\n    ret = virDomainGetInfo(domain, &info);\n    if (ret == 0 && info.state == VIR_DOMAIN_PAUSED)\n        flags |= VIR_MIGRATE_PAUSED;\n\n    destflags = flags & ~(VIR_MIGRATE_ABORT_ON_ERROR |\n                          VIR_MIGRATE_AUTO_CONVERGE);\n\n    /* Prepare the migration.\n     *\n     * The destination host may return a cookie, or leave cookie as\n     * NULL.\n     *\n     * The destination host MUST set uri_out if uri_in is NULL.\n     *\n     * If uri_in is non-NULL, then the destination host may modify\n     * the URI by setting uri_out.  If it does not wish to modify\n     * the URI, it should leave uri_out as NULL.\n     */\n    if (dconn->driver->domainMigratePrepare\n        (dconn, &cookie, &cookielen, uri, &uri_out, destflags, dname,\n         bandwidth) == -1)\n        goto done;\n\n    if (uri == NULL && uri_out == NULL) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"domainMigratePrepare did not set uri\"));\n        goto done;\n    }\n    if (uri_out)\n        uri = uri_out; /* Did domainMigratePrepare change URI? */\n\n    /* Perform the migration.  The driver isn't supposed to return\n     * until the migration is complete.\n     */\n    if (domain->conn->driver->domainMigratePerform\n        (domain, cookie, cookielen, uri, flags, dname, bandwidth) == -1)\n        goto done;\n\n    /* Get the destination domain and return it or error.\n     * 'domain' no longer actually exists at this point\n     * (or so we hope), but we still use the object in memory\n     * in order to get the name.\n     */\n    dname = dname ? dname : domain->name;\n    if (dconn->driver->domainMigrateFinish)\n        ddomain = dconn->driver->domainMigrateFinish\n            (dconn, dname, cookie, cookielen, uri, destflags);\n    else\n        ddomain = virDomainLookupByName(dconn, dname);\n\n done:\n    VIR_FREE(uri_out);\n    VIR_FREE(cookie);\n    return ddomain;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Using migration protocol 1\""
          ],
          "line": 3634
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DRV_SUPPORTS_FEATURE",
          "args": [
            "dconn->driver",
            "dconn",
            "VIR_DRV_FEATURE_MIGRATION_V1"
          ],
          "line": 3632
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DRV_SUPPORTS_FEATURE",
          "args": [
            "domain->conn->driver",
            "domain->conn",
            "VIR_DRV_FEATURE_MIGRATION_V1"
          ],
          "line": 3630
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainMigrateVersion2",
          "args": [
            "domain",
            "dconn",
            "flags",
            "dname",
            "uri",
            "bandwidth"
          ],
          "line": 3628
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainMigrateVersion2",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
          "lines": "2816-2930",
          "snippet": "static virDomainPtr\nvirDomainMigrateVersion2(virDomainPtr domain,\n                         virConnectPtr dconn,\n                         unsigned long flags,\n                         const char *dname,\n                         const char *uri,\n                         unsigned long bandwidth)\n{\n    virDomainPtr ddomain = NULL;\n    char *uri_out = NULL;\n    char *cookie = NULL;\n    char *dom_xml = NULL;\n    int cookielen = 0, ret;\n    virDomainInfo info;\n    virErrorPtr orig_err = NULL;\n    unsigned int getxml_flags = 0;\n    int cancelled;\n    unsigned long destflags;\n\n    VIR_DOMAIN_DEBUG(domain,\n                     \"dconn=%p, flags=0x%lx, dname=%s, uri=%s, bandwidth=%lu\",\n                     dconn, flags, NULLSTR(dname), NULLSTR(uri), bandwidth);\n\n    /* Prepare the migration.\n     *\n     * The destination host may return a cookie, or leave cookie as\n     * NULL.\n     *\n     * The destination host MUST set uri_out if uri_in is NULL.\n     *\n     * If uri_in is non-NULL, then the destination host may modify\n     * the URI by setting uri_out.  If it does not wish to modify\n     * the URI, it should leave uri_out as NULL.\n     */\n\n    /* In version 2 of the protocol, the prepare step is slightly\n     * different.  We fetch the domain XML of the source domain\n     * and pass it to Prepare2.\n     */\n    if (!domain->conn->driver->domainGetXMLDesc) {\n        virReportUnsupportedError();\n        return NULL;\n    }\n\n    if (VIR_DRV_SUPPORTS_FEATURE(domain->conn->driver, domain->conn,\n                                 VIR_DRV_FEATURE_XML_MIGRATABLE)) {\n        getxml_flags |= VIR_DOMAIN_XML_MIGRATABLE;\n    } else {\n        getxml_flags |= VIR_DOMAIN_XML_SECURE | VIR_DOMAIN_XML_UPDATE_CPU;\n    }\n\n    dom_xml = domain->conn->driver->domainGetXMLDesc(domain, getxml_flags);\n    if (!dom_xml)\n        return NULL;\n\n    ret = virDomainGetInfo(domain, &info);\n    if (ret == 0 && info.state == VIR_DOMAIN_PAUSED)\n        flags |= VIR_MIGRATE_PAUSED;\n\n    destflags = flags & ~(VIR_MIGRATE_ABORT_ON_ERROR |\n                          VIR_MIGRATE_AUTO_CONVERGE);\n\n    VIR_DEBUG(\"Prepare2 %p flags=0x%lx\", dconn, destflags);\n    ret = dconn->driver->domainMigratePrepare2\n        (dconn, &cookie, &cookielen, uri, &uri_out, destflags, dname,\n         bandwidth, dom_xml);\n    VIR_FREE(dom_xml);\n    if (ret == -1)\n        goto done;\n\n    if (uri == NULL && uri_out == NULL) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"domainMigratePrepare2 did not set uri\"));\n        cancelled = 1;\n        /* Make sure Finish doesn't overwrite the error */\n        virErrorPreserveLast(&orig_err);\n        goto finish;\n    }\n    if (uri_out)\n        uri = uri_out; /* Did domainMigratePrepare2 change URI? */\n\n    /* Perform the migration.  The driver isn't supposed to return\n     * until the migration is complete.\n     */\n    VIR_DEBUG(\"Perform %p\", domain->conn);\n    ret = domain->conn->driver->domainMigratePerform\n        (domain, cookie, cookielen, uri, flags, dname, bandwidth);\n\n    /* Perform failed. Make sure Finish doesn't overwrite the error */\n    if (ret < 0)\n        virErrorPreserveLast(&orig_err);\n\n    /* If Perform returns < 0, then we need to cancel the VM\n     * startup on the destination\n     */\n    cancelled = ret < 0 ? 1 : 0;\n\n finish:\n    /* In version 2 of the migration protocol, we pass the\n     * status code from the sender to the destination host,\n     * so it can do any cleanup if the migration failed.\n     */\n    dname = dname ? dname : domain->name;\n    VIR_DEBUG(\"Finish2 %p ret=%d\", dconn, ret);\n    ddomain = dconn->driver->domainMigrateFinish2\n        (dconn, dname, cookie, cookielen, uri, destflags, cancelled);\n    if (cancelled && ddomain)\n        VIR_ERROR(_(\"finish step ignored that migration was cancelled\"));\n\n done:\n    virErrorRestore(&orig_err);\n    VIR_FREE(uri_out);\n    VIR_FREE(cookie);\n    return ddomain;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nstatic virDomainPtr\nvirDomainMigrateVersion2(virDomainPtr domain,\n                         virConnectPtr dconn,\n                         unsigned long flags,\n                         const char *dname,\n                         const char *uri,\n                         unsigned long bandwidth)\n{\n    virDomainPtr ddomain = NULL;\n    char *uri_out = NULL;\n    char *cookie = NULL;\n    char *dom_xml = NULL;\n    int cookielen = 0, ret;\n    virDomainInfo info;\n    virErrorPtr orig_err = NULL;\n    unsigned int getxml_flags = 0;\n    int cancelled;\n    unsigned long destflags;\n\n    VIR_DOMAIN_DEBUG(domain,\n                     \"dconn=%p, flags=0x%lx, dname=%s, uri=%s, bandwidth=%lu\",\n                     dconn, flags, NULLSTR(dname), NULLSTR(uri), bandwidth);\n\n    /* Prepare the migration.\n     *\n     * The destination host may return a cookie, or leave cookie as\n     * NULL.\n     *\n     * The destination host MUST set uri_out if uri_in is NULL.\n     *\n     * If uri_in is non-NULL, then the destination host may modify\n     * the URI by setting uri_out.  If it does not wish to modify\n     * the URI, it should leave uri_out as NULL.\n     */\n\n    /* In version 2 of the protocol, the prepare step is slightly\n     * different.  We fetch the domain XML of the source domain\n     * and pass it to Prepare2.\n     */\n    if (!domain->conn->driver->domainGetXMLDesc) {\n        virReportUnsupportedError();\n        return NULL;\n    }\n\n    if (VIR_DRV_SUPPORTS_FEATURE(domain->conn->driver, domain->conn,\n                                 VIR_DRV_FEATURE_XML_MIGRATABLE)) {\n        getxml_flags |= VIR_DOMAIN_XML_MIGRATABLE;\n    } else {\n        getxml_flags |= VIR_DOMAIN_XML_SECURE | VIR_DOMAIN_XML_UPDATE_CPU;\n    }\n\n    dom_xml = domain->conn->driver->domainGetXMLDesc(domain, getxml_flags);\n    if (!dom_xml)\n        return NULL;\n\n    ret = virDomainGetInfo(domain, &info);\n    if (ret == 0 && info.state == VIR_DOMAIN_PAUSED)\n        flags |= VIR_MIGRATE_PAUSED;\n\n    destflags = flags & ~(VIR_MIGRATE_ABORT_ON_ERROR |\n                          VIR_MIGRATE_AUTO_CONVERGE);\n\n    VIR_DEBUG(\"Prepare2 %p flags=0x%lx\", dconn, destflags);\n    ret = dconn->driver->domainMigratePrepare2\n        (dconn, &cookie, &cookielen, uri, &uri_out, destflags, dname,\n         bandwidth, dom_xml);\n    VIR_FREE(dom_xml);\n    if (ret == -1)\n        goto done;\n\n    if (uri == NULL && uri_out == NULL) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"domainMigratePrepare2 did not set uri\"));\n        cancelled = 1;\n        /* Make sure Finish doesn't overwrite the error */\n        virErrorPreserveLast(&orig_err);\n        goto finish;\n    }\n    if (uri_out)\n        uri = uri_out; /* Did domainMigratePrepare2 change URI? */\n\n    /* Perform the migration.  The driver isn't supposed to return\n     * until the migration is complete.\n     */\n    VIR_DEBUG(\"Perform %p\", domain->conn);\n    ret = domain->conn->driver->domainMigratePerform\n        (domain, cookie, cookielen, uri, flags, dname, bandwidth);\n\n    /* Perform failed. Make sure Finish doesn't overwrite the error */\n    if (ret < 0)\n        virErrorPreserveLast(&orig_err);\n\n    /* If Perform returns < 0, then we need to cancel the VM\n     * startup on the destination\n     */\n    cancelled = ret < 0 ? 1 : 0;\n\n finish:\n    /* In version 2 of the migration protocol, we pass the\n     * status code from the sender to the destination host,\n     * so it can do any cleanup if the migration failed.\n     */\n    dname = dname ? dname : domain->name;\n    VIR_DEBUG(\"Finish2 %p ret=%d\", dconn, ret);\n    ddomain = dconn->driver->domainMigrateFinish2\n        (dconn, dname, cookie, cookielen, uri, destflags, cancelled);\n    if (cancelled && ddomain)\n        VIR_ERROR(_(\"finish step ignored that migration was cancelled\"));\n\n done:\n    virErrorRestore(&orig_err);\n    VIR_FREE(uri_out);\n    VIR_FREE(cookie);\n    return ddomain;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Using migration protocol 2\""
          ],
          "line": 3627
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DRV_SUPPORTS_FEATURE",
          "args": [
            "dconn->driver",
            "dconn",
            "VIR_DRV_FEATURE_MIGRATION_V2"
          ],
          "line": 3625
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DRV_SUPPORTS_FEATURE",
          "args": [
            "domain->conn->driver",
            "domain->conn",
            "VIR_DRV_FEATURE_MIGRATION_V2"
          ],
          "line": 3623
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainMigrateVersion3",
          "args": [
            "domain",
            "dconn",
            "NULL",
            "flags",
            "dname",
            "uri",
            "bandwidth"
          ],
          "line": 3621
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainMigrateVersion3",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
          "lines": "3260-3271",
          "snippet": "static virDomainPtr\nvirDomainMigrateVersion3(virDomainPtr domain,\n                         virConnectPtr dconn,\n                         const char *xmlin,\n                         unsigned long flags,\n                         const char *dname,\n                         const char *uri,\n                         unsigned long bandwidth)\n{\n    return virDomainMigrateVersion3Full(domain, dconn, xmlin, dname, uri,\n                                        bandwidth, NULL, 0, false, flags);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nstatic virDomainPtr\nvirDomainMigrateVersion3(virDomainPtr domain,\n                         virConnectPtr dconn,\n                         const char *xmlin,\n                         unsigned long flags,\n                         const char *dname,\n                         const char *uri,\n                         unsigned long bandwidth)\n{\n    return virDomainMigrateVersion3Full(domain, dconn, xmlin, dname, uri,\n                                        bandwidth, NULL, 0, false, flags);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Using migration protocol 3\""
          ],
          "line": 3620
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DRV_SUPPORTS_FEATURE",
          "args": [
            "dconn->driver",
            "dconn",
            "VIR_DRV_FEATURE_MIGRATION_V3"
          ],
          "line": 3618
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DRV_SUPPORTS_FEATURE",
          "args": [
            "domain->conn->driver",
            "domain->conn",
            "VIR_DRV_FEATURE_MIGRATION_V3"
          ],
          "line": 3616
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_INVALID",
            "\"%s\"",
            "_(\"cannot perform tunnelled migration without using peer2peer flag\")"
          ],
          "line": 3610
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"cannot perform tunnelled migration without using peer2peer flag\""
          ],
          "line": 3611
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_ARGUMENT_UNSUPPORTED",
            "\"%s\"",
            "_(\"cannot enforce change protection\")"
          ],
          "line": 3604
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DRV_SUPPORTS_FEATURE",
          "args": [
            "domain->conn->driver",
            "domain->conn",
            "VIR_DRV_FEATURE_MIGRATE_CHANGE_PROTECTION"
          ],
          "line": 3602
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 3592
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainLookupByName",
          "args": [
            "dconn",
            "dname ? dname : domain->name"
          ],
          "line": 3589
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainLookupByName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
          "lines": "410-433",
          "snippet": "virDomainPtr\nvirDomainLookupByName(virConnectPtr conn, const char *name)\n{\n    VIR_DEBUG(\"conn=%p, name=%s\", conn, NULLSTR(name));\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, NULL);\n    virCheckNonNullArgGoto(name, error);\n\n    if (conn->driver->domainLookupByName) {\n        virDomainPtr dom;\n        dom = conn->driver->domainLookupByName(conn, name);\n        if (!dom)\n            goto error;\n        return dom;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return NULL;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nvirDomainPtr\nvirDomainLookupByName(virConnectPtr conn, const char *name)\n{\n    VIR_DEBUG(\"conn=%p, name=%s\", conn, NULLSTR(name));\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, NULL);\n    virCheckNonNullArgGoto(name, error);\n\n    if (conn->driver->domainLookupByName) {\n        virDomainPtr dom;\n        dom = conn->driver->domainLookupByName(conn, name);\n        if (!dom)\n            goto error;\n        return dom;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "dstURI"
          ],
          "line": 3587
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "dstURI"
          ],
          "line": 3584
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainMigrateUnmanaged",
          "args": [
            "domain",
            "NULL",
            "flags",
            "dname",
            "uri ? uri : dstURI",
            "NULL",
            "bandwidth"
          ],
          "line": 3582
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainMigrateUnmanaged",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
          "lines": "3459-3496",
          "snippet": "static int\nvirDomainMigrateUnmanaged(virDomainPtr domain,\n                          const char *xmlin,\n                          unsigned int flags,\n                          const char *dname,\n                          const char *dconnuri,\n                          const char *miguri,\n                          unsigned long long bandwidth)\n{\n    int ret = -1;\n    virTypedParameterPtr params = NULL;\n    int nparams = 0;\n    int maxparams = 0;\n\n    if (miguri &&\n        virTypedParamsAddString(&params, &nparams, &maxparams,\n                                VIR_MIGRATE_PARAM_URI, miguri) < 0)\n        goto cleanup;\n    if (dname &&\n        virTypedParamsAddString(&params, &nparams, &maxparams,\n                                VIR_MIGRATE_PARAM_DEST_NAME, dname) < 0)\n        goto cleanup;\n    if (xmlin &&\n        virTypedParamsAddString(&params, &nparams, &maxparams,\n                                VIR_MIGRATE_PARAM_DEST_XML, xmlin) < 0)\n        goto cleanup;\n    if (virTypedParamsAddULLong(&params, &nparams, &maxparams,\n                                VIR_MIGRATE_PARAM_BANDWIDTH, bandwidth) < 0)\n        goto cleanup;\n\n    ret = virDomainMigrateUnmanagedParams(domain, dconnuri, params,\n                                          nparams, flags);\n\n cleanup:\n    virTypedParamsFree(params, nparams);\n\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nstatic int\nvirDomainMigrateUnmanaged(virDomainPtr domain,\n                          const char *xmlin,\n                          unsigned int flags,\n                          const char *dname,\n                          const char *dconnuri,\n                          const char *miguri,\n                          unsigned long long bandwidth)\n{\n    int ret = -1;\n    virTypedParameterPtr params = NULL;\n    int nparams = 0;\n    int maxparams = 0;\n\n    if (miguri &&\n        virTypedParamsAddString(&params, &nparams, &maxparams,\n                                VIR_MIGRATE_PARAM_URI, miguri) < 0)\n        goto cleanup;\n    if (dname &&\n        virTypedParamsAddString(&params, &nparams, &maxparams,\n                                VIR_MIGRATE_PARAM_DEST_NAME, dname) < 0)\n        goto cleanup;\n    if (xmlin &&\n        virTypedParamsAddString(&params, &nparams, &maxparams,\n                                VIR_MIGRATE_PARAM_DEST_XML, xmlin) < 0)\n        goto cleanup;\n    if (virTypedParamsAddULLong(&params, &nparams, &maxparams,\n                                VIR_MIGRATE_PARAM_BANDWIDTH, bandwidth) < 0)\n        goto cleanup;\n\n    ret = virDomainMigrateUnmanagedParams(domain, dconnuri, params,\n                                          nparams, flags);\n\n cleanup:\n    virTypedParamsFree(params, nparams);\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Using peer2peer migration\""
          ],
          "line": 3581
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virConnectGetURI",
          "args": [
            "dconn"
          ],
          "line": 3576
        },
        "resolved": true,
        "details": {
          "function_name": "virConnectGetURI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-host.c",
          "lines": "299-317",
          "snippet": "char *\nvirConnectGetURI(virConnectPtr conn)\n{\n    char *name;\n    VIR_DEBUG(\"conn=%p\", conn);\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, NULL);\n\n    if (!(name = virURIFormat(conn->uri)))\n        goto error;\n\n    return name;\n\n error:\n    virDispatchError(conn);\n    return NULL;\n}",
          "includes": [
            "#include \"virtypedparam.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nchar *\nvirConnectGetURI(virConnectPtr conn)\n{\n    char *name;\n    VIR_DEBUG(\"conn=%p\", conn);\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, NULL);\n\n    if (!(name = virURIFormat(conn->uri)))\n        goto error;\n\n    return name;\n\n error:\n    virDispatchError(conn);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DRV_SUPPORTS_FEATURE",
          "args": [
            "domain->conn->driver",
            "domain->conn",
            "VIR_DRV_FEATURE_MIGRATION_P2P"
          ],
          "line": 3572
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_ARGUMENT_UNSUPPORTED",
            "\"%s\"",
            "_(\"offline migration is not supported by \"\n                             \"the destination host\")"
          ],
          "line": 3564
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DRV_SUPPORTS_FEATURE",
          "args": [
            "dconn->driver",
            "dconn",
            "VIR_DRV_FEATURE_MIGRATION_OFFLINE"
          ],
          "line": 3562
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_ARGUMENT_UNSUPPORTED",
            "\"%s\"",
            "_(\"offline migration is not supported by \"\n                             \"the source host\")"
          ],
          "line": 3557
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DRV_SUPPORTS_FEATURE",
          "args": [
            "domain->conn->driver",
            "domain->conn",
            "VIR_DRV_FEATURE_MIGRATION_OFFLINE"
          ],
          "line": 3555
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_EXCLUSIVE_FLAGS_GOTO",
          "args": [
            "VIR_MIGRATE_TUNNELLED",
            "VIR_MIGRATE_PARALLEL",
            "error"
          ],
          "line": 3550
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_EXCLUSIVE_FLAGS_GOTO",
          "args": [
            "VIR_MIGRATE_NON_SHARED_DISK",
            "VIR_MIGRATE_NON_SHARED_INC",
            "error"
          ],
          "line": 3546
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "dconn->flags",
            "error"
          ],
          "line": 3544
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckConnectGoto",
          "args": [
            "dconn",
            "error"
          ],
          "line": 3543
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "domain->conn->flags",
            "error"
          ],
          "line": 3540
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "domain",
            "NULL"
          ],
          "line": 3539
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 3536
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "domain",
            "\"dconn=%p, flags=0x%lx, dname=%s, uri=%s, bandwidth=%lu\"",
            "dconn",
            "flags",
            "NULLSTR(dname)",
            "NULLSTR(uri)",
            "bandwidth"
          ],
          "line": 3532
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "uri"
          ],
          "line": 3534
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "dname"
          ],
          "line": 3534
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nvirDomainPtr\nvirDomainMigrate(virDomainPtr domain,\n                 virConnectPtr dconn,\n                 unsigned long flags,\n                 const char *dname,\n                 const char *uri,\n                 unsigned long bandwidth)\n{\n    virDomainPtr ddomain = NULL;\n\n    VIR_DOMAIN_DEBUG(domain,\n                     \"dconn=%p, flags=0x%lx, dname=%s, uri=%s, bandwidth=%lu\",\n                     dconn, flags, NULLSTR(dname), NULLSTR(uri), bandwidth);\n\n    virResetLastError();\n\n    /* First checkout the source */\n    virCheckDomainReturn(domain, NULL);\n    virCheckReadOnlyGoto(domain->conn->flags, error);\n\n    /* Now checkout the destination */\n    virCheckConnectGoto(dconn, error);\n    virCheckReadOnlyGoto(dconn->flags, error);\n\n    VIR_EXCLUSIVE_FLAGS_GOTO(VIR_MIGRATE_NON_SHARED_DISK,\n                             VIR_MIGRATE_NON_SHARED_INC,\n                             error);\n\n    VIR_EXCLUSIVE_FLAGS_GOTO(VIR_MIGRATE_TUNNELLED,\n                             VIR_MIGRATE_PARALLEL,\n                             error);\n\n    if (flags & VIR_MIGRATE_OFFLINE) {\n        if (!VIR_DRV_SUPPORTS_FEATURE(domain->conn->driver, domain->conn,\n                                      VIR_DRV_FEATURE_MIGRATION_OFFLINE)) {\n            virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED, \"%s\",\n                           _(\"offline migration is not supported by \"\n                             \"the source host\"));\n            goto error;\n        }\n        if (!VIR_DRV_SUPPORTS_FEATURE(dconn->driver, dconn,\n                                      VIR_DRV_FEATURE_MIGRATION_OFFLINE)) {\n            virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED, \"%s\",\n                           _(\"offline migration is not supported by \"\n                             \"the destination host\"));\n            goto error;\n        }\n    }\n\n    if (flags & VIR_MIGRATE_PEER2PEER) {\n        if (VIR_DRV_SUPPORTS_FEATURE(domain->conn->driver, domain->conn,\n                                     VIR_DRV_FEATURE_MIGRATION_P2P)) {\n            char *dstURI = NULL;\n            if (uri == NULL) {\n                dstURI = virConnectGetURI(dconn);\n                if (!dstURI)\n                    return NULL;\n            }\n\n            VIR_DEBUG(\"Using peer2peer migration\");\n            if (virDomainMigrateUnmanaged(domain, NULL, flags, dname,\n                                          uri ? uri : dstURI, NULL, bandwidth) < 0) {\n                VIR_FREE(dstURI);\n                goto error;\n            }\n            VIR_FREE(dstURI);\n\n            ddomain = virDomainLookupByName(dconn, dname ? dname : domain->name);\n        } else {\n            /* This driver does not support peer to peer migration */\n            virReportUnsupportedError();\n            goto error;\n        }\n    } else {\n        /* Change protection requires support only on source side, and\n         * is only needed in v3 migration, which automatically re-adds\n         * the flag for just the source side.  We mask it out for\n         * non-peer2peer to allow migration from newer source to an\n         * older destination that rejects the flag.  */\n        if (flags & VIR_MIGRATE_CHANGE_PROTECTION &&\n            !VIR_DRV_SUPPORTS_FEATURE(domain->conn->driver, domain->conn,\n                                      VIR_DRV_FEATURE_MIGRATE_CHANGE_PROTECTION)) {\n            virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED, \"%s\",\n                           _(\"cannot enforce change protection\"));\n            goto error;\n        }\n        flags &= ~VIR_MIGRATE_CHANGE_PROTECTION;\n        if (flags & VIR_MIGRATE_TUNNELLED) {\n            virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                           _(\"cannot perform tunnelled migration without using peer2peer flag\"));\n            goto error;\n        }\n\n        /* Check that migration is supported by both drivers. */\n        if (VIR_DRV_SUPPORTS_FEATURE(domain->conn->driver, domain->conn,\n                                     VIR_DRV_FEATURE_MIGRATION_V3) &&\n            VIR_DRV_SUPPORTS_FEATURE(dconn->driver, dconn,\n                                     VIR_DRV_FEATURE_MIGRATION_V3)) {\n            VIR_DEBUG(\"Using migration protocol 3\");\n            ddomain = virDomainMigrateVersion3(domain, dconn, NULL,\n                                               flags, dname, uri, bandwidth);\n        } else if (VIR_DRV_SUPPORTS_FEATURE(domain->conn->driver, domain->conn,\n                                            VIR_DRV_FEATURE_MIGRATION_V2) &&\n                   VIR_DRV_SUPPORTS_FEATURE(dconn->driver, dconn,\n                                          VIR_DRV_FEATURE_MIGRATION_V2)) {\n            VIR_DEBUG(\"Using migration protocol 2\");\n            ddomain = virDomainMigrateVersion2(domain, dconn, flags,\n                                               dname, uri, bandwidth);\n        } else if (VIR_DRV_SUPPORTS_FEATURE(domain->conn->driver, domain->conn,\n                                            VIR_DRV_FEATURE_MIGRATION_V1) &&\n                   VIR_DRV_SUPPORTS_FEATURE(dconn->driver, dconn,\n                                            VIR_DRV_FEATURE_MIGRATION_V1)) {\n            VIR_DEBUG(\"Using migration protocol 1\");\n            ddomain = virDomainMigrateVersion1(domain, dconn, flags,\n                                               dname, uri, bandwidth);\n        } else {\n            /* This driver does not support any migration method */\n            virReportUnsupportedError();\n            goto error;\n        }\n    }\n\n    if (ddomain == NULL)\n        goto error;\n\n    return ddomain;\n\n error:\n    virDispatchError(domain->conn);\n    return NULL;\n}"
  },
  {
    "function_name": "virDomainMigrateUnmanaged",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "3459-3496",
    "snippet": "static int\nvirDomainMigrateUnmanaged(virDomainPtr domain,\n                          const char *xmlin,\n                          unsigned int flags,\n                          const char *dname,\n                          const char *dconnuri,\n                          const char *miguri,\n                          unsigned long long bandwidth)\n{\n    int ret = -1;\n    virTypedParameterPtr params = NULL;\n    int nparams = 0;\n    int maxparams = 0;\n\n    if (miguri &&\n        virTypedParamsAddString(&params, &nparams, &maxparams,\n                                VIR_MIGRATE_PARAM_URI, miguri) < 0)\n        goto cleanup;\n    if (dname &&\n        virTypedParamsAddString(&params, &nparams, &maxparams,\n                                VIR_MIGRATE_PARAM_DEST_NAME, dname) < 0)\n        goto cleanup;\n    if (xmlin &&\n        virTypedParamsAddString(&params, &nparams, &maxparams,\n                                VIR_MIGRATE_PARAM_DEST_XML, xmlin) < 0)\n        goto cleanup;\n    if (virTypedParamsAddULLong(&params, &nparams, &maxparams,\n                                VIR_MIGRATE_PARAM_BANDWIDTH, bandwidth) < 0)\n        goto cleanup;\n\n    ret = virDomainMigrateUnmanagedParams(domain, dconnuri, params,\n                                          nparams, flags);\n\n cleanup:\n    virTypedParamsFree(params, nparams);\n\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virTypedParamsFree",
          "args": [
            "params",
            "nparams"
          ],
          "line": 3493
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParamsFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam-public.c",
          "lines": "878-884",
          "snippet": "void\nvirTypedParamsFree(virTypedParameterPtr params,\n                   int nparams)\n{\n    virTypedParamsClear(params, nparams);\n    VIR_FREE(params);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtypedparam.h\"\n#include <config.h>\n\nvoid\nvirTypedParamsFree(virTypedParameterPtr params,\n                   int nparams)\n{\n    virTypedParamsClear(params, nparams);\n    VIR_FREE(params);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainMigrateUnmanagedParams",
          "args": [
            "domain",
            "dconnuri",
            "params",
            "nparams",
            "flags"
          ],
          "line": 3489
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainMigrateUnmanagedParams",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
          "lines": "3412-3456",
          "snippet": "static int\nvirDomainMigrateUnmanagedParams(virDomainPtr domain,\n                                const char *dconnuri,\n                                virTypedParameterPtr params,\n                                int nparams,\n                                unsigned int flags)\n{\n    VIR_DOMAIN_DEBUG(domain, \"dconnuri=%s, params=%p, nparams=%d, flags=0x%x\",\n                     NULLSTR(dconnuri), params, nparams, flags);\n    VIR_TYPED_PARAMS_DEBUG(params, nparams);\n\n    if ((flags & VIR_MIGRATE_PEER2PEER) &&\n        virDomainMigrateCheckNotLocal(dconnuri) < 0)\n        return -1;\n\n    if ((flags & VIR_MIGRATE_PEER2PEER) &&\n        VIR_DRV_SUPPORTS_FEATURE(domain->conn->driver, domain->conn,\n                                 VIR_DRV_FEATURE_MIGRATION_PARAMS)) {\n        VIR_DEBUG(\"Using migration protocol 3 with extensible parameters\");\n        if (!domain->conn->driver->domainMigratePerform3Params) {\n            virReportUnsupportedError();\n            return -1;\n        }\n        return domain->conn->driver->domainMigratePerform3Params\n                (domain, dconnuri, params, nparams,\n                 NULL, 0, NULL, NULL, flags);\n    } else if (VIR_DRV_SUPPORTS_FEATURE(domain->conn->driver, domain->conn,\n                                        VIR_DRV_FEATURE_MIGRATION_V3)) {\n        VIR_DEBUG(\"Using migration protocol 3\");\n        if (!domain->conn->driver->domainMigratePerform3) {\n            virReportUnsupportedError();\n            return -1;\n        }\n        return virDomainMigrateUnmanagedProto3(domain, dconnuri,\n                                               params, nparams, flags);\n    } else {\n        VIR_DEBUG(\"Using migration protocol 2\");\n        if (!domain->conn->driver->domainMigratePerform) {\n            virReportUnsupportedError();\n            return -1;\n        }\n        return virDomainMigrateUnmanagedProto2(domain, dconnuri,\n                                               params, nparams, flags);\n    }\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nstatic int\nvirDomainMigrateUnmanagedParams(virDomainPtr domain,\n                                const char *dconnuri,\n                                virTypedParameterPtr params,\n                                int nparams,\n                                unsigned int flags)\n{\n    VIR_DOMAIN_DEBUG(domain, \"dconnuri=%s, params=%p, nparams=%d, flags=0x%x\",\n                     NULLSTR(dconnuri), params, nparams, flags);\n    VIR_TYPED_PARAMS_DEBUG(params, nparams);\n\n    if ((flags & VIR_MIGRATE_PEER2PEER) &&\n        virDomainMigrateCheckNotLocal(dconnuri) < 0)\n        return -1;\n\n    if ((flags & VIR_MIGRATE_PEER2PEER) &&\n        VIR_DRV_SUPPORTS_FEATURE(domain->conn->driver, domain->conn,\n                                 VIR_DRV_FEATURE_MIGRATION_PARAMS)) {\n        VIR_DEBUG(\"Using migration protocol 3 with extensible parameters\");\n        if (!domain->conn->driver->domainMigratePerform3Params) {\n            virReportUnsupportedError();\n            return -1;\n        }\n        return domain->conn->driver->domainMigratePerform3Params\n                (domain, dconnuri, params, nparams,\n                 NULL, 0, NULL, NULL, flags);\n    } else if (VIR_DRV_SUPPORTS_FEATURE(domain->conn->driver, domain->conn,\n                                        VIR_DRV_FEATURE_MIGRATION_V3)) {\n        VIR_DEBUG(\"Using migration protocol 3\");\n        if (!domain->conn->driver->domainMigratePerform3) {\n            virReportUnsupportedError();\n            return -1;\n        }\n        return virDomainMigrateUnmanagedProto3(domain, dconnuri,\n                                               params, nparams, flags);\n    } else {\n        VIR_DEBUG(\"Using migration protocol 2\");\n        if (!domain->conn->driver->domainMigratePerform) {\n            virReportUnsupportedError();\n            return -1;\n        }\n        return virDomainMigrateUnmanagedProto2(domain, dconnuri,\n                                               params, nparams, flags);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virTypedParamsAddULLong",
          "args": [
            "&params",
            "&nparams",
            "&maxparams",
            "VIR_MIGRATE_PARAM_BANDWIDTH",
            "bandwidth"
          ],
          "line": 3485
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParamsAddULLong",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam-public.c",
          "lines": "578-604",
          "snippet": "int\nvirTypedParamsAddULLong(virTypedParameterPtr *params,\n                        int *nparams,\n                        int *maxparams,\n                        const char *name,\n                        unsigned long long value)\n{\n    size_t max = *maxparams;\n    size_t n = *nparams;\n\n    virResetLastError();\n\n    if (VIR_RESIZE_N(*params, max, n, 1) < 0)\n        goto error;\n    *maxparams = max;\n\n    if (virTypedParameterAssign(*params + n, name,\n                                VIR_TYPED_PARAM_ULLONG, value) < 0)\n        goto error;\n\n    *nparams += 1;\n    return 0;\n\n error:\n    virDispatchError(NULL);\n    return -1;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtypedparam.h\"\n#include <config.h>\n\nint\nvirTypedParamsAddULLong(virTypedParameterPtr *params,\n                        int *nparams,\n                        int *maxparams,\n                        const char *name,\n                        unsigned long long value)\n{\n    size_t max = *maxparams;\n    size_t n = *nparams;\n\n    virResetLastError();\n\n    if (VIR_RESIZE_N(*params, max, n, 1) < 0)\n        goto error;\n    *maxparams = max;\n\n    if (virTypedParameterAssign(*params + n, name,\n                                VIR_TYPED_PARAM_ULLONG, value) < 0)\n        goto error;\n\n    *nparams += 1;\n    return 0;\n\n error:\n    virDispatchError(NULL);\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virTypedParamsAddString",
          "args": [
            "&params",
            "&nparams",
            "&maxparams",
            "VIR_MIGRATE_PARAM_DEST_XML",
            "xmlin"
          ],
          "line": 3482
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParamsAddStringList",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam-public.c",
          "lines": "768-788",
          "snippet": "int\nvirTypedParamsAddStringList(virTypedParameterPtr *params,\n                            int *nparams,\n                            int *maxparams,\n                            const char *name,\n                            const char **values)\n{\n    size_t i;\n    int rv = -1;\n\n    if (!values)\n        return 0;\n\n    for (i = 0; values[i]; i++) {\n        if ((rv = virTypedParamsAddString(params, nparams, maxparams,\n                                          name, values[i])) < 0)\n            break;\n    }\n\n    return rv;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtypedparam.h\"\n#include <config.h>\n\nint\nvirTypedParamsAddStringList(virTypedParameterPtr *params,\n                            int *nparams,\n                            int *maxparams,\n                            const char *name,\n                            const char **values)\n{\n    size_t i;\n    int rv = -1;\n\n    if (!values)\n        return 0;\n\n    for (i = 0; values[i]; i++) {\n        if ((rv = virTypedParamsAddString(params, nparams, maxparams,\n                                          name, values[i])) < 0)\n            break;\n    }\n\n    return rv;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nstatic int\nvirDomainMigrateUnmanaged(virDomainPtr domain,\n                          const char *xmlin,\n                          unsigned int flags,\n                          const char *dname,\n                          const char *dconnuri,\n                          const char *miguri,\n                          unsigned long long bandwidth)\n{\n    int ret = -1;\n    virTypedParameterPtr params = NULL;\n    int nparams = 0;\n    int maxparams = 0;\n\n    if (miguri &&\n        virTypedParamsAddString(&params, &nparams, &maxparams,\n                                VIR_MIGRATE_PARAM_URI, miguri) < 0)\n        goto cleanup;\n    if (dname &&\n        virTypedParamsAddString(&params, &nparams, &maxparams,\n                                VIR_MIGRATE_PARAM_DEST_NAME, dname) < 0)\n        goto cleanup;\n    if (xmlin &&\n        virTypedParamsAddString(&params, &nparams, &maxparams,\n                                VIR_MIGRATE_PARAM_DEST_XML, xmlin) < 0)\n        goto cleanup;\n    if (virTypedParamsAddULLong(&params, &nparams, &maxparams,\n                                VIR_MIGRATE_PARAM_BANDWIDTH, bandwidth) < 0)\n        goto cleanup;\n\n    ret = virDomainMigrateUnmanagedParams(domain, dconnuri, params,\n                                          nparams, flags);\n\n cleanup:\n    virTypedParamsFree(params, nparams);\n\n    return ret;\n}"
  },
  {
    "function_name": "virDomainMigrateUnmanagedParams",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "3412-3456",
    "snippet": "static int\nvirDomainMigrateUnmanagedParams(virDomainPtr domain,\n                                const char *dconnuri,\n                                virTypedParameterPtr params,\n                                int nparams,\n                                unsigned int flags)\n{\n    VIR_DOMAIN_DEBUG(domain, \"dconnuri=%s, params=%p, nparams=%d, flags=0x%x\",\n                     NULLSTR(dconnuri), params, nparams, flags);\n    VIR_TYPED_PARAMS_DEBUG(params, nparams);\n\n    if ((flags & VIR_MIGRATE_PEER2PEER) &&\n        virDomainMigrateCheckNotLocal(dconnuri) < 0)\n        return -1;\n\n    if ((flags & VIR_MIGRATE_PEER2PEER) &&\n        VIR_DRV_SUPPORTS_FEATURE(domain->conn->driver, domain->conn,\n                                 VIR_DRV_FEATURE_MIGRATION_PARAMS)) {\n        VIR_DEBUG(\"Using migration protocol 3 with extensible parameters\");\n        if (!domain->conn->driver->domainMigratePerform3Params) {\n            virReportUnsupportedError();\n            return -1;\n        }\n        return domain->conn->driver->domainMigratePerform3Params\n                (domain, dconnuri, params, nparams,\n                 NULL, 0, NULL, NULL, flags);\n    } else if (VIR_DRV_SUPPORTS_FEATURE(domain->conn->driver, domain->conn,\n                                        VIR_DRV_FEATURE_MIGRATION_V3)) {\n        VIR_DEBUG(\"Using migration protocol 3\");\n        if (!domain->conn->driver->domainMigratePerform3) {\n            virReportUnsupportedError();\n            return -1;\n        }\n        return virDomainMigrateUnmanagedProto3(domain, dconnuri,\n                                               params, nparams, flags);\n    } else {\n        VIR_DEBUG(\"Using migration protocol 2\");\n        if (!domain->conn->driver->domainMigratePerform) {\n            virReportUnsupportedError();\n            return -1;\n        }\n        return virDomainMigrateUnmanagedProto2(domain, dconnuri,\n                                               params, nparams, flags);\n    }\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainMigrateUnmanagedProto2",
          "args": [
            "domain",
            "dconnuri",
            "params",
            "nparams",
            "flags"
          ],
          "line": 3453
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainMigrateUnmanagedProto2",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
          "lines": "3308-3354",
          "snippet": "static int\nvirDomainMigrateUnmanagedProto2(virDomainPtr domain,\n                                const char *dconnuri,\n                                virTypedParameterPtr params,\n                                int nparams,\n                                unsigned int flags)\n{\n    /* uri parameter is added for direct case */\n    const char *compatParams[] = { VIR_MIGRATE_PARAM_DEST_NAME,\n                                   VIR_MIGRATE_PARAM_BANDWIDTH,\n                                   VIR_MIGRATE_PARAM_URI };\n    const char *uri = NULL;\n    const char *miguri = NULL;\n    const char *dname = NULL;\n    unsigned long long bandwidth = 0;\n\n    if (!virTypedParamsCheck(params, nparams, compatParams,\n                             G_N_ELEMENTS(compatParams))) {\n        virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED, \"%s\",\n                       _(\"Some parameters are not supported by migration \"\n                         \"protocol 2\"));\n        return -1;\n    }\n\n    if (virTypedParamsGetString(params, nparams,\n                                VIR_MIGRATE_PARAM_URI, &miguri) < 0 ||\n        virTypedParamsGetString(params, nparams,\n                                VIR_MIGRATE_PARAM_DEST_NAME, &dname) < 0 ||\n        virTypedParamsGetULLong(params, nparams,\n                                VIR_MIGRATE_PARAM_BANDWIDTH, &bandwidth) < 0) {\n        return -1;\n    }\n\n    if (flags & VIR_MIGRATE_PEER2PEER) {\n        if (miguri) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"Unable to override peer2peer migration URI\"));\n            return -1;\n        }\n        uri = dconnuri;\n    } else {\n        uri = miguri;\n    }\n\n    return domain->conn->driver->domainMigratePerform\n            (domain, NULL, 0, uri, flags, dname, bandwidth);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nstatic int\nvirDomainMigrateUnmanagedProto2(virDomainPtr domain,\n                                const char *dconnuri,\n                                virTypedParameterPtr params,\n                                int nparams,\n                                unsigned int flags)\n{\n    /* uri parameter is added for direct case */\n    const char *compatParams[] = { VIR_MIGRATE_PARAM_DEST_NAME,\n                                   VIR_MIGRATE_PARAM_BANDWIDTH,\n                                   VIR_MIGRATE_PARAM_URI };\n    const char *uri = NULL;\n    const char *miguri = NULL;\n    const char *dname = NULL;\n    unsigned long long bandwidth = 0;\n\n    if (!virTypedParamsCheck(params, nparams, compatParams,\n                             G_N_ELEMENTS(compatParams))) {\n        virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED, \"%s\",\n                       _(\"Some parameters are not supported by migration \"\n                         \"protocol 2\"));\n        return -1;\n    }\n\n    if (virTypedParamsGetString(params, nparams,\n                                VIR_MIGRATE_PARAM_URI, &miguri) < 0 ||\n        virTypedParamsGetString(params, nparams,\n                                VIR_MIGRATE_PARAM_DEST_NAME, &dname) < 0 ||\n        virTypedParamsGetULLong(params, nparams,\n                                VIR_MIGRATE_PARAM_BANDWIDTH, &bandwidth) < 0) {\n        return -1;\n    }\n\n    if (flags & VIR_MIGRATE_PEER2PEER) {\n        if (miguri) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"Unable to override peer2peer migration URI\"));\n            return -1;\n        }\n        uri = dconnuri;\n    } else {\n        uri = miguri;\n    }\n\n    return domain->conn->driver->domainMigratePerform\n            (domain, NULL, 0, uri, flags, dname, bandwidth);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 3450
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Using migration protocol 2\""
          ],
          "line": 3448
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainMigrateUnmanagedProto3",
          "args": [
            "domain",
            "dconnuri",
            "params",
            "nparams",
            "flags"
          ],
          "line": 3445
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainMigrateUnmanagedProto3",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
          "lines": "3357-3395",
          "snippet": "static int\nvirDomainMigrateUnmanagedProto3(virDomainPtr domain,\n                                const char *dconnuri,\n                                virTypedParameterPtr params,\n                                int nparams,\n                                unsigned int flags)\n{\n    const char *compatParams[] = { VIR_MIGRATE_PARAM_URI,\n                                   VIR_MIGRATE_PARAM_DEST_NAME,\n                                   VIR_MIGRATE_PARAM_DEST_XML,\n                                   VIR_MIGRATE_PARAM_BANDWIDTH };\n    const char *miguri = NULL;\n    const char *dname = NULL;\n    const char *xmlin = NULL;\n    unsigned long long bandwidth = 0;\n\n    if (!virTypedParamsCheck(params, nparams, compatParams,\n                             G_N_ELEMENTS(compatParams))) {\n        virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED, \"%s\",\n                       _(\"Some parameters are not supported by migration \"\n                         \"protocol 3\"));\n        return -1;\n    }\n\n    if (virTypedParamsGetString(params, nparams,\n                                VIR_MIGRATE_PARAM_URI, &miguri) < 0 ||\n        virTypedParamsGetString(params, nparams,\n                                VIR_MIGRATE_PARAM_DEST_NAME, &dname) < 0 ||\n        virTypedParamsGetString(params, nparams,\n                                VIR_MIGRATE_PARAM_DEST_XML, &xmlin) < 0 ||\n        virTypedParamsGetULLong(params, nparams,\n                                VIR_MIGRATE_PARAM_BANDWIDTH, &bandwidth) < 0) {\n        return -1;\n    }\n\n    return domain->conn->driver->domainMigratePerform3\n            (domain, xmlin, NULL, 0, NULL, NULL, dconnuri,\n             miguri, flags, dname, bandwidth);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nstatic int\nvirDomainMigrateUnmanagedProto3(virDomainPtr domain,\n                                const char *dconnuri,\n                                virTypedParameterPtr params,\n                                int nparams,\n                                unsigned int flags)\n{\n    const char *compatParams[] = { VIR_MIGRATE_PARAM_URI,\n                                   VIR_MIGRATE_PARAM_DEST_NAME,\n                                   VIR_MIGRATE_PARAM_DEST_XML,\n                                   VIR_MIGRATE_PARAM_BANDWIDTH };\n    const char *miguri = NULL;\n    const char *dname = NULL;\n    const char *xmlin = NULL;\n    unsigned long long bandwidth = 0;\n\n    if (!virTypedParamsCheck(params, nparams, compatParams,\n                             G_N_ELEMENTS(compatParams))) {\n        virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED, \"%s\",\n                       _(\"Some parameters are not supported by migration \"\n                         \"protocol 3\"));\n        return -1;\n    }\n\n    if (virTypedParamsGetString(params, nparams,\n                                VIR_MIGRATE_PARAM_URI, &miguri) < 0 ||\n        virTypedParamsGetString(params, nparams,\n                                VIR_MIGRATE_PARAM_DEST_NAME, &dname) < 0 ||\n        virTypedParamsGetString(params, nparams,\n                                VIR_MIGRATE_PARAM_DEST_XML, &xmlin) < 0 ||\n        virTypedParamsGetULLong(params, nparams,\n                                VIR_MIGRATE_PARAM_BANDWIDTH, &bandwidth) < 0) {\n        return -1;\n    }\n\n    return domain->conn->driver->domainMigratePerform3\n            (domain, xmlin, NULL, 0, NULL, NULL, dconnuri,\n             miguri, flags, dname, bandwidth);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 3442
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Using migration protocol 3\""
          ],
          "line": 3440
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DRV_SUPPORTS_FEATURE",
          "args": [
            "domain->conn->driver",
            "domain->conn",
            "VIR_DRV_FEATURE_MIGRATION_V3"
          ],
          "line": 3438
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "domain->conn->driver->domainMigratePerform3Params",
          "args": [
            "domain",
            "dconnuri",
            "params",
            "nparams",
            "NULL",
            "0",
            "NULL",
            "NULL",
            "flags"
          ],
          "line": 3435
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 3432
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Using migration protocol 3 with extensible parameters\""
          ],
          "line": 3430
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DRV_SUPPORTS_FEATURE",
          "args": [
            "domain->conn->driver",
            "domain->conn",
            "VIR_DRV_FEATURE_MIGRATION_PARAMS"
          ],
          "line": 3428
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainMigrateCheckNotLocal",
          "args": [
            "dconnuri"
          ],
          "line": 3424
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainMigrateCheckNotLocal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
          "lines": "3286-3305",
          "snippet": "static int\nvirDomainMigrateCheckNotLocal(const char *dconnuri)\n{\n    virURIPtr tempuri = NULL;\n    int ret = -1;\n\n    if (!(tempuri = virURIParse(dconnuri)))\n        goto cleanup;\n    if (!tempuri->server || STRPREFIX(tempuri->server, \"localhost\")) {\n        virReportInvalidArg(dconnuri, \"%s\",\n                            _(\"Attempt to migrate guest to the same host\"));\n        goto cleanup;\n    }\n\n    ret = 0;\n\n cleanup:\n    virURIFree(tempuri);\n    return ret;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nstatic int\nvirDomainMigrateCheckNotLocal(const char *dconnuri)\n{\n    virURIPtr tempuri = NULL;\n    int ret = -1;\n\n    if (!(tempuri = virURIParse(dconnuri)))\n        goto cleanup;\n    if (!tempuri->server || STRPREFIX(tempuri->server, \"localhost\")) {\n        virReportInvalidArg(dconnuri, \"%s\",\n                            _(\"Attempt to migrate guest to the same host\"));\n        goto cleanup;\n    }\n\n    ret = 0;\n\n cleanup:\n    virURIFree(tempuri);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_TYPED_PARAMS_DEBUG",
          "args": [
            "params",
            "nparams"
          ],
          "line": 3421
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "domain",
            "\"dconnuri=%s, params=%p, nparams=%d, flags=0x%x\"",
            "NULLSTR(dconnuri)",
            "params",
            "nparams",
            "flags"
          ],
          "line": 3419
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "dconnuri"
          ],
          "line": 3420
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nstatic int\nvirDomainMigrateUnmanagedParams(virDomainPtr domain,\n                                const char *dconnuri,\n                                virTypedParameterPtr params,\n                                int nparams,\n                                unsigned int flags)\n{\n    VIR_DOMAIN_DEBUG(domain, \"dconnuri=%s, params=%p, nparams=%d, flags=0x%x\",\n                     NULLSTR(dconnuri), params, nparams, flags);\n    VIR_TYPED_PARAMS_DEBUG(params, nparams);\n\n    if ((flags & VIR_MIGRATE_PEER2PEER) &&\n        virDomainMigrateCheckNotLocal(dconnuri) < 0)\n        return -1;\n\n    if ((flags & VIR_MIGRATE_PEER2PEER) &&\n        VIR_DRV_SUPPORTS_FEATURE(domain->conn->driver, domain->conn,\n                                 VIR_DRV_FEATURE_MIGRATION_PARAMS)) {\n        VIR_DEBUG(\"Using migration protocol 3 with extensible parameters\");\n        if (!domain->conn->driver->domainMigratePerform3Params) {\n            virReportUnsupportedError();\n            return -1;\n        }\n        return domain->conn->driver->domainMigratePerform3Params\n                (domain, dconnuri, params, nparams,\n                 NULL, 0, NULL, NULL, flags);\n    } else if (VIR_DRV_SUPPORTS_FEATURE(domain->conn->driver, domain->conn,\n                                        VIR_DRV_FEATURE_MIGRATION_V3)) {\n        VIR_DEBUG(\"Using migration protocol 3\");\n        if (!domain->conn->driver->domainMigratePerform3) {\n            virReportUnsupportedError();\n            return -1;\n        }\n        return virDomainMigrateUnmanagedProto3(domain, dconnuri,\n                                               params, nparams, flags);\n    } else {\n        VIR_DEBUG(\"Using migration protocol 2\");\n        if (!domain->conn->driver->domainMigratePerform) {\n            virReportUnsupportedError();\n            return -1;\n        }\n        return virDomainMigrateUnmanagedProto2(domain, dconnuri,\n                                               params, nparams, flags);\n    }\n}"
  },
  {
    "function_name": "virDomainMigrateUnmanagedProto3",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "3357-3395",
    "snippet": "static int\nvirDomainMigrateUnmanagedProto3(virDomainPtr domain,\n                                const char *dconnuri,\n                                virTypedParameterPtr params,\n                                int nparams,\n                                unsigned int flags)\n{\n    const char *compatParams[] = { VIR_MIGRATE_PARAM_URI,\n                                   VIR_MIGRATE_PARAM_DEST_NAME,\n                                   VIR_MIGRATE_PARAM_DEST_XML,\n                                   VIR_MIGRATE_PARAM_BANDWIDTH };\n    const char *miguri = NULL;\n    const char *dname = NULL;\n    const char *xmlin = NULL;\n    unsigned long long bandwidth = 0;\n\n    if (!virTypedParamsCheck(params, nparams, compatParams,\n                             G_N_ELEMENTS(compatParams))) {\n        virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED, \"%s\",\n                       _(\"Some parameters are not supported by migration \"\n                         \"protocol 3\"));\n        return -1;\n    }\n\n    if (virTypedParamsGetString(params, nparams,\n                                VIR_MIGRATE_PARAM_URI, &miguri) < 0 ||\n        virTypedParamsGetString(params, nparams,\n                                VIR_MIGRATE_PARAM_DEST_NAME, &dname) < 0 ||\n        virTypedParamsGetString(params, nparams,\n                                VIR_MIGRATE_PARAM_DEST_XML, &xmlin) < 0 ||\n        virTypedParamsGetULLong(params, nparams,\n                                VIR_MIGRATE_PARAM_BANDWIDTH, &bandwidth) < 0) {\n        return -1;\n    }\n\n    return domain->conn->driver->domainMigratePerform3\n            (domain, xmlin, NULL, 0, NULL, NULL, dconnuri,\n             miguri, flags, dname, bandwidth);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "domain->conn->driver->domainMigratePerform3",
          "args": [
            "domain",
            "xmlin",
            "NULL",
            "0",
            "NULL",
            "NULL",
            "dconnuri",
            "miguri",
            "flags",
            "dname",
            "bandwidth"
          ],
          "line": 3392
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virTypedParamsGetULLong",
          "args": [
            "params",
            "nparams",
            "VIR_MIGRATE_PARAM_BANDWIDTH",
            "&bandwidth"
          ],
          "line": 3387
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParamsGetULLong",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam-public.c",
          "lines": "288-306",
          "snippet": "int\nvirTypedParamsGetULLong(virTypedParameterPtr params,\n                        int nparams,\n                        const char *name,\n                        unsigned long long *value)\n{\n    virTypedParameterPtr param;\n\n    virResetLastError();\n\n    if (!(param = virTypedParamsGet(params, nparams, name)))\n        return 0;\n\n    VIR_TYPED_PARAM_CHECK_TYPE(VIR_TYPED_PARAM_ULLONG);\n    if (value)\n        *value = param->value.ul;\n\n    return 1;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtypedparam.h\"\n#include <config.h>\n\nint\nvirTypedParamsGetULLong(virTypedParameterPtr params,\n                        int nparams,\n                        const char *name,\n                        unsigned long long *value)\n{\n    virTypedParameterPtr param;\n\n    virResetLastError();\n\n    if (!(param = virTypedParamsGet(params, nparams, name)))\n        return 0;\n\n    VIR_TYPED_PARAM_CHECK_TYPE(VIR_TYPED_PARAM_ULLONG);\n    if (value)\n        *value = param->value.ul;\n\n    return 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virTypedParamsGetString",
          "args": [
            "params",
            "nparams",
            "VIR_MIGRATE_PARAM_DEST_XML",
            "&xmlin"
          ],
          "line": 3385
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParamsGetStringList",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam.c",
          "lines": "432-467",
          "snippet": "int\nvirTypedParamsGetStringList(virTypedParameterPtr params,\n                            int nparams,\n                            const char *name,\n                            const char ***values)\n{\n    size_t i, n;\n    int nfiltered;\n    virTypedParameterPtr *filtered = NULL;\n\n    virCheckNonNullArgGoto(values, error);\n    *values = NULL;\n\n    nfiltered = virTypedParamsFilter(params, nparams, name, &filtered);\n\n    if (nfiltered < 0)\n        goto error;\n\n    if (nfiltered &&\n        VIR_ALLOC_N(*values, nfiltered) < 0)\n        goto error;\n\n    for (n = 0, i = 0; i < nfiltered; i++) {\n        if (filtered[i]->type == VIR_TYPED_PARAM_STRING)\n            (*values)[n++] = filtered[i]->value.s;\n    }\n\n    VIR_FREE(filtered);\n    return n;\n\n error:\n    if (values)\n        VIR_FREE(*values);\n    VIR_FREE(filtered);\n    return -1;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <stdarg.h>",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <stdarg.h>\n#include \"virtypedparam.h\"\n#include <config.h>\n\nint\nvirTypedParamsGetStringList(virTypedParameterPtr params,\n                            int nparams,\n                            const char *name,\n                            const char ***values)\n{\n    size_t i, n;\n    int nfiltered;\n    virTypedParameterPtr *filtered = NULL;\n\n    virCheckNonNullArgGoto(values, error);\n    *values = NULL;\n\n    nfiltered = virTypedParamsFilter(params, nparams, name, &filtered);\n\n    if (nfiltered < 0)\n        goto error;\n\n    if (nfiltered &&\n        VIR_ALLOC_N(*values, nfiltered) < 0)\n        goto error;\n\n    for (n = 0, i = 0; i < nfiltered; i++) {\n        if (filtered[i]->type == VIR_TYPED_PARAM_STRING)\n            (*values)[n++] = filtered[i]->value.s;\n    }\n\n    VIR_FREE(filtered);\n    return n;\n\n error:\n    if (values)\n        VIR_FREE(*values);\n    VIR_FREE(filtered);\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_ARGUMENT_UNSUPPORTED",
            "\"%s\"",
            "_(\"Some parameters are not supported by migration \"\n                         \"protocol 3\")"
          ],
          "line": 3375
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Some parameters are not supported by migration \"\n                         \"protocol 3\""
          ],
          "line": 3376
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virTypedParamsCheck",
          "args": [
            "params",
            "nparams",
            "compatParams",
            "G_N_ELEMENTS(compatParams)"
          ],
          "line": 3373
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParamsCheck",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam.c",
          "lines": "148-169",
          "snippet": "bool\nvirTypedParamsCheck(virTypedParameterPtr params,\n                    int nparams,\n                    const char **names,\n                    int nnames)\n{\n    size_t i, j;\n\n    for (i = 0; i < nparams; i++) {\n        bool found = false;\n        for (j = 0; j < nnames; j++) {\n            if (STREQ(params[i].field, names[j])) {\n                found = true;\n                break;\n            }\n        }\n        if (!found)\n            return false;\n    }\n\n    return true;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <stdarg.h>",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <stdarg.h>\n#include \"virtypedparam.h\"\n#include <config.h>\n\nbool\nvirTypedParamsCheck(virTypedParameterPtr params,\n                    int nparams,\n                    const char **names,\n                    int nnames)\n{\n    size_t i, j;\n\n    for (i = 0; i < nparams; i++) {\n        bool found = false;\n        for (j = 0; j < nnames; j++) {\n            if (STREQ(params[i].field, names[j])) {\n                found = true;\n                break;\n            }\n        }\n        if (!found)\n            return false;\n    }\n\n    return true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "G_N_ELEMENTS",
          "args": [
            "compatParams"
          ],
          "line": 3374
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nstatic int\nvirDomainMigrateUnmanagedProto3(virDomainPtr domain,\n                                const char *dconnuri,\n                                virTypedParameterPtr params,\n                                int nparams,\n                                unsigned int flags)\n{\n    const char *compatParams[] = { VIR_MIGRATE_PARAM_URI,\n                                   VIR_MIGRATE_PARAM_DEST_NAME,\n                                   VIR_MIGRATE_PARAM_DEST_XML,\n                                   VIR_MIGRATE_PARAM_BANDWIDTH };\n    const char *miguri = NULL;\n    const char *dname = NULL;\n    const char *xmlin = NULL;\n    unsigned long long bandwidth = 0;\n\n    if (!virTypedParamsCheck(params, nparams, compatParams,\n                             G_N_ELEMENTS(compatParams))) {\n        virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED, \"%s\",\n                       _(\"Some parameters are not supported by migration \"\n                         \"protocol 3\"));\n        return -1;\n    }\n\n    if (virTypedParamsGetString(params, nparams,\n                                VIR_MIGRATE_PARAM_URI, &miguri) < 0 ||\n        virTypedParamsGetString(params, nparams,\n                                VIR_MIGRATE_PARAM_DEST_NAME, &dname) < 0 ||\n        virTypedParamsGetString(params, nparams,\n                                VIR_MIGRATE_PARAM_DEST_XML, &xmlin) < 0 ||\n        virTypedParamsGetULLong(params, nparams,\n                                VIR_MIGRATE_PARAM_BANDWIDTH, &bandwidth) < 0) {\n        return -1;\n    }\n\n    return domain->conn->driver->domainMigratePerform3\n            (domain, xmlin, NULL, 0, NULL, NULL, dconnuri,\n             miguri, flags, dname, bandwidth);\n}"
  },
  {
    "function_name": "virDomainMigrateUnmanagedProto2",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "3308-3354",
    "snippet": "static int\nvirDomainMigrateUnmanagedProto2(virDomainPtr domain,\n                                const char *dconnuri,\n                                virTypedParameterPtr params,\n                                int nparams,\n                                unsigned int flags)\n{\n    /* uri parameter is added for direct case */\n    const char *compatParams[] = { VIR_MIGRATE_PARAM_DEST_NAME,\n                                   VIR_MIGRATE_PARAM_BANDWIDTH,\n                                   VIR_MIGRATE_PARAM_URI };\n    const char *uri = NULL;\n    const char *miguri = NULL;\n    const char *dname = NULL;\n    unsigned long long bandwidth = 0;\n\n    if (!virTypedParamsCheck(params, nparams, compatParams,\n                             G_N_ELEMENTS(compatParams))) {\n        virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED, \"%s\",\n                       _(\"Some parameters are not supported by migration \"\n                         \"protocol 2\"));\n        return -1;\n    }\n\n    if (virTypedParamsGetString(params, nparams,\n                                VIR_MIGRATE_PARAM_URI, &miguri) < 0 ||\n        virTypedParamsGetString(params, nparams,\n                                VIR_MIGRATE_PARAM_DEST_NAME, &dname) < 0 ||\n        virTypedParamsGetULLong(params, nparams,\n                                VIR_MIGRATE_PARAM_BANDWIDTH, &bandwidth) < 0) {\n        return -1;\n    }\n\n    if (flags & VIR_MIGRATE_PEER2PEER) {\n        if (miguri) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"Unable to override peer2peer migration URI\"));\n            return -1;\n        }\n        uri = dconnuri;\n    } else {\n        uri = miguri;\n    }\n\n    return domain->conn->driver->domainMigratePerform\n            (domain, NULL, 0, uri, flags, dname, bandwidth);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "domain->conn->driver->domainMigratePerform",
          "args": [
            "domain",
            "NULL",
            "0",
            "uri",
            "flags",
            "dname",
            "bandwidth"
          ],
          "line": 3352
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"Unable to override peer2peer migration URI\")"
          ],
          "line": 3343
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to override peer2peer migration URI\""
          ],
          "line": 3344
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virTypedParamsGetULLong",
          "args": [
            "params",
            "nparams",
            "VIR_MIGRATE_PARAM_BANDWIDTH",
            "&bandwidth"
          ],
          "line": 3336
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParamsGetULLong",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam-public.c",
          "lines": "288-306",
          "snippet": "int\nvirTypedParamsGetULLong(virTypedParameterPtr params,\n                        int nparams,\n                        const char *name,\n                        unsigned long long *value)\n{\n    virTypedParameterPtr param;\n\n    virResetLastError();\n\n    if (!(param = virTypedParamsGet(params, nparams, name)))\n        return 0;\n\n    VIR_TYPED_PARAM_CHECK_TYPE(VIR_TYPED_PARAM_ULLONG);\n    if (value)\n        *value = param->value.ul;\n\n    return 1;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtypedparam.h\"\n#include <config.h>\n\nint\nvirTypedParamsGetULLong(virTypedParameterPtr params,\n                        int nparams,\n                        const char *name,\n                        unsigned long long *value)\n{\n    virTypedParameterPtr param;\n\n    virResetLastError();\n\n    if (!(param = virTypedParamsGet(params, nparams, name)))\n        return 0;\n\n    VIR_TYPED_PARAM_CHECK_TYPE(VIR_TYPED_PARAM_ULLONG);\n    if (value)\n        *value = param->value.ul;\n\n    return 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virTypedParamsGetString",
          "args": [
            "params",
            "nparams",
            "VIR_MIGRATE_PARAM_DEST_NAME",
            "&dname"
          ],
          "line": 3334
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParamsGetStringList",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam.c",
          "lines": "432-467",
          "snippet": "int\nvirTypedParamsGetStringList(virTypedParameterPtr params,\n                            int nparams,\n                            const char *name,\n                            const char ***values)\n{\n    size_t i, n;\n    int nfiltered;\n    virTypedParameterPtr *filtered = NULL;\n\n    virCheckNonNullArgGoto(values, error);\n    *values = NULL;\n\n    nfiltered = virTypedParamsFilter(params, nparams, name, &filtered);\n\n    if (nfiltered < 0)\n        goto error;\n\n    if (nfiltered &&\n        VIR_ALLOC_N(*values, nfiltered) < 0)\n        goto error;\n\n    for (n = 0, i = 0; i < nfiltered; i++) {\n        if (filtered[i]->type == VIR_TYPED_PARAM_STRING)\n            (*values)[n++] = filtered[i]->value.s;\n    }\n\n    VIR_FREE(filtered);\n    return n;\n\n error:\n    if (values)\n        VIR_FREE(*values);\n    VIR_FREE(filtered);\n    return -1;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <stdarg.h>",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <stdarg.h>\n#include \"virtypedparam.h\"\n#include <config.h>\n\nint\nvirTypedParamsGetStringList(virTypedParameterPtr params,\n                            int nparams,\n                            const char *name,\n                            const char ***values)\n{\n    size_t i, n;\n    int nfiltered;\n    virTypedParameterPtr *filtered = NULL;\n\n    virCheckNonNullArgGoto(values, error);\n    *values = NULL;\n\n    nfiltered = virTypedParamsFilter(params, nparams, name, &filtered);\n\n    if (nfiltered < 0)\n        goto error;\n\n    if (nfiltered &&\n        VIR_ALLOC_N(*values, nfiltered) < 0)\n        goto error;\n\n    for (n = 0, i = 0; i < nfiltered; i++) {\n        if (filtered[i]->type == VIR_TYPED_PARAM_STRING)\n            (*values)[n++] = filtered[i]->value.s;\n    }\n\n    VIR_FREE(filtered);\n    return n;\n\n error:\n    if (values)\n        VIR_FREE(*values);\n    VIR_FREE(filtered);\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_ARGUMENT_UNSUPPORTED",
            "\"%s\"",
            "_(\"Some parameters are not supported by migration \"\n                         \"protocol 2\")"
          ],
          "line": 3326
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virTypedParamsCheck",
          "args": [
            "params",
            "nparams",
            "compatParams",
            "G_N_ELEMENTS(compatParams)"
          ],
          "line": 3324
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParamsCheck",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam.c",
          "lines": "148-169",
          "snippet": "bool\nvirTypedParamsCheck(virTypedParameterPtr params,\n                    int nparams,\n                    const char **names,\n                    int nnames)\n{\n    size_t i, j;\n\n    for (i = 0; i < nparams; i++) {\n        bool found = false;\n        for (j = 0; j < nnames; j++) {\n            if (STREQ(params[i].field, names[j])) {\n                found = true;\n                break;\n            }\n        }\n        if (!found)\n            return false;\n    }\n\n    return true;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <stdarg.h>",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <stdarg.h>\n#include \"virtypedparam.h\"\n#include <config.h>\n\nbool\nvirTypedParamsCheck(virTypedParameterPtr params,\n                    int nparams,\n                    const char **names,\n                    int nnames)\n{\n    size_t i, j;\n\n    for (i = 0; i < nparams; i++) {\n        bool found = false;\n        for (j = 0; j < nnames; j++) {\n            if (STREQ(params[i].field, names[j])) {\n                found = true;\n                break;\n            }\n        }\n        if (!found)\n            return false;\n    }\n\n    return true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "G_N_ELEMENTS",
          "args": [
            "compatParams"
          ],
          "line": 3325
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nstatic int\nvirDomainMigrateUnmanagedProto2(virDomainPtr domain,\n                                const char *dconnuri,\n                                virTypedParameterPtr params,\n                                int nparams,\n                                unsigned int flags)\n{\n    /* uri parameter is added for direct case */\n    const char *compatParams[] = { VIR_MIGRATE_PARAM_DEST_NAME,\n                                   VIR_MIGRATE_PARAM_BANDWIDTH,\n                                   VIR_MIGRATE_PARAM_URI };\n    const char *uri = NULL;\n    const char *miguri = NULL;\n    const char *dname = NULL;\n    unsigned long long bandwidth = 0;\n\n    if (!virTypedParamsCheck(params, nparams, compatParams,\n                             G_N_ELEMENTS(compatParams))) {\n        virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED, \"%s\",\n                       _(\"Some parameters are not supported by migration \"\n                         \"protocol 2\"));\n        return -1;\n    }\n\n    if (virTypedParamsGetString(params, nparams,\n                                VIR_MIGRATE_PARAM_URI, &miguri) < 0 ||\n        virTypedParamsGetString(params, nparams,\n                                VIR_MIGRATE_PARAM_DEST_NAME, &dname) < 0 ||\n        virTypedParamsGetULLong(params, nparams,\n                                VIR_MIGRATE_PARAM_BANDWIDTH, &bandwidth) < 0) {\n        return -1;\n    }\n\n    if (flags & VIR_MIGRATE_PEER2PEER) {\n        if (miguri) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"Unable to override peer2peer migration URI\"));\n            return -1;\n        }\n        uri = dconnuri;\n    } else {\n        uri = miguri;\n    }\n\n    return domain->conn->driver->domainMigratePerform\n            (domain, NULL, 0, uri, flags, dname, bandwidth);\n}"
  },
  {
    "function_name": "virDomainMigrateCheckNotLocal",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "3286-3305",
    "snippet": "static int\nvirDomainMigrateCheckNotLocal(const char *dconnuri)\n{\n    virURIPtr tempuri = NULL;\n    int ret = -1;\n\n    if (!(tempuri = virURIParse(dconnuri)))\n        goto cleanup;\n    if (!tempuri->server || STRPREFIX(tempuri->server, \"localhost\")) {\n        virReportInvalidArg(dconnuri, \"%s\",\n                            _(\"Attempt to migrate guest to the same host\"));\n        goto cleanup;\n    }\n\n    ret = 0;\n\n cleanup:\n    virURIFree(tempuri);\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virURIFree",
          "args": [
            "tempuri"
          ],
          "line": 3303
        },
        "resolved": true,
        "details": {
          "function_name": "virURIFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viruri.c",
          "lines": "277-298",
          "snippet": "void virURIFree(virURIPtr uri)\n{\n    size_t i;\n\n    if (!uri)\n        return;\n\n    VIR_FREE(uri->scheme);\n    VIR_FREE(uri->server);\n    VIR_FREE(uri->user);\n    VIR_FREE(uri->path);\n    VIR_FREE(uri->query);\n    VIR_FREE(uri->fragment);\n\n    for (i = 0; i < uri->paramsCount; i++) {\n        VIR_FREE(uri->params[i].name);\n        VIR_FREE(uri->params[i].value);\n    }\n    VIR_FREE(uri->params);\n\n    VIR_FREE(uri);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"viruri.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"viruri.h\"\n#include <config.h>\n\nvoid virURIFree(virURIPtr uri)\n{\n    size_t i;\n\n    if (!uri)\n        return;\n\n    VIR_FREE(uri->scheme);\n    VIR_FREE(uri->server);\n    VIR_FREE(uri->user);\n    VIR_FREE(uri->path);\n    VIR_FREE(uri->query);\n    VIR_FREE(uri->fragment);\n\n    for (i = 0; i < uri->paramsCount; i++) {\n        VIR_FREE(uri->params[i].name);\n        VIR_FREE(uri->params[i].value);\n    }\n    VIR_FREE(uri->params);\n\n    VIR_FREE(uri);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportInvalidArg",
          "args": [
            "dconnuri",
            "\"%s\"",
            "_(\"Attempt to migrate guest to the same host\")"
          ],
          "line": 3295
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Attempt to migrate guest to the same host\""
          ],
          "line": 3296
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "STRPREFIX",
          "args": [
            "tempuri->server",
            "\"localhost\""
          ],
          "line": 3294
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virURIParse",
          "args": [
            "dconnuri"
          ],
          "line": 3292
        },
        "resolved": true,
        "details": {
          "function_name": "virURIParse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viruri.c",
          "lines": "143-194",
          "snippet": "virURIPtr\nvirURIParse(const char *uri)\n{\n    xmlURIPtr xmluri;\n    virURIPtr ret = NULL;\n\n    xmluri = xmlParseURI(uri);\n\n    if (!xmluri) {\n        /* libxml2 does not tell us what failed. Grr :-( */\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Unable to parse URI %s\"), uri);\n        return NULL;\n    }\n\n    if (VIR_ALLOC(ret) < 0)\n        goto error;\n\n    ret->scheme = g_strdup(xmluri->scheme);\n    ret->server = g_strdup(xmluri->server);\n    /* xmluri->port value is not defined if server was\n     * not given. Modern versions libxml2 fill port\n     * differently to old versions in this case, so\n     * don't rely on it. eg libxml2 git commit:\n     *   beb7281055dbf0ed4d041022a67c6c5cfd126f25\n     */\n    if (!ret->server || STREQ(ret->server, \"\"))\n        ret->port = 0;\n    else\n        ret->port = xmluri->port;\n    ret->path = g_strdup(xmluri->path);\n    ret->query = g_strdup(xmluri->query_raw);\n    ret->fragment = g_strdup(xmluri->fragment);\n    ret->user = g_strdup(xmluri->user);\n\n    /* Strip square bracket from an IPv6 address.\n     * The function modifies the string in-place. Even after such\n     * modification, it is OK to free the URI with xmlFreeURI. */\n    virStringStripIPv6Brackets(ret->server);\n\n    if (virURIParseParams(ret) < 0)\n        goto error;\n\n    xmlFreeURI(xmluri);\n\n    return ret;\n\n error:\n    xmlFreeURI(xmluri);\n    virURIFree(ret);\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"viruri.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"viruri.h\"\n#include <config.h>\n\nvirURIPtr\nvirURIParse(const char *uri)\n{\n    xmlURIPtr xmluri;\n    virURIPtr ret = NULL;\n\n    xmluri = xmlParseURI(uri);\n\n    if (!xmluri) {\n        /* libxml2 does not tell us what failed. Grr :-( */\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Unable to parse URI %s\"), uri);\n        return NULL;\n    }\n\n    if (VIR_ALLOC(ret) < 0)\n        goto error;\n\n    ret->scheme = g_strdup(xmluri->scheme);\n    ret->server = g_strdup(xmluri->server);\n    /* xmluri->port value is not defined if server was\n     * not given. Modern versions libxml2 fill port\n     * differently to old versions in this case, so\n     * don't rely on it. eg libxml2 git commit:\n     *   beb7281055dbf0ed4d041022a67c6c5cfd126f25\n     */\n    if (!ret->server || STREQ(ret->server, \"\"))\n        ret->port = 0;\n    else\n        ret->port = xmluri->port;\n    ret->path = g_strdup(xmluri->path);\n    ret->query = g_strdup(xmluri->query_raw);\n    ret->fragment = g_strdup(xmluri->fragment);\n    ret->user = g_strdup(xmluri->user);\n\n    /* Strip square bracket from an IPv6 address.\n     * The function modifies the string in-place. Even after such\n     * modification, it is OK to free the URI with xmlFreeURI. */\n    virStringStripIPv6Brackets(ret->server);\n\n    if (virURIParseParams(ret) < 0)\n        goto error;\n\n    xmlFreeURI(xmluri);\n\n    return ret;\n\n error:\n    xmlFreeURI(xmluri);\n    virURIFree(ret);\n    return NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nstatic int\nvirDomainMigrateCheckNotLocal(const char *dconnuri)\n{\n    virURIPtr tempuri = NULL;\n    int ret = -1;\n\n    if (!(tempuri = virURIParse(dconnuri)))\n        goto cleanup;\n    if (!tempuri->server || STRPREFIX(tempuri->server, \"localhost\")) {\n        virReportInvalidArg(dconnuri, \"%s\",\n                            _(\"Attempt to migrate guest to the same host\"));\n        goto cleanup;\n    }\n\n    ret = 0;\n\n cleanup:\n    virURIFree(tempuri);\n    return ret;\n}"
  },
  {
    "function_name": "virDomainMigrateVersion3Params",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "3274-3283",
    "snippet": "static virDomainPtr\nvirDomainMigrateVersion3Params(virDomainPtr domain,\n                               virConnectPtr dconn,\n                               virTypedParameterPtr params,\n                               int nparams,\n                               unsigned int flags)\n{\n    return virDomainMigrateVersion3Full(domain, dconn, NULL, NULL, NULL, 0,\n                                        params, nparams, true, flags);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainMigrateVersion3Full",
          "args": [
            "domain",
            "dconn",
            "NULL",
            "NULL",
            "NULL",
            "0",
            "params",
            "nparams",
            "true",
            "flags"
          ],
          "line": 3281
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainMigrateVersion3Full",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
          "lines": "2961-3257",
          "snippet": "static virDomainPtr\nvirDomainMigrateVersion3Full(virDomainPtr domain,\n                             virConnectPtr dconn,\n                             const char *xmlin,\n                             const char *dname,\n                             const char *uri,\n                             unsigned long long bandwidth,\n                             virTypedParameterPtr params,\n                             int nparams,\n                             bool useParams,\n                             unsigned int flags)\n{\n    virDomainPtr ddomain = NULL;\n    char *uri_out = NULL;\n    char *cookiein = NULL;\n    char *cookieout = NULL;\n    char *dom_xml = NULL;\n    int cookieinlen = 0;\n    int cookieoutlen = 0;\n    int ret;\n    virDomainInfo info;\n    virErrorPtr orig_err = NULL;\n    int cancelled = 1;\n    unsigned long protection = 0;\n    bool notify_source = true;\n    unsigned int destflags;\n    int state;\n    virTypedParameterPtr tmp;\n\n    VIR_DOMAIN_DEBUG(domain,\n                     \"dconn=%p, xmlin=%s, dname=%s, uri=%s, bandwidth=%llu, \"\n                     \"params=%p, nparams=%d, useParams=%d, flags=0x%x\",\n                     dconn, NULLSTR(xmlin), NULLSTR(dname), NULLSTR(uri),\n                     bandwidth, params, nparams, useParams, flags);\n    VIR_TYPED_PARAMS_DEBUG(params, nparams);\n\n    if ((!useParams &&\n         (!domain->conn->driver->domainMigrateBegin3 ||\n          !domain->conn->driver->domainMigratePerform3 ||\n          !domain->conn->driver->domainMigrateConfirm3 ||\n          !dconn->driver->domainMigratePrepare3 ||\n          !dconn->driver->domainMigrateFinish3)) ||\n        (useParams &&\n         (!domain->conn->driver->domainMigrateBegin3Params ||\n          !domain->conn->driver->domainMigratePerform3Params ||\n          !domain->conn->driver->domainMigrateConfirm3Params ||\n          !dconn->driver->domainMigratePrepare3Params ||\n          !dconn->driver->domainMigrateFinish3Params))) {\n        virReportUnsupportedError();\n        return NULL;\n    }\n\n    if (virTypedParamsCopy(&tmp, params, nparams) < 0)\n        return NULL;\n    params = tmp;\n\n    if (VIR_DRV_SUPPORTS_FEATURE(domain->conn->driver, domain->conn,\n                                 VIR_DRV_FEATURE_MIGRATE_CHANGE_PROTECTION))\n        protection = VIR_MIGRATE_CHANGE_PROTECTION;\n\n    VIR_DEBUG(\"Begin3 %p\", domain->conn);\n    if (useParams) {\n        dom_xml = domain->conn->driver->domainMigrateBegin3Params\n            (domain, params, nparams, &cookieout, &cookieoutlen,\n             flags | protection);\n    } else {\n        dom_xml = domain->conn->driver->domainMigrateBegin3\n            (domain, xmlin, &cookieout, &cookieoutlen,\n             flags | protection, dname, bandwidth);\n    }\n    if (!dom_xml)\n        goto done;\n\n    if (useParams) {\n        /* If source is new enough to support extensible migration parameters,\n         * it's certainly new enough to support virDomainGetState. */\n        ret = virDomainGetState(domain, &state, NULL, 0);\n    } else {\n        ret = virDomainGetInfo(domain, &info);\n        state = info.state;\n    }\n    if (ret == 0 && state == VIR_DOMAIN_PAUSED)\n        flags |= VIR_MIGRATE_PAUSED;\n\n    destflags = flags & ~(VIR_MIGRATE_ABORT_ON_ERROR |\n                          VIR_MIGRATE_AUTO_CONVERGE);\n\n    VIR_DEBUG(\"Prepare3 %p flags=0x%x\", dconn, destflags);\n    cookiein = g_steal_pointer(&cookieout);\n    cookieinlen = cookieoutlen;\n    cookieoutlen = 0;\n    if (useParams) {\n        if (virTypedParamsReplaceString(&params, &nparams,\n                                        VIR_MIGRATE_PARAM_DEST_XML,\n                                        dom_xml) < 0)\n            goto done;\n        ret = dconn->driver->domainMigratePrepare3Params\n            (dconn, params, nparams, cookiein, cookieinlen,\n             &cookieout, &cookieoutlen, &uri_out, destflags);\n    } else {\n        ret = dconn->driver->domainMigratePrepare3\n            (dconn, cookiein, cookieinlen, &cookieout, &cookieoutlen,\n             uri, &uri_out, destflags, dname, bandwidth, dom_xml);\n    }\n    if (ret == -1) {\n        if (protection) {\n            /* Begin already started a migration job so we need to cancel it by\n             * calling Confirm while making sure it doesn't overwrite the error\n             */\n            virErrorPreserveLast(&orig_err);\n            goto confirm;\n        } else {\n            goto done;\n        }\n    }\n\n    /* Did domainMigratePrepare3 change URI? */\n    if (uri_out) {\n        uri = uri_out;\n        if (useParams &&\n            virTypedParamsReplaceString(&params, &nparams,\n                                        VIR_MIGRATE_PARAM_URI,\n                                        uri_out) < 0) {\n            cancelled = 1;\n            virErrorPreserveLast(&orig_err);\n            goto finish;\n        }\n    } else if (!uri &&\n               virTypedParamsGetString(params, nparams,\n                                       VIR_MIGRATE_PARAM_URI, &uri) <= 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"domainMigratePrepare3 did not set uri\"));\n        cancelled = 1;\n        virErrorPreserveLast(&orig_err);\n        goto finish;\n    }\n\n    if (flags & VIR_MIGRATE_OFFLINE) {\n        VIR_DEBUG(\"Offline migration, skipping Perform phase\");\n        VIR_FREE(cookieout);\n        cookieoutlen = 0;\n        cancelled = 0;\n        goto finish;\n    }\n\n    /* Perform the migration.  The driver isn't supposed to return\n     * until the migration is complete. The src VM should remain\n     * running, but in paused state until the destination can\n     * confirm migration completion.\n     */\n    VIR_DEBUG(\"Perform3 %p uri=%s\", domain->conn, uri);\n    VIR_FREE(cookiein);\n    cookiein = g_steal_pointer(&cookieout);\n    cookieinlen = cookieoutlen;\n    cookieoutlen = 0;\n    /* dconnuri not relevant in non-P2P modes, so left NULL here */\n    if (useParams) {\n        ret = domain->conn->driver->domainMigratePerform3Params\n            (domain, NULL, params, nparams, cookiein, cookieinlen,\n             &cookieout, &cookieoutlen, flags | protection);\n    } else {\n        ret = domain->conn->driver->domainMigratePerform3\n            (domain, NULL, cookiein, cookieinlen,\n             &cookieout, &cookieoutlen, NULL,\n             uri, flags | protection, dname, bandwidth);\n    }\n\n    /* Perform failed. Make sure Finish doesn't overwrite the error */\n    if (ret < 0) {\n        virErrorPreserveLast(&orig_err);\n        /* Perform failed so we don't need to call confirm to let source know\n         * about the failure.\n         */\n        notify_source = false;\n    }\n\n    /* If Perform returns < 0, then we need to cancel the VM\n     * startup on the destination\n     */\n    cancelled = ret < 0 ? 1 : 0;\n\n finish:\n    /*\n     * The status code from the source is passed to the destination.\n     * The dest can cleanup if the source indicated it failed to\n     * send all migration data. Returns NULL for ddomain if\n     * the dest was unable to complete migration.\n     */\n    VIR_DEBUG(\"Finish3 %p ret=%d\", dconn, ret);\n    VIR_FREE(cookiein);\n    cookiein = g_steal_pointer(&cookieout);\n    cookieinlen = cookieoutlen;\n    cookieoutlen = 0;\n    if (useParams) {\n        if (virTypedParamsGetString(params, nparams,\n                                    VIR_MIGRATE_PARAM_DEST_NAME, NULL) <= 0 &&\n            virTypedParamsReplaceString(&params, &nparams,\n                                        VIR_MIGRATE_PARAM_DEST_NAME,\n                                        domain->name) < 0) {\n            ddomain = NULL;\n        } else {\n            ddomain = dconn->driver->domainMigrateFinish3Params\n                (dconn, params, nparams, cookiein, cookieinlen,\n                 &cookieout, &cookieoutlen, destflags, cancelled);\n        }\n    } else {\n        dname = dname ? dname : domain->name;\n        ddomain = dconn->driver->domainMigrateFinish3\n            (dconn, dname, cookiein, cookieinlen, &cookieout, &cookieoutlen,\n             NULL, uri, destflags, cancelled);\n    }\n\n    if (cancelled) {\n        if (ddomain) {\n            VIR_ERROR(_(\"finish step ignored that migration was cancelled\"));\n        } else {\n            /* If Finish reported a useful error, use it instead of the\n             * original \"migration unexpectedly failed\" error.\n             *\n             * This is ugly but we can't do better with the APIs we have. We\n             * only replace the error if Finish was called with cancelled == 1\n             * and reported a real error (old libvirt would report an error\n             * from RPC instead of MIGRATE_FINISH_OK), which only happens when\n             * the domain died on destination. To further reduce a possibility\n             * of false positives we also check that Perform returned\n             * VIR_ERR_OPERATION_FAILED.\n             */\n            if (orig_err &&\n                orig_err->domain == VIR_FROM_QEMU &&\n                orig_err->code == VIR_ERR_OPERATION_FAILED) {\n                virErrorPtr err = virGetLastError();\n                if (err &&\n                    err->domain == VIR_FROM_QEMU &&\n                    err->code != VIR_ERR_MIGRATE_FINISH_OK) {\n                    virFreeError(orig_err);\n                    orig_err = NULL;\n                }\n            }\n        }\n    }\n\n    /* If ddomain is NULL, then we were unable to start\n     * the guest on the target, and must restart on the\n     * source. There is a small chance that the ddomain\n     * is NULL due to an RPC failure, in which case\n     * ddomain could in fact be running on the dest.\n     * The lock manager plugins should take care of\n     * safety in this scenario.\n     */\n    cancelled = ddomain == NULL ? 1 : 0;\n\n    /* If finish3 set an error, and we don't have an earlier\n     * one we need to preserve it in case confirm3 overwrites\n     */\n    if (!orig_err)\n        virErrorPreserveLast(&orig_err);\n\n confirm:\n    /*\n     * If cancelled, then src VM will be restarted, else it will be killed.\n     * Don't do this if migration failed on source and thus it was already\n     * cancelled there.\n     */\n    if (notify_source) {\n        VIR_DEBUG(\"Confirm3 %p ret=%d domain=%p\", domain->conn, ret, domain);\n        VIR_FREE(cookiein);\n        cookiein = g_steal_pointer(&cookieout);\n        cookieinlen = cookieoutlen;\n        cookieoutlen = 0;\n        if (useParams) {\n            ret = domain->conn->driver->domainMigrateConfirm3Params\n                (domain, params, nparams, cookiein, cookieinlen,\n                 flags | protection, cancelled);\n        } else {\n            ret = domain->conn->driver->domainMigrateConfirm3\n                (domain, cookiein, cookieinlen,\n                 flags | protection, cancelled);\n        }\n        /* If Confirm3 returns -1, there's nothing more we can\n         * do, but fortunately worst case is that there is a\n         * domain left in 'paused' state on source.\n         */\n        if (ret < 0) {\n            VIR_WARN(\"Guest %s probably left in 'paused' state on source\",\n                     domain->name);\n        }\n    }\n\n done:\n    virErrorRestore(&orig_err);\n    VIR_FREE(dom_xml);\n    VIR_FREE(uri_out);\n    VIR_FREE(cookiein);\n    VIR_FREE(cookieout);\n    virTypedParamsFree(params, nparams);\n    return ddomain;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nstatic virDomainPtr\nvirDomainMigrateVersion3Full(virDomainPtr domain,\n                             virConnectPtr dconn,\n                             const char *xmlin,\n                             const char *dname,\n                             const char *uri,\n                             unsigned long long bandwidth,\n                             virTypedParameterPtr params,\n                             int nparams,\n                             bool useParams,\n                             unsigned int flags)\n{\n    virDomainPtr ddomain = NULL;\n    char *uri_out = NULL;\n    char *cookiein = NULL;\n    char *cookieout = NULL;\n    char *dom_xml = NULL;\n    int cookieinlen = 0;\n    int cookieoutlen = 0;\n    int ret;\n    virDomainInfo info;\n    virErrorPtr orig_err = NULL;\n    int cancelled = 1;\n    unsigned long protection = 0;\n    bool notify_source = true;\n    unsigned int destflags;\n    int state;\n    virTypedParameterPtr tmp;\n\n    VIR_DOMAIN_DEBUG(domain,\n                     \"dconn=%p, xmlin=%s, dname=%s, uri=%s, bandwidth=%llu, \"\n                     \"params=%p, nparams=%d, useParams=%d, flags=0x%x\",\n                     dconn, NULLSTR(xmlin), NULLSTR(dname), NULLSTR(uri),\n                     bandwidth, params, nparams, useParams, flags);\n    VIR_TYPED_PARAMS_DEBUG(params, nparams);\n\n    if ((!useParams &&\n         (!domain->conn->driver->domainMigrateBegin3 ||\n          !domain->conn->driver->domainMigratePerform3 ||\n          !domain->conn->driver->domainMigrateConfirm3 ||\n          !dconn->driver->domainMigratePrepare3 ||\n          !dconn->driver->domainMigrateFinish3)) ||\n        (useParams &&\n         (!domain->conn->driver->domainMigrateBegin3Params ||\n          !domain->conn->driver->domainMigratePerform3Params ||\n          !domain->conn->driver->domainMigrateConfirm3Params ||\n          !dconn->driver->domainMigratePrepare3Params ||\n          !dconn->driver->domainMigrateFinish3Params))) {\n        virReportUnsupportedError();\n        return NULL;\n    }\n\n    if (virTypedParamsCopy(&tmp, params, nparams) < 0)\n        return NULL;\n    params = tmp;\n\n    if (VIR_DRV_SUPPORTS_FEATURE(domain->conn->driver, domain->conn,\n                                 VIR_DRV_FEATURE_MIGRATE_CHANGE_PROTECTION))\n        protection = VIR_MIGRATE_CHANGE_PROTECTION;\n\n    VIR_DEBUG(\"Begin3 %p\", domain->conn);\n    if (useParams) {\n        dom_xml = domain->conn->driver->domainMigrateBegin3Params\n            (domain, params, nparams, &cookieout, &cookieoutlen,\n             flags | protection);\n    } else {\n        dom_xml = domain->conn->driver->domainMigrateBegin3\n            (domain, xmlin, &cookieout, &cookieoutlen,\n             flags | protection, dname, bandwidth);\n    }\n    if (!dom_xml)\n        goto done;\n\n    if (useParams) {\n        /* If source is new enough to support extensible migration parameters,\n         * it's certainly new enough to support virDomainGetState. */\n        ret = virDomainGetState(domain, &state, NULL, 0);\n    } else {\n        ret = virDomainGetInfo(domain, &info);\n        state = info.state;\n    }\n    if (ret == 0 && state == VIR_DOMAIN_PAUSED)\n        flags |= VIR_MIGRATE_PAUSED;\n\n    destflags = flags & ~(VIR_MIGRATE_ABORT_ON_ERROR |\n                          VIR_MIGRATE_AUTO_CONVERGE);\n\n    VIR_DEBUG(\"Prepare3 %p flags=0x%x\", dconn, destflags);\n    cookiein = g_steal_pointer(&cookieout);\n    cookieinlen = cookieoutlen;\n    cookieoutlen = 0;\n    if (useParams) {\n        if (virTypedParamsReplaceString(&params, &nparams,\n                                        VIR_MIGRATE_PARAM_DEST_XML,\n                                        dom_xml) < 0)\n            goto done;\n        ret = dconn->driver->domainMigratePrepare3Params\n            (dconn, params, nparams, cookiein, cookieinlen,\n             &cookieout, &cookieoutlen, &uri_out, destflags);\n    } else {\n        ret = dconn->driver->domainMigratePrepare3\n            (dconn, cookiein, cookieinlen, &cookieout, &cookieoutlen,\n             uri, &uri_out, destflags, dname, bandwidth, dom_xml);\n    }\n    if (ret == -1) {\n        if (protection) {\n            /* Begin already started a migration job so we need to cancel it by\n             * calling Confirm while making sure it doesn't overwrite the error\n             */\n            virErrorPreserveLast(&orig_err);\n            goto confirm;\n        } else {\n            goto done;\n        }\n    }\n\n    /* Did domainMigratePrepare3 change URI? */\n    if (uri_out) {\n        uri = uri_out;\n        if (useParams &&\n            virTypedParamsReplaceString(&params, &nparams,\n                                        VIR_MIGRATE_PARAM_URI,\n                                        uri_out) < 0) {\n            cancelled = 1;\n            virErrorPreserveLast(&orig_err);\n            goto finish;\n        }\n    } else if (!uri &&\n               virTypedParamsGetString(params, nparams,\n                                       VIR_MIGRATE_PARAM_URI, &uri) <= 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"domainMigratePrepare3 did not set uri\"));\n        cancelled = 1;\n        virErrorPreserveLast(&orig_err);\n        goto finish;\n    }\n\n    if (flags & VIR_MIGRATE_OFFLINE) {\n        VIR_DEBUG(\"Offline migration, skipping Perform phase\");\n        VIR_FREE(cookieout);\n        cookieoutlen = 0;\n        cancelled = 0;\n        goto finish;\n    }\n\n    /* Perform the migration.  The driver isn't supposed to return\n     * until the migration is complete. The src VM should remain\n     * running, but in paused state until the destination can\n     * confirm migration completion.\n     */\n    VIR_DEBUG(\"Perform3 %p uri=%s\", domain->conn, uri);\n    VIR_FREE(cookiein);\n    cookiein = g_steal_pointer(&cookieout);\n    cookieinlen = cookieoutlen;\n    cookieoutlen = 0;\n    /* dconnuri not relevant in non-P2P modes, so left NULL here */\n    if (useParams) {\n        ret = domain->conn->driver->domainMigratePerform3Params\n            (domain, NULL, params, nparams, cookiein, cookieinlen,\n             &cookieout, &cookieoutlen, flags | protection);\n    } else {\n        ret = domain->conn->driver->domainMigratePerform3\n            (domain, NULL, cookiein, cookieinlen,\n             &cookieout, &cookieoutlen, NULL,\n             uri, flags | protection, dname, bandwidth);\n    }\n\n    /* Perform failed. Make sure Finish doesn't overwrite the error */\n    if (ret < 0) {\n        virErrorPreserveLast(&orig_err);\n        /* Perform failed so we don't need to call confirm to let source know\n         * about the failure.\n         */\n        notify_source = false;\n    }\n\n    /* If Perform returns < 0, then we need to cancel the VM\n     * startup on the destination\n     */\n    cancelled = ret < 0 ? 1 : 0;\n\n finish:\n    /*\n     * The status code from the source is passed to the destination.\n     * The dest can cleanup if the source indicated it failed to\n     * send all migration data. Returns NULL for ddomain if\n     * the dest was unable to complete migration.\n     */\n    VIR_DEBUG(\"Finish3 %p ret=%d\", dconn, ret);\n    VIR_FREE(cookiein);\n    cookiein = g_steal_pointer(&cookieout);\n    cookieinlen = cookieoutlen;\n    cookieoutlen = 0;\n    if (useParams) {\n        if (virTypedParamsGetString(params, nparams,\n                                    VIR_MIGRATE_PARAM_DEST_NAME, NULL) <= 0 &&\n            virTypedParamsReplaceString(&params, &nparams,\n                                        VIR_MIGRATE_PARAM_DEST_NAME,\n                                        domain->name) < 0) {\n            ddomain = NULL;\n        } else {\n            ddomain = dconn->driver->domainMigrateFinish3Params\n                (dconn, params, nparams, cookiein, cookieinlen,\n                 &cookieout, &cookieoutlen, destflags, cancelled);\n        }\n    } else {\n        dname = dname ? dname : domain->name;\n        ddomain = dconn->driver->domainMigrateFinish3\n            (dconn, dname, cookiein, cookieinlen, &cookieout, &cookieoutlen,\n             NULL, uri, destflags, cancelled);\n    }\n\n    if (cancelled) {\n        if (ddomain) {\n            VIR_ERROR(_(\"finish step ignored that migration was cancelled\"));\n        } else {\n            /* If Finish reported a useful error, use it instead of the\n             * original \"migration unexpectedly failed\" error.\n             *\n             * This is ugly but we can't do better with the APIs we have. We\n             * only replace the error if Finish was called with cancelled == 1\n             * and reported a real error (old libvirt would report an error\n             * from RPC instead of MIGRATE_FINISH_OK), which only happens when\n             * the domain died on destination. To further reduce a possibility\n             * of false positives we also check that Perform returned\n             * VIR_ERR_OPERATION_FAILED.\n             */\n            if (orig_err &&\n                orig_err->domain == VIR_FROM_QEMU &&\n                orig_err->code == VIR_ERR_OPERATION_FAILED) {\n                virErrorPtr err = virGetLastError();\n                if (err &&\n                    err->domain == VIR_FROM_QEMU &&\n                    err->code != VIR_ERR_MIGRATE_FINISH_OK) {\n                    virFreeError(orig_err);\n                    orig_err = NULL;\n                }\n            }\n        }\n    }\n\n    /* If ddomain is NULL, then we were unable to start\n     * the guest on the target, and must restart on the\n     * source. There is a small chance that the ddomain\n     * is NULL due to an RPC failure, in which case\n     * ddomain could in fact be running on the dest.\n     * The lock manager plugins should take care of\n     * safety in this scenario.\n     */\n    cancelled = ddomain == NULL ? 1 : 0;\n\n    /* If finish3 set an error, and we don't have an earlier\n     * one we need to preserve it in case confirm3 overwrites\n     */\n    if (!orig_err)\n        virErrorPreserveLast(&orig_err);\n\n confirm:\n    /*\n     * If cancelled, then src VM will be restarted, else it will be killed.\n     * Don't do this if migration failed on source and thus it was already\n     * cancelled there.\n     */\n    if (notify_source) {\n        VIR_DEBUG(\"Confirm3 %p ret=%d domain=%p\", domain->conn, ret, domain);\n        VIR_FREE(cookiein);\n        cookiein = g_steal_pointer(&cookieout);\n        cookieinlen = cookieoutlen;\n        cookieoutlen = 0;\n        if (useParams) {\n            ret = domain->conn->driver->domainMigrateConfirm3Params\n                (domain, params, nparams, cookiein, cookieinlen,\n                 flags | protection, cancelled);\n        } else {\n            ret = domain->conn->driver->domainMigrateConfirm3\n                (domain, cookiein, cookieinlen,\n                 flags | protection, cancelled);\n        }\n        /* If Confirm3 returns -1, there's nothing more we can\n         * do, but fortunately worst case is that there is a\n         * domain left in 'paused' state on source.\n         */\n        if (ret < 0) {\n            VIR_WARN(\"Guest %s probably left in 'paused' state on source\",\n                     domain->name);\n        }\n    }\n\n done:\n    virErrorRestore(&orig_err);\n    VIR_FREE(dom_xml);\n    VIR_FREE(uri_out);\n    VIR_FREE(cookiein);\n    VIR_FREE(cookieout);\n    virTypedParamsFree(params, nparams);\n    return ddomain;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nstatic virDomainPtr\nvirDomainMigrateVersion3Params(virDomainPtr domain,\n                               virConnectPtr dconn,\n                               virTypedParameterPtr params,\n                               int nparams,\n                               unsigned int flags)\n{\n    return virDomainMigrateVersion3Full(domain, dconn, NULL, NULL, NULL, 0,\n                                        params, nparams, true, flags);\n}"
  },
  {
    "function_name": "virDomainMigrateVersion3",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "3260-3271",
    "snippet": "static virDomainPtr\nvirDomainMigrateVersion3(virDomainPtr domain,\n                         virConnectPtr dconn,\n                         const char *xmlin,\n                         unsigned long flags,\n                         const char *dname,\n                         const char *uri,\n                         unsigned long bandwidth)\n{\n    return virDomainMigrateVersion3Full(domain, dconn, xmlin, dname, uri,\n                                        bandwidth, NULL, 0, false, flags);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainMigrateVersion3Full",
          "args": [
            "domain",
            "dconn",
            "xmlin",
            "dname",
            "uri",
            "bandwidth",
            "NULL",
            "0",
            "false",
            "flags"
          ],
          "line": 3269
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainMigrateVersion3Full",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
          "lines": "2961-3257",
          "snippet": "static virDomainPtr\nvirDomainMigrateVersion3Full(virDomainPtr domain,\n                             virConnectPtr dconn,\n                             const char *xmlin,\n                             const char *dname,\n                             const char *uri,\n                             unsigned long long bandwidth,\n                             virTypedParameterPtr params,\n                             int nparams,\n                             bool useParams,\n                             unsigned int flags)\n{\n    virDomainPtr ddomain = NULL;\n    char *uri_out = NULL;\n    char *cookiein = NULL;\n    char *cookieout = NULL;\n    char *dom_xml = NULL;\n    int cookieinlen = 0;\n    int cookieoutlen = 0;\n    int ret;\n    virDomainInfo info;\n    virErrorPtr orig_err = NULL;\n    int cancelled = 1;\n    unsigned long protection = 0;\n    bool notify_source = true;\n    unsigned int destflags;\n    int state;\n    virTypedParameterPtr tmp;\n\n    VIR_DOMAIN_DEBUG(domain,\n                     \"dconn=%p, xmlin=%s, dname=%s, uri=%s, bandwidth=%llu, \"\n                     \"params=%p, nparams=%d, useParams=%d, flags=0x%x\",\n                     dconn, NULLSTR(xmlin), NULLSTR(dname), NULLSTR(uri),\n                     bandwidth, params, nparams, useParams, flags);\n    VIR_TYPED_PARAMS_DEBUG(params, nparams);\n\n    if ((!useParams &&\n         (!domain->conn->driver->domainMigrateBegin3 ||\n          !domain->conn->driver->domainMigratePerform3 ||\n          !domain->conn->driver->domainMigrateConfirm3 ||\n          !dconn->driver->domainMigratePrepare3 ||\n          !dconn->driver->domainMigrateFinish3)) ||\n        (useParams &&\n         (!domain->conn->driver->domainMigrateBegin3Params ||\n          !domain->conn->driver->domainMigratePerform3Params ||\n          !domain->conn->driver->domainMigrateConfirm3Params ||\n          !dconn->driver->domainMigratePrepare3Params ||\n          !dconn->driver->domainMigrateFinish3Params))) {\n        virReportUnsupportedError();\n        return NULL;\n    }\n\n    if (virTypedParamsCopy(&tmp, params, nparams) < 0)\n        return NULL;\n    params = tmp;\n\n    if (VIR_DRV_SUPPORTS_FEATURE(domain->conn->driver, domain->conn,\n                                 VIR_DRV_FEATURE_MIGRATE_CHANGE_PROTECTION))\n        protection = VIR_MIGRATE_CHANGE_PROTECTION;\n\n    VIR_DEBUG(\"Begin3 %p\", domain->conn);\n    if (useParams) {\n        dom_xml = domain->conn->driver->domainMigrateBegin3Params\n            (domain, params, nparams, &cookieout, &cookieoutlen,\n             flags | protection);\n    } else {\n        dom_xml = domain->conn->driver->domainMigrateBegin3\n            (domain, xmlin, &cookieout, &cookieoutlen,\n             flags | protection, dname, bandwidth);\n    }\n    if (!dom_xml)\n        goto done;\n\n    if (useParams) {\n        /* If source is new enough to support extensible migration parameters,\n         * it's certainly new enough to support virDomainGetState. */\n        ret = virDomainGetState(domain, &state, NULL, 0);\n    } else {\n        ret = virDomainGetInfo(domain, &info);\n        state = info.state;\n    }\n    if (ret == 0 && state == VIR_DOMAIN_PAUSED)\n        flags |= VIR_MIGRATE_PAUSED;\n\n    destflags = flags & ~(VIR_MIGRATE_ABORT_ON_ERROR |\n                          VIR_MIGRATE_AUTO_CONVERGE);\n\n    VIR_DEBUG(\"Prepare3 %p flags=0x%x\", dconn, destflags);\n    cookiein = g_steal_pointer(&cookieout);\n    cookieinlen = cookieoutlen;\n    cookieoutlen = 0;\n    if (useParams) {\n        if (virTypedParamsReplaceString(&params, &nparams,\n                                        VIR_MIGRATE_PARAM_DEST_XML,\n                                        dom_xml) < 0)\n            goto done;\n        ret = dconn->driver->domainMigratePrepare3Params\n            (dconn, params, nparams, cookiein, cookieinlen,\n             &cookieout, &cookieoutlen, &uri_out, destflags);\n    } else {\n        ret = dconn->driver->domainMigratePrepare3\n            (dconn, cookiein, cookieinlen, &cookieout, &cookieoutlen,\n             uri, &uri_out, destflags, dname, bandwidth, dom_xml);\n    }\n    if (ret == -1) {\n        if (protection) {\n            /* Begin already started a migration job so we need to cancel it by\n             * calling Confirm while making sure it doesn't overwrite the error\n             */\n            virErrorPreserveLast(&orig_err);\n            goto confirm;\n        } else {\n            goto done;\n        }\n    }\n\n    /* Did domainMigratePrepare3 change URI? */\n    if (uri_out) {\n        uri = uri_out;\n        if (useParams &&\n            virTypedParamsReplaceString(&params, &nparams,\n                                        VIR_MIGRATE_PARAM_URI,\n                                        uri_out) < 0) {\n            cancelled = 1;\n            virErrorPreserveLast(&orig_err);\n            goto finish;\n        }\n    } else if (!uri &&\n               virTypedParamsGetString(params, nparams,\n                                       VIR_MIGRATE_PARAM_URI, &uri) <= 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"domainMigratePrepare3 did not set uri\"));\n        cancelled = 1;\n        virErrorPreserveLast(&orig_err);\n        goto finish;\n    }\n\n    if (flags & VIR_MIGRATE_OFFLINE) {\n        VIR_DEBUG(\"Offline migration, skipping Perform phase\");\n        VIR_FREE(cookieout);\n        cookieoutlen = 0;\n        cancelled = 0;\n        goto finish;\n    }\n\n    /* Perform the migration.  The driver isn't supposed to return\n     * until the migration is complete. The src VM should remain\n     * running, but in paused state until the destination can\n     * confirm migration completion.\n     */\n    VIR_DEBUG(\"Perform3 %p uri=%s\", domain->conn, uri);\n    VIR_FREE(cookiein);\n    cookiein = g_steal_pointer(&cookieout);\n    cookieinlen = cookieoutlen;\n    cookieoutlen = 0;\n    /* dconnuri not relevant in non-P2P modes, so left NULL here */\n    if (useParams) {\n        ret = domain->conn->driver->domainMigratePerform3Params\n            (domain, NULL, params, nparams, cookiein, cookieinlen,\n             &cookieout, &cookieoutlen, flags | protection);\n    } else {\n        ret = domain->conn->driver->domainMigratePerform3\n            (domain, NULL, cookiein, cookieinlen,\n             &cookieout, &cookieoutlen, NULL,\n             uri, flags | protection, dname, bandwidth);\n    }\n\n    /* Perform failed. Make sure Finish doesn't overwrite the error */\n    if (ret < 0) {\n        virErrorPreserveLast(&orig_err);\n        /* Perform failed so we don't need to call confirm to let source know\n         * about the failure.\n         */\n        notify_source = false;\n    }\n\n    /* If Perform returns < 0, then we need to cancel the VM\n     * startup on the destination\n     */\n    cancelled = ret < 0 ? 1 : 0;\n\n finish:\n    /*\n     * The status code from the source is passed to the destination.\n     * The dest can cleanup if the source indicated it failed to\n     * send all migration data. Returns NULL for ddomain if\n     * the dest was unable to complete migration.\n     */\n    VIR_DEBUG(\"Finish3 %p ret=%d\", dconn, ret);\n    VIR_FREE(cookiein);\n    cookiein = g_steal_pointer(&cookieout);\n    cookieinlen = cookieoutlen;\n    cookieoutlen = 0;\n    if (useParams) {\n        if (virTypedParamsGetString(params, nparams,\n                                    VIR_MIGRATE_PARAM_DEST_NAME, NULL) <= 0 &&\n            virTypedParamsReplaceString(&params, &nparams,\n                                        VIR_MIGRATE_PARAM_DEST_NAME,\n                                        domain->name) < 0) {\n            ddomain = NULL;\n        } else {\n            ddomain = dconn->driver->domainMigrateFinish3Params\n                (dconn, params, nparams, cookiein, cookieinlen,\n                 &cookieout, &cookieoutlen, destflags, cancelled);\n        }\n    } else {\n        dname = dname ? dname : domain->name;\n        ddomain = dconn->driver->domainMigrateFinish3\n            (dconn, dname, cookiein, cookieinlen, &cookieout, &cookieoutlen,\n             NULL, uri, destflags, cancelled);\n    }\n\n    if (cancelled) {\n        if (ddomain) {\n            VIR_ERROR(_(\"finish step ignored that migration was cancelled\"));\n        } else {\n            /* If Finish reported a useful error, use it instead of the\n             * original \"migration unexpectedly failed\" error.\n             *\n             * This is ugly but we can't do better with the APIs we have. We\n             * only replace the error if Finish was called with cancelled == 1\n             * and reported a real error (old libvirt would report an error\n             * from RPC instead of MIGRATE_FINISH_OK), which only happens when\n             * the domain died on destination. To further reduce a possibility\n             * of false positives we also check that Perform returned\n             * VIR_ERR_OPERATION_FAILED.\n             */\n            if (orig_err &&\n                orig_err->domain == VIR_FROM_QEMU &&\n                orig_err->code == VIR_ERR_OPERATION_FAILED) {\n                virErrorPtr err = virGetLastError();\n                if (err &&\n                    err->domain == VIR_FROM_QEMU &&\n                    err->code != VIR_ERR_MIGRATE_FINISH_OK) {\n                    virFreeError(orig_err);\n                    orig_err = NULL;\n                }\n            }\n        }\n    }\n\n    /* If ddomain is NULL, then we were unable to start\n     * the guest on the target, and must restart on the\n     * source. There is a small chance that the ddomain\n     * is NULL due to an RPC failure, in which case\n     * ddomain could in fact be running on the dest.\n     * The lock manager plugins should take care of\n     * safety in this scenario.\n     */\n    cancelled = ddomain == NULL ? 1 : 0;\n\n    /* If finish3 set an error, and we don't have an earlier\n     * one we need to preserve it in case confirm3 overwrites\n     */\n    if (!orig_err)\n        virErrorPreserveLast(&orig_err);\n\n confirm:\n    /*\n     * If cancelled, then src VM will be restarted, else it will be killed.\n     * Don't do this if migration failed on source and thus it was already\n     * cancelled there.\n     */\n    if (notify_source) {\n        VIR_DEBUG(\"Confirm3 %p ret=%d domain=%p\", domain->conn, ret, domain);\n        VIR_FREE(cookiein);\n        cookiein = g_steal_pointer(&cookieout);\n        cookieinlen = cookieoutlen;\n        cookieoutlen = 0;\n        if (useParams) {\n            ret = domain->conn->driver->domainMigrateConfirm3Params\n                (domain, params, nparams, cookiein, cookieinlen,\n                 flags | protection, cancelled);\n        } else {\n            ret = domain->conn->driver->domainMigrateConfirm3\n                (domain, cookiein, cookieinlen,\n                 flags | protection, cancelled);\n        }\n        /* If Confirm3 returns -1, there's nothing more we can\n         * do, but fortunately worst case is that there is a\n         * domain left in 'paused' state on source.\n         */\n        if (ret < 0) {\n            VIR_WARN(\"Guest %s probably left in 'paused' state on source\",\n                     domain->name);\n        }\n    }\n\n done:\n    virErrorRestore(&orig_err);\n    VIR_FREE(dom_xml);\n    VIR_FREE(uri_out);\n    VIR_FREE(cookiein);\n    VIR_FREE(cookieout);\n    virTypedParamsFree(params, nparams);\n    return ddomain;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nstatic virDomainPtr\nvirDomainMigrateVersion3Full(virDomainPtr domain,\n                             virConnectPtr dconn,\n                             const char *xmlin,\n                             const char *dname,\n                             const char *uri,\n                             unsigned long long bandwidth,\n                             virTypedParameterPtr params,\n                             int nparams,\n                             bool useParams,\n                             unsigned int flags)\n{\n    virDomainPtr ddomain = NULL;\n    char *uri_out = NULL;\n    char *cookiein = NULL;\n    char *cookieout = NULL;\n    char *dom_xml = NULL;\n    int cookieinlen = 0;\n    int cookieoutlen = 0;\n    int ret;\n    virDomainInfo info;\n    virErrorPtr orig_err = NULL;\n    int cancelled = 1;\n    unsigned long protection = 0;\n    bool notify_source = true;\n    unsigned int destflags;\n    int state;\n    virTypedParameterPtr tmp;\n\n    VIR_DOMAIN_DEBUG(domain,\n                     \"dconn=%p, xmlin=%s, dname=%s, uri=%s, bandwidth=%llu, \"\n                     \"params=%p, nparams=%d, useParams=%d, flags=0x%x\",\n                     dconn, NULLSTR(xmlin), NULLSTR(dname), NULLSTR(uri),\n                     bandwidth, params, nparams, useParams, flags);\n    VIR_TYPED_PARAMS_DEBUG(params, nparams);\n\n    if ((!useParams &&\n         (!domain->conn->driver->domainMigrateBegin3 ||\n          !domain->conn->driver->domainMigratePerform3 ||\n          !domain->conn->driver->domainMigrateConfirm3 ||\n          !dconn->driver->domainMigratePrepare3 ||\n          !dconn->driver->domainMigrateFinish3)) ||\n        (useParams &&\n         (!domain->conn->driver->domainMigrateBegin3Params ||\n          !domain->conn->driver->domainMigratePerform3Params ||\n          !domain->conn->driver->domainMigrateConfirm3Params ||\n          !dconn->driver->domainMigratePrepare3Params ||\n          !dconn->driver->domainMigrateFinish3Params))) {\n        virReportUnsupportedError();\n        return NULL;\n    }\n\n    if (virTypedParamsCopy(&tmp, params, nparams) < 0)\n        return NULL;\n    params = tmp;\n\n    if (VIR_DRV_SUPPORTS_FEATURE(domain->conn->driver, domain->conn,\n                                 VIR_DRV_FEATURE_MIGRATE_CHANGE_PROTECTION))\n        protection = VIR_MIGRATE_CHANGE_PROTECTION;\n\n    VIR_DEBUG(\"Begin3 %p\", domain->conn);\n    if (useParams) {\n        dom_xml = domain->conn->driver->domainMigrateBegin3Params\n            (domain, params, nparams, &cookieout, &cookieoutlen,\n             flags | protection);\n    } else {\n        dom_xml = domain->conn->driver->domainMigrateBegin3\n            (domain, xmlin, &cookieout, &cookieoutlen,\n             flags | protection, dname, bandwidth);\n    }\n    if (!dom_xml)\n        goto done;\n\n    if (useParams) {\n        /* If source is new enough to support extensible migration parameters,\n         * it's certainly new enough to support virDomainGetState. */\n        ret = virDomainGetState(domain, &state, NULL, 0);\n    } else {\n        ret = virDomainGetInfo(domain, &info);\n        state = info.state;\n    }\n    if (ret == 0 && state == VIR_DOMAIN_PAUSED)\n        flags |= VIR_MIGRATE_PAUSED;\n\n    destflags = flags & ~(VIR_MIGRATE_ABORT_ON_ERROR |\n                          VIR_MIGRATE_AUTO_CONVERGE);\n\n    VIR_DEBUG(\"Prepare3 %p flags=0x%x\", dconn, destflags);\n    cookiein = g_steal_pointer(&cookieout);\n    cookieinlen = cookieoutlen;\n    cookieoutlen = 0;\n    if (useParams) {\n        if (virTypedParamsReplaceString(&params, &nparams,\n                                        VIR_MIGRATE_PARAM_DEST_XML,\n                                        dom_xml) < 0)\n            goto done;\n        ret = dconn->driver->domainMigratePrepare3Params\n            (dconn, params, nparams, cookiein, cookieinlen,\n             &cookieout, &cookieoutlen, &uri_out, destflags);\n    } else {\n        ret = dconn->driver->domainMigratePrepare3\n            (dconn, cookiein, cookieinlen, &cookieout, &cookieoutlen,\n             uri, &uri_out, destflags, dname, bandwidth, dom_xml);\n    }\n    if (ret == -1) {\n        if (protection) {\n            /* Begin already started a migration job so we need to cancel it by\n             * calling Confirm while making sure it doesn't overwrite the error\n             */\n            virErrorPreserveLast(&orig_err);\n            goto confirm;\n        } else {\n            goto done;\n        }\n    }\n\n    /* Did domainMigratePrepare3 change URI? */\n    if (uri_out) {\n        uri = uri_out;\n        if (useParams &&\n            virTypedParamsReplaceString(&params, &nparams,\n                                        VIR_MIGRATE_PARAM_URI,\n                                        uri_out) < 0) {\n            cancelled = 1;\n            virErrorPreserveLast(&orig_err);\n            goto finish;\n        }\n    } else if (!uri &&\n               virTypedParamsGetString(params, nparams,\n                                       VIR_MIGRATE_PARAM_URI, &uri) <= 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"domainMigratePrepare3 did not set uri\"));\n        cancelled = 1;\n        virErrorPreserveLast(&orig_err);\n        goto finish;\n    }\n\n    if (flags & VIR_MIGRATE_OFFLINE) {\n        VIR_DEBUG(\"Offline migration, skipping Perform phase\");\n        VIR_FREE(cookieout);\n        cookieoutlen = 0;\n        cancelled = 0;\n        goto finish;\n    }\n\n    /* Perform the migration.  The driver isn't supposed to return\n     * until the migration is complete. The src VM should remain\n     * running, but in paused state until the destination can\n     * confirm migration completion.\n     */\n    VIR_DEBUG(\"Perform3 %p uri=%s\", domain->conn, uri);\n    VIR_FREE(cookiein);\n    cookiein = g_steal_pointer(&cookieout);\n    cookieinlen = cookieoutlen;\n    cookieoutlen = 0;\n    /* dconnuri not relevant in non-P2P modes, so left NULL here */\n    if (useParams) {\n        ret = domain->conn->driver->domainMigratePerform3Params\n            (domain, NULL, params, nparams, cookiein, cookieinlen,\n             &cookieout, &cookieoutlen, flags | protection);\n    } else {\n        ret = domain->conn->driver->domainMigratePerform3\n            (domain, NULL, cookiein, cookieinlen,\n             &cookieout, &cookieoutlen, NULL,\n             uri, flags | protection, dname, bandwidth);\n    }\n\n    /* Perform failed. Make sure Finish doesn't overwrite the error */\n    if (ret < 0) {\n        virErrorPreserveLast(&orig_err);\n        /* Perform failed so we don't need to call confirm to let source know\n         * about the failure.\n         */\n        notify_source = false;\n    }\n\n    /* If Perform returns < 0, then we need to cancel the VM\n     * startup on the destination\n     */\n    cancelled = ret < 0 ? 1 : 0;\n\n finish:\n    /*\n     * The status code from the source is passed to the destination.\n     * The dest can cleanup if the source indicated it failed to\n     * send all migration data. Returns NULL for ddomain if\n     * the dest was unable to complete migration.\n     */\n    VIR_DEBUG(\"Finish3 %p ret=%d\", dconn, ret);\n    VIR_FREE(cookiein);\n    cookiein = g_steal_pointer(&cookieout);\n    cookieinlen = cookieoutlen;\n    cookieoutlen = 0;\n    if (useParams) {\n        if (virTypedParamsGetString(params, nparams,\n                                    VIR_MIGRATE_PARAM_DEST_NAME, NULL) <= 0 &&\n            virTypedParamsReplaceString(&params, &nparams,\n                                        VIR_MIGRATE_PARAM_DEST_NAME,\n                                        domain->name) < 0) {\n            ddomain = NULL;\n        } else {\n            ddomain = dconn->driver->domainMigrateFinish3Params\n                (dconn, params, nparams, cookiein, cookieinlen,\n                 &cookieout, &cookieoutlen, destflags, cancelled);\n        }\n    } else {\n        dname = dname ? dname : domain->name;\n        ddomain = dconn->driver->domainMigrateFinish3\n            (dconn, dname, cookiein, cookieinlen, &cookieout, &cookieoutlen,\n             NULL, uri, destflags, cancelled);\n    }\n\n    if (cancelled) {\n        if (ddomain) {\n            VIR_ERROR(_(\"finish step ignored that migration was cancelled\"));\n        } else {\n            /* If Finish reported a useful error, use it instead of the\n             * original \"migration unexpectedly failed\" error.\n             *\n             * This is ugly but we can't do better with the APIs we have. We\n             * only replace the error if Finish was called with cancelled == 1\n             * and reported a real error (old libvirt would report an error\n             * from RPC instead of MIGRATE_FINISH_OK), which only happens when\n             * the domain died on destination. To further reduce a possibility\n             * of false positives we also check that Perform returned\n             * VIR_ERR_OPERATION_FAILED.\n             */\n            if (orig_err &&\n                orig_err->domain == VIR_FROM_QEMU &&\n                orig_err->code == VIR_ERR_OPERATION_FAILED) {\n                virErrorPtr err = virGetLastError();\n                if (err &&\n                    err->domain == VIR_FROM_QEMU &&\n                    err->code != VIR_ERR_MIGRATE_FINISH_OK) {\n                    virFreeError(orig_err);\n                    orig_err = NULL;\n                }\n            }\n        }\n    }\n\n    /* If ddomain is NULL, then we were unable to start\n     * the guest on the target, and must restart on the\n     * source. There is a small chance that the ddomain\n     * is NULL due to an RPC failure, in which case\n     * ddomain could in fact be running on the dest.\n     * The lock manager plugins should take care of\n     * safety in this scenario.\n     */\n    cancelled = ddomain == NULL ? 1 : 0;\n\n    /* If finish3 set an error, and we don't have an earlier\n     * one we need to preserve it in case confirm3 overwrites\n     */\n    if (!orig_err)\n        virErrorPreserveLast(&orig_err);\n\n confirm:\n    /*\n     * If cancelled, then src VM will be restarted, else it will be killed.\n     * Don't do this if migration failed on source and thus it was already\n     * cancelled there.\n     */\n    if (notify_source) {\n        VIR_DEBUG(\"Confirm3 %p ret=%d domain=%p\", domain->conn, ret, domain);\n        VIR_FREE(cookiein);\n        cookiein = g_steal_pointer(&cookieout);\n        cookieinlen = cookieoutlen;\n        cookieoutlen = 0;\n        if (useParams) {\n            ret = domain->conn->driver->domainMigrateConfirm3Params\n                (domain, params, nparams, cookiein, cookieinlen,\n                 flags | protection, cancelled);\n        } else {\n            ret = domain->conn->driver->domainMigrateConfirm3\n                (domain, cookiein, cookieinlen,\n                 flags | protection, cancelled);\n        }\n        /* If Confirm3 returns -1, there's nothing more we can\n         * do, but fortunately worst case is that there is a\n         * domain left in 'paused' state on source.\n         */\n        if (ret < 0) {\n            VIR_WARN(\"Guest %s probably left in 'paused' state on source\",\n                     domain->name);\n        }\n    }\n\n done:\n    virErrorRestore(&orig_err);\n    VIR_FREE(dom_xml);\n    VIR_FREE(uri_out);\n    VIR_FREE(cookiein);\n    VIR_FREE(cookieout);\n    virTypedParamsFree(params, nparams);\n    return ddomain;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nstatic virDomainPtr\nvirDomainMigrateVersion3(virDomainPtr domain,\n                         virConnectPtr dconn,\n                         const char *xmlin,\n                         unsigned long flags,\n                         const char *dname,\n                         const char *uri,\n                         unsigned long bandwidth)\n{\n    return virDomainMigrateVersion3Full(domain, dconn, xmlin, dname, uri,\n                                        bandwidth, NULL, 0, false, flags);\n}"
  },
  {
    "function_name": "virDomainMigrateVersion3Full",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "2961-3257",
    "snippet": "static virDomainPtr\nvirDomainMigrateVersion3Full(virDomainPtr domain,\n                             virConnectPtr dconn,\n                             const char *xmlin,\n                             const char *dname,\n                             const char *uri,\n                             unsigned long long bandwidth,\n                             virTypedParameterPtr params,\n                             int nparams,\n                             bool useParams,\n                             unsigned int flags)\n{\n    virDomainPtr ddomain = NULL;\n    char *uri_out = NULL;\n    char *cookiein = NULL;\n    char *cookieout = NULL;\n    char *dom_xml = NULL;\n    int cookieinlen = 0;\n    int cookieoutlen = 0;\n    int ret;\n    virDomainInfo info;\n    virErrorPtr orig_err = NULL;\n    int cancelled = 1;\n    unsigned long protection = 0;\n    bool notify_source = true;\n    unsigned int destflags;\n    int state;\n    virTypedParameterPtr tmp;\n\n    VIR_DOMAIN_DEBUG(domain,\n                     \"dconn=%p, xmlin=%s, dname=%s, uri=%s, bandwidth=%llu, \"\n                     \"params=%p, nparams=%d, useParams=%d, flags=0x%x\",\n                     dconn, NULLSTR(xmlin), NULLSTR(dname), NULLSTR(uri),\n                     bandwidth, params, nparams, useParams, flags);\n    VIR_TYPED_PARAMS_DEBUG(params, nparams);\n\n    if ((!useParams &&\n         (!domain->conn->driver->domainMigrateBegin3 ||\n          !domain->conn->driver->domainMigratePerform3 ||\n          !domain->conn->driver->domainMigrateConfirm3 ||\n          !dconn->driver->domainMigratePrepare3 ||\n          !dconn->driver->domainMigrateFinish3)) ||\n        (useParams &&\n         (!domain->conn->driver->domainMigrateBegin3Params ||\n          !domain->conn->driver->domainMigratePerform3Params ||\n          !domain->conn->driver->domainMigrateConfirm3Params ||\n          !dconn->driver->domainMigratePrepare3Params ||\n          !dconn->driver->domainMigrateFinish3Params))) {\n        virReportUnsupportedError();\n        return NULL;\n    }\n\n    if (virTypedParamsCopy(&tmp, params, nparams) < 0)\n        return NULL;\n    params = tmp;\n\n    if (VIR_DRV_SUPPORTS_FEATURE(domain->conn->driver, domain->conn,\n                                 VIR_DRV_FEATURE_MIGRATE_CHANGE_PROTECTION))\n        protection = VIR_MIGRATE_CHANGE_PROTECTION;\n\n    VIR_DEBUG(\"Begin3 %p\", domain->conn);\n    if (useParams) {\n        dom_xml = domain->conn->driver->domainMigrateBegin3Params\n            (domain, params, nparams, &cookieout, &cookieoutlen,\n             flags | protection);\n    } else {\n        dom_xml = domain->conn->driver->domainMigrateBegin3\n            (domain, xmlin, &cookieout, &cookieoutlen,\n             flags | protection, dname, bandwidth);\n    }\n    if (!dom_xml)\n        goto done;\n\n    if (useParams) {\n        /* If source is new enough to support extensible migration parameters,\n         * it's certainly new enough to support virDomainGetState. */\n        ret = virDomainGetState(domain, &state, NULL, 0);\n    } else {\n        ret = virDomainGetInfo(domain, &info);\n        state = info.state;\n    }\n    if (ret == 0 && state == VIR_DOMAIN_PAUSED)\n        flags |= VIR_MIGRATE_PAUSED;\n\n    destflags = flags & ~(VIR_MIGRATE_ABORT_ON_ERROR |\n                          VIR_MIGRATE_AUTO_CONVERGE);\n\n    VIR_DEBUG(\"Prepare3 %p flags=0x%x\", dconn, destflags);\n    cookiein = g_steal_pointer(&cookieout);\n    cookieinlen = cookieoutlen;\n    cookieoutlen = 0;\n    if (useParams) {\n        if (virTypedParamsReplaceString(&params, &nparams,\n                                        VIR_MIGRATE_PARAM_DEST_XML,\n                                        dom_xml) < 0)\n            goto done;\n        ret = dconn->driver->domainMigratePrepare3Params\n            (dconn, params, nparams, cookiein, cookieinlen,\n             &cookieout, &cookieoutlen, &uri_out, destflags);\n    } else {\n        ret = dconn->driver->domainMigratePrepare3\n            (dconn, cookiein, cookieinlen, &cookieout, &cookieoutlen,\n             uri, &uri_out, destflags, dname, bandwidth, dom_xml);\n    }\n    if (ret == -1) {\n        if (protection) {\n            /* Begin already started a migration job so we need to cancel it by\n             * calling Confirm while making sure it doesn't overwrite the error\n             */\n            virErrorPreserveLast(&orig_err);\n            goto confirm;\n        } else {\n            goto done;\n        }\n    }\n\n    /* Did domainMigratePrepare3 change URI? */\n    if (uri_out) {\n        uri = uri_out;\n        if (useParams &&\n            virTypedParamsReplaceString(&params, &nparams,\n                                        VIR_MIGRATE_PARAM_URI,\n                                        uri_out) < 0) {\n            cancelled = 1;\n            virErrorPreserveLast(&orig_err);\n            goto finish;\n        }\n    } else if (!uri &&\n               virTypedParamsGetString(params, nparams,\n                                       VIR_MIGRATE_PARAM_URI, &uri) <= 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"domainMigratePrepare3 did not set uri\"));\n        cancelled = 1;\n        virErrorPreserveLast(&orig_err);\n        goto finish;\n    }\n\n    if (flags & VIR_MIGRATE_OFFLINE) {\n        VIR_DEBUG(\"Offline migration, skipping Perform phase\");\n        VIR_FREE(cookieout);\n        cookieoutlen = 0;\n        cancelled = 0;\n        goto finish;\n    }\n\n    /* Perform the migration.  The driver isn't supposed to return\n     * until the migration is complete. The src VM should remain\n     * running, but in paused state until the destination can\n     * confirm migration completion.\n     */\n    VIR_DEBUG(\"Perform3 %p uri=%s\", domain->conn, uri);\n    VIR_FREE(cookiein);\n    cookiein = g_steal_pointer(&cookieout);\n    cookieinlen = cookieoutlen;\n    cookieoutlen = 0;\n    /* dconnuri not relevant in non-P2P modes, so left NULL here */\n    if (useParams) {\n        ret = domain->conn->driver->domainMigratePerform3Params\n            (domain, NULL, params, nparams, cookiein, cookieinlen,\n             &cookieout, &cookieoutlen, flags | protection);\n    } else {\n        ret = domain->conn->driver->domainMigratePerform3\n            (domain, NULL, cookiein, cookieinlen,\n             &cookieout, &cookieoutlen, NULL,\n             uri, flags | protection, dname, bandwidth);\n    }\n\n    /* Perform failed. Make sure Finish doesn't overwrite the error */\n    if (ret < 0) {\n        virErrorPreserveLast(&orig_err);\n        /* Perform failed so we don't need to call confirm to let source know\n         * about the failure.\n         */\n        notify_source = false;\n    }\n\n    /* If Perform returns < 0, then we need to cancel the VM\n     * startup on the destination\n     */\n    cancelled = ret < 0 ? 1 : 0;\n\n finish:\n    /*\n     * The status code from the source is passed to the destination.\n     * The dest can cleanup if the source indicated it failed to\n     * send all migration data. Returns NULL for ddomain if\n     * the dest was unable to complete migration.\n     */\n    VIR_DEBUG(\"Finish3 %p ret=%d\", dconn, ret);\n    VIR_FREE(cookiein);\n    cookiein = g_steal_pointer(&cookieout);\n    cookieinlen = cookieoutlen;\n    cookieoutlen = 0;\n    if (useParams) {\n        if (virTypedParamsGetString(params, nparams,\n                                    VIR_MIGRATE_PARAM_DEST_NAME, NULL) <= 0 &&\n            virTypedParamsReplaceString(&params, &nparams,\n                                        VIR_MIGRATE_PARAM_DEST_NAME,\n                                        domain->name) < 0) {\n            ddomain = NULL;\n        } else {\n            ddomain = dconn->driver->domainMigrateFinish3Params\n                (dconn, params, nparams, cookiein, cookieinlen,\n                 &cookieout, &cookieoutlen, destflags, cancelled);\n        }\n    } else {\n        dname = dname ? dname : domain->name;\n        ddomain = dconn->driver->domainMigrateFinish3\n            (dconn, dname, cookiein, cookieinlen, &cookieout, &cookieoutlen,\n             NULL, uri, destflags, cancelled);\n    }\n\n    if (cancelled) {\n        if (ddomain) {\n            VIR_ERROR(_(\"finish step ignored that migration was cancelled\"));\n        } else {\n            /* If Finish reported a useful error, use it instead of the\n             * original \"migration unexpectedly failed\" error.\n             *\n             * This is ugly but we can't do better with the APIs we have. We\n             * only replace the error if Finish was called with cancelled == 1\n             * and reported a real error (old libvirt would report an error\n             * from RPC instead of MIGRATE_FINISH_OK), which only happens when\n             * the domain died on destination. To further reduce a possibility\n             * of false positives we also check that Perform returned\n             * VIR_ERR_OPERATION_FAILED.\n             */\n            if (orig_err &&\n                orig_err->domain == VIR_FROM_QEMU &&\n                orig_err->code == VIR_ERR_OPERATION_FAILED) {\n                virErrorPtr err = virGetLastError();\n                if (err &&\n                    err->domain == VIR_FROM_QEMU &&\n                    err->code != VIR_ERR_MIGRATE_FINISH_OK) {\n                    virFreeError(orig_err);\n                    orig_err = NULL;\n                }\n            }\n        }\n    }\n\n    /* If ddomain is NULL, then we were unable to start\n     * the guest on the target, and must restart on the\n     * source. There is a small chance that the ddomain\n     * is NULL due to an RPC failure, in which case\n     * ddomain could in fact be running on the dest.\n     * The lock manager plugins should take care of\n     * safety in this scenario.\n     */\n    cancelled = ddomain == NULL ? 1 : 0;\n\n    /* If finish3 set an error, and we don't have an earlier\n     * one we need to preserve it in case confirm3 overwrites\n     */\n    if (!orig_err)\n        virErrorPreserveLast(&orig_err);\n\n confirm:\n    /*\n     * If cancelled, then src VM will be restarted, else it will be killed.\n     * Don't do this if migration failed on source and thus it was already\n     * cancelled there.\n     */\n    if (notify_source) {\n        VIR_DEBUG(\"Confirm3 %p ret=%d domain=%p\", domain->conn, ret, domain);\n        VIR_FREE(cookiein);\n        cookiein = g_steal_pointer(&cookieout);\n        cookieinlen = cookieoutlen;\n        cookieoutlen = 0;\n        if (useParams) {\n            ret = domain->conn->driver->domainMigrateConfirm3Params\n                (domain, params, nparams, cookiein, cookieinlen,\n                 flags | protection, cancelled);\n        } else {\n            ret = domain->conn->driver->domainMigrateConfirm3\n                (domain, cookiein, cookieinlen,\n                 flags | protection, cancelled);\n        }\n        /* If Confirm3 returns -1, there's nothing more we can\n         * do, but fortunately worst case is that there is a\n         * domain left in 'paused' state on source.\n         */\n        if (ret < 0) {\n            VIR_WARN(\"Guest %s probably left in 'paused' state on source\",\n                     domain->name);\n        }\n    }\n\n done:\n    virErrorRestore(&orig_err);\n    VIR_FREE(dom_xml);\n    VIR_FREE(uri_out);\n    VIR_FREE(cookiein);\n    VIR_FREE(cookieout);\n    virTypedParamsFree(params, nparams);\n    return ddomain;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virTypedParamsFree",
          "args": [
            "params",
            "nparams"
          ],
          "line": 3255
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParamsFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam-public.c",
          "lines": "878-884",
          "snippet": "void\nvirTypedParamsFree(virTypedParameterPtr params,\n                   int nparams)\n{\n    virTypedParamsClear(params, nparams);\n    VIR_FREE(params);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtypedparam.h\"\n#include <config.h>\n\nvoid\nvirTypedParamsFree(virTypedParameterPtr params,\n                   int nparams)\n{\n    virTypedParamsClear(params, nparams);\n    VIR_FREE(params);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "cookieout"
          ],
          "line": 3254
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "cookiein"
          ],
          "line": 3253
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "uri_out"
          ],
          "line": 3252
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "dom_xml"
          ],
          "line": 3251
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virErrorRestore",
          "args": [
            "&orig_err"
          ],
          "line": 3250
        },
        "resolved": true,
        "details": {
          "function_name": "virErrorRestore",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "445-457",
          "snippet": "void\nvirErrorRestore(virErrorPtr *savederr)\n{\n    int saved_errno = errno;\n\n    if (!*savederr)\n        return;\n\n    virSetError(*savederr);\n    virFreeError(*savederr);\n    *savederr = NULL;\n    errno = saved_errno;\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirErrorRestore(virErrorPtr *savederr)\n{\n    int saved_errno = errno;\n\n    if (!*savederr)\n        return;\n\n    virSetError(*savederr);\n    virFreeError(*savederr);\n    *savederr = NULL;\n    errno = saved_errno;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_WARN",
          "args": [
            "\"Guest %s probably left in 'paused' state on source\"",
            "domain->name"
          ],
          "line": 3244
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "domain->conn->driver->domainMigrateConfirm3",
          "args": [
            "domain",
            "cookiein",
            "cookieinlen",
            "flags | protection",
            "cancelled"
          ],
          "line": 3235
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "domain->conn->driver->domainMigrateConfirm3Params",
          "args": [
            "domain",
            "params",
            "nparams",
            "cookiein",
            "cookieinlen",
            "flags | protection",
            "cancelled"
          ],
          "line": 3231
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_steal_pointer",
          "args": [
            "&cookieout"
          ],
          "line": 3227
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "cookiein"
          ],
          "line": 3226
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Confirm3 %p ret=%d domain=%p\"",
            "domain->conn",
            "ret",
            "domain"
          ],
          "line": 3225
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virErrorPreserveLast",
          "args": [
            "&orig_err"
          ],
          "line": 3216
        },
        "resolved": true,
        "details": {
          "function_name": "virErrorPreserveLast",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "424-436",
          "snippet": "void\nvirErrorPreserveLast(virErrorPtr *saveerr)\n{\n    int saved_errno = errno;\n    virErrorPtr lasterr = virGetLastError();\n\n    *saveerr = NULL;\n\n    if (lasterr)\n        *saveerr = virErrorCopyNew(lasterr);\n\n    errno = saved_errno;\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirErrorPreserveLast(virErrorPtr *saveerr)\n{\n    int saved_errno = errno;\n    virErrorPtr lasterr = virGetLastError();\n\n    *saveerr = NULL;\n\n    if (lasterr)\n        *saveerr = virErrorCopyNew(lasterr);\n\n    errno = saved_errno;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virFreeError",
          "args": [
            "orig_err"
          ],
          "line": 3195
        },
        "resolved": true,
        "details": {
          "function_name": "virFreeError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "484-489",
          "snippet": "void\nvirFreeError(virErrorPtr err)\n{\n    virResetError(err);\n    VIR_FREE(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirFreeError(virErrorPtr err)\n{\n    virResetError(err);\n    VIR_FREE(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virGetLastError",
          "args": [],
          "line": 3191
        },
        "resolved": true,
        "details": {
          "function_name": "virGetLastErrorMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "316-325",
          "snippet": "const char *\nvirGetLastErrorMessage(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err && err->code == VIR_ERR_OK)\n        return _(\"no error\");\n    if (!err || !err->message)\n        return _(\"unknown error\");\n    return err->message;\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nconst char *\nvirGetLastErrorMessage(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err && err->code == VIR_ERR_OK)\n        return _(\"no error\");\n    if (!err || !err->message)\n        return _(\"unknown error\");\n    return err->message;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_ERROR",
          "args": [
            "_(\"finish step ignored that migration was cancelled\")"
          ],
          "line": 3175
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"finish step ignored that migration was cancelled\""
          ],
          "line": 3175
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "dconn->driver->domainMigrateFinish3",
          "args": [
            "dconn",
            "dname",
            "cookiein",
            "cookieinlen",
            "&cookieout",
            "&cookieoutlen",
            "NULL",
            "uri",
            "destflags",
            "cancelled"
          ],
          "line": 3168
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dconn->driver->domainMigrateFinish3Params",
          "args": [
            "dconn",
            "params",
            "nparams",
            "cookiein",
            "cookieinlen",
            "&cookieout",
            "&cookieoutlen",
            "destflags",
            "cancelled"
          ],
          "line": 3162
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virTypedParamsReplaceString",
          "args": [
            "&params",
            "&nparams",
            "VIR_MIGRATE_PARAM_DEST_NAME",
            "domain->name"
          ],
          "line": 3157
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParamsReplaceString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam.c",
          "lines": "312-350",
          "snippet": "int\nvirTypedParamsReplaceString(virTypedParameterPtr *params,\n                            int *nparams,\n                            const char *name,\n                            const char *value)\n{\n    char *str = NULL;\n    char *old = NULL;\n    size_t n = *nparams;\n    virTypedParameterPtr param;\n\n    param = virTypedParamsGet(*params, n, name);\n    if (param) {\n        if (param->type != VIR_TYPED_PARAM_STRING) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Parameter '%s' is not a string\"),\n                           param->field);\n            return -1;\n        }\n        old = param->value.s;\n    } else {\n        if (VIR_EXPAND_N(*params, n, 1) < 0)\n            return -1;\n        param = *params + n - 1;\n    }\n\n    str = g_strdup(value);\n\n    if (virTypedParameterAssign(param, name,\n                                VIR_TYPED_PARAM_STRING, str) < 0) {\n        param->value.s = old;\n        VIR_FREE(str);\n        return -1;\n    }\n    VIR_FREE(old);\n\n    *nparams = n;\n    return 0;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <stdarg.h>",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <stdarg.h>\n#include \"virtypedparam.h\"\n#include <config.h>\n\nint\nvirTypedParamsReplaceString(virTypedParameterPtr *params,\n                            int *nparams,\n                            const char *name,\n                            const char *value)\n{\n    char *str = NULL;\n    char *old = NULL;\n    size_t n = *nparams;\n    virTypedParameterPtr param;\n\n    param = virTypedParamsGet(*params, n, name);\n    if (param) {\n        if (param->type != VIR_TYPED_PARAM_STRING) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Parameter '%s' is not a string\"),\n                           param->field);\n            return -1;\n        }\n        old = param->value.s;\n    } else {\n        if (VIR_EXPAND_N(*params, n, 1) < 0)\n            return -1;\n        param = *params + n - 1;\n    }\n\n    str = g_strdup(value);\n\n    if (virTypedParameterAssign(param, name,\n                                VIR_TYPED_PARAM_STRING, str) < 0) {\n        param->value.s = old;\n        VIR_FREE(str);\n        return -1;\n    }\n    VIR_FREE(old);\n\n    *nparams = n;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virTypedParamsGetString",
          "args": [
            "params",
            "nparams",
            "VIR_MIGRATE_PARAM_DEST_NAME",
            "NULL"
          ],
          "line": 3155
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParamsGetStringList",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam.c",
          "lines": "432-467",
          "snippet": "int\nvirTypedParamsGetStringList(virTypedParameterPtr params,\n                            int nparams,\n                            const char *name,\n                            const char ***values)\n{\n    size_t i, n;\n    int nfiltered;\n    virTypedParameterPtr *filtered = NULL;\n\n    virCheckNonNullArgGoto(values, error);\n    *values = NULL;\n\n    nfiltered = virTypedParamsFilter(params, nparams, name, &filtered);\n\n    if (nfiltered < 0)\n        goto error;\n\n    if (nfiltered &&\n        VIR_ALLOC_N(*values, nfiltered) < 0)\n        goto error;\n\n    for (n = 0, i = 0; i < nfiltered; i++) {\n        if (filtered[i]->type == VIR_TYPED_PARAM_STRING)\n            (*values)[n++] = filtered[i]->value.s;\n    }\n\n    VIR_FREE(filtered);\n    return n;\n\n error:\n    if (values)\n        VIR_FREE(*values);\n    VIR_FREE(filtered);\n    return -1;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <stdarg.h>",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <stdarg.h>\n#include \"virtypedparam.h\"\n#include <config.h>\n\nint\nvirTypedParamsGetStringList(virTypedParameterPtr params,\n                            int nparams,\n                            const char *name,\n                            const char ***values)\n{\n    size_t i, n;\n    int nfiltered;\n    virTypedParameterPtr *filtered = NULL;\n\n    virCheckNonNullArgGoto(values, error);\n    *values = NULL;\n\n    nfiltered = virTypedParamsFilter(params, nparams, name, &filtered);\n\n    if (nfiltered < 0)\n        goto error;\n\n    if (nfiltered &&\n        VIR_ALLOC_N(*values, nfiltered) < 0)\n        goto error;\n\n    for (n = 0, i = 0; i < nfiltered; i++) {\n        if (filtered[i]->type == VIR_TYPED_PARAM_STRING)\n            (*values)[n++] = filtered[i]->value.s;\n    }\n\n    VIR_FREE(filtered);\n    return n;\n\n error:\n    if (values)\n        VIR_FREE(*values);\n    VIR_FREE(filtered);\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_steal_pointer",
          "args": [
            "&cookieout"
          ],
          "line": 3151
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "cookiein"
          ],
          "line": 3150
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Finish3 %p ret=%d\"",
            "dconn",
            "ret"
          ],
          "line": 3149
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "domain->conn->driver->domainMigratePerform3",
          "args": [
            "domain",
            "NULL",
            "cookiein",
            "cookieinlen",
            "&cookieout",
            "&cookieoutlen",
            "NULL",
            "uri",
            "flags | protection",
            "dname",
            "bandwidth"
          ],
          "line": 3122
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "domain->conn->driver->domainMigratePerform3Params",
          "args": [
            "domain",
            "NULL",
            "params",
            "nparams",
            "cookiein",
            "cookieinlen",
            "&cookieout",
            "&cookieoutlen",
            "flags | protection"
          ],
          "line": 3118
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_steal_pointer",
          "args": [
            "&cookieout"
          ],
          "line": 3113
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "cookiein"
          ],
          "line": 3112
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Perform3 %p uri=%s\"",
            "domain->conn",
            "uri"
          ],
          "line": 3111
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "cookieout"
          ],
          "line": 3100
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Offline migration, skipping Perform phase\""
          ],
          "line": 3099
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"domainMigratePrepare3 did not set uri\")"
          ],
          "line": 3091
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dconn->driver->domainMigratePrepare3",
          "args": [
            "dconn",
            "cookiein",
            "cookieinlen",
            "&cookieout",
            "&cookieoutlen",
            "uri",
            "&uri_out",
            "destflags",
            "dname",
            "bandwidth",
            "dom_xml"
          ],
          "line": 3061
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dconn->driver->domainMigratePrepare3Params",
          "args": [
            "dconn",
            "params",
            "nparams",
            "cookiein",
            "cookieinlen",
            "&cookieout",
            "&cookieoutlen",
            "&uri_out",
            "destflags"
          ],
          "line": 3057
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_steal_pointer",
          "args": [
            "&cookieout"
          ],
          "line": 3049
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Prepare3 %p flags=0x%x\"",
            "dconn",
            "destflags"
          ],
          "line": 3048
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainGetInfo",
          "args": [
            "domain",
            "&info"
          ],
          "line": 3039
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainGetInfo",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
          "lines": "2420-2450",
          "snippet": "int\nvirDomainGetInfo(virDomainPtr domain, virDomainInfoPtr info)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"info=%p\", info);\n\n    virResetLastError();\n\n    if (info)\n        memset(info, 0, sizeof(*info));\n\n    virCheckDomainReturn(domain, -1);\n    virCheckNonNullArgGoto(info, error);\n\n    conn = domain->conn;\n\n    if (conn->driver->domainGetInfo) {\n        int ret;\n        ret = conn->driver->domainGetInfo(domain, info);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainGetInfo(virDomainPtr domain, virDomainInfoPtr info)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"info=%p\", info);\n\n    virResetLastError();\n\n    if (info)\n        memset(info, 0, sizeof(*info));\n\n    virCheckDomainReturn(domain, -1);\n    virCheckNonNullArgGoto(info, error);\n\n    conn = domain->conn;\n\n    if (conn->driver->domainGetInfo) {\n        int ret;\n        ret = conn->driver->domainGetInfo(domain, info);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainGetState",
          "args": [
            "domain",
            "&state",
            "NULL",
            "0"
          ],
          "line": 3037
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainGetState",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
          "lines": "2466-2496",
          "snippet": "int\nvirDomainGetState(virDomainPtr domain,\n                  int *state,\n                  int *reason,\n                  unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"state=%p, reason=%p, flags=0x%x\",\n                     state, reason, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    virCheckNonNullArgGoto(state, error);\n\n    conn = domain->conn;\n    if (conn->driver->domainGetState) {\n        int ret;\n        ret = conn->driver->domainGetState(domain, state, reason, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainGetState(virDomainPtr domain,\n                  int *state,\n                  int *reason,\n                  unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"state=%p, reason=%p, flags=0x%x\",\n                     state, reason, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    virCheckNonNullArgGoto(state, error);\n\n    conn = domain->conn;\n    if (conn->driver->domainGetState) {\n        int ret;\n        ret = conn->driver->domainGetState(domain, state, reason, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "domain->conn->driver->domainMigrateBegin3",
          "args": [
            "domain",
            "xmlin",
            "&cookieout",
            "&cookieoutlen",
            "flags | protection",
            "dname",
            "bandwidth"
          ],
          "line": 3027
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "domain->conn->driver->domainMigrateBegin3Params",
          "args": [
            "domain",
            "params",
            "nparams",
            "&cookieout",
            "&cookieoutlen",
            "flags | protection"
          ],
          "line": 3023
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Begin3 %p\"",
            "domain->conn"
          ],
          "line": 3021
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DRV_SUPPORTS_FEATURE",
          "args": [
            "domain->conn->driver",
            "domain->conn",
            "VIR_DRV_FEATURE_MIGRATE_CHANGE_PROTECTION"
          ],
          "line": 3017
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virTypedParamsCopy",
          "args": [
            "&tmp",
            "params",
            "nparams"
          ],
          "line": 3013
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParamsCopy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam.c",
          "lines": "353-378",
          "snippet": "int\nvirTypedParamsCopy(virTypedParameterPtr *dst,\n                   virTypedParameterPtr src,\n                   int nparams)\n{\n    size_t i;\n\n    *dst = NULL;\n    if (!src || nparams <= 0)\n        return 0;\n\n    if (VIR_ALLOC_N(*dst, nparams) < 0)\n        return -1;\n\n    for (i = 0; i < nparams; i++) {\n        ignore_value(virStrcpyStatic((*dst)[i].field, src[i].field));\n        (*dst)[i].type = src[i].type;\n        if (src[i].type == VIR_TYPED_PARAM_STRING) {\n            (*dst)[i].value.s = g_strdup(src[i].value.s);\n        } else {\n            (*dst)[i].value = src[i].value;\n        }\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <stdarg.h>",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <stdarg.h>\n#include \"virtypedparam.h\"\n#include <config.h>\n\nint\nvirTypedParamsCopy(virTypedParameterPtr *dst,\n                   virTypedParameterPtr src,\n                   int nparams)\n{\n    size_t i;\n\n    *dst = NULL;\n    if (!src || nparams <= 0)\n        return 0;\n\n    if (VIR_ALLOC_N(*dst, nparams) < 0)\n        return -1;\n\n    for (i = 0; i < nparams; i++) {\n        ignore_value(virStrcpyStatic((*dst)[i].field, src[i].field));\n        (*dst)[i].type = src[i].type;\n        if (src[i].type == VIR_TYPED_PARAM_STRING) {\n            (*dst)[i].value.s = g_strdup(src[i].value.s);\n        } else {\n            (*dst)[i].value = src[i].value;\n        }\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 3009
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_TYPED_PARAMS_DEBUG",
          "args": [
            "params",
            "nparams"
          ],
          "line": 2995
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "domain",
            "\"dconn=%p, xmlin=%s, dname=%s, uri=%s, bandwidth=%llu, \"\n                     \"params=%p, nparams=%d, useParams=%d, flags=0x%x\"",
            "dconn",
            "NULLSTR(xmlin)",
            "NULLSTR(dname)",
            "NULLSTR(uri)",
            "bandwidth",
            "params",
            "nparams",
            "useParams",
            "flags"
          ],
          "line": 2990
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "uri"
          ],
          "line": 2993
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "dname"
          ],
          "line": 2993
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "xmlin"
          ],
          "line": 2993
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nstatic virDomainPtr\nvirDomainMigrateVersion3Full(virDomainPtr domain,\n                             virConnectPtr dconn,\n                             const char *xmlin,\n                             const char *dname,\n                             const char *uri,\n                             unsigned long long bandwidth,\n                             virTypedParameterPtr params,\n                             int nparams,\n                             bool useParams,\n                             unsigned int flags)\n{\n    virDomainPtr ddomain = NULL;\n    char *uri_out = NULL;\n    char *cookiein = NULL;\n    char *cookieout = NULL;\n    char *dom_xml = NULL;\n    int cookieinlen = 0;\n    int cookieoutlen = 0;\n    int ret;\n    virDomainInfo info;\n    virErrorPtr orig_err = NULL;\n    int cancelled = 1;\n    unsigned long protection = 0;\n    bool notify_source = true;\n    unsigned int destflags;\n    int state;\n    virTypedParameterPtr tmp;\n\n    VIR_DOMAIN_DEBUG(domain,\n                     \"dconn=%p, xmlin=%s, dname=%s, uri=%s, bandwidth=%llu, \"\n                     \"params=%p, nparams=%d, useParams=%d, flags=0x%x\",\n                     dconn, NULLSTR(xmlin), NULLSTR(dname), NULLSTR(uri),\n                     bandwidth, params, nparams, useParams, flags);\n    VIR_TYPED_PARAMS_DEBUG(params, nparams);\n\n    if ((!useParams &&\n         (!domain->conn->driver->domainMigrateBegin3 ||\n          !domain->conn->driver->domainMigratePerform3 ||\n          !domain->conn->driver->domainMigrateConfirm3 ||\n          !dconn->driver->domainMigratePrepare3 ||\n          !dconn->driver->domainMigrateFinish3)) ||\n        (useParams &&\n         (!domain->conn->driver->domainMigrateBegin3Params ||\n          !domain->conn->driver->domainMigratePerform3Params ||\n          !domain->conn->driver->domainMigrateConfirm3Params ||\n          !dconn->driver->domainMigratePrepare3Params ||\n          !dconn->driver->domainMigrateFinish3Params))) {\n        virReportUnsupportedError();\n        return NULL;\n    }\n\n    if (virTypedParamsCopy(&tmp, params, nparams) < 0)\n        return NULL;\n    params = tmp;\n\n    if (VIR_DRV_SUPPORTS_FEATURE(domain->conn->driver, domain->conn,\n                                 VIR_DRV_FEATURE_MIGRATE_CHANGE_PROTECTION))\n        protection = VIR_MIGRATE_CHANGE_PROTECTION;\n\n    VIR_DEBUG(\"Begin3 %p\", domain->conn);\n    if (useParams) {\n        dom_xml = domain->conn->driver->domainMigrateBegin3Params\n            (domain, params, nparams, &cookieout, &cookieoutlen,\n             flags | protection);\n    } else {\n        dom_xml = domain->conn->driver->domainMigrateBegin3\n            (domain, xmlin, &cookieout, &cookieoutlen,\n             flags | protection, dname, bandwidth);\n    }\n    if (!dom_xml)\n        goto done;\n\n    if (useParams) {\n        /* If source is new enough to support extensible migration parameters,\n         * it's certainly new enough to support virDomainGetState. */\n        ret = virDomainGetState(domain, &state, NULL, 0);\n    } else {\n        ret = virDomainGetInfo(domain, &info);\n        state = info.state;\n    }\n    if (ret == 0 && state == VIR_DOMAIN_PAUSED)\n        flags |= VIR_MIGRATE_PAUSED;\n\n    destflags = flags & ~(VIR_MIGRATE_ABORT_ON_ERROR |\n                          VIR_MIGRATE_AUTO_CONVERGE);\n\n    VIR_DEBUG(\"Prepare3 %p flags=0x%x\", dconn, destflags);\n    cookiein = g_steal_pointer(&cookieout);\n    cookieinlen = cookieoutlen;\n    cookieoutlen = 0;\n    if (useParams) {\n        if (virTypedParamsReplaceString(&params, &nparams,\n                                        VIR_MIGRATE_PARAM_DEST_XML,\n                                        dom_xml) < 0)\n            goto done;\n        ret = dconn->driver->domainMigratePrepare3Params\n            (dconn, params, nparams, cookiein, cookieinlen,\n             &cookieout, &cookieoutlen, &uri_out, destflags);\n    } else {\n        ret = dconn->driver->domainMigratePrepare3\n            (dconn, cookiein, cookieinlen, &cookieout, &cookieoutlen,\n             uri, &uri_out, destflags, dname, bandwidth, dom_xml);\n    }\n    if (ret == -1) {\n        if (protection) {\n            /* Begin already started a migration job so we need to cancel it by\n             * calling Confirm while making sure it doesn't overwrite the error\n             */\n            virErrorPreserveLast(&orig_err);\n            goto confirm;\n        } else {\n            goto done;\n        }\n    }\n\n    /* Did domainMigratePrepare3 change URI? */\n    if (uri_out) {\n        uri = uri_out;\n        if (useParams &&\n            virTypedParamsReplaceString(&params, &nparams,\n                                        VIR_MIGRATE_PARAM_URI,\n                                        uri_out) < 0) {\n            cancelled = 1;\n            virErrorPreserveLast(&orig_err);\n            goto finish;\n        }\n    } else if (!uri &&\n               virTypedParamsGetString(params, nparams,\n                                       VIR_MIGRATE_PARAM_URI, &uri) <= 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"domainMigratePrepare3 did not set uri\"));\n        cancelled = 1;\n        virErrorPreserveLast(&orig_err);\n        goto finish;\n    }\n\n    if (flags & VIR_MIGRATE_OFFLINE) {\n        VIR_DEBUG(\"Offline migration, skipping Perform phase\");\n        VIR_FREE(cookieout);\n        cookieoutlen = 0;\n        cancelled = 0;\n        goto finish;\n    }\n\n    /* Perform the migration.  The driver isn't supposed to return\n     * until the migration is complete. The src VM should remain\n     * running, but in paused state until the destination can\n     * confirm migration completion.\n     */\n    VIR_DEBUG(\"Perform3 %p uri=%s\", domain->conn, uri);\n    VIR_FREE(cookiein);\n    cookiein = g_steal_pointer(&cookieout);\n    cookieinlen = cookieoutlen;\n    cookieoutlen = 0;\n    /* dconnuri not relevant in non-P2P modes, so left NULL here */\n    if (useParams) {\n        ret = domain->conn->driver->domainMigratePerform3Params\n            (domain, NULL, params, nparams, cookiein, cookieinlen,\n             &cookieout, &cookieoutlen, flags | protection);\n    } else {\n        ret = domain->conn->driver->domainMigratePerform3\n            (domain, NULL, cookiein, cookieinlen,\n             &cookieout, &cookieoutlen, NULL,\n             uri, flags | protection, dname, bandwidth);\n    }\n\n    /* Perform failed. Make sure Finish doesn't overwrite the error */\n    if (ret < 0) {\n        virErrorPreserveLast(&orig_err);\n        /* Perform failed so we don't need to call confirm to let source know\n         * about the failure.\n         */\n        notify_source = false;\n    }\n\n    /* If Perform returns < 0, then we need to cancel the VM\n     * startup on the destination\n     */\n    cancelled = ret < 0 ? 1 : 0;\n\n finish:\n    /*\n     * The status code from the source is passed to the destination.\n     * The dest can cleanup if the source indicated it failed to\n     * send all migration data. Returns NULL for ddomain if\n     * the dest was unable to complete migration.\n     */\n    VIR_DEBUG(\"Finish3 %p ret=%d\", dconn, ret);\n    VIR_FREE(cookiein);\n    cookiein = g_steal_pointer(&cookieout);\n    cookieinlen = cookieoutlen;\n    cookieoutlen = 0;\n    if (useParams) {\n        if (virTypedParamsGetString(params, nparams,\n                                    VIR_MIGRATE_PARAM_DEST_NAME, NULL) <= 0 &&\n            virTypedParamsReplaceString(&params, &nparams,\n                                        VIR_MIGRATE_PARAM_DEST_NAME,\n                                        domain->name) < 0) {\n            ddomain = NULL;\n        } else {\n            ddomain = dconn->driver->domainMigrateFinish3Params\n                (dconn, params, nparams, cookiein, cookieinlen,\n                 &cookieout, &cookieoutlen, destflags, cancelled);\n        }\n    } else {\n        dname = dname ? dname : domain->name;\n        ddomain = dconn->driver->domainMigrateFinish3\n            (dconn, dname, cookiein, cookieinlen, &cookieout, &cookieoutlen,\n             NULL, uri, destflags, cancelled);\n    }\n\n    if (cancelled) {\n        if (ddomain) {\n            VIR_ERROR(_(\"finish step ignored that migration was cancelled\"));\n        } else {\n            /* If Finish reported a useful error, use it instead of the\n             * original \"migration unexpectedly failed\" error.\n             *\n             * This is ugly but we can't do better with the APIs we have. We\n             * only replace the error if Finish was called with cancelled == 1\n             * and reported a real error (old libvirt would report an error\n             * from RPC instead of MIGRATE_FINISH_OK), which only happens when\n             * the domain died on destination. To further reduce a possibility\n             * of false positives we also check that Perform returned\n             * VIR_ERR_OPERATION_FAILED.\n             */\n            if (orig_err &&\n                orig_err->domain == VIR_FROM_QEMU &&\n                orig_err->code == VIR_ERR_OPERATION_FAILED) {\n                virErrorPtr err = virGetLastError();\n                if (err &&\n                    err->domain == VIR_FROM_QEMU &&\n                    err->code != VIR_ERR_MIGRATE_FINISH_OK) {\n                    virFreeError(orig_err);\n                    orig_err = NULL;\n                }\n            }\n        }\n    }\n\n    /* If ddomain is NULL, then we were unable to start\n     * the guest on the target, and must restart on the\n     * source. There is a small chance that the ddomain\n     * is NULL due to an RPC failure, in which case\n     * ddomain could in fact be running on the dest.\n     * The lock manager plugins should take care of\n     * safety in this scenario.\n     */\n    cancelled = ddomain == NULL ? 1 : 0;\n\n    /* If finish3 set an error, and we don't have an earlier\n     * one we need to preserve it in case confirm3 overwrites\n     */\n    if (!orig_err)\n        virErrorPreserveLast(&orig_err);\n\n confirm:\n    /*\n     * If cancelled, then src VM will be restarted, else it will be killed.\n     * Don't do this if migration failed on source and thus it was already\n     * cancelled there.\n     */\n    if (notify_source) {\n        VIR_DEBUG(\"Confirm3 %p ret=%d domain=%p\", domain->conn, ret, domain);\n        VIR_FREE(cookiein);\n        cookiein = g_steal_pointer(&cookieout);\n        cookieinlen = cookieoutlen;\n        cookieoutlen = 0;\n        if (useParams) {\n            ret = domain->conn->driver->domainMigrateConfirm3Params\n                (domain, params, nparams, cookiein, cookieinlen,\n                 flags | protection, cancelled);\n        } else {\n            ret = domain->conn->driver->domainMigrateConfirm3\n                (domain, cookiein, cookieinlen,\n                 flags | protection, cancelled);\n        }\n        /* If Confirm3 returns -1, there's nothing more we can\n         * do, but fortunately worst case is that there is a\n         * domain left in 'paused' state on source.\n         */\n        if (ret < 0) {\n            VIR_WARN(\"Guest %s probably left in 'paused' state on source\",\n                     domain->name);\n        }\n    }\n\n done:\n    virErrorRestore(&orig_err);\n    VIR_FREE(dom_xml);\n    VIR_FREE(uri_out);\n    VIR_FREE(cookiein);\n    VIR_FREE(cookieout);\n    virTypedParamsFree(params, nparams);\n    return ddomain;\n}"
  },
  {
    "function_name": "virDomainMigrateVersion2",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "2816-2930",
    "snippet": "static virDomainPtr\nvirDomainMigrateVersion2(virDomainPtr domain,\n                         virConnectPtr dconn,\n                         unsigned long flags,\n                         const char *dname,\n                         const char *uri,\n                         unsigned long bandwidth)\n{\n    virDomainPtr ddomain = NULL;\n    char *uri_out = NULL;\n    char *cookie = NULL;\n    char *dom_xml = NULL;\n    int cookielen = 0, ret;\n    virDomainInfo info;\n    virErrorPtr orig_err = NULL;\n    unsigned int getxml_flags = 0;\n    int cancelled;\n    unsigned long destflags;\n\n    VIR_DOMAIN_DEBUG(domain,\n                     \"dconn=%p, flags=0x%lx, dname=%s, uri=%s, bandwidth=%lu\",\n                     dconn, flags, NULLSTR(dname), NULLSTR(uri), bandwidth);\n\n    /* Prepare the migration.\n     *\n     * The destination host may return a cookie, or leave cookie as\n     * NULL.\n     *\n     * The destination host MUST set uri_out if uri_in is NULL.\n     *\n     * If uri_in is non-NULL, then the destination host may modify\n     * the URI by setting uri_out.  If it does not wish to modify\n     * the URI, it should leave uri_out as NULL.\n     */\n\n    /* In version 2 of the protocol, the prepare step is slightly\n     * different.  We fetch the domain XML of the source domain\n     * and pass it to Prepare2.\n     */\n    if (!domain->conn->driver->domainGetXMLDesc) {\n        virReportUnsupportedError();\n        return NULL;\n    }\n\n    if (VIR_DRV_SUPPORTS_FEATURE(domain->conn->driver, domain->conn,\n                                 VIR_DRV_FEATURE_XML_MIGRATABLE)) {\n        getxml_flags |= VIR_DOMAIN_XML_MIGRATABLE;\n    } else {\n        getxml_flags |= VIR_DOMAIN_XML_SECURE | VIR_DOMAIN_XML_UPDATE_CPU;\n    }\n\n    dom_xml = domain->conn->driver->domainGetXMLDesc(domain, getxml_flags);\n    if (!dom_xml)\n        return NULL;\n\n    ret = virDomainGetInfo(domain, &info);\n    if (ret == 0 && info.state == VIR_DOMAIN_PAUSED)\n        flags |= VIR_MIGRATE_PAUSED;\n\n    destflags = flags & ~(VIR_MIGRATE_ABORT_ON_ERROR |\n                          VIR_MIGRATE_AUTO_CONVERGE);\n\n    VIR_DEBUG(\"Prepare2 %p flags=0x%lx\", dconn, destflags);\n    ret = dconn->driver->domainMigratePrepare2\n        (dconn, &cookie, &cookielen, uri, &uri_out, destflags, dname,\n         bandwidth, dom_xml);\n    VIR_FREE(dom_xml);\n    if (ret == -1)\n        goto done;\n\n    if (uri == NULL && uri_out == NULL) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"domainMigratePrepare2 did not set uri\"));\n        cancelled = 1;\n        /* Make sure Finish doesn't overwrite the error */\n        virErrorPreserveLast(&orig_err);\n        goto finish;\n    }\n    if (uri_out)\n        uri = uri_out; /* Did domainMigratePrepare2 change URI? */\n\n    /* Perform the migration.  The driver isn't supposed to return\n     * until the migration is complete.\n     */\n    VIR_DEBUG(\"Perform %p\", domain->conn);\n    ret = domain->conn->driver->domainMigratePerform\n        (domain, cookie, cookielen, uri, flags, dname, bandwidth);\n\n    /* Perform failed. Make sure Finish doesn't overwrite the error */\n    if (ret < 0)\n        virErrorPreserveLast(&orig_err);\n\n    /* If Perform returns < 0, then we need to cancel the VM\n     * startup on the destination\n     */\n    cancelled = ret < 0 ? 1 : 0;\n\n finish:\n    /* In version 2 of the migration protocol, we pass the\n     * status code from the sender to the destination host,\n     * so it can do any cleanup if the migration failed.\n     */\n    dname = dname ? dname : domain->name;\n    VIR_DEBUG(\"Finish2 %p ret=%d\", dconn, ret);\n    ddomain = dconn->driver->domainMigrateFinish2\n        (dconn, dname, cookie, cookielen, uri, destflags, cancelled);\n    if (cancelled && ddomain)\n        VIR_ERROR(_(\"finish step ignored that migration was cancelled\"));\n\n done:\n    virErrorRestore(&orig_err);\n    VIR_FREE(uri_out);\n    VIR_FREE(cookie);\n    return ddomain;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "cookie"
          ],
          "line": 2928
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "uri_out"
          ],
          "line": 2927
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virErrorRestore",
          "args": [
            "&orig_err"
          ],
          "line": 2926
        },
        "resolved": true,
        "details": {
          "function_name": "virErrorRestore",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "445-457",
          "snippet": "void\nvirErrorRestore(virErrorPtr *savederr)\n{\n    int saved_errno = errno;\n\n    if (!*savederr)\n        return;\n\n    virSetError(*savederr);\n    virFreeError(*savederr);\n    *savederr = NULL;\n    errno = saved_errno;\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirErrorRestore(virErrorPtr *savederr)\n{\n    int saved_errno = errno;\n\n    if (!*savederr)\n        return;\n\n    virSetError(*savederr);\n    virFreeError(*savederr);\n    *savederr = NULL;\n    errno = saved_errno;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_ERROR",
          "args": [
            "_(\"finish step ignored that migration was cancelled\")"
          ],
          "line": 2923
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"finish step ignored that migration was cancelled\""
          ],
          "line": 2923
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "dconn->driver->domainMigrateFinish2",
          "args": [
            "dconn",
            "dname",
            "cookie",
            "cookielen",
            "uri",
            "destflags",
            "cancelled"
          ],
          "line": 2920
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Finish2 %p ret=%d\"",
            "dconn",
            "ret"
          ],
          "line": 2919
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virErrorPreserveLast",
          "args": [
            "&orig_err"
          ],
          "line": 2906
        },
        "resolved": true,
        "details": {
          "function_name": "virErrorPreserveLast",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "424-436",
          "snippet": "void\nvirErrorPreserveLast(virErrorPtr *saveerr)\n{\n    int saved_errno = errno;\n    virErrorPtr lasterr = virGetLastError();\n\n    *saveerr = NULL;\n\n    if (lasterr)\n        *saveerr = virErrorCopyNew(lasterr);\n\n    errno = saved_errno;\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirErrorPreserveLast(virErrorPtr *saveerr)\n{\n    int saved_errno = errno;\n    virErrorPtr lasterr = virGetLastError();\n\n    *saveerr = NULL;\n\n    if (lasterr)\n        *saveerr = virErrorCopyNew(lasterr);\n\n    errno = saved_errno;\n}"
        }
      },
      {
        "call_info": {
          "callee": "domain->conn->driver->domainMigratePerform",
          "args": [
            "domain",
            "cookie",
            "cookielen",
            "uri",
            "flags",
            "dname",
            "bandwidth"
          ],
          "line": 2901
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Perform %p\"",
            "domain->conn"
          ],
          "line": 2900
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"domainMigratePrepare2 did not set uri\")"
          ],
          "line": 2887
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "dom_xml"
          ],
          "line": 2882
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dconn->driver->domainMigratePrepare2",
          "args": [
            "dconn",
            "&cookie",
            "&cookielen",
            "uri",
            "&uri_out",
            "destflags",
            "dname",
            "bandwidth",
            "dom_xml"
          ],
          "line": 2879
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Prepare2 %p flags=0x%lx\"",
            "dconn",
            "destflags"
          ],
          "line": 2878
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainGetInfo",
          "args": [
            "domain",
            "&info"
          ],
          "line": 2871
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainGetInfo",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
          "lines": "2420-2450",
          "snippet": "int\nvirDomainGetInfo(virDomainPtr domain, virDomainInfoPtr info)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"info=%p\", info);\n\n    virResetLastError();\n\n    if (info)\n        memset(info, 0, sizeof(*info));\n\n    virCheckDomainReturn(domain, -1);\n    virCheckNonNullArgGoto(info, error);\n\n    conn = domain->conn;\n\n    if (conn->driver->domainGetInfo) {\n        int ret;\n        ret = conn->driver->domainGetInfo(domain, info);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainGetInfo(virDomainPtr domain, virDomainInfoPtr info)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"info=%p\", info);\n\n    virResetLastError();\n\n    if (info)\n        memset(info, 0, sizeof(*info));\n\n    virCheckDomainReturn(domain, -1);\n    virCheckNonNullArgGoto(info, error);\n\n    conn = domain->conn;\n\n    if (conn->driver->domainGetInfo) {\n        int ret;\n        ret = conn->driver->domainGetInfo(domain, info);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "domain->conn->driver->domainGetXMLDesc",
          "args": [
            "domain",
            "getxml_flags"
          ],
          "line": 2867
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DRV_SUPPORTS_FEATURE",
          "args": [
            "domain->conn->driver",
            "domain->conn",
            "VIR_DRV_FEATURE_XML_MIGRATABLE"
          ],
          "line": 2860
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 2856
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "domain",
            "\"dconn=%p, flags=0x%lx, dname=%s, uri=%s, bandwidth=%lu\"",
            "dconn",
            "flags",
            "NULLSTR(dname)",
            "NULLSTR(uri)",
            "bandwidth"
          ],
          "line": 2835
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "uri"
          ],
          "line": 2837
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "dname"
          ],
          "line": 2837
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nstatic virDomainPtr\nvirDomainMigrateVersion2(virDomainPtr domain,\n                         virConnectPtr dconn,\n                         unsigned long flags,\n                         const char *dname,\n                         const char *uri,\n                         unsigned long bandwidth)\n{\n    virDomainPtr ddomain = NULL;\n    char *uri_out = NULL;\n    char *cookie = NULL;\n    char *dom_xml = NULL;\n    int cookielen = 0, ret;\n    virDomainInfo info;\n    virErrorPtr orig_err = NULL;\n    unsigned int getxml_flags = 0;\n    int cancelled;\n    unsigned long destflags;\n\n    VIR_DOMAIN_DEBUG(domain,\n                     \"dconn=%p, flags=0x%lx, dname=%s, uri=%s, bandwidth=%lu\",\n                     dconn, flags, NULLSTR(dname), NULLSTR(uri), bandwidth);\n\n    /* Prepare the migration.\n     *\n     * The destination host may return a cookie, or leave cookie as\n     * NULL.\n     *\n     * The destination host MUST set uri_out if uri_in is NULL.\n     *\n     * If uri_in is non-NULL, then the destination host may modify\n     * the URI by setting uri_out.  If it does not wish to modify\n     * the URI, it should leave uri_out as NULL.\n     */\n\n    /* In version 2 of the protocol, the prepare step is slightly\n     * different.  We fetch the domain XML of the source domain\n     * and pass it to Prepare2.\n     */\n    if (!domain->conn->driver->domainGetXMLDesc) {\n        virReportUnsupportedError();\n        return NULL;\n    }\n\n    if (VIR_DRV_SUPPORTS_FEATURE(domain->conn->driver, domain->conn,\n                                 VIR_DRV_FEATURE_XML_MIGRATABLE)) {\n        getxml_flags |= VIR_DOMAIN_XML_MIGRATABLE;\n    } else {\n        getxml_flags |= VIR_DOMAIN_XML_SECURE | VIR_DOMAIN_XML_UPDATE_CPU;\n    }\n\n    dom_xml = domain->conn->driver->domainGetXMLDesc(domain, getxml_flags);\n    if (!dom_xml)\n        return NULL;\n\n    ret = virDomainGetInfo(domain, &info);\n    if (ret == 0 && info.state == VIR_DOMAIN_PAUSED)\n        flags |= VIR_MIGRATE_PAUSED;\n\n    destflags = flags & ~(VIR_MIGRATE_ABORT_ON_ERROR |\n                          VIR_MIGRATE_AUTO_CONVERGE);\n\n    VIR_DEBUG(\"Prepare2 %p flags=0x%lx\", dconn, destflags);\n    ret = dconn->driver->domainMigratePrepare2\n        (dconn, &cookie, &cookielen, uri, &uri_out, destflags, dname,\n         bandwidth, dom_xml);\n    VIR_FREE(dom_xml);\n    if (ret == -1)\n        goto done;\n\n    if (uri == NULL && uri_out == NULL) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"domainMigratePrepare2 did not set uri\"));\n        cancelled = 1;\n        /* Make sure Finish doesn't overwrite the error */\n        virErrorPreserveLast(&orig_err);\n        goto finish;\n    }\n    if (uri_out)\n        uri = uri_out; /* Did domainMigratePrepare2 change URI? */\n\n    /* Perform the migration.  The driver isn't supposed to return\n     * until the migration is complete.\n     */\n    VIR_DEBUG(\"Perform %p\", domain->conn);\n    ret = domain->conn->driver->domainMigratePerform\n        (domain, cookie, cookielen, uri, flags, dname, bandwidth);\n\n    /* Perform failed. Make sure Finish doesn't overwrite the error */\n    if (ret < 0)\n        virErrorPreserveLast(&orig_err);\n\n    /* If Perform returns < 0, then we need to cancel the VM\n     * startup on the destination\n     */\n    cancelled = ret < 0 ? 1 : 0;\n\n finish:\n    /* In version 2 of the migration protocol, we pass the\n     * status code from the sender to the destination host,\n     * so it can do any cleanup if the migration failed.\n     */\n    dname = dname ? dname : domain->name;\n    VIR_DEBUG(\"Finish2 %p ret=%d\", dconn, ret);\n    ddomain = dconn->driver->domainMigrateFinish2\n        (dconn, dname, cookie, cookielen, uri, destflags, cancelled);\n    if (cancelled && ddomain)\n        VIR_ERROR(_(\"finish step ignored that migration was cancelled\"));\n\n done:\n    virErrorRestore(&orig_err);\n    VIR_FREE(uri_out);\n    VIR_FREE(cookie);\n    return ddomain;\n}"
  },
  {
    "function_name": "virDomainMigrateVersion1",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "2721-2794",
    "snippet": "static virDomainPtr\nvirDomainMigrateVersion1(virDomainPtr domain,\n                         virConnectPtr dconn,\n                         unsigned long flags,\n                         const char *dname,\n                         const char *uri,\n                         unsigned long bandwidth)\n{\n    virDomainPtr ddomain = NULL;\n    char *uri_out = NULL;\n    char *cookie = NULL;\n    int cookielen = 0, ret;\n    virDomainInfo info;\n    unsigned int destflags;\n\n    VIR_DOMAIN_DEBUG(domain,\n                     \"dconn=%p, flags=0x%lx, dname=%s, uri=%s, bandwidth=%lu\",\n                     dconn, flags, NULLSTR(dname), NULLSTR(uri), bandwidth);\n\n    ret = virDomainGetInfo(domain, &info);\n    if (ret == 0 && info.state == VIR_DOMAIN_PAUSED)\n        flags |= VIR_MIGRATE_PAUSED;\n\n    destflags = flags & ~(VIR_MIGRATE_ABORT_ON_ERROR |\n                          VIR_MIGRATE_AUTO_CONVERGE);\n\n    /* Prepare the migration.\n     *\n     * The destination host may return a cookie, or leave cookie as\n     * NULL.\n     *\n     * The destination host MUST set uri_out if uri_in is NULL.\n     *\n     * If uri_in is non-NULL, then the destination host may modify\n     * the URI by setting uri_out.  If it does not wish to modify\n     * the URI, it should leave uri_out as NULL.\n     */\n    if (dconn->driver->domainMigratePrepare\n        (dconn, &cookie, &cookielen, uri, &uri_out, destflags, dname,\n         bandwidth) == -1)\n        goto done;\n\n    if (uri == NULL && uri_out == NULL) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"domainMigratePrepare did not set uri\"));\n        goto done;\n    }\n    if (uri_out)\n        uri = uri_out; /* Did domainMigratePrepare change URI? */\n\n    /* Perform the migration.  The driver isn't supposed to return\n     * until the migration is complete.\n     */\n    if (domain->conn->driver->domainMigratePerform\n        (domain, cookie, cookielen, uri, flags, dname, bandwidth) == -1)\n        goto done;\n\n    /* Get the destination domain and return it or error.\n     * 'domain' no longer actually exists at this point\n     * (or so we hope), but we still use the object in memory\n     * in order to get the name.\n     */\n    dname = dname ? dname : domain->name;\n    if (dconn->driver->domainMigrateFinish)\n        ddomain = dconn->driver->domainMigrateFinish\n            (dconn, dname, cookie, cookielen, uri, destflags);\n    else\n        ddomain = virDomainLookupByName(dconn, dname);\n\n done:\n    VIR_FREE(uri_out);\n    VIR_FREE(cookie);\n    return ddomain;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "cookie"
          ],
          "line": 2792
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "uri_out"
          ],
          "line": 2791
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainLookupByName",
          "args": [
            "dconn",
            "dname"
          ],
          "line": 2788
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainLookupByName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
          "lines": "410-433",
          "snippet": "virDomainPtr\nvirDomainLookupByName(virConnectPtr conn, const char *name)\n{\n    VIR_DEBUG(\"conn=%p, name=%s\", conn, NULLSTR(name));\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, NULL);\n    virCheckNonNullArgGoto(name, error);\n\n    if (conn->driver->domainLookupByName) {\n        virDomainPtr dom;\n        dom = conn->driver->domainLookupByName(conn, name);\n        if (!dom)\n            goto error;\n        return dom;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return NULL;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nvirDomainPtr\nvirDomainLookupByName(virConnectPtr conn, const char *name)\n{\n    VIR_DEBUG(\"conn=%p, name=%s\", conn, NULLSTR(name));\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, NULL);\n    virCheckNonNullArgGoto(name, error);\n\n    if (conn->driver->domainLookupByName) {\n        virDomainPtr dom;\n        dom = conn->driver->domainLookupByName(conn, name);\n        if (!dom)\n            goto error;\n        return dom;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "dconn->driver->domainMigrateFinish",
          "args": [
            "dconn",
            "dname",
            "cookie",
            "cookielen",
            "uri",
            "destflags"
          ],
          "line": 2785
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "domain->conn->driver->domainMigratePerform",
          "args": [
            "domain",
            "cookie",
            "cookielen",
            "uri",
            "flags",
            "dname",
            "bandwidth"
          ],
          "line": 2774
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"domainMigratePrepare did not set uri\")"
          ],
          "line": 2764
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"domainMigratePrepare did not set uri\""
          ],
          "line": 2765
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "dconn->driver->domainMigratePrepare",
          "args": [
            "dconn",
            "&cookie",
            "&cookielen",
            "uri",
            "&uri_out",
            "destflags",
            "dname",
            "bandwidth"
          ],
          "line": 2758
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainGetInfo",
          "args": [
            "domain",
            "&info"
          ],
          "line": 2740
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainGetInfo",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
          "lines": "2420-2450",
          "snippet": "int\nvirDomainGetInfo(virDomainPtr domain, virDomainInfoPtr info)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"info=%p\", info);\n\n    virResetLastError();\n\n    if (info)\n        memset(info, 0, sizeof(*info));\n\n    virCheckDomainReturn(domain, -1);\n    virCheckNonNullArgGoto(info, error);\n\n    conn = domain->conn;\n\n    if (conn->driver->domainGetInfo) {\n        int ret;\n        ret = conn->driver->domainGetInfo(domain, info);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainGetInfo(virDomainPtr domain, virDomainInfoPtr info)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"info=%p\", info);\n\n    virResetLastError();\n\n    if (info)\n        memset(info, 0, sizeof(*info));\n\n    virCheckDomainReturn(domain, -1);\n    virCheckNonNullArgGoto(info, error);\n\n    conn = domain->conn;\n\n    if (conn->driver->domainGetInfo) {\n        int ret;\n        ret = conn->driver->domainGetInfo(domain, info);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "domain",
            "\"dconn=%p, flags=0x%lx, dname=%s, uri=%s, bandwidth=%lu\"",
            "dconn",
            "flags",
            "NULLSTR(dname)",
            "NULLSTR(uri)",
            "bandwidth"
          ],
          "line": 2736
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "uri"
          ],
          "line": 2738
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "dname"
          ],
          "line": 2738
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nstatic virDomainPtr\nvirDomainMigrateVersion1(virDomainPtr domain,\n                         virConnectPtr dconn,\n                         unsigned long flags,\n                         const char *dname,\n                         const char *uri,\n                         unsigned long bandwidth)\n{\n    virDomainPtr ddomain = NULL;\n    char *uri_out = NULL;\n    char *cookie = NULL;\n    int cookielen = 0, ret;\n    virDomainInfo info;\n    unsigned int destflags;\n\n    VIR_DOMAIN_DEBUG(domain,\n                     \"dconn=%p, flags=0x%lx, dname=%s, uri=%s, bandwidth=%lu\",\n                     dconn, flags, NULLSTR(dname), NULLSTR(uri), bandwidth);\n\n    ret = virDomainGetInfo(domain, &info);\n    if (ret == 0 && info.state == VIR_DOMAIN_PAUSED)\n        flags |= VIR_MIGRATE_PAUSED;\n\n    destflags = flags & ~(VIR_MIGRATE_ABORT_ON_ERROR |\n                          VIR_MIGRATE_AUTO_CONVERGE);\n\n    /* Prepare the migration.\n     *\n     * The destination host may return a cookie, or leave cookie as\n     * NULL.\n     *\n     * The destination host MUST set uri_out if uri_in is NULL.\n     *\n     * If uri_in is non-NULL, then the destination host may modify\n     * the URI by setting uri_out.  If it does not wish to modify\n     * the URI, it should leave uri_out as NULL.\n     */\n    if (dconn->driver->domainMigratePrepare\n        (dconn, &cookie, &cookielen, uri, &uri_out, destflags, dname,\n         bandwidth) == -1)\n        goto done;\n\n    if (uri == NULL && uri_out == NULL) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"domainMigratePrepare did not set uri\"));\n        goto done;\n    }\n    if (uri_out)\n        uri = uri_out; /* Did domainMigratePrepare change URI? */\n\n    /* Perform the migration.  The driver isn't supposed to return\n     * until the migration is complete.\n     */\n    if (domain->conn->driver->domainMigratePerform\n        (domain, cookie, cookielen, uri, flags, dname, bandwidth) == -1)\n        goto done;\n\n    /* Get the destination domain and return it or error.\n     * 'domain' no longer actually exists at this point\n     * (or so we hope), but we still use the object in memory\n     * in order to get the name.\n     */\n    dname = dname ? dname : domain->name;\n    if (dconn->driver->domainMigrateFinish)\n        ddomain = dconn->driver->domainMigrateFinish\n            (dconn, dname, cookie, cookielen, uri, destflags);\n    else\n        ddomain = virDomainLookupByName(dconn, dname);\n\n done:\n    VIR_FREE(uri_out);\n    VIR_FREE(cookie);\n    return ddomain;\n}"
  },
  {
    "function_name": "virConnectDomainXMLToNative",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "2669-2702",
    "snippet": "char *\nvirConnectDomainXMLToNative(virConnectPtr conn,\n                            const char *nativeFormat,\n                            const char *domainXml,\n                            unsigned int flags)\n{\n    VIR_DEBUG(\"conn=%p, format=%s, xml=%s, flags=0x%x\",\n              conn, NULLSTR(nativeFormat), NULLSTR(domainXml), flags);\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, NULL);\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    virCheckNonNullArgGoto(nativeFormat, error);\n    virCheckNonNullArgGoto(domainXml, error);\n\n    if (conn->driver->connectDomainXMLToNative) {\n        char *ret;\n        ret = conn->driver->connectDomainXMLToNative(conn,\n                                                     nativeFormat,\n                                                     domainXml,\n                                                     flags);\n        if (!ret)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return NULL;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "conn"
          ],
          "line": 2700
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 2697
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->connectDomainXMLToNative",
          "args": [
            "conn",
            "nativeFormat",
            "domainXml",
            "flags"
          ],
          "line": 2688
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "domainXml",
            "error"
          ],
          "line": 2684
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "nativeFormat",
            "error"
          ],
          "line": 2683
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "conn->flags",
            "error"
          ],
          "line": 2681
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckConnectReturn",
          "args": [
            "conn",
            "NULL"
          ],
          "line": 2680
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 2678
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"conn=%p, format=%s, xml=%s, flags=0x%x\"",
            "conn",
            "NULLSTR(nativeFormat)",
            "NULLSTR(domainXml)",
            "flags"
          ],
          "line": 2675
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "domainXml"
          ],
          "line": 2676
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "nativeFormat"
          ],
          "line": 2676
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nchar *\nvirConnectDomainXMLToNative(virConnectPtr conn,\n                            const char *nativeFormat,\n                            const char *domainXml,\n                            unsigned int flags)\n{\n    VIR_DEBUG(\"conn=%p, format=%s, xml=%s, flags=0x%x\",\n              conn, NULLSTR(nativeFormat), NULLSTR(domainXml), flags);\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, NULL);\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    virCheckNonNullArgGoto(nativeFormat, error);\n    virCheckNonNullArgGoto(domainXml, error);\n\n    if (conn->driver->connectDomainXMLToNative) {\n        char *ret;\n        ret = conn->driver->connectDomainXMLToNative(conn,\n                                                     nativeFormat,\n                                                     domainXml,\n                                                     flags);\n        if (!ret)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return NULL;\n}"
  },
  {
    "function_name": "virConnectDomainXMLFromNative",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "2619-2652",
    "snippet": "char *\nvirConnectDomainXMLFromNative(virConnectPtr conn,\n                              const char *nativeFormat,\n                              const char *nativeConfig,\n                              unsigned int flags)\n{\n    VIR_DEBUG(\"conn=%p, format=%s, config=%s, flags=0x%x\",\n              conn, NULLSTR(nativeFormat), NULLSTR(nativeConfig), flags);\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, NULL);\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    virCheckNonNullArgGoto(nativeFormat, error);\n    virCheckNonNullArgGoto(nativeConfig, error);\n\n    if (conn->driver->connectDomainXMLFromNative) {\n        char *ret;\n        ret = conn->driver->connectDomainXMLFromNative(conn,\n                                                       nativeFormat,\n                                                       nativeConfig,\n                                                       flags);\n        if (!ret)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return NULL;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "conn"
          ],
          "line": 2650
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 2647
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->connectDomainXMLFromNative",
          "args": [
            "conn",
            "nativeFormat",
            "nativeConfig",
            "flags"
          ],
          "line": 2638
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "nativeConfig",
            "error"
          ],
          "line": 2634
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "nativeFormat",
            "error"
          ],
          "line": 2633
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "conn->flags",
            "error"
          ],
          "line": 2631
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckConnectReturn",
          "args": [
            "conn",
            "NULL"
          ],
          "line": 2630
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 2628
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"conn=%p, format=%s, config=%s, flags=0x%x\"",
            "conn",
            "NULLSTR(nativeFormat)",
            "NULLSTR(nativeConfig)",
            "flags"
          ],
          "line": 2625
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "nativeConfig"
          ],
          "line": 2626
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "nativeFormat"
          ],
          "line": 2626
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nchar *\nvirConnectDomainXMLFromNative(virConnectPtr conn,\n                              const char *nativeFormat,\n                              const char *nativeConfig,\n                              unsigned int flags)\n{\n    VIR_DEBUG(\"conn=%p, format=%s, config=%s, flags=0x%x\",\n              conn, NULLSTR(nativeFormat), NULLSTR(nativeConfig), flags);\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, NULL);\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    virCheckNonNullArgGoto(nativeFormat, error);\n    virCheckNonNullArgGoto(nativeConfig, error);\n\n    if (conn->driver->connectDomainXMLFromNative) {\n        char *ret;\n        ret = conn->driver->connectDomainXMLFromNative(conn,\n                                                       nativeFormat,\n                                                       nativeConfig,\n                                                       flags);\n        if (!ret)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return NULL;\n}"
  },
  {
    "function_name": "virDomainGetXMLDesc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "2570-2602",
    "snippet": "char *\nvirDomainGetXMLDesc(virDomainPtr domain, unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"flags=0x%x\", flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, NULL);\n    conn = domain->conn;\n\n    if ((conn->flags & VIR_CONNECT_RO) &&\n        (flags & (VIR_DOMAIN_XML_SECURE | VIR_DOMAIN_XML_MIGRATABLE))) {\n        virReportError(VIR_ERR_OPERATION_DENIED, \"%s\",\n                       _(\"virDomainGetXMLDesc with secure flag\"));\n        goto error;\n    }\n\n    if (conn->driver->domainGetXMLDesc) {\n        char *ret;\n        ret = conn->driver->domainGetXMLDesc(domain, flags);\n        if (!ret)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return NULL;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "domain->conn"
          ],
          "line": 2600
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 2597
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainGetXMLDesc",
          "args": [
            "domain",
            "flags"
          ],
          "line": 2591
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_DENIED",
            "\"%s\"",
            "_(\"virDomainGetXMLDesc with secure flag\")"
          ],
          "line": 2584
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"virDomainGetXMLDesc with secure flag\""
          ],
          "line": 2585
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "domain",
            "NULL"
          ],
          "line": 2579
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 2577
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "domain",
            "\"flags=0x%x\"",
            "flags"
          ],
          "line": 2575
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nchar *\nvirDomainGetXMLDesc(virDomainPtr domain, unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"flags=0x%x\", flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, NULL);\n    conn = domain->conn;\n\n    if ((conn->flags & VIR_CONNECT_RO) &&\n        (flags & (VIR_DOMAIN_XML_SECURE | VIR_DOMAIN_XML_MIGRATABLE))) {\n        virReportError(VIR_ERR_OPERATION_DENIED, \"%s\",\n                       _(\"virDomainGetXMLDesc with secure flag\"));\n        goto error;\n    }\n\n    if (conn->driver->domainGetXMLDesc) {\n        char *ret;\n        ret = conn->driver->domainGetXMLDesc(domain, flags);\n        if (!ret)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return NULL;\n}"
  },
  {
    "function_name": "virDomainGetControlInfo",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "2509-2537",
    "snippet": "int\nvirDomainGetControlInfo(virDomainPtr domain,\n                        virDomainControlInfoPtr info,\n                        unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"info=%p, flags=0x%x\", info, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    virCheckNonNullArgGoto(info, error);\n\n    conn = domain->conn;\n    if (conn->driver->domainGetControlInfo) {\n        int ret;\n        ret = conn->driver->domainGetControlInfo(domain, info, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "domain->conn"
          ],
          "line": 2535
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 2532
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainGetControlInfo",
          "args": [
            "domain",
            "info",
            "flags"
          ],
          "line": 2526
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "info",
            "error"
          ],
          "line": 2521
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "domain",
            "-1"
          ],
          "line": 2520
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 2518
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "domain",
            "\"info=%p, flags=0x%x\"",
            "info",
            "flags"
          ],
          "line": 2516
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainGetControlInfo(virDomainPtr domain,\n                        virDomainControlInfoPtr info,\n                        unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"info=%p, flags=0x%x\", info, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    virCheckNonNullArgGoto(info, error);\n\n    conn = domain->conn;\n    if (conn->driver->domainGetControlInfo) {\n        int ret;\n        ret = conn->driver->domainGetControlInfo(domain, info, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainGetState",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "2466-2496",
    "snippet": "int\nvirDomainGetState(virDomainPtr domain,\n                  int *state,\n                  int *reason,\n                  unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"state=%p, reason=%p, flags=0x%x\",\n                     state, reason, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    virCheckNonNullArgGoto(state, error);\n\n    conn = domain->conn;\n    if (conn->driver->domainGetState) {\n        int ret;\n        ret = conn->driver->domainGetState(domain, state, reason, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "domain->conn"
          ],
          "line": 2494
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 2491
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainGetState",
          "args": [
            "domain",
            "state",
            "reason",
            "flags"
          ],
          "line": 2485
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "state",
            "error"
          ],
          "line": 2480
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "domain",
            "-1"
          ],
          "line": 2479
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 2477
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "domain",
            "\"state=%p, reason=%p, flags=0x%x\"",
            "state",
            "reason",
            "flags"
          ],
          "line": 2474
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainGetState(virDomainPtr domain,\n                  int *state,\n                  int *reason,\n                  unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"state=%p, reason=%p, flags=0x%x\",\n                     state, reason, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    virCheckNonNullArgGoto(state, error);\n\n    conn = domain->conn;\n    if (conn->driver->domainGetState) {\n        int ret;\n        ret = conn->driver->domainGetState(domain, state, reason, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainGetInfo",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "2420-2450",
    "snippet": "int\nvirDomainGetInfo(virDomainPtr domain, virDomainInfoPtr info)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"info=%p\", info);\n\n    virResetLastError();\n\n    if (info)\n        memset(info, 0, sizeof(*info));\n\n    virCheckDomainReturn(domain, -1);\n    virCheckNonNullArgGoto(info, error);\n\n    conn = domain->conn;\n\n    if (conn->driver->domainGetInfo) {\n        int ret;\n        ret = conn->driver->domainGetInfo(domain, info);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "domain->conn"
          ],
          "line": 2448
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 2445
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainGetInfo",
          "args": [
            "domain",
            "info"
          ],
          "line": 2439
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "info",
            "error"
          ],
          "line": 2433
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "domain",
            "-1"
          ],
          "line": 2432
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "info",
            "0",
            "sizeof(*info)"
          ],
          "line": 2430
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 2427
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "domain",
            "\"info=%p\"",
            "info"
          ],
          "line": 2425
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainGetInfo(virDomainPtr domain, virDomainInfoPtr info)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"info=%p\", info);\n\n    virResetLastError();\n\n    if (info)\n        memset(info, 0, sizeof(*info));\n\n    virCheckDomainReturn(domain, -1);\n    virCheckNonNullArgGoto(info, error);\n\n    conn = domain->conn;\n\n    if (conn->driver->domainGetInfo) {\n        int ret;\n        ret = conn->driver->domainGetInfo(domain, info);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainGetBlkioParameters",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "2366-2406",
    "snippet": "int\nvirDomainGetBlkioParameters(virDomainPtr domain,\n                            virTypedParameterPtr params,\n                            int *nparams, unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"params=%p, nparams=%d, flags=0x%x\",\n                     params, (nparams) ? *nparams : -1, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    virCheckNonNullArgGoto(nparams, error);\n    virCheckNonNegativeArgGoto(*nparams, error);\n    if (*nparams != 0)\n        virCheckNonNullArgGoto(params, error);\n\n    if (VIR_DRV_SUPPORTS_FEATURE(domain->conn->driver, domain->conn,\n                                 VIR_DRV_FEATURE_TYPED_PARAM_STRING))\n        flags |= VIR_TYPED_PARAM_STRING_OKAY;\n\n    VIR_EXCLUSIVE_FLAGS_GOTO(VIR_DOMAIN_AFFECT_LIVE,\n                             VIR_DOMAIN_AFFECT_CONFIG,\n                             error);\n\n    conn = domain->conn;\n\n    if (conn->driver->domainGetBlkioParameters) {\n        int ret;\n        ret = conn->driver->domainGetBlkioParameters(domain, params, nparams, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "domain->conn"
          ],
          "line": 2404
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 2401
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainGetBlkioParameters",
          "args": [
            "domain",
            "params",
            "nparams",
            "flags"
          ],
          "line": 2396
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_EXCLUSIVE_FLAGS_GOTO",
          "args": [
            "VIR_DOMAIN_AFFECT_LIVE",
            "VIR_DOMAIN_AFFECT_CONFIG",
            "error"
          ],
          "line": 2388
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DRV_SUPPORTS_FEATURE",
          "args": [
            "domain->conn->driver",
            "domain->conn",
            "VIR_DRV_FEATURE_TYPED_PARAM_STRING"
          ],
          "line": 2384
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "params",
            "error"
          ],
          "line": 2382
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNegativeArgGoto",
          "args": [
            "*nparams",
            "error"
          ],
          "line": 2380
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "nparams",
            "error"
          ],
          "line": 2379
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "domain",
            "-1"
          ],
          "line": 2378
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 2376
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "domain",
            "\"params=%p, nparams=%d, flags=0x%x\"",
            "params",
            "(nparams) ? *nparams : -1",
            "flags"
          ],
          "line": 2373
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainGetBlkioParameters(virDomainPtr domain,\n                            virTypedParameterPtr params,\n                            int *nparams, unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"params=%p, nparams=%d, flags=0x%x\",\n                     params, (nparams) ? *nparams : -1, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    virCheckNonNullArgGoto(nparams, error);\n    virCheckNonNegativeArgGoto(*nparams, error);\n    if (*nparams != 0)\n        virCheckNonNullArgGoto(params, error);\n\n    if (VIR_DRV_SUPPORTS_FEATURE(domain->conn->driver, domain->conn,\n                                 VIR_DRV_FEATURE_TYPED_PARAM_STRING))\n        flags |= VIR_TYPED_PARAM_STRING_OKAY;\n\n    VIR_EXCLUSIVE_FLAGS_GOTO(VIR_DOMAIN_AFFECT_LIVE,\n                             VIR_DOMAIN_AFFECT_CONFIG,\n                             error);\n\n    conn = domain->conn;\n\n    if (conn->driver->domainGetBlkioParameters) {\n        int ret;\n        ret = conn->driver->domainGetBlkioParameters(domain, params, nparams, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainSetBlkioParameters",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "2301-2337",
    "snippet": "int\nvirDomainSetBlkioParameters(virDomainPtr domain,\n                            virTypedParameterPtr params,\n                            int nparams, unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"params=%p, nparams=%d, flags=0x%x\",\n                     params, nparams, flags);\n    VIR_TYPED_PARAMS_DEBUG(params, nparams);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n    virCheckNonNullArgGoto(params, error);\n    virCheckNonNegativeArgGoto(nparams, error);\n\n    if (virTypedParameterValidateSet(conn, params, nparams) < 0)\n        goto error;\n\n    if (conn->driver->domainSetBlkioParameters) {\n        int ret;\n        ret = conn->driver->domainSetBlkioParameters(domain, params, nparams, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "domain->conn"
          ],
          "line": 2335
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 2332
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainSetBlkioParameters",
          "args": [
            "domain",
            "params",
            "nparams",
            "flags"
          ],
          "line": 2326
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virTypedParameterValidateSet",
          "args": [
            "conn",
            "params",
            "nparams"
          ],
          "line": 2321
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParameterValidateSet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt.c",
          "lines": "1288-1325",
          "snippet": "int\nvirTypedParameterValidateSet(virConnectPtr conn,\n                             virTypedParameterPtr params,\n                             int nparams)\n{\n    bool string_okay;\n    size_t i;\n\n    string_okay = VIR_DRV_SUPPORTS_FEATURE(conn->driver,\n                                           conn,\n                                           VIR_DRV_FEATURE_TYPED_PARAM_STRING);\n    for (i = 0; i < nparams; i++) {\n        if (strnlen(params[i].field, VIR_TYPED_PARAM_FIELD_LENGTH) ==\n            VIR_TYPED_PARAM_FIELD_LENGTH) {\n            virReportInvalidArg(params,\n                                _(\"string parameter name '%.*s' too long\"),\n                                VIR_TYPED_PARAM_FIELD_LENGTH,\n                                params[i].field);\n            return -1;\n        }\n        if (params[i].type == VIR_TYPED_PARAM_STRING) {\n            if (string_okay) {\n                if (!params[i].value.s) {\n                    virReportInvalidArg(params,\n                                        _(\"NULL string parameter '%s'\"),\n                                        params[i].field);\n                    return -1;\n                }\n            } else {\n                virReportInvalidArg(params,\n                                    _(\"string parameter '%s' unsupported\"),\n                                    params[i].field);\n                return -1;\n            }\n        }\n    }\n    return 0;\n}",
          "includes": [
            "#include \"access/viraccessmanager.h\"",
            "# include \"bhyve/bhyve_driver.h\"",
            "# include \"hyperv/hyperv_driver.h\"",
            "# include \"esx/esx_driver.h\"",
            "# include \"vmware/vmware_driver.h\"",
            "# include \"openvz/openvz_driver.h\"",
            "# include \"remote/remote_driver.h\"",
            "# include \"test/test_driver.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"viruri.h\"",
            "#include \"virrandom.h\"",
            "#include \"virfile.h\"",
            "#include \"virevent.h\"",
            "#include \"vircommand.h\"",
            "#include \"rpc/virnettlscontext.h\"",
            "#include \"virconf.h\"",
            "#include \"configmake.h\"",
            "#include \"viralloc.h\"",
            "#include \"viruuid.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <curl/curl.h>",
            "#include <libxml/xpath.h>",
            "#include <libxml/parser.h>",
            "#include <gio/gnetworking.h>",
            "#include <time.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"access/viraccessmanager.h\"\n# include \"bhyve/bhyve_driver.h\"\n# include \"hyperv/hyperv_driver.h\"\n# include \"esx/esx_driver.h\"\n# include \"vmware/vmware_driver.h\"\n# include \"openvz/openvz_driver.h\"\n# include \"remote/remote_driver.h\"\n# include \"test/test_driver.h\"\n#include \"virtypedparam.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"viruri.h\"\n#include \"virrandom.h\"\n#include \"virfile.h\"\n#include \"virevent.h\"\n#include \"vircommand.h\"\n#include \"rpc/virnettlscontext.h\"\n#include \"virconf.h\"\n#include \"configmake.h\"\n#include \"viralloc.h\"\n#include \"viruuid.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <curl/curl.h>\n#include <libxml/xpath.h>\n#include <libxml/parser.h>\n#include <gio/gnetworking.h>\n#include <time.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nint\nvirTypedParameterValidateSet(virConnectPtr conn,\n                             virTypedParameterPtr params,\n                             int nparams)\n{\n    bool string_okay;\n    size_t i;\n\n    string_okay = VIR_DRV_SUPPORTS_FEATURE(conn->driver,\n                                           conn,\n                                           VIR_DRV_FEATURE_TYPED_PARAM_STRING);\n    for (i = 0; i < nparams; i++) {\n        if (strnlen(params[i].field, VIR_TYPED_PARAM_FIELD_LENGTH) ==\n            VIR_TYPED_PARAM_FIELD_LENGTH) {\n            virReportInvalidArg(params,\n                                _(\"string parameter name '%.*s' too long\"),\n                                VIR_TYPED_PARAM_FIELD_LENGTH,\n                                params[i].field);\n            return -1;\n        }\n        if (params[i].type == VIR_TYPED_PARAM_STRING) {\n            if (string_okay) {\n                if (!params[i].value.s) {\n                    virReportInvalidArg(params,\n                                        _(\"NULL string parameter '%s'\"),\n                                        params[i].field);\n                    return -1;\n                }\n            } else {\n                virReportInvalidArg(params,\n                                    _(\"string parameter '%s' unsupported\"),\n                                    params[i].field);\n                return -1;\n            }\n        }\n    }\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckNonNegativeArgGoto",
          "args": [
            "nparams",
            "error"
          ],
          "line": 2319
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "params",
            "error"
          ],
          "line": 2318
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "conn->flags",
            "error"
          ],
          "line": 2317
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "domain",
            "-1"
          ],
          "line": 2314
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 2312
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_TYPED_PARAMS_DEBUG",
          "args": [
            "params",
            "nparams"
          ],
          "line": 2310
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "domain",
            "\"params=%p, nparams=%d, flags=0x%x\"",
            "params",
            "nparams",
            "flags"
          ],
          "line": 2308
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainSetBlkioParameters(virDomainPtr domain,\n                            virTypedParameterPtr params,\n                            int nparams, unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"params=%p, nparams=%d, flags=0x%x\",\n                     params, nparams, flags);\n    VIR_TYPED_PARAMS_DEBUG(params, nparams);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n    virCheckNonNullArgGoto(params, error);\n    virCheckNonNegativeArgGoto(nparams, error);\n\n    if (virTypedParameterValidateSet(conn, params, nparams) < 0)\n        goto error;\n\n    if (conn->driver->domainSetBlkioParameters) {\n        int ret;\n        ret = conn->driver->domainSetBlkioParameters(domain, params, nparams, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainGetNumaParameters",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "2248-2285",
    "snippet": "int\nvirDomainGetNumaParameters(virDomainPtr domain,\n                           virTypedParameterPtr params,\n                           int *nparams, unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"params=%p, nparams=%d, flags=0x%x\",\n                     params, (nparams) ? *nparams : -1, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    virCheckNonNullArgGoto(nparams, error);\n    virCheckNonNegativeArgGoto(*nparams, error);\n    if (*nparams != 0)\n        virCheckNonNullArgGoto(params, error);\n\n    if (VIR_DRV_SUPPORTS_FEATURE(domain->conn->driver, domain->conn,\n                                 VIR_DRV_FEATURE_TYPED_PARAM_STRING))\n        flags |= VIR_TYPED_PARAM_STRING_OKAY;\n\n    conn = domain->conn;\n\n    if (conn->driver->domainGetNumaParameters) {\n        int ret;\n        ret = conn->driver->domainGetNumaParameters(domain, params, nparams,\n                                                    flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "domain->conn"
          ],
          "line": 2283
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 2280
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainGetNumaParameters",
          "args": [
            "domain",
            "params",
            "nparams",
            "flags"
          ],
          "line": 2274
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DRV_SUPPORTS_FEATURE",
          "args": [
            "domain->conn->driver",
            "domain->conn",
            "VIR_DRV_FEATURE_TYPED_PARAM_STRING"
          ],
          "line": 2266
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "params",
            "error"
          ],
          "line": 2264
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNegativeArgGoto",
          "args": [
            "*nparams",
            "error"
          ],
          "line": 2262
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "nparams",
            "error"
          ],
          "line": 2261
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "domain",
            "-1"
          ],
          "line": 2260
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 2258
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "domain",
            "\"params=%p, nparams=%d, flags=0x%x\"",
            "params",
            "(nparams) ? *nparams : -1",
            "flags"
          ],
          "line": 2255
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainGetNumaParameters(virDomainPtr domain,\n                           virTypedParameterPtr params,\n                           int *nparams, unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"params=%p, nparams=%d, flags=0x%x\",\n                     params, (nparams) ? *nparams : -1, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    virCheckNonNullArgGoto(nparams, error);\n    virCheckNonNegativeArgGoto(*nparams, error);\n    if (*nparams != 0)\n        virCheckNonNullArgGoto(params, error);\n\n    if (VIR_DRV_SUPPORTS_FEATURE(domain->conn->driver, domain->conn,\n                                 VIR_DRV_FEATURE_TYPED_PARAM_STRING))\n        flags |= VIR_TYPED_PARAM_STRING_OKAY;\n\n    conn = domain->conn;\n\n    if (conn->driver->domainGetNumaParameters) {\n        int ret;\n        ret = conn->driver->domainGetNumaParameters(domain, params, nparams,\n                                                    flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainSetNumaParameters",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "2183-2219",
    "snippet": "int\nvirDomainSetNumaParameters(virDomainPtr domain,\n                           virTypedParameterPtr params,\n                           int nparams, unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"params=%p, nparams=%d, flags=0x%x\",\n                     params, nparams, flags);\n    VIR_TYPED_PARAMS_DEBUG(params, nparams);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    virCheckReadOnlyGoto(domain->conn->flags, error);\n    virCheckNonNullArgGoto(params, error);\n    virCheckPositiveArgGoto(nparams, error);\n    if (virTypedParameterValidateSet(domain->conn, params, nparams) < 0)\n        goto error;\n\n    conn = domain->conn;\n\n    if (conn->driver->domainSetNumaParameters) {\n        int ret;\n        ret = conn->driver->domainSetNumaParameters(domain, params, nparams,\n                                                    flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "domain->conn"
          ],
          "line": 2217
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 2214
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainSetNumaParameters",
          "args": [
            "domain",
            "params",
            "nparams",
            "flags"
          ],
          "line": 2207
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virTypedParameterValidateSet",
          "args": [
            "domain->conn",
            "params",
            "nparams"
          ],
          "line": 2200
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParameterValidateSet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt.c",
          "lines": "1288-1325",
          "snippet": "int\nvirTypedParameterValidateSet(virConnectPtr conn,\n                             virTypedParameterPtr params,\n                             int nparams)\n{\n    bool string_okay;\n    size_t i;\n\n    string_okay = VIR_DRV_SUPPORTS_FEATURE(conn->driver,\n                                           conn,\n                                           VIR_DRV_FEATURE_TYPED_PARAM_STRING);\n    for (i = 0; i < nparams; i++) {\n        if (strnlen(params[i].field, VIR_TYPED_PARAM_FIELD_LENGTH) ==\n            VIR_TYPED_PARAM_FIELD_LENGTH) {\n            virReportInvalidArg(params,\n                                _(\"string parameter name '%.*s' too long\"),\n                                VIR_TYPED_PARAM_FIELD_LENGTH,\n                                params[i].field);\n            return -1;\n        }\n        if (params[i].type == VIR_TYPED_PARAM_STRING) {\n            if (string_okay) {\n                if (!params[i].value.s) {\n                    virReportInvalidArg(params,\n                                        _(\"NULL string parameter '%s'\"),\n                                        params[i].field);\n                    return -1;\n                }\n            } else {\n                virReportInvalidArg(params,\n                                    _(\"string parameter '%s' unsupported\"),\n                                    params[i].field);\n                return -1;\n            }\n        }\n    }\n    return 0;\n}",
          "includes": [
            "#include \"access/viraccessmanager.h\"",
            "# include \"bhyve/bhyve_driver.h\"",
            "# include \"hyperv/hyperv_driver.h\"",
            "# include \"esx/esx_driver.h\"",
            "# include \"vmware/vmware_driver.h\"",
            "# include \"openvz/openvz_driver.h\"",
            "# include \"remote/remote_driver.h\"",
            "# include \"test/test_driver.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"viruri.h\"",
            "#include \"virrandom.h\"",
            "#include \"virfile.h\"",
            "#include \"virevent.h\"",
            "#include \"vircommand.h\"",
            "#include \"rpc/virnettlscontext.h\"",
            "#include \"virconf.h\"",
            "#include \"configmake.h\"",
            "#include \"viralloc.h\"",
            "#include \"viruuid.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <curl/curl.h>",
            "#include <libxml/xpath.h>",
            "#include <libxml/parser.h>",
            "#include <gio/gnetworking.h>",
            "#include <time.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"access/viraccessmanager.h\"\n# include \"bhyve/bhyve_driver.h\"\n# include \"hyperv/hyperv_driver.h\"\n# include \"esx/esx_driver.h\"\n# include \"vmware/vmware_driver.h\"\n# include \"openvz/openvz_driver.h\"\n# include \"remote/remote_driver.h\"\n# include \"test/test_driver.h\"\n#include \"virtypedparam.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"viruri.h\"\n#include \"virrandom.h\"\n#include \"virfile.h\"\n#include \"virevent.h\"\n#include \"vircommand.h\"\n#include \"rpc/virnettlscontext.h\"\n#include \"virconf.h\"\n#include \"configmake.h\"\n#include \"viralloc.h\"\n#include \"viruuid.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <curl/curl.h>\n#include <libxml/xpath.h>\n#include <libxml/parser.h>\n#include <gio/gnetworking.h>\n#include <time.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nint\nvirTypedParameterValidateSet(virConnectPtr conn,\n                             virTypedParameterPtr params,\n                             int nparams)\n{\n    bool string_okay;\n    size_t i;\n\n    string_okay = VIR_DRV_SUPPORTS_FEATURE(conn->driver,\n                                           conn,\n                                           VIR_DRV_FEATURE_TYPED_PARAM_STRING);\n    for (i = 0; i < nparams; i++) {\n        if (strnlen(params[i].field, VIR_TYPED_PARAM_FIELD_LENGTH) ==\n            VIR_TYPED_PARAM_FIELD_LENGTH) {\n            virReportInvalidArg(params,\n                                _(\"string parameter name '%.*s' too long\"),\n                                VIR_TYPED_PARAM_FIELD_LENGTH,\n                                params[i].field);\n            return -1;\n        }\n        if (params[i].type == VIR_TYPED_PARAM_STRING) {\n            if (string_okay) {\n                if (!params[i].value.s) {\n                    virReportInvalidArg(params,\n                                        _(\"NULL string parameter '%s'\"),\n                                        params[i].field);\n                    return -1;\n                }\n            } else {\n                virReportInvalidArg(params,\n                                    _(\"string parameter '%s' unsupported\"),\n                                    params[i].field);\n                return -1;\n            }\n        }\n    }\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckPositiveArgGoto",
          "args": [
            "nparams",
            "error"
          ],
          "line": 2199
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "params",
            "error"
          ],
          "line": 2198
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "domain->conn->flags",
            "error"
          ],
          "line": 2197
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "domain",
            "-1"
          ],
          "line": 2196
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 2194
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_TYPED_PARAMS_DEBUG",
          "args": [
            "params",
            "nparams"
          ],
          "line": 2192
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "domain",
            "\"params=%p, nparams=%d, flags=0x%x\"",
            "params",
            "nparams",
            "flags"
          ],
          "line": 2190
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainSetNumaParameters(virDomainPtr domain,\n                           virTypedParameterPtr params,\n                           int nparams, unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"params=%p, nparams=%d, flags=0x%x\",\n                     params, nparams, flags);\n    VIR_TYPED_PARAMS_DEBUG(params, nparams);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    virCheckReadOnlyGoto(domain->conn->flags, error);\n    virCheckNonNullArgGoto(params, error);\n    virCheckPositiveArgGoto(nparams, error);\n    if (virTypedParameterValidateSet(domain->conn, params, nparams) < 0)\n        goto error;\n\n    conn = domain->conn;\n\n    if (conn->driver->domainSetNumaParameters) {\n        int ret;\n        ret = conn->driver->domainSetNumaParameters(domain, params, nparams,\n                                                    flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainGetMemoryParameters",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "2127-2167",
    "snippet": "int\nvirDomainGetMemoryParameters(virDomainPtr domain,\n                             virTypedParameterPtr params,\n                             int *nparams, unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"params=%p, nparams=%d, flags=0x%x\",\n                     params, (nparams) ? *nparams : -1, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    virCheckNonNullArgGoto(nparams, error);\n    virCheckNonNegativeArgGoto(*nparams, error);\n    if (*nparams != 0)\n        virCheckNonNullArgGoto(params, error);\n\n    if (VIR_DRV_SUPPORTS_FEATURE(domain->conn->driver, domain->conn,\n                                 VIR_DRV_FEATURE_TYPED_PARAM_STRING))\n        flags |= VIR_TYPED_PARAM_STRING_OKAY;\n\n    VIR_EXCLUSIVE_FLAGS_GOTO(VIR_DOMAIN_AFFECT_LIVE,\n                             VIR_DOMAIN_AFFECT_CONFIG,\n                             error);\n\n    conn = domain->conn;\n\n    if (conn->driver->domainGetMemoryParameters) {\n        int ret;\n        ret = conn->driver->domainGetMemoryParameters(domain, params, nparams, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "domain->conn"
          ],
          "line": 2165
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 2162
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainGetMemoryParameters",
          "args": [
            "domain",
            "params",
            "nparams",
            "flags"
          ],
          "line": 2157
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_EXCLUSIVE_FLAGS_GOTO",
          "args": [
            "VIR_DOMAIN_AFFECT_LIVE",
            "VIR_DOMAIN_AFFECT_CONFIG",
            "error"
          ],
          "line": 2149
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DRV_SUPPORTS_FEATURE",
          "args": [
            "domain->conn->driver",
            "domain->conn",
            "VIR_DRV_FEATURE_TYPED_PARAM_STRING"
          ],
          "line": 2145
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "params",
            "error"
          ],
          "line": 2143
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNegativeArgGoto",
          "args": [
            "*nparams",
            "error"
          ],
          "line": 2141
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "nparams",
            "error"
          ],
          "line": 2140
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "domain",
            "-1"
          ],
          "line": 2139
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 2137
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "domain",
            "\"params=%p, nparams=%d, flags=0x%x\"",
            "params",
            "(nparams) ? *nparams : -1",
            "flags"
          ],
          "line": 2134
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainGetMemoryParameters(virDomainPtr domain,\n                             virTypedParameterPtr params,\n                             int *nparams, unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"params=%p, nparams=%d, flags=0x%x\",\n                     params, (nparams) ? *nparams : -1, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    virCheckNonNullArgGoto(nparams, error);\n    virCheckNonNegativeArgGoto(*nparams, error);\n    if (*nparams != 0)\n        virCheckNonNullArgGoto(params, error);\n\n    if (VIR_DRV_SUPPORTS_FEATURE(domain->conn->driver, domain->conn,\n                                 VIR_DRV_FEATURE_TYPED_PARAM_STRING))\n        flags |= VIR_TYPED_PARAM_STRING_OKAY;\n\n    VIR_EXCLUSIVE_FLAGS_GOTO(VIR_DOMAIN_AFFECT_LIVE,\n                             VIR_DOMAIN_AFFECT_CONFIG,\n                             error);\n\n    conn = domain->conn;\n\n    if (conn->driver->domainGetMemoryParameters) {\n        int ret;\n        ret = conn->driver->domainGetMemoryParameters(domain, params, nparams, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainSetMemoryParameters",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "2053-2089",
    "snippet": "int\nvirDomainSetMemoryParameters(virDomainPtr domain,\n                             virTypedParameterPtr params,\n                             int nparams, unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"params=%p, nparams=%d, flags=0x%x\",\n                     params, nparams, flags);\n    VIR_TYPED_PARAMS_DEBUG(params, nparams);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n    virCheckNonNullArgGoto(params, error);\n    virCheckPositiveArgGoto(nparams, error);\n\n    if (virTypedParameterValidateSet(conn, params, nparams) < 0)\n        goto error;\n\n    if (conn->driver->domainSetMemoryParameters) {\n        int ret;\n        ret = conn->driver->domainSetMemoryParameters(domain, params, nparams, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "domain->conn"
          ],
          "line": 2087
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 2084
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainSetMemoryParameters",
          "args": [
            "domain",
            "params",
            "nparams",
            "flags"
          ],
          "line": 2078
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virTypedParameterValidateSet",
          "args": [
            "conn",
            "params",
            "nparams"
          ],
          "line": 2073
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParameterValidateSet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt.c",
          "lines": "1288-1325",
          "snippet": "int\nvirTypedParameterValidateSet(virConnectPtr conn,\n                             virTypedParameterPtr params,\n                             int nparams)\n{\n    bool string_okay;\n    size_t i;\n\n    string_okay = VIR_DRV_SUPPORTS_FEATURE(conn->driver,\n                                           conn,\n                                           VIR_DRV_FEATURE_TYPED_PARAM_STRING);\n    for (i = 0; i < nparams; i++) {\n        if (strnlen(params[i].field, VIR_TYPED_PARAM_FIELD_LENGTH) ==\n            VIR_TYPED_PARAM_FIELD_LENGTH) {\n            virReportInvalidArg(params,\n                                _(\"string parameter name '%.*s' too long\"),\n                                VIR_TYPED_PARAM_FIELD_LENGTH,\n                                params[i].field);\n            return -1;\n        }\n        if (params[i].type == VIR_TYPED_PARAM_STRING) {\n            if (string_okay) {\n                if (!params[i].value.s) {\n                    virReportInvalidArg(params,\n                                        _(\"NULL string parameter '%s'\"),\n                                        params[i].field);\n                    return -1;\n                }\n            } else {\n                virReportInvalidArg(params,\n                                    _(\"string parameter '%s' unsupported\"),\n                                    params[i].field);\n                return -1;\n            }\n        }\n    }\n    return 0;\n}",
          "includes": [
            "#include \"access/viraccessmanager.h\"",
            "# include \"bhyve/bhyve_driver.h\"",
            "# include \"hyperv/hyperv_driver.h\"",
            "# include \"esx/esx_driver.h\"",
            "# include \"vmware/vmware_driver.h\"",
            "# include \"openvz/openvz_driver.h\"",
            "# include \"remote/remote_driver.h\"",
            "# include \"test/test_driver.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"viruri.h\"",
            "#include \"virrandom.h\"",
            "#include \"virfile.h\"",
            "#include \"virevent.h\"",
            "#include \"vircommand.h\"",
            "#include \"rpc/virnettlscontext.h\"",
            "#include \"virconf.h\"",
            "#include \"configmake.h\"",
            "#include \"viralloc.h\"",
            "#include \"viruuid.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <curl/curl.h>",
            "#include <libxml/xpath.h>",
            "#include <libxml/parser.h>",
            "#include <gio/gnetworking.h>",
            "#include <time.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"access/viraccessmanager.h\"\n# include \"bhyve/bhyve_driver.h\"\n# include \"hyperv/hyperv_driver.h\"\n# include \"esx/esx_driver.h\"\n# include \"vmware/vmware_driver.h\"\n# include \"openvz/openvz_driver.h\"\n# include \"remote/remote_driver.h\"\n# include \"test/test_driver.h\"\n#include \"virtypedparam.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"viruri.h\"\n#include \"virrandom.h\"\n#include \"virfile.h\"\n#include \"virevent.h\"\n#include \"vircommand.h\"\n#include \"rpc/virnettlscontext.h\"\n#include \"virconf.h\"\n#include \"configmake.h\"\n#include \"viralloc.h\"\n#include \"viruuid.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <curl/curl.h>\n#include <libxml/xpath.h>\n#include <libxml/parser.h>\n#include <gio/gnetworking.h>\n#include <time.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nint\nvirTypedParameterValidateSet(virConnectPtr conn,\n                             virTypedParameterPtr params,\n                             int nparams)\n{\n    bool string_okay;\n    size_t i;\n\n    string_okay = VIR_DRV_SUPPORTS_FEATURE(conn->driver,\n                                           conn,\n                                           VIR_DRV_FEATURE_TYPED_PARAM_STRING);\n    for (i = 0; i < nparams; i++) {\n        if (strnlen(params[i].field, VIR_TYPED_PARAM_FIELD_LENGTH) ==\n            VIR_TYPED_PARAM_FIELD_LENGTH) {\n            virReportInvalidArg(params,\n                                _(\"string parameter name '%.*s' too long\"),\n                                VIR_TYPED_PARAM_FIELD_LENGTH,\n                                params[i].field);\n            return -1;\n        }\n        if (params[i].type == VIR_TYPED_PARAM_STRING) {\n            if (string_okay) {\n                if (!params[i].value.s) {\n                    virReportInvalidArg(params,\n                                        _(\"NULL string parameter '%s'\"),\n                                        params[i].field);\n                    return -1;\n                }\n            } else {\n                virReportInvalidArg(params,\n                                    _(\"string parameter '%s' unsupported\"),\n                                    params[i].field);\n                return -1;\n            }\n        }\n    }\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckPositiveArgGoto",
          "args": [
            "nparams",
            "error"
          ],
          "line": 2071
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "params",
            "error"
          ],
          "line": 2070
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "conn->flags",
            "error"
          ],
          "line": 2069
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "domain",
            "-1"
          ],
          "line": 2066
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 2064
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_TYPED_PARAMS_DEBUG",
          "args": [
            "params",
            "nparams"
          ],
          "line": 2062
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "domain",
            "\"params=%p, nparams=%d, flags=0x%x\"",
            "params",
            "nparams",
            "flags"
          ],
          "line": 2060
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainSetMemoryParameters(virDomainPtr domain,\n                             virTypedParameterPtr params,\n                             int nparams, unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"params=%p, nparams=%d, flags=0x%x\",\n                     params, nparams, flags);\n    VIR_TYPED_PARAMS_DEBUG(params, nparams);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n    virCheckNonNullArgGoto(params, error);\n    virCheckPositiveArgGoto(nparams, error);\n\n    if (virTypedParameterValidateSet(conn, params, nparams) < 0)\n        goto error;\n\n    if (conn->driver->domainSetMemoryParameters) {\n        int ret;\n        ret = conn->driver->domainSetMemoryParameters(domain, params, nparams, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainSetMemoryStatsPeriod",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "2003-2034",
    "snippet": "int\nvirDomainSetMemoryStatsPeriod(virDomainPtr domain, int period,\n                              unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"period=%d, flags=0x%x\", period, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    /* This must be positive to set the balloon collection period */\n    virCheckNonNegativeArgGoto(period, error);\n\n    if (conn->driver->domainSetMemoryStatsPeriod) {\n        int ret;\n        ret = conn->driver->domainSetMemoryStatsPeriod(domain, period, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "domain->conn"
          ],
          "line": 2032
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 2029
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainSetMemoryStatsPeriod",
          "args": [
            "domain",
            "period",
            "flags"
          ],
          "line": 2023
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNegativeArgGoto",
          "args": [
            "period",
            "error"
          ],
          "line": 2019
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "conn->flags",
            "error"
          ],
          "line": 2016
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "domain",
            "-1"
          ],
          "line": 2013
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 2011
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "domain",
            "\"period=%d, flags=0x%x\"",
            "period",
            "flags"
          ],
          "line": 2009
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainSetMemoryStatsPeriod(virDomainPtr domain, int period,\n                              unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"period=%d, flags=0x%x\", period, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    /* This must be positive to set the balloon collection period */\n    virCheckNonNegativeArgGoto(period, error);\n\n    if (conn->driver->domainSetMemoryStatsPeriod) {\n        int ret;\n        ret = conn->driver->domainSetMemoryStatsPeriod(domain, period, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainSetMemoryFlags",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "1943-1978",
    "snippet": "int\nvirDomainSetMemoryFlags(virDomainPtr domain, unsigned long memory,\n                        unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"memory=%lu, flags=0x%x\", memory, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n    virCheckNonZeroArgGoto(memory, error);\n\n    if (virMemoryMaxValue(true) / 1024 <= memory) {\n        virReportError(VIR_ERR_OVERFLOW, _(\"input too large: %lu\"),\n                       memory);\n        goto error;\n    }\n\n    if (conn->driver->domainSetMemoryFlags) {\n        int ret;\n        ret = conn->driver->domainSetMemoryFlags(domain, memory, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "domain->conn"
          ],
          "line": 1976
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 1973
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainSetMemoryFlags",
          "args": [
            "domain",
            "memory",
            "flags"
          ],
          "line": 1967
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OVERFLOW",
            "_(\"input too large: %lu\")",
            "memory"
          ],
          "line": 1960
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"input too large: %lu\""
          ],
          "line": 1960
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virMemoryMaxValue",
          "args": [
            "true"
          ],
          "line": 1959
        },
        "resolved": true,
        "details": {
          "function_name": "virMemoryMaxValue",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
          "lines": "1645-1654",
          "snippet": "unsigned long long\nvirMemoryMaxValue(bool capped)\n{\n    /* On 32-bit machines, our bound is 0xffffffff * KiB. On 64-bit\n     * machines, our bound is off_t (2^63).  */\n    if (capped && sizeof(unsigned long) < sizeof(long long))\n        return 1024ull * ULONG_MAX;\n    else\n        return LLONG_MAX;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <sys/prctl.h>",
            "# include <cap-ng.h>",
            "# include <grp.h>",
            "# include <pwd.h>",
            "# include <libdevmapper.h>",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <conio.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nunsigned long long\nvirMemoryMaxValue(bool capped)\n{\n    /* On 32-bit machines, our bound is 0xffffffff * KiB. On 64-bit\n     * machines, our bound is off_t (2^63).  */\n    if (capped && sizeof(unsigned long) < sizeof(long long))\n        return 1024ull * ULONG_MAX;\n    else\n        return LLONG_MAX;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckNonZeroArgGoto",
          "args": [
            "memory",
            "error"
          ],
          "line": 1957
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "conn->flags",
            "error"
          ],
          "line": 1956
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "domain",
            "-1"
          ],
          "line": 1953
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 1951
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "domain",
            "\"memory=%lu, flags=0x%x\"",
            "memory",
            "flags"
          ],
          "line": 1949
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainSetMemoryFlags(virDomainPtr domain, unsigned long memory,\n                        unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"memory=%lu, flags=0x%x\", memory, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n    virCheckNonZeroArgGoto(memory, error);\n\n    if (virMemoryMaxValue(true) / 1024 <= memory) {\n        virReportError(VIR_ERR_OVERFLOW, _(\"input too large: %lu\"),\n                       memory);\n        goto error;\n    }\n\n    if (conn->driver->domainSetMemoryFlags) {\n        int ret;\n        ret = conn->driver->domainSetMemoryFlags(domain, memory, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainSetMemory",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "1881-1915",
    "snippet": "int\nvirDomainSetMemory(virDomainPtr domain, unsigned long memory)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"memory=%lu\", memory);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n    virCheckNonZeroArgGoto(memory, error);\n\n    if (virMemoryMaxValue(true) / 1024 <= memory) {\n        virReportError(VIR_ERR_OVERFLOW, _(\"input too large: %lu\"),\n                       memory);\n        goto error;\n    }\n\n    if (conn->driver->domainSetMemory) {\n        int ret;\n        ret = conn->driver->domainSetMemory(domain, memory);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "domain->conn"
          ],
          "line": 1913
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 1910
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainSetMemory",
          "args": [
            "domain",
            "memory"
          ],
          "line": 1904
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OVERFLOW",
            "_(\"input too large: %lu\")",
            "memory"
          ],
          "line": 1897
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"input too large: %lu\""
          ],
          "line": 1897
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virMemoryMaxValue",
          "args": [
            "true"
          ],
          "line": 1896
        },
        "resolved": true,
        "details": {
          "function_name": "virMemoryMaxValue",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
          "lines": "1645-1654",
          "snippet": "unsigned long long\nvirMemoryMaxValue(bool capped)\n{\n    /* On 32-bit machines, our bound is 0xffffffff * KiB. On 64-bit\n     * machines, our bound is off_t (2^63).  */\n    if (capped && sizeof(unsigned long) < sizeof(long long))\n        return 1024ull * ULONG_MAX;\n    else\n        return LLONG_MAX;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <sys/prctl.h>",
            "# include <cap-ng.h>",
            "# include <grp.h>",
            "# include <pwd.h>",
            "# include <libdevmapper.h>",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <conio.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nunsigned long long\nvirMemoryMaxValue(bool capped)\n{\n    /* On 32-bit machines, our bound is 0xffffffff * KiB. On 64-bit\n     * machines, our bound is off_t (2^63).  */\n    if (capped && sizeof(unsigned long) < sizeof(long long))\n        return 1024ull * ULONG_MAX;\n    else\n        return LLONG_MAX;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckNonZeroArgGoto",
          "args": [
            "memory",
            "error"
          ],
          "line": 1894
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "conn->flags",
            "error"
          ],
          "line": 1893
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "domain",
            "-1"
          ],
          "line": 1890
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 1888
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "domain",
            "\"memory=%lu\"",
            "memory"
          ],
          "line": 1886
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainSetMemory(virDomainPtr domain, unsigned long memory)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"memory=%lu\", memory);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n    virCheckNonZeroArgGoto(memory, error);\n\n    if (virMemoryMaxValue(true) / 1024 <= memory) {\n        virReportError(VIR_ERR_OVERFLOW, _(\"input too large: %lu\"),\n                       memory);\n        goto error;\n    }\n\n    if (conn->driver->domainSetMemory) {\n        int ret;\n        ret = conn->driver->domainSetMemory(domain, memory);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainSetMaxMemory",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "1828-1862",
    "snippet": "int\nvirDomainSetMaxMemory(virDomainPtr domain, unsigned long memory)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"memory=%lu\", memory);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n    virCheckNonZeroArgGoto(memory, error);\n\n    if (virMemoryMaxValue(true) / 1024 <= memory) {\n        virReportError(VIR_ERR_OVERFLOW, _(\"input too large: %lu\"),\n                       memory);\n        goto error;\n    }\n\n    if (conn->driver->domainSetMaxMemory) {\n        int ret;\n        ret = conn->driver->domainSetMaxMemory(domain, memory);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "domain->conn"
          ],
          "line": 1860
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 1857
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainSetMaxMemory",
          "args": [
            "domain",
            "memory"
          ],
          "line": 1851
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OVERFLOW",
            "_(\"input too large: %lu\")",
            "memory"
          ],
          "line": 1844
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"input too large: %lu\""
          ],
          "line": 1844
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virMemoryMaxValue",
          "args": [
            "true"
          ],
          "line": 1843
        },
        "resolved": true,
        "details": {
          "function_name": "virMemoryMaxValue",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
          "lines": "1645-1654",
          "snippet": "unsigned long long\nvirMemoryMaxValue(bool capped)\n{\n    /* On 32-bit machines, our bound is 0xffffffff * KiB. On 64-bit\n     * machines, our bound is off_t (2^63).  */\n    if (capped && sizeof(unsigned long) < sizeof(long long))\n        return 1024ull * ULONG_MAX;\n    else\n        return LLONG_MAX;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <sys/prctl.h>",
            "# include <cap-ng.h>",
            "# include <grp.h>",
            "# include <pwd.h>",
            "# include <libdevmapper.h>",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <conio.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nunsigned long long\nvirMemoryMaxValue(bool capped)\n{\n    /* On 32-bit machines, our bound is 0xffffffff * KiB. On 64-bit\n     * machines, our bound is off_t (2^63).  */\n    if (capped && sizeof(unsigned long) < sizeof(long long))\n        return 1024ull * ULONG_MAX;\n    else\n        return LLONG_MAX;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckNonZeroArgGoto",
          "args": [
            "memory",
            "error"
          ],
          "line": 1841
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "conn->flags",
            "error"
          ],
          "line": 1840
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "domain",
            "-1"
          ],
          "line": 1837
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 1835
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "domain",
            "\"memory=%lu\"",
            "memory"
          ],
          "line": 1833
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainSetMaxMemory(virDomainPtr domain, unsigned long memory)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"memory=%lu\", memory);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n    virCheckNonZeroArgGoto(memory, error);\n\n    if (virMemoryMaxValue(true) / 1024 <= memory) {\n        virReportError(VIR_ERR_OVERFLOW, _(\"input too large: %lu\"),\n                       memory);\n        goto error;\n    }\n\n    if (conn->driver->domainSetMaxMemory) {\n        int ret;\n        ret = conn->driver->domainSetMaxMemory(domain, memory);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainGetMaxMemory",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "1779-1809",
    "snippet": "unsigned long\nvirDomainGetMaxMemory(virDomainPtr domain)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, 0);\n    conn = domain->conn;\n\n    if (conn->driver->domainGetMaxMemory) {\n        unsigned long long ret;\n        ret = conn->driver->domainGetMaxMemory(domain);\n        if (ret == 0)\n            goto error;\n        if ((unsigned long) ret != ret) {\n            virReportError(VIR_ERR_OVERFLOW, _(\"result too large: %llu\"),\n                           ret);\n            goto error;\n        }\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return 0;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "domain->conn"
          ],
          "line": 1807
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 1804
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OVERFLOW",
            "_(\"result too large: %llu\")",
            "ret"
          ],
          "line": 1797
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"result too large: %llu\""
          ],
          "line": 1797
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "conn->driver->domainGetMaxMemory",
          "args": [
            "domain"
          ],
          "line": 1793
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "domain",
            "0"
          ],
          "line": 1788
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 1786
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "domain"
          ],
          "line": 1784
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nunsigned long\nvirDomainGetMaxMemory(virDomainPtr domain)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, 0);\n    conn = domain->conn;\n\n    if (conn->driver->domainGetMaxMemory) {\n        unsigned long long ret;\n        ret = conn->driver->domainGetMaxMemory(domain);\n        if (ret == 0)\n            goto error;\n        if ((unsigned long) ret != ret) {\n            virReportError(VIR_ERR_OVERFLOW, _(\"result too large: %llu\"),\n                           ret);\n            goto error;\n        }\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return 0;\n}"
  },
  {
    "function_name": "virDomainGetOSType",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "1740-1765",
    "snippet": "char *\nvirDomainGetOSType(virDomainPtr domain)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, NULL);\n    conn = domain->conn;\n\n    if (conn->driver->domainGetOSType) {\n        char *ret;\n        ret = conn->driver->domainGetOSType(domain);\n        if (!ret)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return NULL;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "domain->conn"
          ],
          "line": 1763
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 1760
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainGetOSType",
          "args": [
            "domain"
          ],
          "line": 1754
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "domain",
            "NULL"
          ],
          "line": 1749
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 1747
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "domain"
          ],
          "line": 1745
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nchar *\nvirDomainGetOSType(virDomainPtr domain)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, NULL);\n    conn = domain->conn;\n\n    if (conn->driver->domainGetOSType) {\n        char *ret;\n        ret = conn->driver->domainGetOSType(domain);\n        if (!ret)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return NULL;\n}"
  },
  {
    "function_name": "virDomainGetID",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "1718-1728",
    "snippet": "unsigned int\nvirDomainGetID(virDomainPtr domain)\n{\n    VIR_DOMAIN_DEBUG(domain);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, (unsigned int)-1);\n\n    return domain->id;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "domain",
            "(unsigned int)-1"
          ],
          "line": 1725
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 1723
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "domain"
          ],
          "line": 1721
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nunsigned int\nvirDomainGetID(virDomainPtr domain)\n{\n    VIR_DOMAIN_DEBUG(domain);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, (unsigned int)-1);\n\n    return domain->id;\n}"
  },
  {
    "function_name": "virDomainGetUUIDString",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "1691-1707",
    "snippet": "int\nvirDomainGetUUIDString(virDomainPtr domain, char *buf)\n{\n    VIR_DOMAIN_DEBUG(domain, \"buf=%p\", buf);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    virCheckNonNullArgGoto(buf, error);\n\n    virUUIDFormat(domain->uuid, buf);\n    return 0;\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "domain->conn"
          ],
          "line": 1705
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virUUIDFormat",
          "args": [
            "domain->uuid",
            "buf"
          ],
          "line": 1701
        },
        "resolved": true,
        "details": {
          "function_name": "virUUIDFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viruuid.c",
          "lines": "148-159",
          "snippet": "const char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}",
          "includes": [
            "#include \"virrandom.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include \"viruuid.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virrandom.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <unistd.h>\n#include <time.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include \"viruuid.h\"\n#include <config.h>\n\nconst char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "buf",
            "error"
          ],
          "line": 1699
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "domain",
            "-1"
          ],
          "line": 1698
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 1696
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "domain",
            "\"buf=%p\"",
            "buf"
          ],
          "line": 1694
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainGetUUIDString(virDomainPtr domain, char *buf)\n{\n    VIR_DOMAIN_DEBUG(domain, \"buf=%p\", buf);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    virCheckNonNullArgGoto(buf, error);\n\n    virUUIDFormat(domain->uuid, buf);\n    return 0;\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainGetUUID",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "1661-1678",
    "snippet": "int\nvirDomainGetUUID(virDomainPtr domain, unsigned char *uuid)\n{\n    VIR_DOMAIN_DEBUG(domain, \"uuid=%p\", uuid);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    virCheckNonNullArgGoto(uuid, error);\n\n    memcpy(uuid, &domain->uuid[0], VIR_UUID_BUFLEN);\n\n    return 0;\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "domain->conn"
          ],
          "line": 1676
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "uuid",
            "&domain->uuid[0]",
            "VIR_UUID_BUFLEN"
          ],
          "line": 1671
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "uuid",
            "error"
          ],
          "line": 1669
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "domain",
            "-1"
          ],
          "line": 1668
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 1666
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "domain",
            "\"uuid=%p\"",
            "uuid"
          ],
          "line": 1664
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainGetUUID(virDomainPtr domain, unsigned char *uuid)\n{\n    VIR_DOMAIN_DEBUG(domain, \"uuid=%p\", uuid);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    virCheckNonNullArgGoto(uuid, error);\n\n    memcpy(uuid, &domain->uuid[0], VIR_UUID_BUFLEN);\n\n    return 0;\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainGetName",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "1639-1649",
    "snippet": "const char *\nvirDomainGetName(virDomainPtr domain)\n{\n    VIR_DEBUG(\"domain=%p\", domain);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, NULL);\n\n    return domain->name;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "domain",
            "NULL"
          ],
          "line": 1646
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 1644
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"domain=%p\"",
            "domain"
          ],
          "line": 1642
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nconst char *\nvirDomainGetName(virDomainPtr domain)\n{\n    VIR_DEBUG(\"domain=%p\", domain);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, NULL);\n\n    return domain->name;\n}"
  },
  {
    "function_name": "virDomainReset",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "1600-1627",
    "snippet": "int\nvirDomainReset(virDomainPtr domain, unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"flags=0x%x\", flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->driver->domainReset) {\n        int ret;\n        ret = conn->driver->domainReset(domain, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "domain->conn"
          ],
          "line": 1625
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 1622
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainReset",
          "args": [
            "domain",
            "flags"
          ],
          "line": 1616
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "conn->flags",
            "error"
          ],
          "line": 1612
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "domain",
            "-1"
          ],
          "line": 1609
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 1607
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "domain",
            "\"flags=0x%x\"",
            "flags"
          ],
          "line": 1605
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainReset(virDomainPtr domain, unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"flags=0x%x\", flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->driver->domainReset) {\n        int ret;\n        ret = conn->driver->domainReset(domain, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainReboot",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "1556-1583",
    "snippet": "int\nvirDomainReboot(virDomainPtr domain, unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"flags=0x%x\", flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->driver->domainReboot) {\n        int ret;\n        ret = conn->driver->domainReboot(domain, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "domain->conn"
          ],
          "line": 1581
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 1578
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainReboot",
          "args": [
            "domain",
            "flags"
          ],
          "line": 1572
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "conn->flags",
            "error"
          ],
          "line": 1568
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "domain",
            "-1"
          ],
          "line": 1565
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 1563
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "domain",
            "\"flags=0x%x\"",
            "flags"
          ],
          "line": 1561
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainReboot(virDomainPtr domain, unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"flags=0x%x\", flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->driver->domainReboot) {\n        int ret;\n        ret = conn->driver->domainReboot(domain, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainShutdownFlags",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "1498-1525",
    "snippet": "int\nvirDomainShutdownFlags(virDomainPtr domain, unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"flags=0x%x\", flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->driver->domainShutdownFlags) {\n        int ret;\n        ret = conn->driver->domainShutdownFlags(domain, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "domain->conn"
          ],
          "line": 1523
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 1520
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainShutdownFlags",
          "args": [
            "domain",
            "flags"
          ],
          "line": 1514
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "conn->flags",
            "error"
          ],
          "line": 1510
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "domain",
            "-1"
          ],
          "line": 1507
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 1505
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "domain",
            "\"flags=0x%x\"",
            "flags"
          ],
          "line": 1503
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainShutdownFlags(virDomainPtr domain, unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"flags=0x%x\", flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->driver->domainShutdownFlags) {\n        int ret;\n        ret = conn->driver->domainShutdownFlags(domain, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainShutdown",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "1438-1465",
    "snippet": "int\nvirDomainShutdown(virDomainPtr domain)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->driver->domainShutdown) {\n        int ret;\n        ret = conn->driver->domainShutdown(domain);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "domain->conn"
          ],
          "line": 1463
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 1460
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainShutdown",
          "args": [
            "domain"
          ],
          "line": 1454
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "conn->flags",
            "error"
          ],
          "line": 1450
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "domain",
            "-1"
          ],
          "line": 1447
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 1445
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "domain"
          ],
          "line": 1443
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainShutdown(virDomainPtr domain)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->driver->domainShutdown) {\n        int ret;\n        ret = conn->driver->domainShutdown(domain);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainScreenshot",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "1379-1415",
    "snippet": "char *\nvirDomainScreenshot(virDomainPtr domain,\n                    virStreamPtr stream,\n                    unsigned int screen,\n                    unsigned int flags)\n{\n    VIR_DOMAIN_DEBUG(domain, \"stream=%p, flags=0x%x\", stream, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, NULL);\n    virCheckStreamGoto(stream, error);\n    virCheckReadOnlyGoto(domain->conn->flags, error);\n\n    if (domain->conn != stream->conn) {\n        virReportInvalidArg(stream,\n                            _(\"stream must match connection of domain '%s'\"),\n                            domain->name);\n        goto error;\n    }\n\n    if (domain->conn->driver->domainScreenshot) {\n        char *ret;\n        ret = domain->conn->driver->domainScreenshot(domain, stream,\n                                                     screen, flags);\n\n        if (ret == NULL)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return NULL;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "domain->conn"
          ],
          "line": 1413
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 1410
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "domain->conn->driver->domainScreenshot",
          "args": [
            "domain",
            "stream",
            "screen",
            "flags"
          ],
          "line": 1402
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportInvalidArg",
          "args": [
            "stream",
            "_(\"stream must match connection of domain '%s'\")",
            "domain->name"
          ],
          "line": 1394
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"stream must match connection of domain '%s'\""
          ],
          "line": 1395
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "domain->conn->flags",
            "error"
          ],
          "line": 1391
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckStreamGoto",
          "args": [
            "stream",
            "error"
          ],
          "line": 1390
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "domain",
            "NULL"
          ],
          "line": 1389
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 1387
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "domain",
            "\"stream=%p, flags=0x%x\"",
            "stream",
            "flags"
          ],
          "line": 1385
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nchar *\nvirDomainScreenshot(virDomainPtr domain,\n                    virStreamPtr stream,\n                    unsigned int screen,\n                    unsigned int flags)\n{\n    VIR_DOMAIN_DEBUG(domain, \"stream=%p, flags=0x%x\", stream, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, NULL);\n    virCheckStreamGoto(stream, error);\n    virCheckReadOnlyGoto(domain->conn->flags, error);\n\n    if (domain->conn != stream->conn) {\n        virReportInvalidArg(stream,\n                            _(\"stream must match connection of domain '%s'\"),\n                            domain->name);\n        goto error;\n    }\n\n    if (domain->conn->driver->domainScreenshot) {\n        char *ret;\n        ret = domain->conn->driver->domainScreenshot(domain, stream,\n                                                     screen, flags);\n\n        if (ret == NULL)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return NULL;\n}"
  },
  {
    "function_name": "virDomainCoreDumpWithFormat",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "1300-1353",
    "snippet": "int\nvirDomainCoreDumpWithFormat(virDomainPtr domain, const char *to,\n                            unsigned int dumpformat, unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"to=%s, dumpformat=%u, flags=0x%x\",\n                     to, dumpformat, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n    virCheckNonNullArgGoto(to, error);\n\n    if (dumpformat >= VIR_DOMAIN_CORE_DUMP_FORMAT_LAST) {\n        virReportInvalidArg(flags, _(\"dumpformat '%d' is not supported\"),\n                            dumpformat);\n        goto error;\n    }\n\n    VIR_EXCLUSIVE_FLAGS_GOTO(VIR_DUMP_CRASH, VIR_DUMP_LIVE, error);\n    VIR_EXCLUSIVE_FLAGS_GOTO(VIR_DUMP_CRASH, VIR_DUMP_RESET, error);\n    VIR_EXCLUSIVE_FLAGS_GOTO(VIR_DUMP_LIVE, VIR_DUMP_RESET, error);\n\n    if (conn->driver->domainCoreDumpWithFormat) {\n        int ret;\n        char *absolute_to;\n\n        /* We must absolutize the file path as the save is done out of process */\n        if (virFileAbsPath(to, &absolute_to) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"could not build absolute core file path\"));\n            goto error;\n        }\n\n        ret = conn->driver->domainCoreDumpWithFormat(domain, absolute_to,\n                                                     dumpformat, flags);\n\n        VIR_FREE(absolute_to);\n\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "domain->conn"
          ],
          "line": 1351
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 1348
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "absolute_to"
          ],
          "line": 1341
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainCoreDumpWithFormat",
          "args": [
            "domain",
            "absolute_to",
            "dumpformat",
            "flags"
          ],
          "line": 1338
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"could not build absolute core file path\")"
          ],
          "line": 1333
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"could not build absolute core file path\""
          ],
          "line": 1334
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virFileAbsPath",
          "args": [
            "to",
            "&absolute_to"
          ],
          "line": 1332
        },
        "resolved": true,
        "details": {
          "function_name": "virFileAbsPath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "3227-3239",
          "snippet": "int\nvirFileAbsPath(const char *path, char **abspath)\n{\n    if (path[0] == '/') {\n        *abspath = g_strdup(path);\n    } else {\n        g_autofree char *buf = g_get_current_dir();\n\n        *abspath = g_strdup_printf(\"%s/%s\", buf, path);\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileAbsPath(const char *path, char **abspath)\n{\n    if (path[0] == '/') {\n        *abspath = g_strdup(path);\n    } else {\n        g_autofree char *buf = g_get_current_dir();\n\n        *abspath = g_strdup_printf(\"%s/%s\", buf, path);\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_EXCLUSIVE_FLAGS_GOTO",
          "args": [
            "VIR_DUMP_LIVE",
            "VIR_DUMP_RESET",
            "error"
          ],
          "line": 1325
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_EXCLUSIVE_FLAGS_GOTO",
          "args": [
            "VIR_DUMP_CRASH",
            "VIR_DUMP_RESET",
            "error"
          ],
          "line": 1324
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_EXCLUSIVE_FLAGS_GOTO",
          "args": [
            "VIR_DUMP_CRASH",
            "VIR_DUMP_LIVE",
            "error"
          ],
          "line": 1323
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportInvalidArg",
          "args": [
            "flags",
            "_(\"dumpformat '%d' is not supported\")",
            "dumpformat"
          ],
          "line": 1318
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "to",
            "error"
          ],
          "line": 1315
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "conn->flags",
            "error"
          ],
          "line": 1314
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "domain",
            "-1"
          ],
          "line": 1311
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 1309
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "domain",
            "\"to=%s, dumpformat=%u, flags=0x%x\"",
            "to",
            "dumpformat",
            "flags"
          ],
          "line": 1306
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainCoreDumpWithFormat(virDomainPtr domain, const char *to,\n                            unsigned int dumpformat, unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"to=%s, dumpformat=%u, flags=0x%x\",\n                     to, dumpformat, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n    virCheckNonNullArgGoto(to, error);\n\n    if (dumpformat >= VIR_DOMAIN_CORE_DUMP_FORMAT_LAST) {\n        virReportInvalidArg(flags, _(\"dumpformat '%d' is not supported\"),\n                            dumpformat);\n        goto error;\n    }\n\n    VIR_EXCLUSIVE_FLAGS_GOTO(VIR_DUMP_CRASH, VIR_DUMP_LIVE, error);\n    VIR_EXCLUSIVE_FLAGS_GOTO(VIR_DUMP_CRASH, VIR_DUMP_RESET, error);\n    VIR_EXCLUSIVE_FLAGS_GOTO(VIR_DUMP_LIVE, VIR_DUMP_RESET, error);\n\n    if (conn->driver->domainCoreDumpWithFormat) {\n        int ret;\n        char *absolute_to;\n\n        /* We must absolutize the file path as the save is done out of process */\n        if (virFileAbsPath(to, &absolute_to) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"could not build absolute core file path\"));\n            goto error;\n        }\n\n        ret = conn->driver->domainCoreDumpWithFormat(domain, absolute_to,\n                                                     dumpformat, flags);\n\n        VIR_FREE(absolute_to);\n\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainCoreDump",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "1224-1268",
    "snippet": "int\nvirDomainCoreDump(virDomainPtr domain, const char *to, unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"to=%s, flags=0x%x\", to, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n    virCheckNonNullArgGoto(to, error);\n\n    VIR_EXCLUSIVE_FLAGS_GOTO(VIR_DUMP_CRASH, VIR_DUMP_LIVE, error);\n    VIR_EXCLUSIVE_FLAGS_GOTO(VIR_DUMP_CRASH, VIR_DUMP_RESET, error);\n    VIR_EXCLUSIVE_FLAGS_GOTO(VIR_DUMP_LIVE, VIR_DUMP_RESET, error);\n\n    if (conn->driver->domainCoreDump) {\n        int ret;\n        char *absolute_to;\n\n        /* We must absolutize the file path as the save is done out of process */\n        if (virFileAbsPath(to, &absolute_to) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"could not build absolute core file path\"));\n            goto error;\n        }\n\n        ret = conn->driver->domainCoreDump(domain, absolute_to, flags);\n\n        VIR_FREE(absolute_to);\n\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "domain->conn"
          ],
          "line": 1266
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 1263
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "absolute_to"
          ],
          "line": 1256
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainCoreDump",
          "args": [
            "domain",
            "absolute_to",
            "flags"
          ],
          "line": 1254
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"could not build absolute core file path\")"
          ],
          "line": 1249
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"could not build absolute core file path\""
          ],
          "line": 1250
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virFileAbsPath",
          "args": [
            "to",
            "&absolute_to"
          ],
          "line": 1248
        },
        "resolved": true,
        "details": {
          "function_name": "virFileAbsPath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "3227-3239",
          "snippet": "int\nvirFileAbsPath(const char *path, char **abspath)\n{\n    if (path[0] == '/') {\n        *abspath = g_strdup(path);\n    } else {\n        g_autofree char *buf = g_get_current_dir();\n\n        *abspath = g_strdup_printf(\"%s/%s\", buf, path);\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileAbsPath(const char *path, char **abspath)\n{\n    if (path[0] == '/') {\n        *abspath = g_strdup(path);\n    } else {\n        g_autofree char *buf = g_get_current_dir();\n\n        *abspath = g_strdup_printf(\"%s/%s\", buf, path);\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_EXCLUSIVE_FLAGS_GOTO",
          "args": [
            "VIR_DUMP_LIVE",
            "VIR_DUMP_RESET",
            "error"
          ],
          "line": 1241
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_EXCLUSIVE_FLAGS_GOTO",
          "args": [
            "VIR_DUMP_CRASH",
            "VIR_DUMP_RESET",
            "error"
          ],
          "line": 1240
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_EXCLUSIVE_FLAGS_GOTO",
          "args": [
            "VIR_DUMP_CRASH",
            "VIR_DUMP_LIVE",
            "error"
          ],
          "line": 1239
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "to",
            "error"
          ],
          "line": 1237
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "conn->flags",
            "error"
          ],
          "line": 1236
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "domain",
            "-1"
          ],
          "line": 1233
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 1231
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "domain",
            "\"to=%s, flags=0x%x\"",
            "to",
            "flags"
          ],
          "line": 1229
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainCoreDump(virDomainPtr domain, const char *to, unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"to=%s, flags=0x%x\", to, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n    virCheckNonNullArgGoto(to, error);\n\n    VIR_EXCLUSIVE_FLAGS_GOTO(VIR_DUMP_CRASH, VIR_DUMP_LIVE, error);\n    VIR_EXCLUSIVE_FLAGS_GOTO(VIR_DUMP_CRASH, VIR_DUMP_RESET, error);\n    VIR_EXCLUSIVE_FLAGS_GOTO(VIR_DUMP_LIVE, VIR_DUMP_RESET, error);\n\n    if (conn->driver->domainCoreDump) {\n        int ret;\n        char *absolute_to;\n\n        /* We must absolutize the file path as the save is done out of process */\n        if (virFileAbsPath(to, &absolute_to) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"could not build absolute core file path\"));\n            goto error;\n        }\n\n        ret = conn->driver->domainCoreDump(domain, absolute_to, flags);\n\n        VIR_FREE(absolute_to);\n\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainSaveImageDefineXML",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "1150-1194",
    "snippet": "int\nvirDomainSaveImageDefineXML(virConnectPtr conn, const char *file,\n                            const char *dxml, unsigned int flags)\n{\n    VIR_DEBUG(\"conn=%p, file=%s, dxml=%s, flags=0x%x\",\n              conn, NULLSTR(file), NULLSTR(dxml), flags);\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, -1);\n    virCheckReadOnlyGoto(conn->flags, error);\n    virCheckNonNullArgGoto(file, error);\n    virCheckNonNullArgGoto(dxml, error);\n\n    VIR_EXCLUSIVE_FLAGS_GOTO(VIR_DOMAIN_SAVE_RUNNING,\n                             VIR_DOMAIN_SAVE_PAUSED,\n                             error);\n\n    if (conn->driver->domainSaveImageDefineXML) {\n        int ret;\n        char *absolute_file;\n\n        /* We must absolutize the file path as the read is done out of process */\n        if (virFileAbsPath(file, &absolute_file) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"could not build absolute input file path\"));\n            goto error;\n        }\n\n        ret = conn->driver->domainSaveImageDefineXML(conn, absolute_file,\n                                                     dxml, flags);\n\n        VIR_FREE(absolute_file);\n\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "conn"
          ],
          "line": 1192
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 1189
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "absolute_file"
          ],
          "line": 1182
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainSaveImageDefineXML",
          "args": [
            "conn",
            "absolute_file",
            "dxml",
            "flags"
          ],
          "line": 1179
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"could not build absolute input file path\")"
          ],
          "line": 1174
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"could not build absolute input file path\""
          ],
          "line": 1175
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virFileAbsPath",
          "args": [
            "file",
            "&absolute_file"
          ],
          "line": 1173
        },
        "resolved": true,
        "details": {
          "function_name": "virFileAbsPath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "3227-3239",
          "snippet": "int\nvirFileAbsPath(const char *path, char **abspath)\n{\n    if (path[0] == '/') {\n        *abspath = g_strdup(path);\n    } else {\n        g_autofree char *buf = g_get_current_dir();\n\n        *abspath = g_strdup_printf(\"%s/%s\", buf, path);\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileAbsPath(const char *path, char **abspath)\n{\n    if (path[0] == '/') {\n        *abspath = g_strdup(path);\n    } else {\n        g_autofree char *buf = g_get_current_dir();\n\n        *abspath = g_strdup_printf(\"%s/%s\", buf, path);\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_EXCLUSIVE_FLAGS_GOTO",
          "args": [
            "VIR_DOMAIN_SAVE_RUNNING",
            "VIR_DOMAIN_SAVE_PAUSED",
            "error"
          ],
          "line": 1164
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "dxml",
            "error"
          ],
          "line": 1162
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "file",
            "error"
          ],
          "line": 1161
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "conn->flags",
            "error"
          ],
          "line": 1160
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckConnectReturn",
          "args": [
            "conn",
            "-1"
          ],
          "line": 1159
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 1157
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"conn=%p, file=%s, dxml=%s, flags=0x%x\"",
            "conn",
            "NULLSTR(file)",
            "NULLSTR(dxml)",
            "flags"
          ],
          "line": 1154
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "dxml"
          ],
          "line": 1155
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "file"
          ],
          "line": 1155
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainSaveImageDefineXML(virConnectPtr conn, const char *file,\n                            const char *dxml, unsigned int flags)\n{\n    VIR_DEBUG(\"conn=%p, file=%s, dxml=%s, flags=0x%x\",\n              conn, NULLSTR(file), NULLSTR(dxml), flags);\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, -1);\n    virCheckReadOnlyGoto(conn->flags, error);\n    virCheckNonNullArgGoto(file, error);\n    virCheckNonNullArgGoto(dxml, error);\n\n    VIR_EXCLUSIVE_FLAGS_GOTO(VIR_DOMAIN_SAVE_RUNNING,\n                             VIR_DOMAIN_SAVE_PAUSED,\n                             error);\n\n    if (conn->driver->domainSaveImageDefineXML) {\n        int ret;\n        char *absolute_file;\n\n        /* We must absolutize the file path as the read is done out of process */\n        if (virFileAbsPath(file, &absolute_file) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"could not build absolute input file path\"));\n            goto error;\n        }\n\n        ret = conn->driver->domainSaveImageDefineXML(conn, absolute_file,\n                                                     dxml, flags);\n\n        VIR_FREE(absolute_file);\n\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainSaveImageGetXMLDesc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "1082-1121",
    "snippet": "char *\nvirDomainSaveImageGetXMLDesc(virConnectPtr conn, const char *file,\n                             unsigned int flags)\n{\n    VIR_DEBUG(\"conn=%p, file=%s, flags=0x%x\",\n              conn, NULLSTR(file), flags);\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, NULL);\n    virCheckNonNullArgGoto(file, error);\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->driver->domainSaveImageGetXMLDesc) {\n        char *ret;\n        char *absolute_file;\n\n        /* We must absolutize the file path as the read is done out of process */\n        if (virFileAbsPath(file, &absolute_file) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"could not build absolute input file path\"));\n            goto error;\n        }\n\n        ret = conn->driver->domainSaveImageGetXMLDesc(conn, absolute_file,\n                                                      flags);\n\n        VIR_FREE(absolute_file);\n\n        if (!ret)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return NULL;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "conn"
          ],
          "line": 1119
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 1116
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "absolute_file"
          ],
          "line": 1109
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainSaveImageGetXMLDesc",
          "args": [
            "conn",
            "absolute_file",
            "flags"
          ],
          "line": 1106
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"could not build absolute input file path\")"
          ],
          "line": 1101
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"could not build absolute input file path\""
          ],
          "line": 1102
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virFileAbsPath",
          "args": [
            "file",
            "&absolute_file"
          ],
          "line": 1100
        },
        "resolved": true,
        "details": {
          "function_name": "virFileAbsPath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "3227-3239",
          "snippet": "int\nvirFileAbsPath(const char *path, char **abspath)\n{\n    if (path[0] == '/') {\n        *abspath = g_strdup(path);\n    } else {\n        g_autofree char *buf = g_get_current_dir();\n\n        *abspath = g_strdup_printf(\"%s/%s\", buf, path);\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileAbsPath(const char *path, char **abspath)\n{\n    if (path[0] == '/') {\n        *abspath = g_strdup(path);\n    } else {\n        g_autofree char *buf = g_get_current_dir();\n\n        *abspath = g_strdup_printf(\"%s/%s\", buf, path);\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "conn->flags",
            "error"
          ],
          "line": 1093
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "file",
            "error"
          ],
          "line": 1092
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckConnectReturn",
          "args": [
            "conn",
            "NULL"
          ],
          "line": 1091
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 1089
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"conn=%p, file=%s, flags=0x%x\"",
            "conn",
            "NULLSTR(file)",
            "flags"
          ],
          "line": 1086
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "file"
          ],
          "line": 1087
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nchar *\nvirDomainSaveImageGetXMLDesc(virConnectPtr conn, const char *file,\n                             unsigned int flags)\n{\n    VIR_DEBUG(\"conn=%p, file=%s, flags=0x%x\",\n              conn, NULLSTR(file), flags);\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, NULL);\n    virCheckNonNullArgGoto(file, error);\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->driver->domainSaveImageGetXMLDesc) {\n        char *ret;\n        char *absolute_file;\n\n        /* We must absolutize the file path as the read is done out of process */\n        if (virFileAbsPath(file, &absolute_file) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"could not build absolute input file path\"));\n            goto error;\n        }\n\n        ret = conn->driver->domainSaveImageGetXMLDesc(conn, absolute_file,\n                                                      flags);\n\n        VIR_FREE(absolute_file);\n\n        if (!ret)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return NULL;\n}"
  },
  {
    "function_name": "virDomainRestoreFlags",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "1020-1063",
    "snippet": "int\nvirDomainRestoreFlags(virConnectPtr conn, const char *from, const char *dxml,\n                      unsigned int flags)\n{\n    VIR_DEBUG(\"conn=%p, from=%s, dxml=%s, flags=0x%x\",\n              conn, NULLSTR(from), NULLSTR(dxml), flags);\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, -1);\n    virCheckReadOnlyGoto(conn->flags, error);\n    virCheckNonNullArgGoto(from, error);\n\n    VIR_EXCLUSIVE_FLAGS_GOTO(VIR_DOMAIN_SAVE_RUNNING,\n                             VIR_DOMAIN_SAVE_PAUSED,\n                             error);\n\n    if (conn->driver->domainRestoreFlags) {\n        int ret;\n        char *absolute_from;\n\n        /* We must absolutize the file path as the restore is done out of process */\n        if (virFileAbsPath(from, &absolute_from) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"could not build absolute input file path\"));\n            goto error;\n        }\n\n        ret = conn->driver->domainRestoreFlags(conn, absolute_from, dxml,\n                                               flags);\n\n        VIR_FREE(absolute_from);\n\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "conn"
          ],
          "line": 1061
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 1058
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "absolute_from"
          ],
          "line": 1051
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainRestoreFlags",
          "args": [
            "conn",
            "absolute_from",
            "dxml",
            "flags"
          ],
          "line": 1048
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"could not build absolute input file path\")"
          ],
          "line": 1043
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"could not build absolute input file path\""
          ],
          "line": 1044
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virFileAbsPath",
          "args": [
            "from",
            "&absolute_from"
          ],
          "line": 1042
        },
        "resolved": true,
        "details": {
          "function_name": "virFileAbsPath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "3227-3239",
          "snippet": "int\nvirFileAbsPath(const char *path, char **abspath)\n{\n    if (path[0] == '/') {\n        *abspath = g_strdup(path);\n    } else {\n        g_autofree char *buf = g_get_current_dir();\n\n        *abspath = g_strdup_printf(\"%s/%s\", buf, path);\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileAbsPath(const char *path, char **abspath)\n{\n    if (path[0] == '/') {\n        *abspath = g_strdup(path);\n    } else {\n        g_autofree char *buf = g_get_current_dir();\n\n        *abspath = g_strdup_printf(\"%s/%s\", buf, path);\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_EXCLUSIVE_FLAGS_GOTO",
          "args": [
            "VIR_DOMAIN_SAVE_RUNNING",
            "VIR_DOMAIN_SAVE_PAUSED",
            "error"
          ],
          "line": 1033
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "from",
            "error"
          ],
          "line": 1031
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "conn->flags",
            "error"
          ],
          "line": 1030
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckConnectReturn",
          "args": [
            "conn",
            "-1"
          ],
          "line": 1029
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 1027
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"conn=%p, from=%s, dxml=%s, flags=0x%x\"",
            "conn",
            "NULLSTR(from)",
            "NULLSTR(dxml)",
            "flags"
          ],
          "line": 1024
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "dxml"
          ],
          "line": 1025
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "from"
          ],
          "line": 1025
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainRestoreFlags(virConnectPtr conn, const char *from, const char *dxml,\n                      unsigned int flags)\n{\n    VIR_DEBUG(\"conn=%p, from=%s, dxml=%s, flags=0x%x\",\n              conn, NULLSTR(from), NULLSTR(dxml), flags);\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, -1);\n    virCheckReadOnlyGoto(conn->flags, error);\n    virCheckNonNullArgGoto(from, error);\n\n    VIR_EXCLUSIVE_FLAGS_GOTO(VIR_DOMAIN_SAVE_RUNNING,\n                             VIR_DOMAIN_SAVE_PAUSED,\n                             error);\n\n    if (conn->driver->domainRestoreFlags) {\n        int ret;\n        char *absolute_from;\n\n        /* We must absolutize the file path as the restore is done out of process */\n        if (virFileAbsPath(from, &absolute_from) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"could not build absolute input file path\"));\n            goto error;\n        }\n\n        ret = conn->driver->domainRestoreFlags(conn, absolute_from, dxml,\n                                               flags);\n\n        VIR_FREE(absolute_from);\n\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainRestore",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "952-988",
    "snippet": "int\nvirDomainRestore(virConnectPtr conn, const char *from)\n{\n    VIR_DEBUG(\"conn=%p, from=%s\", conn, NULLSTR(from));\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, -1);\n    virCheckReadOnlyGoto(conn->flags, error);\n    virCheckNonNullArgGoto(from, error);\n\n    if (conn->driver->domainRestore) {\n        int ret;\n        char *absolute_from;\n\n        /* We must absolutize the file path as the restore is done out of process */\n        if (virFileAbsPath(from, &absolute_from) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"could not build absolute input file path\"));\n            goto error;\n        }\n\n        ret = conn->driver->domainRestore(conn, absolute_from);\n\n        VIR_FREE(absolute_from);\n\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "conn"
          ],
          "line": 986
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 983
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "absolute_from"
          ],
          "line": 976
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainRestore",
          "args": [
            "conn",
            "absolute_from"
          ],
          "line": 974
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"could not build absolute input file path\")"
          ],
          "line": 969
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"could not build absolute input file path\""
          ],
          "line": 970
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virFileAbsPath",
          "args": [
            "from",
            "&absolute_from"
          ],
          "line": 968
        },
        "resolved": true,
        "details": {
          "function_name": "virFileAbsPath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "3227-3239",
          "snippet": "int\nvirFileAbsPath(const char *path, char **abspath)\n{\n    if (path[0] == '/') {\n        *abspath = g_strdup(path);\n    } else {\n        g_autofree char *buf = g_get_current_dir();\n\n        *abspath = g_strdup_printf(\"%s/%s\", buf, path);\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileAbsPath(const char *path, char **abspath)\n{\n    if (path[0] == '/') {\n        *abspath = g_strdup(path);\n    } else {\n        g_autofree char *buf = g_get_current_dir();\n\n        *abspath = g_strdup_printf(\"%s/%s\", buf, path);\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "from",
            "error"
          ],
          "line": 961
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "conn->flags",
            "error"
          ],
          "line": 960
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckConnectReturn",
          "args": [
            "conn",
            "-1"
          ],
          "line": 959
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 957
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"conn=%p, from=%s\"",
            "conn",
            "NULLSTR(from)"
          ],
          "line": 955
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "from"
          ],
          "line": 955
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainRestore(virConnectPtr conn, const char *from)\n{\n    VIR_DEBUG(\"conn=%p, from=%s\", conn, NULLSTR(from));\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, -1);\n    virCheckReadOnlyGoto(conn->flags, error);\n    virCheckNonNullArgGoto(from, error);\n\n    if (conn->driver->domainRestore) {\n        int ret;\n        char *absolute_from;\n\n        /* We must absolutize the file path as the restore is done out of process */\n        if (virFileAbsPath(from, &absolute_from) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"could not build absolute input file path\"));\n            goto error;\n        }\n\n        ret = conn->driver->domainRestore(conn, absolute_from);\n\n        VIR_FREE(absolute_from);\n\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainSaveFlags",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "892-938",
    "snippet": "int\nvirDomainSaveFlags(virDomainPtr domain, const char *to,\n                   const char *dxml, unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"to=%s, dxml=%s, flags=0x%x\",\n                     to, NULLSTR(dxml), flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n    virCheckNonNullArgGoto(to, error);\n\n    VIR_EXCLUSIVE_FLAGS_GOTO(VIR_DOMAIN_SAVE_RUNNING,\n                             VIR_DOMAIN_SAVE_PAUSED,\n                             error);\n\n    if (conn->driver->domainSaveFlags) {\n        int ret;\n        char *absolute_to;\n\n        /* We must absolutize the file path as the save is done out of process */\n        if (virFileAbsPath(to, &absolute_to) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"could not build absolute output file path\"));\n            goto error;\n        }\n\n        ret = conn->driver->domainSaveFlags(domain, absolute_to, dxml, flags);\n\n        VIR_FREE(absolute_to);\n\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "domain->conn"
          ],
          "line": 936
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 933
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "absolute_to"
          ],
          "line": 926
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainSaveFlags",
          "args": [
            "domain",
            "absolute_to",
            "dxml",
            "flags"
          ],
          "line": 924
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"could not build absolute output file path\")"
          ],
          "line": 919
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"could not build absolute output file path\""
          ],
          "line": 920
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virFileAbsPath",
          "args": [
            "to",
            "&absolute_to"
          ],
          "line": 918
        },
        "resolved": true,
        "details": {
          "function_name": "virFileAbsPath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "3227-3239",
          "snippet": "int\nvirFileAbsPath(const char *path, char **abspath)\n{\n    if (path[0] == '/') {\n        *abspath = g_strdup(path);\n    } else {\n        g_autofree char *buf = g_get_current_dir();\n\n        *abspath = g_strdup_printf(\"%s/%s\", buf, path);\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileAbsPath(const char *path, char **abspath)\n{\n    if (path[0] == '/') {\n        *abspath = g_strdup(path);\n    } else {\n        g_autofree char *buf = g_get_current_dir();\n\n        *abspath = g_strdup_printf(\"%s/%s\", buf, path);\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_EXCLUSIVE_FLAGS_GOTO",
          "args": [
            "VIR_DOMAIN_SAVE_RUNNING",
            "VIR_DOMAIN_SAVE_PAUSED",
            "error"
          ],
          "line": 909
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "to",
            "error"
          ],
          "line": 907
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "conn->flags",
            "error"
          ],
          "line": 906
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "domain",
            "-1"
          ],
          "line": 903
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 901
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "domain",
            "\"to=%s, dxml=%s, flags=0x%x\"",
            "to",
            "NULLSTR(dxml)",
            "flags"
          ],
          "line": 898
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "dxml"
          ],
          "line": 899
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainSaveFlags(virDomainPtr domain, const char *to,\n                   const char *dxml, unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"to=%s, dxml=%s, flags=0x%x\",\n                     to, NULLSTR(dxml), flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n    virCheckNonNullArgGoto(to, error);\n\n    VIR_EXCLUSIVE_FLAGS_GOTO(VIR_DOMAIN_SAVE_RUNNING,\n                             VIR_DOMAIN_SAVE_PAUSED,\n                             error);\n\n    if (conn->driver->domainSaveFlags) {\n        int ret;\n        char *absolute_to;\n\n        /* We must absolutize the file path as the save is done out of process */\n        if (virFileAbsPath(to, &absolute_to) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"could not build absolute output file path\"));\n            goto error;\n        }\n\n        ret = conn->driver->domainSaveFlags(domain, absolute_to, dxml, flags);\n\n        VIR_FREE(absolute_to);\n\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainSave",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "810-850",
    "snippet": "int\nvirDomainSave(virDomainPtr domain, const char *to)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"to=%s\", to);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n    virCheckNonNullArgGoto(to, error);\n\n    if (conn->driver->domainSave) {\n        int ret;\n        char *absolute_to;\n\n        /* We must absolutize the file path as the save is done out of process */\n        if (virFileAbsPath(to, &absolute_to) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"could not build absolute output file path\"));\n            goto error;\n        }\n\n        ret = conn->driver->domainSave(domain, absolute_to);\n\n        VIR_FREE(absolute_to);\n\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "domain->conn"
          ],
          "line": 848
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 845
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "absolute_to"
          ],
          "line": 838
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainSave",
          "args": [
            "domain",
            "absolute_to"
          ],
          "line": 836
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"could not build absolute output file path\")"
          ],
          "line": 831
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"could not build absolute output file path\""
          ],
          "line": 832
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virFileAbsPath",
          "args": [
            "to",
            "&absolute_to"
          ],
          "line": 830
        },
        "resolved": true,
        "details": {
          "function_name": "virFileAbsPath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "3227-3239",
          "snippet": "int\nvirFileAbsPath(const char *path, char **abspath)\n{\n    if (path[0] == '/') {\n        *abspath = g_strdup(path);\n    } else {\n        g_autofree char *buf = g_get_current_dir();\n\n        *abspath = g_strdup_printf(\"%s/%s\", buf, path);\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileAbsPath(const char *path, char **abspath)\n{\n    if (path[0] == '/') {\n        *abspath = g_strdup(path);\n    } else {\n        g_autofree char *buf = g_get_current_dir();\n\n        *abspath = g_strdup_printf(\"%s/%s\", buf, path);\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "to",
            "error"
          ],
          "line": 823
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "conn->flags",
            "error"
          ],
          "line": 822
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "domain",
            "-1"
          ],
          "line": 819
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 817
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "domain",
            "\"to=%s\"",
            "to"
          ],
          "line": 815
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainSave(virDomainPtr domain, const char *to)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"to=%s\", to);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n    virCheckNonNullArgGoto(to, error);\n\n    if (conn->driver->domainSave) {\n        int ret;\n        char *absolute_to;\n\n        /* We must absolutize the file path as the save is done out of process */\n        if (virFileAbsPath(to, &absolute_to) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"could not build absolute output file path\"));\n            goto error;\n        }\n\n        ret = conn->driver->domainSave(domain, absolute_to);\n\n        VIR_FREE(absolute_to);\n\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainPMWakeup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "763-791",
    "snippet": "int\nvirDomainPMWakeup(virDomainPtr dom,\n                  unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(dom, \"flags=0x%x\", flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(dom, -1);\n    conn = dom->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->driver->domainPMWakeup) {\n        int ret;\n        ret = conn->driver->domainPMWakeup(dom, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "conn"
          ],
          "line": 789
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 786
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainPMWakeup",
          "args": [
            "dom",
            "flags"
          ],
          "line": 780
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "conn->flags",
            "error"
          ],
          "line": 776
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "dom",
            "-1"
          ],
          "line": 773
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 771
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "dom",
            "\"flags=0x%x\"",
            "flags"
          ],
          "line": 769
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainPMWakeup(virDomainPtr dom,\n                  unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(dom, \"flags=0x%x\", flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(dom, -1);\n    conn = dom->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->driver->domainPMWakeup) {\n        int ret;\n        ret = conn->driver->domainPMWakeup(dom, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainPMSuspendForDuration",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "716-748",
    "snippet": "int\nvirDomainPMSuspendForDuration(virDomainPtr dom,\n                              unsigned int target,\n                              unsigned long long duration,\n                              unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(dom, \"target=%u duration=%llu flags=0x%x\",\n                     target, duration, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(dom, -1);\n    conn = dom->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->driver->domainPMSuspendForDuration) {\n        int ret;\n        ret = conn->driver->domainPMSuspendForDuration(dom, target,\n                                                       duration, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "conn"
          ],
          "line": 746
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 743
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainPMSuspendForDuration",
          "args": [
            "dom",
            "target",
            "duration",
            "flags"
          ],
          "line": 736
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "conn->flags",
            "error"
          ],
          "line": 732
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "dom",
            "-1"
          ],
          "line": 729
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 727
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "dom",
            "\"target=%u duration=%llu flags=0x%x\"",
            "target",
            "duration",
            "flags"
          ],
          "line": 724
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainPMSuspendForDuration(virDomainPtr dom,\n                              unsigned int target,\n                              unsigned long long duration,\n                              unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(dom, \"target=%u duration=%llu flags=0x%x\",\n                     target, duration, flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(dom, -1);\n    conn = dom->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->driver->domainPMSuspendForDuration) {\n        int ret;\n        ret = conn->driver->domainPMSuspendForDuration(dom, target,\n                                                       duration, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainResume",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "660-687",
    "snippet": "int\nvirDomainResume(virDomainPtr domain)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->driver->domainResume) {\n        int ret;\n        ret = conn->driver->domainResume(domain);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "domain->conn"
          ],
          "line": 685
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 682
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainResume",
          "args": [
            "domain"
          ],
          "line": 676
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "conn->flags",
            "error"
          ],
          "line": 672
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "domain",
            "-1"
          ],
          "line": 669
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 667
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "domain"
          ],
          "line": 665
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainResume(virDomainPtr domain)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->driver->domainResume) {\n        int ret;\n        ret = conn->driver->domainResume(domain);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainSuspend",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "618-645",
    "snippet": "int\nvirDomainSuspend(virDomainPtr domain)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->driver->domainSuspend) {\n        int ret;\n        ret = conn->driver->domainSuspend(domain);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "domain->conn"
          ],
          "line": 643
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 640
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainSuspend",
          "args": [
            "domain"
          ],
          "line": 634
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "conn->flags",
            "error"
          ],
          "line": 630
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "domain",
            "-1"
          ],
          "line": 627
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 625
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "domain"
          ],
          "line": 623
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainSuspend(virDomainPtr domain)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->driver->domainSuspend) {\n        int ret;\n        ret = conn->driver->domainSuspend(domain);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(domain->conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainRef",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "590-601",
    "snippet": "int\nvirDomainRef(virDomainPtr domain)\n{\n    VIR_DOMAIN_DEBUG(domain, \"refs=%d\", domain ? domain->parent.u.s.refs : 0);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n\n    virObjectRef(domain);\n    return 0;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectRef",
          "args": [
            "domain"
          ],
          "line": 599
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "377-387",
          "snippet": "void *\nvirObjectRef(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return NULL;\n    g_atomic_int_add(&obj->u.s.refs, 1);\n    PROBE(OBJECT_REF, \"obj=%p\", obj);\n    return anyobj;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid *\nvirObjectRef(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return NULL;\n    g_atomic_int_add(&obj->u.s.refs, 1);\n    PROBE(OBJECT_REF, \"obj=%p\", obj);\n    return anyobj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "domain",
            "-1"
          ],
          "line": 597
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 595
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "domain",
            "\"refs=%d\"",
            "domain ? domain->parent.u.s.refs : 0"
          ],
          "line": 593
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainRef(virDomainPtr domain)\n{\n    VIR_DOMAIN_DEBUG(domain, \"refs=%d\", domain ? domain->parent.u.s.refs : 0);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n\n    virObjectRef(domain);\n    return 0;\n}"
  },
  {
    "function_name": "virDomainFree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "559-570",
    "snippet": "int\nvirDomainFree(virDomainPtr domain)\n{\n    VIR_DOMAIN_DEBUG(domain);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n\n    virObjectUnref(domain);\n    return 0;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "domain"
          ],
          "line": 568
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "domain",
            "-1"
          ],
          "line": 566
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 564
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "domain"
          ],
          "line": 562
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainFree(virDomainPtr domain)\n{\n    VIR_DOMAIN_DEBUG(domain);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n\n    virObjectUnref(domain);\n    return 0;\n}"
  },
  {
    "function_name": "virDomainDestroyFlags",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "519-547",
    "snippet": "int\nvirDomainDestroyFlags(virDomainPtr domain,\n                      unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"flags=0x%x\", flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->driver->domainDestroyFlags) {\n        int ret;\n        ret = conn->driver->domainDestroyFlags(domain, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "conn"
          ],
          "line": 545
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 542
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainDestroyFlags",
          "args": [
            "domain",
            "flags"
          ],
          "line": 536
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "conn->flags",
            "error"
          ],
          "line": 532
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "domain",
            "-1"
          ],
          "line": 529
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 527
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "domain",
            "\"flags=0x%x\"",
            "flags"
          ],
          "line": 525
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainDestroyFlags(virDomainPtr domain,\n                      unsigned int flags)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain, \"flags=0x%x\", flags);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->driver->domainDestroyFlags) {\n        int ret;\n        ret = conn->driver->domainDestroyFlags(domain, flags);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainDestroy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "460-487",
    "snippet": "int\nvirDomainDestroy(virDomainPtr domain)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->driver->domainDestroy) {\n        int ret;\n        ret = conn->driver->domainDestroy(domain);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "conn"
          ],
          "line": 485
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 482
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainDestroy",
          "args": [
            "domain"
          ],
          "line": 476
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "conn->flags",
            "error"
          ],
          "line": 472
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "domain",
            "-1"
          ],
          "line": 469
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 467
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "domain"
          ],
          "line": 465
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirDomainDestroy(virDomainPtr domain)\n{\n    virConnectPtr conn;\n\n    VIR_DOMAIN_DEBUG(domain);\n\n    virResetLastError();\n\n    virCheckDomainReturn(domain, -1);\n    conn = domain->conn;\n\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->driver->domainDestroy) {\n        int ret;\n        ret = conn->driver->domainDestroy(domain);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return -1;\n}"
  },
  {
    "function_name": "virDomainLookupByName",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "410-433",
    "snippet": "virDomainPtr\nvirDomainLookupByName(virConnectPtr conn, const char *name)\n{\n    VIR_DEBUG(\"conn=%p, name=%s\", conn, NULLSTR(name));\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, NULL);\n    virCheckNonNullArgGoto(name, error);\n\n    if (conn->driver->domainLookupByName) {\n        virDomainPtr dom;\n        dom = conn->driver->domainLookupByName(conn, name);\n        if (!dom)\n            goto error;\n        return dom;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return NULL;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "conn"
          ],
          "line": 431
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 428
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainLookupByName",
          "args": [
            "conn",
            "name"
          ],
          "line": 422
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "name",
            "error"
          ],
          "line": 418
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckConnectReturn",
          "args": [
            "conn",
            "NULL"
          ],
          "line": 417
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 415
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"conn=%p, name=%s\"",
            "conn",
            "NULLSTR(name)"
          ],
          "line": 413
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "name"
          ],
          "line": 413
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nvirDomainPtr\nvirDomainLookupByName(virConnectPtr conn, const char *name)\n{\n    VIR_DEBUG(\"conn=%p, name=%s\", conn, NULLSTR(name));\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, NULL);\n    virCheckNonNullArgGoto(name, error);\n\n    if (conn->driver->domainLookupByName) {\n        virDomainPtr dom;\n        dom = conn->driver->domainLookupByName(conn, name);\n        if (!dom)\n            goto error;\n        return dom;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return NULL;\n}"
  },
  {
    "function_name": "virDomainLookupByUUIDString",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "373-394",
    "snippet": "virDomainPtr\nvirDomainLookupByUUIDString(virConnectPtr conn, const char *uuidstr)\n{\n    unsigned char uuid[VIR_UUID_BUFLEN];\n    VIR_DEBUG(\"conn=%p, uuidstr=%s\", conn, NULLSTR(uuidstr));\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, NULL);\n    virCheckNonNullArgGoto(uuidstr, error);\n\n    if (virUUIDParse(uuidstr, uuid) < 0) {\n        virReportInvalidArg(uuidstr, \"%s\", _(\"Invalid UUID\"));\n        goto error;\n    }\n\n    return virDomainLookupByUUID(conn, &uuid[0]);\n\n error:\n    virDispatchError(conn);\n    return NULL;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "conn"
          ],
          "line": 392
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainLookupByUUID",
          "args": [
            "conn",
            "&uuid[0]"
          ],
          "line": 389
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainLookupByUUIDString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
          "lines": "373-394",
          "snippet": "virDomainPtr\nvirDomainLookupByUUIDString(virConnectPtr conn, const char *uuidstr)\n{\n    unsigned char uuid[VIR_UUID_BUFLEN];\n    VIR_DEBUG(\"conn=%p, uuidstr=%s\", conn, NULLSTR(uuidstr));\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, NULL);\n    virCheckNonNullArgGoto(uuidstr, error);\n\n    if (virUUIDParse(uuidstr, uuid) < 0) {\n        virReportInvalidArg(uuidstr, \"%s\", _(\"Invalid UUID\"));\n        goto error;\n    }\n\n    return virDomainLookupByUUID(conn, &uuid[0]);\n\n error:\n    virDispatchError(conn);\n    return NULL;\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "virReportInvalidArg",
          "args": [
            "uuidstr",
            "\"%s\"",
            "_(\"Invalid UUID\")"
          ],
          "line": 385
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Invalid UUID\""
          ],
          "line": 385
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virUUIDParse",
          "args": [
            "uuidstr",
            "uuid"
          ],
          "line": 384
        },
        "resolved": true,
        "details": {
          "function_name": "virUUIDParse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viruuid.c",
          "lines": "91-135",
          "snippet": "int\nvirUUIDParse(const char *uuidstr, unsigned char *uuid)\n{\n    const char *cur;\n    size_t i;\n\n    /*\n     * do a liberal scan allowing '-' and ' ' anywhere between character\n     * pairs, and surrounding whitespace, as long as there are exactly\n     * 32 hexadecimal digits the end.\n     */\n    cur = uuidstr;\n    while (g_ascii_isspace(*cur))\n        cur++;\n\n    for (i = 0; i < VIR_UUID_BUFLEN;) {\n        int val;\n        uuid[i] = 0;\n        if (*cur == 0)\n            return -1;\n        if ((*cur == '-') || (*cur == ' ')) {\n            cur++;\n            continue;\n        }\n        if ((val = g_ascii_xdigit_value(*cur)) < 0)\n            return -1;\n        uuid[i] = 16 * val;\n        cur++;\n        if (*cur == 0)\n            return -1;\n        if ((val = g_ascii_xdigit_value(*cur)) < 0)\n            return -1;\n        uuid[i] += val;\n        i++;\n        cur++;\n    }\n\n    while (*cur) {\n        if (!g_ascii_isspace(*cur))\n            return -1;\n        cur++;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virrandom.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include \"viruuid.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virrandom.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <unistd.h>\n#include <time.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include \"viruuid.h\"\n#include <config.h>\n\nint\nvirUUIDParse(const char *uuidstr, unsigned char *uuid)\n{\n    const char *cur;\n    size_t i;\n\n    /*\n     * do a liberal scan allowing '-' and ' ' anywhere between character\n     * pairs, and surrounding whitespace, as long as there are exactly\n     * 32 hexadecimal digits the end.\n     */\n    cur = uuidstr;\n    while (g_ascii_isspace(*cur))\n        cur++;\n\n    for (i = 0; i < VIR_UUID_BUFLEN;) {\n        int val;\n        uuid[i] = 0;\n        if (*cur == 0)\n            return -1;\n        if ((*cur == '-') || (*cur == ' ')) {\n            cur++;\n            continue;\n        }\n        if ((val = g_ascii_xdigit_value(*cur)) < 0)\n            return -1;\n        uuid[i] = 16 * val;\n        cur++;\n        if (*cur == 0)\n            return -1;\n        if ((val = g_ascii_xdigit_value(*cur)) < 0)\n            return -1;\n        uuid[i] += val;\n        i++;\n        cur++;\n    }\n\n    while (*cur) {\n        if (!g_ascii_isspace(*cur))\n            return -1;\n        cur++;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "uuidstr",
            "error"
          ],
          "line": 382
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckConnectReturn",
          "args": [
            "conn",
            "NULL"
          ],
          "line": 381
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 379
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"conn=%p, uuidstr=%s\"",
            "conn",
            "NULLSTR(uuidstr)"
          ],
          "line": 377
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "uuidstr"
          ],
          "line": 377
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nvirDomainPtr\nvirDomainLookupByUUIDString(virConnectPtr conn, const char *uuidstr)\n{\n    unsigned char uuid[VIR_UUID_BUFLEN];\n    VIR_DEBUG(\"conn=%p, uuidstr=%s\", conn, NULLSTR(uuidstr));\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, NULL);\n    virCheckNonNullArgGoto(uuidstr, error);\n\n    if (virUUIDParse(uuidstr, uuid) < 0) {\n        virReportInvalidArg(uuidstr, \"%s\", _(\"Invalid UUID\"));\n        goto error;\n    }\n\n    return virDomainLookupByUUID(conn, &uuid[0]);\n\n error:\n    virDispatchError(conn);\n    return NULL;\n}"
  },
  {
    "function_name": "virDomainLookupByUUID",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "334-357",
    "snippet": "virDomainPtr\nvirDomainLookupByUUID(virConnectPtr conn, const unsigned char *uuid)\n{\n    VIR_UUID_DEBUG(conn, uuid);\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, NULL);\n    virCheckNonNullArgGoto(uuid, error);\n\n    if (conn->driver->domainLookupByUUID) {\n        virDomainPtr ret;\n        ret = conn->driver->domainLookupByUUID(conn, uuid);\n        if (!ret)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return NULL;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "conn"
          ],
          "line": 355
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 352
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainLookupByUUID",
          "args": [
            "conn",
            "uuid"
          ],
          "line": 346
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "uuid",
            "error"
          ],
          "line": 342
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckConnectReturn",
          "args": [
            "conn",
            "NULL"
          ],
          "line": 341
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 339
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_UUID_DEBUG",
          "args": [
            "conn",
            "uuid"
          ],
          "line": 337
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nvirDomainPtr\nvirDomainLookupByUUID(virConnectPtr conn, const unsigned char *uuid)\n{\n    VIR_UUID_DEBUG(conn, uuid);\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, NULL);\n    virCheckNonNullArgGoto(uuid, error);\n\n    if (conn->driver->domainLookupByUUID) {\n        virDomainPtr ret;\n        ret = conn->driver->domainLookupByUUID(conn, uuid);\n        if (!ret)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return NULL;\n}"
  },
  {
    "function_name": "virDomainLookupByID",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "295-318",
    "snippet": "virDomainPtr\nvirDomainLookupByID(virConnectPtr conn, int id)\n{\n    VIR_DEBUG(\"conn=%p, id=%d\", conn, id);\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, NULL);\n    virCheckNonNegativeArgGoto(id, error);\n\n    if (conn->driver->domainLookupByID) {\n        virDomainPtr ret;\n        ret = conn->driver->domainLookupByID(conn, id);\n        if (!ret)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return NULL;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "conn"
          ],
          "line": 316
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 313
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainLookupByID",
          "args": [
            "conn",
            "id"
          ],
          "line": 307
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNegativeArgGoto",
          "args": [
            "id",
            "error"
          ],
          "line": 303
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckConnectReturn",
          "args": [
            "conn",
            "NULL"
          ],
          "line": 302
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 300
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"conn=%p, id=%d\"",
            "conn",
            "id"
          ],
          "line": 298
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nvirDomainPtr\nvirDomainLookupByID(virConnectPtr conn, int id)\n{\n    VIR_DEBUG(\"conn=%p, id=%d\", conn, id);\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, NULL);\n    virCheckNonNegativeArgGoto(id, error);\n\n    if (conn->driver->domainLookupByID) {\n        virDomainPtr ret;\n        ret = conn->driver->domainLookupByID(conn, id);\n        if (!ret)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n\n error:\n    virDispatchError(conn);\n    return NULL;\n}"
  },
  {
    "function_name": "virDomainCreateLinux",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "272-277",
    "snippet": "virDomainPtr\nvirDomainCreateLinux(virConnectPtr conn, const char *xmlDesc,\n                     unsigned int flags)\n{\n    return virDomainCreateXML(conn, xmlDesc, flags);\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainCreateXML",
          "args": [
            "conn",
            "xmlDesc",
            "flags"
          ],
          "line": 276
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainCreateXML",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
          "lines": "162-186",
          "snippet": "virDomainPtr\nvirDomainCreateXML(virConnectPtr conn, const char *xmlDesc,\n                   unsigned int flags)\n{\n    VIR_DEBUG(\"conn=%p, xmlDesc=%s, flags=0x%x\", conn, NULLSTR(xmlDesc), flags);\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, NULL);\n    virCheckNonNullArgGoto(xmlDesc, error);\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->driver->domainCreateXML) {\n        virDomainPtr ret;\n        ret = conn->driver->domainCreateXML(conn, xmlDesc, flags);\n        if (!ret)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n error:\n    virDispatchError(conn);\n    return NULL;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include <sys/stat.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nvirDomainPtr\nvirDomainCreateXML(virConnectPtr conn, const char *xmlDesc,\n                   unsigned int flags)\n{\n    VIR_DEBUG(\"conn=%p, xmlDesc=%s, flags=0x%x\", conn, NULLSTR(xmlDesc), flags);\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, NULL);\n    virCheckNonNullArgGoto(xmlDesc, error);\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->driver->domainCreateXML) {\n        virDomainPtr ret;\n        ret = conn->driver->domainCreateXML(conn, xmlDesc, flags);\n        if (!ret)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n error:\n    virDispatchError(conn);\n    return NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nvirDomainPtr\nvirDomainCreateLinux(virConnectPtr conn, const char *xmlDesc,\n                     unsigned int flags)\n{\n    return virDomainCreateXML(conn, xmlDesc, flags);\n}"
  },
  {
    "function_name": "virDomainCreateXMLWithFiles",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "228-257",
    "snippet": "virDomainPtr\nvirDomainCreateXMLWithFiles(virConnectPtr conn, const char *xmlDesc,\n                            unsigned int nfiles,\n                            int *files,\n                            unsigned int flags)\n{\n    VIR_DEBUG(\"conn=%p, xmlDesc=%s, nfiles=%u, files=%p, flags=0x%x\",\n              conn, NULLSTR(xmlDesc), nfiles, files, flags);\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, NULL);\n    virCheckNonNullArgGoto(xmlDesc, error);\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->driver->domainCreateXMLWithFiles) {\n        virDomainPtr ret;\n        ret = conn->driver->domainCreateXMLWithFiles(conn, xmlDesc,\n                                                     nfiles, files,\n                                                     flags);\n        if (!ret)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n error:\n    virDispatchError(conn);\n    return NULL;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "conn"
          ],
          "line": 255
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 253
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainCreateXMLWithFiles",
          "args": [
            "conn",
            "xmlDesc",
            "nfiles",
            "files",
            "flags"
          ],
          "line": 245
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "conn->flags",
            "error"
          ],
          "line": 241
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "xmlDesc",
            "error"
          ],
          "line": 240
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckConnectReturn",
          "args": [
            "conn",
            "NULL"
          ],
          "line": 239
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 237
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"conn=%p, xmlDesc=%s, nfiles=%u, files=%p, flags=0x%x\"",
            "conn",
            "NULLSTR(xmlDesc)",
            "nfiles",
            "files",
            "flags"
          ],
          "line": 234
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "xmlDesc"
          ],
          "line": 235
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nvirDomainPtr\nvirDomainCreateXMLWithFiles(virConnectPtr conn, const char *xmlDesc,\n                            unsigned int nfiles,\n                            int *files,\n                            unsigned int flags)\n{\n    VIR_DEBUG(\"conn=%p, xmlDesc=%s, nfiles=%u, files=%p, flags=0x%x\",\n              conn, NULLSTR(xmlDesc), nfiles, files, flags);\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, NULL);\n    virCheckNonNullArgGoto(xmlDesc, error);\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->driver->domainCreateXMLWithFiles) {\n        virDomainPtr ret;\n        ret = conn->driver->domainCreateXMLWithFiles(conn, xmlDesc,\n                                                     nfiles, files,\n                                                     flags);\n        if (!ret)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n error:\n    virDispatchError(conn);\n    return NULL;\n}"
  },
  {
    "function_name": "virDomainCreateXML",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "162-186",
    "snippet": "virDomainPtr\nvirDomainCreateXML(virConnectPtr conn, const char *xmlDesc,\n                   unsigned int flags)\n{\n    VIR_DEBUG(\"conn=%p, xmlDesc=%s, flags=0x%x\", conn, NULLSTR(xmlDesc), flags);\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, NULL);\n    virCheckNonNullArgGoto(xmlDesc, error);\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->driver->domainCreateXML) {\n        virDomainPtr ret;\n        ret = conn->driver->domainCreateXML(conn, xmlDesc, flags);\n        if (!ret)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n error:\n    virDispatchError(conn);\n    return NULL;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "conn"
          ],
          "line": 184
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 182
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->domainCreateXML",
          "args": [
            "conn",
            "xmlDesc",
            "flags"
          ],
          "line": 176
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckReadOnlyGoto",
          "args": [
            "conn->flags",
            "error"
          ],
          "line": 172
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "xmlDesc",
            "error"
          ],
          "line": 171
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckConnectReturn",
          "args": [
            "conn",
            "NULL"
          ],
          "line": 170
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 168
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"conn=%p, xmlDesc=%s, flags=0x%x\"",
            "conn",
            "NULLSTR(xmlDesc)",
            "flags"
          ],
          "line": 166
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "xmlDesc"
          ],
          "line": 166
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nvirDomainPtr\nvirDomainCreateXML(virConnectPtr conn, const char *xmlDesc,\n                   unsigned int flags)\n{\n    VIR_DEBUG(\"conn=%p, xmlDesc=%s, flags=0x%x\", conn, NULLSTR(xmlDesc), flags);\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, NULL);\n    virCheckNonNullArgGoto(xmlDesc, error);\n    virCheckReadOnlyGoto(conn->flags, error);\n\n    if (conn->driver->domainCreateXML) {\n        virDomainPtr ret;\n        ret = conn->driver->domainCreateXML(conn, xmlDesc, flags);\n        if (!ret)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n error:\n    virDispatchError(conn);\n    return NULL;\n}"
  },
  {
    "function_name": "virDomainGetConnect",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "119-129",
    "snippet": "virConnectPtr\nvirDomainGetConnect(virDomainPtr dom)\n{\n    VIR_DOMAIN_DEBUG(dom);\n\n    virResetLastError();\n\n    virCheckDomainReturn(dom, NULL);\n\n    return dom->conn;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCheckDomainReturn",
          "args": [
            "dom",
            "NULL"
          ],
          "line": 126
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 124
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DOMAIN_DEBUG",
          "args": [
            "dom"
          ],
          "line": 122
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nvirConnectPtr\nvirDomainGetConnect(virDomainPtr dom)\n{\n    VIR_DOMAIN_DEBUG(dom);\n\n    virResetLastError();\n\n    virCheckDomainReturn(dom, NULL);\n\n    return dom->conn;\n}"
  },
  {
    "function_name": "virConnectNumOfDomains",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "86-106",
    "snippet": "int\nvirConnectNumOfDomains(virConnectPtr conn)\n{\n    VIR_DEBUG(\"conn=%p\", conn);\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, -1);\n\n    if (conn->driver->connectNumOfDomains) {\n        int ret = conn->driver->connectNumOfDomains(conn);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n error:\n    virDispatchError(conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "conn"
          ],
          "line": 104
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 102
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->connectNumOfDomains",
          "args": [
            "conn"
          ],
          "line": 96
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckConnectReturn",
          "args": [
            "conn",
            "-1"
          ],
          "line": 93
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 91
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"conn=%p\"",
            "conn"
          ],
          "line": 89
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirConnectNumOfDomains(virConnectPtr conn)\n{\n    VIR_DEBUG(\"conn=%p\", conn);\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, -1);\n\n    if (conn->driver->connectNumOfDomains) {\n        int ret = conn->driver->connectNumOfDomains(conn);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n error:\n    virDispatchError(conn);\n    return -1;\n}"
  },
  {
    "function_name": "virConnectListDomains",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt-domain.c",
    "lines": "53-75",
    "snippet": "int\nvirConnectListDomains(virConnectPtr conn, int *ids, int maxids)\n{\n    VIR_DEBUG(\"conn=%p, ids=%p, maxids=%d\", conn, ids, maxids);\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, -1);\n    virCheckNonNullArrayArgGoto(ids, maxids, error);\n    virCheckNonNegativeArgGoto(maxids, error);\n\n    if (conn->driver->connectListDomains) {\n        int ret = conn->driver->connectListDomains(conn, ids, maxids);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n error:\n    virDispatchError(conn);\n    return -1;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"virtypedparam.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include <sys/stat.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDispatchError",
          "args": [
            "conn"
          ],
          "line": 73
        },
        "resolved": true,
        "details": {
          "function_name": "virDispatchError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "695-728",
          "snippet": "void\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virErrorFunc virErrorHandler = NULL;",
            "void *virUserData = NULL;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvirErrorFunc virErrorHandler = NULL;\nvoid *virUserData = NULL;\n\nvoid\nvirDispatchError(virConnectPtr conn)\n{\n    virErrorPtr err = virLastErrorObject();\n    virErrorFunc handler = virErrorHandler;\n    void *userData = virUserData;\n\n    /* Can only happen on OOM.  */\n    if (!err)\n        return;\n\n    /* Set a generic error message if none is already set */\n    if (err->code == VIR_ERR_OK)\n        virErrorGenericFailure(err);\n\n    /* Copy the global error to per-connection error if needed */\n    if (conn) {\n        virObjectLock(conn);\n        virCopyError(err, &conn->err);\n\n        if (conn->handler != NULL) {\n            handler = conn->handler;\n            userData = conn->userData;\n        }\n        virObjectUnlock(conn);\n    }\n\n    /* Invoke the error callback functions */\n    if (handler != NULL) {\n        (handler)(userData, err);\n    } else {\n        virDefaultErrorFunc(err);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 71
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conn->driver->connectListDomains",
          "args": [
            "conn",
            "ids",
            "maxids"
          ],
          "line": 65
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNegativeArgGoto",
          "args": [
            "maxids",
            "error"
          ],
          "line": 62
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArrayArgGoto",
          "args": [
            "ids",
            "maxids",
            "error"
          ],
          "line": 61
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckConnectReturn",
          "args": [
            "conn",
            "-1"
          ],
          "line": 60
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 58
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"conn=%p, ids=%p, maxids=%d\"",
            "conn",
            "ids",
            "maxids"
          ],
          "line": 56
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"virtypedparam.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <sys/stat.h>\n#include <config.h>\n\nint\nvirConnectListDomains(virConnectPtr conn, int *ids, int maxids)\n{\n    VIR_DEBUG(\"conn=%p, ids=%p, maxids=%d\", conn, ids, maxids);\n\n    virResetLastError();\n\n    virCheckConnectReturn(conn, -1);\n    virCheckNonNullArrayArgGoto(ids, maxids, error);\n    virCheckNonNegativeArgGoto(maxids, error);\n\n    if (conn->driver->connectListDomains) {\n        int ret = conn->driver->connectListDomains(conn, ids, maxids);\n        if (ret < 0)\n            goto error;\n        return ret;\n    }\n\n    virReportUnsupportedError();\n error:\n    virDispatchError(conn);\n    return -1;\n}"
  }
]