[
  {
    "function_name": "virNetSASLSessionDispose",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetsaslcontext.c",
    "lines": "696-703",
    "snippet": "void virNetSASLSessionDispose(void *obj)\n{\n    virNetSASLSessionPtr sasl = obj;\n\n    if (sasl->conn)\n        sasl_dispose(&sasl->conn);\n    VIR_FREE(sasl->callbacks);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virthread.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virnetmessage.h\"",
      "#include \"virnetsaslcontext.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNetSASLContextDispose(void *obj);",
      "static void virNetSASLSessionDispose(void *obj);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "sasl->callbacks"
          ],
          "line": 702
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sasl_dispose",
          "args": [
            "&sasl->conn"
          ],
          "line": 701
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virnetmessage.h\"\n#include \"virnetsaslcontext.h\"\n#include <config.h>\n\nstatic void virNetSASLContextDispose(void *obj);\nstatic void virNetSASLSessionDispose(void *obj);\n\nvoid virNetSASLSessionDispose(void *obj)\n{\n    virNetSASLSessionPtr sasl = obj;\n\n    if (sasl->conn)\n        sasl_dispose(&sasl->conn);\n    VIR_FREE(sasl->callbacks);\n}"
  },
  {
    "function_name": "virNetSASLContextDispose",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetsaslcontext.c",
    "lines": "691-694",
    "snippet": "void virNetSASLContextDispose(void *obj G_GNUC_UNUSED)\n{\n    return;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virthread.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virnetmessage.h\"",
      "#include \"virnetsaslcontext.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virNetSASLContextDispose(void *obj);",
      "static void virNetSASLSessionDispose(void *obj);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virnetmessage.h\"\n#include \"virnetsaslcontext.h\"\n#include <config.h>\n\nstatic void virNetSASLContextDispose(void *obj);\nstatic void virNetSASLSessionDispose(void *obj);\n\nvoid virNetSASLContextDispose(void *obj G_GNUC_UNUSED)\n{\n    return;\n}"
  },
  {
    "function_name": "virNetSASLSessionDecode",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetsaslcontext.c",
    "lines": "653-689",
    "snippet": "ssize_t virNetSASLSessionDecode(virNetSASLSessionPtr sasl,\n                                const char *input,\n                                size_t inputLen,\n                                const char **output,\n                                size_t *outputlen)\n{\n    unsigned inlen = inputLen;\n    unsigned outlen = 0;\n    int err;\n    ssize_t ret = -1;\n\n    virObjectLock(sasl);\n    if (inputLen > sasl->maxbufsize) {\n        virReportSystemError(EINVAL,\n                             _(\"SASL data length %zu too long, max %zu\"),\n                             inputLen, sasl->maxbufsize);\n        goto cleanup;\n    }\n\n    err = sasl_decode(sasl->conn,\n                      input,\n                      inlen,\n                      output,\n                      &outlen);\n    *outputlen = outlen;\n    if (err != SASL_OK) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"failed to decode SASL data: %d (%s)\"),\n                       err, sasl_errstring(err, NULL, NULL));\n        goto cleanup;\n    }\n    ret = 0;\n\n cleanup:\n    virObjectUnlock(sasl);\n    return ret;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virthread.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virnetmessage.h\"",
      "#include \"virnetsaslcontext.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "sasl"
          ],
          "line": 687
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"failed to decode SASL data: %d (%s)\")",
            "err",
            "sasl_errstring(err, NULL, NULL)"
          ],
          "line": 679
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sasl_errstring",
          "args": [
            "err",
            "NULL",
            "NULL"
          ],
          "line": 681
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"failed to decode SASL data: %d (%s)\""
          ],
          "line": 680
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "sasl_decode",
          "args": [
            "sasl->conn",
            "input",
            "inlen",
            "output",
            "&outlen"
          ],
          "line": 672
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "EINVAL",
            "_(\"SASL data length %zu too long, max %zu\")",
            "inputLen",
            "sasl->maxbufsize"
          ],
          "line": 666
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "sasl"
          ],
          "line": 664
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virnetmessage.h\"\n#include \"virnetsaslcontext.h\"\n#include <config.h>\n\nssize_t virNetSASLSessionDecode(virNetSASLSessionPtr sasl,\n                                const char *input,\n                                size_t inputLen,\n                                const char **output,\n                                size_t *outputlen)\n{\n    unsigned inlen = inputLen;\n    unsigned outlen = 0;\n    int err;\n    ssize_t ret = -1;\n\n    virObjectLock(sasl);\n    if (inputLen > sasl->maxbufsize) {\n        virReportSystemError(EINVAL,\n                             _(\"SASL data length %zu too long, max %zu\"),\n                             inputLen, sasl->maxbufsize);\n        goto cleanup;\n    }\n\n    err = sasl_decode(sasl->conn,\n                      input,\n                      inlen,\n                      output,\n                      &outlen);\n    *outputlen = outlen;\n    if (err != SASL_OK) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"failed to decode SASL data: %d (%s)\"),\n                       err, sasl_errstring(err, NULL, NULL));\n        goto cleanup;\n    }\n    ret = 0;\n\n cleanup:\n    virObjectUnlock(sasl);\n    return ret;\n}"
  },
  {
    "function_name": "virNetSASLSessionEncode",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetsaslcontext.c",
    "lines": "614-651",
    "snippet": "ssize_t virNetSASLSessionEncode(virNetSASLSessionPtr sasl,\n                                const char *input,\n                                size_t inputLen,\n                                const char **output,\n                                size_t *outputlen)\n{\n    unsigned inlen = inputLen;\n    unsigned outlen = 0;\n    int err;\n    ssize_t ret = -1;\n\n    virObjectLock(sasl);\n    if (inputLen > sasl->maxbufsize) {\n        virReportSystemError(EINVAL,\n                             _(\"SASL data length %zu too long, max %zu\"),\n                             inputLen, sasl->maxbufsize);\n        goto cleanup;\n    }\n\n    err = sasl_encode(sasl->conn,\n                      input,\n                      inlen,\n                      output,\n                      &outlen);\n    *outputlen = outlen;\n\n    if (err != SASL_OK) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"failed to encode SASL data: %d (%s)\"),\n                       err, sasl_errstring(err, NULL, NULL));\n        goto cleanup;\n    }\n    ret = 0;\n\n cleanup:\n    virObjectUnlock(sasl);\n    return ret;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virthread.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virnetmessage.h\"",
      "#include \"virnetsaslcontext.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "sasl"
          ],
          "line": 649
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"failed to encode SASL data: %d (%s)\")",
            "err",
            "sasl_errstring(err, NULL, NULL)"
          ],
          "line": 641
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sasl_errstring",
          "args": [
            "err",
            "NULL",
            "NULL"
          ],
          "line": 643
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"failed to encode SASL data: %d (%s)\""
          ],
          "line": 642
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "sasl_encode",
          "args": [
            "sasl->conn",
            "input",
            "inlen",
            "output",
            "&outlen"
          ],
          "line": 633
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "EINVAL",
            "_(\"SASL data length %zu too long, max %zu\")",
            "inputLen",
            "sasl->maxbufsize"
          ],
          "line": 627
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "sasl"
          ],
          "line": 625
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virnetmessage.h\"\n#include \"virnetsaslcontext.h\"\n#include <config.h>\n\nssize_t virNetSASLSessionEncode(virNetSASLSessionPtr sasl,\n                                const char *input,\n                                size_t inputLen,\n                                const char **output,\n                                size_t *outputlen)\n{\n    unsigned inlen = inputLen;\n    unsigned outlen = 0;\n    int err;\n    ssize_t ret = -1;\n\n    virObjectLock(sasl);\n    if (inputLen > sasl->maxbufsize) {\n        virReportSystemError(EINVAL,\n                             _(\"SASL data length %zu too long, max %zu\"),\n                             inputLen, sasl->maxbufsize);\n        goto cleanup;\n    }\n\n    err = sasl_encode(sasl->conn,\n                      input,\n                      inlen,\n                      output,\n                      &outlen);\n    *outputlen = outlen;\n\n    if (err != SASL_OK) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"failed to encode SASL data: %d (%s)\"),\n                       err, sasl_errstring(err, NULL, NULL));\n        goto cleanup;\n    }\n    ret = 0;\n\n cleanup:\n    virObjectUnlock(sasl);\n    return ret;\n}"
  },
  {
    "function_name": "virNetSASLSessionGetMaxBufSize",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetsaslcontext.c",
    "lines": "605-612",
    "snippet": "size_t virNetSASLSessionGetMaxBufSize(virNetSASLSessionPtr sasl)\n{\n    size_t ret;\n    virObjectLock(sasl);\n    ret = sasl->maxbufsize;\n    virObjectUnlock(sasl);\n    return ret;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virthread.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virnetmessage.h\"",
      "#include \"virnetsaslcontext.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "sasl"
          ],
          "line": 610
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "sasl"
          ],
          "line": 608
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virnetmessage.h\"\n#include \"virnetsaslcontext.h\"\n#include <config.h>\n\nsize_t virNetSASLSessionGetMaxBufSize(virNetSASLSessionPtr sasl)\n{\n    size_t ret;\n    virObjectLock(sasl);\n    ret = sasl->maxbufsize;\n    virObjectUnlock(sasl);\n    return ret;\n}"
  },
  {
    "function_name": "virNetSASLSessionServerStep",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetsaslcontext.c",
    "lines": "561-603",
    "snippet": "int virNetSASLSessionServerStep(virNetSASLSessionPtr sasl,\n                                const char *clientin,\n                                size_t clientinlen,\n                                const char **serverout,\n                                size_t *serveroutlen)\n{\n    unsigned inlen = clientinlen;\n    unsigned outlen = 0;\n    int err;\n    int ret = -1;\n\n    virObjectLock(sasl);\n    err = sasl_server_step(sasl->conn,\n                           clientin,\n                           inlen,\n                           serverout,\n                           &outlen);\n\n    *serveroutlen = outlen;\n\n    switch (err) {\n    case SASL_OK:\n        if (virNetSASLSessionUpdateBufSize(sasl) < 0)\n            goto cleanup;\n        ret = VIR_NET_SASL_COMPLETE;\n        break;\n    case SASL_CONTINUE:\n        ret = VIR_NET_SASL_CONTINUE;\n        break;\n    case SASL_INTERACT:\n        ret = VIR_NET_SASL_INTERACT;\n        break;\n    default:\n        virReportError(VIR_ERR_AUTH_FAILED,\n                       _(\"Failed to start SASL negotiation: %d (%s)\"),\n                       err, sasl_errdetail(sasl->conn));\n        break;\n    }\n\n cleanup:\n    virObjectUnlock(sasl);\n    return ret;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virthread.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virnetmessage.h\"",
      "#include \"virnetsaslcontext.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "sasl"
          ],
          "line": 601
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_AUTH_FAILED",
            "_(\"Failed to start SASL negotiation: %d (%s)\")",
            "err",
            "sasl_errdetail(sasl->conn)"
          ],
          "line": 594
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sasl_errdetail",
          "args": [
            "sasl->conn"
          ],
          "line": 596
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Failed to start SASL negotiation: %d (%s)\""
          ],
          "line": 595
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetSASLSessionUpdateBufSize",
          "args": [
            "sasl"
          ],
          "line": 583
        },
        "resolved": true,
        "details": {
          "function_name": "virNetSASLSessionUpdateBufSize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetsaslcontext.c",
          "lines": "360-380",
          "snippet": "static int virNetSASLSessionUpdateBufSize(virNetSASLSessionPtr sasl)\n{\n    union {\n        unsigned *maxbufsize;\n        const void *ptr;\n    } u;\n    int err;\n\n    err = sasl_getprop(sasl->conn, SASL_MAXOUTBUF, &u.ptr);\n    if (err != SASL_OK) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"cannot get security props %d (%s)\"),\n                       err, sasl_errstring(err, NULL, NULL));\n        return -1;\n    }\n\n    VIR_DEBUG(\"Negotiated bufsize is %u vs requested size %zu\",\n              *u.maxbufsize, sasl->maxbufsize);\n    sasl->maxbufsize = *u.maxbufsize;\n    return 0;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virthread.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virnetmessage.h\"",
            "#include \"virnetsaslcontext.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virnetmessage.h\"\n#include \"virnetsaslcontext.h\"\n#include <config.h>\n\nstatic int virNetSASLSessionUpdateBufSize(virNetSASLSessionPtr sasl)\n{\n    union {\n        unsigned *maxbufsize;\n        const void *ptr;\n    } u;\n    int err;\n\n    err = sasl_getprop(sasl->conn, SASL_MAXOUTBUF, &u.ptr);\n    if (err != SASL_OK) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"cannot get security props %d (%s)\"),\n                       err, sasl_errstring(err, NULL, NULL));\n        return -1;\n    }\n\n    VIR_DEBUG(\"Negotiated bufsize is %u vs requested size %zu\",\n              *u.maxbufsize, sasl->maxbufsize);\n    sasl->maxbufsize = *u.maxbufsize;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "sasl_server_step",
          "args": [
            "sasl->conn",
            "clientin",
            "inlen",
            "serverout",
            "&outlen"
          ],
          "line": 573
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "sasl"
          ],
          "line": 572
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virnetmessage.h\"\n#include \"virnetsaslcontext.h\"\n#include <config.h>\n\nint virNetSASLSessionServerStep(virNetSASLSessionPtr sasl,\n                                const char *clientin,\n                                size_t clientinlen,\n                                const char **serverout,\n                                size_t *serveroutlen)\n{\n    unsigned inlen = clientinlen;\n    unsigned outlen = 0;\n    int err;\n    int ret = -1;\n\n    virObjectLock(sasl);\n    err = sasl_server_step(sasl->conn,\n                           clientin,\n                           inlen,\n                           serverout,\n                           &outlen);\n\n    *serveroutlen = outlen;\n\n    switch (err) {\n    case SASL_OK:\n        if (virNetSASLSessionUpdateBufSize(sasl) < 0)\n            goto cleanup;\n        ret = VIR_NET_SASL_COMPLETE;\n        break;\n    case SASL_CONTINUE:\n        ret = VIR_NET_SASL_CONTINUE;\n        break;\n    case SASL_INTERACT:\n        ret = VIR_NET_SASL_INTERACT;\n        break;\n    default:\n        virReportError(VIR_ERR_AUTH_FAILED,\n                       _(\"Failed to start SASL negotiation: %d (%s)\"),\n                       err, sasl_errdetail(sasl->conn));\n        break;\n    }\n\n cleanup:\n    virObjectUnlock(sasl);\n    return ret;\n}"
  },
  {
    "function_name": "virNetSASLSessionServerStart",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetsaslcontext.c",
    "lines": "514-558",
    "snippet": "int virNetSASLSessionServerStart(virNetSASLSessionPtr sasl,\n                                 const char *mechname,\n                                 const char *clientin,\n                                 size_t clientinlen,\n                                 const char **serverout,\n                                 size_t *serveroutlen)\n{\n    unsigned inlen = clientinlen;\n    unsigned outlen = 0;\n    int err;\n    int ret = -1;\n\n    virObjectLock(sasl);\n    err = sasl_server_start(sasl->conn,\n                            mechname,\n                            clientin,\n                            inlen,\n                            serverout,\n                            &outlen);\n\n    *serveroutlen = outlen;\n\n    switch (err) {\n    case SASL_OK:\n        if (virNetSASLSessionUpdateBufSize(sasl) < 0)\n            goto cleanup;\n        ret = VIR_NET_SASL_COMPLETE;\n        break;\n    case SASL_CONTINUE:\n        ret = VIR_NET_SASL_CONTINUE;\n        break;\n    case SASL_INTERACT:\n        ret = VIR_NET_SASL_INTERACT;\n        break;\n    default:\n        virReportError(VIR_ERR_AUTH_FAILED,\n                       _(\"Failed to start SASL negotiation: %d (%s)\"),\n                       err, sasl_errdetail(sasl->conn));\n        break;\n    }\n\n cleanup:\n    virObjectUnlock(sasl);\n    return ret;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virthread.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virnetmessage.h\"",
      "#include \"virnetsaslcontext.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "sasl"
          ],
          "line": 556
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_AUTH_FAILED",
            "_(\"Failed to start SASL negotiation: %d (%s)\")",
            "err",
            "sasl_errdetail(sasl->conn)"
          ],
          "line": 549
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sasl_errdetail",
          "args": [
            "sasl->conn"
          ],
          "line": 551
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Failed to start SASL negotiation: %d (%s)\""
          ],
          "line": 550
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetSASLSessionUpdateBufSize",
          "args": [
            "sasl"
          ],
          "line": 538
        },
        "resolved": true,
        "details": {
          "function_name": "virNetSASLSessionUpdateBufSize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetsaslcontext.c",
          "lines": "360-380",
          "snippet": "static int virNetSASLSessionUpdateBufSize(virNetSASLSessionPtr sasl)\n{\n    union {\n        unsigned *maxbufsize;\n        const void *ptr;\n    } u;\n    int err;\n\n    err = sasl_getprop(sasl->conn, SASL_MAXOUTBUF, &u.ptr);\n    if (err != SASL_OK) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"cannot get security props %d (%s)\"),\n                       err, sasl_errstring(err, NULL, NULL));\n        return -1;\n    }\n\n    VIR_DEBUG(\"Negotiated bufsize is %u vs requested size %zu\",\n              *u.maxbufsize, sasl->maxbufsize);\n    sasl->maxbufsize = *u.maxbufsize;\n    return 0;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virthread.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virnetmessage.h\"",
            "#include \"virnetsaslcontext.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virnetmessage.h\"\n#include \"virnetsaslcontext.h\"\n#include <config.h>\n\nstatic int virNetSASLSessionUpdateBufSize(virNetSASLSessionPtr sasl)\n{\n    union {\n        unsigned *maxbufsize;\n        const void *ptr;\n    } u;\n    int err;\n\n    err = sasl_getprop(sasl->conn, SASL_MAXOUTBUF, &u.ptr);\n    if (err != SASL_OK) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"cannot get security props %d (%s)\"),\n                       err, sasl_errstring(err, NULL, NULL));\n        return -1;\n    }\n\n    VIR_DEBUG(\"Negotiated bufsize is %u vs requested size %zu\",\n              *u.maxbufsize, sasl->maxbufsize);\n    sasl->maxbufsize = *u.maxbufsize;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "sasl_server_start",
          "args": [
            "sasl->conn",
            "mechname",
            "clientin",
            "inlen",
            "serverout",
            "&outlen"
          ],
          "line": 527
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "sasl"
          ],
          "line": 526
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virnetmessage.h\"\n#include \"virnetsaslcontext.h\"\n#include <config.h>\n\nint virNetSASLSessionServerStart(virNetSASLSessionPtr sasl,\n                                 const char *mechname,\n                                 const char *clientin,\n                                 size_t clientinlen,\n                                 const char **serverout,\n                                 size_t *serveroutlen)\n{\n    unsigned inlen = clientinlen;\n    unsigned outlen = 0;\n    int err;\n    int ret = -1;\n\n    virObjectLock(sasl);\n    err = sasl_server_start(sasl->conn,\n                            mechname,\n                            clientin,\n                            inlen,\n                            serverout,\n                            &outlen);\n\n    *serveroutlen = outlen;\n\n    switch (err) {\n    case SASL_OK:\n        if (virNetSASLSessionUpdateBufSize(sasl) < 0)\n            goto cleanup;\n        ret = VIR_NET_SASL_COMPLETE;\n        break;\n    case SASL_CONTINUE:\n        ret = VIR_NET_SASL_CONTINUE;\n        break;\n    case SASL_INTERACT:\n        ret = VIR_NET_SASL_INTERACT;\n        break;\n    default:\n        virReportError(VIR_ERR_AUTH_FAILED,\n                       _(\"Failed to start SASL negotiation: %d (%s)\"),\n                       err, sasl_errdetail(sasl->conn));\n        break;\n    }\n\n cleanup:\n    virObjectUnlock(sasl);\n    return ret;\n}"
  },
  {
    "function_name": "virNetSASLSessionClientStep",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetsaslcontext.c",
    "lines": "466-512",
    "snippet": "int virNetSASLSessionClientStep(virNetSASLSessionPtr sasl,\n                                const char *serverin,\n                                size_t serverinlen,\n                                sasl_interact_t **prompt_need,\n                                const char **clientout,\n                                size_t *clientoutlen)\n{\n    unsigned inlen = serverinlen;\n    unsigned outlen = 0;\n    int err;\n    int ret = -1;\n\n    VIR_DEBUG(\"sasl=%p serverin=%p serverinlen=%zu prompt_need=%p clientout=%p clientoutlen=%p\",\n              sasl, serverin, serverinlen, prompt_need, clientout, clientoutlen);\n\n    virObjectLock(sasl);\n    err = sasl_client_step(sasl->conn,\n                           serverin,\n                           inlen,\n                           prompt_need,\n                           clientout,\n                           &outlen);\n    *clientoutlen = outlen;\n\n    switch (err) {\n    case SASL_OK:\n        if (virNetSASLSessionUpdateBufSize(sasl) < 0)\n            goto cleanup;\n        ret = VIR_NET_SASL_COMPLETE;\n        break;\n    case SASL_CONTINUE:\n        ret = VIR_NET_SASL_CONTINUE;\n        break;\n    case SASL_INTERACT:\n        ret = VIR_NET_SASL_INTERACT;\n        break;\n    default:\n        virReportError(VIR_ERR_AUTH_FAILED,\n                       _(\"Failed to step SASL negotiation: %d (%s)\"),\n                       err, sasl_errdetail(sasl->conn));\n        break;\n    }\n\n cleanup:\n    virObjectUnlock(sasl);\n    return ret;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virthread.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virnetmessage.h\"",
      "#include \"virnetsaslcontext.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "sasl"
          ],
          "line": 510
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_AUTH_FAILED",
            "_(\"Failed to step SASL negotiation: %d (%s)\")",
            "err",
            "sasl_errdetail(sasl->conn)"
          ],
          "line": 503
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sasl_errdetail",
          "args": [
            "sasl->conn"
          ],
          "line": 505
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Failed to step SASL negotiation: %d (%s)\""
          ],
          "line": 504
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetSASLSessionUpdateBufSize",
          "args": [
            "sasl"
          ],
          "line": 492
        },
        "resolved": true,
        "details": {
          "function_name": "virNetSASLSessionUpdateBufSize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetsaslcontext.c",
          "lines": "360-380",
          "snippet": "static int virNetSASLSessionUpdateBufSize(virNetSASLSessionPtr sasl)\n{\n    union {\n        unsigned *maxbufsize;\n        const void *ptr;\n    } u;\n    int err;\n\n    err = sasl_getprop(sasl->conn, SASL_MAXOUTBUF, &u.ptr);\n    if (err != SASL_OK) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"cannot get security props %d (%s)\"),\n                       err, sasl_errstring(err, NULL, NULL));\n        return -1;\n    }\n\n    VIR_DEBUG(\"Negotiated bufsize is %u vs requested size %zu\",\n              *u.maxbufsize, sasl->maxbufsize);\n    sasl->maxbufsize = *u.maxbufsize;\n    return 0;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virthread.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virnetmessage.h\"",
            "#include \"virnetsaslcontext.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virnetmessage.h\"\n#include \"virnetsaslcontext.h\"\n#include <config.h>\n\nstatic int virNetSASLSessionUpdateBufSize(virNetSASLSessionPtr sasl)\n{\n    union {\n        unsigned *maxbufsize;\n        const void *ptr;\n    } u;\n    int err;\n\n    err = sasl_getprop(sasl->conn, SASL_MAXOUTBUF, &u.ptr);\n    if (err != SASL_OK) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"cannot get security props %d (%s)\"),\n                       err, sasl_errstring(err, NULL, NULL));\n        return -1;\n    }\n\n    VIR_DEBUG(\"Negotiated bufsize is %u vs requested size %zu\",\n              *u.maxbufsize, sasl->maxbufsize);\n    sasl->maxbufsize = *u.maxbufsize;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "sasl_client_step",
          "args": [
            "sasl->conn",
            "serverin",
            "inlen",
            "prompt_need",
            "clientout",
            "&outlen"
          ],
          "line": 482
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "sasl"
          ],
          "line": 481
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"sasl=%p serverin=%p serverinlen=%zu prompt_need=%p clientout=%p clientoutlen=%p\"",
            "sasl",
            "serverin",
            "serverinlen",
            "prompt_need",
            "clientout",
            "clientoutlen"
          ],
          "line": 478
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virnetmessage.h\"\n#include \"virnetsaslcontext.h\"\n#include <config.h>\n\nint virNetSASLSessionClientStep(virNetSASLSessionPtr sasl,\n                                const char *serverin,\n                                size_t serverinlen,\n                                sasl_interact_t **prompt_need,\n                                const char **clientout,\n                                size_t *clientoutlen)\n{\n    unsigned inlen = serverinlen;\n    unsigned outlen = 0;\n    int err;\n    int ret = -1;\n\n    VIR_DEBUG(\"sasl=%p serverin=%p serverinlen=%zu prompt_need=%p clientout=%p clientoutlen=%p\",\n              sasl, serverin, serverinlen, prompt_need, clientout, clientoutlen);\n\n    virObjectLock(sasl);\n    err = sasl_client_step(sasl->conn,\n                           serverin,\n                           inlen,\n                           prompt_need,\n                           clientout,\n                           &outlen);\n    *clientoutlen = outlen;\n\n    switch (err) {\n    case SASL_OK:\n        if (virNetSASLSessionUpdateBufSize(sasl) < 0)\n            goto cleanup;\n        ret = VIR_NET_SASL_COMPLETE;\n        break;\n    case SASL_CONTINUE:\n        ret = VIR_NET_SASL_CONTINUE;\n        break;\n    case SASL_INTERACT:\n        ret = VIR_NET_SASL_INTERACT;\n        break;\n    default:\n        virReportError(VIR_ERR_AUTH_FAILED,\n                       _(\"Failed to step SASL negotiation: %d (%s)\"),\n                       err, sasl_errdetail(sasl->conn));\n        break;\n    }\n\n cleanup:\n    virObjectUnlock(sasl);\n    return ret;\n}"
  },
  {
    "function_name": "virNetSASLSessionClientStart",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetsaslcontext.c",
    "lines": "417-463",
    "snippet": "int virNetSASLSessionClientStart(virNetSASLSessionPtr sasl,\n                                 const char *mechlist,\n                                 sasl_interact_t **prompt_need,\n                                 const char **clientout,\n                                 size_t *clientoutlen,\n                                 const char **mech)\n{\n    unsigned outlen = 0;\n    int err;\n    int ret = -1;\n\n    VIR_DEBUG(\"sasl=%p mechlist=%s prompt_need=%p clientout=%p clientoutlen=%p mech=%p\",\n              sasl, mechlist, prompt_need, clientout, clientoutlen, mech);\n\n    virObjectLock(sasl);\n    err = sasl_client_start(sasl->conn,\n                            mechlist,\n                            prompt_need,\n                            clientout,\n                            &outlen,\n                            mech);\n\n    *clientoutlen = outlen;\n\n    switch (err) {\n    case SASL_OK:\n        if (virNetSASLSessionUpdateBufSize(sasl) < 0)\n            goto cleanup;\n        ret = VIR_NET_SASL_COMPLETE;\n        break;\n    case SASL_CONTINUE:\n        ret = VIR_NET_SASL_CONTINUE;\n        break;\n    case SASL_INTERACT:\n        ret = VIR_NET_SASL_INTERACT;\n        break;\n    default:\n        virReportError(VIR_ERR_AUTH_FAILED,\n                       _(\"Failed to start SASL negotiation: %d (%s)\"),\n                       err, sasl_errdetail(sasl->conn));\n        break;\n    }\n\n cleanup:\n    virObjectUnlock(sasl);\n    return ret;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virthread.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virnetmessage.h\"",
      "#include \"virnetsaslcontext.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "sasl"
          ],
          "line": 461
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_AUTH_FAILED",
            "_(\"Failed to start SASL negotiation: %d (%s)\")",
            "err",
            "sasl_errdetail(sasl->conn)"
          ],
          "line": 454
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sasl_errdetail",
          "args": [
            "sasl->conn"
          ],
          "line": 456
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Failed to start SASL negotiation: %d (%s)\""
          ],
          "line": 455
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetSASLSessionUpdateBufSize",
          "args": [
            "sasl"
          ],
          "line": 443
        },
        "resolved": true,
        "details": {
          "function_name": "virNetSASLSessionUpdateBufSize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetsaslcontext.c",
          "lines": "360-380",
          "snippet": "static int virNetSASLSessionUpdateBufSize(virNetSASLSessionPtr sasl)\n{\n    union {\n        unsigned *maxbufsize;\n        const void *ptr;\n    } u;\n    int err;\n\n    err = sasl_getprop(sasl->conn, SASL_MAXOUTBUF, &u.ptr);\n    if (err != SASL_OK) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"cannot get security props %d (%s)\"),\n                       err, sasl_errstring(err, NULL, NULL));\n        return -1;\n    }\n\n    VIR_DEBUG(\"Negotiated bufsize is %u vs requested size %zu\",\n              *u.maxbufsize, sasl->maxbufsize);\n    sasl->maxbufsize = *u.maxbufsize;\n    return 0;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virthread.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virnetmessage.h\"",
            "#include \"virnetsaslcontext.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virnetmessage.h\"\n#include \"virnetsaslcontext.h\"\n#include <config.h>\n\nstatic int virNetSASLSessionUpdateBufSize(virNetSASLSessionPtr sasl)\n{\n    union {\n        unsigned *maxbufsize;\n        const void *ptr;\n    } u;\n    int err;\n\n    err = sasl_getprop(sasl->conn, SASL_MAXOUTBUF, &u.ptr);\n    if (err != SASL_OK) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"cannot get security props %d (%s)\"),\n                       err, sasl_errstring(err, NULL, NULL));\n        return -1;\n    }\n\n    VIR_DEBUG(\"Negotiated bufsize is %u vs requested size %zu\",\n              *u.maxbufsize, sasl->maxbufsize);\n    sasl->maxbufsize = *u.maxbufsize;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "sasl_client_start",
          "args": [
            "sasl->conn",
            "mechlist",
            "prompt_need",
            "clientout",
            "&outlen",
            "mech"
          ],
          "line": 432
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "sasl"
          ],
          "line": 431
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"sasl=%p mechlist=%s prompt_need=%p clientout=%p clientoutlen=%p mech=%p\"",
            "sasl",
            "mechlist",
            "prompt_need",
            "clientout",
            "clientoutlen",
            "mech"
          ],
          "line": 428
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virnetmessage.h\"\n#include \"virnetsaslcontext.h\"\n#include <config.h>\n\nint virNetSASLSessionClientStart(virNetSASLSessionPtr sasl,\n                                 const char *mechlist,\n                                 sasl_interact_t **prompt_need,\n                                 const char **clientout,\n                                 size_t *clientoutlen,\n                                 const char **mech)\n{\n    unsigned outlen = 0;\n    int err;\n    int ret = -1;\n\n    VIR_DEBUG(\"sasl=%p mechlist=%s prompt_need=%p clientout=%p clientoutlen=%p mech=%p\",\n              sasl, mechlist, prompt_need, clientout, clientoutlen, mech);\n\n    virObjectLock(sasl);\n    err = sasl_client_start(sasl->conn,\n                            mechlist,\n                            prompt_need,\n                            clientout,\n                            &outlen,\n                            mech);\n\n    *clientoutlen = outlen;\n\n    switch (err) {\n    case SASL_OK:\n        if (virNetSASLSessionUpdateBufSize(sasl) < 0)\n            goto cleanup;\n        ret = VIR_NET_SASL_COMPLETE;\n        break;\n    case SASL_CONTINUE:\n        ret = VIR_NET_SASL_CONTINUE;\n        break;\n    case SASL_INTERACT:\n        ret = VIR_NET_SASL_INTERACT;\n        break;\n    default:\n        virReportError(VIR_ERR_AUTH_FAILED,\n                       _(\"Failed to start SASL negotiation: %d (%s)\"),\n                       err, sasl_errdetail(sasl->conn));\n        break;\n    }\n\n cleanup:\n    virObjectUnlock(sasl);\n    return ret;\n}"
  },
  {
    "function_name": "virNetSASLSessionListMechanisms",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetsaslcontext.c",
    "lines": "382-414",
    "snippet": "char *virNetSASLSessionListMechanisms(virNetSASLSessionPtr sasl)\n{\n    const char *mechlist;\n    char *ret = NULL;\n    int err;\n\n    virObjectLock(sasl);\n    err = sasl_listmech(sasl->conn,\n                        NULL, /* Don't need to set user */\n                        \"\", /* Prefix */\n                        \",\", /* Separator */\n                        \"\", /* Suffix */\n                        &mechlist,\n                        NULL,\n                        NULL);\n    if (err != SASL_OK) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"cannot list SASL mechanisms %d (%s)\"),\n                       err, sasl_errdetail(sasl->conn));\n        goto cleanup;\n    }\n    VIR_DEBUG(\"SASL mechanism list is '%s'\", mechlist);\n    if (STREQ(mechlist, \"\")) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"no SASL mechanisms are available\"));\n        goto cleanup;\n    }\n    ret = g_strdup(mechlist);\n\n cleanup:\n    virObjectUnlock(sasl);\n    return ret;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virthread.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virnetmessage.h\"",
      "#include \"virnetsaslcontext.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "sasl"
          ],
          "line": 412
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "mechlist"
          ],
          "line": 409
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"no SASL mechanisms are available\")"
          ],
          "line": 405
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "mechlist",
            "\"\""
          ],
          "line": 404
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"SASL mechanism list is '%s'\"",
            "mechlist"
          ],
          "line": 403
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"cannot list SASL mechanisms %d (%s)\")",
            "err",
            "sasl_errdetail(sasl->conn)"
          ],
          "line": 398
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sasl_errdetail",
          "args": [
            "sasl->conn"
          ],
          "line": 400
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sasl_listmech",
          "args": [
            "sasl->conn",
            "NULL",
            "/* Don't need to set user */\"\"",
            "/* Prefix */\",\"",
            "/* Separator */\"\"",
            "/* Suffix */&mechlist",
            "NULL",
            "NULL"
          ],
          "line": 389
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "sasl"
          ],
          "line": 388
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virnetmessage.h\"\n#include \"virnetsaslcontext.h\"\n#include <config.h>\n\nchar *virNetSASLSessionListMechanisms(virNetSASLSessionPtr sasl)\n{\n    const char *mechlist;\n    char *ret = NULL;\n    int err;\n\n    virObjectLock(sasl);\n    err = sasl_listmech(sasl->conn,\n                        NULL, /* Don't need to set user */\n                        \"\", /* Prefix */\n                        \",\", /* Separator */\n                        \"\", /* Suffix */\n                        &mechlist,\n                        NULL,\n                        NULL);\n    if (err != SASL_OK) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"cannot list SASL mechanisms %d (%s)\"),\n                       err, sasl_errdetail(sasl->conn));\n        goto cleanup;\n    }\n    VIR_DEBUG(\"SASL mechanism list is '%s'\", mechlist);\n    if (STREQ(mechlist, \"\")) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"no SASL mechanisms are available\"));\n        goto cleanup;\n    }\n    ret = g_strdup(mechlist);\n\n cleanup:\n    virObjectUnlock(sasl);\n    return ret;\n}"
  },
  {
    "function_name": "virNetSASLSessionUpdateBufSize",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetsaslcontext.c",
    "lines": "360-380",
    "snippet": "static int virNetSASLSessionUpdateBufSize(virNetSASLSessionPtr sasl)\n{\n    union {\n        unsigned *maxbufsize;\n        const void *ptr;\n    } u;\n    int err;\n\n    err = sasl_getprop(sasl->conn, SASL_MAXOUTBUF, &u.ptr);\n    if (err != SASL_OK) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"cannot get security props %d (%s)\"),\n                       err, sasl_errstring(err, NULL, NULL));\n        return -1;\n    }\n\n    VIR_DEBUG(\"Negotiated bufsize is %u vs requested size %zu\",\n              *u.maxbufsize, sasl->maxbufsize);\n    sasl->maxbufsize = *u.maxbufsize;\n    return 0;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virthread.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virnetmessage.h\"",
      "#include \"virnetsaslcontext.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Negotiated bufsize is %u vs requested size %zu\"",
            "*u.maxbufsize",
            "sasl->maxbufsize"
          ],
          "line": 376
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"cannot get security props %d (%s)\")",
            "err",
            "sasl_errstring(err, NULL, NULL)"
          ],
          "line": 370
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sasl_errstring",
          "args": [
            "err",
            "NULL",
            "NULL"
          ],
          "line": 372
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"cannot get security props %d (%s)\""
          ],
          "line": 371
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "sasl_getprop",
          "args": [
            "sasl->conn",
            "SASL_MAXOUTBUF",
            "&u.ptr"
          ],
          "line": 368
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virnetmessage.h\"\n#include \"virnetsaslcontext.h\"\n#include <config.h>\n\nstatic int virNetSASLSessionUpdateBufSize(virNetSASLSessionPtr sasl)\n{\n    union {\n        unsigned *maxbufsize;\n        const void *ptr;\n    } u;\n    int err;\n\n    err = sasl_getprop(sasl->conn, SASL_MAXOUTBUF, &u.ptr);\n    if (err != SASL_OK) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"cannot get security props %d (%s)\"),\n                       err, sasl_errstring(err, NULL, NULL));\n        return -1;\n    }\n\n    VIR_DEBUG(\"Negotiated bufsize is %u vs requested size %zu\",\n              *u.maxbufsize, sasl->maxbufsize);\n    sasl->maxbufsize = *u.maxbufsize;\n    return 0;\n}"
  },
  {
    "function_name": "virNetSASLSessionSecProps",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetsaslcontext.c",
    "lines": "323-357",
    "snippet": "int virNetSASLSessionSecProps(virNetSASLSessionPtr sasl,\n                              int minSSF,\n                              int maxSSF,\n                              bool allowAnonymous)\n{\n    sasl_security_properties_t secprops;\n    int err;\n    int ret = -1;\n\n    VIR_DEBUG(\"minSSF=%d maxSSF=%d allowAnonymous=%d maxbufsize=%zu\",\n              minSSF, maxSSF, allowAnonymous, sasl->maxbufsize);\n\n    virObjectLock(sasl);\n    memset(&secprops, 0, sizeof(secprops));\n\n    secprops.min_ssf = minSSF;\n    secprops.max_ssf = maxSSF;\n    secprops.maxbufsize = sasl->maxbufsize;\n    secprops.security_flags = allowAnonymous ? 0 :\n        SASL_SEC_NOANONYMOUS | SASL_SEC_NOPLAINTEXT;\n\n    err = sasl_setprop(sasl->conn, SASL_SEC_PROPS, &secprops);\n    if (err != SASL_OK) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"cannot set security props %d (%s)\"),\n                       err, sasl_errstring(err, NULL, NULL));\n        goto cleanup;\n    }\n\n    ret = 0;\n\n cleanup:\n    virObjectUnlock(sasl);\n    return ret;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virthread.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virnetmessage.h\"",
      "#include \"virnetsaslcontext.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "sasl"
          ],
          "line": 355
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"cannot set security props %d (%s)\")",
            "err",
            "sasl_errstring(err, NULL, NULL)"
          ],
          "line": 346
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sasl_errstring",
          "args": [
            "err",
            "NULL",
            "NULL"
          ],
          "line": 348
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"cannot set security props %d (%s)\""
          ],
          "line": 347
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "sasl_setprop",
          "args": [
            "sasl->conn",
            "SASL_SEC_PROPS",
            "&secprops"
          ],
          "line": 344
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&secprops",
            "0",
            "sizeof(secprops)"
          ],
          "line": 336
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "sasl"
          ],
          "line": 335
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"minSSF=%d maxSSF=%d allowAnonymous=%d maxbufsize=%zu\"",
            "minSSF",
            "maxSSF",
            "allowAnonymous",
            "sasl->maxbufsize"
          ],
          "line": 332
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virnetmessage.h\"\n#include \"virnetsaslcontext.h\"\n#include <config.h>\n\nint virNetSASLSessionSecProps(virNetSASLSessionPtr sasl,\n                              int minSSF,\n                              int maxSSF,\n                              bool allowAnonymous)\n{\n    sasl_security_properties_t secprops;\n    int err;\n    int ret = -1;\n\n    VIR_DEBUG(\"minSSF=%d maxSSF=%d allowAnonymous=%d maxbufsize=%zu\",\n              minSSF, maxSSF, allowAnonymous, sasl->maxbufsize);\n\n    virObjectLock(sasl);\n    memset(&secprops, 0, sizeof(secprops));\n\n    secprops.min_ssf = minSSF;\n    secprops.max_ssf = maxSSF;\n    secprops.maxbufsize = sasl->maxbufsize;\n    secprops.security_flags = allowAnonymous ? 0 :\n        SASL_SEC_NOANONYMOUS | SASL_SEC_NOPLAINTEXT;\n\n    err = sasl_setprop(sasl->conn, SASL_SEC_PROPS, &secprops);\n    if (err != SASL_OK) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"cannot set security props %d (%s)\"),\n                       err, sasl_errstring(err, NULL, NULL));\n        goto cleanup;\n    }\n\n    ret = 0;\n\n cleanup:\n    virObjectUnlock(sasl);\n    return ret;\n}"
  },
  {
    "function_name": "virNetSASLSessionGetKeySize",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetsaslcontext.c",
    "lines": "301-321",
    "snippet": "int virNetSASLSessionGetKeySize(virNetSASLSessionPtr sasl)\n{\n    int err;\n    int ssf;\n    const void *val;\n\n    virObjectLock(sasl);\n    err = sasl_getprop(sasl->conn, SASL_SSF, &val);\n    if (err != SASL_OK) {\n        virReportError(VIR_ERR_AUTH_FAILED,\n                       _(\"cannot query SASL ssf on connection %d (%s)\"),\n                       err, sasl_errstring(err, NULL, NULL));\n        ssf = -1;\n        goto cleanup;\n    }\n    ssf = *(const int *)val;\n\n cleanup:\n    virObjectUnlock(sasl);\n    return ssf;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virthread.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virnetmessage.h\"",
      "#include \"virnetsaslcontext.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "sasl"
          ],
          "line": 319
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_AUTH_FAILED",
            "_(\"cannot query SASL ssf on connection %d (%s)\")",
            "err",
            "sasl_errstring(err, NULL, NULL)"
          ],
          "line": 310
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sasl_errstring",
          "args": [
            "err",
            "NULL",
            "NULL"
          ],
          "line": 312
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"cannot query SASL ssf on connection %d (%s)\""
          ],
          "line": 311
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "sasl_getprop",
          "args": [
            "sasl->conn",
            "SASL_SSF",
            "&val"
          ],
          "line": 308
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "sasl"
          ],
          "line": 307
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virnetmessage.h\"\n#include \"virnetsaslcontext.h\"\n#include <config.h>\n\nint virNetSASLSessionGetKeySize(virNetSASLSessionPtr sasl)\n{\n    int err;\n    int ssf;\n    const void *val;\n\n    virObjectLock(sasl);\n    err = sasl_getprop(sasl->conn, SASL_SSF, &val);\n    if (err != SASL_OK) {\n        virReportError(VIR_ERR_AUTH_FAILED,\n                       _(\"cannot query SASL ssf on connection %d (%s)\"),\n                       err, sasl_errstring(err, NULL, NULL));\n        ssf = -1;\n        goto cleanup;\n    }\n    ssf = *(const int *)val;\n\n cleanup:\n    virObjectUnlock(sasl);\n    return ssf;\n}"
  },
  {
    "function_name": "virNetSASLSessionGetIdentity",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetsaslcontext.c",
    "lines": "274-298",
    "snippet": "const char *virNetSASLSessionGetIdentity(virNetSASLSessionPtr sasl)\n{\n    const void *val = NULL;\n    int err;\n    virObjectLock(sasl);\n\n    err = sasl_getprop(sasl->conn, SASL_USERNAME, &val);\n    if (err != SASL_OK) {\n        virReportError(VIR_ERR_AUTH_FAILED,\n                       _(\"cannot query SASL username on connection %d (%s)\"),\n                       err, sasl_errstring(err, NULL, NULL));\n        val = NULL;\n        goto cleanup;\n    }\n    if (val == NULL) {\n        virReportError(VIR_ERR_AUTH_FAILED, \"%s\",\n                       _(\"no client username was found\"));\n        goto cleanup;\n    }\n    VIR_DEBUG(\"SASL client username %s\", (const char *)val);\n\n cleanup:\n    virObjectUnlock(sasl);\n    return (const char*)val;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virthread.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virnetmessage.h\"",
      "#include \"virnetsaslcontext.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "sasl"
          ],
          "line": 296
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"SASL client username %s\"",
            "(const char *)val"
          ],
          "line": 293
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_AUTH_FAILED",
            "\"%s\"",
            "_(\"no client username was found\")"
          ],
          "line": 289
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"no client username was found\""
          ],
          "line": 290
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_AUTH_FAILED",
            "_(\"cannot query SASL username on connection %d (%s)\")",
            "err",
            "sasl_errstring(err, NULL, NULL)"
          ],
          "line": 282
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sasl_errstring",
          "args": [
            "err",
            "NULL",
            "NULL"
          ],
          "line": 284
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sasl_getprop",
          "args": [
            "sasl->conn",
            "SASL_USERNAME",
            "&val"
          ],
          "line": 280
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "sasl"
          ],
          "line": 278
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virnetmessage.h\"\n#include \"virnetsaslcontext.h\"\n#include <config.h>\n\nconst char *virNetSASLSessionGetIdentity(virNetSASLSessionPtr sasl)\n{\n    const void *val = NULL;\n    int err;\n    virObjectLock(sasl);\n\n    err = sasl_getprop(sasl->conn, SASL_USERNAME, &val);\n    if (err != SASL_OK) {\n        virReportError(VIR_ERR_AUTH_FAILED,\n                       _(\"cannot query SASL username on connection %d (%s)\"),\n                       err, sasl_errstring(err, NULL, NULL));\n        val = NULL;\n        goto cleanup;\n    }\n    if (val == NULL) {\n        virReportError(VIR_ERR_AUTH_FAILED, \"%s\",\n                       _(\"no client username was found\"));\n        goto cleanup;\n    }\n    VIR_DEBUG(\"SASL client username %s\", (const char *)val);\n\n cleanup:\n    virObjectUnlock(sasl);\n    return (const char*)val;\n}"
  },
  {
    "function_name": "virNetSASLSessionExtKeySize",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetsaslcontext.c",
    "lines": "252-272",
    "snippet": "int virNetSASLSessionExtKeySize(virNetSASLSessionPtr sasl,\n                                int ssf)\n{\n    int err;\n    int ret = -1;\n    virObjectLock(sasl);\n\n    err = sasl_setprop(sasl->conn, SASL_SSF_EXTERNAL, &ssf);\n    if (err != SASL_OK) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"cannot set external SSF %d (%s)\"),\n                       err, sasl_errstring(err, NULL, NULL));\n        goto cleanup;\n    }\n\n    ret = 0;\n\n cleanup:\n    virObjectUnlock(sasl);\n    return ret;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virthread.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virnetmessage.h\"",
      "#include \"virnetsaslcontext.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "sasl"
          ],
          "line": 270
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"cannot set external SSF %d (%s)\")",
            "err",
            "sasl_errstring(err, NULL, NULL)"
          ],
          "line": 261
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sasl_errstring",
          "args": [
            "err",
            "NULL",
            "NULL"
          ],
          "line": 263
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"cannot set external SSF %d (%s)\""
          ],
          "line": 262
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "sasl_setprop",
          "args": [
            "sasl->conn",
            "SASL_SSF_EXTERNAL",
            "&ssf"
          ],
          "line": 259
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "sasl"
          ],
          "line": 257
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virnetmessage.h\"\n#include \"virnetsaslcontext.h\"\n#include <config.h>\n\nint virNetSASLSessionExtKeySize(virNetSASLSessionPtr sasl,\n                                int ssf)\n{\n    int err;\n    int ret = -1;\n    virObjectLock(sasl);\n\n    err = sasl_setprop(sasl->conn, SASL_SSF_EXTERNAL, &ssf);\n    if (err != SASL_OK) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"cannot set external SSF %d (%s)\"),\n                       err, sasl_errstring(err, NULL, NULL));\n        goto cleanup;\n    }\n\n    ret = 0;\n\n cleanup:\n    virObjectUnlock(sasl);\n    return ret;\n}"
  },
  {
    "function_name": "virNetSASLSessionNewServer",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetsaslcontext.c",
    "lines": "216-250",
    "snippet": "virNetSASLSessionPtr virNetSASLSessionNewServer(virNetSASLContextPtr ctxt G_GNUC_UNUSED,\n                                                const char *service,\n                                                const char *localAddr,\n                                                const char *remoteAddr)\n{\n    virNetSASLSessionPtr sasl = NULL;\n    int err;\n\n    if (!(sasl = virObjectLockableNew(virNetSASLSessionClass)))\n        return NULL;\n\n    /* Arbitrary size for amount of data we can encode in a single block */\n    sasl->maxbufsize = 1 << 16;\n\n    err = sasl_server_new(service,\n                          NULL,\n                          NULL,\n                          localAddr,\n                          remoteAddr,\n                          NULL,\n                          SASL_SUCCESS_DATA,\n                          &sasl->conn);\n    if (err != SASL_OK) {\n        virReportError(VIR_ERR_AUTH_FAILED,\n                       _(\"Failed to create SASL client context: %d (%s)\"),\n                       err, sasl_errstring(err, NULL, NULL));\n        goto cleanup;\n    }\n\n    return sasl;\n\n cleanup:\n    virObjectUnref(sasl);\n    return NULL;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virthread.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virnetmessage.h\"",
      "#include \"virnetsaslcontext.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virClassPtr virNetSASLSessionClass;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "sasl"
          ],
          "line": 248
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_AUTH_FAILED",
            "_(\"Failed to create SASL client context: %d (%s)\")",
            "err",
            "sasl_errstring(err, NULL, NULL)"
          ],
          "line": 239
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sasl_errstring",
          "args": [
            "err",
            "NULL",
            "NULL"
          ],
          "line": 241
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Failed to create SASL client context: %d (%s)\""
          ],
          "line": 240
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "sasl_server_new",
          "args": [
            "service",
            "NULL",
            "NULL",
            "localAddr",
            "remoteAddr",
            "NULL",
            "SASL_SUCCESS_DATA",
            "&sasl->conn"
          ],
          "line": 230
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virObjectLockableNew",
          "args": [
            "virNetSASLSessionClass"
          ],
          "line": 224
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLockableNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "256-279",
          "snippet": "void *\nvirObjectLockableNew(virClassPtr klass)\n{\n    virObjectLockablePtr obj;\n\n    if (!virClassIsDerivedFrom(klass, virClassForObjectLockable())) {\n        virReportInvalidArg(klass,\n                            _(\"Class %s must derive from virObjectLockable\"),\n                            virClassName(klass));\n        return NULL;\n    }\n\n    if (!(obj = virObjectNew(klass)))\n        return NULL;\n\n    if (virMutexInit(&obj->lock) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Unable to initialize mutex\"));\n        virObjectUnref(obj);\n        return NULL;\n    }\n\n    return obj;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nvoid *\nvirObjectLockableNew(virClassPtr klass)\n{\n    virObjectLockablePtr obj;\n\n    if (!virClassIsDerivedFrom(klass, virClassForObjectLockable())) {\n        virReportInvalidArg(klass,\n                            _(\"Class %s must derive from virObjectLockable\"),\n                            virClassName(klass));\n        return NULL;\n    }\n\n    if (!(obj = virObjectNew(klass)))\n        return NULL;\n\n    if (virMutexInit(&obj->lock) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Unable to initialize mutex\"));\n        virObjectUnref(obj);\n        return NULL;\n    }\n\n    return obj;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virnetmessage.h\"\n#include \"virnetsaslcontext.h\"\n#include <config.h>\n\nstatic virClassPtr virNetSASLSessionClass;\n\nvirNetSASLSessionPtr virNetSASLSessionNewServer(virNetSASLContextPtr ctxt G_GNUC_UNUSED,\n                                                const char *service,\n                                                const char *localAddr,\n                                                const char *remoteAddr)\n{\n    virNetSASLSessionPtr sasl = NULL;\n    int err;\n\n    if (!(sasl = virObjectLockableNew(virNetSASLSessionClass)))\n        return NULL;\n\n    /* Arbitrary size for amount of data we can encode in a single block */\n    sasl->maxbufsize = 1 << 16;\n\n    err = sasl_server_new(service,\n                          NULL,\n                          NULL,\n                          localAddr,\n                          remoteAddr,\n                          NULL,\n                          SASL_SUCCESS_DATA,\n                          &sasl->conn);\n    if (err != SASL_OK) {\n        virReportError(VIR_ERR_AUTH_FAILED,\n                       _(\"Failed to create SASL client context: %d (%s)\"),\n                       err, sasl_errstring(err, NULL, NULL));\n        goto cleanup;\n    }\n\n    return sasl;\n\n cleanup:\n    virObjectUnref(sasl);\n    return NULL;\n}"
  },
  {
    "function_name": "virNetSASLSessionNewClient",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetsaslcontext.c",
    "lines": "178-214",
    "snippet": "virNetSASLSessionPtr virNetSASLSessionNewClient(virNetSASLContextPtr ctxt G_GNUC_UNUSED,\n                                                const char *service,\n                                                const char *hostname,\n                                                const char *localAddr,\n                                                const char *remoteAddr,\n                                                sasl_callback_t *cbs)\n{\n    virNetSASLSessionPtr sasl = NULL;\n    int err;\n\n    if (!(sasl = virObjectLockableNew(virNetSASLSessionClass)))\n        return NULL;\n\n    /* Arbitrary size for amount of data we can encode in a single block */\n    sasl->maxbufsize = 1 << 16;\n\n    err = sasl_client_new(service,\n                          hostname,\n                          localAddr,\n                          remoteAddr,\n                          cbs,\n                          SASL_SUCCESS_DATA,\n                          &sasl->conn);\n    if (err != SASL_OK) {\n        virReportError(VIR_ERR_AUTH_FAILED,\n                       _(\"Failed to create SASL client context: %d (%s)\"),\n                       err, sasl_errstring(err, NULL, NULL));\n        goto cleanup;\n    }\n    sasl->callbacks = cbs;\n\n    return sasl;\n\n cleanup:\n    virObjectUnref(sasl);\n    return NULL;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virthread.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virnetmessage.h\"",
      "#include \"virnetsaslcontext.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virClassPtr virNetSASLSessionClass;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "sasl"
          ],
          "line": 212
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_AUTH_FAILED",
            "_(\"Failed to create SASL client context: %d (%s)\")",
            "err",
            "sasl_errstring(err, NULL, NULL)"
          ],
          "line": 202
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sasl_errstring",
          "args": [
            "err",
            "NULL",
            "NULL"
          ],
          "line": 204
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Failed to create SASL client context: %d (%s)\""
          ],
          "line": 203
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "sasl_client_new",
          "args": [
            "service",
            "hostname",
            "localAddr",
            "remoteAddr",
            "cbs",
            "SASL_SUCCESS_DATA",
            "&sasl->conn"
          ],
          "line": 194
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virObjectLockableNew",
          "args": [
            "virNetSASLSessionClass"
          ],
          "line": 188
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLockableNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "256-279",
          "snippet": "void *\nvirObjectLockableNew(virClassPtr klass)\n{\n    virObjectLockablePtr obj;\n\n    if (!virClassIsDerivedFrom(klass, virClassForObjectLockable())) {\n        virReportInvalidArg(klass,\n                            _(\"Class %s must derive from virObjectLockable\"),\n                            virClassName(klass));\n        return NULL;\n    }\n\n    if (!(obj = virObjectNew(klass)))\n        return NULL;\n\n    if (virMutexInit(&obj->lock) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Unable to initialize mutex\"));\n        virObjectUnref(obj);\n        return NULL;\n    }\n\n    return obj;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nvoid *\nvirObjectLockableNew(virClassPtr klass)\n{\n    virObjectLockablePtr obj;\n\n    if (!virClassIsDerivedFrom(klass, virClassForObjectLockable())) {\n        virReportInvalidArg(klass,\n                            _(\"Class %s must derive from virObjectLockable\"),\n                            virClassName(klass));\n        return NULL;\n    }\n\n    if (!(obj = virObjectNew(klass)))\n        return NULL;\n\n    if (virMutexInit(&obj->lock) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Unable to initialize mutex\"));\n        virObjectUnref(obj);\n        return NULL;\n    }\n\n    return obj;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virnetmessage.h\"\n#include \"virnetsaslcontext.h\"\n#include <config.h>\n\nstatic virClassPtr virNetSASLSessionClass;\n\nvirNetSASLSessionPtr virNetSASLSessionNewClient(virNetSASLContextPtr ctxt G_GNUC_UNUSED,\n                                                const char *service,\n                                                const char *hostname,\n                                                const char *localAddr,\n                                                const char *remoteAddr,\n                                                sasl_callback_t *cbs)\n{\n    virNetSASLSessionPtr sasl = NULL;\n    int err;\n\n    if (!(sasl = virObjectLockableNew(virNetSASLSessionClass)))\n        return NULL;\n\n    /* Arbitrary size for amount of data we can encode in a single block */\n    sasl->maxbufsize = 1 << 16;\n\n    err = sasl_client_new(service,\n                          hostname,\n                          localAddr,\n                          remoteAddr,\n                          cbs,\n                          SASL_SUCCESS_DATA,\n                          &sasl->conn);\n    if (err != SASL_OK) {\n        virReportError(VIR_ERR_AUTH_FAILED,\n                       _(\"Failed to create SASL client context: %d (%s)\"),\n                       err, sasl_errstring(err, NULL, NULL));\n        goto cleanup;\n    }\n    sasl->callbacks = cbs;\n\n    return sasl;\n\n cleanup:\n    virObjectUnref(sasl);\n    return NULL;\n}"
  },
  {
    "function_name": "virNetSASLContextCheckIdentity",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetsaslcontext.c",
    "lines": "140-175",
    "snippet": "int virNetSASLContextCheckIdentity(virNetSASLContextPtr ctxt,\n                                   const char *identity)\n{\n    const char *const*wildcards;\n    int ret = -1;\n\n    virObjectLock(ctxt);\n\n    /* If the list is not set, allow any DN. */\n    wildcards = ctxt->usernameWhitelist;\n    if (!wildcards) {\n        ret = 1; /* No ACL, allow all */\n        goto cleanup;\n    }\n\n    while (*wildcards) {\n        if (g_pattern_match_simple(*wildcards, identity)) {\n            ret = 1;\n            goto cleanup; /* Successful match */\n        }\n\n        wildcards++;\n    }\n\n    /* Denied */\n    VIR_ERROR(_(\"SASL client identity '%s' not allowed in whitelist\"), identity);\n\n    /* This is the most common error: make it informative. */\n    virReportError(VIR_ERR_SYSTEM_ERROR, \"%s\",\n                   _(\"Client's username is not on the list of allowed clients\"));\n    ret = 0;\n\n cleanup:\n    virObjectUnlock(ctxt);\n    return ret;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virthread.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virnetmessage.h\"",
      "#include \"virnetsaslcontext.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnlock",
          "args": [
            "ctxt"
          ],
          "line": 173
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "501-510",
          "snippet": "void\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectUnlock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_SYSTEM_ERROR",
            "\"%s\"",
            "_(\"Client's username is not on the list of allowed clients\")"
          ],
          "line": 168
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Client's username is not on the list of allowed clients\""
          ],
          "line": 169
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_ERROR",
          "args": [
            "_(\"SASL client identity '%s' not allowed in whitelist\")",
            "identity"
          ],
          "line": 165
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_pattern_match_simple",
          "args": [
            "*wildcards",
            "identity"
          ],
          "line": 156
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virObjectLock",
          "args": [
            "ctxt"
          ],
          "line": 146
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "424-433",
          "snippet": "void\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid\nvirObjectLock(void *anyobj)\n{\n    virObjectLockablePtr obj = virObjectGetLockableObj(anyobj);\n\n    if (!obj)\n        return;\n\n    virMutexLock(&obj->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virnetmessage.h\"\n#include \"virnetsaslcontext.h\"\n#include <config.h>\n\nint virNetSASLContextCheckIdentity(virNetSASLContextPtr ctxt,\n                                   const char *identity)\n{\n    const char *const*wildcards;\n    int ret = -1;\n\n    virObjectLock(ctxt);\n\n    /* If the list is not set, allow any DN. */\n    wildcards = ctxt->usernameWhitelist;\n    if (!wildcards) {\n        ret = 1; /* No ACL, allow all */\n        goto cleanup;\n    }\n\n    while (*wildcards) {\n        if (g_pattern_match_simple(*wildcards, identity)) {\n            ret = 1;\n            goto cleanup; /* Successful match */\n        }\n\n        wildcards++;\n    }\n\n    /* Denied */\n    VIR_ERROR(_(\"SASL client identity '%s' not allowed in whitelist\"), identity);\n\n    /* This is the most common error: make it informative. */\n    virReportError(VIR_ERR_SYSTEM_ERROR, \"%s\",\n                   _(\"Client's username is not on the list of allowed clients\"));\n    ret = 0;\n\n cleanup:\n    virObjectUnlock(ctxt);\n    return ret;\n}"
  },
  {
    "function_name": "virNetSASLContextNewServer",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetsaslcontext.c",
    "lines": "124-138",
    "snippet": "virNetSASLContextPtr virNetSASLContextNewServer(const char *const*usernameWhitelist)\n{\n    virNetSASLContextPtr ctxt;\n\n    if (virNetSASLContextInitialize() < 0 ||\n        virNetSASLContextServerInitialize() < 0)\n        return NULL;\n\n    if (!(ctxt = virObjectLockableNew(virNetSASLContextClass)))\n        return NULL;\n\n    ctxt->usernameWhitelist = usernameWhitelist;\n\n    return ctxt;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virthread.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virnetmessage.h\"",
      "#include \"virnetsaslcontext.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virClassPtr virNetSASLContextClass;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectLockableNew",
          "args": [
            "virNetSASLContextClass"
          ],
          "line": 132
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLockableNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "256-279",
          "snippet": "void *\nvirObjectLockableNew(virClassPtr klass)\n{\n    virObjectLockablePtr obj;\n\n    if (!virClassIsDerivedFrom(klass, virClassForObjectLockable())) {\n        virReportInvalidArg(klass,\n                            _(\"Class %s must derive from virObjectLockable\"),\n                            virClassName(klass));\n        return NULL;\n    }\n\n    if (!(obj = virObjectNew(klass)))\n        return NULL;\n\n    if (virMutexInit(&obj->lock) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Unable to initialize mutex\"));\n        virObjectUnref(obj);\n        return NULL;\n    }\n\n    return obj;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nvoid *\nvirObjectLockableNew(virClassPtr klass)\n{\n    virObjectLockablePtr obj;\n\n    if (!virClassIsDerivedFrom(klass, virClassForObjectLockable())) {\n        virReportInvalidArg(klass,\n                            _(\"Class %s must derive from virObjectLockable\"),\n                            virClassName(klass));\n        return NULL;\n    }\n\n    if (!(obj = virObjectNew(klass)))\n        return NULL;\n\n    if (virMutexInit(&obj->lock) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Unable to initialize mutex\"));\n        virObjectUnref(obj);\n        return NULL;\n    }\n\n    return obj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetSASLContextServerInitialize",
          "args": [],
          "line": 129
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNetSASLContextInitialize",
          "args": [],
          "line": 128
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virnetmessage.h\"\n#include \"virnetsaslcontext.h\"\n#include <config.h>\n\nstatic virClassPtr virNetSASLContextClass;\n\nvirNetSASLContextPtr virNetSASLContextNewServer(const char *const*usernameWhitelist)\n{\n    virNetSASLContextPtr ctxt;\n\n    if (virNetSASLContextInitialize() < 0 ||\n        virNetSASLContextServerInitialize() < 0)\n        return NULL;\n\n    if (!(ctxt = virObjectLockableNew(virNetSASLContextClass)))\n        return NULL;\n\n    ctxt->usernameWhitelist = usernameWhitelist;\n\n    return ctxt;\n}"
  },
  {
    "function_name": "virNetSASLContextNewClient",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetsaslcontext.c",
    "lines": "110-122",
    "snippet": "virNetSASLContextPtr virNetSASLContextNewClient(void)\n{\n    virNetSASLContextPtr ctxt;\n\n    if (virNetSASLContextInitialize() < 0 ||\n        virNetSASLContextClientInitialize() < 0)\n        return NULL;\n\n    if (!(ctxt = virObjectLockableNew(virNetSASLContextClass)))\n        return NULL;\n\n    return ctxt;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virthread.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virnetmessage.h\"",
      "#include \"virnetsaslcontext.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virClassPtr virNetSASLContextClass;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectLockableNew",
          "args": [
            "virNetSASLContextClass"
          ],
          "line": 118
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLockableNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "256-279",
          "snippet": "void *\nvirObjectLockableNew(virClassPtr klass)\n{\n    virObjectLockablePtr obj;\n\n    if (!virClassIsDerivedFrom(klass, virClassForObjectLockable())) {\n        virReportInvalidArg(klass,\n                            _(\"Class %s must derive from virObjectLockable\"),\n                            virClassName(klass));\n        return NULL;\n    }\n\n    if (!(obj = virObjectNew(klass)))\n        return NULL;\n\n    if (virMutexInit(&obj->lock) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Unable to initialize mutex\"));\n        virObjectUnref(obj);\n        return NULL;\n    }\n\n    return obj;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nvoid *\nvirObjectLockableNew(virClassPtr klass)\n{\n    virObjectLockablePtr obj;\n\n    if (!virClassIsDerivedFrom(klass, virClassForObjectLockable())) {\n        virReportInvalidArg(klass,\n                            _(\"Class %s must derive from virObjectLockable\"),\n                            virClassName(klass));\n        return NULL;\n    }\n\n    if (!(obj = virObjectNew(klass)))\n        return NULL;\n\n    if (virMutexInit(&obj->lock) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Unable to initialize mutex\"));\n        virObjectUnref(obj);\n        return NULL;\n    }\n\n    return obj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetSASLContextClientInitialize",
          "args": [],
          "line": 115
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNetSASLContextInitialize",
          "args": [],
          "line": 114
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virnetmessage.h\"\n#include \"virnetsaslcontext.h\"\n#include <config.h>\n\nstatic virClassPtr virNetSASLContextClass;\n\nvirNetSASLContextPtr virNetSASLContextNewClient(void)\n{\n    virNetSASLContextPtr ctxt;\n\n    if (virNetSASLContextInitialize() < 0 ||\n        virNetSASLContextClientInitialize() < 0)\n        return NULL;\n\n    if (!(ctxt = virObjectLockableNew(virNetSASLContextClass)))\n        return NULL;\n\n    return ctxt;\n}"
  },
  {
    "function_name": "virNetSASLContextServerOnceInit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetsaslcontext.c",
    "lines": "94-105",
    "snippet": "static int virNetSASLContextServerOnceInit(void)\n{\n    int err = sasl_server_init(NULL, \"libvirt\");\n    if (err != SASL_OK) {\n        virReportError(VIR_ERR_AUTH_FAILED,\n                       _(\"failed to initialize SASL library: %d (%s)\"),\n                       err, sasl_errstring(err, NULL, NULL));\n        return -1;\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virthread.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virnetmessage.h\"",
      "#include \"virnetsaslcontext.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_AUTH_FAILED",
            "_(\"failed to initialize SASL library: %d (%s)\")",
            "err",
            "sasl_errstring(err, NULL, NULL)"
          ],
          "line": 98
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sasl_errstring",
          "args": [
            "err",
            "NULL",
            "NULL"
          ],
          "line": 100
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"failed to initialize SASL library: %d (%s)\""
          ],
          "line": 99
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "sasl_server_init",
          "args": [
            "NULL",
            "\"libvirt\""
          ],
          "line": 96
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virnetmessage.h\"\n#include \"virnetsaslcontext.h\"\n#include <config.h>\n\nstatic int virNetSASLContextServerOnceInit(void)\n{\n    int err = sasl_server_init(NULL, \"libvirt\");\n    if (err != SASL_OK) {\n        virReportError(VIR_ERR_AUTH_FAILED,\n                       _(\"failed to initialize SASL library: %d (%s)\"),\n                       err, sasl_errstring(err, NULL, NULL));\n        return -1;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virNetSASLContextClientOnceInit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetsaslcontext.c",
    "lines": "78-89",
    "snippet": "static int virNetSASLContextClientOnceInit(void)\n{\n    int err = sasl_client_init(NULL);\n    if (err != SASL_OK) {\n        virReportError(VIR_ERR_AUTH_FAILED,\n                       _(\"failed to initialize SASL library: %d (%s)\"),\n                       err, sasl_errstring(err, NULL, NULL));\n        return -1;\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virthread.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virnetmessage.h\"",
      "#include \"virnetsaslcontext.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_AUTH_FAILED",
            "_(\"failed to initialize SASL library: %d (%s)\")",
            "err",
            "sasl_errstring(err, NULL, NULL)"
          ],
          "line": 82
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sasl_errstring",
          "args": [
            "err",
            "NULL",
            "NULL"
          ],
          "line": 84
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"failed to initialize SASL library: %d (%s)\""
          ],
          "line": 83
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "sasl_client_init",
          "args": [
            "NULL"
          ],
          "line": 80
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virnetmessage.h\"\n#include \"virnetsaslcontext.h\"\n#include <config.h>\n\nstatic int virNetSASLContextClientOnceInit(void)\n{\n    int err = sasl_client_init(NULL);\n    if (err != SASL_OK) {\n        virReportError(VIR_ERR_AUTH_FAILED,\n                       _(\"failed to initialize SASL library: %d (%s)\"),\n                       err, sasl_errstring(err, NULL, NULL));\n        return -1;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virNetSASLContextOnceInit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/rpc/virnetsaslcontext.c",
    "lines": "56-65",
    "snippet": "static int virNetSASLContextOnceInit(void)\n{\n    if (!VIR_CLASS_NEW(virNetSASLContext, virClassForObjectLockable()))\n        return -1;\n\n    if (!VIR_CLASS_NEW(virNetSASLSession, virClassForObjectLockable()))\n        return -1;\n\n    return 0;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virthread.h\"",
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virnetmessage.h\"",
      "#include \"virnetsaslcontext.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_CLASS_NEW",
          "args": [
            "virNetSASLSession",
            "virClassForObjectLockable()"
          ],
          "line": 61
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virClassForObjectLockable",
          "args": [],
          "line": 61
        },
        "resolved": true,
        "details": {
          "function_name": "virClassForObjectLockable",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "116-123",
          "snippet": "virClassPtr\nvirClassForObjectLockable(void)\n{\n    if (virObjectInitialize() < 0)\n        return NULL;\n\n    return virObjectLockableClass;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virClassPtr virObjectLockableClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic virClassPtr virObjectLockableClass;\n\nvirClassPtr\nvirClassForObjectLockable(void)\n{\n    if (virObjectInitialize() < 0)\n        return NULL;\n\n    return virObjectLockableClass;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_CLASS_NEW",
          "args": [
            "virNetSASLContext",
            "virClassForObjectLockable()"
          ],
          "line": 58
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virthread.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virnetmessage.h\"\n#include \"virnetsaslcontext.h\"\n#include <config.h>\n\nstatic int virNetSASLContextOnceInit(void)\n{\n    if (!VIR_CLASS_NEW(virNetSASLContext, virClassForObjectLockable()))\n        return -1;\n\n    if (!VIR_CLASS_NEW(virNetSASLSession, virClassForObjectLockable()))\n        return -1;\n\n    return 0;\n}"
  }
]