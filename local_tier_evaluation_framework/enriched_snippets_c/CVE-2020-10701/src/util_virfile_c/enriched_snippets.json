[
  {
    "function_name": "virFileDataSync",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "4498-4506",
    "snippet": "int\nvirFileDataSync(int fd)\n{\n#if defined(__APPLE__) || defined(WIN32)\n    return g_fsync(fd);\n#else\n    return fdatasync(fd);\n#endif\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fdatasync",
          "args": [
            "fd"
          ],
          "line": 4504
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_fsync",
          "args": [
            "fd"
          ],
          "line": 4502
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_fsync",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "177-185",
          "snippet": "gint\nvir_g_fsync(gint fd)\n{\n#ifdef G_OS_WIN32\n    return _commit(fd);\n#else\n    return fsync(fd);\n#endif\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\ngint\nvir_g_fsync(gint fd)\n{\n#ifdef G_OS_WIN32\n    return _commit(fd);\n#else\n    return fsync(fd);\n#endif\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileDataSync(int fd)\n{\n#if defined(__APPLE__) || defined(WIN32)\n    return g_fsync(fd);\n#else\n    return fdatasync(fd);\n#endif\n}"
  },
  {
    "function_name": "virFileGetXAttr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "4481-4495",
    "snippet": "int\nvirFileGetXAttr(const char *path,\n                const char *name,\n                char **value)\n{\n    int ret;\n\n    if ((ret = virFileGetXAttrQuiet(path, name, value)) < 0) {\n        virReportSystemError(errno,\n                             _(\"Unable to get XATTR %s on %s\"),\n                             name, path);\n    }\n\n    return ret;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"Unable to get XATTR %s on %s\")",
            "name",
            "path"
          ],
          "line": 4489
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to get XATTR %s on %s\""
          ],
          "line": 4490
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virFileGetXAttrQuiet",
          "args": [
            "path",
            "name",
            "value"
          ],
          "line": 4488
        },
        "resolved": true,
        "details": {
          "function_name": "virFileGetXAttrQuiet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "4435-4442",
          "snippet": "int\nvirFileGetXAttrQuiet(const char *path G_GNUC_UNUSED,\n                     const char *name G_GNUC_UNUSED,\n                     char **value G_GNUC_UNUSED)\n{\n    errno = ENOSYS;\n    return -1;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileGetXAttrQuiet(const char *path G_GNUC_UNUSED,\n                     const char *name G_GNUC_UNUSED,\n                     char **value G_GNUC_UNUSED)\n{\n    errno = ENOSYS;\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileGetXAttr(const char *path,\n                const char *name,\n                char **value)\n{\n    int ret;\n\n    if ((ret = virFileGetXAttrQuiet(path, name, value)) < 0) {\n        virReportSystemError(errno,\n                             _(\"Unable to get XATTR %s on %s\"),\n                             name, path);\n    }\n\n    return ret;\n}"
  },
  {
    "function_name": "virFileRemoveXAttr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "4456-4465",
    "snippet": "int\nvirFileRemoveXAttr(const char *path,\n                   const char *name)\n{\n    errno = ENOSYS;\n    virReportSystemError(errno,\n                         _(\"Unable to remove XATTR %s on %s\"),\n                         name, path);\n    return -1;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"Unable to remove XATTR %s on %s\")",
            "name",
            "path"
          ],
          "line": 4461
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to remove XATTR %s on %s\""
          ],
          "line": 4462
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileRemoveXAttr(const char *path,\n                   const char *name)\n{\n    errno = ENOSYS;\n    virReportSystemError(errno,\n                         _(\"Unable to remove XATTR %s on %s\"),\n                         name, path);\n    return -1;\n}"
  },
  {
    "function_name": "virFileSetXAttr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "4444-4454",
    "snippet": "int\nvirFileSetXAttr(const char *path,\n                const char *name,\n                const char *value G_GNUC_UNUSED)\n{\n    errno = ENOSYS;\n    virReportSystemError(errno,\n                         _(\"Unable to set XATTR %s on %s\"),\n                         name, path);\n    return -1;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"Unable to set XATTR %s on %s\")",
            "name",
            "path"
          ],
          "line": 4450
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to set XATTR %s on %s\""
          ],
          "line": 4451
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileSetXAttr(const char *path,\n                const char *name,\n                const char *value G_GNUC_UNUSED)\n{\n    errno = ENOSYS;\n    virReportSystemError(errno,\n                         _(\"Unable to set XATTR %s on %s\"),\n                         name, path);\n    return -1;\n}"
  },
  {
    "function_name": "virFileGetXAttrQuiet",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "4435-4442",
    "snippet": "int\nvirFileGetXAttrQuiet(const char *path G_GNUC_UNUSED,\n                     const char *name G_GNUC_UNUSED,\n                     char **value G_GNUC_UNUSED)\n{\n    errno = ENOSYS;\n    return -1;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileGetXAttrQuiet(const char *path G_GNUC_UNUSED,\n                     const char *name G_GNUC_UNUSED,\n                     char **value G_GNUC_UNUSED)\n{\n    errno = ENOSYS;\n    return -1;\n}"
  },
  {
    "function_name": "virFileRemoveXAttr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "4419-4431",
    "snippet": "int\nvirFileRemoveXAttr(const char *path,\n                   const char *name)\n{\n    if (removexattr(path, name) < 0) {\n        virReportSystemError(errno,\n                             _(\"Unable to remove XATTR %s on %s\"),\n                             name, path);\n        return -1;\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"Unable to remove XATTR %s on %s\")",
            "name",
            "path"
          ],
          "line": 4424
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to remove XATTR %s on %s\""
          ],
          "line": 4425
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "removexattr",
          "args": [
            "path",
            "name"
          ],
          "line": 4423
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileRemoveXAttr(const char *path,\n                   const char *name)\n{\n    if (removexattr(path, name) < 0) {\n        virReportSystemError(errno,\n                             _(\"Unable to remove XATTR %s on %s\"),\n                             name, path);\n        return -1;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virFileSetXAttr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "4394-4407",
    "snippet": "int\nvirFileSetXAttr(const char *path,\n                const char *name,\n                const char *value)\n{\n    if (setxattr(path, name, value, strlen(value), 0) < 0) {\n        virReportSystemError(errno,\n                             _(\"Unable to set XATTR %s on %s\"),\n                             name, path);\n        return -1;\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"Unable to set XATTR %s on %s\")",
            "name",
            "path"
          ],
          "line": 4400
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to set XATTR %s on %s\""
          ],
          "line": 4401
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "setxattr",
          "args": [
            "path",
            "name",
            "value",
            "strlen(value)",
            "0"
          ],
          "line": 4399
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "value"
          ],
          "line": 4399
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileSetXAttr(const char *path,\n                const char *name,\n                const char *value)\n{\n    if (setxattr(path, name, value, strlen(value), 0) < 0) {\n        virReportSystemError(errno,\n                             _(\"Unable to set XATTR %s on %s\"),\n                             name, path);\n        return -1;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virFileGetXAttrQuiet",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "4346-4381",
    "snippet": "int\nvirFileGetXAttrQuiet(const char *path,\n                     const char *name,\n                     char **value)\n{\n    char *buf = NULL;\n    int ret = -1;\n\n    /* We might be racing with somebody who sets the same attribute. */\n    while (1) {\n        ssize_t need;\n        ssize_t got;\n\n        /* The first call determines how many bytes we need to allocate. */\n        if ((need = getxattr(path, name, NULL, 0)) < 0)\n            goto cleanup;\n\n        if (VIR_REALLOC_N_QUIET(buf, need + 1) < 0)\n            goto cleanup;\n\n        if ((got = getxattr(path, name, buf, need)) < 0) {\n            if (errno == ERANGE)\n                continue;\n            goto cleanup;\n        }\n\n        buf[got] = '\\0';\n        break;\n    }\n\n    *value = g_steal_pointer(&buf);\n    ret = 0;\n cleanup:\n    VIR_FREE(buf);\n    return ret;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "buf"
          ],
          "line": 4379
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_steal_pointer",
          "args": [
            "&buf"
          ],
          "line": 4376
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getxattr",
          "args": [
            "path",
            "name",
            "buf",
            "need"
          ],
          "line": 4366
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_REALLOC_N_QUIET",
          "args": [
            "buf",
            "need + 1"
          ],
          "line": 4363
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getxattr",
          "args": [
            "path",
            "name",
            "NULL",
            "0"
          ],
          "line": 4360
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileGetXAttrQuiet(const char *path,\n                     const char *name,\n                     char **value)\n{\n    char *buf = NULL;\n    int ret = -1;\n\n    /* We might be racing with somebody who sets the same attribute. */\n    while (1) {\n        ssize_t need;\n        ssize_t got;\n\n        /* The first call determines how many bytes we need to allocate. */\n        if ((need = getxattr(path, name, NULL, 0)) < 0)\n            goto cleanup;\n\n        if (VIR_REALLOC_N_QUIET(buf, need + 1) < 0)\n            goto cleanup;\n\n        if ((got = getxattr(path, name, buf, need)) < 0) {\n            if (errno == ERANGE)\n                continue;\n            goto cleanup;\n        }\n\n        buf[got] = '\\0';\n        break;\n    }\n\n    *value = g_steal_pointer(&buf);\n    ret = 0;\n cleanup:\n    VIR_FREE(buf);\n    return ret;\n}"
  },
  {
    "function_name": "virFileWaitForExists",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "4314-4330",
    "snippet": "int\nvirFileWaitForExists(const char *path,\n                     size_t ms,\n                     size_t tries)\n{\n    errno = 0;\n\n    /* wait for @path to be accessible in @ms milliseconds, up to @tries */\n    while (tries-- > 0 && !virFileExists(path)) {\n        if (tries == 0 || errno != ENOENT)\n            return -1;\n\n        g_usleep(ms * 1000);\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_usleep",
          "args": [
            "ms * 1000"
          ],
          "line": 4326
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virFileExists",
          "args": [
            "path"
          ],
          "line": 4322
        },
        "resolved": true,
        "details": {
          "function_name": "virFileExists",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1873-1877",
          "snippet": "bool\nvirFileExists(const char *path)\n{\n    return access(path, F_OK) == 0;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nbool\nvirFileExists(const char *path)\n{\n    return access(path, F_OK) == 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileWaitForExists(const char *path,\n                     size_t ms,\n                     size_t tries)\n{\n    errno = 0;\n\n    /* wait for @path to be accessible in @ms milliseconds, up to @tries */\n    while (tries-- > 0 && !virFileExists(path)) {\n        if (tries == 0 || errno != ENOENT)\n            return -1;\n\n        g_usleep(ms * 1000);\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virFileReadValueString",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "4279-4299",
    "snippet": "int\nvirFileReadValueString(char **value, const char *format, ...)\n{\n    int ret;\n    g_autofree char *path = NULL;\n    va_list ap;\n\n    va_start(ap, format);\n    path = g_strdup_vprintf(format, ap);\n    va_end(ap);\n\n    if (!virFileExists(path))\n        return -2;\n\n    ret = virFileReadAll(path, VIR_FILE_READ_VALUE_STRING_MAX, value);\n\n    if (*value)\n        virStringTrimOptionalNewline(*value);\n\n    return ret;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define VIR_FILE_READ_VALUE_STRING_MAX 4096"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virStringTrimOptionalNewline",
          "args": [
            "*value"
          ],
          "line": 4296
        },
        "resolved": true,
        "details": {
          "function_name": "virStringTrimOptionalNewline",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "1338-1347",
          "snippet": "void virStringTrimOptionalNewline(char *str)\n{\n    size_t len = strlen(str);\n\n    if (!len)\n        return;\n\n    if (str[len - 1] == '\\n')\n        str[len - 1] = '\\0';\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nvoid virStringTrimOptionalNewline(char *str)\n{\n    size_t len = strlen(str);\n\n    if (!len)\n        return;\n\n    if (str[len - 1] == '\\n')\n        str[len - 1] = '\\0';\n}"
        }
      },
      {
        "call_info": {
          "callee": "virFileReadAll",
          "args": [
            "path",
            "VIR_FILE_READ_VALUE_STRING_MAX",
            "value"
          ],
          "line": 4293
        },
        "resolved": true,
        "details": {
          "function_name": "virFileReadAllQuiet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1459-1472",
          "snippet": "int\nvirFileReadAllQuiet(const char *path, int maxlen, char **buf)\n{\n    int fd = open(path, O_RDONLY);\n    if (fd < 0)\n        return -errno;\n\n    int len = virFileReadLimFD(fd, maxlen, buf);\n    VIR_FORCE_CLOSE(fd);\n    if (len < 0)\n        return -errno;\n\n    return len;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileReadAllQuiet(const char *path, int maxlen, char **buf)\n{\n    int fd = open(path, O_RDONLY);\n    if (fd < 0)\n        return -errno;\n\n    int len = virFileReadLimFD(fd, maxlen, buf);\n    VIR_FORCE_CLOSE(fd);\n    if (len < 0)\n        return -errno;\n\n    return len;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virFileExists",
          "args": [
            "path"
          ],
          "line": 4290
        },
        "resolved": true,
        "details": {
          "function_name": "virFileExists",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1873-1877",
          "snippet": "bool\nvirFileExists(const char *path)\n{\n    return access(path, F_OK) == 0;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nbool\nvirFileExists(const char *path)\n{\n    return access(path, F_OK) == 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "va_end",
          "args": [
            "ap"
          ],
          "line": 4288
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strdup_vprintf",
          "args": [
            "format",
            "ap"
          ],
          "line": 4287
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_vprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "205-213",
          "snippet": "char *\nvir_g_strdup_vprintf(const char *msg, va_list args)\n{\n    char *ret;\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_vprintf(const char *msg, va_list args)\n{\n    char *ret;\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "va_start",
          "args": [
            "ap",
            "format"
          ],
          "line": 4286
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\n#define VIR_FILE_READ_VALUE_STRING_MAX 4096\n\nint\nvirFileReadValueString(char **value, const char *format, ...)\n{\n    int ret;\n    g_autofree char *path = NULL;\n    va_list ap;\n\n    va_start(ap, format);\n    path = g_strdup_vprintf(format, ap);\n    va_end(ap);\n\n    if (!virFileExists(path))\n        return -2;\n\n    ret = virFileReadAll(path, VIR_FILE_READ_VALUE_STRING_MAX, value);\n\n    if (*value)\n        virStringTrimOptionalNewline(*value);\n\n    return ret;\n}"
  },
  {
    "function_name": "virFileReadValueBitmap",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "4241-4265",
    "snippet": "int\nvirFileReadValueBitmap(virBitmapPtr *value, const char *format, ...)\n{\n    g_autofree char *str = NULL;\n    g_autofree char *path = NULL;\n    va_list ap;\n\n    va_start(ap, format);\n    path = g_strdup_vprintf(format, ap);\n    va_end(ap);\n\n    if (!virFileExists(path))\n        return -2;\n\n    if (virFileReadAll(path, VIR_FILE_READ_VALUE_STRING_MAX, &str) < 0)\n        return -1;\n\n    virStringTrimOptionalNewline(str);\n\n    *value = virBitmapParseUnlimited(str);\n    if (!*value)\n        return -1;\n\n    return 0;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define VIR_FILE_READ_VALUE_STRING_MAX 4096"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virBitmapParseUnlimited",
          "args": [
            "str"
          ],
          "line": 4260
        },
        "resolved": true,
        "details": {
          "function_name": "virBitmapParseUnlimited",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
          "lines": "605-695",
          "snippet": "virBitmapPtr\nvirBitmapParseUnlimited(const char *str)\n{\n    virBitmapPtr bitmap = virBitmapNewEmpty();\n    bool neg = false;\n    const char *cur = str;\n    char *tmp;\n    size_t i;\n    int start, last;\n\n    if (!str)\n        goto error;\n\n    virSkipSpaces(&cur);\n\n    if (*cur == '\\0')\n        goto error;\n\n    while (*cur != 0) {\n        /*\n         * 3 constructs are allowed:\n         *     - N   : a single CPU number\n         *     - N-M : a range of CPU numbers with N < M\n         *     - ^N  : remove a single CPU number from the current set\n         */\n        if (*cur == '^') {\n            cur++;\n            neg = true;\n        }\n\n        if (!g_ascii_isdigit(*cur))\n            goto error;\n\n        if (virStrToLong_i(cur, &tmp, 10, &start) < 0)\n            goto error;\n        if (start < 0)\n            goto error;\n\n        cur = tmp;\n\n        virSkipSpaces(&cur);\n\n        if (*cur == ',' || *cur == 0) {\n            if (neg) {\n                if (virBitmapClearBitExpand(bitmap, start) < 0)\n                    goto error;\n            } else {\n                if (virBitmapSetBitExpand(bitmap, start) < 0)\n                    goto error;\n            }\n        } else if (*cur == '-') {\n            if (neg)\n                goto error;\n\n            cur++;\n            virSkipSpaces(&cur);\n\n            if (virStrToLong_i(cur, &tmp, 10, &last) < 0)\n                goto error;\n            if (last < start)\n                goto error;\n\n            cur = tmp;\n\n            for (i = start; i <= last; i++) {\n                if (virBitmapSetBitExpand(bitmap, i) < 0)\n                    goto error;\n            }\n\n            virSkipSpaces(&cur);\n        }\n\n        if (*cur == ',') {\n            cur++;\n            virSkipSpaces(&cur);\n            neg = false;\n        } else if (*cur == 0) {\n            break;\n        } else {\n            goto error;\n        }\n    }\n\n    return bitmap;\n\n error:\n    virReportError(VIR_ERR_INVALID_ARG,\n                   _(\"Failed to parse bitmap '%s'\"), NULLSTR(str));\n    virBitmapFree(bitmap);\n    return NULL;\n}",
          "includes": [
            "#include \"virerror.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbitmap.h\"",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\nvirBitmapPtr\nvirBitmapParseUnlimited(const char *str)\n{\n    virBitmapPtr bitmap = virBitmapNewEmpty();\n    bool neg = false;\n    const char *cur = str;\n    char *tmp;\n    size_t i;\n    int start, last;\n\n    if (!str)\n        goto error;\n\n    virSkipSpaces(&cur);\n\n    if (*cur == '\\0')\n        goto error;\n\n    while (*cur != 0) {\n        /*\n         * 3 constructs are allowed:\n         *     - N   : a single CPU number\n         *     - N-M : a range of CPU numbers with N < M\n         *     - ^N  : remove a single CPU number from the current set\n         */\n        if (*cur == '^') {\n            cur++;\n            neg = true;\n        }\n\n        if (!g_ascii_isdigit(*cur))\n            goto error;\n\n        if (virStrToLong_i(cur, &tmp, 10, &start) < 0)\n            goto error;\n        if (start < 0)\n            goto error;\n\n        cur = tmp;\n\n        virSkipSpaces(&cur);\n\n        if (*cur == ',' || *cur == 0) {\n            if (neg) {\n                if (virBitmapClearBitExpand(bitmap, start) < 0)\n                    goto error;\n            } else {\n                if (virBitmapSetBitExpand(bitmap, start) < 0)\n                    goto error;\n            }\n        } else if (*cur == '-') {\n            if (neg)\n                goto error;\n\n            cur++;\n            virSkipSpaces(&cur);\n\n            if (virStrToLong_i(cur, &tmp, 10, &last) < 0)\n                goto error;\n            if (last < start)\n                goto error;\n\n            cur = tmp;\n\n            for (i = start; i <= last; i++) {\n                if (virBitmapSetBitExpand(bitmap, i) < 0)\n                    goto error;\n            }\n\n            virSkipSpaces(&cur);\n        }\n\n        if (*cur == ',') {\n            cur++;\n            virSkipSpaces(&cur);\n            neg = false;\n        } else if (*cur == 0) {\n            break;\n        } else {\n            goto error;\n        }\n    }\n\n    return bitmap;\n\n error:\n    virReportError(VIR_ERR_INVALID_ARG,\n                   _(\"Failed to parse bitmap '%s'\"), NULLSTR(str));\n    virBitmapFree(bitmap);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStringTrimOptionalNewline",
          "args": [
            "str"
          ],
          "line": 4258
        },
        "resolved": true,
        "details": {
          "function_name": "virStringTrimOptionalNewline",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "1338-1347",
          "snippet": "void virStringTrimOptionalNewline(char *str)\n{\n    size_t len = strlen(str);\n\n    if (!len)\n        return;\n\n    if (str[len - 1] == '\\n')\n        str[len - 1] = '\\0';\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nvoid virStringTrimOptionalNewline(char *str)\n{\n    size_t len = strlen(str);\n\n    if (!len)\n        return;\n\n    if (str[len - 1] == '\\n')\n        str[len - 1] = '\\0';\n}"
        }
      },
      {
        "call_info": {
          "callee": "virFileReadAll",
          "args": [
            "path",
            "VIR_FILE_READ_VALUE_STRING_MAX",
            "&str"
          ],
          "line": 4255
        },
        "resolved": true,
        "details": {
          "function_name": "virFileReadAllQuiet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1459-1472",
          "snippet": "int\nvirFileReadAllQuiet(const char *path, int maxlen, char **buf)\n{\n    int fd = open(path, O_RDONLY);\n    if (fd < 0)\n        return -errno;\n\n    int len = virFileReadLimFD(fd, maxlen, buf);\n    VIR_FORCE_CLOSE(fd);\n    if (len < 0)\n        return -errno;\n\n    return len;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileReadAllQuiet(const char *path, int maxlen, char **buf)\n{\n    int fd = open(path, O_RDONLY);\n    if (fd < 0)\n        return -errno;\n\n    int len = virFileReadLimFD(fd, maxlen, buf);\n    VIR_FORCE_CLOSE(fd);\n    if (len < 0)\n        return -errno;\n\n    return len;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virFileExists",
          "args": [
            "path"
          ],
          "line": 4252
        },
        "resolved": true,
        "details": {
          "function_name": "virFileExists",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1873-1877",
          "snippet": "bool\nvirFileExists(const char *path)\n{\n    return access(path, F_OK) == 0;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nbool\nvirFileExists(const char *path)\n{\n    return access(path, F_OK) == 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "va_end",
          "args": [
            "ap"
          ],
          "line": 4250
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strdup_vprintf",
          "args": [
            "format",
            "ap"
          ],
          "line": 4249
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_vprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "205-213",
          "snippet": "char *\nvir_g_strdup_vprintf(const char *msg, va_list args)\n{\n    char *ret;\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_vprintf(const char *msg, va_list args)\n{\n    char *ret;\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "va_start",
          "args": [
            "ap",
            "format"
          ],
          "line": 4248
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\n#define VIR_FILE_READ_VALUE_STRING_MAX 4096\n\nint\nvirFileReadValueBitmap(virBitmapPtr *value, const char *format, ...)\n{\n    g_autofree char *str = NULL;\n    g_autofree char *path = NULL;\n    va_list ap;\n\n    va_start(ap, format);\n    path = g_strdup_vprintf(format, ap);\n    va_end(ap);\n\n    if (!virFileExists(path))\n        return -2;\n\n    if (virFileReadAll(path, VIR_FILE_READ_VALUE_STRING_MAX, &str) < 0)\n        return -1;\n\n    virStringTrimOptionalNewline(str);\n\n    *value = virBitmapParseUnlimited(str);\n    if (!*value)\n        return -1;\n\n    return 0;\n}"
  },
  {
    "function_name": "virFileReadValueScaledInt",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "4197-4225",
    "snippet": "int\nvirFileReadValueScaledInt(unsigned long long *value, const char *format, ...)\n{\n    g_autofree char *str = NULL;\n    g_autofree char *path = NULL;\n    char *endp = NULL;\n    va_list ap;\n\n    va_start(ap, format);\n    path = g_strdup_vprintf(format, ap);\n    va_end(ap);\n\n    if (!virFileExists(path))\n        return -2;\n\n    if (virFileReadAll(path, VIR_INT64_STR_BUFLEN, &str) < 0)\n        return -1;\n\n    virStringTrimOptionalNewline(str);\n\n    if (virStrToLong_ullp(str, &endp, 10, value) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Invalid unsigned scaled integer value '%s' in file '%s'\"),\n                       str, path);\n        return -1;\n    }\n\n    return virScaleInteger(value, endp, 1024, ULLONG_MAX);\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virScaleInteger",
          "args": [
            "value",
            "endp",
            "1024",
            "ULLONG_MAX"
          ],
          "line": 4224
        },
        "resolved": true,
        "details": {
          "function_name": "virScaleInteger",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
          "lines": "175-235",
          "snippet": "int\nvirScaleInteger(unsigned long long *value, const char *suffix,\n                unsigned long long scale, unsigned long long limit)\n{\n    if (!suffix || !*suffix) {\n        if (!scale) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"invalid scale %llu\"), scale);\n            return -1;\n        }\n        suffix = \"\";\n    } else if (STRCASEEQ(suffix, \"b\") || STRCASEEQ(suffix, \"byte\") ||\n               STRCASEEQ(suffix, \"bytes\")) {\n        scale = 1;\n    } else {\n        int base;\n\n        if (!suffix[1] || STRCASEEQ(suffix + 1, \"iB\")) {\n            base = 1024;\n        } else if (g_ascii_tolower(suffix[1]) == 'b' && !suffix[2]) {\n            base = 1000;\n        } else {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"unknown suffix '%s'\"), suffix);\n            return -1;\n        }\n        scale = 1;\n        switch (g_ascii_tolower(*suffix)) {\n        case 'e':\n            scale *= base;\n            G_GNUC_FALLTHROUGH;\n        case 'p':\n            scale *= base;\n            G_GNUC_FALLTHROUGH;\n        case 't':\n            scale *= base;\n            G_GNUC_FALLTHROUGH;\n        case 'g':\n            scale *= base;\n            G_GNUC_FALLTHROUGH;\n        case 'm':\n            scale *= base;\n            G_GNUC_FALLTHROUGH;\n        case 'k':\n            scale *= base;\n            break;\n        default:\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"unknown suffix '%s'\"), suffix);\n            return -1;\n        }\n    }\n\n    if (*value && *value > (limit / scale)) {\n        virReportError(VIR_ERR_OVERFLOW, _(\"value too large: %llu%s\"),\n                       *value, suffix);\n        return -1;\n    }\n    *value *= scale;\n    return 0;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <sys/prctl.h>",
            "# include <cap-ng.h>",
            "# include <grp.h>",
            "# include <pwd.h>",
            "# include <libdevmapper.h>",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <conio.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nint\nvirScaleInteger(unsigned long long *value, const char *suffix,\n                unsigned long long scale, unsigned long long limit)\n{\n    if (!suffix || !*suffix) {\n        if (!scale) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"invalid scale %llu\"), scale);\n            return -1;\n        }\n        suffix = \"\";\n    } else if (STRCASEEQ(suffix, \"b\") || STRCASEEQ(suffix, \"byte\") ||\n               STRCASEEQ(suffix, \"bytes\")) {\n        scale = 1;\n    } else {\n        int base;\n\n        if (!suffix[1] || STRCASEEQ(suffix + 1, \"iB\")) {\n            base = 1024;\n        } else if (g_ascii_tolower(suffix[1]) == 'b' && !suffix[2]) {\n            base = 1000;\n        } else {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"unknown suffix '%s'\"), suffix);\n            return -1;\n        }\n        scale = 1;\n        switch (g_ascii_tolower(*suffix)) {\n        case 'e':\n            scale *= base;\n            G_GNUC_FALLTHROUGH;\n        case 'p':\n            scale *= base;\n            G_GNUC_FALLTHROUGH;\n        case 't':\n            scale *= base;\n            G_GNUC_FALLTHROUGH;\n        case 'g':\n            scale *= base;\n            G_GNUC_FALLTHROUGH;\n        case 'm':\n            scale *= base;\n            G_GNUC_FALLTHROUGH;\n        case 'k':\n            scale *= base;\n            break;\n        default:\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"unknown suffix '%s'\"), suffix);\n            return -1;\n        }\n    }\n\n    if (*value && *value > (limit / scale)) {\n        virReportError(VIR_ERR_OVERFLOW, _(\"value too large: %llu%s\"),\n                       *value, suffix);\n        return -1;\n    }\n    *value *= scale;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Invalid unsigned scaled integer value '%s' in file '%s'\")",
            "str",
            "path"
          ],
          "line": 4218
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Invalid unsigned scaled integer value '%s' in file '%s'\""
          ],
          "line": 4219
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStrToLong_ullp",
          "args": [
            "str",
            "&endp",
            "10",
            "value"
          ],
          "line": 4217
        },
        "resolved": true,
        "details": {
          "function_name": "virStrToLong_ullp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "568-586",
          "snippet": "int\nvirStrToLong_ullp(char const *s, char **end_ptr, int base,\n                  unsigned long long *result)\n{\n    unsigned long long val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtoull(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToLong_ullp(char const *s, char **end_ptr, int base,\n                  unsigned long long *result)\n{\n    unsigned long long val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtoull(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStringTrimOptionalNewline",
          "args": [
            "str"
          ],
          "line": 4215
        },
        "resolved": true,
        "details": {
          "function_name": "virStringTrimOptionalNewline",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "1338-1347",
          "snippet": "void virStringTrimOptionalNewline(char *str)\n{\n    size_t len = strlen(str);\n\n    if (!len)\n        return;\n\n    if (str[len - 1] == '\\n')\n        str[len - 1] = '\\0';\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nvoid virStringTrimOptionalNewline(char *str)\n{\n    size_t len = strlen(str);\n\n    if (!len)\n        return;\n\n    if (str[len - 1] == '\\n')\n        str[len - 1] = '\\0';\n}"
        }
      },
      {
        "call_info": {
          "callee": "virFileReadAll",
          "args": [
            "path",
            "VIR_INT64_STR_BUFLEN",
            "&str"
          ],
          "line": 4212
        },
        "resolved": true,
        "details": {
          "function_name": "virFileReadAllQuiet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1459-1472",
          "snippet": "int\nvirFileReadAllQuiet(const char *path, int maxlen, char **buf)\n{\n    int fd = open(path, O_RDONLY);\n    if (fd < 0)\n        return -errno;\n\n    int len = virFileReadLimFD(fd, maxlen, buf);\n    VIR_FORCE_CLOSE(fd);\n    if (len < 0)\n        return -errno;\n\n    return len;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileReadAllQuiet(const char *path, int maxlen, char **buf)\n{\n    int fd = open(path, O_RDONLY);\n    if (fd < 0)\n        return -errno;\n\n    int len = virFileReadLimFD(fd, maxlen, buf);\n    VIR_FORCE_CLOSE(fd);\n    if (len < 0)\n        return -errno;\n\n    return len;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virFileExists",
          "args": [
            "path"
          ],
          "line": 4209
        },
        "resolved": true,
        "details": {
          "function_name": "virFileExists",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1873-1877",
          "snippet": "bool\nvirFileExists(const char *path)\n{\n    return access(path, F_OK) == 0;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nbool\nvirFileExists(const char *path)\n{\n    return access(path, F_OK) == 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "va_end",
          "args": [
            "ap"
          ],
          "line": 4207
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strdup_vprintf",
          "args": [
            "format",
            "ap"
          ],
          "line": 4206
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_vprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "205-213",
          "snippet": "char *\nvir_g_strdup_vprintf(const char *msg, va_list args)\n{\n    char *ret;\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_vprintf(const char *msg, va_list args)\n{\n    char *ret;\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "va_start",
          "args": [
            "ap",
            "format"
          ],
          "line": 4205
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileReadValueScaledInt(unsigned long long *value, const char *format, ...)\n{\n    g_autofree char *str = NULL;\n    g_autofree char *path = NULL;\n    char *endp = NULL;\n    va_list ap;\n\n    va_start(ap, format);\n    path = g_strdup_vprintf(format, ap);\n    va_end(ap);\n\n    if (!virFileExists(path))\n        return -2;\n\n    if (virFileReadAll(path, VIR_INT64_STR_BUFLEN, &str) < 0)\n        return -1;\n\n    virStringTrimOptionalNewline(str);\n\n    if (virStrToLong_ullp(str, &endp, 10, value) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Invalid unsigned scaled integer value '%s' in file '%s'\"),\n                       str, path);\n        return -1;\n    }\n\n    return virScaleInteger(value, endp, 1024, ULLONG_MAX);\n}"
  },
  {
    "function_name": "virFileReadValueUllong",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "4157-4184",
    "snippet": "int\nvirFileReadValueUllong(unsigned long long *value, const char *format, ...)\n{\n    g_autofree char *str = NULL;\n    g_autofree char *path = NULL;\n    va_list ap;\n\n    va_start(ap, format);\n    path = g_strdup_vprintf(format, ap);\n    va_end(ap);\n\n    if (!virFileExists(path))\n        return -2;\n\n    if (virFileReadAll(path, VIR_INT64_STR_BUFLEN, &str) < 0)\n        return -1;\n\n    virStringTrimOptionalNewline(str);\n\n    if (virStrToLong_ullp(str, NULL, 10, value) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Invalid unsigned long long value '%s' in file '%s'\"),\n                       str, path);\n        return -1;\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Invalid unsigned long long value '%s' in file '%s'\")",
            "str",
            "path"
          ],
          "line": 4177
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Invalid unsigned long long value '%s' in file '%s'\""
          ],
          "line": 4178
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStrToLong_ullp",
          "args": [
            "str",
            "NULL",
            "10",
            "value"
          ],
          "line": 4176
        },
        "resolved": true,
        "details": {
          "function_name": "virStrToLong_ullp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "568-586",
          "snippet": "int\nvirStrToLong_ullp(char const *s, char **end_ptr, int base,\n                  unsigned long long *result)\n{\n    unsigned long long val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtoull(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToLong_ullp(char const *s, char **end_ptr, int base,\n                  unsigned long long *result)\n{\n    unsigned long long val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtoull(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStringTrimOptionalNewline",
          "args": [
            "str"
          ],
          "line": 4174
        },
        "resolved": true,
        "details": {
          "function_name": "virStringTrimOptionalNewline",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "1338-1347",
          "snippet": "void virStringTrimOptionalNewline(char *str)\n{\n    size_t len = strlen(str);\n\n    if (!len)\n        return;\n\n    if (str[len - 1] == '\\n')\n        str[len - 1] = '\\0';\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nvoid virStringTrimOptionalNewline(char *str)\n{\n    size_t len = strlen(str);\n\n    if (!len)\n        return;\n\n    if (str[len - 1] == '\\n')\n        str[len - 1] = '\\0';\n}"
        }
      },
      {
        "call_info": {
          "callee": "virFileReadAll",
          "args": [
            "path",
            "VIR_INT64_STR_BUFLEN",
            "&str"
          ],
          "line": 4171
        },
        "resolved": true,
        "details": {
          "function_name": "virFileReadAllQuiet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1459-1472",
          "snippet": "int\nvirFileReadAllQuiet(const char *path, int maxlen, char **buf)\n{\n    int fd = open(path, O_RDONLY);\n    if (fd < 0)\n        return -errno;\n\n    int len = virFileReadLimFD(fd, maxlen, buf);\n    VIR_FORCE_CLOSE(fd);\n    if (len < 0)\n        return -errno;\n\n    return len;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileReadAllQuiet(const char *path, int maxlen, char **buf)\n{\n    int fd = open(path, O_RDONLY);\n    if (fd < 0)\n        return -errno;\n\n    int len = virFileReadLimFD(fd, maxlen, buf);\n    VIR_FORCE_CLOSE(fd);\n    if (len < 0)\n        return -errno;\n\n    return len;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virFileExists",
          "args": [
            "path"
          ],
          "line": 4168
        },
        "resolved": true,
        "details": {
          "function_name": "virFileExists",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1873-1877",
          "snippet": "bool\nvirFileExists(const char *path)\n{\n    return access(path, F_OK) == 0;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nbool\nvirFileExists(const char *path)\n{\n    return access(path, F_OK) == 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "va_end",
          "args": [
            "ap"
          ],
          "line": 4166
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strdup_vprintf",
          "args": [
            "format",
            "ap"
          ],
          "line": 4165
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_vprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "205-213",
          "snippet": "char *\nvir_g_strdup_vprintf(const char *msg, va_list args)\n{\n    char *ret;\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_vprintf(const char *msg, va_list args)\n{\n    char *ret;\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "va_start",
          "args": [
            "ap",
            "format"
          ],
          "line": 4164
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileReadValueUllong(unsigned long long *value, const char *format, ...)\n{\n    g_autofree char *str = NULL;\n    g_autofree char *path = NULL;\n    va_list ap;\n\n    va_start(ap, format);\n    path = g_strdup_vprintf(format, ap);\n    va_end(ap);\n\n    if (!virFileExists(path))\n        return -2;\n\n    if (virFileReadAll(path, VIR_INT64_STR_BUFLEN, &str) < 0)\n        return -1;\n\n    virStringTrimOptionalNewline(str);\n\n    if (virStrToLong_ullp(str, NULL, 10, value) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Invalid unsigned long long value '%s' in file '%s'\"),\n                       str, path);\n        return -1;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virFileReadValueUint",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "4117-4144",
    "snippet": "int\nvirFileReadValueUint(unsigned int *value, const char *format, ...)\n{\n    g_autofree char *str = NULL;\n    g_autofree char *path = NULL;\n    va_list ap;\n\n    va_start(ap, format);\n    path = g_strdup_vprintf(format, ap);\n    va_end(ap);\n\n    if (!virFileExists(path))\n        return -2;\n\n    if (virFileReadAll(path, VIR_INT64_STR_BUFLEN, &str) < 0)\n        return -1;\n\n    virStringTrimOptionalNewline(str);\n\n    if (virStrToLong_uip(str, NULL, 10, value) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Invalid unsigned integer value '%s' in file '%s'\"),\n                       str, path);\n        return -1;\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Invalid unsigned integer value '%s' in file '%s'\")",
            "str",
            "path"
          ],
          "line": 4137
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Invalid unsigned integer value '%s' in file '%s'\""
          ],
          "line": 4138
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStrToLong_uip",
          "args": [
            "str",
            "NULL",
            "10",
            "value"
          ],
          "line": 4136
        },
        "resolved": true,
        "details": {
          "function_name": "virStrToLong_uip",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "444-461",
          "snippet": "int\nvirStrToLong_uip(char const *s, char **end_ptr, int base, unsigned int *result)\n{\n    unsigned long int val;\n    char *p;\n    bool err = false;\n\n    errno = 0;\n    val = strtoul(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s || (unsigned int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToLong_uip(char const *s, char **end_ptr, int base, unsigned int *result)\n{\n    unsigned long int val;\n    char *p;\n    bool err = false;\n\n    errno = 0;\n    val = strtoul(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s || (unsigned int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStringTrimOptionalNewline",
          "args": [
            "str"
          ],
          "line": 4134
        },
        "resolved": true,
        "details": {
          "function_name": "virStringTrimOptionalNewline",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "1338-1347",
          "snippet": "void virStringTrimOptionalNewline(char *str)\n{\n    size_t len = strlen(str);\n\n    if (!len)\n        return;\n\n    if (str[len - 1] == '\\n')\n        str[len - 1] = '\\0';\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nvoid virStringTrimOptionalNewline(char *str)\n{\n    size_t len = strlen(str);\n\n    if (!len)\n        return;\n\n    if (str[len - 1] == '\\n')\n        str[len - 1] = '\\0';\n}"
        }
      },
      {
        "call_info": {
          "callee": "virFileReadAll",
          "args": [
            "path",
            "VIR_INT64_STR_BUFLEN",
            "&str"
          ],
          "line": 4131
        },
        "resolved": true,
        "details": {
          "function_name": "virFileReadAllQuiet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1459-1472",
          "snippet": "int\nvirFileReadAllQuiet(const char *path, int maxlen, char **buf)\n{\n    int fd = open(path, O_RDONLY);\n    if (fd < 0)\n        return -errno;\n\n    int len = virFileReadLimFD(fd, maxlen, buf);\n    VIR_FORCE_CLOSE(fd);\n    if (len < 0)\n        return -errno;\n\n    return len;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileReadAllQuiet(const char *path, int maxlen, char **buf)\n{\n    int fd = open(path, O_RDONLY);\n    if (fd < 0)\n        return -errno;\n\n    int len = virFileReadLimFD(fd, maxlen, buf);\n    VIR_FORCE_CLOSE(fd);\n    if (len < 0)\n        return -errno;\n\n    return len;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virFileExists",
          "args": [
            "path"
          ],
          "line": 4128
        },
        "resolved": true,
        "details": {
          "function_name": "virFileExists",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1873-1877",
          "snippet": "bool\nvirFileExists(const char *path)\n{\n    return access(path, F_OK) == 0;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nbool\nvirFileExists(const char *path)\n{\n    return access(path, F_OK) == 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "va_end",
          "args": [
            "ap"
          ],
          "line": 4126
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strdup_vprintf",
          "args": [
            "format",
            "ap"
          ],
          "line": 4125
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_vprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "205-213",
          "snippet": "char *\nvir_g_strdup_vprintf(const char *msg, va_list args)\n{\n    char *ret;\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_vprintf(const char *msg, va_list args)\n{\n    char *ret;\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "va_start",
          "args": [
            "ap",
            "format"
          ],
          "line": 4124
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileReadValueUint(unsigned int *value, const char *format, ...)\n{\n    g_autofree char *str = NULL;\n    g_autofree char *path = NULL;\n    va_list ap;\n\n    va_start(ap, format);\n    path = g_strdup_vprintf(format, ap);\n    va_end(ap);\n\n    if (!virFileExists(path))\n        return -2;\n\n    if (virFileReadAll(path, VIR_INT64_STR_BUFLEN, &str) < 0)\n        return -1;\n\n    virStringTrimOptionalNewline(str);\n\n    if (virStrToLong_uip(str, NULL, 10, value) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Invalid unsigned integer value '%s' in file '%s'\"),\n                       str, path);\n        return -1;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virFileReadValueInt",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "4077-4104",
    "snippet": "int\nvirFileReadValueInt(int *value, const char *format, ...)\n{\n    g_autofree char *str = NULL;\n    g_autofree char *path = NULL;\n    va_list ap;\n\n    va_start(ap, format);\n    path = g_strdup_vprintf(format, ap);\n    va_end(ap);\n\n    if (!virFileExists(path))\n        return -2;\n\n    if (virFileReadAll(path, VIR_INT64_STR_BUFLEN, &str) < 0)\n        return -1;\n\n    virStringTrimOptionalNewline(str);\n\n    if (virStrToLong_i(str, NULL, 10, value) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Invalid integer value '%s' in file '%s'\"),\n                       str, path);\n        return -1;\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Invalid integer value '%s' in file '%s'\")",
            "str",
            "path"
          ],
          "line": 4097
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Invalid integer value '%s' in file '%s'\""
          ],
          "line": 4098
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStrToLong_i",
          "args": [
            "str",
            "NULL",
            "10",
            "value"
          ],
          "line": 4096
        },
        "resolved": true,
        "details": {
          "function_name": "virStrToLong_i",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "391-407",
          "snippet": "int\nvirStrToLong_i(char const *s, char **end_ptr, int base, int *result)\n{\n    long int val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtol(s, &p, base); /* exempt from syntax-check */\n    err = (errno || (!end_ptr && *p) || p == s || (int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToLong_i(char const *s, char **end_ptr, int base, int *result)\n{\n    long int val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtol(s, &p, base); /* exempt from syntax-check */\n    err = (errno || (!end_ptr && *p) || p == s || (int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStringTrimOptionalNewline",
          "args": [
            "str"
          ],
          "line": 4094
        },
        "resolved": true,
        "details": {
          "function_name": "virStringTrimOptionalNewline",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "1338-1347",
          "snippet": "void virStringTrimOptionalNewline(char *str)\n{\n    size_t len = strlen(str);\n\n    if (!len)\n        return;\n\n    if (str[len - 1] == '\\n')\n        str[len - 1] = '\\0';\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nvoid virStringTrimOptionalNewline(char *str)\n{\n    size_t len = strlen(str);\n\n    if (!len)\n        return;\n\n    if (str[len - 1] == '\\n')\n        str[len - 1] = '\\0';\n}"
        }
      },
      {
        "call_info": {
          "callee": "virFileReadAll",
          "args": [
            "path",
            "VIR_INT64_STR_BUFLEN",
            "&str"
          ],
          "line": 4091
        },
        "resolved": true,
        "details": {
          "function_name": "virFileReadAllQuiet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1459-1472",
          "snippet": "int\nvirFileReadAllQuiet(const char *path, int maxlen, char **buf)\n{\n    int fd = open(path, O_RDONLY);\n    if (fd < 0)\n        return -errno;\n\n    int len = virFileReadLimFD(fd, maxlen, buf);\n    VIR_FORCE_CLOSE(fd);\n    if (len < 0)\n        return -errno;\n\n    return len;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileReadAllQuiet(const char *path, int maxlen, char **buf)\n{\n    int fd = open(path, O_RDONLY);\n    if (fd < 0)\n        return -errno;\n\n    int len = virFileReadLimFD(fd, maxlen, buf);\n    VIR_FORCE_CLOSE(fd);\n    if (len < 0)\n        return -errno;\n\n    return len;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virFileExists",
          "args": [
            "path"
          ],
          "line": 4088
        },
        "resolved": true,
        "details": {
          "function_name": "virFileExists",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1873-1877",
          "snippet": "bool\nvirFileExists(const char *path)\n{\n    return access(path, F_OK) == 0;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nbool\nvirFileExists(const char *path)\n{\n    return access(path, F_OK) == 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "va_end",
          "args": [
            "ap"
          ],
          "line": 4086
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strdup_vprintf",
          "args": [
            "format",
            "ap"
          ],
          "line": 4085
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_vprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "205-213",
          "snippet": "char *\nvir_g_strdup_vprintf(const char *msg, va_list args)\n{\n    char *ret;\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_vprintf(const char *msg, va_list args)\n{\n    char *ret;\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "va_start",
          "args": [
            "ap",
            "format"
          ],
          "line": 4084
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileReadValueInt(int *value, const char *format, ...)\n{\n    g_autofree char *str = NULL;\n    g_autofree char *path = NULL;\n    va_list ap;\n\n    va_start(ap, format);\n    path = g_strdup_vprintf(format, ap);\n    va_end(ap);\n\n    if (!virFileExists(path))\n        return -2;\n\n    if (virFileReadAll(path, VIR_INT64_STR_BUFLEN, &str) < 0)\n        return -1;\n\n    virStringTrimOptionalNewline(str);\n\n    if (virStrToLong_i(str, NULL, 10, value) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Invalid integer value '%s' in file '%s'\"),\n                       str, path);\n        return -1;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virFileInData",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "4053-4062",
    "snippet": "int\nvirFileInData(int fd G_GNUC_UNUSED,\n              int *inData G_GNUC_UNUSED,\n              long long *length G_GNUC_UNUSED)\n{\n    errno = ENOSYS;\n    virReportSystemError(errno, \"%s\",\n                         _(\"sparse files not supported\"));\n    return -1;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "\"%s\"",
            "_(\"sparse files not supported\")"
          ],
          "line": 4059
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"sparse files not supported\""
          ],
          "line": 4060
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileInData(int fd G_GNUC_UNUSED,\n              int *inData G_GNUC_UNUSED,\n              long long *length G_GNUC_UNUSED)\n{\n    errno = ENOSYS;\n    virReportSystemError(errno, \"%s\",\n                         _(\"sparse files not supported\"));\n    return -1;\n}"
  },
  {
    "function_name": "virFileInData",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "3960-4049",
    "snippet": "int\nvirFileInData(int fd,\n              int *inData,\n              long long *length)\n{\n    int ret = -1;\n    off_t cur, data, hole, end;\n\n    /* Get current position */\n    cur = lseek(fd, 0, SEEK_CUR);\n    if (cur == (off_t) -1) {\n        virReportSystemError(errno, \"%s\",\n                             _(\"Unable to get current position in file\"));\n        goto cleanup;\n    }\n\n    /* Now try to get data and hole offsets */\n    data = lseek(fd, cur, SEEK_DATA);\n\n    /* There are four options:\n     * 1) data == cur;  @cur is in data\n     * 2) data > cur; @cur is in a hole, next data at @data\n     * 3) data < 0, errno = ENXIO; either @cur is in trailing hole, or @cur is beyond EOF.\n     * 4) data < 0, errno != ENXIO; we learned nothing\n     */\n\n    if (data == (off_t) -1) {\n        /* cases 3 and 4 */\n        if (errno != ENXIO) {\n            virReportSystemError(errno, \"%s\",\n                                 _(\"Unable to seek to data\"));\n            goto cleanup;\n        }\n\n        *inData = 0;\n        /* There are two situations now. There is always an\n         * implicit hole at EOF. However, there might be a\n         * trailing hole just before EOF too. If that's the case\n         * report it. */\n        if ((end = lseek(fd, 0, SEEK_END)) == (off_t) -1) {\n            virReportSystemError(errno, \"%s\",\n                                 _(\"Unable to seek to EOF\"));\n            goto cleanup;\n        }\n        *length = end - cur;\n    } else if (data > cur) {\n        /* case 2 */\n        *inData = 0;\n        *length = data - cur;\n    } else {\n        /* case 1 */\n        *inData = 1;\n\n        /* We don't know where does the next hole start. Let's\n         * find out. Here we get the same 4 possibilities as\n         * described above.*/\n        hole = lseek(fd, data, SEEK_HOLE);\n        if (hole == (off_t) -1 || hole == data) {\n            /* cases 1, 3 and 4 */\n            /* Wait a second. The reason why we are here is\n             * because we are in data. But at the same time we\n             * are in a trailing hole? Wut!? Do the best what we\n             * can do here. */\n            virReportSystemError(errno, \"%s\",\n                                 _(\"unable to seek to hole\"));\n            goto cleanup;\n        } else {\n            /* case 2 */\n            *length = (hole - data);\n        }\n    }\n\n    ret = 0;\n cleanup:\n    /* At any rate, reposition back to where we started. */\n    if (cur != (off_t) -1) {\n        int theerrno = errno;\n\n        if (lseek(fd, cur, SEEK_SET) == (off_t) -1) {\n            virReportSystemError(errno, \"%s\",\n                                 _(\"unable to restore position in file\"));\n            ret = -1;\n            if (theerrno == 0)\n                theerrno = errno;\n        }\n\n        errno = theerrno;\n    }\n    return ret;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "\"%s\"",
            "_(\"unable to restore position in file\")"
          ],
          "line": 4039
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"unable to restore position in file\""
          ],
          "line": 4040
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "lseek",
          "args": [
            "fd",
            "cur",
            "SEEK_SET"
          ],
          "line": 4038
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "\"%s\"",
            "_(\"unable to seek to hole\")"
          ],
          "line": 4023
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lseek",
          "args": [
            "fd",
            "data",
            "SEEK_HOLE"
          ],
          "line": 4016
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "\"%s\"",
            "_(\"Unable to seek to EOF\")"
          ],
          "line": 4000
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lseek",
          "args": [
            "fd",
            "0",
            "SEEK_END"
          ],
          "line": 3999
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "\"%s\"",
            "_(\"Unable to seek to data\")"
          ],
          "line": 3989
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lseek",
          "args": [
            "fd",
            "cur",
            "SEEK_DATA"
          ],
          "line": 3977
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "\"%s\"",
            "_(\"Unable to get current position in file\")"
          ],
          "line": 3971
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lseek",
          "args": [
            "fd",
            "0",
            "SEEK_CUR"
          ],
          "line": 3969
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileInData(int fd,\n              int *inData,\n              long long *length)\n{\n    int ret = -1;\n    off_t cur, data, hole, end;\n\n    /* Get current position */\n    cur = lseek(fd, 0, SEEK_CUR);\n    if (cur == (off_t) -1) {\n        virReportSystemError(errno, \"%s\",\n                             _(\"Unable to get current position in file\"));\n        goto cleanup;\n    }\n\n    /* Now try to get data and hole offsets */\n    data = lseek(fd, cur, SEEK_DATA);\n\n    /* There are four options:\n     * 1) data == cur;  @cur is in data\n     * 2) data > cur; @cur is in a hole, next data at @data\n     * 3) data < 0, errno = ENXIO; either @cur is in trailing hole, or @cur is beyond EOF.\n     * 4) data < 0, errno != ENXIO; we learned nothing\n     */\n\n    if (data == (off_t) -1) {\n        /* cases 3 and 4 */\n        if (errno != ENXIO) {\n            virReportSystemError(errno, \"%s\",\n                                 _(\"Unable to seek to data\"));\n            goto cleanup;\n        }\n\n        *inData = 0;\n        /* There are two situations now. There is always an\n         * implicit hole at EOF. However, there might be a\n         * trailing hole just before EOF too. If that's the case\n         * report it. */\n        if ((end = lseek(fd, 0, SEEK_END)) == (off_t) -1) {\n            virReportSystemError(errno, \"%s\",\n                                 _(\"Unable to seek to EOF\"));\n            goto cleanup;\n        }\n        *length = end - cur;\n    } else if (data > cur) {\n        /* case 2 */\n        *inData = 0;\n        *length = data - cur;\n    } else {\n        /* case 1 */\n        *inData = 1;\n\n        /* We don't know where does the next hole start. Let's\n         * find out. Here we get the same 4 possibilities as\n         * described above.*/\n        hole = lseek(fd, data, SEEK_HOLE);\n        if (hole == (off_t) -1 || hole == data) {\n            /* cases 1, 3 and 4 */\n            /* Wait a second. The reason why we are here is\n             * because we are in data. But at the same time we\n             * are in a trailing hole? Wut!? Do the best what we\n             * can do here. */\n            virReportSystemError(errno, \"%s\",\n                                 _(\"unable to seek to hole\"));\n            goto cleanup;\n        } else {\n            /* case 2 */\n            *length = (hole - data);\n        }\n    }\n\n    ret = 0;\n cleanup:\n    /* At any rate, reposition back to where we started. */\n    if (cur != (off_t) -1) {\n        int theerrno = errno;\n\n        if (lseek(fd, cur, SEEK_SET) == (off_t) -1) {\n            virReportSystemError(errno, \"%s\",\n                                 _(\"unable to restore position in file\"));\n            ret = -1;\n            if (theerrno == 0)\n                theerrno = errno;\n        }\n\n        errno = theerrno;\n    }\n    return ret;\n}"
  },
  {
    "function_name": "virFileComparePaths",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "3910-3930",
    "snippet": "int\nvirFileComparePaths(const char *p1, const char *p2)\n{\n    g_autofree char *res1 = NULL;\n    g_autofree char *res2 = NULL;\n\n    /* Assume p1 and p2 are symlinks, so try to resolve and canonicalize them.\n     * Canonicalization fails for example on file systems names like 'proc' or\n     * 'sysfs', since they're no real paths so fallback to plain string\n     * comparison.\n     */\n    ignore_value(virFileResolveLink(p1, &res1));\n    if (!res1)\n        res1 = g_strdup(p1);\n\n    ignore_value(virFileResolveLink(p2, &res2));\n    if (!res2)\n        res2 = g_strdup(p2);\n\n    return STREQ_NULLABLE(res1, res2);\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "STREQ_NULLABLE",
          "args": [
            "res1",
            "res2"
          ],
          "line": 3929
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "p2"
          ],
          "line": 3927
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ignore_value",
          "args": [
            "virFileResolveLink(p2, &res2)"
          ],
          "line": 3925
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virFileResolveLink",
          "args": [
            "p2",
            "&res2"
          ],
          "line": 3925
        },
        "resolved": true,
        "details": {
          "function_name": "virFileResolveLink",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1608-1612",
          "snippet": "int\nvirFileResolveLink(const char *linkpath, char **resultpath)\n{\n    return virFileResolveLinkHelper(linkpath, false, resultpath);\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileResolveLink(const char *linkpath, char **resultpath)\n{\n    return virFileResolveLinkHelper(linkpath, false, resultpath);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ignore_value",
          "args": [
            "virFileResolveLink(p1, &res1)"
          ],
          "line": 3921
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileComparePaths(const char *p1, const char *p2)\n{\n    g_autofree char *res1 = NULL;\n    g_autofree char *res2 = NULL;\n\n    /* Assume p1 and p2 are symlinks, so try to resolve and canonicalize them.\n     * Canonicalization fails for example on file systems names like 'proc' or\n     * 'sysfs', since they're no real paths so fallback to plain string\n     * comparison.\n     */\n    ignore_value(virFileResolveLink(p1, &res1));\n    if (!res1)\n        res1 = g_strdup(p1);\n\n    ignore_value(virFileResolveLink(p2, &res2));\n    if (!res2)\n        res2 = g_strdup(p2);\n\n    return STREQ_NULLABLE(res1, res2);\n}"
  },
  {
    "function_name": "virFileCopyACLs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "3876-3893",
    "snippet": "int\nvirFileCopyACLs(const char *src,\n                const char *dst)\n{\n    void *acl = NULL;\n    int ret = -1;\n\n    if (virFileGetACLs(src, &acl) < 0)\n        return ret;\n\n    if (virFileSetACLs(dst, acl) < 0)\n        goto cleanup;\n\n    ret = 0;\n cleanup:\n    virFileFreeACLs(&acl);\n    return ret;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virFileFreeACLs",
          "args": [
            "&acl"
          ],
          "line": 3891
        },
        "resolved": true,
        "details": {
          "function_name": "virFileFreeACLs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "3868-3872",
          "snippet": "void\nvirFileFreeACLs(void **acl)\n{\n    *acl = NULL;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nvoid\nvirFileFreeACLs(void **acl)\n{\n    *acl = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virFileSetACLs",
          "args": [
            "dst",
            "acl"
          ],
          "line": 3886
        },
        "resolved": true,
        "details": {
          "function_name": "virFileSetACLs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "3859-3865",
          "snippet": "int\nvirFileSetACLs(const char *file G_GNUC_UNUSED,\n               void *acl G_GNUC_UNUSED)\n{\n    errno = ENOTSUP;\n    return -1;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileSetACLs(const char *file G_GNUC_UNUSED,\n               void *acl G_GNUC_UNUSED)\n{\n    errno = ENOTSUP;\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virFileGetACLs",
          "args": [
            "src",
            "&acl"
          ],
          "line": 3883
        },
        "resolved": true,
        "details": {
          "function_name": "virFileGetACLs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "3850-3856",
          "snippet": "int\nvirFileGetACLs(const char *file G_GNUC_UNUSED,\n               void **acl G_GNUC_UNUSED)\n{\n    errno = ENOTSUP;\n    return -1;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileGetACLs(const char *file G_GNUC_UNUSED,\n               void **acl G_GNUC_UNUSED)\n{\n    errno = ENOTSUP;\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileCopyACLs(const char *src,\n                const char *dst)\n{\n    void *acl = NULL;\n    int ret = -1;\n\n    if (virFileGetACLs(src, &acl) < 0)\n        return ret;\n\n    if (virFileSetACLs(dst, acl) < 0)\n        goto cleanup;\n\n    ret = 0;\n cleanup:\n    virFileFreeACLs(&acl);\n    return ret;\n}"
  },
  {
    "function_name": "virFileFreeACLs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "3868-3872",
    "snippet": "void\nvirFileFreeACLs(void **acl)\n{\n    *acl = NULL;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nvoid\nvirFileFreeACLs(void **acl)\n{\n    *acl = NULL;\n}"
  },
  {
    "function_name": "virFileSetACLs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "3859-3865",
    "snippet": "int\nvirFileSetACLs(const char *file G_GNUC_UNUSED,\n               void *acl G_GNUC_UNUSED)\n{\n    errno = ENOTSUP;\n    return -1;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileSetACLs(const char *file G_GNUC_UNUSED,\n               void *acl G_GNUC_UNUSED)\n{\n    errno = ENOTSUP;\n    return -1;\n}"
  },
  {
    "function_name": "virFileGetACLs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "3850-3856",
    "snippet": "int\nvirFileGetACLs(const char *file G_GNUC_UNUSED,\n               void **acl G_GNUC_UNUSED)\n{\n    errno = ENOTSUP;\n    return -1;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileGetACLs(const char *file G_GNUC_UNUSED,\n               void **acl G_GNUC_UNUSED)\n{\n    errno = ENOTSUP;\n    return -1;\n}"
  },
  {
    "function_name": "virFileFreeACLs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "3841-3846",
    "snippet": "void\nvirFileFreeACLs(void **acl)\n{\n    acl_free(*acl);\n    *acl = NULL;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "acl_free",
          "args": [
            "*acl"
          ],
          "line": 3844
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nvoid\nvirFileFreeACLs(void **acl)\n{\n    acl_free(*acl);\n    *acl = NULL;\n}"
  },
  {
    "function_name": "virFileSetACLs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "3830-3838",
    "snippet": "int\nvirFileSetACLs(const char *file,\n               void *acl)\n{\n    if (acl_set_file(file, ACL_TYPE_ACCESS, acl) < 0)\n        return -1;\n\n    return 0;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "acl_set_file",
          "args": [
            "file",
            "ACL_TYPE_ACCESS",
            "acl"
          ],
          "line": 3834
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileSetACLs(const char *file,\n               void *acl)\n{\n    if (acl_set_file(file, ACL_TYPE_ACCESS, acl) < 0)\n        return -1;\n\n    return 0;\n}"
  },
  {
    "function_name": "virFileGetACLs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "3819-3827",
    "snippet": "int\nvirFileGetACLs(const char *file,\n               void **acl)\n{\n    if (!(*acl = acl_get_file(file, ACL_TYPE_ACCESS)))\n        return -1;\n\n    return 0;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "acl_get_file",
          "args": [
            "file",
            "ACL_TYPE_ACCESS"
          ],
          "line": 3823
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileGetACLs(const char *file,\n               void **acl)\n{\n    if (!(*acl = acl_get_file(file, ACL_TYPE_ACCESS)))\n        return -1;\n\n    return 0;\n}"
  },
  {
    "function_name": "virFileMoveMount",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "3807-3814",
    "snippet": "int\nvirFileMoveMount(const char *src G_GNUC_UNUSED,\n                 const char *dst G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"mount move is not supported on this platform.\"));\n    return -1;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "\"%s\"",
            "_(\"mount move is not supported on this platform.\")"
          ],
          "line": 3811
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"mount move is not supported on this platform.\""
          ],
          "line": 3812
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileMoveMount(const char *src G_GNUC_UNUSED,\n                 const char *dst G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"mount move is not supported on this platform.\"));\n    return -1;\n}"
  },
  {
    "function_name": "virFileBindMountDevice",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "3797-3804",
    "snippet": "int\nvirFileBindMountDevice(const char *src G_GNUC_UNUSED,\n                       const char *dst G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"mount is not supported on this platform.\"));\n    return -1;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "\"%s\"",
            "_(\"mount is not supported on this platform.\")"
          ],
          "line": 3801
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"mount is not supported on this platform.\""
          ],
          "line": 3802
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileBindMountDevice(const char *src G_GNUC_UNUSED,\n                       const char *dst G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"mount is not supported on this platform.\"));\n    return -1;\n}"
  },
  {
    "function_name": "virFileSetupDev",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "3787-3794",
    "snippet": "int\nvirFileSetupDev(const char *path G_GNUC_UNUSED,\n                const char *mount_options G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"mount is not supported on this platform.\"));\n    return -1;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "\"%s\"",
            "_(\"mount is not supported on this platform.\")"
          ],
          "line": 3791
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"mount is not supported on this platform.\""
          ],
          "line": 3792
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileSetupDev(const char *path G_GNUC_UNUSED,\n                const char *mount_options G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"mount is not supported on this platform.\"));\n    return -1;\n}"
  },
  {
    "function_name": "virFileMoveMount",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "3768-3782",
    "snippet": "int\nvirFileMoveMount(const char *src,\n                 const char *dst)\n{\n    const unsigned long mount_flags = MS_MOVE;\n\n    if (mount(src, dst, \"none\", mount_flags, NULL) < 0) {\n        virReportSystemError(errno,\n                             _(\"Unable to move %s mount to %s\"),\n                             src, dst);\n        return -1;\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"Unable to move %s mount to %s\")",
            "src",
            "dst"
          ],
          "line": 3775
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to move %s mount to %s\""
          ],
          "line": 3776
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "mount",
          "args": [
            "src",
            "dst",
            "\"none\"",
            "mount_flags",
            "NULL"
          ],
          "line": 3774
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileMoveMount(const char *src,\n                 const char *dst)\n{\n    const unsigned long mount_flags = MS_MOVE;\n\n    if (mount(src, dst, \"none\", mount_flags, NULL) < 0) {\n        virReportSystemError(errno,\n                             _(\"Unable to move %s mount to %s\"),\n                             src, dst);\n        return -1;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virFileBindMountDevice",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "3742-3765",
    "snippet": "int\nvirFileBindMountDevice(const char *src,\n                       const char *dst)\n{\n    if (!virFileExists(dst)) {\n        if (virFileIsDir(src)) {\n            if (virFileMakePath(dst) < 0) {\n                virReportSystemError(errno, _(\"Unable to make dir %s\"), dst);\n                return -1;\n            }\n        } else {\n            if (virFileTouch(dst, 0666) < 0)\n                return -1;\n        }\n    }\n\n    if (mount(src, dst, \"none\", MS_BIND, NULL) < 0) {\n        virReportSystemError(errno, _(\"Failed to bind %s on to %s\"), src,\n                             dst);\n        return -1;\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"Failed to bind %s on to %s\")",
            "src",
            "dst"
          ],
          "line": 3759
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Failed to bind %s on to %s\""
          ],
          "line": 3759
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "mount",
          "args": [
            "src",
            "dst",
            "\"none\"",
            "MS_BIND",
            "NULL"
          ],
          "line": 3758
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virFileTouch",
          "args": [
            "dst",
            "0666"
          ],
          "line": 3753
        },
        "resolved": true,
        "details": {
          "function_name": "virFileTouch",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "591-609",
          "snippet": "int virFileTouch(const char *path, mode_t mode)\n{\n    int fd = -1;\n\n    if ((fd = open(path, O_WRONLY | O_CREAT, mode)) < 0) {\n        virReportSystemError(errno, _(\"cannot create file '%s'\"),\n                             path);\n        return -1;\n    }\n\n    if (VIR_CLOSE(fd) < 0) {\n        virReportSystemError(errno, _(\"cannot save file '%s'\"),\n                             path);\n        VIR_FORCE_CLOSE(fd);\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint virFileTouch(const char *path, mode_t mode)\n{\n    int fd = -1;\n\n    if ((fd = open(path, O_WRONLY | O_CREAT, mode)) < 0) {\n        virReportSystemError(errno, _(\"cannot create file '%s'\"),\n                             path);\n        return -1;\n    }\n\n    if (VIR_CLOSE(fd) < 0) {\n        virReportSystemError(errno, _(\"cannot save file '%s'\"),\n                             path);\n        VIR_FORCE_CLOSE(fd);\n        return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"Unable to make dir %s\")",
            "dst"
          ],
          "line": 3749
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virFileMakePath",
          "args": [
            "dst"
          ],
          "line": 3748
        },
        "resolved": true,
        "details": {
          "function_name": "virFileMakePath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "3076-3080",
          "snippet": "int\nvirFileMakePath(const char *path)\n{\n    return virFileMakePathWithMode(path, 0777);\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileMakePath(const char *path)\n{\n    return virFileMakePathWithMode(path, 0777);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virFileIsDir",
          "args": [
            "src"
          ],
          "line": 3747
        },
        "resolved": true,
        "details": {
          "function_name": "virFileIsDir",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1850-1855",
          "snippet": "bool\nvirFileIsDir(const char *path)\n{\n    struct stat s;\n    return (stat(path, &s) == 0) && S_ISDIR(s.st_mode);\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nbool\nvirFileIsDir(const char *path)\n{\n    struct stat s;\n    return (stat(path, &s) == 0) && S_ISDIR(s.st_mode);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virFileExists",
          "args": [
            "dst"
          ],
          "line": 3746
        },
        "resolved": true,
        "details": {
          "function_name": "virFileExists",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1873-1877",
          "snippet": "bool\nvirFileExists(const char *path)\n{\n    return access(path, F_OK) == 0;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nbool\nvirFileExists(const char *path)\n{\n    return access(path, F_OK) == 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileBindMountDevice(const char *src,\n                       const char *dst)\n{\n    if (!virFileExists(dst)) {\n        if (virFileIsDir(src)) {\n            if (virFileMakePath(dst) < 0) {\n                virReportSystemError(errno, _(\"Unable to make dir %s\"), dst);\n                return -1;\n            }\n        } else {\n            if (virFileTouch(dst, 0666) < 0)\n                return -1;\n        }\n    }\n\n    if (mount(src, dst, \"none\", MS_BIND, NULL) < 0) {\n        virReportSystemError(errno, _(\"Failed to bind %s on to %s\"), src,\n                             dst);\n        return -1;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virFileSetupDev",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "3716-3739",
    "snippet": "int\nvirFileSetupDev(const char *path,\n                const char *mount_options)\n{\n    const unsigned long mount_flags = MS_NOSUID;\n    const char *mount_fs = \"tmpfs\";\n\n    if (virFileMakePath(path) < 0) {\n        virReportSystemError(errno,\n                             _(\"Failed to make path %s\"), path);\n        return -1;\n    }\n\n    VIR_DEBUG(\"Mount devfs on %s type=tmpfs flags=0x%lx, opts=%s\",\n              path, mount_flags, mount_options);\n    if (mount(\"devfs\", path, mount_fs, mount_flags, mount_options) < 0) {\n        virReportSystemError(errno,\n                             _(\"Failed to mount devfs on %s type %s (%s)\"),\n                             path, mount_fs, mount_options);\n        return -1;\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"Failed to mount devfs on %s type %s (%s)\")",
            "path",
            "mount_fs",
            "mount_options"
          ],
          "line": 3732
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Failed to mount devfs on %s type %s (%s)\""
          ],
          "line": 3733
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "mount",
          "args": [
            "\"devfs\"",
            "path",
            "mount_fs",
            "mount_flags",
            "mount_options"
          ],
          "line": 3731
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Mount devfs on %s type=tmpfs flags=0x%lx, opts=%s\"",
            "path",
            "mount_flags",
            "mount_options"
          ],
          "line": 3729
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"Failed to make path %s\")",
            "path"
          ],
          "line": 3724
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virFileMakePath",
          "args": [
            "path"
          ],
          "line": 3723
        },
        "resolved": true,
        "details": {
          "function_name": "virFileMakePath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "3076-3080",
          "snippet": "int\nvirFileMakePath(const char *path)\n{\n    return virFileMakePathWithMode(path, 0777);\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileMakePath(const char *path)\n{\n    return virFileMakePathWithMode(path, 0777);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileSetupDev(const char *path,\n                const char *mount_options)\n{\n    const unsigned long mount_flags = MS_NOSUID;\n    const char *mount_fs = \"tmpfs\";\n\n    if (virFileMakePath(path) < 0) {\n        virReportSystemError(errno,\n                             _(\"Failed to make path %s\"), path);\n        return -1;\n    }\n\n    VIR_DEBUG(\"Mount devfs on %s type=tmpfs flags=0x%lx, opts=%s\",\n              path, mount_flags, mount_options);\n    if (mount(\"devfs\", path, mount_fs, mount_flags, mount_options) < 0) {\n        virReportSystemError(errno,\n                             _(\"Failed to mount devfs on %s type %s (%s)\"),\n                             path, mount_fs, mount_options);\n        return -1;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virFileIsSharedFS",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "3699-3712",
    "snippet": "int virFileIsSharedFS(const char *path)\n{\n    return virFileIsSharedFSType(path,\n                                 VIR_FILE_SHFS_NFS |\n                                 VIR_FILE_SHFS_GFS2 |\n                                 VIR_FILE_SHFS_OCFS |\n                                 VIR_FILE_SHFS_AFS |\n                                 VIR_FILE_SHFS_SMB |\n                                 VIR_FILE_SHFS_CIFS |\n                                 VIR_FILE_SHFS_CEPH |\n                                 VIR_FILE_SHFS_GPFS|\n                                 VIR_FILE_SHFS_QB |\n                                 VIR_FILE_SHFS_ACFS);\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virFileIsSharedFSType",
          "args": [
            "path",
            "VIR_FILE_SHFS_NFS |\n                                 VIR_FILE_SHFS_GFS2 |\n                                 VIR_FILE_SHFS_OCFS |\n                                 VIR_FILE_SHFS_AFS |\n                                 VIR_FILE_SHFS_SMB |\n                                 VIR_FILE_SHFS_CIFS |\n                                 VIR_FILE_SHFS_CEPH |\n                                 VIR_FILE_SHFS_GPFS|\n                                 VIR_FILE_SHFS_QB |\n                                 VIR_FILE_SHFS_ACFS"
          ],
          "line": 3701
        },
        "resolved": true,
        "details": {
          "function_name": "virFileIsSharedFSType",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "3648-3653",
          "snippet": "int virFileIsSharedFSType(const char *path G_GNUC_UNUSED,\n                          int fstypes G_GNUC_UNUSED)\n{\n    /* XXX implement me :-) */\n    return 0;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint virFileIsSharedFSType(const char *path G_GNUC_UNUSED,\n                          int fstypes G_GNUC_UNUSED)\n{\n    /* XXX implement me :-) */\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint virFileIsSharedFS(const char *path)\n{\n    return virFileIsSharedFSType(path,\n                                 VIR_FILE_SHFS_NFS |\n                                 VIR_FILE_SHFS_GFS2 |\n                                 VIR_FILE_SHFS_OCFS |\n                                 VIR_FILE_SHFS_AFS |\n                                 VIR_FILE_SHFS_SMB |\n                                 VIR_FILE_SHFS_CIFS |\n                                 VIR_FILE_SHFS_CEPH |\n                                 VIR_FILE_SHFS_GPFS|\n                                 VIR_FILE_SHFS_QB |\n                                 VIR_FILE_SHFS_ACFS);\n}"
  },
  {
    "function_name": "virFileGetDefaultHugepage",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "3685-3697",
    "snippet": "virHugeTLBFSPtr\nvirFileGetDefaultHugepage(virHugeTLBFSPtr fs,\n                          size_t nfs)\n{\n    size_t i;\n\n    for (i = 0; i < nfs; i++) {\n        if (fs[i].deflt)\n            return &fs[i];\n    }\n\n    return NULL;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nvirHugeTLBFSPtr\nvirFileGetDefaultHugepage(virHugeTLBFSPtr fs,\n                          size_t nfs)\n{\n    size_t i;\n\n    for (i = 0; i < nfs; i++) {\n        if (fs[i].deflt)\n            return &fs[i];\n    }\n\n    return NULL;\n}"
  },
  {
    "function_name": "virFileFindHugeTLBFS",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "3664-3671",
    "snippet": "int\nvirFileFindHugeTLBFS(virHugeTLBFSPtr *ret_fs G_GNUC_UNUSED,\n                     size_t *ret_nfs G_GNUC_UNUSED)\n{\n    /* XXX implement me :-) */\n    virReportUnsupportedError();\n    return -1;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 3669
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileFindHugeTLBFS(virHugeTLBFSPtr *ret_fs G_GNUC_UNUSED,\n                     size_t *ret_nfs G_GNUC_UNUSED)\n{\n    /* XXX implement me :-) */\n    virReportUnsupportedError();\n    return -1;\n}"
  },
  {
    "function_name": "virFileGetHugepageSize",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "3655-3662",
    "snippet": "int\nvirFileGetHugepageSize(const char *path G_GNUC_UNUSED,\n                       unsigned long long *size G_GNUC_UNUSED)\n{\n    /* XXX implement me :-) */\n    virReportUnsupportedError();\n    return -1;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportUnsupportedError",
          "args": [],
          "line": 3660
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileGetHugepageSize(const char *path G_GNUC_UNUSED,\n                       unsigned long long *size G_GNUC_UNUSED)\n{\n    /* XXX implement me :-) */\n    virReportUnsupportedError();\n    return -1;\n}"
  },
  {
    "function_name": "virFileIsSharedFSType",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "3648-3653",
    "snippet": "int virFileIsSharedFSType(const char *path G_GNUC_UNUSED,\n                          int fstypes G_GNUC_UNUSED)\n{\n    /* XXX implement me :-) */\n    return 0;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint virFileIsSharedFSType(const char *path G_GNUC_UNUSED,\n                          int fstypes G_GNUC_UNUSED)\n{\n    /* XXX implement me :-) */\n    return 0;\n}"
  },
  {
    "function_name": "virFileFindHugeTLBFS",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "3590-3644",
    "snippet": "int\nvirFileFindHugeTLBFS(virHugeTLBFSPtr *ret_fs,\n                     size_t *ret_nfs)\n{\n    int ret = -1;\n    FILE *f = NULL;\n    struct mntent mb;\n    char mntbuf[1024];\n    virHugeTLBFSPtr fs = NULL;\n    size_t nfs = 0;\n    unsigned long long default_hugepagesz = 0;\n\n    if (!(f = setmntent(PROC_MOUNTS, \"r\"))) {\n        virReportSystemError(errno,\n                             _(\"Unable to open %s\"),\n                             PROC_MOUNTS);\n        goto cleanup;\n    }\n\n    while (getmntent_r(f, &mb, mntbuf, sizeof(mntbuf))) {\n        virHugeTLBFSPtr tmp;\n\n        if (STRNEQ(mb.mnt_type, \"hugetlbfs\"))\n            continue;\n\n        if (VIR_EXPAND_N(fs, nfs, 1) < 0)\n             goto cleanup;\n\n        tmp = &fs[nfs - 1];\n\n        tmp->mnt_dir = g_strdup(mb.mnt_dir);\n\n        if (virFileGetHugepageSize(tmp->mnt_dir, &tmp->size) < 0)\n            goto cleanup;\n\n        if (!default_hugepagesz &&\n            virFileGetDefaultHugepageSize(&default_hugepagesz) < 0)\n            goto cleanup;\n\n        tmp->deflt = tmp->size == default_hugepagesz;\n    }\n\n    *ret_fs = fs;\n    *ret_nfs = nfs;\n    fs = NULL;\n    nfs = 0;\n    ret = 0;\n\n cleanup:\n    endmntent(f);\n    while (nfs)\n        VIR_FREE(fs[--nfs].mnt_dir);\n    VIR_FREE(fs);\n    return ret;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "fs"
          ],
          "line": 3642
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "fs[--nfs].mnt_dir"
          ],
          "line": 3641
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "endmntent",
          "args": [
            "f"
          ],
          "line": 3639
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virFileGetDefaultHugepageSize",
          "args": [
            "&default_hugepagesz"
          ],
          "line": 3626
        },
        "resolved": true,
        "details": {
          "function_name": "virFileGetDefaultHugepageSize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "3555-3588",
          "snippet": "static int\nvirFileGetDefaultHugepageSize(unsigned long long *size)\n{\n    g_autofree char *meminfo = NULL;\n    char *c;\n    char *n;\n    char *unit;\n\n    if (virFileReadAll(PROC_MEMINFO, 4096, &meminfo) < 0)\n        return -1;\n\n    if (!(c = strstr(meminfo, HUGEPAGESIZE_STR))) {\n        virReportError(VIR_ERR_NO_SUPPORT,\n                       _(\"%s not found in %s\"),\n                       HUGEPAGESIZE_STR,\n                       PROC_MEMINFO);\n        return -1;\n    }\n    c += strlen(HUGEPAGESIZE_STR);\n\n    if ((n = strchr(c, '\\n'))) {\n        /* Cut off the rest of the meminfo file */\n        *n = '\\0';\n    }\n\n    if (virStrToLong_ull(c, &unit, 10, size) < 0 || STRNEQ(unit, \" kB\")) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Unable to parse %s %s\"),\n                       HUGEPAGESIZE_STR, c);\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nvirFileGetDefaultHugepageSize(unsigned long long *size)\n{\n    g_autofree char *meminfo = NULL;\n    char *c;\n    char *n;\n    char *unit;\n\n    if (virFileReadAll(PROC_MEMINFO, 4096, &meminfo) < 0)\n        return -1;\n\n    if (!(c = strstr(meminfo, HUGEPAGESIZE_STR))) {\n        virReportError(VIR_ERR_NO_SUPPORT,\n                       _(\"%s not found in %s\"),\n                       HUGEPAGESIZE_STR,\n                       PROC_MEMINFO);\n        return -1;\n    }\n    c += strlen(HUGEPAGESIZE_STR);\n\n    if ((n = strchr(c, '\\n'))) {\n        /* Cut off the rest of the meminfo file */\n        *n = '\\0';\n    }\n\n    if (virStrToLong_ull(c, &unit, 10, size) < 0 || STRNEQ(unit, \" kB\")) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Unable to parse %s %s\"),\n                       HUGEPAGESIZE_STR, c);\n        return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virFileGetHugepageSize",
          "args": [
            "tmp->mnt_dir",
            "&tmp->size"
          ],
          "line": 3622
        },
        "resolved": true,
        "details": {
          "function_name": "virFileGetHugepageSize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "3655-3662",
          "snippet": "int\nvirFileGetHugepageSize(const char *path G_GNUC_UNUSED,\n                       unsigned long long *size G_GNUC_UNUSED)\n{\n    /* XXX implement me :-) */\n    virReportUnsupportedError();\n    return -1;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileGetHugepageSize(const char *path G_GNUC_UNUSED,\n                       unsigned long long *size G_GNUC_UNUSED)\n{\n    /* XXX implement me :-) */\n    virReportUnsupportedError();\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "mb.mnt_dir"
          ],
          "line": 3620
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_EXPAND_N",
          "args": [
            "fs",
            "nfs",
            "1"
          ],
          "line": 3615
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STRNEQ",
          "args": [
            "mb.mnt_type",
            "\"hugetlbfs\""
          ],
          "line": 3612
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getmntent_r",
          "args": [
            "f",
            "&mb",
            "mntbuf",
            "sizeof(mntbuf)"
          ],
          "line": 3609
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"Unable to open %s\")",
            "PROC_MOUNTS"
          ],
          "line": 3603
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setmntent",
          "args": [
            "PROC_MOUNTS",
            "\"r\""
          ],
          "line": 3602
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileFindHugeTLBFS(virHugeTLBFSPtr *ret_fs,\n                     size_t *ret_nfs)\n{\n    int ret = -1;\n    FILE *f = NULL;\n    struct mntent mb;\n    char mntbuf[1024];\n    virHugeTLBFSPtr fs = NULL;\n    size_t nfs = 0;\n    unsigned long long default_hugepagesz = 0;\n\n    if (!(f = setmntent(PROC_MOUNTS, \"r\"))) {\n        virReportSystemError(errno,\n                             _(\"Unable to open %s\"),\n                             PROC_MOUNTS);\n        goto cleanup;\n    }\n\n    while (getmntent_r(f, &mb, mntbuf, sizeof(mntbuf))) {\n        virHugeTLBFSPtr tmp;\n\n        if (STRNEQ(mb.mnt_type, \"hugetlbfs\"))\n            continue;\n\n        if (VIR_EXPAND_N(fs, nfs, 1) < 0)\n             goto cleanup;\n\n        tmp = &fs[nfs - 1];\n\n        tmp->mnt_dir = g_strdup(mb.mnt_dir);\n\n        if (virFileGetHugepageSize(tmp->mnt_dir, &tmp->size) < 0)\n            goto cleanup;\n\n        if (!default_hugepagesz &&\n            virFileGetDefaultHugepageSize(&default_hugepagesz) < 0)\n            goto cleanup;\n\n        tmp->deflt = tmp->size == default_hugepagesz;\n    }\n\n    *ret_fs = fs;\n    *ret_nfs = nfs;\n    fs = NULL;\n    nfs = 0;\n    ret = 0;\n\n cleanup:\n    endmntent(f);\n    while (nfs)\n        VIR_FREE(fs[--nfs].mnt_dir);\n    VIR_FREE(fs);\n    return ret;\n}"
  },
  {
    "function_name": "virFileGetDefaultHugepageSize",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "3555-3588",
    "snippet": "static int\nvirFileGetDefaultHugepageSize(unsigned long long *size)\n{\n    g_autofree char *meminfo = NULL;\n    char *c;\n    char *n;\n    char *unit;\n\n    if (virFileReadAll(PROC_MEMINFO, 4096, &meminfo) < 0)\n        return -1;\n\n    if (!(c = strstr(meminfo, HUGEPAGESIZE_STR))) {\n        virReportError(VIR_ERR_NO_SUPPORT,\n                       _(\"%s not found in %s\"),\n                       HUGEPAGESIZE_STR,\n                       PROC_MEMINFO);\n        return -1;\n    }\n    c += strlen(HUGEPAGESIZE_STR);\n\n    if ((n = strchr(c, '\\n'))) {\n        /* Cut off the rest of the meminfo file */\n        *n = '\\0';\n    }\n\n    if (virStrToLong_ull(c, &unit, 10, size) < 0 || STRNEQ(unit, \" kB\")) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Unable to parse %s %s\"),\n                       HUGEPAGESIZE_STR, c);\n        return -1;\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Unable to parse %s %s\")",
            "HUGEPAGESIZE_STR",
            "c"
          ],
          "line": 3581
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to parse %s %s\""
          ],
          "line": 3582
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "STRNEQ",
          "args": [
            "unit",
            "\" kB\""
          ],
          "line": 3580
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStrToLong_ull",
          "args": [
            "c",
            "&unit",
            "10",
            "size"
          ],
          "line": 3580
        },
        "resolved": true,
        "details": {
          "function_name": "virStrToLong_ullp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "568-586",
          "snippet": "int\nvirStrToLong_ullp(char const *s, char **end_ptr, int base,\n                  unsigned long long *result)\n{\n    unsigned long long val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtoull(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToLong_ullp(char const *s, char **end_ptr, int base,\n                  unsigned long long *result)\n{\n    unsigned long long val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtoull(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "c",
            "'\\n'"
          ],
          "line": 3575
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "HUGEPAGESIZE_STR"
          ],
          "line": 3573
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_NO_SUPPORT",
            "_(\"%s not found in %s\")",
            "HUGEPAGESIZE_STR",
            "PROC_MEMINFO"
          ],
          "line": 3567
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "meminfo",
            "HUGEPAGESIZE_STR"
          ],
          "line": 3566
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virFileReadAll",
          "args": [
            "PROC_MEMINFO",
            "4096",
            "&meminfo"
          ],
          "line": 3563
        },
        "resolved": true,
        "details": {
          "function_name": "virFileReadAllQuiet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1459-1472",
          "snippet": "int\nvirFileReadAllQuiet(const char *path, int maxlen, char **buf)\n{\n    int fd = open(path, O_RDONLY);\n    if (fd < 0)\n        return -errno;\n\n    int len = virFileReadLimFD(fd, maxlen, buf);\n    VIR_FORCE_CLOSE(fd);\n    if (len < 0)\n        return -errno;\n\n    return len;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileReadAllQuiet(const char *path, int maxlen, char **buf)\n{\n    int fd = open(path, O_RDONLY);\n    if (fd < 0)\n        return -errno;\n\n    int len = virFileReadLimFD(fd, maxlen, buf);\n    VIR_FORCE_CLOSE(fd);\n    if (len < 0)\n        return -errno;\n\n    return len;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nvirFileGetDefaultHugepageSize(unsigned long long *size)\n{\n    g_autofree char *meminfo = NULL;\n    char *c;\n    char *n;\n    char *unit;\n\n    if (virFileReadAll(PROC_MEMINFO, 4096, &meminfo) < 0)\n        return -1;\n\n    if (!(c = strstr(meminfo, HUGEPAGESIZE_STR))) {\n        virReportError(VIR_ERR_NO_SUPPORT,\n                       _(\"%s not found in %s\"),\n                       HUGEPAGESIZE_STR,\n                       PROC_MEMINFO);\n        return -1;\n    }\n    c += strlen(HUGEPAGESIZE_STR);\n\n    if ((n = strchr(c, '\\n'))) {\n        /* Cut off the rest of the meminfo file */\n        *n = '\\0';\n    }\n\n    if (virStrToLong_ull(c, &unit, 10, size) < 0 || STRNEQ(unit, \" kB\")) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Unable to parse %s %s\"),\n                       HUGEPAGESIZE_STR, c);\n        return -1;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virFileGetHugepageSize",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "3527-3550",
    "snippet": "int\nvirFileGetHugepageSize(const char *path,\n                       unsigned long long *size)\n{\n    struct statfs fs;\n\n    if (statfs(path, &fs) < 0) {\n        virReportSystemError(errno,\n                             _(\"cannot determine filesystem for '%s'\"),\n                             path);\n        return -1;\n    }\n\n    if (fs.f_type != HUGETLBFS_MAGIC) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"not a hugetlbfs mount: '%s'\"),\n                       path);\n        return -1;\n    }\n\n    *size = fs.f_bsize / 1024; /* we are storing size in KiB */\n\n    return 0;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"not a hugetlbfs mount: '%s'\")",
            "path"
          ],
          "line": 3541
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"not a hugetlbfs mount: '%s'\""
          ],
          "line": 3542
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"cannot determine filesystem for '%s'\")",
            "path"
          ],
          "line": 3534
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "statfs",
          "args": [
            "path",
            "&fs"
          ],
          "line": 3533
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileGetHugepageSize(const char *path,\n                       unsigned long long *size)\n{\n    struct statfs fs;\n\n    if (statfs(path, &fs) < 0) {\n        virReportSystemError(errno,\n                             _(\"cannot determine filesystem for '%s'\"),\n                             path);\n        return -1;\n    }\n\n    if (fs.f_type != HUGETLBFS_MAGIC) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"not a hugetlbfs mount: '%s'\"),\n                       path);\n        return -1;\n    }\n\n    *size = fs.f_bsize / 1024; /* we are storing size in KiB */\n\n    return 0;\n}"
  },
  {
    "function_name": "virFileIsSharedFSType",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "3438-3525",
    "snippet": "int\nvirFileIsSharedFSType(const char *path,\n                      int fstypes)\n{\n    g_autofree char *dirpath = NULL;\n    char *p = NULL;\n    struct statfs sb;\n    int statfs_ret;\n    long long f_type = 0;\n\n    dirpath = g_strdup(path);\n\n    statfs_ret = statfs(dirpath, &sb);\n\n    while ((statfs_ret < 0) && (p != dirpath)) {\n        /* Try less and less of the path until we get to a\n         * directory we can stat. Even if we don't have 'x'\n         * permission on any directory in the path on the NFS\n         * server (assuming it's NFS), we will be able to stat the\n         * mount point, and that will properly tell us if the\n         * fstype is NFS.\n         */\n\n        if ((p = strrchr(dirpath, '/')) == NULL) {\n            virReportSystemError(EINVAL,\n                                 _(\"Invalid relative path '%s'\"), path);\n            return -1;\n        }\n\n        if (p == dirpath)\n            *(p+1) = '\\0';\n        else\n            *p = '\\0';\n\n        statfs_ret = statfs(dirpath, &sb);\n    }\n\n    if (statfs_ret < 0) {\n        virReportSystemError(errno,\n                             _(\"cannot determine filesystem for '%s'\"),\n                             path);\n        return -1;\n    }\n\n    f_type = sb.f_type;\n\n    if (f_type == FUSE_SUPER_MAGIC) {\n        VIR_DEBUG(\"Found FUSE mount for path=%s. Trying to fix it\", path);\n        virFileIsSharedFixFUSE(path, &f_type);\n    }\n\n    VIR_DEBUG(\"Check if path %s with FS magic %lld is shared\",\n              path, f_type);\n\n    if ((fstypes & VIR_FILE_SHFS_NFS) &&\n        (f_type == NFS_SUPER_MAGIC))\n        return 1;\n\n    if ((fstypes & VIR_FILE_SHFS_GFS2) &&\n        (f_type == GFS2_MAGIC))\n        return 1;\n    if ((fstypes & VIR_FILE_SHFS_OCFS) &&\n        (f_type == OCFS2_SUPER_MAGIC))\n        return 1;\n    if ((fstypes & VIR_FILE_SHFS_AFS) &&\n        (f_type == AFS_FS_MAGIC))\n        return 1;\n    if ((fstypes & VIR_FILE_SHFS_SMB) &&\n        (f_type == SMB_SUPER_MAGIC))\n        return 1;\n    if ((fstypes & VIR_FILE_SHFS_CIFS) &&\n        (f_type == CIFS_SUPER_MAGIC))\n        return 1;\n    if ((fstypes & VIR_FILE_SHFS_CEPH) &&\n        (f_type == CEPH_SUPER_MAGIC))\n        return 1;\n    if ((fstypes & VIR_FILE_SHFS_GPFS) &&\n        (f_type == GPFS_SUPER_MAGIC))\n        return 1;\n    if ((fstypes & VIR_FILE_SHFS_QB) &&\n        (f_type == QB_MAGIC))\n        return 1;\n    if ((fstypes & VIR_FILE_SHFS_ACFS) &&\n        (f_type == VIR_ACFS_MAGIC))\n        return 1;\n\n    return 0;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Check if path %s with FS magic %lld is shared\"",
            "path",
            "f_type"
          ],
          "line": 3489
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virFileIsSharedFixFUSE",
          "args": [
            "path",
            "&f_type"
          ],
          "line": 3486
        },
        "resolved": true,
        "details": {
          "function_name": "virFileIsSharedFixFUSE",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "3370-3435",
          "snippet": "static int\nvirFileIsSharedFixFUSE(const char *path,\n                       long long *f_type)\n{\n    FILE *f = NULL;\n    struct mntent mb;\n    char mntbuf[1024];\n    char *mntDir = NULL;\n    char *mntType = NULL;\n    char *canonPath = NULL;\n    size_t maxMatching = 0;\n    int ret = -1;\n\n    if (!(canonPath = virFileCanonicalizePath(path))) {\n        virReportSystemError(errno,\n                             _(\"unable to canonicalize %s\"),\n                             path);\n        return -1;\n    }\n\n    VIR_DEBUG(\"Path canonicalization: %s->%s\", path, canonPath);\n\n    if (!(f = setmntent(PROC_MOUNTS, \"r\"))) {\n        virReportSystemError(errno,\n                             _(\"Unable to open %s\"),\n                             PROC_MOUNTS);\n        goto cleanup;\n    }\n\n    while (getmntent_r(f, &mb, mntbuf, sizeof(mntbuf))) {\n        const char *p;\n        size_t len = strlen(mb.mnt_dir);\n\n        if (!(p = STRSKIP(canonPath, mb.mnt_dir)))\n            continue;\n\n        if (*(p - 1) != '/' && *p != '/' && *p != '\\0')\n            continue;\n\n        if (len > maxMatching) {\n            maxMatching = len;\n            VIR_FREE(mntType);\n            VIR_FREE(mntDir);\n            mntDir = g_strdup(mb.mnt_dir);\n            mntType = g_strdup(mb.mnt_type);\n        }\n    }\n\n    if (STREQ_NULLABLE(mntType, \"fuse.glusterfs\")) {\n        VIR_DEBUG(\"Found gluster FUSE mountpoint=%s for path=%s. \"\n                  \"Fixing shared FS type\", mntDir, canonPath);\n        *f_type = GFS2_MAGIC;\n    } else if (STREQ_NULLABLE(mntType, \"fuse.quobyte\")) {\n        VIR_DEBUG(\"Found Quobyte FUSE mountpoint=%s for path=%s. \"\n                  \"Fixing shared FS type\", mntDir, canonPath);\n        *f_type = QB_MAGIC;\n    }\n\n    ret = 0;\n cleanup:\n    VIR_FREE(canonPath);\n    VIR_FREE(mntType);\n    VIR_FREE(mntDir);\n    endmntent(f);\n    return ret;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nvirFileIsSharedFixFUSE(const char *path,\n                       long long *f_type)\n{\n    FILE *f = NULL;\n    struct mntent mb;\n    char mntbuf[1024];\n    char *mntDir = NULL;\n    char *mntType = NULL;\n    char *canonPath = NULL;\n    size_t maxMatching = 0;\n    int ret = -1;\n\n    if (!(canonPath = virFileCanonicalizePath(path))) {\n        virReportSystemError(errno,\n                             _(\"unable to canonicalize %s\"),\n                             path);\n        return -1;\n    }\n\n    VIR_DEBUG(\"Path canonicalization: %s->%s\", path, canonPath);\n\n    if (!(f = setmntent(PROC_MOUNTS, \"r\"))) {\n        virReportSystemError(errno,\n                             _(\"Unable to open %s\"),\n                             PROC_MOUNTS);\n        goto cleanup;\n    }\n\n    while (getmntent_r(f, &mb, mntbuf, sizeof(mntbuf))) {\n        const char *p;\n        size_t len = strlen(mb.mnt_dir);\n\n        if (!(p = STRSKIP(canonPath, mb.mnt_dir)))\n            continue;\n\n        if (*(p - 1) != '/' && *p != '/' && *p != '\\0')\n            continue;\n\n        if (len > maxMatching) {\n            maxMatching = len;\n            VIR_FREE(mntType);\n            VIR_FREE(mntDir);\n            mntDir = g_strdup(mb.mnt_dir);\n            mntType = g_strdup(mb.mnt_type);\n        }\n    }\n\n    if (STREQ_NULLABLE(mntType, \"fuse.glusterfs\")) {\n        VIR_DEBUG(\"Found gluster FUSE mountpoint=%s for path=%s. \"\n                  \"Fixing shared FS type\", mntDir, canonPath);\n        *f_type = GFS2_MAGIC;\n    } else if (STREQ_NULLABLE(mntType, \"fuse.quobyte\")) {\n        VIR_DEBUG(\"Found Quobyte FUSE mountpoint=%s for path=%s. \"\n                  \"Fixing shared FS type\", mntDir, canonPath);\n        *f_type = QB_MAGIC;\n    }\n\n    ret = 0;\n cleanup:\n    VIR_FREE(canonPath);\n    VIR_FREE(mntType);\n    VIR_FREE(mntDir);\n    endmntent(f);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Found FUSE mount for path=%s. Trying to fix it\"",
            "path"
          ],
          "line": 3485
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"cannot determine filesystem for '%s'\")",
            "path"
          ],
          "line": 3476
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"cannot determine filesystem for '%s'\""
          ],
          "line": 3477
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "statfs",
          "args": [
            "dirpath",
            "&sb"
          ],
          "line": 3472
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "EINVAL",
            "_(\"Invalid relative path '%s'\")",
            "path"
          ],
          "line": 3462
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strrchr",
          "args": [
            "dirpath",
            "'/'"
          ],
          "line": 3461
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "statfs",
          "args": [
            "dirpath",
            "&sb"
          ],
          "line": 3450
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileIsSharedFSType(const char *path,\n                      int fstypes)\n{\n    g_autofree char *dirpath = NULL;\n    char *p = NULL;\n    struct statfs sb;\n    int statfs_ret;\n    long long f_type = 0;\n\n    dirpath = g_strdup(path);\n\n    statfs_ret = statfs(dirpath, &sb);\n\n    while ((statfs_ret < 0) && (p != dirpath)) {\n        /* Try less and less of the path until we get to a\n         * directory we can stat. Even if we don't have 'x'\n         * permission on any directory in the path on the NFS\n         * server (assuming it's NFS), we will be able to stat the\n         * mount point, and that will properly tell us if the\n         * fstype is NFS.\n         */\n\n        if ((p = strrchr(dirpath, '/')) == NULL) {\n            virReportSystemError(EINVAL,\n                                 _(\"Invalid relative path '%s'\"), path);\n            return -1;\n        }\n\n        if (p == dirpath)\n            *(p+1) = '\\0';\n        else\n            *p = '\\0';\n\n        statfs_ret = statfs(dirpath, &sb);\n    }\n\n    if (statfs_ret < 0) {\n        virReportSystemError(errno,\n                             _(\"cannot determine filesystem for '%s'\"),\n                             path);\n        return -1;\n    }\n\n    f_type = sb.f_type;\n\n    if (f_type == FUSE_SUPER_MAGIC) {\n        VIR_DEBUG(\"Found FUSE mount for path=%s. Trying to fix it\", path);\n        virFileIsSharedFixFUSE(path, &f_type);\n    }\n\n    VIR_DEBUG(\"Check if path %s with FS magic %lld is shared\",\n              path, f_type);\n\n    if ((fstypes & VIR_FILE_SHFS_NFS) &&\n        (f_type == NFS_SUPER_MAGIC))\n        return 1;\n\n    if ((fstypes & VIR_FILE_SHFS_GFS2) &&\n        (f_type == GFS2_MAGIC))\n        return 1;\n    if ((fstypes & VIR_FILE_SHFS_OCFS) &&\n        (f_type == OCFS2_SUPER_MAGIC))\n        return 1;\n    if ((fstypes & VIR_FILE_SHFS_AFS) &&\n        (f_type == AFS_FS_MAGIC))\n        return 1;\n    if ((fstypes & VIR_FILE_SHFS_SMB) &&\n        (f_type == SMB_SUPER_MAGIC))\n        return 1;\n    if ((fstypes & VIR_FILE_SHFS_CIFS) &&\n        (f_type == CIFS_SUPER_MAGIC))\n        return 1;\n    if ((fstypes & VIR_FILE_SHFS_CEPH) &&\n        (f_type == CEPH_SUPER_MAGIC))\n        return 1;\n    if ((fstypes & VIR_FILE_SHFS_GPFS) &&\n        (f_type == GPFS_SUPER_MAGIC))\n        return 1;\n    if ((fstypes & VIR_FILE_SHFS_QB) &&\n        (f_type == QB_MAGIC))\n        return 1;\n    if ((fstypes & VIR_FILE_SHFS_ACFS) &&\n        (f_type == VIR_ACFS_MAGIC))\n        return 1;\n\n    return 0;\n}"
  },
  {
    "function_name": "virFileIsSharedFixFUSE",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "3370-3435",
    "snippet": "static int\nvirFileIsSharedFixFUSE(const char *path,\n                       long long *f_type)\n{\n    FILE *f = NULL;\n    struct mntent mb;\n    char mntbuf[1024];\n    char *mntDir = NULL;\n    char *mntType = NULL;\n    char *canonPath = NULL;\n    size_t maxMatching = 0;\n    int ret = -1;\n\n    if (!(canonPath = virFileCanonicalizePath(path))) {\n        virReportSystemError(errno,\n                             _(\"unable to canonicalize %s\"),\n                             path);\n        return -1;\n    }\n\n    VIR_DEBUG(\"Path canonicalization: %s->%s\", path, canonPath);\n\n    if (!(f = setmntent(PROC_MOUNTS, \"r\"))) {\n        virReportSystemError(errno,\n                             _(\"Unable to open %s\"),\n                             PROC_MOUNTS);\n        goto cleanup;\n    }\n\n    while (getmntent_r(f, &mb, mntbuf, sizeof(mntbuf))) {\n        const char *p;\n        size_t len = strlen(mb.mnt_dir);\n\n        if (!(p = STRSKIP(canonPath, mb.mnt_dir)))\n            continue;\n\n        if (*(p - 1) != '/' && *p != '/' && *p != '\\0')\n            continue;\n\n        if (len > maxMatching) {\n            maxMatching = len;\n            VIR_FREE(mntType);\n            VIR_FREE(mntDir);\n            mntDir = g_strdup(mb.mnt_dir);\n            mntType = g_strdup(mb.mnt_type);\n        }\n    }\n\n    if (STREQ_NULLABLE(mntType, \"fuse.glusterfs\")) {\n        VIR_DEBUG(\"Found gluster FUSE mountpoint=%s for path=%s. \"\n                  \"Fixing shared FS type\", mntDir, canonPath);\n        *f_type = GFS2_MAGIC;\n    } else if (STREQ_NULLABLE(mntType, \"fuse.quobyte\")) {\n        VIR_DEBUG(\"Found Quobyte FUSE mountpoint=%s for path=%s. \"\n                  \"Fixing shared FS type\", mntDir, canonPath);\n        *f_type = QB_MAGIC;\n    }\n\n    ret = 0;\n cleanup:\n    VIR_FREE(canonPath);\n    VIR_FREE(mntType);\n    VIR_FREE(mntDir);\n    endmntent(f);\n    return ret;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "endmntent",
          "args": [
            "f"
          ],
          "line": 3433
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "mntDir"
          ],
          "line": 3432
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "mntType"
          ],
          "line": 3431
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "canonPath"
          ],
          "line": 3430
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Found Quobyte FUSE mountpoint=%s for path=%s. \"\n                  \"Fixing shared FS type\"",
            "mntDir",
            "canonPath"
          ],
          "line": 3423
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ_NULLABLE",
          "args": [
            "mntType",
            "\"fuse.quobyte\""
          ],
          "line": 3422
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Found gluster FUSE mountpoint=%s for path=%s. \"\n                  \"Fixing shared FS type\"",
            "mntDir",
            "canonPath"
          ],
          "line": 3419
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ_NULLABLE",
          "args": [
            "mntType",
            "\"fuse.glusterfs\""
          ],
          "line": 3418
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "mb.mnt_type"
          ],
          "line": 3414
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "mntDir"
          ],
          "line": 3412
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "mntType"
          ],
          "line": 3411
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STRSKIP",
          "args": [
            "canonPath",
            "mb.mnt_dir"
          ],
          "line": 3403
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "mb.mnt_dir"
          ],
          "line": 3401
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getmntent_r",
          "args": [
            "f",
            "&mb",
            "mntbuf",
            "sizeof(mntbuf)"
          ],
          "line": 3399
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"Unable to open %s\")",
            "PROC_MOUNTS"
          ],
          "line": 3393
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setmntent",
          "args": [
            "PROC_MOUNTS",
            "\"r\""
          ],
          "line": 3392
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Path canonicalization: %s->%s\"",
            "path",
            "canonPath"
          ],
          "line": 3390
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"unable to canonicalize %s\")",
            "path"
          ],
          "line": 3384
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virFileCanonicalizePath",
          "args": [
            "path"
          ],
          "line": 3383
        },
        "resolved": true,
        "details": {
          "function_name": "virFileCanonicalizePath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "3299-3310",
          "snippet": "char *\nvirFileCanonicalizePath(const char *path)\n{\n#ifdef WIN32\n    /* Does not resolve symlinks, only expands . & .. & repeated /.\n     * It will never fail, so sanitize errno to indicate success */\n    errno = 0;\n    return g_canonicalize_filename(path, NULL);\n#else\n    return realpath(path, NULL); /* exempt from syntax-check */\n#endif\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nchar *\nvirFileCanonicalizePath(const char *path)\n{\n#ifdef WIN32\n    /* Does not resolve symlinks, only expands . & .. & repeated /.\n     * It will never fail, so sanitize errno to indicate success */\n    errno = 0;\n    return g_canonicalize_filename(path, NULL);\n#else\n    return realpath(path, NULL); /* exempt from syntax-check */\n#endif\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nvirFileIsSharedFixFUSE(const char *path,\n                       long long *f_type)\n{\n    FILE *f = NULL;\n    struct mntent mb;\n    char mntbuf[1024];\n    char *mntDir = NULL;\n    char *mntType = NULL;\n    char *canonPath = NULL;\n    size_t maxMatching = 0;\n    int ret = -1;\n\n    if (!(canonPath = virFileCanonicalizePath(path))) {\n        virReportSystemError(errno,\n                             _(\"unable to canonicalize %s\"),\n                             path);\n        return -1;\n    }\n\n    VIR_DEBUG(\"Path canonicalization: %s->%s\", path, canonPath);\n\n    if (!(f = setmntent(PROC_MOUNTS, \"r\"))) {\n        virReportSystemError(errno,\n                             _(\"Unable to open %s\"),\n                             PROC_MOUNTS);\n        goto cleanup;\n    }\n\n    while (getmntent_r(f, &mb, mntbuf, sizeof(mntbuf))) {\n        const char *p;\n        size_t len = strlen(mb.mnt_dir);\n\n        if (!(p = STRSKIP(canonPath, mb.mnt_dir)))\n            continue;\n\n        if (*(p - 1) != '/' && *p != '/' && *p != '\\0')\n            continue;\n\n        if (len > maxMatching) {\n            maxMatching = len;\n            VIR_FREE(mntType);\n            VIR_FREE(mntDir);\n            mntDir = g_strdup(mb.mnt_dir);\n            mntType = g_strdup(mb.mnt_type);\n        }\n    }\n\n    if (STREQ_NULLABLE(mntType, \"fuse.glusterfs\")) {\n        VIR_DEBUG(\"Found gluster FUSE mountpoint=%s for path=%s. \"\n                  \"Fixing shared FS type\", mntDir, canonPath);\n        *f_type = GFS2_MAGIC;\n    } else if (STREQ_NULLABLE(mntType, \"fuse.quobyte\")) {\n        VIR_DEBUG(\"Found Quobyte FUSE mountpoint=%s for path=%s. \"\n                  \"Fixing shared FS type\", mntDir, canonPath);\n        *f_type = QB_MAGIC;\n    }\n\n    ret = 0;\n cleanup:\n    VIR_FREE(canonPath);\n    VIR_FREE(mntType);\n    VIR_FREE(mntDir);\n    endmntent(f);\n    return ret;\n}"
  },
  {
    "function_name": "virFileRemoveLastComponent",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "3319-3328",
    "snippet": "void\nvirFileRemoveLastComponent(char *path)\n{\n    char *tmp;\n\n    if ((tmp = strrchr(path, G_DIR_SEPARATOR)))\n        tmp[1] = '\\0';\n    else\n        path[0] = '\\0';\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strrchr",
          "args": [
            "path",
            "G_DIR_SEPARATOR"
          ],
          "line": 3324
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nvoid\nvirFileRemoveLastComponent(char *path)\n{\n    char *tmp;\n\n    if ((tmp = strrchr(path, G_DIR_SEPARATOR)))\n        tmp[1] = '\\0';\n    else\n        path[0] = '\\0';\n}"
  },
  {
    "function_name": "virFileCanonicalizePath",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "3299-3310",
    "snippet": "char *\nvirFileCanonicalizePath(const char *path)\n{\n#ifdef WIN32\n    /* Does not resolve symlinks, only expands . & .. & repeated /.\n     * It will never fail, so sanitize errno to indicate success */\n    errno = 0;\n    return g_canonicalize_filename(path, NULL);\n#else\n    return realpath(path, NULL); /* exempt from syntax-check */\n#endif\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "realpath",
          "args": [
            "path",
            "NULL"
          ],
          "line": 3308
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_canonicalize_filename",
          "args": [
            "path",
            "NULL"
          ],
          "line": 3306
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_canonicalize_filename",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "72-173",
          "snippet": "gchar *\nvir_g_canonicalize_filename(const gchar *filename,\n                            const gchar *relative_to)\n{\n#if GLIB_CHECK_VERSION(2, 58, 0)\n    return g_canonicalize_filename(filename, relative_to);\n#else /* ! GLIB_CHECK_VERSION(2, 58, 0) */\n    gchar *canon, *start, *p, *q;\n    guint i;\n\n    g_return_val_if_fail(relative_to == NULL || g_path_is_absolute(relative_to), NULL);\n\n    if (!g_path_is_absolute(filename)) {\n        gchar *cwd_allocated = NULL;\n        const gchar  *cwd;\n\n        if (relative_to != NULL)\n            cwd = relative_to;\n        else\n            cwd = cwd_allocated = g_get_current_dir();\n\n        canon = g_build_filename(cwd, filename, NULL);\n        g_free(cwd_allocated);\n    } else {\n        canon = g_strdup(filename);\n    }\n\n    start = (char *)g_path_skip_root(canon);\n\n    if (start == NULL) {\n        /* This shouldn't really happen, as g_get_current_dir() should\n           return an absolute pathname, but bug 573843 shows this is\n           not always happening */\n        g_free(canon);\n        return g_build_filename(G_DIR_SEPARATOR_S, filename, NULL);\n    }\n\n    /* POSIX allows double slashes at the start to\n     * mean something special (as does windows too).\n     * So, \"//\" != \"/\", but more than two slashes\n     * is treated as \"/\".\n     */\n    i = 0;\n    for (p = start - 1;\n         (p >= canon) &&\n             G_IS_DIR_SEPARATOR(*p);\n         p--)\n        i++;\n    if (i > 2) {\n        i -= 1;\n        start -= i;\n        memmove(start, start+i, strlen(start+i) + 1);\n    }\n\n    /* Make sure we're using the canonical dir separator */\n    p++;\n    while (p < start && G_IS_DIR_SEPARATOR(*p))\n        *p++ = G_DIR_SEPARATOR;\n\n    p = start;\n    while (*p != 0) {\n        if (p[0] == '.' && (p[1] == 0 || G_IS_DIR_SEPARATOR(p[1]))) {\n            memmove(p, p+1, strlen(p+1)+1);\n        } else if (p[0] == '.' && p[1] == '.' &&\n                   (p[2] == 0 || G_IS_DIR_SEPARATOR(p[2]))) {\n            q = p + 2;\n            /* Skip previous separator */\n            p = p - 2;\n            if (p < start)\n                p = start;\n            while (p > start && !G_IS_DIR_SEPARATOR(*p))\n                p--;\n            if (G_IS_DIR_SEPARATOR(*p))\n                *p++ = G_DIR_SEPARATOR;\n            memmove(p, q, strlen(q)+1);\n        } else {\n            /* Skip until next separator */\n            while (*p != 0 && !G_IS_DIR_SEPARATOR(*p))\n                p++;\n\n            if (*p != 0) {\n                /* Canonicalize one separator */\n                *p++ = G_DIR_SEPARATOR;\n            }\n        }\n\n        /* Remove additional separators */\n        q = p;\n        while (*q && G_IS_DIR_SEPARATOR(*q))\n            q++;\n\n        if (p != q)\n            memmove(p, q, strlen(q) + 1);\n    }\n\n    /* Remove trailing slashes */\n    if (p > start && G_IS_DIR_SEPARATOR(*(p-1)))\n        *(p-1) = 0;\n\n    return canon;\n#endif /* ! GLIB_CHECK_VERSION(2, 58, 0) */\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\ngchar *\nvir_g_canonicalize_filename(const gchar *filename,\n                            const gchar *relative_to)\n{\n#if GLIB_CHECK_VERSION(2, 58, 0)\n    return g_canonicalize_filename(filename, relative_to);\n#else /* ! GLIB_CHECK_VERSION(2, 58, 0) */\n    gchar *canon, *start, *p, *q;\n    guint i;\n\n    g_return_val_if_fail(relative_to == NULL || g_path_is_absolute(relative_to), NULL);\n\n    if (!g_path_is_absolute(filename)) {\n        gchar *cwd_allocated = NULL;\n        const gchar  *cwd;\n\n        if (relative_to != NULL)\n            cwd = relative_to;\n        else\n            cwd = cwd_allocated = g_get_current_dir();\n\n        canon = g_build_filename(cwd, filename, NULL);\n        g_free(cwd_allocated);\n    } else {\n        canon = g_strdup(filename);\n    }\n\n    start = (char *)g_path_skip_root(canon);\n\n    if (start == NULL) {\n        /* This shouldn't really happen, as g_get_current_dir() should\n           return an absolute pathname, but bug 573843 shows this is\n           not always happening */\n        g_free(canon);\n        return g_build_filename(G_DIR_SEPARATOR_S, filename, NULL);\n    }\n\n    /* POSIX allows double slashes at the start to\n     * mean something special (as does windows too).\n     * So, \"//\" != \"/\", but more than two slashes\n     * is treated as \"/\".\n     */\n    i = 0;\n    for (p = start - 1;\n         (p >= canon) &&\n             G_IS_DIR_SEPARATOR(*p);\n         p--)\n        i++;\n    if (i > 2) {\n        i -= 1;\n        start -= i;\n        memmove(start, start+i, strlen(start+i) + 1);\n    }\n\n    /* Make sure we're using the canonical dir separator */\n    p++;\n    while (p < start && G_IS_DIR_SEPARATOR(*p))\n        *p++ = G_DIR_SEPARATOR;\n\n    p = start;\n    while (*p != 0) {\n        if (p[0] == '.' && (p[1] == 0 || G_IS_DIR_SEPARATOR(p[1]))) {\n            memmove(p, p+1, strlen(p+1)+1);\n        } else if (p[0] == '.' && p[1] == '.' &&\n                   (p[2] == 0 || G_IS_DIR_SEPARATOR(p[2]))) {\n            q = p + 2;\n            /* Skip previous separator */\n            p = p - 2;\n            if (p < start)\n                p = start;\n            while (p > start && !G_IS_DIR_SEPARATOR(*p))\n                p--;\n            if (G_IS_DIR_SEPARATOR(*p))\n                *p++ = G_DIR_SEPARATOR;\n            memmove(p, q, strlen(q)+1);\n        } else {\n            /* Skip until next separator */\n            while (*p != 0 && !G_IS_DIR_SEPARATOR(*p))\n                p++;\n\n            if (*p != 0) {\n                /* Canonicalize one separator */\n                *p++ = G_DIR_SEPARATOR;\n            }\n        }\n\n        /* Remove additional separators */\n        q = p;\n        while (*q && G_IS_DIR_SEPARATOR(*q))\n            q++;\n\n        if (p != q)\n            memmove(p, q, strlen(q) + 1);\n    }\n\n    /* Remove trailing slashes */\n    if (p > start && G_IS_DIR_SEPARATOR(*(p-1)))\n        *(p-1) = 0;\n\n    return canon;\n#endif /* ! GLIB_CHECK_VERSION(2, 58, 0) */\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nchar *\nvirFileCanonicalizePath(const char *path)\n{\n#ifdef WIN32\n    /* Does not resolve symlinks, only expands . & .. & repeated /.\n     * It will never fail, so sanitize errno to indicate success */\n    errno = 0;\n    return g_canonicalize_filename(path, NULL);\n#else\n    return realpath(path, NULL); /* exempt from syntax-check */\n#endif\n}"
  },
  {
    "function_name": "virFileSanitizePath",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "3242-3290",
    "snippet": "char *\nvirFileSanitizePath(const char *path)\n{\n    const char *cur = path;\n    char *uri;\n    char *cleanpath;\n    int idx = 0;\n\n    cleanpath = g_strdup(path);\n\n    /* don't sanitize URIs - rfc3986 states that two slashes may lead to a\n     * different resource, thus removing them would possibly change the path */\n    if ((uri = strstr(path, \"://\")) && strchr(path, '/') > uri)\n        return cleanpath;\n\n    /* Need to sanitize:\n     * //           -> //\n     * ///          -> /\n     * /../foo      -> /../foo\n     * /foo///bar/  -> /foo/bar\n     */\n\n    /* Starting with // is valid posix, but ///foo == /foo */\n    if (cur[0] == '/' && cur[1] == '/' && cur[2] != '/') {\n        idx = 2;\n        cur += 2;\n    }\n\n    /* Sanitize path in place */\n    while (*cur != '\\0') {\n        if (*cur != '/') {\n            cleanpath[idx++] = *cur++;\n            continue;\n        }\n\n        /* Skip all extra / */\n        while (*++cur == '/')\n            continue;\n\n        /* Don't add a trailing / */\n        if (idx != 0 && *cur == '\\0')\n            break;\n\n        cleanpath[idx++] = '/';\n    }\n    cleanpath[idx] = '\\0';\n\n    return cleanpath;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "path",
            "'/'"
          ],
          "line": 3254
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "path",
            "\"://\""
          ],
          "line": 3254
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "path"
          ],
          "line": 3250
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nchar *\nvirFileSanitizePath(const char *path)\n{\n    const char *cur = path;\n    char *uri;\n    char *cleanpath;\n    int idx = 0;\n\n    cleanpath = g_strdup(path);\n\n    /* don't sanitize URIs - rfc3986 states that two slashes may lead to a\n     * different resource, thus removing them would possibly change the path */\n    if ((uri = strstr(path, \"://\")) && strchr(path, '/') > uri)\n        return cleanpath;\n\n    /* Need to sanitize:\n     * //           -> //\n     * ///          -> /\n     * /../foo      -> /../foo\n     * /foo///bar/  -> /foo/bar\n     */\n\n    /* Starting with // is valid posix, but ///foo == /foo */\n    if (cur[0] == '/' && cur[1] == '/' && cur[2] != '/') {\n        idx = 2;\n        cur += 2;\n    }\n\n    /* Sanitize path in place */\n    while (*cur != '\\0') {\n        if (*cur != '/') {\n            cleanpath[idx++] = *cur++;\n            continue;\n        }\n\n        /* Skip all extra / */\n        while (*++cur == '/')\n            continue;\n\n        /* Don't add a trailing / */\n        if (idx != 0 && *cur == '\\0')\n            break;\n\n        cleanpath[idx++] = '/';\n    }\n    cleanpath[idx] = '\\0';\n\n    return cleanpath;\n}"
  },
  {
    "function_name": "virFileAbsPath",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "3227-3239",
    "snippet": "int\nvirFileAbsPath(const char *path, char **abspath)\n{\n    if (path[0] == '/') {\n        *abspath = g_strdup(path);\n    } else {\n        g_autofree char *buf = g_get_current_dir();\n\n        *abspath = g_strdup_printf(\"%s/%s\", buf, path);\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"%s/%s\"",
            "buf",
            "path"
          ],
          "line": 3235
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_get_current_dir",
          "args": [],
          "line": 3233
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileAbsPath(const char *path, char **abspath)\n{\n    if (path[0] == '/') {\n        *abspath = g_strdup(path);\n    } else {\n        g_autofree char *buf = g_get_current_dir();\n\n        *abspath = g_strdup_printf(\"%s/%s\", buf, path);\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virFileOpenTty",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "3209-3217",
    "snippet": "int\nvirFileOpenTty(int *ttymaster G_GNUC_UNUSED,\n               char **ttyName G_GNUC_UNUSED,\n               int rawmode G_GNUC_UNUSED)\n{\n    /* mingw completely lacks pseudo-terminals */\n    errno = ENOSYS;\n    return -1;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileOpenTty(int *ttymaster G_GNUC_UNUSED,\n               char **ttyName G_GNUC_UNUSED,\n               int rawmode G_GNUC_UNUSED)\n{\n    /* mingw completely lacks pseudo-terminals */\n    errno = ENOSYS;\n    return -1;\n}"
  },
  {
    "function_name": "virFileOpenTty",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "3134-3207",
    "snippet": "int\nvirFileOpenTty(int *ttymaster, char **ttyName, int rawmode)\n{\n    /* XXX A word of caution - on some platforms (Solaris and HP-UX),\n     * additional ioctl() calls are needs after opening the slave\n     * before it will cause isatty() to return true.  Should we make\n     * virFileOpenTty also return the opened slave fd, so the caller\n     * doesn't have to worry about that mess?  */\n    int ret = -1;\n    int slave = -1;\n    g_autofree char *name = NULL;\n\n    /* Unfortunately, we can't use the name argument of openpty, since\n     * there is no guarantee on how large the buffer has to be.\n     * Likewise, we can't use the termios argument: we have to use\n     * read-modify-write since there is no portable way to initialize\n     * a struct termios without use of tcgetattr.  */\n    if (openpty(ttymaster, &slave, NULL, NULL, NULL) < 0)\n        return -1;\n\n    /* What a shame that openpty cannot atomically set FD_CLOEXEC, but\n     * that using posix_openpt/grantpt/unlockpt/ptsname is not\n     * thread-safe, and that ptsname_r is not portable.  */\n    if (virSetNonBlock(*ttymaster) < 0 ||\n        virSetCloseExec(*ttymaster) < 0)\n        goto cleanup;\n\n    /* While Linux supports tcgetattr on either the master or the\n     * slave, Solaris requires it to be on the slave.  */\n    if (rawmode) {\n        struct termios ttyAttr;\n        if (tcgetattr(slave, &ttyAttr) < 0)\n            goto cleanup;\n\n        cfmakeraw(&ttyAttr);\n\n        if (tcsetattr(slave, TCSADRAIN, &ttyAttr) < 0)\n            goto cleanup;\n    }\n\n    /* ttyname_r on the slave is required by POSIX, while ptsname_r on\n     * the master is a glibc extension, and the POSIX ptsname is not\n     * thread-safe.  Since openpty gave us both descriptors, guess\n     * which way we will determine the name?  :)  */\n    if (ttyName) {\n        /* Initial guess of 64 is generally sufficient; rely on ERANGE\n         * to tell us if we need to grow.  */\n        size_t len = 64;\n        int rc;\n\n        if (VIR_ALLOC_N(name, len) < 0)\n            goto cleanup;\n\n        while ((rc = ttyname_r(slave, name, len)) == ERANGE) {\n            if (VIR_RESIZE_N(name, len, len, len) < 0)\n                goto cleanup;\n        }\n        if (rc != 0) {\n            errno = rc;\n            goto cleanup;\n        }\n        *ttyName = name;\n        name = NULL;\n    }\n\n    ret = 0;\n\n cleanup:\n    if (ret != 0)\n        VIR_FORCE_CLOSE(*ttymaster);\n    VIR_FORCE_CLOSE(slave);\n\n    return ret;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FORCE_CLOSE",
          "args": [
            "slave"
          ],
          "line": 3204
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FORCE_CLOSE",
          "args": [
            "*ttymaster"
          ],
          "line": 3203
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_RESIZE_N",
          "args": [
            "name",
            "len",
            "len",
            "len"
          ],
          "line": 3188
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ttyname_r",
          "args": [
            "slave",
            "name",
            "len"
          ],
          "line": 3187
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC_N",
          "args": [
            "name",
            "len"
          ],
          "line": 3184
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tcsetattr",
          "args": [
            "slave",
            "TCSADRAIN",
            "&ttyAttr"
          ],
          "line": 3170
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cfmakeraw",
          "args": [
            "&ttyAttr"
          ],
          "line": 3168
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tcgetattr",
          "args": [
            "slave",
            "&ttyAttr"
          ],
          "line": 3165
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virSetCloseExec",
          "args": [
            "*ttymaster"
          ],
          "line": 3158
        },
        "resolved": true,
        "details": {
          "function_name": "virSetCloseExec",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
          "lines": "131-134",
          "snippet": "int virSetCloseExec(int fd)\n{\n    return virSetInherit(fd, false);\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <sys/prctl.h>",
            "# include <cap-ng.h>",
            "# include <grp.h>",
            "# include <pwd.h>",
            "# include <libdevmapper.h>",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <conio.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nint virSetCloseExec(int fd)\n{\n    return virSetInherit(fd, false);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSetNonBlock",
          "args": [
            "*ttymaster"
          ],
          "line": 3157
        },
        "resolved": true,
        "details": {
          "function_name": "virSetNonBlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
          "lines": "126-129",
          "snippet": "int virSetNonBlock(int fd)\n{\n    return virSetBlocking(fd, false);\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <sys/prctl.h>",
            "# include <cap-ng.h>",
            "# include <grp.h>",
            "# include <pwd.h>",
            "# include <libdevmapper.h>",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <conio.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nint virSetNonBlock(int fd)\n{\n    return virSetBlocking(fd, false);\n}"
        }
      },
      {
        "call_info": {
          "callee": "openpty",
          "args": [
            "ttymaster",
            "&slave",
            "NULL",
            "NULL",
            "NULL"
          ],
          "line": 3151
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileOpenTty(int *ttymaster, char **ttyName, int rawmode)\n{\n    /* XXX A word of caution - on some platforms (Solaris and HP-UX),\n     * additional ioctl() calls are needs after opening the slave\n     * before it will cause isatty() to return true.  Should we make\n     * virFileOpenTty also return the opened slave fd, so the caller\n     * doesn't have to worry about that mess?  */\n    int ret = -1;\n    int slave = -1;\n    g_autofree char *name = NULL;\n\n    /* Unfortunately, we can't use the name argument of openpty, since\n     * there is no guarantee on how large the buffer has to be.\n     * Likewise, we can't use the termios argument: we have to use\n     * read-modify-write since there is no portable way to initialize\n     * a struct termios without use of tcgetattr.  */\n    if (openpty(ttymaster, &slave, NULL, NULL, NULL) < 0)\n        return -1;\n\n    /* What a shame that openpty cannot atomically set FD_CLOEXEC, but\n     * that using posix_openpt/grantpt/unlockpt/ptsname is not\n     * thread-safe, and that ptsname_r is not portable.  */\n    if (virSetNonBlock(*ttymaster) < 0 ||\n        virSetCloseExec(*ttymaster) < 0)\n        goto cleanup;\n\n    /* While Linux supports tcgetattr on either the master or the\n     * slave, Solaris requires it to be on the slave.  */\n    if (rawmode) {\n        struct termios ttyAttr;\n        if (tcgetattr(slave, &ttyAttr) < 0)\n            goto cleanup;\n\n        cfmakeraw(&ttyAttr);\n\n        if (tcsetattr(slave, TCSADRAIN, &ttyAttr) < 0)\n            goto cleanup;\n    }\n\n    /* ttyname_r on the slave is required by POSIX, while ptsname_r on\n     * the master is a glibc extension, and the POSIX ptsname is not\n     * thread-safe.  Since openpty gave us both descriptors, guess\n     * which way we will determine the name?  :)  */\n    if (ttyName) {\n        /* Initial guess of 64 is generally sufficient; rely on ERANGE\n         * to tell us if we need to grow.  */\n        size_t len = 64;\n        int rc;\n\n        if (VIR_ALLOC_N(name, len) < 0)\n            goto cleanup;\n\n        while ((rc = ttyname_r(slave, name, len)) == ERANGE) {\n            if (VIR_RESIZE_N(name, len, len, len) < 0)\n                goto cleanup;\n        }\n        if (rc != 0) {\n            errno = rc;\n            goto cleanup;\n        }\n        *ttyName = name;\n        name = NULL;\n    }\n\n    ret = 0;\n\n cleanup:\n    if (ret != 0)\n        VIR_FORCE_CLOSE(*ttymaster);\n    VIR_FORCE_CLOSE(slave);\n\n    return ret;\n}"
  },
  {
    "function_name": "virFileBuildPath",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "3116-3128",
    "snippet": "char *\nvirFileBuildPath(const char *dir, const char *name, const char *ext)\n{\n    char *path;\n\n    if (ext == NULL) {\n        path = g_strdup_printf(\"%s/%s\", dir, name);\n    } else {\n        path = g_strdup_printf(\"%s/%s%s\", dir, name, ext);\n    }\n\n    return path;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"%s/%s%s\"",
            "dir",
            "name",
            "ext"
          ],
          "line": 3124
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nchar *\nvirFileBuildPath(const char *dir, const char *name, const char *ext)\n{\n    char *path;\n\n    if (ext == NULL) {\n        path = g_strdup_printf(\"%s/%s\", dir, name);\n    } else {\n        path = g_strdup_printf(\"%s/%s%s\", dir, name, ext);\n    }\n\n    return path;\n}"
  },
  {
    "function_name": "virFileMakeParentPath",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "3094-3111",
    "snippet": "int\nvirFileMakeParentPath(const char *path)\n{\n    char *p;\n    g_autofree char *tmp = NULL;\n\n    VIR_DEBUG(\"path=%s\", path);\n\n    tmp = g_strdup(path);\n\n    if ((p = strrchr(tmp, '/')) == NULL) {\n        errno = EINVAL;\n        return -1;\n    }\n    *p = '\\0';\n\n    return virFileMakePathHelper(tmp, 0777);\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virFileMakePathHelper",
          "args": [
            "tmp",
            "0777"
          ],
          "line": 3110
        },
        "resolved": true,
        "details": {
          "function_name": "virFileMakePathHelper",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "3031-3068",
          "snippet": "static int\nvirFileMakePathHelper(char *path, mode_t mode)\n{\n    struct stat st;\n    char *p;\n\n    VIR_DEBUG(\"path=%s mode=0%o\", path, mode);\n\n    if (stat(path, &st) >= 0) {\n        if (S_ISDIR(st.st_mode))\n            return 0;\n\n        errno = ENOTDIR;\n        return -1;\n    }\n\n    if (errno != ENOENT)\n        return -1;\n\n    if ((p = strrchr(path, '/')) == NULL) {\n        errno = EINVAL;\n        return -1;\n    }\n\n    if (p != path) {\n        *p = '\\0';\n\n        if (virFileMakePathHelper(path, mode) < 0)\n            return -1;\n\n        *p = '/';\n    }\n\n    if (g_mkdir(path, mode) < 0 && errno != EEXIST)\n        return -1;\n\n    return 0;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nvirFileMakePathHelper(char *path, mode_t mode)\n{\n    struct stat st;\n    char *p;\n\n    VIR_DEBUG(\"path=%s mode=0%o\", path, mode);\n\n    if (stat(path, &st) >= 0) {\n        if (S_ISDIR(st.st_mode))\n            return 0;\n\n        errno = ENOTDIR;\n        return -1;\n    }\n\n    if (errno != ENOENT)\n        return -1;\n\n    if ((p = strrchr(path, '/')) == NULL) {\n        errno = EINVAL;\n        return -1;\n    }\n\n    if (p != path) {\n        *p = '\\0';\n\n        if (virFileMakePathHelper(path, mode) < 0)\n            return -1;\n\n        *p = '/';\n    }\n\n    if (g_mkdir(path, mode) < 0 && errno != EEXIST)\n        return -1;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strrchr",
          "args": [
            "tmp",
            "'/'"
          ],
          "line": 3104
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "path"
          ],
          "line": 3102
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"path=%s\"",
            "path"
          ],
          "line": 3100
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileMakeParentPath(const char *path)\n{\n    char *p;\n    g_autofree char *tmp = NULL;\n\n    VIR_DEBUG(\"path=%s\", path);\n\n    tmp = g_strdup(path);\n\n    if ((p = strrchr(tmp, '/')) == NULL) {\n        errno = EINVAL;\n        return -1;\n    }\n    *p = '\\0';\n\n    return virFileMakePathHelper(tmp, 0777);\n}"
  },
  {
    "function_name": "virFileMakePathWithMode",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "3082-3091",
    "snippet": "int\nvirFileMakePathWithMode(const char *path,\n                        mode_t mode)\n{\n    g_autofree char *tmp = NULL;\n\n    tmp = g_strdup(path);\n\n    return virFileMakePathHelper(tmp, mode);\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virFileMakePathHelper",
          "args": [
            "tmp",
            "mode"
          ],
          "line": 3090
        },
        "resolved": true,
        "details": {
          "function_name": "virFileMakePathHelper",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "3031-3068",
          "snippet": "static int\nvirFileMakePathHelper(char *path, mode_t mode)\n{\n    struct stat st;\n    char *p;\n\n    VIR_DEBUG(\"path=%s mode=0%o\", path, mode);\n\n    if (stat(path, &st) >= 0) {\n        if (S_ISDIR(st.st_mode))\n            return 0;\n\n        errno = ENOTDIR;\n        return -1;\n    }\n\n    if (errno != ENOENT)\n        return -1;\n\n    if ((p = strrchr(path, '/')) == NULL) {\n        errno = EINVAL;\n        return -1;\n    }\n\n    if (p != path) {\n        *p = '\\0';\n\n        if (virFileMakePathHelper(path, mode) < 0)\n            return -1;\n\n        *p = '/';\n    }\n\n    if (g_mkdir(path, mode) < 0 && errno != EEXIST)\n        return -1;\n\n    return 0;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nvirFileMakePathHelper(char *path, mode_t mode)\n{\n    struct stat st;\n    char *p;\n\n    VIR_DEBUG(\"path=%s mode=0%o\", path, mode);\n\n    if (stat(path, &st) >= 0) {\n        if (S_ISDIR(st.st_mode))\n            return 0;\n\n        errno = ENOTDIR;\n        return -1;\n    }\n\n    if (errno != ENOENT)\n        return -1;\n\n    if ((p = strrchr(path, '/')) == NULL) {\n        errno = EINVAL;\n        return -1;\n    }\n\n    if (p != path) {\n        *p = '\\0';\n\n        if (virFileMakePathHelper(path, mode) < 0)\n            return -1;\n\n        *p = '/';\n    }\n\n    if (g_mkdir(path, mode) < 0 && errno != EEXIST)\n        return -1;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "path"
          ],
          "line": 3088
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileMakePathWithMode(const char *path,\n                        mode_t mode)\n{\n    g_autofree char *tmp = NULL;\n\n    tmp = g_strdup(path);\n\n    return virFileMakePathHelper(tmp, mode);\n}"
  },
  {
    "function_name": "virFileMakePath",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "3076-3080",
    "snippet": "int\nvirFileMakePath(const char *path)\n{\n    return virFileMakePathWithMode(path, 0777);\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virFileMakePathWithMode",
          "args": [
            "path",
            "0777"
          ],
          "line": 3079
        },
        "resolved": true,
        "details": {
          "function_name": "virFileMakePathWithMode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "3082-3091",
          "snippet": "int\nvirFileMakePathWithMode(const char *path,\n                        mode_t mode)\n{\n    g_autofree char *tmp = NULL;\n\n    tmp = g_strdup(path);\n\n    return virFileMakePathHelper(tmp, mode);\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileMakePathWithMode(const char *path,\n                        mode_t mode)\n{\n    g_autofree char *tmp = NULL;\n\n    tmp = g_strdup(path);\n\n    return virFileMakePathHelper(tmp, mode);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileMakePath(const char *path)\n{\n    return virFileMakePathWithMode(path, 0777);\n}"
  },
  {
    "function_name": "virFileMakePathHelper",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "3031-3068",
    "snippet": "static int\nvirFileMakePathHelper(char *path, mode_t mode)\n{\n    struct stat st;\n    char *p;\n\n    VIR_DEBUG(\"path=%s mode=0%o\", path, mode);\n\n    if (stat(path, &st) >= 0) {\n        if (S_ISDIR(st.st_mode))\n            return 0;\n\n        errno = ENOTDIR;\n        return -1;\n    }\n\n    if (errno != ENOENT)\n        return -1;\n\n    if ((p = strrchr(path, '/')) == NULL) {\n        errno = EINVAL;\n        return -1;\n    }\n\n    if (p != path) {\n        *p = '\\0';\n\n        if (virFileMakePathHelper(path, mode) < 0)\n            return -1;\n\n        *p = '/';\n    }\n\n    if (g_mkdir(path, mode) < 0 && errno != EEXIST)\n        return -1;\n\n    return 0;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_mkdir",
          "args": [
            "path",
            "mode"
          ],
          "line": 3064
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virFileMakePathHelper",
          "args": [
            "path",
            "mode"
          ],
          "line": 3058
        },
        "resolved": true,
        "details": {
          "function_name": "virFileMakePathHelper",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "3031-3068",
          "snippet": "static int\nvirFileMakePathHelper(char *path, mode_t mode)\n{\n    struct stat st;\n    char *p;\n\n    VIR_DEBUG(\"path=%s mode=0%o\", path, mode);\n\n    if (stat(path, &st) >= 0) {\n        if (S_ISDIR(st.st_mode))\n            return 0;\n\n        errno = ENOTDIR;\n        return -1;\n    }\n\n    if (errno != ENOENT)\n        return -1;\n\n    if ((p = strrchr(path, '/')) == NULL) {\n        errno = EINVAL;\n        return -1;\n    }\n\n    if (p != path) {\n        *p = '\\0';\n\n        if (virFileMakePathHelper(path, mode) < 0)\n            return -1;\n\n        *p = '/';\n    }\n\n    if (g_mkdir(path, mode) < 0 && errno != EEXIST)\n        return -1;\n\n    return 0;\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "strrchr",
          "args": [
            "path",
            "'/'"
          ],
          "line": 3050
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "S_ISDIR",
          "args": [
            "st.st_mode"
          ],
          "line": 3040
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "stat",
          "args": [
            "path",
            "&st"
          ],
          "line": 3039
        },
        "resolved": true,
        "details": {
          "function_name": "profile_status",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_apparmor.c",
          "lines": "70-108",
          "snippet": "static int\nprofile_status(const char *str, const int check_enforcing)\n{\n    char *content = NULL;\n    char *tmp = NULL;\n    char *etmp = NULL;\n    int rc = -2;\n\n    /* create string that is '<str> \\0' for accurate matching */\n    tmp = g_strdup_printf(\"%s \", str);\n\n    if (check_enforcing != 0) {\n        /* create string that is '<str> (enforce)\\0' for accurate matching */\n        etmp = g_strdup_printf(\"%s (enforce)\", str);\n    }\n\n    if (virFileReadAll(APPARMOR_PROFILES_PATH, MAX_FILE_LEN, &content) < 0) {\n        virReportSystemError(errno,\n                             _(\"Failed to read AppArmor profiles list \"\n                             \"\\'%s\\'\"), APPARMOR_PROFILES_PATH);\n        goto cleanup;\n    }\n\n    if (strstr(content, tmp) != NULL)\n        rc = 0;\n    else\n        rc = -1; /* return -1 if not loaded */\n    if (check_enforcing != 0) {\n        if (rc == 0 && strstr(content, etmp) != NULL)\n            rc = 1;                 /* return '1' if loaded and enforcing */\n    }\n\n    VIR_FREE(content);\n cleanup:\n    VIR_FREE(tmp);\n    VIR_FREE(etmp);\n\n    return rc;\n}",
          "includes": [
            "#include \"virmdev.h\"",
            "#include \"virscsi.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"vircommand.h\"",
            "#include \"configmake.h\"",
            "#include \"virfile.h\"",
            "#include \"virscsivhost.h\"",
            "#include \"virusb.h\"",
            "#include \"virpci.h\"",
            "#include \"viruuid.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"security_apparmor.h\"",
            "#include \"internal.h\"",
            "#include <wait.h>",
            "#include <unistd.h>",
            "#include <sys/apparmor.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virmdev.h\"\n#include \"virscsi.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"configmake.h\"\n#include \"virfile.h\"\n#include \"virscsivhost.h\"\n#include \"virusb.h\"\n#include \"virpci.h\"\n#include \"viruuid.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"security_apparmor.h\"\n#include \"internal.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/apparmor.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nprofile_status(const char *str, const int check_enforcing)\n{\n    char *content = NULL;\n    char *tmp = NULL;\n    char *etmp = NULL;\n    int rc = -2;\n\n    /* create string that is '<str> \\0' for accurate matching */\n    tmp = g_strdup_printf(\"%s \", str);\n\n    if (check_enforcing != 0) {\n        /* create string that is '<str> (enforce)\\0' for accurate matching */\n        etmp = g_strdup_printf(\"%s (enforce)\", str);\n    }\n\n    if (virFileReadAll(APPARMOR_PROFILES_PATH, MAX_FILE_LEN, &content) < 0) {\n        virReportSystemError(errno,\n                             _(\"Failed to read AppArmor profiles list \"\n                             \"\\'%s\\'\"), APPARMOR_PROFILES_PATH);\n        goto cleanup;\n    }\n\n    if (strstr(content, tmp) != NULL)\n        rc = 0;\n    else\n        rc = -1; /* return -1 if not loaded */\n    if (check_enforcing != 0) {\n        if (rc == 0 && strstr(content, etmp) != NULL)\n            rc = 1;                 /* return '1' if loaded and enforcing */\n    }\n\n    VIR_FREE(content);\n cleanup:\n    VIR_FREE(tmp);\n    VIR_FREE(etmp);\n\n    return rc;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"path=%s mode=0%o\"",
            "path",
            "mode"
          ],
          "line": 3037
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nvirFileMakePathHelper(char *path, mode_t mode)\n{\n    struct stat st;\n    char *p;\n\n    VIR_DEBUG(\"path=%s mode=0%o\", path, mode);\n\n    if (stat(path, &st) >= 0) {\n        if (S_ISDIR(st.st_mode))\n            return 0;\n\n        errno = ENOTDIR;\n        return -1;\n    }\n\n    if (errno != ENOENT)\n        return -1;\n\n    if ((p = strrchr(path, '/')) == NULL) {\n        errno = EINVAL;\n        return -1;\n    }\n\n    if (p != path) {\n        *p = '\\0';\n\n        if (virFileMakePathHelper(path, mode) < 0)\n            return -1;\n\n        *p = '/';\n    }\n\n    if (g_mkdir(path, mode) < 0 && errno != EEXIST)\n        return -1;\n\n    return 0;\n}"
  },
  {
    "function_name": "virFileChownFiles",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "3019-3028",
    "snippet": "int virFileChownFiles(const char *name,\n                      uid_t uid,\n                      gid_t gid)\n{\n    virReportSystemError(ENOSYS,\n                         _(\"cannot chown '%s' to (%u, %u)\"),\n                         name, (unsigned int) uid,\n                         (unsigned int) gid);\n    return -1;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "_(\"cannot chown '%s' to (%u, %u)\")",
            "name",
            "(unsigned int) uid",
            "(unsigned int) gid"
          ],
          "line": 3023
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"cannot chown '%s' to (%u, %u)\""
          ],
          "line": 3024
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint virFileChownFiles(const char *name,\n                      uid_t uid,\n                      gid_t gid)\n{\n    virReportSystemError(ENOSYS,\n                         _(\"cannot chown '%s' to (%u, %u)\"),\n                         name, (unsigned int) uid,\n                         (unsigned int) gid);\n    return -1;\n}"
  },
  {
    "function_name": "virFileChownFiles",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "2977-3015",
    "snippet": "int virFileChownFiles(const char *name,\n                      uid_t uid,\n                      gid_t gid)\n{\n    struct dirent *ent;\n    int ret = -1;\n    int direrr;\n    DIR *dir;\n\n    if (virDirOpen(&dir, name) < 0)\n        return -1;\n\n    while ((direrr = virDirRead(dir, &ent, name)) > 0) {\n        g_autofree char *path = NULL;\n\n        path = g_strdup_printf(\"%s/%s\", name, ent->d_name);\n\n        if (!virFileIsRegular(path))\n            continue;\n\n        if (chown(path, uid, gid) < 0) {\n            virReportSystemError(errno,\n                                 _(\"cannot chown '%s' to (%u, %u)\"),\n                                 ent->d_name, (unsigned int) uid,\n                                 (unsigned int) gid);\n            goto cleanup;\n        }\n    }\n\n    if (direrr < 0)\n        goto cleanup;\n\n    ret = 0;\n\n cleanup:\n    virDirClose(&dir);\n\n    return ret;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDirClose",
          "args": [
            "&dir"
          ],
          "line": 3012
        },
        "resolved": true,
        "details": {
          "function_name": "virDirClose",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "2956-2963",
          "snippet": "void virDirClose(DIR **dirp)\n{\n    if (!*dirp)\n        return;\n\n    closedir(*dirp); /* exempt from syntax-check */\n    *dirp = NULL;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nvoid virDirClose(DIR **dirp)\n{\n    if (!*dirp)\n        return;\n\n    closedir(*dirp); /* exempt from syntax-check */\n    *dirp = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"cannot chown '%s' to (%u, %u)\")",
            "ent->d_name",
            "(unsigned int) uid",
            "(unsigned int) gid"
          ],
          "line": 2998
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"cannot chown '%s' to (%u, %u)\""
          ],
          "line": 2999
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "chown",
          "args": [
            "path",
            "uid",
            "gid"
          ],
          "line": 2997
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virFileIsRegular",
          "args": [
            "path"
          ],
          "line": 2994
        },
        "resolved": true,
        "details": {
          "function_name": "virFileIsRegular",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1858-1863",
          "snippet": "bool\nvirFileIsRegular(const char *path)\n{\n    struct stat s;\n    return (stat(path, &s) == 0) && S_ISREG(s.st_mode);\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nbool\nvirFileIsRegular(const char *path)\n{\n    struct stat s;\n    return (stat(path, &s) == 0) && S_ISREG(s.st_mode);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDirRead",
          "args": [
            "dir",
            "&ent",
            "name"
          ],
          "line": 2989
        },
        "resolved": true,
        "details": {
          "function_name": "virDirRead",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "2940-2954",
          "snippet": "int virDirRead(DIR *dirp, struct dirent **ent, const char *name)\n{\n    do {\n        errno = 0;\n        *ent = readdir(dirp); /* exempt from syntax-check */\n        if (!*ent && errno) {\n            if (name)\n                virReportSystemError(errno, _(\"Unable to read directory '%s'\"),\n                                     name);\n            return -1;\n        }\n    } while (*ent && (STREQ((*ent)->d_name, \".\") ||\n                      STREQ((*ent)->d_name, \"..\")));\n    return !!*ent;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint virDirRead(DIR *dirp, struct dirent **ent, const char *name)\n{\n    do {\n        errno = 0;\n        *ent = readdir(dirp); /* exempt from syntax-check */\n        if (!*ent && errno) {\n            if (name)\n                virReportSystemError(errno, _(\"Unable to read directory '%s'\"),\n                                     name);\n            return -1;\n        }\n    } while (*ent && (STREQ((*ent)->d_name, \".\") ||\n                      STREQ((*ent)->d_name, \"..\")));\n    return !!*ent;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDirOpen",
          "args": [
            "&dir",
            "name"
          ],
          "line": 2986
        },
        "resolved": true,
        "details": {
          "function_name": "virDirOpenQuiet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "2914-2918",
          "snippet": "int\nvirDirOpenQuiet(DIR **dirp, const char *name)\n{\n    return virDirOpenInternal(dirp, name, false, true);\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirDirOpenQuiet(DIR **dirp, const char *name)\n{\n    return virDirOpenInternal(dirp, name, false, true);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint virFileChownFiles(const char *name,\n                      uid_t uid,\n                      gid_t gid)\n{\n    struct dirent *ent;\n    int ret = -1;\n    int direrr;\n    DIR *dir;\n\n    if (virDirOpen(&dir, name) < 0)\n        return -1;\n\n    while ((direrr = virDirRead(dir, &ent, name)) > 0) {\n        g_autofree char *path = NULL;\n\n        path = g_strdup_printf(\"%s/%s\", name, ent->d_name);\n\n        if (!virFileIsRegular(path))\n            continue;\n\n        if (chown(path, uid, gid) < 0) {\n            virReportSystemError(errno,\n                                 _(\"cannot chown '%s' to (%u, %u)\"),\n                                 ent->d_name, (unsigned int) uid,\n                                 (unsigned int) gid);\n            goto cleanup;\n        }\n    }\n\n    if (direrr < 0)\n        goto cleanup;\n\n    ret = 0;\n\n cleanup:\n    virDirClose(&dir);\n\n    return ret;\n}"
  },
  {
    "function_name": "virDirClose",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "2956-2963",
    "snippet": "void virDirClose(DIR **dirp)\n{\n    if (!*dirp)\n        return;\n\n    closedir(*dirp); /* exempt from syntax-check */\n    *dirp = NULL;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "closedir",
          "args": [
            "*dirp"
          ],
          "line": 2961
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nvoid virDirClose(DIR **dirp)\n{\n    if (!*dirp)\n        return;\n\n    closedir(*dirp); /* exempt from syntax-check */\n    *dirp = NULL;\n}"
  },
  {
    "function_name": "virDirRead",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "2940-2954",
    "snippet": "int virDirRead(DIR *dirp, struct dirent **ent, const char *name)\n{\n    do {\n        errno = 0;\n        *ent = readdir(dirp); /* exempt from syntax-check */\n        if (!*ent && errno) {\n            if (name)\n                virReportSystemError(errno, _(\"Unable to read directory '%s'\"),\n                                     name);\n            return -1;\n        }\n    } while (*ent && (STREQ((*ent)->d_name, \".\") ||\n                      STREQ((*ent)->d_name, \"..\")));\n    return !!*ent;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "(*ent)->d_name",
            "\"..\""
          ],
          "line": 2952
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "(*ent)->d_name",
            "\".\""
          ],
          "line": 2951
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"Unable to read directory '%s'\")",
            "name"
          ],
          "line": 2947
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to read directory '%s'\""
          ],
          "line": 2947
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "readdir",
          "args": [
            "dirp"
          ],
          "line": 2944
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint virDirRead(DIR *dirp, struct dirent **ent, const char *name)\n{\n    do {\n        errno = 0;\n        *ent = readdir(dirp); /* exempt from syntax-check */\n        if (!*ent && errno) {\n            if (name)\n                virReportSystemError(errno, _(\"Unable to read directory '%s'\"),\n                                     name);\n            return -1;\n        }\n    } while (*ent && (STREQ((*ent)->d_name, \".\") ||\n                      STREQ((*ent)->d_name, \"..\")));\n    return !!*ent;\n}"
  },
  {
    "function_name": "virDirOpenQuiet",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "2914-2918",
    "snippet": "int\nvirDirOpenQuiet(DIR **dirp, const char *name)\n{\n    return virDirOpenInternal(dirp, name, false, true);\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDirOpenInternal",
          "args": [
            "dirp",
            "name",
            "false",
            "true"
          ],
          "line": 2917
        },
        "resolved": true,
        "details": {
          "function_name": "virDirOpenInternal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "2859-2873",
          "snippet": "static int\nvirDirOpenInternal(DIR **dirp, const char *name, bool ignoreENOENT, bool quiet)\n{\n    *dirp = opendir(name); /* exempt from syntax-check */\n    if (!*dirp) {\n        if (quiet)\n            return -1;\n\n        if (ignoreENOENT && errno == ENOENT)\n            return 0;\n        virReportSystemError(errno, _(\"cannot open directory '%s'\"), name);\n        return -1;\n    }\n    return 1;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nvirDirOpenInternal(DIR **dirp, const char *name, bool ignoreENOENT, bool quiet)\n{\n    *dirp = opendir(name); /* exempt from syntax-check */\n    if (!*dirp) {\n        if (quiet)\n            return -1;\n\n        if (ignoreENOENT && errno == ENOENT)\n            return 0;\n        virReportSystemError(errno, _(\"cannot open directory '%s'\"), name);\n        return -1;\n    }\n    return 1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirDirOpenQuiet(DIR **dirp, const char *name)\n{\n    return virDirOpenInternal(dirp, name, false, true);\n}"
  },
  {
    "function_name": "virDirOpenIfExists",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "2898-2902",
    "snippet": "int\nvirDirOpenIfExists(DIR **dirp, const char *name)\n{\n    return virDirOpenInternal(dirp, name, true, false);\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDirOpenInternal",
          "args": [
            "dirp",
            "name",
            "true",
            "false"
          ],
          "line": 2901
        },
        "resolved": true,
        "details": {
          "function_name": "virDirOpenInternal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "2859-2873",
          "snippet": "static int\nvirDirOpenInternal(DIR **dirp, const char *name, bool ignoreENOENT, bool quiet)\n{\n    *dirp = opendir(name); /* exempt from syntax-check */\n    if (!*dirp) {\n        if (quiet)\n            return -1;\n\n        if (ignoreENOENT && errno == ENOENT)\n            return 0;\n        virReportSystemError(errno, _(\"cannot open directory '%s'\"), name);\n        return -1;\n    }\n    return 1;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nvirDirOpenInternal(DIR **dirp, const char *name, bool ignoreENOENT, bool quiet)\n{\n    *dirp = opendir(name); /* exempt from syntax-check */\n    if (!*dirp) {\n        if (quiet)\n            return -1;\n\n        if (ignoreENOENT && errno == ENOENT)\n            return 0;\n        virReportSystemError(errno, _(\"cannot open directory '%s'\"), name);\n        return -1;\n    }\n    return 1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirDirOpenIfExists(DIR **dirp, const char *name)\n{\n    return virDirOpenInternal(dirp, name, true, false);\n}"
  },
  {
    "function_name": "virDirOpen",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "2883-2887",
    "snippet": "int\nvirDirOpen(DIR **dirp, const char *name)\n{\n    return virDirOpenInternal(dirp, name, false, false);\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDirOpenInternal",
          "args": [
            "dirp",
            "name",
            "false",
            "false"
          ],
          "line": 2886
        },
        "resolved": true,
        "details": {
          "function_name": "virDirOpenInternal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "2859-2873",
          "snippet": "static int\nvirDirOpenInternal(DIR **dirp, const char *name, bool ignoreENOENT, bool quiet)\n{\n    *dirp = opendir(name); /* exempt from syntax-check */\n    if (!*dirp) {\n        if (quiet)\n            return -1;\n\n        if (ignoreENOENT && errno == ENOENT)\n            return 0;\n        virReportSystemError(errno, _(\"cannot open directory '%s'\"), name);\n        return -1;\n    }\n    return 1;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nvirDirOpenInternal(DIR **dirp, const char *name, bool ignoreENOENT, bool quiet)\n{\n    *dirp = opendir(name); /* exempt from syntax-check */\n    if (!*dirp) {\n        if (quiet)\n            return -1;\n\n        if (ignoreENOENT && errno == ENOENT)\n            return 0;\n        virReportSystemError(errno, _(\"cannot open directory '%s'\"), name);\n        return -1;\n    }\n    return 1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirDirOpen(DIR **dirp, const char *name)\n{\n    return virDirOpenInternal(dirp, name, false, false);\n}"
  },
  {
    "function_name": "virDirOpenInternal",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "2859-2873",
    "snippet": "static int\nvirDirOpenInternal(DIR **dirp, const char *name, bool ignoreENOENT, bool quiet)\n{\n    *dirp = opendir(name); /* exempt from syntax-check */\n    if (!*dirp) {\n        if (quiet)\n            return -1;\n\n        if (ignoreENOENT && errno == ENOENT)\n            return 0;\n        virReportSystemError(errno, _(\"cannot open directory '%s'\"), name);\n        return -1;\n    }\n    return 1;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"cannot open directory '%s'\")",
            "name"
          ],
          "line": 2869
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"cannot open directory '%s'\""
          ],
          "line": 2869
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "opendir",
          "args": [
            "name"
          ],
          "line": 2862
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nvirDirOpenInternal(DIR **dirp, const char *name, bool ignoreENOENT, bool quiet)\n{\n    *dirp = opendir(name); /* exempt from syntax-check */\n    if (!*dirp) {\n        if (quiet)\n            return -1;\n\n        if (ignoreENOENT && errno == ENOENT)\n            return 0;\n        virReportSystemError(errno, _(\"cannot open directory '%s'\"), name);\n        return -1;\n    }\n    return 1;\n}"
  },
  {
    "function_name": "virFileRemove",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "2844-2856",
    "snippet": "int\nvirFileRemove(const char *path,\n              uid_t uid G_GNUC_UNUSED,\n              gid_t gid G_GNUC_UNUSED)\n{\n    if (unlink(path) < 0) {\n        virReportSystemError(errno, _(\"Unable to unlink path '%s'\"),\n                             path);\n        return -1;\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"Unable to unlink path '%s'\")",
            "path"
          ],
          "line": 2850
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to unlink path '%s'\""
          ],
          "line": 2850
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlink",
          "args": [
            "path"
          ],
          "line": 2849
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileRemove(const char *path,\n              uid_t uid G_GNUC_UNUSED,\n              gid_t gid G_GNUC_UNUSED)\n{\n    if (unlink(path) < 0) {\n        virReportSystemError(errno, _(\"Unable to unlink path '%s'\"),\n                             path);\n        return -1;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virDirCreate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "2831-2842",
    "snippet": "int\nvirDirCreate(const char *path G_GNUC_UNUSED,\n             mode_t mode G_GNUC_UNUSED,\n             uid_t uid G_GNUC_UNUSED,\n             gid_t gid G_GNUC_UNUSED,\n             unsigned int flags_unused G_GNUC_UNUSED)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   \"%s\", _(\"virDirCreate is not implemented for WIN32\"));\n\n    return -ENOSYS;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"virDirCreate is not implemented for WIN32\")"
          ],
          "line": 2838
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"virDirCreate is not implemented for WIN32\""
          ],
          "line": 2839
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirDirCreate(const char *path G_GNUC_UNUSED,\n             mode_t mode G_GNUC_UNUSED,\n             uid_t uid G_GNUC_UNUSED,\n             gid_t gid G_GNUC_UNUSED,\n             unsigned int flags_unused G_GNUC_UNUSED)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   \"%s\", _(\"virDirCreate is not implemented for WIN32\"));\n\n    return -ENOSYS;\n}"
  },
  {
    "function_name": "virFileOpenAs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "2817-2829",
    "snippet": "int\nvirFileOpenAs(const char *path G_GNUC_UNUSED,\n              int openflags G_GNUC_UNUSED,\n              mode_t mode G_GNUC_UNUSED,\n              uid_t uid G_GNUC_UNUSED,\n              gid_t gid G_GNUC_UNUSED,\n              unsigned int flags_unused G_GNUC_UNUSED)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   \"%s\", _(\"virFileOpenAs is not implemented for WIN32\"));\n\n    return -ENOSYS;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"virFileOpenAs is not implemented for WIN32\")"
          ],
          "line": 2825
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"virFileOpenAs is not implemented for WIN32\""
          ],
          "line": 2826
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileOpenAs(const char *path G_GNUC_UNUSED,\n              int openflags G_GNUC_UNUSED,\n              mode_t mode G_GNUC_UNUSED,\n              uid_t uid G_GNUC_UNUSED,\n              gid_t gid G_GNUC_UNUSED,\n              unsigned int flags_unused G_GNUC_UNUSED)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   \"%s\", _(\"virFileOpenAs is not implemented for WIN32\"));\n\n    return -ENOSYS;\n}"
  },
  {
    "function_name": "virFileAccessibleAs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "2805-2814",
    "snippet": "int\nvirFileAccessibleAs(const char *path,\n                    int mode,\n                    uid_t uid G_GNUC_UNUSED,\n                    gid_t gid G_GNUC_UNUSED)\n{\n    VIR_WARN(\"Ignoring uid/gid due to WIN32\");\n\n    return access(path, mode);\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "access",
          "args": [
            "path",
            "mode"
          ],
          "line": 2813
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_WARN",
          "args": [
            "\"Ignoring uid/gid due to WIN32\""
          ],
          "line": 2811
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileAccessibleAs(const char *path,\n                    int mode,\n                    uid_t uid G_GNUC_UNUSED,\n                    gid_t gid G_GNUC_UNUSED)\n{\n    VIR_WARN(\"Ignoring uid/gid due to WIN32\");\n\n    return access(path, mode);\n}"
  },
  {
    "function_name": "virDirCreate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "2672-2801",
    "snippet": "int\nvirDirCreate(const char *path,\n             mode_t mode, uid_t uid, gid_t gid,\n             unsigned int flags)\n{\n    struct stat st;\n    pid_t pid;\n    int status = 0, ret = 0;\n    g_autofree gid_t *groups = NULL;\n    int ngroups;\n    bool created = false;\n\n    /* Everything after this check is crazyness to allow setting uid/gid\n     * on directories that are on root-squash NFS shares. We only want\n     * to go that route if the follow conditions are true:\n     *\n     * 1) VIR_DIR_CREATE_AS_UID was passed, currently only used when\n     *    directory is being created for a NETFS pool\n     * 2) We are running as root, since that's when the root-squash\n     *    workaround is required.\n     * 3) An explicit uid/gid was requested\n     * 4) The directory doesn't already exist and the ALLOW_EXIST flag\n     *    wasn't passed.\n     *\n     * If any of those conditions are _not_ met, ignore the fork crazyness\n     */\n    if ((!(flags & VIR_DIR_CREATE_AS_UID))\n        || (geteuid() != 0)\n        || ((uid == (uid_t) -1) && (gid == (gid_t) -1))\n        || ((flags & VIR_DIR_CREATE_ALLOW_EXIST) && virFileExists(path))) {\n        return virDirCreateNoFork(path, mode, uid, gid, flags);\n    }\n\n    if (uid == (uid_t) -1)\n        uid = geteuid();\n    if (gid == (gid_t) -1)\n        gid = getegid();\n\n    ngroups = virGetGroupList(uid, gid, &groups);\n    if (ngroups < 0)\n        return -errno;\n\n    pid = virFork();\n\n    if (pid < 0)\n        return -errno;\n\n    if (pid) { /* parent */\n        /* wait for child to complete, and retrieve its exit code */\n\n        if (virProcessWait(pid, &status, 0) < 0) {\n            /* virProcessWait() reports errno on waitpid failure, so we'll just\n             * set our return status to EINTR; otherwise, set status to EACCES\n             * since the original failure for the fork+setuid path would have\n             * been EACCES or EPERM by definition.\n             */\n            if (virLastErrorIsSystemErrno(0))\n                status = EINTR;\n            else if (!status)\n                status = EACCES;\n        }\n\n        /*\n         * If the child exited with EACCES, then fall back to non-fork method\n         * as in the original logic introduced and explained by commit 98f6f381.\n         */\n        if (status == EACCES) {\n            virResetLastError();\n            return virDirCreateNoFork(path, mode, uid, gid, flags);\n        }\n\n        if (status)\n            ret = -status;\n\n        return ret;\n    }\n\n    /* child */\n\n    /* set desired uid/gid, then attempt to create the directory */\n    if (virSetUIDGID(uid, gid, groups, ngroups) < 0) {\n        ret = errno;\n        goto childerror;\n    }\n\n    if (mkdir(path, mode) < 0) {\n        ret = errno;\n        if (ret != EACCES) {\n            /* in case of EACCES, the parent will retry */\n            virReportSystemError(errno, _(\"child failed to create directory '%s'\"),\n                                 path);\n        }\n        goto childerror;\n    }\n    created = true;\n\n    /* check if group was set properly by creating after\n     * setgid. If not, try doing it with chown */\n    if (stat(path, &st) == -1) {\n        ret = errno;\n        virReportSystemError(errno,\n                             _(\"stat of '%s' failed\"), path);\n        goto childerror;\n    }\n\n    if ((st.st_gid != gid) && (chown(path, (uid_t) -1, gid) < 0)) {\n        ret = errno;\n        virReportSystemError(errno,\n                             _(\"cannot chown '%s' to group %u\"),\n                             path, (unsigned int) gid);\n        goto childerror;\n    }\n\n    if (mode != (mode_t) -1 && chmod(path, mode) < 0) {\n        virReportSystemError(errno,\n                             _(\"cannot set mode of '%s' to %04o\"),\n                             path, mode);\n        goto childerror;\n    }\n\n childerror:\n    if (ret != 0 && created)\n        rmdir(path);\n\n    if ((ret & 0xff) != ret) {\n        VIR_WARN(\"unable to pass desired return value %d\", ret);\n        ret = 0xff;\n    }\n    _exit(ret);\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_exit",
          "args": [
            "ret"
          ],
          "line": 2800
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_WARN",
          "args": [
            "\"unable to pass desired return value %d\"",
            "ret"
          ],
          "line": 2797
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rmdir",
          "args": [
            "path"
          ],
          "line": 2794
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"cannot set mode of '%s' to %04o\")",
            "path",
            "mode"
          ],
          "line": 2786
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"cannot set mode of '%s' to %04o\""
          ],
          "line": 2787
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "chmod",
          "args": [
            "path",
            "mode"
          ],
          "line": 2785
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"cannot chown '%s' to group %u\")",
            "path",
            "(unsigned int) gid"
          ],
          "line": 2779
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "chown",
          "args": [
            "path",
            "(uid_t) -1",
            "gid"
          ],
          "line": 2777
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"stat of '%s' failed\")",
            "path"
          ],
          "line": 2772
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "stat",
          "args": [
            "path",
            "&st"
          ],
          "line": 2770
        },
        "resolved": true,
        "details": {
          "function_name": "profile_status",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_apparmor.c",
          "lines": "70-108",
          "snippet": "static int\nprofile_status(const char *str, const int check_enforcing)\n{\n    char *content = NULL;\n    char *tmp = NULL;\n    char *etmp = NULL;\n    int rc = -2;\n\n    /* create string that is '<str> \\0' for accurate matching */\n    tmp = g_strdup_printf(\"%s \", str);\n\n    if (check_enforcing != 0) {\n        /* create string that is '<str> (enforce)\\0' for accurate matching */\n        etmp = g_strdup_printf(\"%s (enforce)\", str);\n    }\n\n    if (virFileReadAll(APPARMOR_PROFILES_PATH, MAX_FILE_LEN, &content) < 0) {\n        virReportSystemError(errno,\n                             _(\"Failed to read AppArmor profiles list \"\n                             \"\\'%s\\'\"), APPARMOR_PROFILES_PATH);\n        goto cleanup;\n    }\n\n    if (strstr(content, tmp) != NULL)\n        rc = 0;\n    else\n        rc = -1; /* return -1 if not loaded */\n    if (check_enforcing != 0) {\n        if (rc == 0 && strstr(content, etmp) != NULL)\n            rc = 1;                 /* return '1' if loaded and enforcing */\n    }\n\n    VIR_FREE(content);\n cleanup:\n    VIR_FREE(tmp);\n    VIR_FREE(etmp);\n\n    return rc;\n}",
          "includes": [
            "#include \"virmdev.h\"",
            "#include \"virscsi.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"vircommand.h\"",
            "#include \"configmake.h\"",
            "#include \"virfile.h\"",
            "#include \"virscsivhost.h\"",
            "#include \"virusb.h\"",
            "#include \"virpci.h\"",
            "#include \"viruuid.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"security_apparmor.h\"",
            "#include \"internal.h\"",
            "#include <wait.h>",
            "#include <unistd.h>",
            "#include <sys/apparmor.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virmdev.h\"\n#include \"virscsi.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"configmake.h\"\n#include \"virfile.h\"\n#include \"virscsivhost.h\"\n#include \"virusb.h\"\n#include \"virpci.h\"\n#include \"viruuid.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"security_apparmor.h\"\n#include \"internal.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/apparmor.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nprofile_status(const char *str, const int check_enforcing)\n{\n    char *content = NULL;\n    char *tmp = NULL;\n    char *etmp = NULL;\n    int rc = -2;\n\n    /* create string that is '<str> \\0' for accurate matching */\n    tmp = g_strdup_printf(\"%s \", str);\n\n    if (check_enforcing != 0) {\n        /* create string that is '<str> (enforce)\\0' for accurate matching */\n        etmp = g_strdup_printf(\"%s (enforce)\", str);\n    }\n\n    if (virFileReadAll(APPARMOR_PROFILES_PATH, MAX_FILE_LEN, &content) < 0) {\n        virReportSystemError(errno,\n                             _(\"Failed to read AppArmor profiles list \"\n                             \"\\'%s\\'\"), APPARMOR_PROFILES_PATH);\n        goto cleanup;\n    }\n\n    if (strstr(content, tmp) != NULL)\n        rc = 0;\n    else\n        rc = -1; /* return -1 if not loaded */\n    if (check_enforcing != 0) {\n        if (rc == 0 && strstr(content, etmp) != NULL)\n            rc = 1;                 /* return '1' if loaded and enforcing */\n    }\n\n    VIR_FREE(content);\n cleanup:\n    VIR_FREE(tmp);\n    VIR_FREE(etmp);\n\n    return rc;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"child failed to create directory '%s'\")",
            "path"
          ],
          "line": 2761
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mkdir",
          "args": [
            "path",
            "mode"
          ],
          "line": 2757
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virSetUIDGID",
          "args": [
            "uid",
            "gid",
            "groups",
            "ngroups"
          ],
          "line": 2752
        },
        "resolved": true,
        "details": {
          "function_name": "virSetUIDGID",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
          "lines": "1147-1156",
          "snippet": "int\nvirSetUIDGID(uid_t uid G_GNUC_UNUSED,\n             gid_t gid G_GNUC_UNUSED,\n             gid_t *groups G_GNUC_UNUSED,\n             int ngroups G_GNUC_UNUSED)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   \"%s\", _(\"virSetUIDGID is not available\"));\n    return -1;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <sys/prctl.h>",
            "# include <cap-ng.h>",
            "# include <grp.h>",
            "# include <pwd.h>",
            "# include <libdevmapper.h>",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <conio.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nint\nvirSetUIDGID(uid_t uid G_GNUC_UNUSED,\n             gid_t gid G_GNUC_UNUSED,\n             gid_t *groups G_GNUC_UNUSED,\n             int ngroups G_GNUC_UNUSED)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   \"%s\", _(\"virSetUIDGID is not available\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDirCreateNoFork",
          "args": [
            "path",
            "mode",
            "uid",
            "gid",
            "flags"
          ],
          "line": 2740
        },
        "resolved": true,
        "details": {
          "function_name": "virDirCreateNoFork",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "2606-2651",
          "snippet": "static int\nvirDirCreateNoFork(const char *path,\n                   mode_t mode, uid_t uid, gid_t gid,\n                   unsigned int flags)\n{\n    int ret = 0;\n    struct stat st;\n    bool created = false;\n\n    if (!((flags & VIR_DIR_CREATE_ALLOW_EXIST) && virFileExists(path))) {\n        if (mkdir(path, mode) < 0) {\n            ret = -errno;\n            virReportSystemError(errno, _(\"failed to create directory '%s'\"),\n                                 path);\n            goto error;\n        }\n        created = true;\n    }\n\n    if (stat(path, &st) == -1) {\n        ret = -errno;\n        virReportSystemError(errno, _(\"stat of '%s' failed\"), path);\n        goto error;\n    }\n# ifndef WIN32\n    if (((uid != (uid_t) -1 && st.st_uid != uid) ||\n         (gid != (gid_t) -1 && st.st_gid != gid))\n        && (chown(path, uid, gid) < 0)) {\n        ret = -errno;\n        virReportSystemError(errno, _(\"cannot chown '%s' to (%u, %u)\"),\n                             path, (unsigned int) uid, (unsigned int) gid);\n        goto error;\n    }\n# endif /* !WIN32 */\n    if (mode != (mode_t) -1 && chmod(path, mode) < 0) {\n        ret = -errno;\n        virReportSystemError(errno,\n                             _(\"cannot set mode of '%s' to %04o\"),\n                             path, mode);\n        goto error;\n    }\n error:\n    if (ret < 0 && created)\n        rmdir(path);\n    return ret;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nvirDirCreateNoFork(const char *path,\n                   mode_t mode, uid_t uid, gid_t gid,\n                   unsigned int flags)\n{\n    int ret = 0;\n    struct stat st;\n    bool created = false;\n\n    if (!((flags & VIR_DIR_CREATE_ALLOW_EXIST) && virFileExists(path))) {\n        if (mkdir(path, mode) < 0) {\n            ret = -errno;\n            virReportSystemError(errno, _(\"failed to create directory '%s'\"),\n                                 path);\n            goto error;\n        }\n        created = true;\n    }\n\n    if (stat(path, &st) == -1) {\n        ret = -errno;\n        virReportSystemError(errno, _(\"stat of '%s' failed\"), path);\n        goto error;\n    }\n# ifndef WIN32\n    if (((uid != (uid_t) -1 && st.st_uid != uid) ||\n         (gid != (gid_t) -1 && st.st_gid != gid))\n        && (chown(path, uid, gid) < 0)) {\n        ret = -errno;\n        virReportSystemError(errno, _(\"cannot chown '%s' to (%u, %u)\"),\n                             path, (unsigned int) uid, (unsigned int) gid);\n        goto error;\n    }\n# endif /* !WIN32 */\n    if (mode != (mode_t) -1 && chmod(path, mode) < 0) {\n        ret = -errno;\n        virReportSystemError(errno,\n                             _(\"cannot set mode of '%s' to %04o\"),\n                             path, mode);\n        goto error;\n    }\n error:\n    if (ret < 0 && created)\n        rmdir(path);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 2739
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLastErrorIsSystemErrno",
          "args": [
            "0"
          ],
          "line": 2728
        },
        "resolved": true,
        "details": {
          "function_name": "virLastErrorIsSystemErrno",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "1432-1442",
          "snippet": "bool virLastErrorIsSystemErrno(int errnum)\n{\n    virErrorPtr err = virGetLastError();\n    if (!err)\n        return false;\n    if (err->code != VIR_ERR_SYSTEM_ERROR)\n        return false;\n    if (errnum != 0 && err->int1 != errnum)\n        return false;\n    return true;\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nbool virLastErrorIsSystemErrno(int errnum)\n{\n    virErrorPtr err = virGetLastError();\n    if (!err)\n        return false;\n    if (err->code != VIR_ERR_SYSTEM_ERROR)\n        return false;\n    if (errnum != 0 && err->int1 != errnum)\n        return false;\n    return true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virProcessWait",
          "args": [
            "pid",
            "&status",
            "0"
          ],
          "line": 2722
        },
        "resolved": true,
        "details": {
          "function_name": "virProcessWait",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virprocess.c",
          "lines": "296-302",
          "snippet": "int\nvirProcessWait(pid_t pid, int *exitstatus G_GNUC_UNUSED, bool raw G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, _(\"unable to wait for process %lld\"),\n                         (long long) pid);\n    return -1;\n}",
          "includes": [
            "#   include <sys/syscall.h>",
            "#include \"vircommand.h\"",
            "#include \"virstring.h\"",
            "#include \"virutil.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virprocess.h\"",
            "# include <windows.h>",
            "# include <sys/cpuset.h>",
            "# include <sys/user.h>",
            "# include <sys/sysctl.h>",
            "# include <sys/param.h>",
            "# include <sched.h>",
            "# include <sys/resource.h>",
            "# include <sys/time.h>",
            "# include <sys/mount.h>",
            "#include <unistd.h>",
            "# include <sys/wait.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#   include <sys/syscall.h>\n#include \"vircommand.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virprocess.h\"\n# include <windows.h>\n# include <sys/cpuset.h>\n# include <sys/user.h>\n# include <sys/sysctl.h>\n# include <sys/param.h>\n# include <sched.h>\n# include <sys/resource.h>\n# include <sys/time.h>\n# include <sys/mount.h>\n#include <unistd.h>\n# include <sys/wait.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirProcessWait(pid_t pid, int *exitstatus G_GNUC_UNUSED, bool raw G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, _(\"unable to wait for process %lld\"),\n                         (long long) pid);\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virFork",
          "args": [],
          "line": 2714
        },
        "resolved": true,
        "details": {
          "function_name": "virFork",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "902-908",
          "snippet": "pid_t\nvirFork(void)\n{\n    errno = ENOTSUP;\n\n    return -1;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\npid_t\nvirFork(void)\n{\n    errno = ENOTSUP;\n\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virGetGroupList",
          "args": [
            "uid",
            "gid",
            "&groups"
          ],
          "line": 2710
        },
        "resolved": true,
        "details": {
          "function_name": "virGetGroupList",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
          "lines": "1059-1065",
          "snippet": "int\nvirGetGroupList(uid_t uid G_GNUC_UNUSED, gid_t gid G_GNUC_UNUSED,\n                gid_t **list)\n{\n    *list = NULL;\n    return 0;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <sys/prctl.h>",
            "# include <cap-ng.h>",
            "# include <grp.h>",
            "# include <pwd.h>",
            "# include <libdevmapper.h>",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <conio.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nint\nvirGetGroupList(uid_t uid G_GNUC_UNUSED, gid_t gid G_GNUC_UNUSED,\n                gid_t **list)\n{\n    *list = NULL;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "getegid",
          "args": [],
          "line": 2708
        },
        "resolved": true,
        "details": {
          "function_name": "getegid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.h",
          "lines": "78-79",
          "snippet": "static inline int getegid(void)\n{ return 0; }",
          "includes": [
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include \"internal.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/types.h>\n#include <unistd.h>\n#include \"internal.h\"\n\nstatic inline int getegid(void)\n{ return 0; }"
        }
      },
      {
        "call_info": {
          "callee": "geteuid",
          "args": [],
          "line": 2706
        },
        "resolved": true,
        "details": {
          "function_name": "geteuid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.h",
          "lines": "68-69",
          "snippet": "static inline int geteuid(void)\n{ return 0; }",
          "includes": [
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include \"internal.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/types.h>\n#include <unistd.h>\n#include \"internal.h\"\n\nstatic inline int geteuid(void)\n{ return 0; }"
        }
      },
      {
        "call_info": {
          "callee": "virFileExists",
          "args": [
            "path"
          ],
          "line": 2701
        },
        "resolved": true,
        "details": {
          "function_name": "virFileExists",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1873-1877",
          "snippet": "bool\nvirFileExists(const char *path)\n{\n    return access(path, F_OK) == 0;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nbool\nvirFileExists(const char *path)\n{\n    return access(path, F_OK) == 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirDirCreate(const char *path,\n             mode_t mode, uid_t uid, gid_t gid,\n             unsigned int flags)\n{\n    struct stat st;\n    pid_t pid;\n    int status = 0, ret = 0;\n    g_autofree gid_t *groups = NULL;\n    int ngroups;\n    bool created = false;\n\n    /* Everything after this check is crazyness to allow setting uid/gid\n     * on directories that are on root-squash NFS shares. We only want\n     * to go that route if the follow conditions are true:\n     *\n     * 1) VIR_DIR_CREATE_AS_UID was passed, currently only used when\n     *    directory is being created for a NETFS pool\n     * 2) We are running as root, since that's when the root-squash\n     *    workaround is required.\n     * 3) An explicit uid/gid was requested\n     * 4) The directory doesn't already exist and the ALLOW_EXIST flag\n     *    wasn't passed.\n     *\n     * If any of those conditions are _not_ met, ignore the fork crazyness\n     */\n    if ((!(flags & VIR_DIR_CREATE_AS_UID))\n        || (geteuid() != 0)\n        || ((uid == (uid_t) -1) && (gid == (gid_t) -1))\n        || ((flags & VIR_DIR_CREATE_ALLOW_EXIST) && virFileExists(path))) {\n        return virDirCreateNoFork(path, mode, uid, gid, flags);\n    }\n\n    if (uid == (uid_t) -1)\n        uid = geteuid();\n    if (gid == (gid_t) -1)\n        gid = getegid();\n\n    ngroups = virGetGroupList(uid, gid, &groups);\n    if (ngroups < 0)\n        return -errno;\n\n    pid = virFork();\n\n    if (pid < 0)\n        return -errno;\n\n    if (pid) { /* parent */\n        /* wait for child to complete, and retrieve its exit code */\n\n        if (virProcessWait(pid, &status, 0) < 0) {\n            /* virProcessWait() reports errno on waitpid failure, so we'll just\n             * set our return status to EINTR; otherwise, set status to EACCES\n             * since the original failure for the fork+setuid path would have\n             * been EACCES or EPERM by definition.\n             */\n            if (virLastErrorIsSystemErrno(0))\n                status = EINTR;\n            else if (!status)\n                status = EACCES;\n        }\n\n        /*\n         * If the child exited with EACCES, then fall back to non-fork method\n         * as in the original logic introduced and explained by commit 98f6f381.\n         */\n        if (status == EACCES) {\n            virResetLastError();\n            return virDirCreateNoFork(path, mode, uid, gid, flags);\n        }\n\n        if (status)\n            ret = -status;\n\n        return ret;\n    }\n\n    /* child */\n\n    /* set desired uid/gid, then attempt to create the directory */\n    if (virSetUIDGID(uid, gid, groups, ngroups) < 0) {\n        ret = errno;\n        goto childerror;\n    }\n\n    if (mkdir(path, mode) < 0) {\n        ret = errno;\n        if (ret != EACCES) {\n            /* in case of EACCES, the parent will retry */\n            virReportSystemError(errno, _(\"child failed to create directory '%s'\"),\n                                 path);\n        }\n        goto childerror;\n    }\n    created = true;\n\n    /* check if group was set properly by creating after\n     * setgid. If not, try doing it with chown */\n    if (stat(path, &st) == -1) {\n        ret = errno;\n        virReportSystemError(errno,\n                             _(\"stat of '%s' failed\"), path);\n        goto childerror;\n    }\n\n    if ((st.st_gid != gid) && (chown(path, (uid_t) -1, gid) < 0)) {\n        ret = errno;\n        virReportSystemError(errno,\n                             _(\"cannot chown '%s' to group %u\"),\n                             path, (unsigned int) gid);\n        goto childerror;\n    }\n\n    if (mode != (mode_t) -1 && chmod(path, mode) < 0) {\n        virReportSystemError(errno,\n                             _(\"cannot set mode of '%s' to %04o\"),\n                             path, mode);\n        goto childerror;\n    }\n\n childerror:\n    if (ret != 0 && created)\n        rmdir(path);\n\n    if ((ret & 0xff) != ret) {\n        VIR_WARN(\"unable to pass desired return value %d\", ret);\n        ret = 0xff;\n    }\n    _exit(ret);\n}"
  },
  {
    "function_name": "virDirCreateNoFork",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "2606-2651",
    "snippet": "static int\nvirDirCreateNoFork(const char *path,\n                   mode_t mode, uid_t uid, gid_t gid,\n                   unsigned int flags)\n{\n    int ret = 0;\n    struct stat st;\n    bool created = false;\n\n    if (!((flags & VIR_DIR_CREATE_ALLOW_EXIST) && virFileExists(path))) {\n        if (mkdir(path, mode) < 0) {\n            ret = -errno;\n            virReportSystemError(errno, _(\"failed to create directory '%s'\"),\n                                 path);\n            goto error;\n        }\n        created = true;\n    }\n\n    if (stat(path, &st) == -1) {\n        ret = -errno;\n        virReportSystemError(errno, _(\"stat of '%s' failed\"), path);\n        goto error;\n    }\n# ifndef WIN32\n    if (((uid != (uid_t) -1 && st.st_uid != uid) ||\n         (gid != (gid_t) -1 && st.st_gid != gid))\n        && (chown(path, uid, gid) < 0)) {\n        ret = -errno;\n        virReportSystemError(errno, _(\"cannot chown '%s' to (%u, %u)\"),\n                             path, (unsigned int) uid, (unsigned int) gid);\n        goto error;\n    }\n# endif /* !WIN32 */\n    if (mode != (mode_t) -1 && chmod(path, mode) < 0) {\n        ret = -errno;\n        virReportSystemError(errno,\n                             _(\"cannot set mode of '%s' to %04o\"),\n                             path, mode);\n        goto error;\n    }\n error:\n    if (ret < 0 && created)\n        rmdir(path);\n    return ret;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rmdir",
          "args": [
            "path"
          ],
          "line": 2649
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"cannot set mode of '%s' to %04o\")",
            "path",
            "mode"
          ],
          "line": 2642
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"cannot set mode of '%s' to %04o\""
          ],
          "line": 2643
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "chmod",
          "args": [
            "path",
            "mode"
          ],
          "line": 2640
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"cannot chown '%s' to (%u, %u)\")",
            "path",
            "(unsigned int) uid",
            "(unsigned int) gid"
          ],
          "line": 2635
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "chown",
          "args": [
            "path",
            "uid",
            "gid"
          ],
          "line": 2633
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"stat of '%s' failed\")",
            "path"
          ],
          "line": 2627
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "stat",
          "args": [
            "path",
            "&st"
          ],
          "line": 2625
        },
        "resolved": true,
        "details": {
          "function_name": "profile_status",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_apparmor.c",
          "lines": "70-108",
          "snippet": "static int\nprofile_status(const char *str, const int check_enforcing)\n{\n    char *content = NULL;\n    char *tmp = NULL;\n    char *etmp = NULL;\n    int rc = -2;\n\n    /* create string that is '<str> \\0' for accurate matching */\n    tmp = g_strdup_printf(\"%s \", str);\n\n    if (check_enforcing != 0) {\n        /* create string that is '<str> (enforce)\\0' for accurate matching */\n        etmp = g_strdup_printf(\"%s (enforce)\", str);\n    }\n\n    if (virFileReadAll(APPARMOR_PROFILES_PATH, MAX_FILE_LEN, &content) < 0) {\n        virReportSystemError(errno,\n                             _(\"Failed to read AppArmor profiles list \"\n                             \"\\'%s\\'\"), APPARMOR_PROFILES_PATH);\n        goto cleanup;\n    }\n\n    if (strstr(content, tmp) != NULL)\n        rc = 0;\n    else\n        rc = -1; /* return -1 if not loaded */\n    if (check_enforcing != 0) {\n        if (rc == 0 && strstr(content, etmp) != NULL)\n            rc = 1;                 /* return '1' if loaded and enforcing */\n    }\n\n    VIR_FREE(content);\n cleanup:\n    VIR_FREE(tmp);\n    VIR_FREE(etmp);\n\n    return rc;\n}",
          "includes": [
            "#include \"virmdev.h\"",
            "#include \"virscsi.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"vircommand.h\"",
            "#include \"configmake.h\"",
            "#include \"virfile.h\"",
            "#include \"virscsivhost.h\"",
            "#include \"virusb.h\"",
            "#include \"virpci.h\"",
            "#include \"viruuid.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"security_apparmor.h\"",
            "#include \"internal.h\"",
            "#include <wait.h>",
            "#include <unistd.h>",
            "#include <sys/apparmor.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virmdev.h\"\n#include \"virscsi.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"configmake.h\"\n#include \"virfile.h\"\n#include \"virscsivhost.h\"\n#include \"virusb.h\"\n#include \"virpci.h\"\n#include \"viruuid.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"security_apparmor.h\"\n#include \"internal.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/apparmor.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nprofile_status(const char *str, const int check_enforcing)\n{\n    char *content = NULL;\n    char *tmp = NULL;\n    char *etmp = NULL;\n    int rc = -2;\n\n    /* create string that is '<str> \\0' for accurate matching */\n    tmp = g_strdup_printf(\"%s \", str);\n\n    if (check_enforcing != 0) {\n        /* create string that is '<str> (enforce)\\0' for accurate matching */\n        etmp = g_strdup_printf(\"%s (enforce)\", str);\n    }\n\n    if (virFileReadAll(APPARMOR_PROFILES_PATH, MAX_FILE_LEN, &content) < 0) {\n        virReportSystemError(errno,\n                             _(\"Failed to read AppArmor profiles list \"\n                             \"\\'%s\\'\"), APPARMOR_PROFILES_PATH);\n        goto cleanup;\n    }\n\n    if (strstr(content, tmp) != NULL)\n        rc = 0;\n    else\n        rc = -1; /* return -1 if not loaded */\n    if (check_enforcing != 0) {\n        if (rc == 0 && strstr(content, etmp) != NULL)\n            rc = 1;                 /* return '1' if loaded and enforcing */\n    }\n\n    VIR_FREE(content);\n cleanup:\n    VIR_FREE(tmp);\n    VIR_FREE(etmp);\n\n    return rc;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"failed to create directory '%s'\")",
            "path"
          ],
          "line": 2618
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mkdir",
          "args": [
            "path",
            "mode"
          ],
          "line": 2616
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virFileExists",
          "args": [
            "path"
          ],
          "line": 2615
        },
        "resolved": true,
        "details": {
          "function_name": "virFileExists",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1873-1877",
          "snippet": "bool\nvirFileExists(const char *path)\n{\n    return access(path, F_OK) == 0;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nbool\nvirFileExists(const char *path)\n{\n    return access(path, F_OK) == 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nvirDirCreateNoFork(const char *path,\n                   mode_t mode, uid_t uid, gid_t gid,\n                   unsigned int flags)\n{\n    int ret = 0;\n    struct stat st;\n    bool created = false;\n\n    if (!((flags & VIR_DIR_CREATE_ALLOW_EXIST) && virFileExists(path))) {\n        if (mkdir(path, mode) < 0) {\n            ret = -errno;\n            virReportSystemError(errno, _(\"failed to create directory '%s'\"),\n                                 path);\n            goto error;\n        }\n        created = true;\n    }\n\n    if (stat(path, &st) == -1) {\n        ret = -errno;\n        virReportSystemError(errno, _(\"stat of '%s' failed\"), path);\n        goto error;\n    }\n# ifndef WIN32\n    if (((uid != (uid_t) -1 && st.st_uid != uid) ||\n         (gid != (gid_t) -1 && st.st_gid != gid))\n        && (chown(path, uid, gid) < 0)) {\n        ret = -errno;\n        virReportSystemError(errno, _(\"cannot chown '%s' to (%u, %u)\"),\n                             path, (unsigned int) uid, (unsigned int) gid);\n        goto error;\n    }\n# endif /* !WIN32 */\n    if (mode != (mode_t) -1 && chmod(path, mode) < 0) {\n        ret = -errno;\n        virReportSystemError(errno,\n                             _(\"cannot set mode of '%s' to %04o\"),\n                             path, mode);\n        goto error;\n    }\n error:\n    if (ret < 0 && created)\n        rmdir(path);\n    return ret;\n}"
  },
  {
    "function_name": "virFileRemove",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "2510-2594",
    "snippet": "int\nvirFileRemove(const char *path,\n              uid_t uid,\n              gid_t gid)\n{\n    pid_t pid;\n    int status = 0, ret = 0;\n    g_autofree gid_t *groups = NULL;\n    int ngroups;\n\n    if (!virFileRemoveNeedsSetuid(path, uid, gid)) {\n        if (virFileIsDir(path))\n            return rmdir(path);\n        else\n            return unlink(path);\n    }\n\n    /* Otherwise, we have to deal with the NFS root-squash craziness\n     * to run under the uid/gid that created the volume in order to\n     * perform the unlink of the volume.\n     */\n    if (uid == (uid_t) -1)\n        uid = geteuid();\n    if (gid == (gid_t) -1)\n        gid = getegid();\n\n    ngroups = virGetGroupList(uid, gid, &groups);\n    if (ngroups < 0)\n        return -errno;\n\n    pid = virFork();\n\n    if (pid < 0)\n        return -errno;\n\n    if (pid) { /* parent */\n        /* wait for child to complete, and retrieve its exit code */\n\n        if (virProcessWait(pid, &status, 0) < 0) {\n            /* virProcessWait() reports errno on waitpid failure, so we'll just\n             * set our return status to EINTR; otherwise, set status to EACCES\n             * since the original failure for the fork+setuid path would have\n             * been EACCES or EPERM by definition.\n             */\n            if (virLastErrorIsSystemErrno(0))\n                status = EINTR;\n            else if (!status)\n                status = EACCES;\n        }\n\n        if (status) {\n            errno = status;\n            ret = -1;\n        }\n\n        return ret;\n    }\n\n    /* child */\n\n    /* set desired uid/gid, then attempt to unlink the file */\n    if (virSetUIDGID(uid, gid, groups, ngroups) < 0) {\n        ret = errno;\n        goto childerror;\n    }\n\n    if (virFileIsDir(path)) {\n        if (rmdir(path) < 0) {\n            ret = errno;\n            goto childerror;\n        }\n    } else {\n        if (unlink(path) < 0) {\n            ret = errno;\n            goto childerror;\n        }\n    }\n\n childerror:\n    if ((ret & 0xff) != ret) {\n        VIR_WARN(\"unable to pass desired return value %d\", ret);\n        ret = 0xff;\n    }\n    _exit(ret);\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_exit",
          "args": [
            "ret"
          ],
          "line": 2593
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_WARN",
          "args": [
            "\"unable to pass desired return value %d\"",
            "ret"
          ],
          "line": 2590
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlink",
          "args": [
            "path"
          ],
          "line": 2582
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rmdir",
          "args": [
            "path"
          ],
          "line": 2577
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virFileIsDir",
          "args": [
            "path"
          ],
          "line": 2576
        },
        "resolved": true,
        "details": {
          "function_name": "virFileIsDir",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1850-1855",
          "snippet": "bool\nvirFileIsDir(const char *path)\n{\n    struct stat s;\n    return (stat(path, &s) == 0) && S_ISDIR(s.st_mode);\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nbool\nvirFileIsDir(const char *path)\n{\n    struct stat s;\n    return (stat(path, &s) == 0) && S_ISDIR(s.st_mode);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSetUIDGID",
          "args": [
            "uid",
            "gid",
            "groups",
            "ngroups"
          ],
          "line": 2571
        },
        "resolved": true,
        "details": {
          "function_name": "virSetUIDGID",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
          "lines": "1147-1156",
          "snippet": "int\nvirSetUIDGID(uid_t uid G_GNUC_UNUSED,\n             gid_t gid G_GNUC_UNUSED,\n             gid_t *groups G_GNUC_UNUSED,\n             int ngroups G_GNUC_UNUSED)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   \"%s\", _(\"virSetUIDGID is not available\"));\n    return -1;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <sys/prctl.h>",
            "# include <cap-ng.h>",
            "# include <grp.h>",
            "# include <pwd.h>",
            "# include <libdevmapper.h>",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <conio.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nint\nvirSetUIDGID(uid_t uid G_GNUC_UNUSED,\n             gid_t gid G_GNUC_UNUSED,\n             gid_t *groups G_GNUC_UNUSED,\n             int ngroups G_GNUC_UNUSED)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   \"%s\", _(\"virSetUIDGID is not available\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virLastErrorIsSystemErrno",
          "args": [
            "0"
          ],
          "line": 2554
        },
        "resolved": true,
        "details": {
          "function_name": "virLastErrorIsSystemErrno",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "1432-1442",
          "snippet": "bool virLastErrorIsSystemErrno(int errnum)\n{\n    virErrorPtr err = virGetLastError();\n    if (!err)\n        return false;\n    if (err->code != VIR_ERR_SYSTEM_ERROR)\n        return false;\n    if (errnum != 0 && err->int1 != errnum)\n        return false;\n    return true;\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nbool virLastErrorIsSystemErrno(int errnum)\n{\n    virErrorPtr err = virGetLastError();\n    if (!err)\n        return false;\n    if (err->code != VIR_ERR_SYSTEM_ERROR)\n        return false;\n    if (errnum != 0 && err->int1 != errnum)\n        return false;\n    return true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virProcessWait",
          "args": [
            "pid",
            "&status",
            "0"
          ],
          "line": 2548
        },
        "resolved": true,
        "details": {
          "function_name": "virProcessWait",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virprocess.c",
          "lines": "296-302",
          "snippet": "int\nvirProcessWait(pid_t pid, int *exitstatus G_GNUC_UNUSED, bool raw G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, _(\"unable to wait for process %lld\"),\n                         (long long) pid);\n    return -1;\n}",
          "includes": [
            "#   include <sys/syscall.h>",
            "#include \"vircommand.h\"",
            "#include \"virstring.h\"",
            "#include \"virutil.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virprocess.h\"",
            "# include <windows.h>",
            "# include <sys/cpuset.h>",
            "# include <sys/user.h>",
            "# include <sys/sysctl.h>",
            "# include <sys/param.h>",
            "# include <sched.h>",
            "# include <sys/resource.h>",
            "# include <sys/time.h>",
            "# include <sys/mount.h>",
            "#include <unistd.h>",
            "# include <sys/wait.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#   include <sys/syscall.h>\n#include \"vircommand.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virprocess.h\"\n# include <windows.h>\n# include <sys/cpuset.h>\n# include <sys/user.h>\n# include <sys/sysctl.h>\n# include <sys/param.h>\n# include <sched.h>\n# include <sys/resource.h>\n# include <sys/time.h>\n# include <sys/mount.h>\n#include <unistd.h>\n# include <sys/wait.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirProcessWait(pid_t pid, int *exitstatus G_GNUC_UNUSED, bool raw G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, _(\"unable to wait for process %lld\"),\n                         (long long) pid);\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virFork",
          "args": [],
          "line": 2540
        },
        "resolved": true,
        "details": {
          "function_name": "virFork",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "902-908",
          "snippet": "pid_t\nvirFork(void)\n{\n    errno = ENOTSUP;\n\n    return -1;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\npid_t\nvirFork(void)\n{\n    errno = ENOTSUP;\n\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virGetGroupList",
          "args": [
            "uid",
            "gid",
            "&groups"
          ],
          "line": 2536
        },
        "resolved": true,
        "details": {
          "function_name": "virGetGroupList",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
          "lines": "1059-1065",
          "snippet": "int\nvirGetGroupList(uid_t uid G_GNUC_UNUSED, gid_t gid G_GNUC_UNUSED,\n                gid_t **list)\n{\n    *list = NULL;\n    return 0;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <sys/prctl.h>",
            "# include <cap-ng.h>",
            "# include <grp.h>",
            "# include <pwd.h>",
            "# include <libdevmapper.h>",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <conio.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nint\nvirGetGroupList(uid_t uid G_GNUC_UNUSED, gid_t gid G_GNUC_UNUSED,\n                gid_t **list)\n{\n    *list = NULL;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "getegid",
          "args": [],
          "line": 2534
        },
        "resolved": true,
        "details": {
          "function_name": "getegid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.h",
          "lines": "78-79",
          "snippet": "static inline int getegid(void)\n{ return 0; }",
          "includes": [
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include \"internal.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/types.h>\n#include <unistd.h>\n#include \"internal.h\"\n\nstatic inline int getegid(void)\n{ return 0; }"
        }
      },
      {
        "call_info": {
          "callee": "geteuid",
          "args": [],
          "line": 2532
        },
        "resolved": true,
        "details": {
          "function_name": "geteuid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.h",
          "lines": "68-69",
          "snippet": "static inline int geteuid(void)\n{ return 0; }",
          "includes": [
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include \"internal.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/types.h>\n#include <unistd.h>\n#include \"internal.h\"\n\nstatic inline int geteuid(void)\n{ return 0; }"
        }
      },
      {
        "call_info": {
          "callee": "unlink",
          "args": [
            "path"
          ],
          "line": 2524
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rmdir",
          "args": [
            "path"
          ],
          "line": 2522
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virFileRemoveNeedsSetuid",
          "args": [
            "path",
            "uid",
            "gid"
          ],
          "line": 2520
        },
        "resolved": true,
        "details": {
          "function_name": "virFileRemoveNeedsSetuid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "2474-2496",
          "snippet": "static bool\nvirFileRemoveNeedsSetuid(const char *path, uid_t uid, gid_t gid)\n{\n    /* If running unprivileged, setuid isn't going to work */\n    if (geteuid() != 0)\n        return false;\n\n    /* uid/gid weren't specified */\n    if ((uid == (uid_t) -1) && (gid == (gid_t) -1))\n        return false;\n\n    /* already running as proper uid/gid */\n    if (uid == geteuid() && gid == getegid())\n        return false;\n\n    /* Only perform the setuid stuff for NFS, which is the only case\n       that may actually need it. This can error, but just be safe and\n       only check for a clear negative result. */\n    if (virFileIsSharedFSType(path, VIR_FILE_SHFS_NFS) == 0)\n        return false;\n\n    return true;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic bool\nvirFileRemoveNeedsSetuid(const char *path, uid_t uid, gid_t gid)\n{\n    /* If running unprivileged, setuid isn't going to work */\n    if (geteuid() != 0)\n        return false;\n\n    /* uid/gid weren't specified */\n    if ((uid == (uid_t) -1) && (gid == (gid_t) -1))\n        return false;\n\n    /* already running as proper uid/gid */\n    if (uid == geteuid() && gid == getegid())\n        return false;\n\n    /* Only perform the setuid stuff for NFS, which is the only case\n       that may actually need it. This can error, but just be safe and\n       only check for a clear negative result. */\n    if (virFileIsSharedFSType(path, VIR_FILE_SHFS_NFS) == 0)\n        return false;\n\n    return true;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileRemove(const char *path,\n              uid_t uid,\n              gid_t gid)\n{\n    pid_t pid;\n    int status = 0, ret = 0;\n    g_autofree gid_t *groups = NULL;\n    int ngroups;\n\n    if (!virFileRemoveNeedsSetuid(path, uid, gid)) {\n        if (virFileIsDir(path))\n            return rmdir(path);\n        else\n            return unlink(path);\n    }\n\n    /* Otherwise, we have to deal with the NFS root-squash craziness\n     * to run under the uid/gid that created the volume in order to\n     * perform the unlink of the volume.\n     */\n    if (uid == (uid_t) -1)\n        uid = geteuid();\n    if (gid == (gid_t) -1)\n        gid = getegid();\n\n    ngroups = virGetGroupList(uid, gid, &groups);\n    if (ngroups < 0)\n        return -errno;\n\n    pid = virFork();\n\n    if (pid < 0)\n        return -errno;\n\n    if (pid) { /* parent */\n        /* wait for child to complete, and retrieve its exit code */\n\n        if (virProcessWait(pid, &status, 0) < 0) {\n            /* virProcessWait() reports errno on waitpid failure, so we'll just\n             * set our return status to EINTR; otherwise, set status to EACCES\n             * since the original failure for the fork+setuid path would have\n             * been EACCES or EPERM by definition.\n             */\n            if (virLastErrorIsSystemErrno(0))\n                status = EINTR;\n            else if (!status)\n                status = EACCES;\n        }\n\n        if (status) {\n            errno = status;\n            ret = -1;\n        }\n\n        return ret;\n    }\n\n    /* child */\n\n    /* set desired uid/gid, then attempt to unlink the file */\n    if (virSetUIDGID(uid, gid, groups, ngroups) < 0) {\n        ret = errno;\n        goto childerror;\n    }\n\n    if (virFileIsDir(path)) {\n        if (rmdir(path) < 0) {\n            ret = errno;\n            goto childerror;\n        }\n    } else {\n        if (unlink(path) < 0) {\n            ret = errno;\n            goto childerror;\n        }\n    }\n\n childerror:\n    if ((ret & 0xff) != ret) {\n        VIR_WARN(\"unable to pass desired return value %d\", ret);\n        ret = 0xff;\n    }\n    _exit(ret);\n}"
  },
  {
    "function_name": "virFileRemoveNeedsSetuid",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "2474-2496",
    "snippet": "static bool\nvirFileRemoveNeedsSetuid(const char *path, uid_t uid, gid_t gid)\n{\n    /* If running unprivileged, setuid isn't going to work */\n    if (geteuid() != 0)\n        return false;\n\n    /* uid/gid weren't specified */\n    if ((uid == (uid_t) -1) && (gid == (gid_t) -1))\n        return false;\n\n    /* already running as proper uid/gid */\n    if (uid == geteuid() && gid == getegid())\n        return false;\n\n    /* Only perform the setuid stuff for NFS, which is the only case\n       that may actually need it. This can error, but just be safe and\n       only check for a clear negative result. */\n    if (virFileIsSharedFSType(path, VIR_FILE_SHFS_NFS) == 0)\n        return false;\n\n    return true;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virFileIsSharedFSType",
          "args": [
            "path",
            "VIR_FILE_SHFS_NFS"
          ],
          "line": 2492
        },
        "resolved": true,
        "details": {
          "function_name": "virFileIsSharedFSType",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "3648-3653",
          "snippet": "int virFileIsSharedFSType(const char *path G_GNUC_UNUSED,\n                          int fstypes G_GNUC_UNUSED)\n{\n    /* XXX implement me :-) */\n    return 0;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint virFileIsSharedFSType(const char *path G_GNUC_UNUSED,\n                          int fstypes G_GNUC_UNUSED)\n{\n    /* XXX implement me :-) */\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "getegid",
          "args": [],
          "line": 2486
        },
        "resolved": true,
        "details": {
          "function_name": "getegid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.h",
          "lines": "78-79",
          "snippet": "static inline int getegid(void)\n{ return 0; }",
          "includes": [
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include \"internal.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/types.h>\n#include <unistd.h>\n#include \"internal.h\"\n\nstatic inline int getegid(void)\n{ return 0; }"
        }
      },
      {
        "call_info": {
          "callee": "geteuid",
          "args": [],
          "line": 2486
        },
        "resolved": true,
        "details": {
          "function_name": "geteuid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.h",
          "lines": "68-69",
          "snippet": "static inline int geteuid(void)\n{ return 0; }",
          "includes": [
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include \"internal.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/types.h>\n#include <unistd.h>\n#include \"internal.h\"\n\nstatic inline int geteuid(void)\n{ return 0; }"
        }
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic bool\nvirFileRemoveNeedsSetuid(const char *path, uid_t uid, gid_t gid)\n{\n    /* If running unprivileged, setuid isn't going to work */\n    if (geteuid() != 0)\n        return false;\n\n    /* uid/gid weren't specified */\n    if ((uid == (uid_t) -1) && (gid == (gid_t) -1))\n        return false;\n\n    /* already running as proper uid/gid */\n    if (uid == geteuid() && gid == getegid())\n        return false;\n\n    /* Only perform the setuid stuff for NFS, which is the only case\n       that may actually need it. This can error, but just be safe and\n       only check for a clear negative result. */\n    if (virFileIsSharedFSType(path, VIR_FILE_SHFS_NFS) == 0)\n        return false;\n\n    return true;\n}"
  },
  {
    "function_name": "virFileOpenAs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "2387-2463",
    "snippet": "int\nvirFileOpenAs(const char *path, int openflags, mode_t mode,\n              uid_t uid, gid_t gid, unsigned int flags)\n{\n    int ret = 0, fd = -1;\n    bool created = false;\n\n    /* allow using -1 to mean \"current value\" */\n    if (uid == (uid_t) -1)\n        uid = geteuid();\n    if (gid == (gid_t) -1)\n        gid = getegid();\n\n    /* treat absence of both flags as presence of both for simpler\n     * calling. */\n    if (!(flags & (VIR_FILE_OPEN_NOFORK|VIR_FILE_OPEN_FORK)))\n        flags |= VIR_FILE_OPEN_NOFORK|VIR_FILE_OPEN_FORK;\n\n    if ((flags & VIR_FILE_OPEN_NOFORK)\n        || (geteuid() != 0)\n        || ((uid == 0) && (gid == 0))) {\n\n        if ((fd = open(path, openflags, mode)) < 0) {\n            ret = -errno;\n            if (!(flags & VIR_FILE_OPEN_FORK))\n                goto error;\n        } else {\n            if (openflags & O_CREAT)\n                created = true;\n            ret = virFileOpenForceOwnerMode(path, fd, mode, uid, gid, flags);\n            if (ret < 0)\n                goto error;\n        }\n    }\n\n    /* If we either 1) didn't try opening as current user at all, or\n     * 2) failed, and errno/virStorageFileIsSharedFS indicate we might\n     * be successful if we try as a different uid, then try doing\n     * fork+setuid+setgid before opening.\n     */\n    if ((fd < 0) && (flags & VIR_FILE_OPEN_FORK)) {\n\n        if (ret < 0) {\n            /* An open(2) that failed due to insufficient permissions\n             * could return one or the other of these depending on OS\n             * version and circumstances. Any other errno indicates a\n             * problem that couldn't be remedied by fork+setuid\n             * anyway. */\n            if (ret != -EACCES && ret != -EPERM)\n                goto error;\n\n            /* On Linux we can also verify the FS-type of the\n             * directory.  (this is a NOP on other platforms). */\n            if (virFileIsSharedFS(path) <= 0)\n                goto error;\n        }\n\n        /* passed all prerequisites - retry the open w/fork+setuid */\n        if ((fd = virFileOpenForked(path, openflags, mode, uid, gid, flags)) < 0) {\n            ret = fd;\n            goto error;\n        }\n    }\n\n    /* File is successfully opened */\n    return fd;\n\n error:\n    if (fd >= 0) {\n        /* some other failure after the open succeeded */\n        VIR_FORCE_CLOSE(fd);\n        if (created)\n            unlink(path);\n    }\n    /* whoever failed the open last has already set ret = -errno */\n    return ret;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "unlink",
          "args": [
            "path"
          ],
          "line": 2459
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FORCE_CLOSE",
          "args": [
            "fd"
          ],
          "line": 2457
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virFileOpenForked",
          "args": [
            "path",
            "openflags",
            "mode",
            "uid",
            "gid",
            "flags"
          ],
          "line": 2445
        },
        "resolved": true,
        "details": {
          "function_name": "virFileOpenForked",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "2220-2353",
          "snippet": "static int\nvirFileOpenForked(const char *path, int openflags, mode_t mode,\n                  uid_t uid, gid_t gid, unsigned int flags)\n{\n    pid_t pid;\n    int status = 0, ret = 0;\n    int recvfd_errno = 0;\n    int fd = -1;\n    int pair[2] = { -1, -1 };\n    g_autofree gid_t *groups = NULL;\n    int ngroups;\n    bool created = false;\n\n    /* parent is running as root, but caller requested that the\n     * file be opened as some other user and/or group). The\n     * following dance avoids problems caused by root-squashing\n     * NFS servers. */\n\n    ngroups = virGetGroupList(uid, gid, &groups);\n    if (ngroups < 0)\n        return -errno;\n\n    if (socketpair(AF_UNIX, SOCK_STREAM, 0, pair) < 0) {\n        ret = -errno;\n        virReportSystemError(errno,\n                             _(\"failed to create socket needed for '%s'\"),\n                             path);\n        return ret;\n    }\n\n    pid = virFork();\n    if (pid < 0)\n        return -errno;\n\n    if (pid == 0) {\n\n        /* child */\n\n        /* set desired uid/gid, then attempt to create the file */\n        VIR_FORCE_CLOSE(pair[0]);\n        if (virSetUIDGID(uid, gid, groups, ngroups) < 0) {\n            ret = -errno;\n            goto childerror;\n        }\n\n        if ((fd = open(path, openflags, mode)) < 0) {\n            ret = -errno;\n            virReportSystemError(errno,\n                                 _(\"child process failed to create file '%s'\"),\n                                 path);\n            goto childerror;\n        }\n        if (openflags & O_CREAT)\n            created = true;\n\n        /* File is successfully open. Set permissions if requested. */\n        ret = virFileOpenForceOwnerMode(path, fd, mode, uid, gid, flags);\n        if (ret < 0) {\n            ret = -errno;\n            virReportSystemError(errno,\n                                 _(\"child process failed to force owner mode file '%s'\"),\n                                 path);\n            goto childerror;\n        }\n\n        do {\n            ret = virSocketSendFD(pair[1], fd);\n        } while (ret < 0 && errno == EINTR);\n\n        if (ret < 0) {\n            ret = -errno;\n            virReportSystemError(errno, \"%s\",\n                                 _(\"child process failed to send fd to parent\"));\n            goto childerror;\n        }\n\n    childerror:\n        /* ret tracks -errno on failure, but exit value must be positive.\n         * If the child exits with EACCES, then the parent tries again.  */\n        /* XXX This makes assumptions about errno being < 255, which is\n         * not true on Hurd.  */\n        VIR_FORCE_CLOSE(pair[1]);\n        if (ret < 0) {\n            VIR_FORCE_CLOSE(fd);\n            if (created)\n                unlink(path);\n        }\n        ret = -ret;\n        if ((ret & 0xff) != ret) {\n            VIR_WARN(\"unable to pass desired return value %d\", ret);\n            ret = 0xff;\n        }\n        _exit(ret);\n    }\n\n    /* parent */\n\n    VIR_FORCE_CLOSE(pair[1]);\n\n    do {\n        fd = virSocketRecvFD(pair[0], 0);\n    } while (fd < 0 && errno == EINTR);\n    VIR_FORCE_CLOSE(pair[0]); /* NB: this preserves errno */\n    if (fd < 0)\n        recvfd_errno = errno;\n\n    if (virProcessWait(pid, &status, 0) < 0) {\n        /* virProcessWait() reports errno on waitpid failure, so we'll just\n         * set our return status to EINTR; otherwise, set status to EACCES\n         * since the original failure for the fork+setuid path would have\n         * been EACCES or EPERM by definition.\n         */\n        if (virLastErrorIsSystemErrno(0))\n            status = EINTR;\n        else if (!status)\n            status = EACCES;\n    }\n\n    if (status) {\n        VIR_FORCE_CLOSE(fd);\n        return -status;\n    }\n\n    /* if waitpid succeeded, but recvfd failed, report recvfd_errno */\n    if (recvfd_errno != 0) {\n        virReportSystemError(recvfd_errno,\n                             _(\"failed recvfd for child creating '%s'\"),\n                             path);\n        return -recvfd_errno;\n    }\n\n    /* otherwise, waitpid and recvfd succeeded, return the fd */\n    return fd;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nvirFileOpenForked(const char *path, int openflags, mode_t mode,\n                  uid_t uid, gid_t gid, unsigned int flags)\n{\n    pid_t pid;\n    int status = 0, ret = 0;\n    int recvfd_errno = 0;\n    int fd = -1;\n    int pair[2] = { -1, -1 };\n    g_autofree gid_t *groups = NULL;\n    int ngroups;\n    bool created = false;\n\n    /* parent is running as root, but caller requested that the\n     * file be opened as some other user and/or group). The\n     * following dance avoids problems caused by root-squashing\n     * NFS servers. */\n\n    ngroups = virGetGroupList(uid, gid, &groups);\n    if (ngroups < 0)\n        return -errno;\n\n    if (socketpair(AF_UNIX, SOCK_STREAM, 0, pair) < 0) {\n        ret = -errno;\n        virReportSystemError(errno,\n                             _(\"failed to create socket needed for '%s'\"),\n                             path);\n        return ret;\n    }\n\n    pid = virFork();\n    if (pid < 0)\n        return -errno;\n\n    if (pid == 0) {\n\n        /* child */\n\n        /* set desired uid/gid, then attempt to create the file */\n        VIR_FORCE_CLOSE(pair[0]);\n        if (virSetUIDGID(uid, gid, groups, ngroups) < 0) {\n            ret = -errno;\n            goto childerror;\n        }\n\n        if ((fd = open(path, openflags, mode)) < 0) {\n            ret = -errno;\n            virReportSystemError(errno,\n                                 _(\"child process failed to create file '%s'\"),\n                                 path);\n            goto childerror;\n        }\n        if (openflags & O_CREAT)\n            created = true;\n\n        /* File is successfully open. Set permissions if requested. */\n        ret = virFileOpenForceOwnerMode(path, fd, mode, uid, gid, flags);\n        if (ret < 0) {\n            ret = -errno;\n            virReportSystemError(errno,\n                                 _(\"child process failed to force owner mode file '%s'\"),\n                                 path);\n            goto childerror;\n        }\n\n        do {\n            ret = virSocketSendFD(pair[1], fd);\n        } while (ret < 0 && errno == EINTR);\n\n        if (ret < 0) {\n            ret = -errno;\n            virReportSystemError(errno, \"%s\",\n                                 _(\"child process failed to send fd to parent\"));\n            goto childerror;\n        }\n\n    childerror:\n        /* ret tracks -errno on failure, but exit value must be positive.\n         * If the child exits with EACCES, then the parent tries again.  */\n        /* XXX This makes assumptions about errno being < 255, which is\n         * not true on Hurd.  */\n        VIR_FORCE_CLOSE(pair[1]);\n        if (ret < 0) {\n            VIR_FORCE_CLOSE(fd);\n            if (created)\n                unlink(path);\n        }\n        ret = -ret;\n        if ((ret & 0xff) != ret) {\n            VIR_WARN(\"unable to pass desired return value %d\", ret);\n            ret = 0xff;\n        }\n        _exit(ret);\n    }\n\n    /* parent */\n\n    VIR_FORCE_CLOSE(pair[1]);\n\n    do {\n        fd = virSocketRecvFD(pair[0], 0);\n    } while (fd < 0 && errno == EINTR);\n    VIR_FORCE_CLOSE(pair[0]); /* NB: this preserves errno */\n    if (fd < 0)\n        recvfd_errno = errno;\n\n    if (virProcessWait(pid, &status, 0) < 0) {\n        /* virProcessWait() reports errno on waitpid failure, so we'll just\n         * set our return status to EINTR; otherwise, set status to EACCES\n         * since the original failure for the fork+setuid path would have\n         * been EACCES or EPERM by definition.\n         */\n        if (virLastErrorIsSystemErrno(0))\n            status = EINTR;\n        else if (!status)\n            status = EACCES;\n    }\n\n    if (status) {\n        VIR_FORCE_CLOSE(fd);\n        return -status;\n    }\n\n    /* if waitpid succeeded, but recvfd failed, report recvfd_errno */\n    if (recvfd_errno != 0) {\n        virReportSystemError(recvfd_errno,\n                             _(\"failed recvfd for child creating '%s'\"),\n                             path);\n        return -recvfd_errno;\n    }\n\n    /* otherwise, waitpid and recvfd succeeded, return the fd */\n    return fd;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virFileIsSharedFS",
          "args": [
            "path"
          ],
          "line": 2440
        },
        "resolved": true,
        "details": {
          "function_name": "virFileIsSharedFS",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "3699-3712",
          "snippet": "int virFileIsSharedFS(const char *path)\n{\n    return virFileIsSharedFSType(path,\n                                 VIR_FILE_SHFS_NFS |\n                                 VIR_FILE_SHFS_GFS2 |\n                                 VIR_FILE_SHFS_OCFS |\n                                 VIR_FILE_SHFS_AFS |\n                                 VIR_FILE_SHFS_SMB |\n                                 VIR_FILE_SHFS_CIFS |\n                                 VIR_FILE_SHFS_CEPH |\n                                 VIR_FILE_SHFS_GPFS|\n                                 VIR_FILE_SHFS_QB |\n                                 VIR_FILE_SHFS_ACFS);\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint virFileIsSharedFS(const char *path)\n{\n    return virFileIsSharedFSType(path,\n                                 VIR_FILE_SHFS_NFS |\n                                 VIR_FILE_SHFS_GFS2 |\n                                 VIR_FILE_SHFS_OCFS |\n                                 VIR_FILE_SHFS_AFS |\n                                 VIR_FILE_SHFS_SMB |\n                                 VIR_FILE_SHFS_CIFS |\n                                 VIR_FILE_SHFS_CEPH |\n                                 VIR_FILE_SHFS_GPFS|\n                                 VIR_FILE_SHFS_QB |\n                                 VIR_FILE_SHFS_ACFS);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virFileOpenForceOwnerMode",
          "args": [
            "path",
            "fd",
            "mode",
            "uid",
            "gid",
            "flags"
          ],
          "line": 2416
        },
        "resolved": true,
        "details": {
          "function_name": "virFileOpenForceOwnerMode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "2169-2208",
          "snippet": "static int\nvirFileOpenForceOwnerMode(const char *path, int fd, mode_t mode,\n                          uid_t uid, gid_t gid, unsigned int flags)\n{\n    int ret = 0;\n    struct stat st;\n\n    if (!(flags & (VIR_FILE_OPEN_FORCE_OWNER | VIR_FILE_OPEN_FORCE_MODE)))\n        return 0;\n\n    if (fstat(fd, &st) == -1) {\n        ret = -errno;\n        virReportSystemError(errno, _(\"stat of '%s' failed\"), path);\n        return ret;\n    }\n    /* NB: uid:gid are never \"-1\" (default) at this point - the caller\n     * has always changed -1 to the value of get[gu]id().\n    */\n    if ((flags & VIR_FILE_OPEN_FORCE_OWNER) &&\n        ((st.st_uid != uid) || (st.st_gid != gid)) &&\n        (fchown(fd, uid, gid) < 0)) {\n        ret = -errno;\n        virReportSystemError(errno,\n                             _(\"cannot chown '%s' to (%u, %u)\"),\n                             path, (unsigned int) uid,\n                             (unsigned int) gid);\n        return ret;\n    }\n    if ((flags & VIR_FILE_OPEN_FORCE_MODE) &&\n        ((mode & (S_IRWXU|S_IRWXG|S_IRWXO)) !=\n         (st.st_mode & (S_IRWXU|S_IRWXG|S_IRWXO))) &&\n        (fchmod(fd, mode) < 0)) {\n        ret = -errno;\n        virReportSystemError(errno,\n                             _(\"cannot set mode of '%s' to %04o\"),\n                             path, mode);\n        return ret;\n    }\n    return ret;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nvirFileOpenForceOwnerMode(const char *path, int fd, mode_t mode,\n                          uid_t uid, gid_t gid, unsigned int flags)\n{\n    int ret = 0;\n    struct stat st;\n\n    if (!(flags & (VIR_FILE_OPEN_FORCE_OWNER | VIR_FILE_OPEN_FORCE_MODE)))\n        return 0;\n\n    if (fstat(fd, &st) == -1) {\n        ret = -errno;\n        virReportSystemError(errno, _(\"stat of '%s' failed\"), path);\n        return ret;\n    }\n    /* NB: uid:gid are never \"-1\" (default) at this point - the caller\n     * has always changed -1 to the value of get[gu]id().\n    */\n    if ((flags & VIR_FILE_OPEN_FORCE_OWNER) &&\n        ((st.st_uid != uid) || (st.st_gid != gid)) &&\n        (fchown(fd, uid, gid) < 0)) {\n        ret = -errno;\n        virReportSystemError(errno,\n                             _(\"cannot chown '%s' to (%u, %u)\"),\n                             path, (unsigned int) uid,\n                             (unsigned int) gid);\n        return ret;\n    }\n    if ((flags & VIR_FILE_OPEN_FORCE_MODE) &&\n        ((mode & (S_IRWXU|S_IRWXG|S_IRWXO)) !=\n         (st.st_mode & (S_IRWXU|S_IRWXG|S_IRWXO))) &&\n        (fchmod(fd, mode) < 0)) {\n        ret = -errno;\n        virReportSystemError(errno,\n                             _(\"cannot set mode of '%s' to %04o\"),\n                             path, mode);\n        return ret;\n    }\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "open",
          "args": [
            "path",
            "openflags",
            "mode"
          ],
          "line": 2409
        },
        "resolved": true,
        "details": {
          "function_name": "qemuBlockReopenReadOnly",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
          "lines": "3308-3323",
          "snippet": "int\nqemuBlockReopenReadOnly(virDomainObjPtr vm,\n                         virStorageSourcePtr src,\n                         qemuDomainAsyncJob asyncJob)\n{\n    if (src->readonly)\n        return 0;\n\n    src->readonly = true;\n    if (qemuBlockReopenFormat(vm, src, asyncJob) < 0) {\n        src->readonly = false;\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_block.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nint\nqemuBlockReopenReadOnly(virDomainObjPtr vm,\n                         virStorageSourcePtr src,\n                         qemuDomainAsyncJob asyncJob)\n{\n    if (src->readonly)\n        return 0;\n\n    src->readonly = true;\n    if (qemuBlockReopenFormat(vm, src, asyncJob) < 0) {\n        src->readonly = false;\n        return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "geteuid",
          "args": [],
          "line": 2406
        },
        "resolved": true,
        "details": {
          "function_name": "geteuid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.h",
          "lines": "68-69",
          "snippet": "static inline int geteuid(void)\n{ return 0; }",
          "includes": [
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include \"internal.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/types.h>\n#include <unistd.h>\n#include \"internal.h\"\n\nstatic inline int geteuid(void)\n{ return 0; }"
        }
      },
      {
        "call_info": {
          "callee": "getegid",
          "args": [],
          "line": 2398
        },
        "resolved": true,
        "details": {
          "function_name": "getegid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.h",
          "lines": "78-79",
          "snippet": "static inline int getegid(void)\n{ return 0; }",
          "includes": [
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include \"internal.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/types.h>\n#include <unistd.h>\n#include \"internal.h\"\n\nstatic inline int getegid(void)\n{ return 0; }"
        }
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileOpenAs(const char *path, int openflags, mode_t mode,\n              uid_t uid, gid_t gid, unsigned int flags)\n{\n    int ret = 0, fd = -1;\n    bool created = false;\n\n    /* allow using -1 to mean \"current value\" */\n    if (uid == (uid_t) -1)\n        uid = geteuid();\n    if (gid == (gid_t) -1)\n        gid = getegid();\n\n    /* treat absence of both flags as presence of both for simpler\n     * calling. */\n    if (!(flags & (VIR_FILE_OPEN_NOFORK|VIR_FILE_OPEN_FORK)))\n        flags |= VIR_FILE_OPEN_NOFORK|VIR_FILE_OPEN_FORK;\n\n    if ((flags & VIR_FILE_OPEN_NOFORK)\n        || (geteuid() != 0)\n        || ((uid == 0) && (gid == 0))) {\n\n        if ((fd = open(path, openflags, mode)) < 0) {\n            ret = -errno;\n            if (!(flags & VIR_FILE_OPEN_FORK))\n                goto error;\n        } else {\n            if (openflags & O_CREAT)\n                created = true;\n            ret = virFileOpenForceOwnerMode(path, fd, mode, uid, gid, flags);\n            if (ret < 0)\n                goto error;\n        }\n    }\n\n    /* If we either 1) didn't try opening as current user at all, or\n     * 2) failed, and errno/virStorageFileIsSharedFS indicate we might\n     * be successful if we try as a different uid, then try doing\n     * fork+setuid+setgid before opening.\n     */\n    if ((fd < 0) && (flags & VIR_FILE_OPEN_FORK)) {\n\n        if (ret < 0) {\n            /* An open(2) that failed due to insufficient permissions\n             * could return one or the other of these depending on OS\n             * version and circumstances. Any other errno indicates a\n             * problem that couldn't be remedied by fork+setuid\n             * anyway. */\n            if (ret != -EACCES && ret != -EPERM)\n                goto error;\n\n            /* On Linux we can also verify the FS-type of the\n             * directory.  (this is a NOP on other platforms). */\n            if (virFileIsSharedFS(path) <= 0)\n                goto error;\n        }\n\n        /* passed all prerequisites - retry the open w/fork+setuid */\n        if ((fd = virFileOpenForked(path, openflags, mode, uid, gid, flags)) < 0) {\n            ret = fd;\n            goto error;\n        }\n    }\n\n    /* File is successfully opened */\n    return fd;\n\n error:\n    if (fd >= 0) {\n        /* some other failure after the open succeeded */\n        VIR_FORCE_CLOSE(fd);\n        if (created)\n            unlink(path);\n    }\n    /* whoever failed the open last has already set ret = -errno */\n    return ret;\n}"
  },
  {
    "function_name": "virFileOpenForked",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "2220-2353",
    "snippet": "static int\nvirFileOpenForked(const char *path, int openflags, mode_t mode,\n                  uid_t uid, gid_t gid, unsigned int flags)\n{\n    pid_t pid;\n    int status = 0, ret = 0;\n    int recvfd_errno = 0;\n    int fd = -1;\n    int pair[2] = { -1, -1 };\n    g_autofree gid_t *groups = NULL;\n    int ngroups;\n    bool created = false;\n\n    /* parent is running as root, but caller requested that the\n     * file be opened as some other user and/or group). The\n     * following dance avoids problems caused by root-squashing\n     * NFS servers. */\n\n    ngroups = virGetGroupList(uid, gid, &groups);\n    if (ngroups < 0)\n        return -errno;\n\n    if (socketpair(AF_UNIX, SOCK_STREAM, 0, pair) < 0) {\n        ret = -errno;\n        virReportSystemError(errno,\n                             _(\"failed to create socket needed for '%s'\"),\n                             path);\n        return ret;\n    }\n\n    pid = virFork();\n    if (pid < 0)\n        return -errno;\n\n    if (pid == 0) {\n\n        /* child */\n\n        /* set desired uid/gid, then attempt to create the file */\n        VIR_FORCE_CLOSE(pair[0]);\n        if (virSetUIDGID(uid, gid, groups, ngroups) < 0) {\n            ret = -errno;\n            goto childerror;\n        }\n\n        if ((fd = open(path, openflags, mode)) < 0) {\n            ret = -errno;\n            virReportSystemError(errno,\n                                 _(\"child process failed to create file '%s'\"),\n                                 path);\n            goto childerror;\n        }\n        if (openflags & O_CREAT)\n            created = true;\n\n        /* File is successfully open. Set permissions if requested. */\n        ret = virFileOpenForceOwnerMode(path, fd, mode, uid, gid, flags);\n        if (ret < 0) {\n            ret = -errno;\n            virReportSystemError(errno,\n                                 _(\"child process failed to force owner mode file '%s'\"),\n                                 path);\n            goto childerror;\n        }\n\n        do {\n            ret = virSocketSendFD(pair[1], fd);\n        } while (ret < 0 && errno == EINTR);\n\n        if (ret < 0) {\n            ret = -errno;\n            virReportSystemError(errno, \"%s\",\n                                 _(\"child process failed to send fd to parent\"));\n            goto childerror;\n        }\n\n    childerror:\n        /* ret tracks -errno on failure, but exit value must be positive.\n         * If the child exits with EACCES, then the parent tries again.  */\n        /* XXX This makes assumptions about errno being < 255, which is\n         * not true on Hurd.  */\n        VIR_FORCE_CLOSE(pair[1]);\n        if (ret < 0) {\n            VIR_FORCE_CLOSE(fd);\n            if (created)\n                unlink(path);\n        }\n        ret = -ret;\n        if ((ret & 0xff) != ret) {\n            VIR_WARN(\"unable to pass desired return value %d\", ret);\n            ret = 0xff;\n        }\n        _exit(ret);\n    }\n\n    /* parent */\n\n    VIR_FORCE_CLOSE(pair[1]);\n\n    do {\n        fd = virSocketRecvFD(pair[0], 0);\n    } while (fd < 0 && errno == EINTR);\n    VIR_FORCE_CLOSE(pair[0]); /* NB: this preserves errno */\n    if (fd < 0)\n        recvfd_errno = errno;\n\n    if (virProcessWait(pid, &status, 0) < 0) {\n        /* virProcessWait() reports errno on waitpid failure, so we'll just\n         * set our return status to EINTR; otherwise, set status to EACCES\n         * since the original failure for the fork+setuid path would have\n         * been EACCES or EPERM by definition.\n         */\n        if (virLastErrorIsSystemErrno(0))\n            status = EINTR;\n        else if (!status)\n            status = EACCES;\n    }\n\n    if (status) {\n        VIR_FORCE_CLOSE(fd);\n        return -status;\n    }\n\n    /* if waitpid succeeded, but recvfd failed, report recvfd_errno */\n    if (recvfd_errno != 0) {\n        virReportSystemError(recvfd_errno,\n                             _(\"failed recvfd for child creating '%s'\"),\n                             path);\n        return -recvfd_errno;\n    }\n\n    /* otherwise, waitpid and recvfd succeeded, return the fd */\n    return fd;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "recvfd_errno",
            "_(\"failed recvfd for child creating '%s'\")",
            "path"
          ],
          "line": 2345
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"failed recvfd for child creating '%s'\""
          ],
          "line": 2346
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FORCE_CLOSE",
          "args": [
            "fd"
          ],
          "line": 2339
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virLastErrorIsSystemErrno",
          "args": [
            "0"
          ],
          "line": 2332
        },
        "resolved": true,
        "details": {
          "function_name": "virLastErrorIsSystemErrno",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "1432-1442",
          "snippet": "bool virLastErrorIsSystemErrno(int errnum)\n{\n    virErrorPtr err = virGetLastError();\n    if (!err)\n        return false;\n    if (err->code != VIR_ERR_SYSTEM_ERROR)\n        return false;\n    if (errnum != 0 && err->int1 != errnum)\n        return false;\n    return true;\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nbool virLastErrorIsSystemErrno(int errnum)\n{\n    virErrorPtr err = virGetLastError();\n    if (!err)\n        return false;\n    if (err->code != VIR_ERR_SYSTEM_ERROR)\n        return false;\n    if (errnum != 0 && err->int1 != errnum)\n        return false;\n    return true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virProcessWait",
          "args": [
            "pid",
            "&status",
            "0"
          ],
          "line": 2326
        },
        "resolved": true,
        "details": {
          "function_name": "virProcessWait",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virprocess.c",
          "lines": "296-302",
          "snippet": "int\nvirProcessWait(pid_t pid, int *exitstatus G_GNUC_UNUSED, bool raw G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, _(\"unable to wait for process %lld\"),\n                         (long long) pid);\n    return -1;\n}",
          "includes": [
            "#   include <sys/syscall.h>",
            "#include \"vircommand.h\"",
            "#include \"virstring.h\"",
            "#include \"virutil.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virprocess.h\"",
            "# include <windows.h>",
            "# include <sys/cpuset.h>",
            "# include <sys/user.h>",
            "# include <sys/sysctl.h>",
            "# include <sys/param.h>",
            "# include <sched.h>",
            "# include <sys/resource.h>",
            "# include <sys/time.h>",
            "# include <sys/mount.h>",
            "#include <unistd.h>",
            "# include <sys/wait.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#   include <sys/syscall.h>\n#include \"vircommand.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virprocess.h\"\n# include <windows.h>\n# include <sys/cpuset.h>\n# include <sys/user.h>\n# include <sys/sysctl.h>\n# include <sys/param.h>\n# include <sched.h>\n# include <sys/resource.h>\n# include <sys/time.h>\n# include <sys/mount.h>\n#include <unistd.h>\n# include <sys/wait.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirProcessWait(pid_t pid, int *exitstatus G_GNUC_UNUSED, bool raw G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, _(\"unable to wait for process %lld\"),\n                         (long long) pid);\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FORCE_CLOSE",
          "args": [
            "pair[0]"
          ],
          "line": 2322
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virSocketRecvFD",
          "args": [
            "pair[0]",
            "0"
          ],
          "line": 2320
        },
        "resolved": true,
        "details": {
          "function_name": "virSocketRecvFD",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsocket.c",
          "lines": "496-501",
          "snippet": "int\nvirSocketRecvFD(int sock G_GNUC_UNUSED, int fdflags G_GNUC_UNUSED)\n{\n    errno = ENOSYS;\n    return -1;\n}",
          "includes": [
            "#include <fcntl.h>",
            "#include \"virfile.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <fcntl.h>\n#include \"virfile.h\"\n#include \"virutil.h\"\n#include \"virsocket.h\"\n#include <config.h>\n\nint\nvirSocketRecvFD(int sock G_GNUC_UNUSED, int fdflags G_GNUC_UNUSED)\n{\n    errno = ENOSYS;\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FORCE_CLOSE",
          "args": [
            "pair[1]"
          ],
          "line": 2317
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_exit",
          "args": [
            "ret"
          ],
          "line": 2312
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_WARN",
          "args": [
            "\"unable to pass desired return value %d\"",
            "ret"
          ],
          "line": 2309
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlink",
          "args": [
            "path"
          ],
          "line": 2305
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FORCE_CLOSE",
          "args": [
            "fd"
          ],
          "line": 2303
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FORCE_CLOSE",
          "args": [
            "pair[1]"
          ],
          "line": 2301
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "\"%s\"",
            "_(\"child process failed to send fd to parent\")"
          ],
          "line": 2291
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virSocketSendFD",
          "args": [
            "pair[1]",
            "fd"
          ],
          "line": 2286
        },
        "resolved": true,
        "details": {
          "function_name": "virSocketSendFD",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsocket.c",
          "lines": "489-494",
          "snippet": "int\nvirSocketSendFD(int sock G_GNUC_UNUSED, int fd G_GNUC_UNUSED)\n{\n    errno = ENOSYS;\n    return -1;\n}",
          "includes": [
            "#include <fcntl.h>",
            "#include \"virfile.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <fcntl.h>\n#include \"virfile.h\"\n#include \"virutil.h\"\n#include \"virsocket.h\"\n#include <config.h>\n\nint\nvirSocketSendFD(int sock G_GNUC_UNUSED, int fd G_GNUC_UNUSED)\n{\n    errno = ENOSYS;\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"child process failed to force owner mode file '%s'\")",
            "path"
          ],
          "line": 2279
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virFileOpenForceOwnerMode",
          "args": [
            "path",
            "fd",
            "mode",
            "uid",
            "gid",
            "flags"
          ],
          "line": 2276
        },
        "resolved": true,
        "details": {
          "function_name": "virFileOpenForceOwnerMode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "2169-2208",
          "snippet": "static int\nvirFileOpenForceOwnerMode(const char *path, int fd, mode_t mode,\n                          uid_t uid, gid_t gid, unsigned int flags)\n{\n    int ret = 0;\n    struct stat st;\n\n    if (!(flags & (VIR_FILE_OPEN_FORCE_OWNER | VIR_FILE_OPEN_FORCE_MODE)))\n        return 0;\n\n    if (fstat(fd, &st) == -1) {\n        ret = -errno;\n        virReportSystemError(errno, _(\"stat of '%s' failed\"), path);\n        return ret;\n    }\n    /* NB: uid:gid are never \"-1\" (default) at this point - the caller\n     * has always changed -1 to the value of get[gu]id().\n    */\n    if ((flags & VIR_FILE_OPEN_FORCE_OWNER) &&\n        ((st.st_uid != uid) || (st.st_gid != gid)) &&\n        (fchown(fd, uid, gid) < 0)) {\n        ret = -errno;\n        virReportSystemError(errno,\n                             _(\"cannot chown '%s' to (%u, %u)\"),\n                             path, (unsigned int) uid,\n                             (unsigned int) gid);\n        return ret;\n    }\n    if ((flags & VIR_FILE_OPEN_FORCE_MODE) &&\n        ((mode & (S_IRWXU|S_IRWXG|S_IRWXO)) !=\n         (st.st_mode & (S_IRWXU|S_IRWXG|S_IRWXO))) &&\n        (fchmod(fd, mode) < 0)) {\n        ret = -errno;\n        virReportSystemError(errno,\n                             _(\"cannot set mode of '%s' to %04o\"),\n                             path, mode);\n        return ret;\n    }\n    return ret;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nvirFileOpenForceOwnerMode(const char *path, int fd, mode_t mode,\n                          uid_t uid, gid_t gid, unsigned int flags)\n{\n    int ret = 0;\n    struct stat st;\n\n    if (!(flags & (VIR_FILE_OPEN_FORCE_OWNER | VIR_FILE_OPEN_FORCE_MODE)))\n        return 0;\n\n    if (fstat(fd, &st) == -1) {\n        ret = -errno;\n        virReportSystemError(errno, _(\"stat of '%s' failed\"), path);\n        return ret;\n    }\n    /* NB: uid:gid are never \"-1\" (default) at this point - the caller\n     * has always changed -1 to the value of get[gu]id().\n    */\n    if ((flags & VIR_FILE_OPEN_FORCE_OWNER) &&\n        ((st.st_uid != uid) || (st.st_gid != gid)) &&\n        (fchown(fd, uid, gid) < 0)) {\n        ret = -errno;\n        virReportSystemError(errno,\n                             _(\"cannot chown '%s' to (%u, %u)\"),\n                             path, (unsigned int) uid,\n                             (unsigned int) gid);\n        return ret;\n    }\n    if ((flags & VIR_FILE_OPEN_FORCE_MODE) &&\n        ((mode & (S_IRWXU|S_IRWXG|S_IRWXO)) !=\n         (st.st_mode & (S_IRWXU|S_IRWXG|S_IRWXO))) &&\n        (fchmod(fd, mode) < 0)) {\n        ret = -errno;\n        virReportSystemError(errno,\n                             _(\"cannot set mode of '%s' to %04o\"),\n                             path, mode);\n        return ret;\n    }\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"child process failed to create file '%s'\")",
            "path"
          ],
          "line": 2267
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "open",
          "args": [
            "path",
            "openflags",
            "mode"
          ],
          "line": 2265
        },
        "resolved": true,
        "details": {
          "function_name": "qemuBlockReopenReadOnly",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
          "lines": "3308-3323",
          "snippet": "int\nqemuBlockReopenReadOnly(virDomainObjPtr vm,\n                         virStorageSourcePtr src,\n                         qemuDomainAsyncJob asyncJob)\n{\n    if (src->readonly)\n        return 0;\n\n    src->readonly = true;\n    if (qemuBlockReopenFormat(vm, src, asyncJob) < 0) {\n        src->readonly = false;\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_block.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nint\nqemuBlockReopenReadOnly(virDomainObjPtr vm,\n                         virStorageSourcePtr src,\n                         qemuDomainAsyncJob asyncJob)\n{\n    if (src->readonly)\n        return 0;\n\n    src->readonly = true;\n    if (qemuBlockReopenFormat(vm, src, asyncJob) < 0) {\n        src->readonly = false;\n        return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSetUIDGID",
          "args": [
            "uid",
            "gid",
            "groups",
            "ngroups"
          ],
          "line": 2260
        },
        "resolved": true,
        "details": {
          "function_name": "virSetUIDGID",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
          "lines": "1147-1156",
          "snippet": "int\nvirSetUIDGID(uid_t uid G_GNUC_UNUSED,\n             gid_t gid G_GNUC_UNUSED,\n             gid_t *groups G_GNUC_UNUSED,\n             int ngroups G_GNUC_UNUSED)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   \"%s\", _(\"virSetUIDGID is not available\"));\n    return -1;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <sys/prctl.h>",
            "# include <cap-ng.h>",
            "# include <grp.h>",
            "# include <pwd.h>",
            "# include <libdevmapper.h>",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <conio.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nint\nvirSetUIDGID(uid_t uid G_GNUC_UNUSED,\n             gid_t gid G_GNUC_UNUSED,\n             gid_t *groups G_GNUC_UNUSED,\n             int ngroups G_GNUC_UNUSED)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   \"%s\", _(\"virSetUIDGID is not available\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FORCE_CLOSE",
          "args": [
            "pair[0]"
          ],
          "line": 2259
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virFork",
          "args": [],
          "line": 2250
        },
        "resolved": true,
        "details": {
          "function_name": "virFork",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "902-908",
          "snippet": "pid_t\nvirFork(void)\n{\n    errno = ENOTSUP;\n\n    return -1;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\npid_t\nvirFork(void)\n{\n    errno = ENOTSUP;\n\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"failed to create socket needed for '%s'\")",
            "path"
          ],
          "line": 2244
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "socketpair",
          "args": [
            "AF_UNIX",
            "SOCK_STREAM",
            "0",
            "pair"
          ],
          "line": 2242
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virGetGroupList",
          "args": [
            "uid",
            "gid",
            "&groups"
          ],
          "line": 2238
        },
        "resolved": true,
        "details": {
          "function_name": "virGetGroupList",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
          "lines": "1059-1065",
          "snippet": "int\nvirGetGroupList(uid_t uid G_GNUC_UNUSED, gid_t gid G_GNUC_UNUSED,\n                gid_t **list)\n{\n    *list = NULL;\n    return 0;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <sys/prctl.h>",
            "# include <cap-ng.h>",
            "# include <grp.h>",
            "# include <pwd.h>",
            "# include <libdevmapper.h>",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <conio.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nint\nvirGetGroupList(uid_t uid G_GNUC_UNUSED, gid_t gid G_GNUC_UNUSED,\n                gid_t **list)\n{\n    *list = NULL;\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nvirFileOpenForked(const char *path, int openflags, mode_t mode,\n                  uid_t uid, gid_t gid, unsigned int flags)\n{\n    pid_t pid;\n    int status = 0, ret = 0;\n    int recvfd_errno = 0;\n    int fd = -1;\n    int pair[2] = { -1, -1 };\n    g_autofree gid_t *groups = NULL;\n    int ngroups;\n    bool created = false;\n\n    /* parent is running as root, but caller requested that the\n     * file be opened as some other user and/or group). The\n     * following dance avoids problems caused by root-squashing\n     * NFS servers. */\n\n    ngroups = virGetGroupList(uid, gid, &groups);\n    if (ngroups < 0)\n        return -errno;\n\n    if (socketpair(AF_UNIX, SOCK_STREAM, 0, pair) < 0) {\n        ret = -errno;\n        virReportSystemError(errno,\n                             _(\"failed to create socket needed for '%s'\"),\n                             path);\n        return ret;\n    }\n\n    pid = virFork();\n    if (pid < 0)\n        return -errno;\n\n    if (pid == 0) {\n\n        /* child */\n\n        /* set desired uid/gid, then attempt to create the file */\n        VIR_FORCE_CLOSE(pair[0]);\n        if (virSetUIDGID(uid, gid, groups, ngroups) < 0) {\n            ret = -errno;\n            goto childerror;\n        }\n\n        if ((fd = open(path, openflags, mode)) < 0) {\n            ret = -errno;\n            virReportSystemError(errno,\n                                 _(\"child process failed to create file '%s'\"),\n                                 path);\n            goto childerror;\n        }\n        if (openflags & O_CREAT)\n            created = true;\n\n        /* File is successfully open. Set permissions if requested. */\n        ret = virFileOpenForceOwnerMode(path, fd, mode, uid, gid, flags);\n        if (ret < 0) {\n            ret = -errno;\n            virReportSystemError(errno,\n                                 _(\"child process failed to force owner mode file '%s'\"),\n                                 path);\n            goto childerror;\n        }\n\n        do {\n            ret = virSocketSendFD(pair[1], fd);\n        } while (ret < 0 && errno == EINTR);\n\n        if (ret < 0) {\n            ret = -errno;\n            virReportSystemError(errno, \"%s\",\n                                 _(\"child process failed to send fd to parent\"));\n            goto childerror;\n        }\n\n    childerror:\n        /* ret tracks -errno on failure, but exit value must be positive.\n         * If the child exits with EACCES, then the parent tries again.  */\n        /* XXX This makes assumptions about errno being < 255, which is\n         * not true on Hurd.  */\n        VIR_FORCE_CLOSE(pair[1]);\n        if (ret < 0) {\n            VIR_FORCE_CLOSE(fd);\n            if (created)\n                unlink(path);\n        }\n        ret = -ret;\n        if ((ret & 0xff) != ret) {\n            VIR_WARN(\"unable to pass desired return value %d\", ret);\n            ret = 0xff;\n        }\n        _exit(ret);\n    }\n\n    /* parent */\n\n    VIR_FORCE_CLOSE(pair[1]);\n\n    do {\n        fd = virSocketRecvFD(pair[0], 0);\n    } while (fd < 0 && errno == EINTR);\n    VIR_FORCE_CLOSE(pair[0]); /* NB: this preserves errno */\n    if (fd < 0)\n        recvfd_errno = errno;\n\n    if (virProcessWait(pid, &status, 0) < 0) {\n        /* virProcessWait() reports errno on waitpid failure, so we'll just\n         * set our return status to EINTR; otherwise, set status to EACCES\n         * since the original failure for the fork+setuid path would have\n         * been EACCES or EPERM by definition.\n         */\n        if (virLastErrorIsSystemErrno(0))\n            status = EINTR;\n        else if (!status)\n            status = EACCES;\n    }\n\n    if (status) {\n        VIR_FORCE_CLOSE(fd);\n        return -status;\n    }\n\n    /* if waitpid succeeded, but recvfd failed, report recvfd_errno */\n    if (recvfd_errno != 0) {\n        virReportSystemError(recvfd_errno,\n                             _(\"failed recvfd for child creating '%s'\"),\n                             path);\n        return -recvfd_errno;\n    }\n\n    /* otherwise, waitpid and recvfd succeeded, return the fd */\n    return fd;\n}"
  },
  {
    "function_name": "virFileOpenForceOwnerMode",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "2169-2208",
    "snippet": "static int\nvirFileOpenForceOwnerMode(const char *path, int fd, mode_t mode,\n                          uid_t uid, gid_t gid, unsigned int flags)\n{\n    int ret = 0;\n    struct stat st;\n\n    if (!(flags & (VIR_FILE_OPEN_FORCE_OWNER | VIR_FILE_OPEN_FORCE_MODE)))\n        return 0;\n\n    if (fstat(fd, &st) == -1) {\n        ret = -errno;\n        virReportSystemError(errno, _(\"stat of '%s' failed\"), path);\n        return ret;\n    }\n    /* NB: uid:gid are never \"-1\" (default) at this point - the caller\n     * has always changed -1 to the value of get[gu]id().\n    */\n    if ((flags & VIR_FILE_OPEN_FORCE_OWNER) &&\n        ((st.st_uid != uid) || (st.st_gid != gid)) &&\n        (fchown(fd, uid, gid) < 0)) {\n        ret = -errno;\n        virReportSystemError(errno,\n                             _(\"cannot chown '%s' to (%u, %u)\"),\n                             path, (unsigned int) uid,\n                             (unsigned int) gid);\n        return ret;\n    }\n    if ((flags & VIR_FILE_OPEN_FORCE_MODE) &&\n        ((mode & (S_IRWXU|S_IRWXG|S_IRWXO)) !=\n         (st.st_mode & (S_IRWXU|S_IRWXG|S_IRWXO))) &&\n        (fchmod(fd, mode) < 0)) {\n        ret = -errno;\n        virReportSystemError(errno,\n                             _(\"cannot set mode of '%s' to %04o\"),\n                             path, mode);\n        return ret;\n    }\n    return ret;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"cannot set mode of '%s' to %04o\")",
            "path",
            "mode"
          ],
          "line": 2202
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"cannot set mode of '%s' to %04o\""
          ],
          "line": 2203
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "fchmod",
          "args": [
            "fd",
            "mode"
          ],
          "line": 2200
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"cannot chown '%s' to (%u, %u)\")",
            "path",
            "(unsigned int) uid",
            "(unsigned int) gid"
          ],
          "line": 2191
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fchown",
          "args": [
            "fd",
            "uid",
            "gid"
          ],
          "line": 2189
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"stat of '%s' failed\")",
            "path"
          ],
          "line": 2181
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fstat",
          "args": [
            "fd",
            "&st"
          ],
          "line": 2179
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nvirFileOpenForceOwnerMode(const char *path, int fd, mode_t mode,\n                          uid_t uid, gid_t gid, unsigned int flags)\n{\n    int ret = 0;\n    struct stat st;\n\n    if (!(flags & (VIR_FILE_OPEN_FORCE_OWNER | VIR_FILE_OPEN_FORCE_MODE)))\n        return 0;\n\n    if (fstat(fd, &st) == -1) {\n        ret = -errno;\n        virReportSystemError(errno, _(\"stat of '%s' failed\"), path);\n        return ret;\n    }\n    /* NB: uid:gid are never \"-1\" (default) at this point - the caller\n     * has always changed -1 to the value of get[gu]id().\n    */\n    if ((flags & VIR_FILE_OPEN_FORCE_OWNER) &&\n        ((st.st_uid != uid) || (st.st_gid != gid)) &&\n        (fchown(fd, uid, gid) < 0)) {\n        ret = -errno;\n        virReportSystemError(errno,\n                             _(\"cannot chown '%s' to (%u, %u)\"),\n                             path, (unsigned int) uid,\n                             (unsigned int) gid);\n        return ret;\n    }\n    if ((flags & VIR_FILE_OPEN_FORCE_MODE) &&\n        ((mode & (S_IRWXU|S_IRWXG|S_IRWXO)) !=\n         (st.st_mode & (S_IRWXU|S_IRWXG|S_IRWXO))) &&\n        (fchmod(fd, mode) < 0)) {\n        ret = -errno;\n        virReportSystemError(errno,\n                             _(\"cannot set mode of '%s' to %04o\"),\n                             path, mode);\n        return ret;\n    }\n    return ret;\n}"
  },
  {
    "function_name": "virFileAccessibleAs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "2111-2163",
    "snippet": "int\nvirFileAccessibleAs(const char *path, int mode,\n                    uid_t uid, gid_t gid)\n{\n    pid_t pid = 0;\n    int status, ret = 0;\n    g_autofree gid_t *groups = NULL;\n    int ngroups;\n\n    if (uid == geteuid() &&\n        gid == getegid())\n        return access(path, mode);\n\n    ngroups = virGetGroupList(uid, gid, &groups);\n    if (ngroups < 0)\n        return -1;\n\n    pid = virFork();\n\n    if (pid < 0)\n        return -1;\n\n    if (pid) { /* parent */\n        if (virProcessWait(pid, &status, false) < 0) {\n            /* virProcessWait() already reported error */\n            errno = EINTR;\n            return -1;\n        }\n\n        if (status) {\n            errno = status;\n            return -1;\n        }\n\n        return 0;\n    }\n\n    if (virSetUIDGID(uid, gid, groups, ngroups) < 0) {\n        ret = errno;\n        goto childerror;\n    }\n\n    if (access(path, mode) < 0)\n        ret = errno;\n\n childerror:\n    if ((ret & 0xFF) != ret) {\n        VIR_WARN(\"unable to pass desired return value %d\", ret);\n        ret = 0xFF;\n    }\n\n    _exit(ret);\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_exit",
          "args": [
            "ret"
          ],
          "line": 2162
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_WARN",
          "args": [
            "\"unable to pass desired return value %d\"",
            "ret"
          ],
          "line": 2158
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "access",
          "args": [
            "path",
            "mode"
          ],
          "line": 2153
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virSetUIDGID",
          "args": [
            "uid",
            "gid",
            "groups",
            "ngroups"
          ],
          "line": 2148
        },
        "resolved": true,
        "details": {
          "function_name": "virSetUIDGID",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
          "lines": "1147-1156",
          "snippet": "int\nvirSetUIDGID(uid_t uid G_GNUC_UNUSED,\n             gid_t gid G_GNUC_UNUSED,\n             gid_t *groups G_GNUC_UNUSED,\n             int ngroups G_GNUC_UNUSED)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   \"%s\", _(\"virSetUIDGID is not available\"));\n    return -1;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <sys/prctl.h>",
            "# include <cap-ng.h>",
            "# include <grp.h>",
            "# include <pwd.h>",
            "# include <libdevmapper.h>",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <conio.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nint\nvirSetUIDGID(uid_t uid G_GNUC_UNUSED,\n             gid_t gid G_GNUC_UNUSED,\n             gid_t *groups G_GNUC_UNUSED,\n             int ngroups G_GNUC_UNUSED)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   \"%s\", _(\"virSetUIDGID is not available\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virProcessWait",
          "args": [
            "pid",
            "&status",
            "false"
          ],
          "line": 2134
        },
        "resolved": true,
        "details": {
          "function_name": "virProcessWait",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virprocess.c",
          "lines": "296-302",
          "snippet": "int\nvirProcessWait(pid_t pid, int *exitstatus G_GNUC_UNUSED, bool raw G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, _(\"unable to wait for process %lld\"),\n                         (long long) pid);\n    return -1;\n}",
          "includes": [
            "#   include <sys/syscall.h>",
            "#include \"vircommand.h\"",
            "#include \"virstring.h\"",
            "#include \"virutil.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virprocess.h\"",
            "# include <windows.h>",
            "# include <sys/cpuset.h>",
            "# include <sys/user.h>",
            "# include <sys/sysctl.h>",
            "# include <sys/param.h>",
            "# include <sched.h>",
            "# include <sys/resource.h>",
            "# include <sys/time.h>",
            "# include <sys/mount.h>",
            "#include <unistd.h>",
            "# include <sys/wait.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#   include <sys/syscall.h>\n#include \"vircommand.h\"\n#include \"virstring.h\"\n#include \"virutil.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virprocess.h\"\n# include <windows.h>\n# include <sys/cpuset.h>\n# include <sys/user.h>\n# include <sys/sysctl.h>\n# include <sys/param.h>\n# include <sched.h>\n# include <sys/resource.h>\n# include <sys/time.h>\n# include <sys/mount.h>\n#include <unistd.h>\n# include <sys/wait.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirProcessWait(pid_t pid, int *exitstatus G_GNUC_UNUSED, bool raw G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, _(\"unable to wait for process %lld\"),\n                         (long long) pid);\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virFork",
          "args": [],
          "line": 2128
        },
        "resolved": true,
        "details": {
          "function_name": "virFork",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "902-908",
          "snippet": "pid_t\nvirFork(void)\n{\n    errno = ENOTSUP;\n\n    return -1;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\npid_t\nvirFork(void)\n{\n    errno = ENOTSUP;\n\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virGetGroupList",
          "args": [
            "uid",
            "gid",
            "&groups"
          ],
          "line": 2124
        },
        "resolved": true,
        "details": {
          "function_name": "virGetGroupList",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
          "lines": "1059-1065",
          "snippet": "int\nvirGetGroupList(uid_t uid G_GNUC_UNUSED, gid_t gid G_GNUC_UNUSED,\n                gid_t **list)\n{\n    *list = NULL;\n    return 0;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <sys/prctl.h>",
            "# include <cap-ng.h>",
            "# include <grp.h>",
            "# include <pwd.h>",
            "# include <libdevmapper.h>",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <conio.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nint\nvirGetGroupList(uid_t uid G_GNUC_UNUSED, gid_t gid G_GNUC_UNUSED,\n                gid_t **list)\n{\n    *list = NULL;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "access",
          "args": [
            "path",
            "mode"
          ],
          "line": 2122
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getegid",
          "args": [],
          "line": 2121
        },
        "resolved": true,
        "details": {
          "function_name": "getegid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.h",
          "lines": "78-79",
          "snippet": "static inline int getegid(void)\n{ return 0; }",
          "includes": [
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include \"internal.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/types.h>\n#include <unistd.h>\n#include \"internal.h\"\n\nstatic inline int getegid(void)\n{ return 0; }"
        }
      },
      {
        "call_info": {
          "callee": "geteuid",
          "args": [],
          "line": 2120
        },
        "resolved": true,
        "details": {
          "function_name": "geteuid",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.h",
          "lines": "68-69",
          "snippet": "static inline int geteuid(void)\n{ return 0; }",
          "includes": [
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include \"internal.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/types.h>\n#include <unistd.h>\n#include \"internal.h\"\n\nstatic inline int geteuid(void)\n{ return 0; }"
        }
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileAccessibleAs(const char *path, int mode,\n                    uid_t uid, gid_t gid)\n{\n    pid_t pid = 0;\n    int status, ret = 0;\n    g_autofree gid_t *groups = NULL;\n    int ngroups;\n\n    if (uid == geteuid() &&\n        gid == getegid())\n        return access(path, mode);\n\n    ngroups = virGetGroupList(uid, gid, &groups);\n    if (ngroups < 0)\n        return -1;\n\n    pid = virFork();\n\n    if (pid < 0)\n        return -1;\n\n    if (pid) { /* parent */\n        if (virProcessWait(pid, &status, false) < 0) {\n            /* virProcessWait() already reported error */\n            errno = EINTR;\n            return -1;\n        }\n\n        if (status) {\n            errno = status;\n            return -1;\n        }\n\n        return 0;\n    }\n\n    if (virSetUIDGID(uid, gid, groups, ngroups) < 0) {\n        ret = errno;\n        goto childerror;\n    }\n\n    if (access(path, mode) < 0)\n        ret = errno;\n\n childerror:\n    if ((ret & 0xFF) != ret) {\n        VIR_WARN(\"unable to pass desired return value %d\", ret);\n        ret = 0xFF;\n    }\n\n    _exit(ret);\n}"
  },
  {
    "function_name": "virFileGetMountReverseSubtree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "2096-2102",
    "snippet": "int virFileGetMountReverseSubtree(const char *mtabpath,\n                                  const char *prefix,\n                                  char ***mountsret,\n                                  size_t *nmountsret)\n{\n    return virFileGetMountSubtreeImpl(mtabpath, prefix, mountsret, nmountsret, true);\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virFileGetMountSubtreeImpl",
          "args": [
            "mtabpath",
            "prefix",
            "mountsret",
            "nmountsret",
            "true"
          ],
          "line": 2101
        },
        "resolved": true,
        "details": {
          "function_name": "virFileGetMountSubtreeImpl",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "2045-2055",
          "snippet": "static int\nvirFileGetMountSubtreeImpl(const char *mtabpath G_GNUC_UNUSED,\n                           const char *prefix G_GNUC_UNUSED,\n                           char ***mountsret G_GNUC_UNUSED,\n                           size_t *nmountsret G_GNUC_UNUSED,\n                           bool reverse G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to determine mount table on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nvirFileGetMountSubtreeImpl(const char *mtabpath G_GNUC_UNUSED,\n                           const char *prefix G_GNUC_UNUSED,\n                           char ***mountsret G_GNUC_UNUSED,\n                           size_t *nmountsret G_GNUC_UNUSED,\n                           bool reverse G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to determine mount table on this platform\"));\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint virFileGetMountReverseSubtree(const char *mtabpath,\n                                  const char *prefix,\n                                  char ***mountsret,\n                                  size_t *nmountsret)\n{\n    return virFileGetMountSubtreeImpl(mtabpath, prefix, mountsret, nmountsret, true);\n}"
  },
  {
    "function_name": "virFileGetMountSubtree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "2073-2079",
    "snippet": "int virFileGetMountSubtree(const char *mtabpath,\n                           const char *prefix,\n                           char ***mountsret,\n                           size_t *nmountsret)\n{\n    return virFileGetMountSubtreeImpl(mtabpath, prefix, mountsret, nmountsret, false);\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virFileGetMountSubtreeImpl",
          "args": [
            "mtabpath",
            "prefix",
            "mountsret",
            "nmountsret",
            "false"
          ],
          "line": 2078
        },
        "resolved": true,
        "details": {
          "function_name": "virFileGetMountSubtreeImpl",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "2045-2055",
          "snippet": "static int\nvirFileGetMountSubtreeImpl(const char *mtabpath G_GNUC_UNUSED,\n                           const char *prefix G_GNUC_UNUSED,\n                           char ***mountsret G_GNUC_UNUSED,\n                           size_t *nmountsret G_GNUC_UNUSED,\n                           bool reverse G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to determine mount table on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nvirFileGetMountSubtreeImpl(const char *mtabpath G_GNUC_UNUSED,\n                           const char *prefix G_GNUC_UNUSED,\n                           char ***mountsret G_GNUC_UNUSED,\n                           size_t *nmountsret G_GNUC_UNUSED,\n                           bool reverse G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to determine mount table on this platform\"));\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint virFileGetMountSubtree(const char *mtabpath,\n                           const char *prefix,\n                           char ***mountsret,\n                           size_t *nmountsret)\n{\n    return virFileGetMountSubtreeImpl(mtabpath, prefix, mountsret, nmountsret, false);\n}"
  },
  {
    "function_name": "virFileGetMountSubtreeImpl",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "2045-2055",
    "snippet": "static int\nvirFileGetMountSubtreeImpl(const char *mtabpath G_GNUC_UNUSED,\n                           const char *prefix G_GNUC_UNUSED,\n                           char ***mountsret G_GNUC_UNUSED,\n                           size_t *nmountsret G_GNUC_UNUSED,\n                           bool reverse G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to determine mount table on this platform\"));\n    return -1;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "\"%s\"",
            "_(\"Unable to determine mount table on this platform\")"
          ],
          "line": 2052
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to determine mount table on this platform\""
          ],
          "line": 2053
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nvirFileGetMountSubtreeImpl(const char *mtabpath G_GNUC_UNUSED,\n                           const char *prefix G_GNUC_UNUSED,\n                           char ***mountsret G_GNUC_UNUSED,\n                           size_t *nmountsret G_GNUC_UNUSED,\n                           bool reverse G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to determine mount table on this platform\"));\n    return -1;\n}"
  },
  {
    "function_name": "virFileGetMountSubtreeImpl",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "1994-2043",
    "snippet": "static int\nvirFileGetMountSubtreeImpl(const char *mtabpath,\n                           const char *prefix,\n                           char ***mountsret,\n                           size_t *nmountsret,\n                           bool reverse)\n{\n    FILE *procmnt;\n    struct mntent mntent;\n    char mntbuf[1024];\n    int ret = -1;\n    char **mounts = NULL;\n    size_t nmounts = 0;\n\n    VIR_DEBUG(\"prefix=%s\", prefix);\n\n    *mountsret = NULL;\n    *nmountsret = 0;\n\n    if (!(procmnt = setmntent(mtabpath, \"r\"))) {\n        virReportSystemError(errno,\n                             _(\"Failed to read %s\"), mtabpath);\n        return -1;\n    }\n\n    while (getmntent_r(procmnt, &mntent, mntbuf, sizeof(mntbuf)) != NULL) {\n        if (!(STREQ(mntent.mnt_dir, prefix) ||\n              (STRPREFIX(mntent.mnt_dir, prefix) &&\n               mntent.mnt_dir[strlen(prefix)] == '/')))\n            continue;\n\n        if (VIR_EXPAND_N(mounts, nmounts, nmounts ? 1 : 2) < 0)\n            goto cleanup;\n        mounts[nmounts - 2] = g_strdup(mntent.mnt_dir);\n    }\n\n    if (mounts)\n        qsort(mounts, nmounts - 1, sizeof(mounts[0]),\n              reverse ? virStringSortRevCompare : virStringSortCompare);\n\n    *mountsret = mounts;\n    *nmountsret = nmounts ? nmounts - 1 : 0;\n    ret = 0;\n\n cleanup:\n    if (ret < 0)\n        virStringListFree(mounts);\n    endmntent(procmnt);\n    return ret;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "endmntent",
          "args": [
            "procmnt"
          ],
          "line": 2041
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStringListFree",
          "args": [
            "mounts"
          ],
          "line": 2040
        },
        "resolved": true,
        "details": {
          "function_name": "virStringListFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "306-314",
          "snippet": "void virStringListFree(char **strings)\n{\n    char **tmp = strings;\n    while (tmp && *tmp) {\n        VIR_FREE(*tmp);\n        tmp++;\n    }\n    VIR_FREE(strings);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nvoid virStringListFree(char **strings)\n{\n    char **tmp = strings;\n    while (tmp && *tmp) {\n        VIR_FREE(*tmp);\n        tmp++;\n    }\n    VIR_FREE(strings);\n}"
        }
      },
      {
        "call_info": {
          "callee": "qsort",
          "args": [
            "mounts",
            "nmounts - 1",
            "sizeof(mounts[0])",
            "reverse ? virStringSortRevCompare : virStringSortCompare"
          ],
          "line": 2031
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "mntent.mnt_dir"
          ],
          "line": 2027
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_EXPAND_N",
          "args": [
            "mounts",
            "nmounts",
            "nmounts ? 1 : 2"
          ],
          "line": 2025
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "prefix"
          ],
          "line": 2022
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STRPREFIX",
          "args": [
            "mntent.mnt_dir",
            "prefix"
          ],
          "line": 2021
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "mntent.mnt_dir",
            "prefix"
          ],
          "line": 2020
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getmntent_r",
          "args": [
            "procmnt",
            "&mntent",
            "mntbuf",
            "sizeof(mntbuf)"
          ],
          "line": 2019
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"Failed to read %s\")",
            "mtabpath"
          ],
          "line": 2014
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setmntent",
          "args": [
            "mtabpath",
            "\"r\""
          ],
          "line": 2013
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"prefix=%s\"",
            "prefix"
          ],
          "line": 2008
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nvirFileGetMountSubtreeImpl(const char *mtabpath,\n                           const char *prefix,\n                           char ***mountsret,\n                           size_t *nmountsret,\n                           bool reverse)\n{\n    FILE *procmnt;\n    struct mntent mntent;\n    char mntbuf[1024];\n    int ret = -1;\n    char **mounts = NULL;\n    size_t nmounts = 0;\n\n    VIR_DEBUG(\"prefix=%s\", prefix);\n\n    *mountsret = NULL;\n    *nmountsret = 0;\n\n    if (!(procmnt = setmntent(mtabpath, \"r\"))) {\n        virReportSystemError(errno,\n                             _(\"Failed to read %s\"), mtabpath);\n        return -1;\n    }\n\n    while (getmntent_r(procmnt, &mntent, mntbuf, sizeof(mntbuf)) != NULL) {\n        if (!(STREQ(mntent.mnt_dir, prefix) ||\n              (STRPREFIX(mntent.mnt_dir, prefix) &&\n               mntent.mnt_dir[strlen(prefix)] == '/')))\n            continue;\n\n        if (VIR_EXPAND_N(mounts, nmounts, nmounts ? 1 : 2) < 0)\n            goto cleanup;\n        mounts[nmounts - 2] = g_strdup(mntent.mnt_dir);\n    }\n\n    if (mounts)\n        qsort(mounts, nmounts - 1, sizeof(mounts[0]),\n              reverse ? virStringSortRevCompare : virStringSortCompare);\n\n    *mountsret = mounts;\n    *nmountsret = nmounts ? nmounts - 1 : 0;\n    ret = 0;\n\n cleanup:\n    if (ret < 0)\n        virStringListFree(mounts);\n    endmntent(procmnt);\n    return ret;\n}"
  },
  {
    "function_name": "virFileIsCDROM",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "1980-1988",
    "snippet": "int\nvirFileIsCDROM(const char *path)\n{\n    if (STRPREFIX(path, \"/dev/cd\") ||\n        STRPREFIX(path, \"/dev/acd\"))\n        return 1;\n\n    return 0;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "STRPREFIX",
          "args": [
            "path",
            "\"/dev/acd\""
          ],
          "line": 1984
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STRPREFIX",
          "args": [
            "path",
            "\"/dev/cd\""
          ],
          "line": 1983
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileIsCDROM(const char *path)\n{\n    if (STRPREFIX(path, \"/dev/cd\") ||\n        STRPREFIX(path, \"/dev/acd\"))\n        return 1;\n\n    return 0;\n}"
  },
  {
    "function_name": "virFileIsCDROM",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "1956-1976",
    "snippet": "int\nvirFileIsCDROM(const char *path)\n{\n    struct stat st;\n    VIR_AUTOCLOSE fd = -1;\n\n    if ((fd = open(path, O_RDONLY | O_NONBLOCK)) < 0)\n        return -1;\n\n    if (fstat(fd, &st) < 0)\n        return -1;\n\n    if (!S_ISBLK(st.st_mode))\n        return 0;\n\n    /* Attempt to detect via a CDROM specific ioctl */\n    if (ioctl(fd, CDROM_DRIVE_STATUS, CDSL_CURRENT) >= 0)\n        return 1;\n\n    return 0;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ioctl",
          "args": [
            "fd",
            "CDROM_DRIVE_STATUS",
            "CDSL_CURRENT"
          ],
          "line": 1972
        },
        "resolved": true,
        "details": {
          "function_name": "vir_ioctlsocket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsocket.c",
          "lines": "292-308",
          "snippet": "int\nvir_ioctlsocket(int fd, int cmd, void *arg)\n{\n    SOCKET sk = FD2SK(fd);\n\n    if (sk == INVALID_SOCKET) {\n        errno = EBADF;\n        return -1;\n    }\n\n    if (ioctlsocket(sk, cmd, arg) < 0) {\n        set_errno();\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include <fcntl.h>",
            "#include \"virfile.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <fcntl.h>\n#include \"virfile.h\"\n#include \"virutil.h\"\n#include \"virsocket.h\"\n#include <config.h>\n\nint\nvir_ioctlsocket(int fd, int cmd, void *arg)\n{\n    SOCKET sk = FD2SK(fd);\n\n    if (sk == INVALID_SOCKET) {\n        errno = EBADF;\n        return -1;\n    }\n\n    if (ioctlsocket(sk, cmd, arg) < 0) {\n        set_errno();\n        return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "S_ISBLK",
          "args": [
            "st.st_mode"
          ],
          "line": 1968
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fstat",
          "args": [
            "fd",
            "&st"
          ],
          "line": 1965
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "open",
          "args": [
            "path",
            "O_RDONLY | O_NONBLOCK"
          ],
          "line": 1962
        },
        "resolved": true,
        "details": {
          "function_name": "virFileFdopen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "164-177",
          "snippet": "FILE *virFileFdopen(int *fdptr, const char *mode)\n{\n    FILE *file = NULL;\n\n    if (*fdptr >= 0) {\n        file = fdopen(*fdptr, mode);\n        if (file)\n            *fdptr = -1;\n    } else {\n        errno = EBADF;\n    }\n\n    return file;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nFILE *virFileFdopen(int *fdptr, const char *mode)\n{\n    FILE *file = NULL;\n\n    if (*fdptr >= 0) {\n        file = fdopen(*fdptr, mode);\n        if (file)\n            *fdptr = -1;\n    } else {\n        errno = EBADF;\n    }\n\n    return file;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileIsCDROM(const char *path)\n{\n    struct stat st;\n    VIR_AUTOCLOSE fd = -1;\n\n    if ((fd = open(path, O_RDONLY | O_NONBLOCK)) < 0)\n        return -1;\n\n    if (fstat(fd, &st) < 0)\n        return -1;\n\n    if (!S_ISBLK(st.st_mode))\n        return 0;\n\n    /* Attempt to detect via a CDROM specific ioctl */\n    if (ioctl(fd, CDROM_DRIVE_STATUS, CDSL_CURRENT) >= 0)\n        return 1;\n\n    return 0;\n}"
  },
  {
    "function_name": "virFileIsMountPoint",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "1910-1944",
    "snippet": "int virFileIsMountPoint(const char *file)\n{\n    g_autofree char *parent = NULL;\n    int ret;\n    struct stat sb1, sb2;\n\n    parent = g_path_get_dirname(file);\n\n    VIR_DEBUG(\"Comparing '%s' to '%s'\", file, parent);\n\n    if (stat(file, &sb1) < 0) {\n        if (errno == ENOENT)\n            return 0;\n        else\n            virReportSystemError(errno,\n                                 _(\"Cannot stat '%s'\"),\n                                 file);\n        return -1;\n    }\n\n    if (stat(parent, &sb2) < 0) {\n        virReportSystemError(errno,\n                             _(\"Cannot stat '%s'\"),\n                             parent);\n        return -1;\n    }\n\n    if (!S_ISDIR(sb1.st_mode))\n        return 0;\n\n    ret = sb1.st_dev != sb2.st_dev;\n    VIR_DEBUG(\"Is mount %d\", ret);\n\n    return ret;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Is mount %d\"",
            "ret"
          ],
          "line": 1941
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "S_ISDIR",
          "args": [
            "sb1.st_mode"
          ],
          "line": 1937
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"Cannot stat '%s'\")",
            "parent"
          ],
          "line": 1931
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Cannot stat '%s'\""
          ],
          "line": 1932
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "stat",
          "args": [
            "parent",
            "&sb2"
          ],
          "line": 1930
        },
        "resolved": true,
        "details": {
          "function_name": "profile_status",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_apparmor.c",
          "lines": "70-108",
          "snippet": "static int\nprofile_status(const char *str, const int check_enforcing)\n{\n    char *content = NULL;\n    char *tmp = NULL;\n    char *etmp = NULL;\n    int rc = -2;\n\n    /* create string that is '<str> \\0' for accurate matching */\n    tmp = g_strdup_printf(\"%s \", str);\n\n    if (check_enforcing != 0) {\n        /* create string that is '<str> (enforce)\\0' for accurate matching */\n        etmp = g_strdup_printf(\"%s (enforce)\", str);\n    }\n\n    if (virFileReadAll(APPARMOR_PROFILES_PATH, MAX_FILE_LEN, &content) < 0) {\n        virReportSystemError(errno,\n                             _(\"Failed to read AppArmor profiles list \"\n                             \"\\'%s\\'\"), APPARMOR_PROFILES_PATH);\n        goto cleanup;\n    }\n\n    if (strstr(content, tmp) != NULL)\n        rc = 0;\n    else\n        rc = -1; /* return -1 if not loaded */\n    if (check_enforcing != 0) {\n        if (rc == 0 && strstr(content, etmp) != NULL)\n            rc = 1;                 /* return '1' if loaded and enforcing */\n    }\n\n    VIR_FREE(content);\n cleanup:\n    VIR_FREE(tmp);\n    VIR_FREE(etmp);\n\n    return rc;\n}",
          "includes": [
            "#include \"virmdev.h\"",
            "#include \"virscsi.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"vircommand.h\"",
            "#include \"configmake.h\"",
            "#include \"virfile.h\"",
            "#include \"virscsivhost.h\"",
            "#include \"virusb.h\"",
            "#include \"virpci.h\"",
            "#include \"viruuid.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"security_apparmor.h\"",
            "#include \"internal.h\"",
            "#include <wait.h>",
            "#include <unistd.h>",
            "#include <sys/apparmor.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virmdev.h\"\n#include \"virscsi.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"configmake.h\"\n#include \"virfile.h\"\n#include \"virscsivhost.h\"\n#include \"virusb.h\"\n#include \"virpci.h\"\n#include \"viruuid.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"security_apparmor.h\"\n#include \"internal.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/apparmor.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nprofile_status(const char *str, const int check_enforcing)\n{\n    char *content = NULL;\n    char *tmp = NULL;\n    char *etmp = NULL;\n    int rc = -2;\n\n    /* create string that is '<str> \\0' for accurate matching */\n    tmp = g_strdup_printf(\"%s \", str);\n\n    if (check_enforcing != 0) {\n        /* create string that is '<str> (enforce)\\0' for accurate matching */\n        etmp = g_strdup_printf(\"%s (enforce)\", str);\n    }\n\n    if (virFileReadAll(APPARMOR_PROFILES_PATH, MAX_FILE_LEN, &content) < 0) {\n        virReportSystemError(errno,\n                             _(\"Failed to read AppArmor profiles list \"\n                             \"\\'%s\\'\"), APPARMOR_PROFILES_PATH);\n        goto cleanup;\n    }\n\n    if (strstr(content, tmp) != NULL)\n        rc = 0;\n    else\n        rc = -1; /* return -1 if not loaded */\n    if (check_enforcing != 0) {\n        if (rc == 0 && strstr(content, etmp) != NULL)\n            rc = 1;                 /* return '1' if loaded and enforcing */\n    }\n\n    VIR_FREE(content);\n cleanup:\n    VIR_FREE(tmp);\n    VIR_FREE(etmp);\n\n    return rc;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"Cannot stat '%s'\")",
            "file"
          ],
          "line": 1924
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Comparing '%s' to '%s'\"",
            "file",
            "parent"
          ],
          "line": 1918
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_path_get_dirname",
          "args": [
            "file"
          ],
          "line": 1916
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint virFileIsMountPoint(const char *file)\n{\n    g_autofree char *parent = NULL;\n    int ret;\n    struct stat sb1, sb2;\n\n    parent = g_path_get_dirname(file);\n\n    VIR_DEBUG(\"Comparing '%s' to '%s'\", file, parent);\n\n    if (stat(file, &sb1) < 0) {\n        if (errno == ENOENT)\n            return 0;\n        else\n            virReportSystemError(errno,\n                                 _(\"Cannot stat '%s'\"),\n                                 file);\n        return -1;\n    }\n\n    if (stat(parent, &sb2) < 0) {\n        virReportSystemError(errno,\n                             _(\"Cannot stat '%s'\"),\n                             parent);\n        return -1;\n    }\n\n    if (!S_ISDIR(sb1.st_mode))\n        return 0;\n\n    ret = sb1.st_dev != sb2.st_dev;\n    VIR_DEBUG(\"Is mount %d\", ret);\n\n    return ret;\n}"
  },
  {
    "function_name": "virFileIsExecutable",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "1886-1899",
    "snippet": "bool\nvirFileIsExecutable(const char *file)\n{\n    struct stat sb;\n\n    /* We would also want to check faccessat if we cared about ACLs,\n     * but we don't.  */\n    if (stat(file, &sb) < 0)\n        return false;\n    if (S_ISREG(sb.st_mode) && (sb.st_mode & 0111) != 0)\n        return true;\n    errno = S_ISDIR(sb.st_mode) ? EISDIR : EACCES;\n    return false;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "S_ISDIR",
          "args": [
            "sb.st_mode"
          ],
          "line": 1897
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "S_ISREG",
          "args": [
            "sb.st_mode"
          ],
          "line": 1895
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "stat",
          "args": [
            "file",
            "&sb"
          ],
          "line": 1893
        },
        "resolved": true,
        "details": {
          "function_name": "profile_status",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_apparmor.c",
          "lines": "70-108",
          "snippet": "static int\nprofile_status(const char *str, const int check_enforcing)\n{\n    char *content = NULL;\n    char *tmp = NULL;\n    char *etmp = NULL;\n    int rc = -2;\n\n    /* create string that is '<str> \\0' for accurate matching */\n    tmp = g_strdup_printf(\"%s \", str);\n\n    if (check_enforcing != 0) {\n        /* create string that is '<str> (enforce)\\0' for accurate matching */\n        etmp = g_strdup_printf(\"%s (enforce)\", str);\n    }\n\n    if (virFileReadAll(APPARMOR_PROFILES_PATH, MAX_FILE_LEN, &content) < 0) {\n        virReportSystemError(errno,\n                             _(\"Failed to read AppArmor profiles list \"\n                             \"\\'%s\\'\"), APPARMOR_PROFILES_PATH);\n        goto cleanup;\n    }\n\n    if (strstr(content, tmp) != NULL)\n        rc = 0;\n    else\n        rc = -1; /* return -1 if not loaded */\n    if (check_enforcing != 0) {\n        if (rc == 0 && strstr(content, etmp) != NULL)\n            rc = 1;                 /* return '1' if loaded and enforcing */\n    }\n\n    VIR_FREE(content);\n cleanup:\n    VIR_FREE(tmp);\n    VIR_FREE(etmp);\n\n    return rc;\n}",
          "includes": [
            "#include \"virmdev.h\"",
            "#include \"virscsi.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"vircommand.h\"",
            "#include \"configmake.h\"",
            "#include \"virfile.h\"",
            "#include \"virscsivhost.h\"",
            "#include \"virusb.h\"",
            "#include \"virpci.h\"",
            "#include \"viruuid.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"security_apparmor.h\"",
            "#include \"internal.h\"",
            "#include <wait.h>",
            "#include <unistd.h>",
            "#include <sys/apparmor.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virmdev.h\"\n#include \"virscsi.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"configmake.h\"\n#include \"virfile.h\"\n#include \"virscsivhost.h\"\n#include \"virusb.h\"\n#include \"virpci.h\"\n#include \"viruuid.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"security_apparmor.h\"\n#include \"internal.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/apparmor.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nprofile_status(const char *str, const int check_enforcing)\n{\n    char *content = NULL;\n    char *tmp = NULL;\n    char *etmp = NULL;\n    int rc = -2;\n\n    /* create string that is '<str> \\0' for accurate matching */\n    tmp = g_strdup_printf(\"%s \", str);\n\n    if (check_enforcing != 0) {\n        /* create string that is '<str> (enforce)\\0' for accurate matching */\n        etmp = g_strdup_printf(\"%s (enforce)\", str);\n    }\n\n    if (virFileReadAll(APPARMOR_PROFILES_PATH, MAX_FILE_LEN, &content) < 0) {\n        virReportSystemError(errno,\n                             _(\"Failed to read AppArmor profiles list \"\n                             \"\\'%s\\'\"), APPARMOR_PROFILES_PATH);\n        goto cleanup;\n    }\n\n    if (strstr(content, tmp) != NULL)\n        rc = 0;\n    else\n        rc = -1; /* return -1 if not loaded */\n    if (check_enforcing != 0) {\n        if (rc == 0 && strstr(content, etmp) != NULL)\n            rc = 1;                 /* return '1' if loaded and enforcing */\n    }\n\n    VIR_FREE(content);\n cleanup:\n    VIR_FREE(tmp);\n    VIR_FREE(etmp);\n\n    return rc;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nbool\nvirFileIsExecutable(const char *file)\n{\n    struct stat sb;\n\n    /* We would also want to check faccessat if we cared about ACLs,\n     * but we don't.  */\n    if (stat(file, &sb) < 0)\n        return false;\n    if (S_ISREG(sb.st_mode) && (sb.st_mode & 0111) != 0)\n        return true;\n    errno = S_ISDIR(sb.st_mode) ? EISDIR : EACCES;\n    return false;\n}"
  },
  {
    "function_name": "virFileExists",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "1873-1877",
    "snippet": "bool\nvirFileExists(const char *path)\n{\n    return access(path, F_OK) == 0;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "access",
          "args": [
            "path",
            "F_OK"
          ],
          "line": 1876
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nbool\nvirFileExists(const char *path)\n{\n    return access(path, F_OK) == 0;\n}"
  },
  {
    "function_name": "virFileIsRegular",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "1858-1863",
    "snippet": "bool\nvirFileIsRegular(const char *path)\n{\n    struct stat s;\n    return (stat(path, &s) == 0) && S_ISREG(s.st_mode);\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "S_ISREG",
          "args": [
            "s.st_mode"
          ],
          "line": 1862
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "stat",
          "args": [
            "path",
            "&s"
          ],
          "line": 1862
        },
        "resolved": true,
        "details": {
          "function_name": "profile_status",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_apparmor.c",
          "lines": "70-108",
          "snippet": "static int\nprofile_status(const char *str, const int check_enforcing)\n{\n    char *content = NULL;\n    char *tmp = NULL;\n    char *etmp = NULL;\n    int rc = -2;\n\n    /* create string that is '<str> \\0' for accurate matching */\n    tmp = g_strdup_printf(\"%s \", str);\n\n    if (check_enforcing != 0) {\n        /* create string that is '<str> (enforce)\\0' for accurate matching */\n        etmp = g_strdup_printf(\"%s (enforce)\", str);\n    }\n\n    if (virFileReadAll(APPARMOR_PROFILES_PATH, MAX_FILE_LEN, &content) < 0) {\n        virReportSystemError(errno,\n                             _(\"Failed to read AppArmor profiles list \"\n                             \"\\'%s\\'\"), APPARMOR_PROFILES_PATH);\n        goto cleanup;\n    }\n\n    if (strstr(content, tmp) != NULL)\n        rc = 0;\n    else\n        rc = -1; /* return -1 if not loaded */\n    if (check_enforcing != 0) {\n        if (rc == 0 && strstr(content, etmp) != NULL)\n            rc = 1;                 /* return '1' if loaded and enforcing */\n    }\n\n    VIR_FREE(content);\n cleanup:\n    VIR_FREE(tmp);\n    VIR_FREE(etmp);\n\n    return rc;\n}",
          "includes": [
            "#include \"virmdev.h\"",
            "#include \"virscsi.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"vircommand.h\"",
            "#include \"configmake.h\"",
            "#include \"virfile.h\"",
            "#include \"virscsivhost.h\"",
            "#include \"virusb.h\"",
            "#include \"virpci.h\"",
            "#include \"viruuid.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"security_apparmor.h\"",
            "#include \"internal.h\"",
            "#include <wait.h>",
            "#include <unistd.h>",
            "#include <sys/apparmor.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virmdev.h\"\n#include \"virscsi.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"configmake.h\"\n#include \"virfile.h\"\n#include \"virscsivhost.h\"\n#include \"virusb.h\"\n#include \"virpci.h\"\n#include \"viruuid.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"security_apparmor.h\"\n#include \"internal.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/apparmor.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nprofile_status(const char *str, const int check_enforcing)\n{\n    char *content = NULL;\n    char *tmp = NULL;\n    char *etmp = NULL;\n    int rc = -2;\n\n    /* create string that is '<str> \\0' for accurate matching */\n    tmp = g_strdup_printf(\"%s \", str);\n\n    if (check_enforcing != 0) {\n        /* create string that is '<str> (enforce)\\0' for accurate matching */\n        etmp = g_strdup_printf(\"%s (enforce)\", str);\n    }\n\n    if (virFileReadAll(APPARMOR_PROFILES_PATH, MAX_FILE_LEN, &content) < 0) {\n        virReportSystemError(errno,\n                             _(\"Failed to read AppArmor profiles list \"\n                             \"\\'%s\\'\"), APPARMOR_PROFILES_PATH);\n        goto cleanup;\n    }\n\n    if (strstr(content, tmp) != NULL)\n        rc = 0;\n    else\n        rc = -1; /* return -1 if not loaded */\n    if (check_enforcing != 0) {\n        if (rc == 0 && strstr(content, etmp) != NULL)\n            rc = 1;                 /* return '1' if loaded and enforcing */\n    }\n\n    VIR_FREE(content);\n cleanup:\n    VIR_FREE(tmp);\n    VIR_FREE(etmp);\n\n    return rc;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nbool\nvirFileIsRegular(const char *path)\n{\n    struct stat s;\n    return (stat(path, &s) == 0) && S_ISREG(s.st_mode);\n}"
  },
  {
    "function_name": "virFileIsDir",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "1850-1855",
    "snippet": "bool\nvirFileIsDir(const char *path)\n{\n    struct stat s;\n    return (stat(path, &s) == 0) && S_ISDIR(s.st_mode);\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "S_ISDIR",
          "args": [
            "s.st_mode"
          ],
          "line": 1854
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "stat",
          "args": [
            "path",
            "&s"
          ],
          "line": 1854
        },
        "resolved": true,
        "details": {
          "function_name": "profile_status",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_apparmor.c",
          "lines": "70-108",
          "snippet": "static int\nprofile_status(const char *str, const int check_enforcing)\n{\n    char *content = NULL;\n    char *tmp = NULL;\n    char *etmp = NULL;\n    int rc = -2;\n\n    /* create string that is '<str> \\0' for accurate matching */\n    tmp = g_strdup_printf(\"%s \", str);\n\n    if (check_enforcing != 0) {\n        /* create string that is '<str> (enforce)\\0' for accurate matching */\n        etmp = g_strdup_printf(\"%s (enforce)\", str);\n    }\n\n    if (virFileReadAll(APPARMOR_PROFILES_PATH, MAX_FILE_LEN, &content) < 0) {\n        virReportSystemError(errno,\n                             _(\"Failed to read AppArmor profiles list \"\n                             \"\\'%s\\'\"), APPARMOR_PROFILES_PATH);\n        goto cleanup;\n    }\n\n    if (strstr(content, tmp) != NULL)\n        rc = 0;\n    else\n        rc = -1; /* return -1 if not loaded */\n    if (check_enforcing != 0) {\n        if (rc == 0 && strstr(content, etmp) != NULL)\n            rc = 1;                 /* return '1' if loaded and enforcing */\n    }\n\n    VIR_FREE(content);\n cleanup:\n    VIR_FREE(tmp);\n    VIR_FREE(etmp);\n\n    return rc;\n}",
          "includes": [
            "#include \"virmdev.h\"",
            "#include \"virscsi.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"vircommand.h\"",
            "#include \"configmake.h\"",
            "#include \"virfile.h\"",
            "#include \"virscsivhost.h\"",
            "#include \"virusb.h\"",
            "#include \"virpci.h\"",
            "#include \"viruuid.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"security_apparmor.h\"",
            "#include \"internal.h\"",
            "#include <wait.h>",
            "#include <unistd.h>",
            "#include <sys/apparmor.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virmdev.h\"\n#include \"virscsi.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"configmake.h\"\n#include \"virfile.h\"\n#include \"virscsivhost.h\"\n#include \"virusb.h\"\n#include \"virpci.h\"\n#include \"viruuid.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"security_apparmor.h\"\n#include \"internal.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/apparmor.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nprofile_status(const char *str, const int check_enforcing)\n{\n    char *content = NULL;\n    char *tmp = NULL;\n    char *etmp = NULL;\n    int rc = -2;\n\n    /* create string that is '<str> \\0' for accurate matching */\n    tmp = g_strdup_printf(\"%s \", str);\n\n    if (check_enforcing != 0) {\n        /* create string that is '<str> (enforce)\\0' for accurate matching */\n        etmp = g_strdup_printf(\"%s (enforce)\", str);\n    }\n\n    if (virFileReadAll(APPARMOR_PROFILES_PATH, MAX_FILE_LEN, &content) < 0) {\n        virReportSystemError(errno,\n                             _(\"Failed to read AppArmor profiles list \"\n                             \"\\'%s\\'\"), APPARMOR_PROFILES_PATH);\n        goto cleanup;\n    }\n\n    if (strstr(content, tmp) != NULL)\n        rc = 0;\n    else\n        rc = -1; /* return -1 if not loaded */\n    if (check_enforcing != 0) {\n        if (rc == 0 && strstr(content, etmp) != NULL)\n            rc = 1;                 /* return '1' if loaded and enforcing */\n    }\n\n    VIR_FREE(content);\n cleanup:\n    VIR_FREE(tmp);\n    VIR_FREE(etmp);\n\n    return rc;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nbool\nvirFileIsDir(const char *path)\n{\n    struct stat s;\n    return (stat(path, &s) == 0) && S_ISDIR(s.st_mode);\n}"
  },
  {
    "function_name": "virFileLength",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "1829-1847",
    "snippet": "off_t\nvirFileLength(const char *path, int fd)\n{\n    struct stat s;\n\n    if (fd >= 0) {\n        if (fstat(fd, &s) < 0)\n            return -1;\n    } else {\n        if (stat(path, &s) < 0)\n            return -1;\n    }\n\n    if (!S_ISREG(s.st_mode))\n       return -1;\n\n    return s.st_size;\n\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "S_ISREG",
          "args": [
            "s.st_mode"
          ],
          "line": 1842
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "stat",
          "args": [
            "path",
            "&s"
          ],
          "line": 1838
        },
        "resolved": true,
        "details": {
          "function_name": "profile_status",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_apparmor.c",
          "lines": "70-108",
          "snippet": "static int\nprofile_status(const char *str, const int check_enforcing)\n{\n    char *content = NULL;\n    char *tmp = NULL;\n    char *etmp = NULL;\n    int rc = -2;\n\n    /* create string that is '<str> \\0' for accurate matching */\n    tmp = g_strdup_printf(\"%s \", str);\n\n    if (check_enforcing != 0) {\n        /* create string that is '<str> (enforce)\\0' for accurate matching */\n        etmp = g_strdup_printf(\"%s (enforce)\", str);\n    }\n\n    if (virFileReadAll(APPARMOR_PROFILES_PATH, MAX_FILE_LEN, &content) < 0) {\n        virReportSystemError(errno,\n                             _(\"Failed to read AppArmor profiles list \"\n                             \"\\'%s\\'\"), APPARMOR_PROFILES_PATH);\n        goto cleanup;\n    }\n\n    if (strstr(content, tmp) != NULL)\n        rc = 0;\n    else\n        rc = -1; /* return -1 if not loaded */\n    if (check_enforcing != 0) {\n        if (rc == 0 && strstr(content, etmp) != NULL)\n            rc = 1;                 /* return '1' if loaded and enforcing */\n    }\n\n    VIR_FREE(content);\n cleanup:\n    VIR_FREE(tmp);\n    VIR_FREE(etmp);\n\n    return rc;\n}",
          "includes": [
            "#include \"virmdev.h\"",
            "#include \"virscsi.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"vircommand.h\"",
            "#include \"configmake.h\"",
            "#include \"virfile.h\"",
            "#include \"virscsivhost.h\"",
            "#include \"virusb.h\"",
            "#include \"virpci.h\"",
            "#include \"viruuid.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"security_apparmor.h\"",
            "#include \"internal.h\"",
            "#include <wait.h>",
            "#include <unistd.h>",
            "#include <sys/apparmor.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virmdev.h\"\n#include \"virscsi.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"configmake.h\"\n#include \"virfile.h\"\n#include \"virscsivhost.h\"\n#include \"virusb.h\"\n#include \"virpci.h\"\n#include \"viruuid.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"security_apparmor.h\"\n#include \"internal.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/apparmor.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nprofile_status(const char *str, const int check_enforcing)\n{\n    char *content = NULL;\n    char *tmp = NULL;\n    char *etmp = NULL;\n    int rc = -2;\n\n    /* create string that is '<str> \\0' for accurate matching */\n    tmp = g_strdup_printf(\"%s \", str);\n\n    if (check_enforcing != 0) {\n        /* create string that is '<str> (enforce)\\0' for accurate matching */\n        etmp = g_strdup_printf(\"%s (enforce)\", str);\n    }\n\n    if (virFileReadAll(APPARMOR_PROFILES_PATH, MAX_FILE_LEN, &content) < 0) {\n        virReportSystemError(errno,\n                             _(\"Failed to read AppArmor profiles list \"\n                             \"\\'%s\\'\"), APPARMOR_PROFILES_PATH);\n        goto cleanup;\n    }\n\n    if (strstr(content, tmp) != NULL)\n        rc = 0;\n    else\n        rc = -1; /* return -1 if not loaded */\n    if (check_enforcing != 0) {\n        if (rc == 0 && strstr(content, etmp) != NULL)\n            rc = 1;                 /* return '1' if loaded and enforcing */\n    }\n\n    VIR_FREE(content);\n cleanup:\n    VIR_FREE(tmp);\n    VIR_FREE(etmp);\n\n    return rc;\n}"
        }
      },
      {
        "call_info": {
          "callee": "fstat",
          "args": [
            "fd",
            "&s"
          ],
          "line": 1835
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\noff_t\nvirFileLength(const char *path, int fd)\n{\n    struct stat s;\n\n    if (fd >= 0) {\n        if (fstat(fd, &s) < 0)\n            return -1;\n    } else {\n        if (stat(path, &s) < 0)\n            return -1;\n    }\n\n    if (!S_ISREG(s.st_mode))\n       return -1;\n\n    return s.st_size;\n\n}"
  },
  {
    "function_name": "virFileActivateDirOverrideForLib",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "1809-1814",
    "snippet": "void\nvirFileActivateDirOverrideForLib(void)\n{\n    if (getenv(\"LIBVIRT_DIR_OVERRIDE\") != NULL)\n        useDirOverride = true;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static bool useDirOverride;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "getenv",
          "args": [
            "\"LIBVIRT_DIR_OVERRIDE\""
          ],
          "line": 1812
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic bool useDirOverride;\n\nvoid\nvirFileActivateDirOverrideForLib(void)\n{\n    if (getenv(\"LIBVIRT_DIR_OVERRIDE\") != NULL)\n        useDirOverride = true;\n}"
  },
  {
    "function_name": "virFileActivateDirOverrideForProg",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "1788-1800",
    "snippet": "void\nvirFileActivateDirOverrideForProg(const char *argv0)\n{\n    char *file = strrchr(argv0, '/');\n    if (!file || file[1] == '\\0')\n        return;\n    file++;\n    if (STRPREFIX(file, \"lt-\") ||\n        strstr(argv0, \"/.libs/\")) {\n        useDirOverride = true;\n        VIR_DEBUG(\"Activating build dir override for %s\", argv0);\n    }\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static bool useDirOverride;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Activating build dir override for %s\"",
            "argv0"
          ],
          "line": 1798
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "argv0",
            "\"/.libs/\""
          ],
          "line": 1796
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STRPREFIX",
          "args": [
            "file",
            "\"lt-\""
          ],
          "line": 1795
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strrchr",
          "args": [
            "argv0",
            "'/'"
          ],
          "line": 1791
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic bool useDirOverride;\n\nvoid\nvirFileActivateDirOverrideForProg(const char *argv0)\n{\n    char *file = strrchr(argv0, '/');\n    if (!file || file[1] == '\\0')\n        return;\n    file++;\n    if (STRPREFIX(file, \"lt-\") ||\n        strstr(argv0, \"/.libs/\")) {\n        useDirOverride = true;\n        VIR_DEBUG(\"Activating build dir override for %s\", argv0);\n    }\n}"
  },
  {
    "function_name": "virFileFindResource",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "1771-1777",
    "snippet": "char *\nvirFileFindResource(const char *filename,\n                    const char *builddir,\n                    const char *installdir)\n{\n    return virFileFindResourceFull(filename, NULL, NULL, builddir, installdir, NULL);\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virFileFindResourceFull",
          "args": [
            "filename",
            "NULL",
            "NULL",
            "builddir",
            "installdir",
            "NULL"
          ],
          "line": 1776
        },
        "resolved": true,
        "details": {
          "function_name": "virFileFindResourceFull",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1741-1769",
          "snippet": "char *\nvirFileFindResourceFull(const char *filename,\n                        const char *prefix,\n                        const char *suffix,\n                        const char *builddir,\n                        const char *installdir,\n                        const char *envname)\n{\n    char *ret = NULL;\n    const char *envval = envname ? getenv(envname) : NULL;\n    const char *path;\n\n    if (!prefix)\n        prefix = \"\";\n    if (!suffix)\n        suffix = \"\";\n\n    if (envval)\n        path = envval;\n    else if (useDirOverride)\n        path = builddir;\n    else\n        path = installdir;\n\n    ret = g_strdup_printf(\"%s/%s%s%s\", path, prefix, filename, suffix);\n\n    VIR_DEBUG(\"Resolved '%s' to '%s'\", filename, ret);\n    return ret;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static bool useDirOverride;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic bool useDirOverride;\n\nchar *\nvirFileFindResourceFull(const char *filename,\n                        const char *prefix,\n                        const char *suffix,\n                        const char *builddir,\n                        const char *installdir,\n                        const char *envname)\n{\n    char *ret = NULL;\n    const char *envval = envname ? getenv(envname) : NULL;\n    const char *path;\n\n    if (!prefix)\n        prefix = \"\";\n    if (!suffix)\n        suffix = \"\";\n\n    if (envval)\n        path = envval;\n    else if (useDirOverride)\n        path = builddir;\n    else\n        path = installdir;\n\n    ret = g_strdup_printf(\"%s/%s%s%s\", path, prefix, filename, suffix);\n\n    VIR_DEBUG(\"Resolved '%s' to '%s'\", filename, ret);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nchar *\nvirFileFindResource(const char *filename,\n                    const char *builddir,\n                    const char *installdir)\n{\n    return virFileFindResourceFull(filename, NULL, NULL, builddir, installdir, NULL);\n}"
  },
  {
    "function_name": "virFileFindResourceFull",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "1741-1769",
    "snippet": "char *\nvirFileFindResourceFull(const char *filename,\n                        const char *prefix,\n                        const char *suffix,\n                        const char *builddir,\n                        const char *installdir,\n                        const char *envname)\n{\n    char *ret = NULL;\n    const char *envval = envname ? getenv(envname) : NULL;\n    const char *path;\n\n    if (!prefix)\n        prefix = \"\";\n    if (!suffix)\n        suffix = \"\";\n\n    if (envval)\n        path = envval;\n    else if (useDirOverride)\n        path = builddir;\n    else\n        path = installdir;\n\n    ret = g_strdup_printf(\"%s/%s%s%s\", path, prefix, filename, suffix);\n\n    VIR_DEBUG(\"Resolved '%s' to '%s'\", filename, ret);\n    return ret;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static bool useDirOverride;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Resolved '%s' to '%s'\"",
            "filename",
            "ret"
          ],
          "line": 1767
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"%s/%s%s%s\"",
            "path",
            "prefix",
            "filename",
            "suffix"
          ],
          "line": 1765
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "getenv",
          "args": [
            "envname"
          ],
          "line": 1750
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic bool useDirOverride;\n\nchar *\nvirFileFindResourceFull(const char *filename,\n                        const char *prefix,\n                        const char *suffix,\n                        const char *builddir,\n                        const char *installdir,\n                        const char *envname)\n{\n    char *ret = NULL;\n    const char *envval = envname ? getenv(envname) : NULL;\n    const char *path;\n\n    if (!prefix)\n        prefix = \"\";\n    if (!suffix)\n        suffix = \"\";\n\n    if (envval)\n        path = envval;\n    else if (useDirOverride)\n        path = builddir;\n    else\n        path = installdir;\n\n    ret = g_strdup_printf(\"%s/%s%s%s\", path, prefix, filename, suffix);\n\n    VIR_DEBUG(\"Resolved '%s' to '%s'\", filename, ret);\n    return ret;\n}"
  },
  {
    "function_name": "virFindFileInPath",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "1657-1709",
    "snippet": "char *\nvirFindFileInPath(const char *file)\n{\n    const char *origpath = NULL;\n    VIR_AUTOSTRINGLIST paths = NULL;\n    char **pathiter;\n\n    if (file == NULL)\n        return NULL;\n\n    /* if we are passed an absolute path (starting with /), return a\n     * copy of that path, after validating that it is executable\n     */\n    if (g_path_is_absolute(file)) {\n        if (!virFileIsExecutable(file))\n            return NULL;\n\n        return g_strdup(file);\n    }\n\n    /* If we are passed an anchored path (containing a /), then there\n     * is no path search - it must exist in the current directory\n     */\n    if (strchr(file, '/')) {\n        char *abspath = NULL;\n\n        if (!virFileIsExecutable(file))\n            return NULL;\n\n        ignore_value(virFileAbsPath(file, &abspath));\n        return abspath;\n    }\n\n    /* copy PATH env so we can tweak it */\n    origpath = getenv(\"PATH\");\n    if (!origpath)\n        origpath = \"/bin:/usr/bin\";\n\n    /* for each path segment, append the file to search for and test for\n     * it. return it if found.\n     */\n\n    if (!(paths = virStringSplit(origpath, \":\", 0)))\n        return NULL;\n\n    for (pathiter = paths; *pathiter; pathiter++) {\n        g_autofree char *fullpath = g_strdup_printf(\"%s/%s\", *pathiter, file);\n        if (virFileIsExecutable(fullpath))\n            return g_steal_pointer(&fullpath);\n    }\n\n    return NULL;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_steal_pointer",
          "args": [
            "&fullpath"
          ],
          "line": 1705
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virFileIsExecutable",
          "args": [
            "fullpath"
          ],
          "line": 1704
        },
        "resolved": true,
        "details": {
          "function_name": "virFileIsExecutable",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1886-1899",
          "snippet": "bool\nvirFileIsExecutable(const char *file)\n{\n    struct stat sb;\n\n    /* We would also want to check faccessat if we cared about ACLs,\n     * but we don't.  */\n    if (stat(file, &sb) < 0)\n        return false;\n    if (S_ISREG(sb.st_mode) && (sb.st_mode & 0111) != 0)\n        return true;\n    errno = S_ISDIR(sb.st_mode) ? EISDIR : EACCES;\n    return false;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nbool\nvirFileIsExecutable(const char *file)\n{\n    struct stat sb;\n\n    /* We would also want to check faccessat if we cared about ACLs,\n     * but we don't.  */\n    if (stat(file, &sb) < 0)\n        return false;\n    if (S_ISREG(sb.st_mode) && (sb.st_mode & 0111) != 0)\n        return true;\n    errno = S_ISDIR(sb.st_mode) ? EISDIR : EACCES;\n    return false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"%s/%s\"",
            "*pathiter",
            "file"
          ],
          "line": 1703
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStringSplit",
          "args": [
            "origpath",
            "\":\"",
            "0"
          ],
          "line": 1699
        },
        "resolved": true,
        "details": {
          "function_name": "virStringSplit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "126-132",
          "snippet": "char **\nvirStringSplit(const char *string,\n               const char *delim,\n               size_t max_tokens)\n{\n    return virStringSplitCount(string, delim, max_tokens, NULL);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nchar **\nvirStringSplit(const char *string,\n               const char *delim,\n               size_t max_tokens)\n{\n    return virStringSplitCount(string, delim, max_tokens, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "getenv",
          "args": [
            "\"PATH\""
          ],
          "line": 1691
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ignore_value",
          "args": [
            "virFileAbsPath(file, &abspath)"
          ],
          "line": 1686
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virFileAbsPath",
          "args": [
            "file",
            "&abspath"
          ],
          "line": 1686
        },
        "resolved": true,
        "details": {
          "function_name": "virFileAbsPath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "3227-3239",
          "snippet": "int\nvirFileAbsPath(const char *path, char **abspath)\n{\n    if (path[0] == '/') {\n        *abspath = g_strdup(path);\n    } else {\n        g_autofree char *buf = g_get_current_dir();\n\n        *abspath = g_strdup_printf(\"%s/%s\", buf, path);\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileAbsPath(const char *path, char **abspath)\n{\n    if (path[0] == '/') {\n        *abspath = g_strdup(path);\n    } else {\n        g_autofree char *buf = g_get_current_dir();\n\n        *abspath = g_strdup_printf(\"%s/%s\", buf, path);\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "file",
            "'/'"
          ],
          "line": 1680
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_path_is_absolute",
          "args": [
            "file"
          ],
          "line": 1670
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nchar *\nvirFindFileInPath(const char *file)\n{\n    const char *origpath = NULL;\n    VIR_AUTOSTRINGLIST paths = NULL;\n    char **pathiter;\n\n    if (file == NULL)\n        return NULL;\n\n    /* if we are passed an absolute path (starting with /), return a\n     * copy of that path, after validating that it is executable\n     */\n    if (g_path_is_absolute(file)) {\n        if (!virFileIsExecutable(file))\n            return NULL;\n\n        return g_strdup(file);\n    }\n\n    /* If we are passed an anchored path (containing a /), then there\n     * is no path search - it must exist in the current directory\n     */\n    if (strchr(file, '/')) {\n        char *abspath = NULL;\n\n        if (!virFileIsExecutable(file))\n            return NULL;\n\n        ignore_value(virFileAbsPath(file, &abspath));\n        return abspath;\n    }\n\n    /* copy PATH env so we can tweak it */\n    origpath = getenv(\"PATH\");\n    if (!origpath)\n        origpath = \"/bin:/usr/bin\";\n\n    /* for each path segment, append the file to search for and test for\n     * it. return it if found.\n     */\n\n    if (!(paths = virStringSplit(origpath, \":\", 0)))\n        return NULL;\n\n    for (pathiter = paths; *pathiter; pathiter++) {\n        g_autofree char *fullpath = g_strdup_printf(\"%s/%s\", *pathiter, file);\n        if (virFileIsExecutable(fullpath))\n            return g_steal_pointer(&fullpath);\n    }\n\n    return NULL;\n}"
  },
  {
    "function_name": "virFileIsLink",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "1633-1649",
    "snippet": "int\nvirFileIsLink(const char *linkpath)\n{\n    GStatBuf st;\n\n    /* Still do this on Windows so we report\n     * errors like ENOENT, etc\n     */\n    if (g_lstat(linkpath, &st) < 0)\n        return -errno;\n\n#ifndef WIN32\n    return S_ISLNK(st.st_mode) != 0;\n#else /* WIN32 */\n    return 0;\n#endif /* WIN32 */\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "S_ISLNK",
          "args": [
            "st.st_mode"
          ],
          "line": 1645
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_lstat",
          "args": [
            "linkpath",
            "&st"
          ],
          "line": 1641
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileIsLink(const char *linkpath)\n{\n    GStatBuf st;\n\n    /* Still do this on Windows so we report\n     * errors like ENOENT, etc\n     */\n    if (g_lstat(linkpath, &st) < 0)\n        return -errno;\n\n#ifndef WIN32\n    return S_ISLNK(st.st_mode) != 0;\n#else /* WIN32 */\n    return 0;\n#endif /* WIN32 */\n}"
  },
  {
    "function_name": "virFileResolveAllLinks",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "1622-1626",
    "snippet": "int\nvirFileResolveAllLinks(const char *linkpath, char **resultpath)\n{\n    return virFileResolveLinkHelper(linkpath, true, resultpath);\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virFileResolveLinkHelper",
          "args": [
            "linkpath",
            "true",
            "resultpath"
          ],
          "line": 1625
        },
        "resolved": true,
        "details": {
          "function_name": "virFileResolveLinkHelper",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1571-1598",
          "snippet": "static int\nvirFileResolveLinkHelper(const char *linkpath,\n                         bool intermediatePaths,\n                         char **resultpath)\n{\n    GStatBuf st;\n\n    *resultpath = NULL;\n\n    /* We don't need the full canonicalization of intermediate\n     * directories, if linkpath is absolute and the basename is\n     * already a non-symlink.  */\n    if (g_path_is_absolute(linkpath) && !intermediatePaths) {\n        if (g_lstat(linkpath, &st) < 0)\n            return -1;\n\n#ifndef WIN32\n        if (!S_ISLNK(st.st_mode)) {\n            *resultpath = g_strdup(linkpath);\n            return 0;\n        }\n#endif /* WIN32 */\n    }\n\n    *resultpath = virFileCanonicalizePath(linkpath);\n\n    return *resultpath == NULL ? -1 : 0;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nvirFileResolveLinkHelper(const char *linkpath,\n                         bool intermediatePaths,\n                         char **resultpath)\n{\n    GStatBuf st;\n\n    *resultpath = NULL;\n\n    /* We don't need the full canonicalization of intermediate\n     * directories, if linkpath is absolute and the basename is\n     * already a non-symlink.  */\n    if (g_path_is_absolute(linkpath) && !intermediatePaths) {\n        if (g_lstat(linkpath, &st) < 0)\n            return -1;\n\n#ifndef WIN32\n        if (!S_ISLNK(st.st_mode)) {\n            *resultpath = g_strdup(linkpath);\n            return 0;\n        }\n#endif /* WIN32 */\n    }\n\n    *resultpath = virFileCanonicalizePath(linkpath);\n\n    return *resultpath == NULL ? -1 : 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileResolveAllLinks(const char *linkpath, char **resultpath)\n{\n    return virFileResolveLinkHelper(linkpath, true, resultpath);\n}"
  },
  {
    "function_name": "virFileResolveLink",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "1608-1612",
    "snippet": "int\nvirFileResolveLink(const char *linkpath, char **resultpath)\n{\n    return virFileResolveLinkHelper(linkpath, false, resultpath);\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virFileResolveLinkHelper",
          "args": [
            "linkpath",
            "false",
            "resultpath"
          ],
          "line": 1611
        },
        "resolved": true,
        "details": {
          "function_name": "virFileResolveLinkHelper",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1571-1598",
          "snippet": "static int\nvirFileResolveLinkHelper(const char *linkpath,\n                         bool intermediatePaths,\n                         char **resultpath)\n{\n    GStatBuf st;\n\n    *resultpath = NULL;\n\n    /* We don't need the full canonicalization of intermediate\n     * directories, if linkpath is absolute and the basename is\n     * already a non-symlink.  */\n    if (g_path_is_absolute(linkpath) && !intermediatePaths) {\n        if (g_lstat(linkpath, &st) < 0)\n            return -1;\n\n#ifndef WIN32\n        if (!S_ISLNK(st.st_mode)) {\n            *resultpath = g_strdup(linkpath);\n            return 0;\n        }\n#endif /* WIN32 */\n    }\n\n    *resultpath = virFileCanonicalizePath(linkpath);\n\n    return *resultpath == NULL ? -1 : 0;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nvirFileResolveLinkHelper(const char *linkpath,\n                         bool intermediatePaths,\n                         char **resultpath)\n{\n    GStatBuf st;\n\n    *resultpath = NULL;\n\n    /* We don't need the full canonicalization of intermediate\n     * directories, if linkpath is absolute and the basename is\n     * already a non-symlink.  */\n    if (g_path_is_absolute(linkpath) && !intermediatePaths) {\n        if (g_lstat(linkpath, &st) < 0)\n            return -1;\n\n#ifndef WIN32\n        if (!S_ISLNK(st.st_mode)) {\n            *resultpath = g_strdup(linkpath);\n            return 0;\n        }\n#endif /* WIN32 */\n    }\n\n    *resultpath = virFileCanonicalizePath(linkpath);\n\n    return *resultpath == NULL ? -1 : 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileResolveLink(const char *linkpath, char **resultpath)\n{\n    return virFileResolveLinkHelper(linkpath, false, resultpath);\n}"
  },
  {
    "function_name": "virFileResolveLinkHelper",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "1571-1598",
    "snippet": "static int\nvirFileResolveLinkHelper(const char *linkpath,\n                         bool intermediatePaths,\n                         char **resultpath)\n{\n    GStatBuf st;\n\n    *resultpath = NULL;\n\n    /* We don't need the full canonicalization of intermediate\n     * directories, if linkpath is absolute and the basename is\n     * already a non-symlink.  */\n    if (g_path_is_absolute(linkpath) && !intermediatePaths) {\n        if (g_lstat(linkpath, &st) < 0)\n            return -1;\n\n#ifndef WIN32\n        if (!S_ISLNK(st.st_mode)) {\n            *resultpath = g_strdup(linkpath);\n            return 0;\n        }\n#endif /* WIN32 */\n    }\n\n    *resultpath = virFileCanonicalizePath(linkpath);\n\n    return *resultpath == NULL ? -1 : 0;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virFileCanonicalizePath",
          "args": [
            "linkpath"
          ],
          "line": 1595
        },
        "resolved": true,
        "details": {
          "function_name": "virFileCanonicalizePath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "3299-3310",
          "snippet": "char *\nvirFileCanonicalizePath(const char *path)\n{\n#ifdef WIN32\n    /* Does not resolve symlinks, only expands . & .. & repeated /.\n     * It will never fail, so sanitize errno to indicate success */\n    errno = 0;\n    return g_canonicalize_filename(path, NULL);\n#else\n    return realpath(path, NULL); /* exempt from syntax-check */\n#endif\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nchar *\nvirFileCanonicalizePath(const char *path)\n{\n#ifdef WIN32\n    /* Does not resolve symlinks, only expands . & .. & repeated /.\n     * It will never fail, so sanitize errno to indicate success */\n    errno = 0;\n    return g_canonicalize_filename(path, NULL);\n#else\n    return realpath(path, NULL); /* exempt from syntax-check */\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "linkpath"
          ],
          "line": 1589
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "S_ISLNK",
          "args": [
            "st.st_mode"
          ],
          "line": 1588
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_lstat",
          "args": [
            "linkpath",
            "&st"
          ],
          "line": 1584
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_path_is_absolute",
          "args": [
            "linkpath"
          ],
          "line": 1583
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nvirFileResolveLinkHelper(const char *linkpath,\n                         bool intermediatePaths,\n                         char **resultpath)\n{\n    GStatBuf st;\n\n    *resultpath = NULL;\n\n    /* We don't need the full canonicalization of intermediate\n     * directories, if linkpath is absolute and the basename is\n     * already a non-symlink.  */\n    if (g_path_is_absolute(linkpath) && !intermediatePaths) {\n        if (g_lstat(linkpath, &st) < 0)\n            return -1;\n\n#ifndef WIN32\n        if (!S_ISLNK(st.st_mode)) {\n            *resultpath = g_strdup(linkpath);\n            return 0;\n        }\n#endif /* WIN32 */\n    }\n\n    *resultpath = virFileCanonicalizePath(linkpath);\n\n    return *resultpath == NULL ? -1 : 0;\n}"
  },
  {
    "function_name": "virFileRelLinkPointsTo",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "1551-1568",
    "snippet": "int\nvirFileRelLinkPointsTo(const char *directory,\n                       const char *checkLink,\n                       const char *checkDest)\n{\n    g_autofree char *candidate = NULL;\n\n    if (*checkLink == '/')\n        return virFileLinkPointsTo(checkLink, checkDest);\n    if (!directory) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"cannot resolve '%s' without starting directory\"),\n                       checkLink);\n        return -1;\n    }\n    candidate = g_strdup_printf(\"%s/%s\", directory, checkLink);\n    return virFileLinkPointsTo(candidate, checkDest);\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virFileLinkPointsTo",
          "args": [
            "candidate",
            "checkDest"
          ],
          "line": 1567
        },
        "resolved": true,
        "details": {
          "function_name": "virFileLinkPointsTo",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1533-1543",
          "snippet": "int\nvirFileLinkPointsTo(const char *checkLink,\n                    const char *checkDest)\n{\n    struct stat src_sb;\n    struct stat dest_sb;\n\n    return (stat(checkLink, &src_sb) == 0\n            && stat(checkDest, &dest_sb) == 0\n            && SAME_INODE(src_sb, dest_sb));\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileLinkPointsTo(const char *checkLink,\n                    const char *checkDest)\n{\n    struct stat src_sb;\n    struct stat dest_sb;\n\n    return (stat(checkLink, &src_sb) == 0\n            && stat(checkDest, &dest_sb) == 0\n            && SAME_INODE(src_sb, dest_sb));\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"%s/%s\"",
            "directory",
            "checkLink"
          ],
          "line": 1566
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"cannot resolve '%s' without starting directory\")",
            "checkLink"
          ],
          "line": 1561
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileRelLinkPointsTo(const char *directory,\n                       const char *checkLink,\n                       const char *checkDest)\n{\n    g_autofree char *candidate = NULL;\n\n    if (*checkLink == '/')\n        return virFileLinkPointsTo(checkLink, checkDest);\n    if (!directory) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"cannot resolve '%s' without starting directory\"),\n                       checkLink);\n        return -1;\n    }\n    candidate = g_strdup_printf(\"%s/%s\", directory, checkLink);\n    return virFileLinkPointsTo(candidate, checkDest);\n}"
  },
  {
    "function_name": "virFileLinkPointsTo",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "1533-1543",
    "snippet": "int\nvirFileLinkPointsTo(const char *checkLink,\n                    const char *checkDest)\n{\n    struct stat src_sb;\n    struct stat dest_sb;\n\n    return (stat(checkLink, &src_sb) == 0\n            && stat(checkDest, &dest_sb) == 0\n            && SAME_INODE(src_sb, dest_sb));\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "SAME_INODE",
          "args": [
            "src_sb",
            "dest_sb"
          ],
          "line": 1542
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "stat",
          "args": [
            "checkDest",
            "&dest_sb"
          ],
          "line": 1541
        },
        "resolved": true,
        "details": {
          "function_name": "profile_status",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_apparmor.c",
          "lines": "70-108",
          "snippet": "static int\nprofile_status(const char *str, const int check_enforcing)\n{\n    char *content = NULL;\n    char *tmp = NULL;\n    char *etmp = NULL;\n    int rc = -2;\n\n    /* create string that is '<str> \\0' for accurate matching */\n    tmp = g_strdup_printf(\"%s \", str);\n\n    if (check_enforcing != 0) {\n        /* create string that is '<str> (enforce)\\0' for accurate matching */\n        etmp = g_strdup_printf(\"%s (enforce)\", str);\n    }\n\n    if (virFileReadAll(APPARMOR_PROFILES_PATH, MAX_FILE_LEN, &content) < 0) {\n        virReportSystemError(errno,\n                             _(\"Failed to read AppArmor profiles list \"\n                             \"\\'%s\\'\"), APPARMOR_PROFILES_PATH);\n        goto cleanup;\n    }\n\n    if (strstr(content, tmp) != NULL)\n        rc = 0;\n    else\n        rc = -1; /* return -1 if not loaded */\n    if (check_enforcing != 0) {\n        if (rc == 0 && strstr(content, etmp) != NULL)\n            rc = 1;                 /* return '1' if loaded and enforcing */\n    }\n\n    VIR_FREE(content);\n cleanup:\n    VIR_FREE(tmp);\n    VIR_FREE(etmp);\n\n    return rc;\n}",
          "includes": [
            "#include \"virmdev.h\"",
            "#include \"virscsi.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"vircommand.h\"",
            "#include \"configmake.h\"",
            "#include \"virfile.h\"",
            "#include \"virscsivhost.h\"",
            "#include \"virusb.h\"",
            "#include \"virpci.h\"",
            "#include \"viruuid.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"security_apparmor.h\"",
            "#include \"internal.h\"",
            "#include <wait.h>",
            "#include <unistd.h>",
            "#include <sys/apparmor.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virmdev.h\"\n#include \"virscsi.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"configmake.h\"\n#include \"virfile.h\"\n#include \"virscsivhost.h\"\n#include \"virusb.h\"\n#include \"virpci.h\"\n#include \"viruuid.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"security_apparmor.h\"\n#include \"internal.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/apparmor.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nprofile_status(const char *str, const int check_enforcing)\n{\n    char *content = NULL;\n    char *tmp = NULL;\n    char *etmp = NULL;\n    int rc = -2;\n\n    /* create string that is '<str> \\0' for accurate matching */\n    tmp = g_strdup_printf(\"%s \", str);\n\n    if (check_enforcing != 0) {\n        /* create string that is '<str> (enforce)\\0' for accurate matching */\n        etmp = g_strdup_printf(\"%s (enforce)\", str);\n    }\n\n    if (virFileReadAll(APPARMOR_PROFILES_PATH, MAX_FILE_LEN, &content) < 0) {\n        virReportSystemError(errno,\n                             _(\"Failed to read AppArmor profiles list \"\n                             \"\\'%s\\'\"), APPARMOR_PROFILES_PATH);\n        goto cleanup;\n    }\n\n    if (strstr(content, tmp) != NULL)\n        rc = 0;\n    else\n        rc = -1; /* return -1 if not loaded */\n    if (check_enforcing != 0) {\n        if (rc == 0 && strstr(content, etmp) != NULL)\n            rc = 1;                 /* return '1' if loaded and enforcing */\n    }\n\n    VIR_FREE(content);\n cleanup:\n    VIR_FREE(tmp);\n    VIR_FREE(etmp);\n\n    return rc;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileLinkPointsTo(const char *checkLink,\n                    const char *checkDest)\n{\n    struct stat src_sb;\n    struct stat dest_sb;\n\n    return (stat(checkLink, &src_sb) == 0\n            && stat(checkDest, &dest_sb) == 0\n            && SAME_INODE(src_sb, dest_sb));\n}"
  },
  {
    "function_name": "virFileWriteStr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "1502-1524",
    "snippet": "int\nvirFileWriteStr(const char *path, const char *str, mode_t mode)\n{\n    int fd;\n\n    if (mode)\n        fd = open(path, O_WRONLY|O_TRUNC|O_CREAT, mode);\n    else\n        fd = open(path, O_WRONLY|O_TRUNC);\n    if (fd == -1)\n        return -1;\n\n    if (safewrite(fd, str, strlen(str)) < 0) {\n        VIR_FORCE_CLOSE(fd);\n        return -1;\n    }\n\n    /* Use errno from failed close only if there was no write error.  */\n    if (VIR_CLOSE(fd) != 0)\n        return -1;\n\n    return 0;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_CLOSE",
          "args": [
            "fd"
          ],
          "line": 1520
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FORCE_CLOSE",
          "args": [
            "fd"
          ],
          "line": 1515
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "safewrite",
          "args": [
            "fd",
            "str",
            "strlen(str)"
          ],
          "line": 1514
        },
        "resolved": true,
        "details": {
          "function_name": "safewrite",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1093-1111",
          "snippet": "ssize_t\nsafewrite(int fd, const void *buf, size_t count)\n{\n    size_t nwritten = 0;\n    while (count > 0) {\n        ssize_t r = write(fd, buf, count);\n\n        if (r < 0 && errno == EINTR)\n            continue;\n        if (r < 0)\n            return r;\n        if (r == 0)\n            return nwritten;\n        buf = (const char *)buf + r;\n        count -= r;\n        nwritten += r;\n    }\n    return nwritten;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nssize_t\nsafewrite(int fd, const void *buf, size_t count)\n{\n    size_t nwritten = 0;\n    while (count > 0) {\n        ssize_t r = write(fd, buf, count);\n\n        if (r < 0 && errno == EINTR)\n            continue;\n        if (r < 0)\n            return r;\n        if (r == 0)\n            return nwritten;\n        buf = (const char *)buf + r;\n        count -= r;\n        nwritten += r;\n    }\n    return nwritten;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "str"
          ],
          "line": 1514
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "open",
          "args": [
            "path",
            "O_WRONLY|O_TRUNC"
          ],
          "line": 1510
        },
        "resolved": true,
        "details": {
          "function_name": "virFileFdopen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "164-177",
          "snippet": "FILE *virFileFdopen(int *fdptr, const char *mode)\n{\n    FILE *file = NULL;\n\n    if (*fdptr >= 0) {\n        file = fdopen(*fdptr, mode);\n        if (file)\n            *fdptr = -1;\n    } else {\n        errno = EBADF;\n    }\n\n    return file;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nFILE *virFileFdopen(int *fdptr, const char *mode)\n{\n    FILE *file = NULL;\n\n    if (*fdptr >= 0) {\n        file = fdopen(*fdptr, mode);\n        if (file)\n            *fdptr = -1;\n    } else {\n        errno = EBADF;\n    }\n\n    return file;\n}"
        }
      },
      {
        "call_info": {
          "callee": "open",
          "args": [
            "path",
            "O_WRONLY|O_TRUNC|O_CREAT",
            "mode"
          ],
          "line": 1508
        },
        "resolved": true,
        "details": {
          "function_name": "qemuBlockReopenReadOnly",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
          "lines": "3308-3323",
          "snippet": "int\nqemuBlockReopenReadOnly(virDomainObjPtr vm,\n                         virStorageSourcePtr src,\n                         qemuDomainAsyncJob asyncJob)\n{\n    if (src->readonly)\n        return 0;\n\n    src->readonly = true;\n    if (qemuBlockReopenFormat(vm, src, asyncJob) < 0) {\n        src->readonly = false;\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_block.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nint\nqemuBlockReopenReadOnly(virDomainObjPtr vm,\n                         virStorageSourcePtr src,\n                         qemuDomainAsyncJob asyncJob)\n{\n    if (src->readonly)\n        return 0;\n\n    src->readonly = true;\n    if (qemuBlockReopenFormat(vm, src, asyncJob) < 0) {\n        src->readonly = false;\n        return -1;\n    }\n\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileWriteStr(const char *path, const char *str, mode_t mode)\n{\n    int fd;\n\n    if (mode)\n        fd = open(path, O_WRONLY|O_TRUNC|O_CREAT, mode);\n    else\n        fd = open(path, O_WRONLY|O_TRUNC);\n    if (fd == -1)\n        return -1;\n\n    if (safewrite(fd, str, strlen(str)) < 0) {\n        VIR_FORCE_CLOSE(fd);\n        return -1;\n    }\n\n    /* Use errno from failed close only if there was no write error.  */\n    if (VIR_CLOSE(fd) != 0)\n        return -1;\n\n    return 0;\n}"
  },
  {
    "function_name": "virFileReadBufQuiet",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "1479-1496",
    "snippet": "int\nvirFileReadBufQuiet(const char *file, char *buf, int len)\n{\n    int fd;\n    ssize_t sz;\n\n    fd = open(file, O_RDONLY);\n    if (fd < 0)\n        return -errno;\n\n    sz = saferead(fd, buf, len - 1);\n    VIR_FORCE_CLOSE(fd);\n    if (sz < 0)\n        return -errno;\n\n    buf[sz] = '\\0';\n    return sz;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FORCE_CLOSE",
          "args": [
            "fd"
          ],
          "line": 1490
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "saferead",
          "args": [
            "fd",
            "buf",
            "len - 1"
          ],
          "line": 1489
        },
        "resolved": true,
        "details": {
          "function_name": "saferead_lim",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1330-1372",
          "snippet": "static char *\nsaferead_lim(int fd, size_t max_len, size_t *length)\n{\n    char *buf = NULL;\n    size_t alloc = 0;\n    size_t size = 0;\n    int save_errno;\n\n    for (;;) {\n        int count;\n        int requested;\n\n        if (size + BUFSIZ + 1 > alloc) {\n            alloc += alloc / 2;\n            if (alloc < size + BUFSIZ + 1)\n                alloc = size + BUFSIZ + 1;\n\n            if (VIR_REALLOC_N(buf, alloc) < 0) {\n                save_errno = errno;\n                break;\n            }\n        }\n\n        /* Ensure that (size + requested <= max_len); */\n        requested = MIN(size < max_len ? max_len - size : 0,\n                        alloc - size - 1);\n        count = saferead(fd, buf + size, requested);\n        size += count;\n\n        if (count != requested || requested == 0) {\n            save_errno = errno;\n            if (count < 0)\n                break;\n            buf[size] = '\\0';\n            *length = size;\n            return buf;\n        }\n    }\n\n    VIR_FREE(buf);\n    errno = save_errno;\n    return NULL;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic char *\nsaferead_lim(int fd, size_t max_len, size_t *length)\n{\n    char *buf = NULL;\n    size_t alloc = 0;\n    size_t size = 0;\n    int save_errno;\n\n    for (;;) {\n        int count;\n        int requested;\n\n        if (size + BUFSIZ + 1 > alloc) {\n            alloc += alloc / 2;\n            if (alloc < size + BUFSIZ + 1)\n                alloc = size + BUFSIZ + 1;\n\n            if (VIR_REALLOC_N(buf, alloc) < 0) {\n                save_errno = errno;\n                break;\n            }\n        }\n\n        /* Ensure that (size + requested <= max_len); */\n        requested = MIN(size < max_len ? max_len - size : 0,\n                        alloc - size - 1);\n        count = saferead(fd, buf + size, requested);\n        size += count;\n\n        if (count != requested || requested == 0) {\n            save_errno = errno;\n            if (count < 0)\n                break;\n            buf[size] = '\\0';\n            *length = size;\n            return buf;\n        }\n    }\n\n    VIR_FREE(buf);\n    errno = save_errno;\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "open",
          "args": [
            "file",
            "O_RDONLY"
          ],
          "line": 1485
        },
        "resolved": true,
        "details": {
          "function_name": "virFileFdopen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "164-177",
          "snippet": "FILE *virFileFdopen(int *fdptr, const char *mode)\n{\n    FILE *file = NULL;\n\n    if (*fdptr >= 0) {\n        file = fdopen(*fdptr, mode);\n        if (file)\n            *fdptr = -1;\n    } else {\n        errno = EBADF;\n    }\n\n    return file;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nFILE *virFileFdopen(int *fdptr, const char *mode)\n{\n    FILE *file = NULL;\n\n    if (*fdptr >= 0) {\n        file = fdopen(*fdptr, mode);\n        if (file)\n            *fdptr = -1;\n    } else {\n        errno = EBADF;\n    }\n\n    return file;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileReadBufQuiet(const char *file, char *buf, int len)\n{\n    int fd;\n    ssize_t sz;\n\n    fd = open(file, O_RDONLY);\n    if (fd < 0)\n        return -errno;\n\n    sz = saferead(fd, buf, len - 1);\n    VIR_FORCE_CLOSE(fd);\n    if (sz < 0)\n        return -errno;\n\n    buf[sz] = '\\0';\n    return sz;\n}"
  },
  {
    "function_name": "virFileReadAllQuiet",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "1459-1472",
    "snippet": "int\nvirFileReadAllQuiet(const char *path, int maxlen, char **buf)\n{\n    int fd = open(path, O_RDONLY);\n    if (fd < 0)\n        return -errno;\n\n    int len = virFileReadLimFD(fd, maxlen, buf);\n    VIR_FORCE_CLOSE(fd);\n    if (len < 0)\n        return -errno;\n\n    return len;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FORCE_CLOSE",
          "args": [
            "fd"
          ],
          "line": 1467
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virFileReadLimFD",
          "args": [
            "fd",
            "maxlen",
            "buf"
          ],
          "line": 1466
        },
        "resolved": true,
        "details": {
          "function_name": "virFileReadLimFD",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1416-1438",
          "snippet": "int\nvirFileReadLimFD(int fd, int maxlen, char **buf)\n{\n    size_t len;\n    char *s;\n\n    if (maxlen <= 0) {\n        errno = EINVAL;\n        return -1;\n    }\n    s = saferead_lim(fd, maxlen+1, &len);\n    if (s == NULL)\n        return -1;\n    if (len > maxlen || (int)len != len) {\n        VIR_FREE(s);\n        /* There was at least one byte more than MAXLEN.\n           Set errno accordingly. */\n        errno = EOVERFLOW;\n        return -1;\n    }\n    *buf = s;\n    return len;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileReadLimFD(int fd, int maxlen, char **buf)\n{\n    size_t len;\n    char *s;\n\n    if (maxlen <= 0) {\n        errno = EINVAL;\n        return -1;\n    }\n    s = saferead_lim(fd, maxlen+1, &len);\n    if (s == NULL)\n        return -1;\n    if (len > maxlen || (int)len != len) {\n        VIR_FREE(s);\n        /* There was at least one byte more than MAXLEN.\n           Set errno accordingly. */\n        errno = EOVERFLOW;\n        return -1;\n    }\n    *buf = s;\n    return len;\n}"
        }
      },
      {
        "call_info": {
          "callee": "open",
          "args": [
            "path",
            "O_RDONLY"
          ],
          "line": 1462
        },
        "resolved": true,
        "details": {
          "function_name": "virFileFdopen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "164-177",
          "snippet": "FILE *virFileFdopen(int *fdptr, const char *mode)\n{\n    FILE *file = NULL;\n\n    if (*fdptr >= 0) {\n        file = fdopen(*fdptr, mode);\n        if (file)\n            *fdptr = -1;\n    } else {\n        errno = EBADF;\n    }\n\n    return file;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nFILE *virFileFdopen(int *fdptr, const char *mode)\n{\n    FILE *file = NULL;\n\n    if (*fdptr >= 0) {\n        file = fdopen(*fdptr, mode);\n        if (file)\n            *fdptr = -1;\n    } else {\n        errno = EBADF;\n    }\n\n    return file;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileReadAllQuiet(const char *path, int maxlen, char **buf)\n{\n    int fd = open(path, O_RDONLY);\n    if (fd < 0)\n        return -errno;\n\n    int len = virFileReadLimFD(fd, maxlen, buf);\n    VIR_FORCE_CLOSE(fd);\n    if (len < 0)\n        return -errno;\n\n    return len;\n}"
  },
  {
    "function_name": "virFileReadAll",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "1440-1457",
    "snippet": "int\nvirFileReadAll(const char *path, int maxlen, char **buf)\n{\n    int fd = open(path, O_RDONLY);\n    if (fd < 0) {\n        virReportSystemError(errno, _(\"Failed to open file '%s'\"), path);\n        return -1;\n    }\n\n    int len = virFileReadLimFD(fd, maxlen, buf);\n    VIR_FORCE_CLOSE(fd);\n    if (len < 0) {\n        virReportSystemError(errno, _(\"Failed to read file '%s'\"), path);\n        return -1;\n    }\n\n    return len;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"Failed to read file '%s'\")",
            "path"
          ],
          "line": 1452
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Failed to read file '%s'\""
          ],
          "line": 1452
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FORCE_CLOSE",
          "args": [
            "fd"
          ],
          "line": 1450
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virFileReadLimFD",
          "args": [
            "fd",
            "maxlen",
            "buf"
          ],
          "line": 1449
        },
        "resolved": true,
        "details": {
          "function_name": "virFileReadLimFD",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1416-1438",
          "snippet": "int\nvirFileReadLimFD(int fd, int maxlen, char **buf)\n{\n    size_t len;\n    char *s;\n\n    if (maxlen <= 0) {\n        errno = EINVAL;\n        return -1;\n    }\n    s = saferead_lim(fd, maxlen+1, &len);\n    if (s == NULL)\n        return -1;\n    if (len > maxlen || (int)len != len) {\n        VIR_FREE(s);\n        /* There was at least one byte more than MAXLEN.\n           Set errno accordingly. */\n        errno = EOVERFLOW;\n        return -1;\n    }\n    *buf = s;\n    return len;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileReadLimFD(int fd, int maxlen, char **buf)\n{\n    size_t len;\n    char *s;\n\n    if (maxlen <= 0) {\n        errno = EINVAL;\n        return -1;\n    }\n    s = saferead_lim(fd, maxlen+1, &len);\n    if (s == NULL)\n        return -1;\n    if (len > maxlen || (int)len != len) {\n        VIR_FREE(s);\n        /* There was at least one byte more than MAXLEN.\n           Set errno accordingly. */\n        errno = EOVERFLOW;\n        return -1;\n    }\n    *buf = s;\n    return len;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"Failed to open file '%s'\")",
            "path"
          ],
          "line": 1445
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "open",
          "args": [
            "path",
            "O_RDONLY"
          ],
          "line": 1443
        },
        "resolved": true,
        "details": {
          "function_name": "virFileFdopen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "164-177",
          "snippet": "FILE *virFileFdopen(int *fdptr, const char *mode)\n{\n    FILE *file = NULL;\n\n    if (*fdptr >= 0) {\n        file = fdopen(*fdptr, mode);\n        if (file)\n            *fdptr = -1;\n    } else {\n        errno = EBADF;\n    }\n\n    return file;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nFILE *virFileFdopen(int *fdptr, const char *mode)\n{\n    FILE *file = NULL;\n\n    if (*fdptr >= 0) {\n        file = fdopen(*fdptr, mode);\n        if (file)\n            *fdptr = -1;\n    } else {\n        errno = EBADF;\n    }\n\n    return file;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileReadAll(const char *path, int maxlen, char **buf)\n{\n    int fd = open(path, O_RDONLY);\n    if (fd < 0) {\n        virReportSystemError(errno, _(\"Failed to open file '%s'\"), path);\n        return -1;\n    }\n\n    int len = virFileReadLimFD(fd, maxlen, buf);\n    VIR_FORCE_CLOSE(fd);\n    if (len < 0) {\n        virReportSystemError(errno, _(\"Failed to read file '%s'\"), path);\n        return -1;\n    }\n\n    return len;\n}"
  },
  {
    "function_name": "virFileReadLimFD",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "1416-1438",
    "snippet": "int\nvirFileReadLimFD(int fd, int maxlen, char **buf)\n{\n    size_t len;\n    char *s;\n\n    if (maxlen <= 0) {\n        errno = EINVAL;\n        return -1;\n    }\n    s = saferead_lim(fd, maxlen+1, &len);\n    if (s == NULL)\n        return -1;\n    if (len > maxlen || (int)len != len) {\n        VIR_FREE(s);\n        /* There was at least one byte more than MAXLEN.\n           Set errno accordingly. */\n        errno = EOVERFLOW;\n        return -1;\n    }\n    *buf = s;\n    return len;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "s"
          ],
          "line": 1430
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "saferead_lim",
          "args": [
            "fd",
            "maxlen+1",
            "&len"
          ],
          "line": 1426
        },
        "resolved": true,
        "details": {
          "function_name": "saferead_lim",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1330-1372",
          "snippet": "static char *\nsaferead_lim(int fd, size_t max_len, size_t *length)\n{\n    char *buf = NULL;\n    size_t alloc = 0;\n    size_t size = 0;\n    int save_errno;\n\n    for (;;) {\n        int count;\n        int requested;\n\n        if (size + BUFSIZ + 1 > alloc) {\n            alloc += alloc / 2;\n            if (alloc < size + BUFSIZ + 1)\n                alloc = size + BUFSIZ + 1;\n\n            if (VIR_REALLOC_N(buf, alloc) < 0) {\n                save_errno = errno;\n                break;\n            }\n        }\n\n        /* Ensure that (size + requested <= max_len); */\n        requested = MIN(size < max_len ? max_len - size : 0,\n                        alloc - size - 1);\n        count = saferead(fd, buf + size, requested);\n        size += count;\n\n        if (count != requested || requested == 0) {\n            save_errno = errno;\n            if (count < 0)\n                break;\n            buf[size] = '\\0';\n            *length = size;\n            return buf;\n        }\n    }\n\n    VIR_FREE(buf);\n    errno = save_errno;\n    return NULL;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic char *\nsaferead_lim(int fd, size_t max_len, size_t *length)\n{\n    char *buf = NULL;\n    size_t alloc = 0;\n    size_t size = 0;\n    int save_errno;\n\n    for (;;) {\n        int count;\n        int requested;\n\n        if (size + BUFSIZ + 1 > alloc) {\n            alloc += alloc / 2;\n            if (alloc < size + BUFSIZ + 1)\n                alloc = size + BUFSIZ + 1;\n\n            if (VIR_REALLOC_N(buf, alloc) < 0) {\n                save_errno = errno;\n                break;\n            }\n        }\n\n        /* Ensure that (size + requested <= max_len); */\n        requested = MIN(size < max_len ? max_len - size : 0,\n                        alloc - size - 1);\n        count = saferead(fd, buf + size, requested);\n        size += count;\n\n        if (count != requested || requested == 0) {\n            save_errno = errno;\n            if (count < 0)\n                break;\n            buf[size] = '\\0';\n            *length = size;\n            return buf;\n        }\n    }\n\n    VIR_FREE(buf);\n    errno = save_errno;\n    return NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileReadLimFD(int fd, int maxlen, char **buf)\n{\n    size_t len;\n    char *s;\n\n    if (maxlen <= 0) {\n        errno = EINVAL;\n        return -1;\n    }\n    s = saferead_lim(fd, maxlen+1, &len);\n    if (s == NULL)\n        return -1;\n    if (len > maxlen || (int)len != len) {\n        VIR_FREE(s);\n        /* There was at least one byte more than MAXLEN.\n           Set errno accordingly. */\n        errno = EOVERFLOW;\n        return -1;\n    }\n    *buf = s;\n    return len;\n}"
  },
  {
    "function_name": "virFileReadHeaderQuiet",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "1395-1411",
    "snippet": "int\nvirFileReadHeaderQuiet(const char *path,\n                       int maxlen,\n                       char **buf)\n{\n    int fd;\n    int len;\n\n    fd = open(path, O_RDONLY);\n    if (fd < 0)\n        return -1;\n\n    len = virFileReadHeaderFD(fd, maxlen, buf);\n    VIR_FORCE_CLOSE(fd);\n\n    return len;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FORCE_CLOSE",
          "args": [
            "fd"
          ],
          "line": 1408
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virFileReadHeaderFD",
          "args": [
            "fd",
            "maxlen",
            "buf"
          ],
          "line": 1407
        },
        "resolved": true,
        "details": {
          "function_name": "virFileReadHeaderFD",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1377-1392",
          "snippet": "int\nvirFileReadHeaderFD(int fd, int maxlen, char **buf)\n{\n    size_t len;\n    char *s;\n\n    if (maxlen <= 0) {\n        errno = EINVAL;\n        return -1;\n    }\n    s = saferead_lim(fd, maxlen, &len);\n    if (s == NULL)\n        return -1;\n    *buf = s;\n    return len;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileReadHeaderFD(int fd, int maxlen, char **buf)\n{\n    size_t len;\n    char *s;\n\n    if (maxlen <= 0) {\n        errno = EINVAL;\n        return -1;\n    }\n    s = saferead_lim(fd, maxlen, &len);\n    if (s == NULL)\n        return -1;\n    *buf = s;\n    return len;\n}"
        }
      },
      {
        "call_info": {
          "callee": "open",
          "args": [
            "path",
            "O_RDONLY"
          ],
          "line": 1403
        },
        "resolved": true,
        "details": {
          "function_name": "virFileFdopen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "164-177",
          "snippet": "FILE *virFileFdopen(int *fdptr, const char *mode)\n{\n    FILE *file = NULL;\n\n    if (*fdptr >= 0) {\n        file = fdopen(*fdptr, mode);\n        if (file)\n            *fdptr = -1;\n    } else {\n        errno = EBADF;\n    }\n\n    return file;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nFILE *virFileFdopen(int *fdptr, const char *mode)\n{\n    FILE *file = NULL;\n\n    if (*fdptr >= 0) {\n        file = fdopen(*fdptr, mode);\n        if (file)\n            *fdptr = -1;\n    } else {\n        errno = EBADF;\n    }\n\n    return file;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileReadHeaderQuiet(const char *path,\n                       int maxlen,\n                       char **buf)\n{\n    int fd;\n    int len;\n\n    fd = open(path, O_RDONLY);\n    if (fd < 0)\n        return -1;\n\n    len = virFileReadHeaderFD(fd, maxlen, buf);\n    VIR_FORCE_CLOSE(fd);\n\n    return len;\n}"
  },
  {
    "function_name": "virFileReadHeaderFD",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "1377-1392",
    "snippet": "int\nvirFileReadHeaderFD(int fd, int maxlen, char **buf)\n{\n    size_t len;\n    char *s;\n\n    if (maxlen <= 0) {\n        errno = EINVAL;\n        return -1;\n    }\n    s = saferead_lim(fd, maxlen, &len);\n    if (s == NULL)\n        return -1;\n    *buf = s;\n    return len;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "saferead_lim",
          "args": [
            "fd",
            "maxlen",
            "&len"
          ],
          "line": 1387
        },
        "resolved": true,
        "details": {
          "function_name": "saferead_lim",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1330-1372",
          "snippet": "static char *\nsaferead_lim(int fd, size_t max_len, size_t *length)\n{\n    char *buf = NULL;\n    size_t alloc = 0;\n    size_t size = 0;\n    int save_errno;\n\n    for (;;) {\n        int count;\n        int requested;\n\n        if (size + BUFSIZ + 1 > alloc) {\n            alloc += alloc / 2;\n            if (alloc < size + BUFSIZ + 1)\n                alloc = size + BUFSIZ + 1;\n\n            if (VIR_REALLOC_N(buf, alloc) < 0) {\n                save_errno = errno;\n                break;\n            }\n        }\n\n        /* Ensure that (size + requested <= max_len); */\n        requested = MIN(size < max_len ? max_len - size : 0,\n                        alloc - size - 1);\n        count = saferead(fd, buf + size, requested);\n        size += count;\n\n        if (count != requested || requested == 0) {\n            save_errno = errno;\n            if (count < 0)\n                break;\n            buf[size] = '\\0';\n            *length = size;\n            return buf;\n        }\n    }\n\n    VIR_FREE(buf);\n    errno = save_errno;\n    return NULL;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic char *\nsaferead_lim(int fd, size_t max_len, size_t *length)\n{\n    char *buf = NULL;\n    size_t alloc = 0;\n    size_t size = 0;\n    int save_errno;\n\n    for (;;) {\n        int count;\n        int requested;\n\n        if (size + BUFSIZ + 1 > alloc) {\n            alloc += alloc / 2;\n            if (alloc < size + BUFSIZ + 1)\n                alloc = size + BUFSIZ + 1;\n\n            if (VIR_REALLOC_N(buf, alloc) < 0) {\n                save_errno = errno;\n                break;\n            }\n        }\n\n        /* Ensure that (size + requested <= max_len); */\n        requested = MIN(size < max_len ? max_len - size : 0,\n                        alloc - size - 1);\n        count = saferead(fd, buf + size, requested);\n        size += count;\n\n        if (count != requested || requested == 0) {\n            save_errno = errno;\n            if (count < 0)\n                break;\n            buf[size] = '\\0';\n            *length = size;\n            return buf;\n        }\n    }\n\n    VIR_FREE(buf);\n    errno = save_errno;\n    return NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileReadHeaderFD(int fd, int maxlen, char **buf)\n{\n    size_t len;\n    char *s;\n\n    if (maxlen <= 0) {\n        errno = EINVAL;\n        return -1;\n    }\n    s = saferead_lim(fd, maxlen, &len);\n    if (s == NULL)\n        return -1;\n    *buf = s;\n    return len;\n}"
  },
  {
    "function_name": "saferead_lim",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "1330-1372",
    "snippet": "static char *\nsaferead_lim(int fd, size_t max_len, size_t *length)\n{\n    char *buf = NULL;\n    size_t alloc = 0;\n    size_t size = 0;\n    int save_errno;\n\n    for (;;) {\n        int count;\n        int requested;\n\n        if (size + BUFSIZ + 1 > alloc) {\n            alloc += alloc / 2;\n            if (alloc < size + BUFSIZ + 1)\n                alloc = size + BUFSIZ + 1;\n\n            if (VIR_REALLOC_N(buf, alloc) < 0) {\n                save_errno = errno;\n                break;\n            }\n        }\n\n        /* Ensure that (size + requested <= max_len); */\n        requested = MIN(size < max_len ? max_len - size : 0,\n                        alloc - size - 1);\n        count = saferead(fd, buf + size, requested);\n        size += count;\n\n        if (count != requested || requested == 0) {\n            save_errno = errno;\n            if (count < 0)\n                break;\n            buf[size] = '\\0';\n            *length = size;\n            return buf;\n        }\n    }\n\n    VIR_FREE(buf);\n    errno = save_errno;\n    return NULL;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "buf"
          ],
          "line": 1369
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "saferead",
          "args": [
            "fd",
            "buf + size",
            "requested"
          ],
          "line": 1356
        },
        "resolved": true,
        "details": {
          "function_name": "saferead_lim",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1330-1372",
          "snippet": "static char *\nsaferead_lim(int fd, size_t max_len, size_t *length)\n{\n    char *buf = NULL;\n    size_t alloc = 0;\n    size_t size = 0;\n    int save_errno;\n\n    for (;;) {\n        int count;\n        int requested;\n\n        if (size + BUFSIZ + 1 > alloc) {\n            alloc += alloc / 2;\n            if (alloc < size + BUFSIZ + 1)\n                alloc = size + BUFSIZ + 1;\n\n            if (VIR_REALLOC_N(buf, alloc) < 0) {\n                save_errno = errno;\n                break;\n            }\n        }\n\n        /* Ensure that (size + requested <= max_len); */\n        requested = MIN(size < max_len ? max_len - size : 0,\n                        alloc - size - 1);\n        count = saferead(fd, buf + size, requested);\n        size += count;\n\n        if (count != requested || requested == 0) {\n            save_errno = errno;\n            if (count < 0)\n                break;\n            buf[size] = '\\0';\n            *length = size;\n            return buf;\n        }\n    }\n\n    VIR_FREE(buf);\n    errno = save_errno;\n    return NULL;\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "MIN",
          "args": [
            "size < max_len ? max_len - size : 0",
            "alloc - size - 1"
          ],
          "line": 1354
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_REALLOC_N",
          "args": [
            "buf",
            "alloc"
          ],
          "line": 1347
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic char *\nsaferead_lim(int fd, size_t max_len, size_t *length)\n{\n    char *buf = NULL;\n    size_t alloc = 0;\n    size_t size = 0;\n    int save_errno;\n\n    for (;;) {\n        int count;\n        int requested;\n\n        if (size + BUFSIZ + 1 > alloc) {\n            alloc += alloc / 2;\n            if (alloc < size + BUFSIZ + 1)\n                alloc = size + BUFSIZ + 1;\n\n            if (VIR_REALLOC_N(buf, alloc) < 0) {\n                save_errno = errno;\n                break;\n            }\n        }\n\n        /* Ensure that (size + requested <= max_len); */\n        requested = MIN(size < max_len ? max_len - size : 0,\n                        alloc - size - 1);\n        count = saferead(fd, buf + size, requested);\n        size += count;\n\n        if (count != requested || requested == 0) {\n            save_errno = errno;\n            if (count < 0)\n                break;\n            buf[size] = '\\0';\n            *length = size;\n            return buf;\n        }\n    }\n\n    VIR_FREE(buf);\n    errno = save_errno;\n    return NULL;\n}"
  },
  {
    "function_name": "virBuildPathInternal",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "1302-1327",
    "snippet": "int\nvirBuildPathInternal(char **path, ...)\n{\n    char *path_component = NULL;\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n    va_list ap;\n    int ret = 0;\n\n    va_start(ap, path);\n\n    path_component = va_arg(ap, char *);\n    virBufferAdd(&buf, path_component, -1);\n\n    while ((path_component = va_arg(ap, char *)) != NULL) {\n        virBufferAddChar(&buf, '/');\n        virBufferAdd(&buf, path_component, -1);\n    }\n\n    va_end(ap);\n\n    *path = virBufferContentAndReset(&buf);\n    if (*path == NULL)\n        ret = -1;\n\n    return ret;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virBufferContentAndReset",
          "args": [
            "&buf"
          ],
          "line": 1322
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferContentAndReset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "247-260",
          "snippet": "char *\nvirBufferContentAndReset(virBufferPtr buf)\n{\n    char *str = NULL;\n\n    if (!buf)\n        return NULL;\n\n    if (buf->str)\n        str = g_string_free(buf->str, false);\n\n    memset(buf, 0, sizeof(*buf));\n    return str;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nchar *\nvirBufferContentAndReset(virBufferPtr buf)\n{\n    char *str = NULL;\n\n    if (!buf)\n        return NULL;\n\n    if (buf->str)\n        str = g_string_free(buf->str, false);\n\n    memset(buf, 0, sizeof(*buf));\n    return str;\n}"
        }
      },
      {
        "call_info": {
          "callee": "va_end",
          "args": [
            "ap"
          ],
          "line": 1320
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBufferAdd",
          "args": [
            "&buf",
            "path_component",
            "-1"
          ],
          "line": 1317
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferAdd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "156-169",
          "snippet": "void\nvirBufferAdd(virBufferPtr buf, const char *str, int len)\n{\n    if (!str || !buf || (len == 0 && buf->indent == 0))\n        return;\n\n    virBufferInitialize(buf);\n    virBufferApplyIndent(buf);\n\n    if (len < 0)\n        g_string_append(buf->str, str);\n    else\n        g_string_append_len(buf->str, str, len);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirBufferAdd(virBufferPtr buf, const char *str, int len)\n{\n    if (!str || !buf || (len == 0 && buf->indent == 0))\n        return;\n\n    virBufferInitialize(buf);\n    virBufferApplyIndent(buf);\n\n    if (len < 0)\n        g_string_append(buf->str, str);\n    else\n        g_string_append_len(buf->str, str, len);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferAddChar",
          "args": [
            "&buf",
            "'/'"
          ],
          "line": 1316
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferAddChar",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "206-210",
          "snippet": "void\nvirBufferAddChar(virBufferPtr buf, char c)\n{\n    virBufferAdd(buf, &c, 1);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirBufferAddChar(virBufferPtr buf, char c)\n{\n    virBufferAdd(buf, &c, 1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "va_arg",
          "args": [
            "ap",
            "char*"
          ],
          "line": 1315
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_arg",
          "args": [
            "ap",
            "char*"
          ],
          "line": 1312
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_start",
          "args": [
            "ap",
            "path"
          ],
          "line": 1310
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirBuildPathInternal(char **path, ...)\n{\n    char *path_component = NULL;\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n    va_list ap;\n    int ret = 0;\n\n    va_start(ap, path);\n\n    path_component = va_arg(ap, char *);\n    virBufferAdd(&buf, path_component, -1);\n\n    while ((path_component = va_arg(ap, char *)) != NULL) {\n        virBufferAddChar(&buf, '/');\n        virBufferAdd(&buf, path_component, -1);\n    }\n\n    va_end(ap);\n\n    *path = virBufferContentAndReset(&buf);\n    if (*path == NULL)\n        ret = -1;\n\n    return ret;\n}"
  },
  {
    "function_name": "virFileFindMountPoint",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "1292-1298",
    "snippet": "char *\nvirFileFindMountPoint(const char *type G_GNUC_UNUSED)\n{\n    errno = ENOSYS;\n\n    return NULL;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nchar *\nvirFileFindMountPoint(const char *type G_GNUC_UNUSED)\n{\n    errno = ENOSYS;\n\n    return NULL;\n}"
  },
  {
    "function_name": "virFileFindMountPoint",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "1262-1288",
    "snippet": "char *\nvirFileFindMountPoint(const char *type)\n{\n    FILE *f;\n    struct mntent mb;\n    char mntbuf[1024];\n    char *ret = NULL;\n\n    f = setmntent(\"/proc/mounts\", \"r\");\n    if (!f)\n        return NULL;\n\n    while (getmntent_r(f, &mb, mntbuf, sizeof(mntbuf))) {\n        if (STREQ(mb.mnt_type, type)) {\n            ret = g_strdup(mb.mnt_dir);\n            goto cleanup;\n        }\n    }\n\n    if (!ret)\n        errno = ENOENT;\n\n cleanup:\n    endmntent(f);\n\n    return ret;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "endmntent",
          "args": [
            "f"
          ],
          "line": 1285
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "mb.mnt_dir"
          ],
          "line": 1276
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "mb.mnt_type",
            "type"
          ],
          "line": 1275
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getmntent_r",
          "args": [
            "f",
            "&mb",
            "mntbuf",
            "sizeof(mntbuf)"
          ],
          "line": 1274
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setmntent",
          "args": [
            "\"/proc/mounts\"",
            "\"r\""
          ],
          "line": 1270
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nchar *\nvirFileFindMountPoint(const char *type)\n{\n    FILE *f;\n    struct mntent mb;\n    char mntbuf[1024];\n    char *ret = NULL;\n\n    f = setmntent(\"/proc/mounts\", \"r\");\n    if (!f)\n        return NULL;\n\n    while (getmntent_r(f, &mb, mntbuf, sizeof(mntbuf))) {\n        if (STREQ(mb.mnt_type, type)) {\n            ret = g_strdup(mb.mnt_dir);\n            goto cleanup;\n        }\n    }\n\n    if (!ret)\n        errno = ENOENT;\n\n cleanup:\n    endmntent(f);\n\n    return ret;\n}"
  },
  {
    "function_name": "virFileAllocate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "1246-1255",
    "snippet": "int virFileAllocate(int fd, off_t offset, off_t len)\n{\n    int ret;\n\n    ret = safezero_posix_fallocate(fd, offset, len);\n    if (ret != -2)\n        return ret;\n\n    return safezero_sys_fallocate(fd, offset, len);\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "safezero_sys_fallocate",
          "args": [
            "fd",
            "offset",
            "len"
          ],
          "line": 1254
        },
        "resolved": true,
        "details": {
          "function_name": "safezero_sys_fallocate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1142-1148",
          "snippet": "static int\nsafezero_sys_fallocate(int fd G_GNUC_UNUSED,\n                       off_t offset G_GNUC_UNUSED,\n                       off_t len G_GNUC_UNUSED)\n{\n    return -2;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nsafezero_sys_fallocate(int fd G_GNUC_UNUSED,\n                       off_t offset G_GNUC_UNUSED,\n                       off_t len G_GNUC_UNUSED)\n{\n    return -2;\n}"
        }
      },
      {
        "call_info": {
          "callee": "safezero_posix_fallocate",
          "args": [
            "fd",
            "offset",
            "len"
          ],
          "line": 1250
        },
        "resolved": true,
        "details": {
          "function_name": "safezero_posix_fallocate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1124-1130",
          "snippet": "static int\nsafezero_posix_fallocate(int fd G_GNUC_UNUSED,\n                         off_t offset G_GNUC_UNUSED,\n                         off_t len G_GNUC_UNUSED)\n{\n    return -2;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nsafezero_posix_fallocate(int fd G_GNUC_UNUSED,\n                         off_t offset G_GNUC_UNUSED,\n                         off_t len G_GNUC_UNUSED)\n{\n    return -2;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint virFileAllocate(int fd, off_t offset, off_t len)\n{\n    int ret;\n\n    ret = safezero_posix_fallocate(fd, offset, len);\n    if (ret != -2)\n        return ret;\n\n    return safezero_sys_fallocate(fd, offset, len);\n}"
  },
  {
    "function_name": "safezero",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "1229-1244",
    "snippet": "int safezero(int fd, off_t offset, off_t len)\n{\n    int ret;\n\n    ret = safezero_posix_fallocate(fd, offset, len);\n    if (ret != -2)\n        return ret;\n\n    if (safezero_sys_fallocate(fd, offset, len) == 0)\n        return 0;\n\n    ret = safezero_mmap(fd, offset, len);\n    if (ret != -2)\n        return ret;\n    return safezero_slow(fd, offset, len);\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "safezero_slow",
          "args": [
            "fd",
            "offset",
            "len"
          ],
          "line": 1243
        },
        "resolved": true,
        "details": {
          "function_name": "safezero_slow",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1195-1227",
          "snippet": "static int\nsafezero_slow(int fd, off_t offset, off_t len)\n{\n    int r;\n    g_autofree char *buf = NULL;\n    unsigned long long remain, bytes;\n\n    if (lseek(fd, offset, SEEK_SET) < 0)\n        return -1;\n\n    /* Split up the write in small chunks so as not to allocate lots of RAM */\n    remain = len;\n    bytes = MIN(1024 * 1024, len);\n\n    r = VIR_ALLOC_N(buf, bytes);\n    if (r < 0) {\n        errno = ENOMEM;\n        return -1;\n    }\n\n    while (remain) {\n        if (bytes > remain)\n            bytes = remain;\n\n        r = safewrite(fd, buf, bytes);\n        if (r < 0)\n            return -1;\n\n        /* safewrite() guarantees all data will be written */\n        remain -= bytes;\n    }\n    return 0;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nsafezero_slow(int fd, off_t offset, off_t len)\n{\n    int r;\n    g_autofree char *buf = NULL;\n    unsigned long long remain, bytes;\n\n    if (lseek(fd, offset, SEEK_SET) < 0)\n        return -1;\n\n    /* Split up the write in small chunks so as not to allocate lots of RAM */\n    remain = len;\n    bytes = MIN(1024 * 1024, len);\n\n    r = VIR_ALLOC_N(buf, bytes);\n    if (r < 0) {\n        errno = ENOMEM;\n        return -1;\n    }\n\n    while (remain) {\n        if (bytes > remain)\n            bytes = remain;\n\n        r = safewrite(fd, buf, bytes);\n        if (r < 0)\n            return -1;\n\n        /* safewrite() guarantees all data will be written */\n        remain -= bytes;\n    }\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "safezero_mmap",
          "args": [
            "fd",
            "offset",
            "len"
          ],
          "line": 1240
        },
        "resolved": true,
        "details": {
          "function_name": "safezero_mmap",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1186-1192",
          "snippet": "static int\nsafezero_mmap(int fd G_GNUC_UNUSED,\n              off_t offset G_GNUC_UNUSED,\n              off_t len G_GNUC_UNUSED)\n{\n    return -2;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nsafezero_mmap(int fd G_GNUC_UNUSED,\n              off_t offset G_GNUC_UNUSED,\n              off_t len G_GNUC_UNUSED)\n{\n    return -2;\n}"
        }
      },
      {
        "call_info": {
          "callee": "safezero_sys_fallocate",
          "args": [
            "fd",
            "offset",
            "len"
          ],
          "line": 1237
        },
        "resolved": true,
        "details": {
          "function_name": "safezero_sys_fallocate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1142-1148",
          "snippet": "static int\nsafezero_sys_fallocate(int fd G_GNUC_UNUSED,\n                       off_t offset G_GNUC_UNUSED,\n                       off_t len G_GNUC_UNUSED)\n{\n    return -2;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nsafezero_sys_fallocate(int fd G_GNUC_UNUSED,\n                       off_t offset G_GNUC_UNUSED,\n                       off_t len G_GNUC_UNUSED)\n{\n    return -2;\n}"
        }
      },
      {
        "call_info": {
          "callee": "safezero_posix_fallocate",
          "args": [
            "fd",
            "offset",
            "len"
          ],
          "line": 1233
        },
        "resolved": true,
        "details": {
          "function_name": "safezero_posix_fallocate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1124-1130",
          "snippet": "static int\nsafezero_posix_fallocate(int fd G_GNUC_UNUSED,\n                         off_t offset G_GNUC_UNUSED,\n                         off_t len G_GNUC_UNUSED)\n{\n    return -2;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nsafezero_posix_fallocate(int fd G_GNUC_UNUSED,\n                         off_t offset G_GNUC_UNUSED,\n                         off_t len G_GNUC_UNUSED)\n{\n    return -2;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint safezero(int fd, off_t offset, off_t len)\n{\n    int ret;\n\n    ret = safezero_posix_fallocate(fd, offset, len);\n    if (ret != -2)\n        return ret;\n\n    if (safezero_sys_fallocate(fd, offset, len) == 0)\n        return 0;\n\n    ret = safezero_mmap(fd, offset, len);\n    if (ret != -2)\n        return ret;\n    return safezero_slow(fd, offset, len);\n}"
  },
  {
    "function_name": "safezero_slow",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "1195-1227",
    "snippet": "static int\nsafezero_slow(int fd, off_t offset, off_t len)\n{\n    int r;\n    g_autofree char *buf = NULL;\n    unsigned long long remain, bytes;\n\n    if (lseek(fd, offset, SEEK_SET) < 0)\n        return -1;\n\n    /* Split up the write in small chunks so as not to allocate lots of RAM */\n    remain = len;\n    bytes = MIN(1024 * 1024, len);\n\n    r = VIR_ALLOC_N(buf, bytes);\n    if (r < 0) {\n        errno = ENOMEM;\n        return -1;\n    }\n\n    while (remain) {\n        if (bytes > remain)\n            bytes = remain;\n\n        r = safewrite(fd, buf, bytes);\n        if (r < 0)\n            return -1;\n\n        /* safewrite() guarantees all data will be written */\n        remain -= bytes;\n    }\n    return 0;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "safewrite",
          "args": [
            "fd",
            "buf",
            "bytes"
          ],
          "line": 1219
        },
        "resolved": true,
        "details": {
          "function_name": "safewrite",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1093-1111",
          "snippet": "ssize_t\nsafewrite(int fd, const void *buf, size_t count)\n{\n    size_t nwritten = 0;\n    while (count > 0) {\n        ssize_t r = write(fd, buf, count);\n\n        if (r < 0 && errno == EINTR)\n            continue;\n        if (r < 0)\n            return r;\n        if (r == 0)\n            return nwritten;\n        buf = (const char *)buf + r;\n        count -= r;\n        nwritten += r;\n    }\n    return nwritten;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nssize_t\nsafewrite(int fd, const void *buf, size_t count)\n{\n    size_t nwritten = 0;\n    while (count > 0) {\n        ssize_t r = write(fd, buf, count);\n\n        if (r < 0 && errno == EINTR)\n            continue;\n        if (r < 0)\n            return r;\n        if (r == 0)\n            return nwritten;\n        buf = (const char *)buf + r;\n        count -= r;\n        nwritten += r;\n    }\n    return nwritten;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC_N",
          "args": [
            "buf",
            "bytes"
          ],
          "line": 1209
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MIN",
          "args": [
            "1024 * 1024",
            "len"
          ],
          "line": 1207
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lseek",
          "args": [
            "fd",
            "offset",
            "SEEK_SET"
          ],
          "line": 1202
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nsafezero_slow(int fd, off_t offset, off_t len)\n{\n    int r;\n    g_autofree char *buf = NULL;\n    unsigned long long remain, bytes;\n\n    if (lseek(fd, offset, SEEK_SET) < 0)\n        return -1;\n\n    /* Split up the write in small chunks so as not to allocate lots of RAM */\n    remain = len;\n    bytes = MIN(1024 * 1024, len);\n\n    r = VIR_ALLOC_N(buf, bytes);\n    if (r < 0) {\n        errno = ENOMEM;\n        return -1;\n    }\n\n    while (remain) {\n        if (bytes > remain)\n            bytes = remain;\n\n        r = safewrite(fd, buf, bytes);\n        if (r < 0)\n            return -1;\n\n        /* safewrite() guarantees all data will be written */\n        remain -= bytes;\n    }\n    return 0;\n}"
  },
  {
    "function_name": "safezero_mmap",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "1186-1192",
    "snippet": "static int\nsafezero_mmap(int fd G_GNUC_UNUSED,\n              off_t offset G_GNUC_UNUSED,\n              off_t len G_GNUC_UNUSED)\n{\n    return -2;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nsafezero_mmap(int fd G_GNUC_UNUSED,\n              off_t offset G_GNUC_UNUSED,\n              off_t len G_GNUC_UNUSED)\n{\n    return -2;\n}"
  },
  {
    "function_name": "safezero_mmap",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "1152-1184",
    "snippet": "static int\nsafezero_mmap(int fd, off_t offset, off_t len)\n{\n    int r;\n    char *buf;\n    static long pagemask;\n    off_t map_skip;\n\n    /* align offset and length, rounding offset down and length up */\n    if (pagemask == 0)\n        pagemask = ~(virGetSystemPageSize() - 1);\n    map_skip = offset - (offset & pagemask);\n\n    /* memset wants the mmap'ed file to be present on disk so create a\n     * sparse file\n     */\n    r = ftruncate(fd, offset + len);\n    if (r < 0)\n        return -1;\n\n    buf = mmap(NULL, len + map_skip, PROT_READ | PROT_WRITE, MAP_SHARED,\n               fd, offset - map_skip);\n    if (buf != MAP_FAILED) {\n        memset(buf + map_skip, 0, len);\n        munmap(buf, len + map_skip);\n\n        return 0;\n    }\n\n    /* fall back to writing zeroes using safewrite if mmap fails (for\n     * example because of virtual memory limits) */\n    return -2;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "munmap",
          "args": [
            "buf",
            "len + map_skip"
          ],
          "line": 1176
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "buf + map_skip",
            "0",
            "len"
          ],
          "line": 1175
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mmap",
          "args": [
            "NULL",
            "len + map_skip",
            "PROT_READ | PROT_WRITE",
            "MAP_SHARED",
            "fd",
            "offset - map_skip"
          ],
          "line": 1172
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ftruncate",
          "args": [
            "fd",
            "offset + len"
          ],
          "line": 1168
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virGetSystemPageSize",
          "args": [],
          "line": 1162
        },
        "resolved": true,
        "details": {
          "function_name": "virGetSystemPageSizeKB",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
          "lines": "1602-1608",
          "snippet": "long virGetSystemPageSizeKB(void)\n{\n    long val = virGetSystemPageSize();\n    if (val < 0)\n        return val;\n    return val / 1024;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <sys/prctl.h>",
            "# include <cap-ng.h>",
            "# include <grp.h>",
            "# include <pwd.h>",
            "# include <libdevmapper.h>",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <conio.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nlong virGetSystemPageSizeKB(void)\n{\n    long val = virGetSystemPageSize();\n    if (val < 0)\n        return val;\n    return val / 1024;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nsafezero_mmap(int fd, off_t offset, off_t len)\n{\n    int r;\n    char *buf;\n    static long pagemask;\n    off_t map_skip;\n\n    /* align offset and length, rounding offset down and length up */\n    if (pagemask == 0)\n        pagemask = ~(virGetSystemPageSize() - 1);\n    map_skip = offset - (offset & pagemask);\n\n    /* memset wants the mmap'ed file to be present on disk so create a\n     * sparse file\n     */\n    r = ftruncate(fd, offset + len);\n    if (r < 0)\n        return -1;\n\n    buf = mmap(NULL, len + map_skip, PROT_READ | PROT_WRITE, MAP_SHARED,\n               fd, offset - map_skip);\n    if (buf != MAP_FAILED) {\n        memset(buf + map_skip, 0, len);\n        munmap(buf, len + map_skip);\n\n        return 0;\n    }\n\n    /* fall back to writing zeroes using safewrite if mmap fails (for\n     * example because of virtual memory limits) */\n    return -2;\n}"
  },
  {
    "function_name": "safezero_sys_fallocate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "1142-1148",
    "snippet": "static int\nsafezero_sys_fallocate(int fd G_GNUC_UNUSED,\n                       off_t offset G_GNUC_UNUSED,\n                       off_t len G_GNUC_UNUSED)\n{\n    return -2;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nsafezero_sys_fallocate(int fd G_GNUC_UNUSED,\n                       off_t offset G_GNUC_UNUSED,\n                       off_t len G_GNUC_UNUSED)\n{\n    return -2;\n}"
  },
  {
    "function_name": "safezero_sys_fallocate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "1134-1140",
    "snippet": "static int\nsafezero_sys_fallocate(int fd,\n                       off_t offset,\n                       off_t len)\n{\n    return syscall(SYS_fallocate, fd, 0, offset, len);\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "syscall",
          "args": [
            "SYS_fallocate",
            "fd",
            "0",
            "offset",
            "len"
          ],
          "line": 1139
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nsafezero_sys_fallocate(int fd,\n                       off_t offset,\n                       off_t len)\n{\n    return syscall(SYS_fallocate, fd, 0, offset, len);\n}"
  },
  {
    "function_name": "safezero_posix_fallocate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "1124-1130",
    "snippet": "static int\nsafezero_posix_fallocate(int fd G_GNUC_UNUSED,\n                         off_t offset G_GNUC_UNUSED,\n                         off_t len G_GNUC_UNUSED)\n{\n    return -2;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nsafezero_posix_fallocate(int fd G_GNUC_UNUSED,\n                         off_t offset G_GNUC_UNUSED,\n                         off_t len G_GNUC_UNUSED)\n{\n    return -2;\n}"
  },
  {
    "function_name": "safezero_posix_fallocate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "1114-1122",
    "snippet": "static int\nsafezero_posix_fallocate(int fd, off_t offset, off_t len)\n{\n    int ret = posix_fallocate(fd, offset, len);\n    if (ret == 0)\n        return 0;\n    errno = ret;\n    return -1;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "posix_fallocate",
          "args": [
            "fd",
            "offset",
            "len"
          ],
          "line": 1117
        },
        "resolved": true,
        "details": {
          "function_name": "safezero_posix_fallocate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1124-1130",
          "snippet": "static int\nsafezero_posix_fallocate(int fd G_GNUC_UNUSED,\n                         off_t offset G_GNUC_UNUSED,\n                         off_t len G_GNUC_UNUSED)\n{\n    return -2;\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nsafezero_posix_fallocate(int fd, off_t offset, off_t len)\n{\n    int ret = posix_fallocate(fd, offset, len);\n    if (ret == 0)\n        return 0;\n    errno = ret;\n    return -1;\n}"
  },
  {
    "function_name": "safewrite",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "1093-1111",
    "snippet": "ssize_t\nsafewrite(int fd, const void *buf, size_t count)\n{\n    size_t nwritten = 0;\n    while (count > 0) {\n        ssize_t r = write(fd, buf, count);\n\n        if (r < 0 && errno == EINTR)\n            continue;\n        if (r < 0)\n            return r;\n        if (r == 0)\n            return nwritten;\n        buf = (const char *)buf + r;\n        count -= r;\n        nwritten += r;\n    }\n    return nwritten;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "write",
          "args": [
            "fd",
            "buf",
            "count"
          ],
          "line": 1098
        },
        "resolved": true,
        "details": {
          "function_name": "safewrite",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1093-1111",
          "snippet": "ssize_t\nsafewrite(int fd, const void *buf, size_t count)\n{\n    size_t nwritten = 0;\n    while (count > 0) {\n        ssize_t r = write(fd, buf, count);\n\n        if (r < 0 && errno == EINTR)\n            continue;\n        if (r < 0)\n            return r;\n        if (r == 0)\n            return nwritten;\n        buf = (const char *)buf + r;\n        count -= r;\n        nwritten += r;\n    }\n    return nwritten;\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nssize_t\nsafewrite(int fd, const void *buf, size_t count)\n{\n    size_t nwritten = 0;\n    while (count > 0) {\n        ssize_t r = write(fd, buf, count);\n\n        if (r < 0 && errno == EINTR)\n            continue;\n        if (r < 0)\n            return r;\n        if (r == 0)\n            return nwritten;\n        buf = (const char *)buf + r;\n        count -= r;\n        nwritten += r;\n    }\n    return nwritten;\n}"
  },
  {
    "function_name": "saferead",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "1069-1086",
    "snippet": "ssize_t\nsaferead(int fd, void *buf, size_t count)\n{\n    size_t nread = 0;\n    while (count > 0) {\n        ssize_t r = read(fd, buf, count);\n        if (r < 0 && errno == EINTR)\n            continue;\n        if (r < 0)\n            return r;\n        if (r == 0)\n            return nread;\n        buf = (char *)buf + r;\n        count -= r;\n        nread += r;\n    }\n    return nread;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "read",
          "args": [
            "fd",
            "buf",
            "count"
          ],
          "line": 1074
        },
        "resolved": true,
        "details": {
          "function_name": "saferead_lim",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1330-1372",
          "snippet": "static char *\nsaferead_lim(int fd, size_t max_len, size_t *length)\n{\n    char *buf = NULL;\n    size_t alloc = 0;\n    size_t size = 0;\n    int save_errno;\n\n    for (;;) {\n        int count;\n        int requested;\n\n        if (size + BUFSIZ + 1 > alloc) {\n            alloc += alloc / 2;\n            if (alloc < size + BUFSIZ + 1)\n                alloc = size + BUFSIZ + 1;\n\n            if (VIR_REALLOC_N(buf, alloc) < 0) {\n                save_errno = errno;\n                break;\n            }\n        }\n\n        /* Ensure that (size + requested <= max_len); */\n        requested = MIN(size < max_len ? max_len - size : 0,\n                        alloc - size - 1);\n        count = saferead(fd, buf + size, requested);\n        size += count;\n\n        if (count != requested || requested == 0) {\n            save_errno = errno;\n            if (count < 0)\n                break;\n            buf[size] = '\\0';\n            *length = size;\n            return buf;\n        }\n    }\n\n    VIR_FREE(buf);\n    errno = save_errno;\n    return NULL;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic char *\nsaferead_lim(int fd, size_t max_len, size_t *length)\n{\n    char *buf = NULL;\n    size_t alloc = 0;\n    size_t size = 0;\n    int save_errno;\n\n    for (;;) {\n        int count;\n        int requested;\n\n        if (size + BUFSIZ + 1 > alloc) {\n            alloc += alloc / 2;\n            if (alloc < size + BUFSIZ + 1)\n                alloc = size + BUFSIZ + 1;\n\n            if (VIR_REALLOC_N(buf, alloc) < 0) {\n                save_errno = errno;\n                break;\n            }\n        }\n\n        /* Ensure that (size + requested <= max_len); */\n        requested = MIN(size < max_len ? max_len - size : 0,\n                        alloc - size - 1);\n        count = saferead(fd, buf + size, requested);\n        size += count;\n\n        if (count != requested || requested == 0) {\n            save_errno = errno;\n            if (count < 0)\n                break;\n            buf[size] = '\\0';\n            *length = size;\n            return buf;\n        }\n    }\n\n    VIR_FREE(buf);\n    errno = save_errno;\n    return NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nssize_t\nsaferead(int fd, void *buf, size_t count)\n{\n    size_t nread = 0;\n    while (count > 0) {\n        ssize_t r = read(fd, buf, count);\n        if (r < 0 && errno == EINTR)\n            continue;\n        if (r < 0)\n            return r;\n        if (r == 0)\n            return nread;\n        buf = (char *)buf + r;\n        count -= r;\n        nread += r;\n    }\n    return nread;\n}"
  },
  {
    "function_name": "virFileDeleteTree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "1009-1062",
    "snippet": "int virFileDeleteTree(const char *dir)\n{\n    DIR *dh;\n    struct dirent *de;\n    int ret = -1;\n    int direrr;\n\n    /* Silently return 0 if passed NULL or directory doesn't exist */\n    if (!dir || !virFileExists(dir))\n        return 0;\n\n    if (virDirOpen(&dh, dir) < 0)\n        return -1;\n\n    while ((direrr = virDirRead(dh, &de, dir)) > 0) {\n        g_autofree char *filepath = NULL;\n        GStatBuf sb;\n\n        filepath = g_strdup_printf(\"%s/%s\", dir, de->d_name);\n\n        if (g_lstat(filepath, &sb) < 0) {\n            virReportSystemError(errno, _(\"Cannot access '%s'\"),\n                                 filepath);\n            goto cleanup;\n        }\n\n        if (S_ISDIR(sb.st_mode)) {\n            if (virFileDeleteTree(filepath) < 0)\n                goto cleanup;\n        } else {\n            if (unlink(filepath) < 0 && errno != ENOENT) {\n                virReportSystemError(errno,\n                                     _(\"Cannot delete file '%s'\"),\n                                     filepath);\n                goto cleanup;\n            }\n        }\n    }\n    if (direrr < 0)\n        goto cleanup;\n\n    if (rmdir(dir) < 0 && errno != ENOENT) {\n        virReportSystemError(errno,\n                             _(\"Cannot delete directory '%s'\"),\n                             dir);\n        goto cleanup;\n    }\n\n    ret = 0;\n\n cleanup:\n    VIR_DIR_CLOSE(dh);\n    return ret;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_DIR_CLOSE",
          "args": [
            "dh"
          ],
          "line": 1060
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"Cannot delete directory '%s'\")",
            "dir"
          ],
          "line": 1051
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Cannot delete directory '%s'\""
          ],
          "line": 1052
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "rmdir",
          "args": [
            "dir"
          ],
          "line": 1050
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"Cannot delete file '%s'\")",
            "filepath"
          ],
          "line": 1040
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlink",
          "args": [
            "filepath"
          ],
          "line": 1039
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virFileDeleteTree",
          "args": [
            "filepath"
          ],
          "line": 1036
        },
        "resolved": true,
        "details": {
          "function_name": "virFileDeleteTree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1009-1062",
          "snippet": "int virFileDeleteTree(const char *dir)\n{\n    DIR *dh;\n    struct dirent *de;\n    int ret = -1;\n    int direrr;\n\n    /* Silently return 0 if passed NULL or directory doesn't exist */\n    if (!dir || !virFileExists(dir))\n        return 0;\n\n    if (virDirOpen(&dh, dir) < 0)\n        return -1;\n\n    while ((direrr = virDirRead(dh, &de, dir)) > 0) {\n        g_autofree char *filepath = NULL;\n        GStatBuf sb;\n\n        filepath = g_strdup_printf(\"%s/%s\", dir, de->d_name);\n\n        if (g_lstat(filepath, &sb) < 0) {\n            virReportSystemError(errno, _(\"Cannot access '%s'\"),\n                                 filepath);\n            goto cleanup;\n        }\n\n        if (S_ISDIR(sb.st_mode)) {\n            if (virFileDeleteTree(filepath) < 0)\n                goto cleanup;\n        } else {\n            if (unlink(filepath) < 0 && errno != ENOENT) {\n                virReportSystemError(errno,\n                                     _(\"Cannot delete file '%s'\"),\n                                     filepath);\n                goto cleanup;\n            }\n        }\n    }\n    if (direrr < 0)\n        goto cleanup;\n\n    if (rmdir(dir) < 0 && errno != ENOENT) {\n        virReportSystemError(errno,\n                             _(\"Cannot delete directory '%s'\"),\n                             dir);\n        goto cleanup;\n    }\n\n    ret = 0;\n\n cleanup:\n    VIR_DIR_CLOSE(dh);\n    return ret;\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "S_ISDIR",
          "args": [
            "sb.st_mode"
          ],
          "line": 1035
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"Cannot access '%s'\")",
            "filepath"
          ],
          "line": 1030
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_lstat",
          "args": [
            "filepath",
            "&sb"
          ],
          "line": 1029
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDirRead",
          "args": [
            "dh",
            "&de",
            "dir"
          ],
          "line": 1023
        },
        "resolved": true,
        "details": {
          "function_name": "virDirRead",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "2940-2954",
          "snippet": "int virDirRead(DIR *dirp, struct dirent **ent, const char *name)\n{\n    do {\n        errno = 0;\n        *ent = readdir(dirp); /* exempt from syntax-check */\n        if (!*ent && errno) {\n            if (name)\n                virReportSystemError(errno, _(\"Unable to read directory '%s'\"),\n                                     name);\n            return -1;\n        }\n    } while (*ent && (STREQ((*ent)->d_name, \".\") ||\n                      STREQ((*ent)->d_name, \"..\")));\n    return !!*ent;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint virDirRead(DIR *dirp, struct dirent **ent, const char *name)\n{\n    do {\n        errno = 0;\n        *ent = readdir(dirp); /* exempt from syntax-check */\n        if (!*ent && errno) {\n            if (name)\n                virReportSystemError(errno, _(\"Unable to read directory '%s'\"),\n                                     name);\n            return -1;\n        }\n    } while (*ent && (STREQ((*ent)->d_name, \".\") ||\n                      STREQ((*ent)->d_name, \"..\")));\n    return !!*ent;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDirOpen",
          "args": [
            "&dh",
            "dir"
          ],
          "line": 1020
        },
        "resolved": true,
        "details": {
          "function_name": "virDirOpenQuiet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "2914-2918",
          "snippet": "int\nvirDirOpenQuiet(DIR **dirp, const char *name)\n{\n    return virDirOpenInternal(dirp, name, false, true);\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirDirOpenQuiet(DIR **dirp, const char *name)\n{\n    return virDirOpenInternal(dirp, name, false, true);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virFileExists",
          "args": [
            "dir"
          ],
          "line": 1017
        },
        "resolved": true,
        "details": {
          "function_name": "virFileExists",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1873-1877",
          "snippet": "bool\nvirFileExists(const char *path)\n{\n    return access(path, F_OK) == 0;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nbool\nvirFileExists(const char *path)\n{\n    return access(path, F_OK) == 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint virFileDeleteTree(const char *dir)\n{\n    DIR *dh;\n    struct dirent *de;\n    int ret = -1;\n    int direrr;\n\n    /* Silently return 0 if passed NULL or directory doesn't exist */\n    if (!dir || !virFileExists(dir))\n        return 0;\n\n    if (virDirOpen(&dh, dir) < 0)\n        return -1;\n\n    while ((direrr = virDirRead(dh, &de, dir)) > 0) {\n        g_autofree char *filepath = NULL;\n        GStatBuf sb;\n\n        filepath = g_strdup_printf(\"%s/%s\", dir, de->d_name);\n\n        if (g_lstat(filepath, &sb) < 0) {\n            virReportSystemError(errno, _(\"Cannot access '%s'\"),\n                                 filepath);\n            goto cleanup;\n        }\n\n        if (S_ISDIR(sb.st_mode)) {\n            if (virFileDeleteTree(filepath) < 0)\n                goto cleanup;\n        } else {\n            if (unlink(filepath) < 0 && errno != ENOENT) {\n                virReportSystemError(errno,\n                                     _(\"Cannot delete file '%s'\"),\n                                     filepath);\n                goto cleanup;\n            }\n        }\n    }\n    if (direrr < 0)\n        goto cleanup;\n\n    if (rmdir(dir) < 0 && errno != ENOENT) {\n        virReportSystemError(errno,\n                             _(\"Cannot delete directory '%s'\"),\n                             dir);\n        goto cleanup;\n    }\n\n    ret = 0;\n\n cleanup:\n    VIR_DIR_CLOSE(dh);\n    return ret;\n}"
  },
  {
    "function_name": "virFileNBDDeviceAssociate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "983-992",
    "snippet": "int virFileNBDDeviceAssociate(const char *file,\n                              virStorageFileFormat fmt G_GNUC_UNUSED,\n                              bool readonly G_GNUC_UNUSED,\n                              char **dev G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS,\n                         _(\"Unable to associate file %s with NBD device\"),\n                         file);\n    return -1;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "_(\"Unable to associate file %s with NBD device\")",
            "file"
          ],
          "line": 988
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to associate file %s with NBD device\""
          ],
          "line": 989
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint virFileNBDDeviceAssociate(const char *file,\n                              virStorageFileFormat fmt G_GNUC_UNUSED,\n                              bool readonly G_GNUC_UNUSED,\n                              char **dev G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS,\n                         _(\"Unable to associate file %s with NBD device\"),\n                         file);\n    return -1;\n}"
  },
  {
    "function_name": "virFileLoopDeviceAssociate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "973-981",
    "snippet": "int virFileLoopDeviceAssociate(const char *file,\n                               char **dev G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS,\n                         _(\"Unable to associate file %s with loop device\"),\n                         file);\n    *dev = NULL;\n    return -1;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "_(\"Unable to associate file %s with loop device\")",
            "file"
          ],
          "line": 976
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to associate file %s with loop device\""
          ],
          "line": 977
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint virFileLoopDeviceAssociate(const char *file,\n                               char **dev G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS,\n                         _(\"Unable to associate file %s with loop device\"),\n                         file);\n    *dev = NULL;\n    return -1;\n}"
  },
  {
    "function_name": "virFileNBDDeviceAssociate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "917-969",
    "snippet": "int virFileNBDDeviceAssociate(const char *file,\n                              virStorageFileFormat fmt,\n                              bool readonly,\n                              char **dev)\n{\n    g_autofree char *nbddev = NULL;\n    g_autofree char *qemunbd = NULL;\n    g_autoptr(virCommand) cmd = NULL;\n    const char *fmtstr = NULL;\n\n    if (!virFileNBDLoadDriver())\n        return -1;\n\n    if (!(nbddev = virFileNBDDeviceFindUnused()))\n        return -1;\n\n    if (!(qemunbd = virFindFileInPath(\"qemu-nbd\"))) {\n        virReportSystemError(ENOENT, \"%s\",\n                             _(\"Unable to find 'qemu-nbd' binary in $PATH\"));\n        return -1;\n    }\n\n    if (fmt > 0)\n        fmtstr = virStorageFileFormatTypeToString(fmt);\n\n    cmd = virCommandNew(qemunbd);\n\n    /* Explicitly not trying to cope with old qemu-nbd which\n     * lacked --format. We want to see a fatal error in that\n     * case since it would be security flaw to continue */\n    if (fmtstr)\n        virCommandAddArgList(cmd, \"--format\", fmtstr, NULL);\n\n    if (readonly)\n        virCommandAddArg(cmd, \"-r\");\n\n    virCommandAddArgList(cmd,\n                         \"-n\", /* Don't cache in qemu-nbd layer */\n                         \"-c\", nbddev,\n                         file, NULL);\n\n    /* qemu-nbd will daemonize itself */\n\n    if (virCommandRun(cmd, NULL) < 0)\n        return -1;\n\n    VIR_DEBUG(\"Associated NBD device %s with file %s and format %s\",\n              nbddev, file, fmtstr);\n    *dev = nbddev;\n    nbddev = NULL;\n\n    return 0;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Associated NBD device %s with file %s and format %s\"",
            "nbddev",
            "file",
            "fmtstr"
          ],
          "line": 963
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCommandRun",
          "args": [
            "cmd",
            "NULL"
          ],
          "line": 960
        },
        "resolved": true,
        "details": {
          "function_name": "virCommandRunAsync",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "2931-2937",
          "snippet": "int\nvirCommandRunAsync(virCommandPtr cmd G_GNUC_UNUSED, pid_t *pid G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Executing new processes is not supported on Win32 platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nint\nvirCommandRunAsync(virCommandPtr cmd G_GNUC_UNUSED, pid_t *pid G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Executing new processes is not supported on Win32 platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCommandAddArgList",
          "args": [
            "cmd",
            "\"-n\"",
            "/* Don't cache in qemu-nbd layer */\"-c\"",
            "nbddev",
            "file",
            "NULL"
          ],
          "line": 953
        },
        "resolved": true,
        "details": {
          "function_name": "virCommandAddArgList",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "1655-1684",
          "snippet": "void\nvirCommandAddArgList(virCommandPtr cmd, ...)\n{\n    va_list list;\n    int narg = 0;\n\n    if (!cmd || cmd->has_error)\n        return;\n\n    va_start(list, cmd);\n    while (va_arg(list, const char *) != NULL)\n        narg++;\n    va_end(list);\n\n    /* narg plus trailing NULL. */\n    if (VIR_RESIZE_N(cmd->args, cmd->maxargs, cmd->nargs, narg + 1) < 0) {\n        cmd->has_error = ENOMEM;\n        return;\n    }\n\n    va_start(list, cmd);\n    while (1) {\n        char *arg = va_arg(list, char *);\n        if (!arg)\n            break;\n        arg = g_strdup(arg);\n        cmd->args[cmd->nargs++] = arg;\n    }\n    va_end(list);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nvoid\nvirCommandAddArgList(virCommandPtr cmd, ...)\n{\n    va_list list;\n    int narg = 0;\n\n    if (!cmd || cmd->has_error)\n        return;\n\n    va_start(list, cmd);\n    while (va_arg(list, const char *) != NULL)\n        narg++;\n    va_end(list);\n\n    /* narg plus trailing NULL. */\n    if (VIR_RESIZE_N(cmd->args, cmd->maxargs, cmd->nargs, narg + 1) < 0) {\n        cmd->has_error = ENOMEM;\n        return;\n    }\n\n    va_start(list, cmd);\n    while (1) {\n        char *arg = va_arg(list, char *);\n        if (!arg)\n            break;\n        arg = g_strdup(arg);\n        cmd->args[cmd->nargs++] = arg;\n    }\n    va_end(list);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCommandNew",
          "args": [
            "qemunbd"
          ],
          "line": 942
        },
        "resolved": true,
        "details": {
          "function_name": "virCommandNewArgList",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "969-980",
          "snippet": "virCommandPtr\nvirCommandNewArgList(const char *binary, ...)\n{\n    virCommandPtr cmd;\n    va_list list;\n\n    va_start(list, binary);\n    cmd = virCommandNewVAList(binary, list);\n    va_end(list);\n\n    return cmd;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nvirCommandPtr\nvirCommandNewArgList(const char *binary, ...)\n{\n    virCommandPtr cmd;\n    va_list list;\n\n    va_start(list, binary);\n    cmd = virCommandNewVAList(binary, list);\n    va_end(list);\n\n    return cmd;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStorageFileFormatTypeToString",
          "args": [
            "fmt"
          ],
          "line": 940
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOENT",
            "\"%s\"",
            "_(\"Unable to find 'qemu-nbd' binary in $PATH\")"
          ],
          "line": 934
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to find 'qemu-nbd' binary in $PATH\""
          ],
          "line": 935
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virFindFileInPath",
          "args": [
            "\"qemu-nbd\""
          ],
          "line": 933
        },
        "resolved": true,
        "details": {
          "function_name": "virFindFileInPath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1657-1709",
          "snippet": "char *\nvirFindFileInPath(const char *file)\n{\n    const char *origpath = NULL;\n    VIR_AUTOSTRINGLIST paths = NULL;\n    char **pathiter;\n\n    if (file == NULL)\n        return NULL;\n\n    /* if we are passed an absolute path (starting with /), return a\n     * copy of that path, after validating that it is executable\n     */\n    if (g_path_is_absolute(file)) {\n        if (!virFileIsExecutable(file))\n            return NULL;\n\n        return g_strdup(file);\n    }\n\n    /* If we are passed an anchored path (containing a /), then there\n     * is no path search - it must exist in the current directory\n     */\n    if (strchr(file, '/')) {\n        char *abspath = NULL;\n\n        if (!virFileIsExecutable(file))\n            return NULL;\n\n        ignore_value(virFileAbsPath(file, &abspath));\n        return abspath;\n    }\n\n    /* copy PATH env so we can tweak it */\n    origpath = getenv(\"PATH\");\n    if (!origpath)\n        origpath = \"/bin:/usr/bin\";\n\n    /* for each path segment, append the file to search for and test for\n     * it. return it if found.\n     */\n\n    if (!(paths = virStringSplit(origpath, \":\", 0)))\n        return NULL;\n\n    for (pathiter = paths; *pathiter; pathiter++) {\n        g_autofree char *fullpath = g_strdup_printf(\"%s/%s\", *pathiter, file);\n        if (virFileIsExecutable(fullpath))\n            return g_steal_pointer(&fullpath);\n    }\n\n    return NULL;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nchar *\nvirFindFileInPath(const char *file)\n{\n    const char *origpath = NULL;\n    VIR_AUTOSTRINGLIST paths = NULL;\n    char **pathiter;\n\n    if (file == NULL)\n        return NULL;\n\n    /* if we are passed an absolute path (starting with /), return a\n     * copy of that path, after validating that it is executable\n     */\n    if (g_path_is_absolute(file)) {\n        if (!virFileIsExecutable(file))\n            return NULL;\n\n        return g_strdup(file);\n    }\n\n    /* If we are passed an anchored path (containing a /), then there\n     * is no path search - it must exist in the current directory\n     */\n    if (strchr(file, '/')) {\n        char *abspath = NULL;\n\n        if (!virFileIsExecutable(file))\n            return NULL;\n\n        ignore_value(virFileAbsPath(file, &abspath));\n        return abspath;\n    }\n\n    /* copy PATH env so we can tweak it */\n    origpath = getenv(\"PATH\");\n    if (!origpath)\n        origpath = \"/bin:/usr/bin\";\n\n    /* for each path segment, append the file to search for and test for\n     * it. return it if found.\n     */\n\n    if (!(paths = virStringSplit(origpath, \":\", 0)))\n        return NULL;\n\n    for (pathiter = paths; *pathiter; pathiter++) {\n        g_autofree char *fullpath = g_strdup_printf(\"%s/%s\", *pathiter, file);\n        if (virFileIsExecutable(fullpath))\n            return g_steal_pointer(&fullpath);\n    }\n\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virFileNBDDeviceFindUnused",
          "args": [],
          "line": 930
        },
        "resolved": true,
        "details": {
          "function_name": "virFileNBDDeviceFindUnused",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "865-895",
          "snippet": "static char *\nvirFileNBDDeviceFindUnused(void)\n{\n    DIR *dh;\n    char *ret = NULL;\n    struct dirent *de;\n    int direrr;\n\n    if (virDirOpen(&dh, SYSFS_BLOCK_DIR) < 0)\n        return NULL;\n\n    while ((direrr = virDirRead(dh, &de, SYSFS_BLOCK_DIR)) > 0) {\n        if (STRPREFIX(de->d_name, \"nbd\")) {\n            int rv = virFileNBDDeviceIsBusy(de->d_name);\n            if (rv < 0)\n                goto cleanup;\n            if (rv == 0) {\n                ret = g_strdup_printf(\"/dev/%s\", de->d_name);\n                goto cleanup;\n            }\n        }\n    }\n    if (direrr < 0)\n        goto cleanup;\n    virReportSystemError(EBUSY, \"%s\",\n                         _(\"No free NBD devices\"));\n\n cleanup:\n    VIR_DIR_CLOSE(dh);\n    return ret;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic char *\nvirFileNBDDeviceFindUnused(void)\n{\n    DIR *dh;\n    char *ret = NULL;\n    struct dirent *de;\n    int direrr;\n\n    if (virDirOpen(&dh, SYSFS_BLOCK_DIR) < 0)\n        return NULL;\n\n    while ((direrr = virDirRead(dh, &de, SYSFS_BLOCK_DIR)) > 0) {\n        if (STRPREFIX(de->d_name, \"nbd\")) {\n            int rv = virFileNBDDeviceIsBusy(de->d_name);\n            if (rv < 0)\n                goto cleanup;\n            if (rv == 0) {\n                ret = g_strdup_printf(\"/dev/%s\", de->d_name);\n                goto cleanup;\n            }\n        }\n    }\n    if (direrr < 0)\n        goto cleanup;\n    virReportSystemError(EBUSY, \"%s\",\n                         _(\"No free NBD devices\"));\n\n cleanup:\n    VIR_DIR_CLOSE(dh);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virFileNBDLoadDriver",
          "args": [],
          "line": 927
        },
        "resolved": true,
        "details": {
          "function_name": "virFileNBDLoadDriver",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "897-915",
          "snippet": "static bool\nvirFileNBDLoadDriver(void)\n{\n    if (virKModIsBlacklisted(NBD_DRIVER)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Failed to load nbd module: \"\n                         \"administratively prohibited\"));\n        return false;\n    } else {\n        g_autofree char *errbuf = NULL;\n\n        if ((errbuf = virKModLoad(NBD_DRIVER, true))) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"Failed to load nbd module\"));\n            return false;\n        }\n    }\n    return true;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic bool\nvirFileNBDLoadDriver(void)\n{\n    if (virKModIsBlacklisted(NBD_DRIVER)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Failed to load nbd module: \"\n                         \"administratively prohibited\"));\n        return false;\n    } else {\n        g_autofree char *errbuf = NULL;\n\n        if ((errbuf = virKModLoad(NBD_DRIVER, true))) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"Failed to load nbd module\"));\n            return false;\n        }\n    }\n    return true;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint virFileNBDDeviceAssociate(const char *file,\n                              virStorageFileFormat fmt,\n                              bool readonly,\n                              char **dev)\n{\n    g_autofree char *nbddev = NULL;\n    g_autofree char *qemunbd = NULL;\n    g_autoptr(virCommand) cmd = NULL;\n    const char *fmtstr = NULL;\n\n    if (!virFileNBDLoadDriver())\n        return -1;\n\n    if (!(nbddev = virFileNBDDeviceFindUnused()))\n        return -1;\n\n    if (!(qemunbd = virFindFileInPath(\"qemu-nbd\"))) {\n        virReportSystemError(ENOENT, \"%s\",\n                             _(\"Unable to find 'qemu-nbd' binary in $PATH\"));\n        return -1;\n    }\n\n    if (fmt > 0)\n        fmtstr = virStorageFileFormatTypeToString(fmt);\n\n    cmd = virCommandNew(qemunbd);\n\n    /* Explicitly not trying to cope with old qemu-nbd which\n     * lacked --format. We want to see a fatal error in that\n     * case since it would be security flaw to continue */\n    if (fmtstr)\n        virCommandAddArgList(cmd, \"--format\", fmtstr, NULL);\n\n    if (readonly)\n        virCommandAddArg(cmd, \"-r\");\n\n    virCommandAddArgList(cmd,\n                         \"-n\", /* Don't cache in qemu-nbd layer */\n                         \"-c\", nbddev,\n                         file, NULL);\n\n    /* qemu-nbd will daemonize itself */\n\n    if (virCommandRun(cmd, NULL) < 0)\n        return -1;\n\n    VIR_DEBUG(\"Associated NBD device %s with file %s and format %s\",\n              nbddev, file, fmtstr);\n    *dev = nbddev;\n    nbddev = NULL;\n\n    return 0;\n}"
  },
  {
    "function_name": "virFileNBDLoadDriver",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "897-915",
    "snippet": "static bool\nvirFileNBDLoadDriver(void)\n{\n    if (virKModIsBlacklisted(NBD_DRIVER)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Failed to load nbd module: \"\n                         \"administratively prohibited\"));\n        return false;\n    } else {\n        g_autofree char *errbuf = NULL;\n\n        if ((errbuf = virKModLoad(NBD_DRIVER, true))) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"Failed to load nbd module\"));\n            return false;\n        }\n    }\n    return true;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"Failed to load nbd module\")"
          ],
          "line": 909
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Failed to load nbd module\""
          ],
          "line": 910
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virKModLoad",
          "args": [
            "NBD_DRIVER",
            "true"
          ],
          "line": 908
        },
        "resolved": true,
        "details": {
          "function_name": "virKModLoad",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virkmod.c",
          "lines": "94-104",
          "snippet": "char *\nvirKModLoad(const char *module, bool useBlacklist)\n{\n    char *errbuf = NULL;\n\n    if (doModprobe(useBlacklist ? \"-b\" : NULL, module, NULL, &errbuf) < 0)\n        return errbuf;\n\n    VIR_FREE(errbuf);\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"vircommand.h\"",
            "#include \"virkmod.h\"",
            "#include \"viralloc.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"vircommand.h\"\n#include \"virkmod.h\"\n#include \"viralloc.h\"\n#include <config.h>\n\nchar *\nvirKModLoad(const char *module, bool useBlacklist)\n{\n    char *errbuf = NULL;\n\n    if (doModprobe(useBlacklist ? \"-b\" : NULL, module, NULL, &errbuf) < 0)\n        return errbuf;\n\n    VIR_FREE(errbuf);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"Failed to load nbd module: \"\n                         \"administratively prohibited\")"
          ],
          "line": 901
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virKModIsBlacklisted",
          "args": [
            "NBD_DRIVER"
          ],
          "line": 900
        },
        "resolved": true,
        "details": {
          "function_name": "virKModIsBlacklisted",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virkmod.c",
          "lines": "145-166",
          "snippet": "bool\nvirKModIsBlacklisted(const char *module)\n{\n    size_t i;\n    g_autofree char *drvblklst = NULL;\n    g_autofree char *outbuf = NULL;\n\n    drvblklst = g_strdup_printf(\"blacklist %s\\n\", module);\n\n    /* modprobe will convert all '-' into '_', so we need to as well */\n    for (i = 0; i < drvblklst[i]; i++)\n        if (drvblklst[i] == '-')\n            drvblklst[i] = '_';\n\n    if (doModprobe(\"-c\", NULL, &outbuf, NULL) < 0)\n        return false;\n\n    if (strstr(outbuf, drvblklst))\n        return true;\n\n    return false;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"vircommand.h\"",
            "#include \"virkmod.h\"",
            "#include \"viralloc.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"vircommand.h\"\n#include \"virkmod.h\"\n#include \"viralloc.h\"\n#include <config.h>\n\nbool\nvirKModIsBlacklisted(const char *module)\n{\n    size_t i;\n    g_autofree char *drvblklst = NULL;\n    g_autofree char *outbuf = NULL;\n\n    drvblklst = g_strdup_printf(\"blacklist %s\\n\", module);\n\n    /* modprobe will convert all '-' into '_', so we need to as well */\n    for (i = 0; i < drvblklst[i]; i++)\n        if (drvblklst[i] == '-')\n            drvblklst[i] = '_';\n\n    if (doModprobe(\"-c\", NULL, &outbuf, NULL) < 0)\n        return false;\n\n    if (strstr(outbuf, drvblklst))\n        return true;\n\n    return false;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic bool\nvirFileNBDLoadDriver(void)\n{\n    if (virKModIsBlacklisted(NBD_DRIVER)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Failed to load nbd module: \"\n                         \"administratively prohibited\"));\n        return false;\n    } else {\n        g_autofree char *errbuf = NULL;\n\n        if ((errbuf = virKModLoad(NBD_DRIVER, true))) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"Failed to load nbd module\"));\n            return false;\n        }\n    }\n    return true;\n}"
  },
  {
    "function_name": "virFileNBDDeviceFindUnused",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "865-895",
    "snippet": "static char *\nvirFileNBDDeviceFindUnused(void)\n{\n    DIR *dh;\n    char *ret = NULL;\n    struct dirent *de;\n    int direrr;\n\n    if (virDirOpen(&dh, SYSFS_BLOCK_DIR) < 0)\n        return NULL;\n\n    while ((direrr = virDirRead(dh, &de, SYSFS_BLOCK_DIR)) > 0) {\n        if (STRPREFIX(de->d_name, \"nbd\")) {\n            int rv = virFileNBDDeviceIsBusy(de->d_name);\n            if (rv < 0)\n                goto cleanup;\n            if (rv == 0) {\n                ret = g_strdup_printf(\"/dev/%s\", de->d_name);\n                goto cleanup;\n            }\n        }\n    }\n    if (direrr < 0)\n        goto cleanup;\n    virReportSystemError(EBUSY, \"%s\",\n                         _(\"No free NBD devices\"));\n\n cleanup:\n    VIR_DIR_CLOSE(dh);\n    return ret;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_DIR_CLOSE",
          "args": [
            "dh"
          ],
          "line": 893
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "EBUSY",
            "\"%s\"",
            "_(\"No free NBD devices\")"
          ],
          "line": 889
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"No free NBD devices\""
          ],
          "line": 890
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virFileNBDDeviceIsBusy",
          "args": [
            "de->d_name"
          ],
          "line": 878
        },
        "resolved": true,
        "details": {
          "function_name": "virFileNBDDeviceIsBusy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "845-862",
          "snippet": "static int\nvirFileNBDDeviceIsBusy(const char *dev_name)\n{\n    g_autofree char *path = NULL;\n\n    path = g_strdup_printf(SYSFS_BLOCK_DIR \"/%s/pid\", dev_name);\n\n    if (!virFileExists(path)) {\n        if (errno == ENOENT)\n            return 0;\n        else\n            virReportSystemError(errno,\n                                 _(\"Cannot check NBD device %s pid\"),\n                                 dev_name);\n        return -1;\n    }\n    return 1;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nvirFileNBDDeviceIsBusy(const char *dev_name)\n{\n    g_autofree char *path = NULL;\n\n    path = g_strdup_printf(SYSFS_BLOCK_DIR \"/%s/pid\", dev_name);\n\n    if (!virFileExists(path)) {\n        if (errno == ENOENT)\n            return 0;\n        else\n            virReportSystemError(errno,\n                                 _(\"Cannot check NBD device %s pid\"),\n                                 dev_name);\n        return -1;\n    }\n    return 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "STRPREFIX",
          "args": [
            "de->d_name",
            "\"nbd\""
          ],
          "line": 877
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDirRead",
          "args": [
            "dh",
            "&de",
            "SYSFS_BLOCK_DIR"
          ],
          "line": 876
        },
        "resolved": true,
        "details": {
          "function_name": "virDirRead",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "2940-2954",
          "snippet": "int virDirRead(DIR *dirp, struct dirent **ent, const char *name)\n{\n    do {\n        errno = 0;\n        *ent = readdir(dirp); /* exempt from syntax-check */\n        if (!*ent && errno) {\n            if (name)\n                virReportSystemError(errno, _(\"Unable to read directory '%s'\"),\n                                     name);\n            return -1;\n        }\n    } while (*ent && (STREQ((*ent)->d_name, \".\") ||\n                      STREQ((*ent)->d_name, \"..\")));\n    return !!*ent;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint virDirRead(DIR *dirp, struct dirent **ent, const char *name)\n{\n    do {\n        errno = 0;\n        *ent = readdir(dirp); /* exempt from syntax-check */\n        if (!*ent && errno) {\n            if (name)\n                virReportSystemError(errno, _(\"Unable to read directory '%s'\"),\n                                     name);\n            return -1;\n        }\n    } while (*ent && (STREQ((*ent)->d_name, \".\") ||\n                      STREQ((*ent)->d_name, \"..\")));\n    return !!*ent;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDirOpen",
          "args": [
            "&dh",
            "SYSFS_BLOCK_DIR"
          ],
          "line": 873
        },
        "resolved": true,
        "details": {
          "function_name": "virDirOpenQuiet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "2914-2918",
          "snippet": "int\nvirDirOpenQuiet(DIR **dirp, const char *name)\n{\n    return virDirOpenInternal(dirp, name, false, true);\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirDirOpenQuiet(DIR **dirp, const char *name)\n{\n    return virDirOpenInternal(dirp, name, false, true);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic char *\nvirFileNBDDeviceFindUnused(void)\n{\n    DIR *dh;\n    char *ret = NULL;\n    struct dirent *de;\n    int direrr;\n\n    if (virDirOpen(&dh, SYSFS_BLOCK_DIR) < 0)\n        return NULL;\n\n    while ((direrr = virDirRead(dh, &de, SYSFS_BLOCK_DIR)) > 0) {\n        if (STRPREFIX(de->d_name, \"nbd\")) {\n            int rv = virFileNBDDeviceIsBusy(de->d_name);\n            if (rv < 0)\n                goto cleanup;\n            if (rv == 0) {\n                ret = g_strdup_printf(\"/dev/%s\", de->d_name);\n                goto cleanup;\n            }\n        }\n    }\n    if (direrr < 0)\n        goto cleanup;\n    virReportSystemError(EBUSY, \"%s\",\n                         _(\"No free NBD devices\"));\n\n cleanup:\n    VIR_DIR_CLOSE(dh);\n    return ret;\n}"
  },
  {
    "function_name": "virFileNBDDeviceIsBusy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "845-862",
    "snippet": "static int\nvirFileNBDDeviceIsBusy(const char *dev_name)\n{\n    g_autofree char *path = NULL;\n\n    path = g_strdup_printf(SYSFS_BLOCK_DIR \"/%s/pid\", dev_name);\n\n    if (!virFileExists(path)) {\n        if (errno == ENOENT)\n            return 0;\n        else\n            virReportSystemError(errno,\n                                 _(\"Cannot check NBD device %s pid\"),\n                                 dev_name);\n        return -1;\n    }\n    return 1;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"Cannot check NBD device %s pid\")",
            "dev_name"
          ],
          "line": 856
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Cannot check NBD device %s pid\""
          ],
          "line": 857
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virFileExists",
          "args": [
            "path"
          ],
          "line": 852
        },
        "resolved": true,
        "details": {
          "function_name": "virFileExists",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1873-1877",
          "snippet": "bool\nvirFileExists(const char *path)\n{\n    return access(path, F_OK) == 0;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nbool\nvirFileExists(const char *path)\n{\n    return access(path, F_OK) == 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nvirFileNBDDeviceIsBusy(const char *dev_name)\n{\n    g_autofree char *path = NULL;\n\n    path = g_strdup_printf(SYSFS_BLOCK_DIR \"/%s/pid\", dev_name);\n\n    if (!virFileExists(path)) {\n        if (errno == ENOENT)\n            return 0;\n        else\n            virReportSystemError(errno,\n                                 _(\"Cannot check NBD device %s pid\"),\n                                 dev_name);\n        return -1;\n    }\n    return 1;\n}"
  },
  {
    "function_name": "virFileLoopDeviceAssociate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "782-838",
    "snippet": "int virFileLoopDeviceAssociate(const char *file,\n                               char **dev)\n{\n    int lofd = -1;\n    int fsfd = -1;\n    struct loop_info64 lo;\n    g_autofree char *loname = NULL;\n    int ret = -1;\n\n    if ((lofd = virFileLoopDeviceOpen(&loname)) < 0)\n        return -1;\n\n    memset(&lo, 0, sizeof(lo));\n    lo.lo_flags = LO_FLAGS_AUTOCLEAR;\n\n    /* Set backing file name for LOOP_GET_STATUS64 queries */\n    if (virStrncpy((char *) lo.lo_file_name, file,\n                   strlen(file), LO_NAME_SIZE) < 0) {\n        virReportSystemError(errno,\n                             _(\"Unable to set backing file %s\"), file);\n        goto cleanup;\n    }\n\n    if ((fsfd = open(file, O_RDWR)) < 0) {\n        virReportSystemError(errno,\n                             _(\"Unable to open %s\"), file);\n        goto cleanup;\n    }\n\n    if (ioctl(lofd, LOOP_SET_FD, fsfd) < 0) {\n        virReportSystemError(errno,\n                             _(\"Unable to attach %s to loop device\"),\n                             file);\n        goto cleanup;\n    }\n\n    if (ioctl(lofd, LOOP_SET_STATUS64, &lo) < 0) {\n        virReportSystemError(errno, \"%s\",\n                             _(\"Unable to mark loop device as autoclear\"));\n\n        if (ioctl(lofd, LOOP_CLR_FD, 0) < 0)\n            VIR_WARN(\"Unable to detach %s from loop device\", file);\n        goto cleanup;\n    }\n\n    VIR_DEBUG(\"Attached loop device  %s %d to %s\", file, lofd, loname);\n    *dev = loname;\n    loname = NULL;\n\n    ret = 0;\n\n cleanup:\n    VIR_FORCE_CLOSE(fsfd);\n    if (ret == -1)\n        VIR_FORCE_CLOSE(lofd);\n    return lofd;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FORCE_CLOSE",
          "args": [
            "lofd"
          ],
          "line": 836
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FORCE_CLOSE",
          "args": [
            "fsfd"
          ],
          "line": 834
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Attached loop device  %s %d to %s\"",
            "file",
            "lofd",
            "loname"
          ],
          "line": 827
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_WARN",
          "args": [
            "\"Unable to detach %s from loop device\"",
            "file"
          ],
          "line": 823
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ioctl",
          "args": [
            "lofd",
            "LOOP_CLR_FD",
            "0"
          ],
          "line": 822
        },
        "resolved": true,
        "details": {
          "function_name": "vir_ioctlsocket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsocket.c",
          "lines": "292-308",
          "snippet": "int\nvir_ioctlsocket(int fd, int cmd, void *arg)\n{\n    SOCKET sk = FD2SK(fd);\n\n    if (sk == INVALID_SOCKET) {\n        errno = EBADF;\n        return -1;\n    }\n\n    if (ioctlsocket(sk, cmd, arg) < 0) {\n        set_errno();\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include <fcntl.h>",
            "#include \"virfile.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <fcntl.h>\n#include \"virfile.h\"\n#include \"virutil.h\"\n#include \"virsocket.h\"\n#include <config.h>\n\nint\nvir_ioctlsocket(int fd, int cmd, void *arg)\n{\n    SOCKET sk = FD2SK(fd);\n\n    if (sk == INVALID_SOCKET) {\n        errno = EBADF;\n        return -1;\n    }\n\n    if (ioctlsocket(sk, cmd, arg) < 0) {\n        set_errno();\n        return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "\"%s\"",
            "_(\"Unable to mark loop device as autoclear\")"
          ],
          "line": 819
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to mark loop device as autoclear\""
          ],
          "line": 820
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"Unable to attach %s to loop device\")",
            "file"
          ],
          "line": 812
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"Unable to open %s\")",
            "file"
          ],
          "line": 806
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "open",
          "args": [
            "file",
            "O_RDWR"
          ],
          "line": 805
        },
        "resolved": true,
        "details": {
          "function_name": "virFileFdopen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "164-177",
          "snippet": "FILE *virFileFdopen(int *fdptr, const char *mode)\n{\n    FILE *file = NULL;\n\n    if (*fdptr >= 0) {\n        file = fdopen(*fdptr, mode);\n        if (file)\n            *fdptr = -1;\n    } else {\n        errno = EBADF;\n    }\n\n    return file;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nFILE *virFileFdopen(int *fdptr, const char *mode)\n{\n    FILE *file = NULL;\n\n    if (*fdptr >= 0) {\n        file = fdopen(*fdptr, mode);\n        if (file)\n            *fdptr = -1;\n    } else {\n        errno = EBADF;\n    }\n\n    return file;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"Unable to set backing file %s\")",
            "file"
          ],
          "line": 800
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStrncpy",
          "args": [
            "(char *) lo.lo_file_name",
            "file",
            "strlen(file)",
            "LO_NAME_SIZE"
          ],
          "line": 798
        },
        "resolved": true,
        "details": {
          "function_name": "virStrncpy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "746-765",
          "snippet": "int\nvirStrncpy(char *dest, const char *src, size_t n, size_t destbytes)\n{\n    size_t src_len = strlen(src);\n\n    /* As a special case, -1 means \"copy the entire string\".\n     *\n     * This is to avoid calling strlen() twice, once in the virStrcpy()\n     * wrapper and once here for bound checking purposes. */\n    if (n == -1)\n        n = src_len;\n\n    if (n > src_len || n > (destbytes - 1))\n        return -1;\n\n    memcpy(dest, src, n);\n    dest[n] = '\\0';\n\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrncpy(char *dest, const char *src, size_t n, size_t destbytes)\n{\n    size_t src_len = strlen(src);\n\n    /* As a special case, -1 means \"copy the entire string\".\n     *\n     * This is to avoid calling strlen() twice, once in the virStrcpy()\n     * wrapper and once here for bound checking purposes. */\n    if (n == -1)\n        n = src_len;\n\n    if (n > src_len || n > (destbytes - 1))\n        return -1;\n\n    memcpy(dest, src, n);\n    dest[n] = '\\0';\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "file"
          ],
          "line": 799
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&lo",
            "0",
            "sizeof(lo)"
          ],
          "line": 794
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virFileLoopDeviceOpen",
          "args": [
            "&loname"
          ],
          "line": 791
        },
        "resolved": true,
        "details": {
          "function_name": "virFileLoopDeviceOpen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "762-780",
          "snippet": "static int virFileLoopDeviceOpen(char **dev_name)\n{\n    int loop_fd = -1;\n\n# if HAVE_DECL_LOOP_CTL_GET_FREE\n    if (virFileLoopDeviceOpenLoopCtl(dev_name, &loop_fd) < 0)\n        return -1;\n\n    VIR_DEBUG(\"Return from loop-control got fd %d\", loop_fd);\n\n    if (loop_fd >= 0)\n        return loop_fd;\n# endif /* HAVE_DECL_LOOP_CTL_GET_FREE */\n\n    /* Without the loop control device we just use the old technique. */\n    loop_fd = virFileLoopDeviceOpenSearch(dev_name);\n\n    return loop_fd;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic int virFileLoopDeviceOpen(char **dev_name)\n{\n    int loop_fd = -1;\n\n# if HAVE_DECL_LOOP_CTL_GET_FREE\n    if (virFileLoopDeviceOpenLoopCtl(dev_name, &loop_fd) < 0)\n        return -1;\n\n    VIR_DEBUG(\"Return from loop-control got fd %d\", loop_fd);\n\n    if (loop_fd >= 0)\n        return loop_fd;\n# endif /* HAVE_DECL_LOOP_CTL_GET_FREE */\n\n    /* Without the loop control device we just use the old technique. */\n    loop_fd = virFileLoopDeviceOpenSearch(dev_name);\n\n    return loop_fd;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint virFileLoopDeviceAssociate(const char *file,\n                               char **dev)\n{\n    int lofd = -1;\n    int fsfd = -1;\n    struct loop_info64 lo;\n    g_autofree char *loname = NULL;\n    int ret = -1;\n\n    if ((lofd = virFileLoopDeviceOpen(&loname)) < 0)\n        return -1;\n\n    memset(&lo, 0, sizeof(lo));\n    lo.lo_flags = LO_FLAGS_AUTOCLEAR;\n\n    /* Set backing file name for LOOP_GET_STATUS64 queries */\n    if (virStrncpy((char *) lo.lo_file_name, file,\n                   strlen(file), LO_NAME_SIZE) < 0) {\n        virReportSystemError(errno,\n                             _(\"Unable to set backing file %s\"), file);\n        goto cleanup;\n    }\n\n    if ((fsfd = open(file, O_RDWR)) < 0) {\n        virReportSystemError(errno,\n                             _(\"Unable to open %s\"), file);\n        goto cleanup;\n    }\n\n    if (ioctl(lofd, LOOP_SET_FD, fsfd) < 0) {\n        virReportSystemError(errno,\n                             _(\"Unable to attach %s to loop device\"),\n                             file);\n        goto cleanup;\n    }\n\n    if (ioctl(lofd, LOOP_SET_STATUS64, &lo) < 0) {\n        virReportSystemError(errno, \"%s\",\n                             _(\"Unable to mark loop device as autoclear\"));\n\n        if (ioctl(lofd, LOOP_CLR_FD, 0) < 0)\n            VIR_WARN(\"Unable to detach %s from loop device\", file);\n        goto cleanup;\n    }\n\n    VIR_DEBUG(\"Attached loop device  %s %d to %s\", file, lofd, loname);\n    *dev = loname;\n    loname = NULL;\n\n    ret = 0;\n\n cleanup:\n    VIR_FORCE_CLOSE(fsfd);\n    if (ret == -1)\n        VIR_FORCE_CLOSE(lofd);\n    return lofd;\n}"
  },
  {
    "function_name": "virFileLoopDeviceOpen",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "762-780",
    "snippet": "static int virFileLoopDeviceOpen(char **dev_name)\n{\n    int loop_fd = -1;\n\n# if HAVE_DECL_LOOP_CTL_GET_FREE\n    if (virFileLoopDeviceOpenLoopCtl(dev_name, &loop_fd) < 0)\n        return -1;\n\n    VIR_DEBUG(\"Return from loop-control got fd %d\", loop_fd);\n\n    if (loop_fd >= 0)\n        return loop_fd;\n# endif /* HAVE_DECL_LOOP_CTL_GET_FREE */\n\n    /* Without the loop control device we just use the old technique. */\n    loop_fd = virFileLoopDeviceOpenSearch(dev_name);\n\n    return loop_fd;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virFileLoopDeviceOpenSearch",
          "args": [
            "dev_name"
          ],
          "line": 777
        },
        "resolved": true,
        "details": {
          "function_name": "virFileLoopDeviceOpenSearch",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "698-760",
          "snippet": "static int virFileLoopDeviceOpenSearch(char **dev_name)\n{\n    int fd = -1;\n    DIR *dh = NULL;\n    struct dirent *de;\n    char *looppath = NULL;\n    struct loop_info64 lo;\n    int direrr;\n\n    VIR_DEBUG(\"Looking for loop devices in /dev\");\n\n    if (virDirOpen(&dh, \"/dev\") < 0)\n        goto cleanup;\n\n    while ((direrr = virDirRead(dh, &de, \"/dev\")) > 0) {\n        /* Checking 'loop' prefix is insufficient, since\n         * new kernels have a dev named 'loop-control'\n         */\n        if (!STRPREFIX(de->d_name, \"loop\") ||\n            !g_ascii_isdigit(de->d_name[4]))\n            continue;\n\n        looppath = g_strdup_printf(\"/dev/%s\", de->d_name);\n\n        VIR_DEBUG(\"Checking up on device %s\", looppath);\n        if ((fd = open(looppath, O_RDWR)) < 0) {\n            virReportSystemError(errno,\n                                 _(\"Unable to open %s\"), looppath);\n            goto cleanup;\n        }\n\n        if (ioctl(fd, LOOP_GET_STATUS64, &lo) < 0) {\n            /* Got a free device, return the fd */\n            if (errno == ENXIO)\n                goto cleanup;\n\n            VIR_FORCE_CLOSE(fd);\n            virReportSystemError(errno,\n                                 _(\"Unable to get loop status on %s\"),\n                                 looppath);\n            goto cleanup;\n        }\n\n        /* Oh well, try the next device */\n        VIR_FORCE_CLOSE(fd);\n        VIR_FREE(looppath);\n    }\n    if (direrr < 0)\n        goto cleanup;\n    virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                   _(\"Unable to find a free loop device in /dev\"));\n\n cleanup:\n    if (fd != -1) {\n        VIR_DEBUG(\"Got free loop device %s %d\", looppath, fd);\n        *dev_name = looppath;\n    } else {\n        VIR_DEBUG(\"No free loop devices available\");\n        VIR_FREE(looppath);\n    }\n    VIR_DIR_CLOSE(dh);\n    return fd;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic int virFileLoopDeviceOpenSearch(char **dev_name)\n{\n    int fd = -1;\n    DIR *dh = NULL;\n    struct dirent *de;\n    char *looppath = NULL;\n    struct loop_info64 lo;\n    int direrr;\n\n    VIR_DEBUG(\"Looking for loop devices in /dev\");\n\n    if (virDirOpen(&dh, \"/dev\") < 0)\n        goto cleanup;\n\n    while ((direrr = virDirRead(dh, &de, \"/dev\")) > 0) {\n        /* Checking 'loop' prefix is insufficient, since\n         * new kernels have a dev named 'loop-control'\n         */\n        if (!STRPREFIX(de->d_name, \"loop\") ||\n            !g_ascii_isdigit(de->d_name[4]))\n            continue;\n\n        looppath = g_strdup_printf(\"/dev/%s\", de->d_name);\n\n        VIR_DEBUG(\"Checking up on device %s\", looppath);\n        if ((fd = open(looppath, O_RDWR)) < 0) {\n            virReportSystemError(errno,\n                                 _(\"Unable to open %s\"), looppath);\n            goto cleanup;\n        }\n\n        if (ioctl(fd, LOOP_GET_STATUS64, &lo) < 0) {\n            /* Got a free device, return the fd */\n            if (errno == ENXIO)\n                goto cleanup;\n\n            VIR_FORCE_CLOSE(fd);\n            virReportSystemError(errno,\n                                 _(\"Unable to get loop status on %s\"),\n                                 looppath);\n            goto cleanup;\n        }\n\n        /* Oh well, try the next device */\n        VIR_FORCE_CLOSE(fd);\n        VIR_FREE(looppath);\n    }\n    if (direrr < 0)\n        goto cleanup;\n    virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                   _(\"Unable to find a free loop device in /dev\"));\n\n cleanup:\n    if (fd != -1) {\n        VIR_DEBUG(\"Got free loop device %s %d\", looppath, fd);\n        *dev_name = looppath;\n    } else {\n        VIR_DEBUG(\"No free loop devices available\");\n        VIR_FREE(looppath);\n    }\n    VIR_DIR_CLOSE(dh);\n    return fd;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Return from loop-control got fd %d\"",
            "loop_fd"
          ],
          "line": 770
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virFileLoopDeviceOpenLoopCtl",
          "args": [
            "dev_name",
            "&loop_fd"
          ],
          "line": 767
        },
        "resolved": true,
        "details": {
          "function_name": "virFileLoopDeviceOpenLoopCtl",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "658-695",
          "snippet": "static int virFileLoopDeviceOpenLoopCtl(char **dev_name, int *fd)\n{\n    int devnr;\n    int ctl_fd;\n    char *looppath = NULL;\n\n    VIR_DEBUG(\"Opening loop-control device\");\n    if ((ctl_fd = open(\"/dev/loop-control\", O_RDWR)) < 0) {\n        if (errno == ENOENT)\n            return 0;\n\n        virReportSystemError(errno, \"%s\",\n                             _(\"Unable to open /dev/loop-control\"));\n        return -1;\n    }\n\n    if ((devnr = ioctl(ctl_fd, LOOP_CTL_GET_FREE)) < 0) {\n        virReportSystemError(errno, \"%s\",\n                             _(\"Unable to get free loop device via ioctl\"));\n        close(ctl_fd);\n        return -1;\n    }\n    close(ctl_fd);\n\n    VIR_DEBUG(\"Found free loop device number %i\", devnr);\n\n    looppath = g_strdup_printf(\"/dev/loop%i\", devnr);\n\n    if ((*fd = open(looppath, O_RDWR)) < 0) {\n        virReportSystemError(errno,\n                             _(\"Unable to open %s\"), looppath);\n        VIR_FREE(looppath);\n        return -1;\n    }\n\n    *dev_name = looppath;\n    return 0;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic int virFileLoopDeviceOpenLoopCtl(char **dev_name, int *fd)\n{\n    int devnr;\n    int ctl_fd;\n    char *looppath = NULL;\n\n    VIR_DEBUG(\"Opening loop-control device\");\n    if ((ctl_fd = open(\"/dev/loop-control\", O_RDWR)) < 0) {\n        if (errno == ENOENT)\n            return 0;\n\n        virReportSystemError(errno, \"%s\",\n                             _(\"Unable to open /dev/loop-control\"));\n        return -1;\n    }\n\n    if ((devnr = ioctl(ctl_fd, LOOP_CTL_GET_FREE)) < 0) {\n        virReportSystemError(errno, \"%s\",\n                             _(\"Unable to get free loop device via ioctl\"));\n        close(ctl_fd);\n        return -1;\n    }\n    close(ctl_fd);\n\n    VIR_DEBUG(\"Found free loop device number %i\", devnr);\n\n    looppath = g_strdup_printf(\"/dev/loop%i\", devnr);\n\n    if ((*fd = open(looppath, O_RDWR)) < 0) {\n        virReportSystemError(errno,\n                             _(\"Unable to open %s\"), looppath);\n        VIR_FREE(looppath);\n        return -1;\n    }\n\n    *dev_name = looppath;\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic int virFileLoopDeviceOpen(char **dev_name)\n{\n    int loop_fd = -1;\n\n# if HAVE_DECL_LOOP_CTL_GET_FREE\n    if (virFileLoopDeviceOpenLoopCtl(dev_name, &loop_fd) < 0)\n        return -1;\n\n    VIR_DEBUG(\"Return from loop-control got fd %d\", loop_fd);\n\n    if (loop_fd >= 0)\n        return loop_fd;\n# endif /* HAVE_DECL_LOOP_CTL_GET_FREE */\n\n    /* Without the loop control device we just use the old technique. */\n    loop_fd = virFileLoopDeviceOpenSearch(dev_name);\n\n    return loop_fd;\n}"
  },
  {
    "function_name": "virFileLoopDeviceOpenSearch",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "698-760",
    "snippet": "static int virFileLoopDeviceOpenSearch(char **dev_name)\n{\n    int fd = -1;\n    DIR *dh = NULL;\n    struct dirent *de;\n    char *looppath = NULL;\n    struct loop_info64 lo;\n    int direrr;\n\n    VIR_DEBUG(\"Looking for loop devices in /dev\");\n\n    if (virDirOpen(&dh, \"/dev\") < 0)\n        goto cleanup;\n\n    while ((direrr = virDirRead(dh, &de, \"/dev\")) > 0) {\n        /* Checking 'loop' prefix is insufficient, since\n         * new kernels have a dev named 'loop-control'\n         */\n        if (!STRPREFIX(de->d_name, \"loop\") ||\n            !g_ascii_isdigit(de->d_name[4]))\n            continue;\n\n        looppath = g_strdup_printf(\"/dev/%s\", de->d_name);\n\n        VIR_DEBUG(\"Checking up on device %s\", looppath);\n        if ((fd = open(looppath, O_RDWR)) < 0) {\n            virReportSystemError(errno,\n                                 _(\"Unable to open %s\"), looppath);\n            goto cleanup;\n        }\n\n        if (ioctl(fd, LOOP_GET_STATUS64, &lo) < 0) {\n            /* Got a free device, return the fd */\n            if (errno == ENXIO)\n                goto cleanup;\n\n            VIR_FORCE_CLOSE(fd);\n            virReportSystemError(errno,\n                                 _(\"Unable to get loop status on %s\"),\n                                 looppath);\n            goto cleanup;\n        }\n\n        /* Oh well, try the next device */\n        VIR_FORCE_CLOSE(fd);\n        VIR_FREE(looppath);\n    }\n    if (direrr < 0)\n        goto cleanup;\n    virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                   _(\"Unable to find a free loop device in /dev\"));\n\n cleanup:\n    if (fd != -1) {\n        VIR_DEBUG(\"Got free loop device %s %d\", looppath, fd);\n        *dev_name = looppath;\n    } else {\n        VIR_DEBUG(\"No free loop devices available\");\n        VIR_FREE(looppath);\n    }\n    VIR_DIR_CLOSE(dh);\n    return fd;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_DIR_CLOSE",
          "args": [
            "dh"
          ],
          "line": 758
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "looppath"
          ],
          "line": 756
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"No free loop devices available\""
          ],
          "line": 755
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Got free loop device %s %d\"",
            "looppath",
            "fd"
          ],
          "line": 752
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"Unable to find a free loop device in /dev\")"
          ],
          "line": 747
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to find a free loop device in /dev\""
          ],
          "line": 748
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "looppath"
          ],
          "line": 743
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FORCE_CLOSE",
          "args": [
            "fd"
          ],
          "line": 742
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"Unable to get loop status on %s\")",
            "looppath"
          ],
          "line": 735
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FORCE_CLOSE",
          "args": [
            "fd"
          ],
          "line": 734
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ioctl",
          "args": [
            "fd",
            "LOOP_GET_STATUS64",
            "&lo"
          ],
          "line": 729
        },
        "resolved": true,
        "details": {
          "function_name": "vir_ioctlsocket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsocket.c",
          "lines": "292-308",
          "snippet": "int\nvir_ioctlsocket(int fd, int cmd, void *arg)\n{\n    SOCKET sk = FD2SK(fd);\n\n    if (sk == INVALID_SOCKET) {\n        errno = EBADF;\n        return -1;\n    }\n\n    if (ioctlsocket(sk, cmd, arg) < 0) {\n        set_errno();\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include <fcntl.h>",
            "#include \"virfile.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <fcntl.h>\n#include \"virfile.h\"\n#include \"virutil.h\"\n#include \"virsocket.h\"\n#include <config.h>\n\nint\nvir_ioctlsocket(int fd, int cmd, void *arg)\n{\n    SOCKET sk = FD2SK(fd);\n\n    if (sk == INVALID_SOCKET) {\n        errno = EBADF;\n        return -1;\n    }\n\n    if (ioctlsocket(sk, cmd, arg) < 0) {\n        set_errno();\n        return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"Unable to open %s\")",
            "looppath"
          ],
          "line": 724
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "open",
          "args": [
            "looppath",
            "O_RDWR"
          ],
          "line": 723
        },
        "resolved": true,
        "details": {
          "function_name": "virFileFdopen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "164-177",
          "snippet": "FILE *virFileFdopen(int *fdptr, const char *mode)\n{\n    FILE *file = NULL;\n\n    if (*fdptr >= 0) {\n        file = fdopen(*fdptr, mode);\n        if (file)\n            *fdptr = -1;\n    } else {\n        errno = EBADF;\n    }\n\n    return file;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nFILE *virFileFdopen(int *fdptr, const char *mode)\n{\n    FILE *file = NULL;\n\n    if (*fdptr >= 0) {\n        file = fdopen(*fdptr, mode);\n        if (file)\n            *fdptr = -1;\n    } else {\n        errno = EBADF;\n    }\n\n    return file;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Checking up on device %s\"",
            "looppath"
          ],
          "line": 722
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_ascii_isdigit",
          "args": [
            "de->d_name[4]"
          ],
          "line": 717
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STRPREFIX",
          "args": [
            "de->d_name",
            "\"loop\""
          ],
          "line": 716
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDirRead",
          "args": [
            "dh",
            "&de",
            "\"/dev\""
          ],
          "line": 712
        },
        "resolved": true,
        "details": {
          "function_name": "virDirRead",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "2940-2954",
          "snippet": "int virDirRead(DIR *dirp, struct dirent **ent, const char *name)\n{\n    do {\n        errno = 0;\n        *ent = readdir(dirp); /* exempt from syntax-check */\n        if (!*ent && errno) {\n            if (name)\n                virReportSystemError(errno, _(\"Unable to read directory '%s'\"),\n                                     name);\n            return -1;\n        }\n    } while (*ent && (STREQ((*ent)->d_name, \".\") ||\n                      STREQ((*ent)->d_name, \"..\")));\n    return !!*ent;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint virDirRead(DIR *dirp, struct dirent **ent, const char *name)\n{\n    do {\n        errno = 0;\n        *ent = readdir(dirp); /* exempt from syntax-check */\n        if (!*ent && errno) {\n            if (name)\n                virReportSystemError(errno, _(\"Unable to read directory '%s'\"),\n                                     name);\n            return -1;\n        }\n    } while (*ent && (STREQ((*ent)->d_name, \".\") ||\n                      STREQ((*ent)->d_name, \"..\")));\n    return !!*ent;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDirOpen",
          "args": [
            "&dh",
            "\"/dev\""
          ],
          "line": 709
        },
        "resolved": true,
        "details": {
          "function_name": "virDirOpenQuiet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "2914-2918",
          "snippet": "int\nvirDirOpenQuiet(DIR **dirp, const char *name)\n{\n    return virDirOpenInternal(dirp, name, false, true);\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirDirOpenQuiet(DIR **dirp, const char *name)\n{\n    return virDirOpenInternal(dirp, name, false, true);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Looking for loop devices in /dev\""
          ],
          "line": 707
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic int virFileLoopDeviceOpenSearch(char **dev_name)\n{\n    int fd = -1;\n    DIR *dh = NULL;\n    struct dirent *de;\n    char *looppath = NULL;\n    struct loop_info64 lo;\n    int direrr;\n\n    VIR_DEBUG(\"Looking for loop devices in /dev\");\n\n    if (virDirOpen(&dh, \"/dev\") < 0)\n        goto cleanup;\n\n    while ((direrr = virDirRead(dh, &de, \"/dev\")) > 0) {\n        /* Checking 'loop' prefix is insufficient, since\n         * new kernels have a dev named 'loop-control'\n         */\n        if (!STRPREFIX(de->d_name, \"loop\") ||\n            !g_ascii_isdigit(de->d_name[4]))\n            continue;\n\n        looppath = g_strdup_printf(\"/dev/%s\", de->d_name);\n\n        VIR_DEBUG(\"Checking up on device %s\", looppath);\n        if ((fd = open(looppath, O_RDWR)) < 0) {\n            virReportSystemError(errno,\n                                 _(\"Unable to open %s\"), looppath);\n            goto cleanup;\n        }\n\n        if (ioctl(fd, LOOP_GET_STATUS64, &lo) < 0) {\n            /* Got a free device, return the fd */\n            if (errno == ENXIO)\n                goto cleanup;\n\n            VIR_FORCE_CLOSE(fd);\n            virReportSystemError(errno,\n                                 _(\"Unable to get loop status on %s\"),\n                                 looppath);\n            goto cleanup;\n        }\n\n        /* Oh well, try the next device */\n        VIR_FORCE_CLOSE(fd);\n        VIR_FREE(looppath);\n    }\n    if (direrr < 0)\n        goto cleanup;\n    virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                   _(\"Unable to find a free loop device in /dev\"));\n\n cleanup:\n    if (fd != -1) {\n        VIR_DEBUG(\"Got free loop device %s %d\", looppath, fd);\n        *dev_name = looppath;\n    } else {\n        VIR_DEBUG(\"No free loop devices available\");\n        VIR_FREE(looppath);\n    }\n    VIR_DIR_CLOSE(dh);\n    return fd;\n}"
  },
  {
    "function_name": "virFileLoopDeviceOpenLoopCtl",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "658-695",
    "snippet": "static int virFileLoopDeviceOpenLoopCtl(char **dev_name, int *fd)\n{\n    int devnr;\n    int ctl_fd;\n    char *looppath = NULL;\n\n    VIR_DEBUG(\"Opening loop-control device\");\n    if ((ctl_fd = open(\"/dev/loop-control\", O_RDWR)) < 0) {\n        if (errno == ENOENT)\n            return 0;\n\n        virReportSystemError(errno, \"%s\",\n                             _(\"Unable to open /dev/loop-control\"));\n        return -1;\n    }\n\n    if ((devnr = ioctl(ctl_fd, LOOP_CTL_GET_FREE)) < 0) {\n        virReportSystemError(errno, \"%s\",\n                             _(\"Unable to get free loop device via ioctl\"));\n        close(ctl_fd);\n        return -1;\n    }\n    close(ctl_fd);\n\n    VIR_DEBUG(\"Found free loop device number %i\", devnr);\n\n    looppath = g_strdup_printf(\"/dev/loop%i\", devnr);\n\n    if ((*fd = open(looppath, O_RDWR)) < 0) {\n        virReportSystemError(errno,\n                             _(\"Unable to open %s\"), looppath);\n        VIR_FREE(looppath);\n        return -1;\n    }\n\n    *dev_name = looppath;\n    return 0;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "looppath"
          ],
          "line": 689
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"Unable to open %s\")",
            "looppath"
          ],
          "line": 687
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to open %s\""
          ],
          "line": 688
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "open",
          "args": [
            "looppath",
            "O_RDWR"
          ],
          "line": 686
        },
        "resolved": true,
        "details": {
          "function_name": "virFileFdopen",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "164-177",
          "snippet": "FILE *virFileFdopen(int *fdptr, const char *mode)\n{\n    FILE *file = NULL;\n\n    if (*fdptr >= 0) {\n        file = fdopen(*fdptr, mode);\n        if (file)\n            *fdptr = -1;\n    } else {\n        errno = EBADF;\n    }\n\n    return file;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nFILE *virFileFdopen(int *fdptr, const char *mode)\n{\n    FILE *file = NULL;\n\n    if (*fdptr >= 0) {\n        file = fdopen(*fdptr, mode);\n        if (file)\n            *fdptr = -1;\n    } else {\n        errno = EBADF;\n    }\n\n    return file;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Found free loop device number %i\"",
            "devnr"
          ],
          "line": 682
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "close",
          "args": [
            "ctl_fd"
          ],
          "line": 680
        },
        "resolved": true,
        "details": {
          "function_name": "vir_closesocket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsocket.c",
          "lines": "197-213",
          "snippet": "int\nvir_closesocket(int fd)\n{\n    SOCKET sk = FD2SK(fd);\n\n    if (sk == INVALID_SOCKET) {\n        errno = EBADF;\n        return -1;\n    }\n\n    if (closesocket(sk) < 0) {\n        set_errno();\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include <fcntl.h>",
            "#include \"virfile.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <fcntl.h>\n#include \"virfile.h\"\n#include \"virutil.h\"\n#include \"virsocket.h\"\n#include <config.h>\n\nint\nvir_closesocket(int fd)\n{\n    SOCKET sk = FD2SK(fd);\n\n    if (sk == INVALID_SOCKET) {\n        errno = EBADF;\n        return -1;\n    }\n\n    if (closesocket(sk) < 0) {\n        set_errno();\n        return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "\"%s\"",
            "_(\"Unable to get free loop device via ioctl\")"
          ],
          "line": 675
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ioctl",
          "args": [
            "ctl_fd",
            "LOOP_CTL_GET_FREE"
          ],
          "line": 674
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "\"%s\"",
            "_(\"Unable to open /dev/loop-control\")"
          ],
          "line": 669
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Opening loop-control device\""
          ],
          "line": 664
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic int virFileLoopDeviceOpenLoopCtl(char **dev_name, int *fd)\n{\n    int devnr;\n    int ctl_fd;\n    char *looppath = NULL;\n\n    VIR_DEBUG(\"Opening loop-control device\");\n    if ((ctl_fd = open(\"/dev/loop-control\", O_RDWR)) < 0) {\n        if (errno == ENOENT)\n            return 0;\n\n        virReportSystemError(errno, \"%s\",\n                             _(\"Unable to open /dev/loop-control\"));\n        return -1;\n    }\n\n    if ((devnr = ioctl(ctl_fd, LOOP_CTL_GET_FREE)) < 0) {\n        virReportSystemError(errno, \"%s\",\n                             _(\"Unable to get free loop device via ioctl\"));\n        close(ctl_fd);\n        return -1;\n    }\n    close(ctl_fd);\n\n    VIR_DEBUG(\"Found free loop device number %i\", devnr);\n\n    looppath = g_strdup_printf(\"/dev/loop%i\", devnr);\n\n    if ((*fd = open(looppath, O_RDWR)) < 0) {\n        virReportSystemError(errno,\n                             _(\"Unable to open %s\"), looppath);\n        VIR_FREE(looppath);\n        return -1;\n    }\n\n    *dev_name = looppath;\n    return 0;\n}"
  },
  {
    "function_name": "virFileUpdatePerm",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "614-646",
    "snippet": "int virFileUpdatePerm(const char *path,\n                      mode_t mode_remove,\n                      mode_t mode_add)\n{\n    struct stat sb;\n    mode_t mode;\n\n    if (mode_remove & ~MODE_BITS || mode_add & ~MODE_BITS) {\n        virReportError(VIR_ERR_INVALID_ARG, \"%s\", _(\"invalid mode\"));\n        return -1;\n    }\n\n    if (stat(path, &sb) < 0) {\n        virReportSystemError(errno, _(\"cannot stat '%s'\"), path);\n        return -1;\n    }\n\n    mode = sb.st_mode & MODE_BITS;\n\n    if ((mode & mode_remove) == 0 && (mode & mode_add) == mode_add)\n        return 0;\n\n    mode &= MODE_BITS ^ mode_remove;\n    mode |= mode_add;\n\n    if (chmod(path, mode) < 0) {\n        virReportSystemError(errno, _(\"cannot change permission of '%s'\"),\n                             path);\n        return -1;\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define MODE_BITS (S_ISUID | S_ISGID | S_ISVTX | S_IRWXU | S_IRWXG | S_IRWXO)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"cannot change permission of '%s'\")",
            "path"
          ],
          "line": 640
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"cannot change permission of '%s'\""
          ],
          "line": 640
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "chmod",
          "args": [
            "path",
            "mode"
          ],
          "line": 639
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"cannot stat '%s'\")",
            "path"
          ],
          "line": 627
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "stat",
          "args": [
            "path",
            "&sb"
          ],
          "line": 626
        },
        "resolved": true,
        "details": {
          "function_name": "profile_status",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/security/security_apparmor.c",
          "lines": "70-108",
          "snippet": "static int\nprofile_status(const char *str, const int check_enforcing)\n{\n    char *content = NULL;\n    char *tmp = NULL;\n    char *etmp = NULL;\n    int rc = -2;\n\n    /* create string that is '<str> \\0' for accurate matching */\n    tmp = g_strdup_printf(\"%s \", str);\n\n    if (check_enforcing != 0) {\n        /* create string that is '<str> (enforce)\\0' for accurate matching */\n        etmp = g_strdup_printf(\"%s (enforce)\", str);\n    }\n\n    if (virFileReadAll(APPARMOR_PROFILES_PATH, MAX_FILE_LEN, &content) < 0) {\n        virReportSystemError(errno,\n                             _(\"Failed to read AppArmor profiles list \"\n                             \"\\'%s\\'\"), APPARMOR_PROFILES_PATH);\n        goto cleanup;\n    }\n\n    if (strstr(content, tmp) != NULL)\n        rc = 0;\n    else\n        rc = -1; /* return -1 if not loaded */\n    if (check_enforcing != 0) {\n        if (rc == 0 && strstr(content, etmp) != NULL)\n            rc = 1;                 /* return '1' if loaded and enforcing */\n    }\n\n    VIR_FREE(content);\n cleanup:\n    VIR_FREE(tmp);\n    VIR_FREE(etmp);\n\n    return rc;\n}",
          "includes": [
            "#include \"virmdev.h\"",
            "#include \"virscsi.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"vircommand.h\"",
            "#include \"configmake.h\"",
            "#include \"virfile.h\"",
            "#include \"virscsivhost.h\"",
            "#include \"virusb.h\"",
            "#include \"virpci.h\"",
            "#include \"viruuid.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"security_apparmor.h\"",
            "#include \"internal.h\"",
            "#include <wait.h>",
            "#include <unistd.h>",
            "#include <sys/apparmor.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virmdev.h\"\n#include \"virscsi.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"vircommand.h\"\n#include \"configmake.h\"\n#include \"virfile.h\"\n#include \"virscsivhost.h\"\n#include \"virusb.h\"\n#include \"virpci.h\"\n#include \"viruuid.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"security_apparmor.h\"\n#include \"internal.h\"\n#include <wait.h>\n#include <unistd.h>\n#include <sys/apparmor.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nprofile_status(const char *str, const int check_enforcing)\n{\n    char *content = NULL;\n    char *tmp = NULL;\n    char *etmp = NULL;\n    int rc = -2;\n\n    /* create string that is '<str> \\0' for accurate matching */\n    tmp = g_strdup_printf(\"%s \", str);\n\n    if (check_enforcing != 0) {\n        /* create string that is '<str> (enforce)\\0' for accurate matching */\n        etmp = g_strdup_printf(\"%s (enforce)\", str);\n    }\n\n    if (virFileReadAll(APPARMOR_PROFILES_PATH, MAX_FILE_LEN, &content) < 0) {\n        virReportSystemError(errno,\n                             _(\"Failed to read AppArmor profiles list \"\n                             \"\\'%s\\'\"), APPARMOR_PROFILES_PATH);\n        goto cleanup;\n    }\n\n    if (strstr(content, tmp) != NULL)\n        rc = 0;\n    else\n        rc = -1; /* return -1 if not loaded */\n    if (check_enforcing != 0) {\n        if (rc == 0 && strstr(content, etmp) != NULL)\n            rc = 1;                 /* return '1' if loaded and enforcing */\n    }\n\n    VIR_FREE(content);\n cleanup:\n    VIR_FREE(tmp);\n    VIR_FREE(etmp);\n\n    return rc;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INVALID_ARG",
            "\"%s\"",
            "_(\"invalid mode\")"
          ],
          "line": 622
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\n#define MODE_BITS (S_ISUID | S_ISGID | S_ISVTX | S_IRWXU | S_IRWXG | S_IRWXO)\n\nint virFileUpdatePerm(const char *path,\n                      mode_t mode_remove,\n                      mode_t mode_add)\n{\n    struct stat sb;\n    mode_t mode;\n\n    if (mode_remove & ~MODE_BITS || mode_add & ~MODE_BITS) {\n        virReportError(VIR_ERR_INVALID_ARG, \"%s\", _(\"invalid mode\"));\n        return -1;\n    }\n\n    if (stat(path, &sb) < 0) {\n        virReportSystemError(errno, _(\"cannot stat '%s'\"), path);\n        return -1;\n    }\n\n    mode = sb.st_mode & MODE_BITS;\n\n    if ((mode & mode_remove) == 0 && (mode & mode_add) == mode_add)\n        return 0;\n\n    mode &= MODE_BITS ^ mode_remove;\n    mode |= mode_add;\n\n    if (chmod(path, mode) < 0) {\n        virReportSystemError(errno, _(\"cannot change permission of '%s'\"),\n                             path);\n        return -1;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virFileTouch",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "591-609",
    "snippet": "int virFileTouch(const char *path, mode_t mode)\n{\n    int fd = -1;\n\n    if ((fd = open(path, O_WRONLY | O_CREAT, mode)) < 0) {\n        virReportSystemError(errno, _(\"cannot create file '%s'\"),\n                             path);\n        return -1;\n    }\n\n    if (VIR_CLOSE(fd) < 0) {\n        virReportSystemError(errno, _(\"cannot save file '%s'\"),\n                             path);\n        VIR_FORCE_CLOSE(fd);\n        return -1;\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FORCE_CLOSE",
          "args": [
            "fd"
          ],
          "line": 604
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"cannot save file '%s'\")",
            "path"
          ],
          "line": 602
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"cannot save file '%s'\""
          ],
          "line": 602
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_CLOSE",
          "args": [
            "fd"
          ],
          "line": 601
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"cannot create file '%s'\")",
            "path"
          ],
          "line": 596
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "open",
          "args": [
            "path",
            "O_WRONLY | O_CREAT",
            "mode"
          ],
          "line": 595
        },
        "resolved": true,
        "details": {
          "function_name": "qemuBlockReopenReadOnly",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
          "lines": "3308-3323",
          "snippet": "int\nqemuBlockReopenReadOnly(virDomainObjPtr vm,\n                         virStorageSourcePtr src,\n                         qemuDomainAsyncJob asyncJob)\n{\n    if (src->readonly)\n        return 0;\n\n    src->readonly = true;\n    if (qemuBlockReopenFormat(vm, src, asyncJob) < 0) {\n        src->readonly = false;\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_block.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nint\nqemuBlockReopenReadOnly(virDomainObjPtr vm,\n                         virStorageSourcePtr src,\n                         qemuDomainAsyncJob asyncJob)\n{\n    if (src->readonly)\n        return 0;\n\n    src->readonly = true;\n    if (qemuBlockReopenFormat(vm, src, asyncJob) < 0) {\n        src->readonly = false;\n        return -1;\n    }\n\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint virFileTouch(const char *path, mode_t mode)\n{\n    int fd = -1;\n\n    if ((fd = open(path, O_WRONLY | O_CREAT, mode)) < 0) {\n        virReportSystemError(errno, _(\"cannot create file '%s'\"),\n                             path);\n        return -1;\n    }\n\n    if (VIR_CLOSE(fd) < 0) {\n        virReportSystemError(errno, _(\"cannot save file '%s'\"),\n                             path);\n        VIR_FORCE_CLOSE(fd);\n        return -1;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virFileRewriteStr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "581-588",
    "snippet": "int\nvirFileRewriteStr(const char *path,\n                  mode_t mode,\n                  const char *str)\n{\n    return virFileRewrite(path, mode,\n                          virFileRewriteStrHelper, str);\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virFileRewrite",
          "args": [
            "path",
            "mode",
            "virFileRewriteStrHelper",
            "str"
          ],
          "line": 586
        },
        "resolved": true,
        "details": {
          "function_name": "virFileRewrite",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "518-566",
          "snippet": "int\nvirFileRewrite(const char *path,\n               mode_t mode,\n               virFileRewriteFunc rewrite,\n               const void *opaque)\n{\n    g_autofree char *newfile = NULL;\n    int fd = -1;\n    int ret = -1;\n\n    newfile = g_strdup_printf(\"%s.new\", path);\n\n    if ((fd = open(newfile, O_WRONLY | O_CREAT | O_TRUNC, mode)) < 0) {\n        virReportSystemError(errno, _(\"cannot create file '%s'\"),\n                             newfile);\n        goto cleanup;\n    }\n\n    if (rewrite(fd, opaque) < 0) {\n        virReportSystemError(errno, _(\"cannot write data to file '%s'\"),\n                             newfile);\n        goto cleanup;\n    }\n\n    if (g_fsync(fd) < 0) {\n        virReportSystemError(errno, _(\"cannot sync file '%s'\"),\n                             newfile);\n        goto cleanup;\n    }\n\n    if (VIR_CLOSE(fd) < 0) {\n        virReportSystemError(errno, _(\"cannot save file '%s'\"),\n                             newfile);\n        goto cleanup;\n    }\n\n    if (rename(newfile, path) < 0) {\n        virReportSystemError(errno, _(\"cannot rename file '%s' as '%s'\"),\n                             newfile, path);\n        goto cleanup;\n    }\n\n    ret = 0;\n\n cleanup:\n    VIR_FORCE_CLOSE(fd);\n    unlink(newfile);\n    return ret;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileRewrite(const char *path,\n               mode_t mode,\n               virFileRewriteFunc rewrite,\n               const void *opaque)\n{\n    g_autofree char *newfile = NULL;\n    int fd = -1;\n    int ret = -1;\n\n    newfile = g_strdup_printf(\"%s.new\", path);\n\n    if ((fd = open(newfile, O_WRONLY | O_CREAT | O_TRUNC, mode)) < 0) {\n        virReportSystemError(errno, _(\"cannot create file '%s'\"),\n                             newfile);\n        goto cleanup;\n    }\n\n    if (rewrite(fd, opaque) < 0) {\n        virReportSystemError(errno, _(\"cannot write data to file '%s'\"),\n                             newfile);\n        goto cleanup;\n    }\n\n    if (g_fsync(fd) < 0) {\n        virReportSystemError(errno, _(\"cannot sync file '%s'\"),\n                             newfile);\n        goto cleanup;\n    }\n\n    if (VIR_CLOSE(fd) < 0) {\n        virReportSystemError(errno, _(\"cannot save file '%s'\"),\n                             newfile);\n        goto cleanup;\n    }\n\n    if (rename(newfile, path) < 0) {\n        virReportSystemError(errno, _(\"cannot rename file '%s' as '%s'\"),\n                             newfile, path);\n        goto cleanup;\n    }\n\n    ret = 0;\n\n cleanup:\n    VIR_FORCE_CLOSE(fd);\n    unlink(newfile);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileRewriteStr(const char *path,\n                  mode_t mode,\n                  const char *str)\n{\n    return virFileRewrite(path, mode,\n                          virFileRewriteStrHelper, str);\n}"
  },
  {
    "function_name": "virFileRewriteStrHelper",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "569-578",
    "snippet": "static int\nvirFileRewriteStrHelper(int fd, const void *opaque)\n{\n    const char *data = opaque;\n\n    if (safewrite(fd, data, strlen(data)) < 0)\n        return -1;\n\n    return 0;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "safewrite",
          "args": [
            "fd",
            "data",
            "strlen(data)"
          ],
          "line": 574
        },
        "resolved": true,
        "details": {
          "function_name": "safewrite",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1093-1111",
          "snippet": "ssize_t\nsafewrite(int fd, const void *buf, size_t count)\n{\n    size_t nwritten = 0;\n    while (count > 0) {\n        ssize_t r = write(fd, buf, count);\n\n        if (r < 0 && errno == EINTR)\n            continue;\n        if (r < 0)\n            return r;\n        if (r == 0)\n            return nwritten;\n        buf = (const char *)buf + r;\n        count -= r;\n        nwritten += r;\n    }\n    return nwritten;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nssize_t\nsafewrite(int fd, const void *buf, size_t count)\n{\n    size_t nwritten = 0;\n    while (count > 0) {\n        ssize_t r = write(fd, buf, count);\n\n        if (r < 0 && errno == EINTR)\n            continue;\n        if (r < 0)\n            return r;\n        if (r == 0)\n            return nwritten;\n        buf = (const char *)buf + r;\n        count -= r;\n        nwritten += r;\n    }\n    return nwritten;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "data"
          ],
          "line": 574
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nvirFileRewriteStrHelper(int fd, const void *opaque)\n{\n    const char *data = opaque;\n\n    if (safewrite(fd, data, strlen(data)) < 0)\n        return -1;\n\n    return 0;\n}"
  },
  {
    "function_name": "virFileRewrite",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "518-566",
    "snippet": "int\nvirFileRewrite(const char *path,\n               mode_t mode,\n               virFileRewriteFunc rewrite,\n               const void *opaque)\n{\n    g_autofree char *newfile = NULL;\n    int fd = -1;\n    int ret = -1;\n\n    newfile = g_strdup_printf(\"%s.new\", path);\n\n    if ((fd = open(newfile, O_WRONLY | O_CREAT | O_TRUNC, mode)) < 0) {\n        virReportSystemError(errno, _(\"cannot create file '%s'\"),\n                             newfile);\n        goto cleanup;\n    }\n\n    if (rewrite(fd, opaque) < 0) {\n        virReportSystemError(errno, _(\"cannot write data to file '%s'\"),\n                             newfile);\n        goto cleanup;\n    }\n\n    if (g_fsync(fd) < 0) {\n        virReportSystemError(errno, _(\"cannot sync file '%s'\"),\n                             newfile);\n        goto cleanup;\n    }\n\n    if (VIR_CLOSE(fd) < 0) {\n        virReportSystemError(errno, _(\"cannot save file '%s'\"),\n                             newfile);\n        goto cleanup;\n    }\n\n    if (rename(newfile, path) < 0) {\n        virReportSystemError(errno, _(\"cannot rename file '%s' as '%s'\"),\n                             newfile, path);\n        goto cleanup;\n    }\n\n    ret = 0;\n\n cleanup:\n    VIR_FORCE_CLOSE(fd);\n    unlink(newfile);\n    return ret;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "unlink",
          "args": [
            "newfile"
          ],
          "line": 564
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FORCE_CLOSE",
          "args": [
            "fd"
          ],
          "line": 563
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"cannot rename file '%s' as '%s'\")",
            "newfile",
            "path"
          ],
          "line": 555
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"cannot rename file '%s' as '%s'\""
          ],
          "line": 555
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "rename",
          "args": [
            "newfile",
            "path"
          ],
          "line": 554
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"cannot save file '%s'\")",
            "newfile"
          ],
          "line": 549
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_CLOSE",
          "args": [
            "fd"
          ],
          "line": 548
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"cannot sync file '%s'\")",
            "newfile"
          ],
          "line": 543
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_fsync",
          "args": [
            "fd"
          ],
          "line": 542
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_fsync",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "177-185",
          "snippet": "gint\nvir_g_fsync(gint fd)\n{\n#ifdef G_OS_WIN32\n    return _commit(fd);\n#else\n    return fsync(fd);\n#endif\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\ngint\nvir_g_fsync(gint fd)\n{\n#ifdef G_OS_WIN32\n    return _commit(fd);\n#else\n    return fsync(fd);\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"cannot write data to file '%s'\")",
            "newfile"
          ],
          "line": 537
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rewrite",
          "args": [
            "fd",
            "opaque"
          ],
          "line": 536
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"cannot create file '%s'\")",
            "newfile"
          ],
          "line": 531
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "open",
          "args": [
            "newfile",
            "O_WRONLY | O_CREAT | O_TRUNC",
            "mode"
          ],
          "line": 530
        },
        "resolved": true,
        "details": {
          "function_name": "qemuBlockReopenReadOnly",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_block.c",
          "lines": "3308-3323",
          "snippet": "int\nqemuBlockReopenReadOnly(virDomainObjPtr vm,\n                         virStorageSourcePtr src,\n                         qemuDomainAsyncJob asyncJob)\n{\n    if (src->readonly)\n        return 0;\n\n    src->readonly = true;\n    if (qemuBlockReopenFormat(vm, src, asyncJob) < 0) {\n        src->readonly = false;\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_block.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"qemu_security.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_command.h\"\n#include \"qemu_block.h\"\n#include <config.h>\n\nint\nqemuBlockReopenReadOnly(virDomainObjPtr vm,\n                         virStorageSourcePtr src,\n                         qemuDomainAsyncJob asyncJob)\n{\n    if (src->readonly)\n        return 0;\n\n    src->readonly = true;\n    if (qemuBlockReopenFormat(vm, src, asyncJob) < 0) {\n        src->readonly = false;\n        return -1;\n    }\n\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileRewrite(const char *path,\n               mode_t mode,\n               virFileRewriteFunc rewrite,\n               const void *opaque)\n{\n    g_autofree char *newfile = NULL;\n    int fd = -1;\n    int ret = -1;\n\n    newfile = g_strdup_printf(\"%s.new\", path);\n\n    if ((fd = open(newfile, O_WRONLY | O_CREAT | O_TRUNC, mode)) < 0) {\n        virReportSystemError(errno, _(\"cannot create file '%s'\"),\n                             newfile);\n        goto cleanup;\n    }\n\n    if (rewrite(fd, opaque) < 0) {\n        virReportSystemError(errno, _(\"cannot write data to file '%s'\"),\n                             newfile);\n        goto cleanup;\n    }\n\n    if (g_fsync(fd) < 0) {\n        virReportSystemError(errno, _(\"cannot sync file '%s'\"),\n                             newfile);\n        goto cleanup;\n    }\n\n    if (VIR_CLOSE(fd) < 0) {\n        virReportSystemError(errno, _(\"cannot save file '%s'\"),\n                             newfile);\n        goto cleanup;\n    }\n\n    if (rename(newfile, path) < 0) {\n        virReportSystemError(errno, _(\"cannot rename file '%s' as '%s'\"),\n                             newfile, path);\n        goto cleanup;\n    }\n\n    ret = 0;\n\n cleanup:\n    VIR_FORCE_CLOSE(fd);\n    unlink(newfile);\n    return ret;\n}"
  },
  {
    "function_name": "virFileFlock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "507-513",
    "snippet": "int virFileFlock(int fd G_GNUC_UNUSED,\n                 bool lock G_GNUC_UNUSED,\n                 bool shared G_GNUC_UNUSED)\n{\n    errno = ENOSYS;\n    return -1;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint virFileFlock(int fd G_GNUC_UNUSED,\n                 bool lock G_GNUC_UNUSED,\n                 bool shared G_GNUC_UNUSED)\n{\n    errno = ENOSYS;\n    return -1;\n}"
  },
  {
    "function_name": "virFileUnlock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "499-504",
    "snippet": "int virFileUnlock(int fd G_GNUC_UNUSED,\n                  off_t start G_GNUC_UNUSED,\n                  off_t len G_GNUC_UNUSED)\n{\n    return -ENOSYS;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint virFileUnlock(int fd G_GNUC_UNUSED,\n                  off_t start G_GNUC_UNUSED,\n                  off_t len G_GNUC_UNUSED)\n{\n    return -ENOSYS;\n}"
  },
  {
    "function_name": "virFileLock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "489-496",
    "snippet": "int virFileLock(int fd G_GNUC_UNUSED,\n                bool shared G_GNUC_UNUSED,\n                off_t start G_GNUC_UNUSED,\n                off_t len G_GNUC_UNUSED,\n                bool waitForLock G_GNUC_UNUSED)\n{\n    return -ENOSYS;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint virFileLock(int fd G_GNUC_UNUSED,\n                bool shared G_GNUC_UNUSED,\n                off_t start G_GNUC_UNUSED,\n                off_t len G_GNUC_UNUSED,\n                bool waitForLock G_GNUC_UNUSED)\n{\n    return -ENOSYS;\n}"
  },
  {
    "function_name": "virFileFlock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "479-485",
    "snippet": "int virFileFlock(int fd, bool lock, bool shared)\n{\n    if (lock)\n        return flock(fd, shared ? LOCK_SH : LOCK_EX);\n\n    return flock(fd, LOCK_UN);\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "flock",
          "args": [
            "fd",
            "LOCK_UN"
          ],
          "line": 484
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "flock",
          "args": [
            "fd",
            "shared ? LOCK_SH : LOCK_EX"
          ],
          "line": 482
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint virFileFlock(int fd, bool lock, bool shared)\n{\n    if (lock)\n        return flock(fd, shared ? LOCK_SH : LOCK_EX);\n\n    return flock(fd, LOCK_UN);\n}"
  },
  {
    "function_name": "virFileUnlock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "449-462",
    "snippet": "int virFileUnlock(int fd, off_t start, off_t len)\n{\n    struct flock fl = {\n        .l_type = F_UNLCK,\n        .l_whence = SEEK_SET,\n        .l_start = start,\n        .l_len = len,\n    };\n\n    if (fcntl(fd, F_SETLK, &fl) < 0)\n        return -errno;\n\n    return 0;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fcntl",
          "args": [
            "fd",
            "F_SETLK",
            "&fl"
          ],
          "line": 458
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint virFileUnlock(int fd, off_t start, off_t len)\n{\n    struct flock fl = {\n        .l_type = F_UNLCK,\n        .l_whence = SEEK_SET,\n        .l_start = start,\n        .l_len = len,\n    };\n\n    if (fcntl(fd, F_SETLK, &fl) < 0)\n        return -errno;\n\n    return 0;\n}"
  },
  {
    "function_name": "virFileLock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "419-434",
    "snippet": "int virFileLock(int fd, bool shared, off_t start, off_t len, bool waitForLock)\n{\n    struct flock fl = {\n        .l_type = shared ? F_RDLCK : F_WRLCK,\n        .l_whence = SEEK_SET,\n        .l_start = start,\n        .l_len = len,\n    };\n\n    int cmd = waitForLock ? F_SETLKW : F_SETLK;\n\n    if (fcntl(fd, cmd, &fl) < 0)\n        return -errno;\n\n    return 0;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fcntl",
          "args": [
            "fd",
            "cmd",
            "&fl"
          ],
          "line": 430
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint virFileLock(int fd, bool shared, off_t start, off_t len, bool waitForLock)\n{\n    struct flock fl = {\n        .l_type = shared ? F_RDLCK : F_WRLCK,\n        .l_whence = SEEK_SET,\n        .l_start = start,\n        .l_len = len,\n    };\n\n    int cmd = waitForLock ? F_SETLKW : F_SETLK;\n\n    if (fcntl(fd, cmd, &fl) < 0)\n        return -errno;\n\n    return 0;\n}"
  },
  {
    "function_name": "virFileWrapperFdFree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "381-390",
    "snippet": "void\nvirFileWrapperFdFree(virFileWrapperFdPtr wfd)\n{\n    if (!wfd)\n        return;\n\n    VIR_FREE(wfd->err_msg);\n    virCommandFree(wfd->cmd);\n    VIR_FREE(wfd);\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "wfd"
          ],
          "line": 389
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCommandFree",
          "args": [
            "wfd->cmd"
          ],
          "line": 388
        },
        "resolved": true,
        "details": {
          "function_name": "virCommandFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "2992-3047",
          "snippet": "void\nvirCommandFree(virCommandPtr cmd)\n{\n    size_t i;\n    if (!cmd)\n        return;\n\n    for (i = 0; i < cmd->npassfd; i++) {\n        if (cmd->passfd[i].flags & VIR_COMMAND_PASS_FD_CLOSE_PARENT)\n            VIR_FORCE_CLOSE(cmd->passfd[i].fd);\n    }\n    cmd->npassfd = 0;\n    VIR_FREE(cmd->passfd);\n\n    if (cmd->asyncioThread) {\n        virThreadJoin(cmd->asyncioThread);\n        VIR_FREE(cmd->asyncioThread);\n    }\n    VIR_FREE(cmd->inbuf);\n    VIR_FORCE_CLOSE(cmd->outfd);\n    VIR_FORCE_CLOSE(cmd->errfd);\n\n    for (i = 0; i < cmd->nargs; i++)\n        VIR_FREE(cmd->args[i]);\n    VIR_FREE(cmd->args);\n\n    for (i = 0; i < cmd->nenv; i++)\n        VIR_FREE(cmd->env[i]);\n    VIR_FREE(cmd->env);\n\n    VIR_FREE(cmd->pwd);\n\n    if (cmd->handshake) {\n        /* The other 2 fds in these arrays are closed\n         * due to use with virCommandPassFD\n         */\n        VIR_FORCE_CLOSE(cmd->handshakeWait[0]);\n        VIR_FORCE_CLOSE(cmd->handshakeNotify[1]);\n    }\n\n    VIR_FREE(cmd->pidfile);\n\n    if (cmd->reap)\n        virCommandAbort(cmd);\n\n#if defined(WITH_SECDRIVER_SELINUX)\n    VIR_FREE(cmd->seLinuxLabel);\n#endif\n#if defined(WITH_SECDRIVER_APPARMOR)\n    VIR_FREE(cmd->appArmorProfile);\n#endif\n\n    virCommandFreeSendBuffers(cmd);\n\n    VIR_FREE(cmd);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nvoid\nvirCommandFree(virCommandPtr cmd)\n{\n    size_t i;\n    if (!cmd)\n        return;\n\n    for (i = 0; i < cmd->npassfd; i++) {\n        if (cmd->passfd[i].flags & VIR_COMMAND_PASS_FD_CLOSE_PARENT)\n            VIR_FORCE_CLOSE(cmd->passfd[i].fd);\n    }\n    cmd->npassfd = 0;\n    VIR_FREE(cmd->passfd);\n\n    if (cmd->asyncioThread) {\n        virThreadJoin(cmd->asyncioThread);\n        VIR_FREE(cmd->asyncioThread);\n    }\n    VIR_FREE(cmd->inbuf);\n    VIR_FORCE_CLOSE(cmd->outfd);\n    VIR_FORCE_CLOSE(cmd->errfd);\n\n    for (i = 0; i < cmd->nargs; i++)\n        VIR_FREE(cmd->args[i]);\n    VIR_FREE(cmd->args);\n\n    for (i = 0; i < cmd->nenv; i++)\n        VIR_FREE(cmd->env[i]);\n    VIR_FREE(cmd->env);\n\n    VIR_FREE(cmd->pwd);\n\n    if (cmd->handshake) {\n        /* The other 2 fds in these arrays are closed\n         * due to use with virCommandPassFD\n         */\n        VIR_FORCE_CLOSE(cmd->handshakeWait[0]);\n        VIR_FORCE_CLOSE(cmd->handshakeNotify[1]);\n    }\n\n    VIR_FREE(cmd->pidfile);\n\n    if (cmd->reap)\n        virCommandAbort(cmd);\n\n#if defined(WITH_SECDRIVER_SELINUX)\n    VIR_FREE(cmd->seLinuxLabel);\n#endif\n#if defined(WITH_SECDRIVER_APPARMOR)\n    VIR_FREE(cmd->appArmorProfile);\n#endif\n\n    virCommandFreeSendBuffers(cmd);\n\n    VIR_FREE(cmd);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "wfd->err_msg"
          ],
          "line": 387
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nvoid\nvirFileWrapperFdFree(virFileWrapperFdPtr wfd)\n{\n    if (!wfd)\n        return;\n\n    VIR_FREE(wfd->err_msg);\n    virCommandFree(wfd->cmd);\n    VIR_FREE(wfd);\n}"
  },
  {
    "function_name": "virFileWrapperFdClose",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "348-370",
    "snippet": "int\nvirFileWrapperFdClose(virFileWrapperFdPtr wfd)\n{\n    int ret;\n\n    if (!wfd || wfd->closed)\n        return 0;\n\n    ret = virCommandWait(wfd->cmd, NULL);\n\n    /* If the command used to process I/O has failed and produced some\n     * messages on stderr, it's fair to assume those will be more\n     * relevant to the user than whatever eg. QEMU can figure out on its\n     * own having no knowledge of the fact a command is handling its I/O\n     * in the first place, so it's okay if we end up discarding an\n     * existing error here */\n    if (ret < 0 && wfd->err_msg && *wfd->err_msg)\n        virReportError(VIR_ERR_OPERATION_FAILED, \"%s\", wfd->err_msg);\n\n    wfd->closed = true;\n\n    return ret;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_FAILED",
            "\"%s\"",
            "wfd->err_msg"
          ],
          "line": 365
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCommandWait",
          "args": [
            "wfd->cmd",
            "NULL"
          ],
          "line": 356
        },
        "resolved": true,
        "details": {
          "function_name": "virCommandWait",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "2940-2946",
          "snippet": "int\nvirCommandWait(virCommandPtr cmd G_GNUC_UNUSED, int *exitstatus G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Executing new processes is not supported on Win32 platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nint\nvirCommandWait(virCommandPtr cmd G_GNUC_UNUSED, int *exitstatus G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Executing new processes is not supported on Win32 platform\"));\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileWrapperFdClose(virFileWrapperFdPtr wfd)\n{\n    int ret;\n\n    if (!wfd || wfd->closed)\n        return 0;\n\n    ret = virCommandWait(wfd->cmd, NULL);\n\n    /* If the command used to process I/O has failed and produced some\n     * messages on stderr, it's fair to assume those will be more\n     * relevant to the user than whatever eg. QEMU can figure out on its\n     * own having no knowledge of the fact a command is handling its I/O\n     * in the first place, so it's okay if we end up discarding an\n     * existing error here */\n    if (ret < 0 && wfd->err_msg && *wfd->err_msg)\n        virReportError(VIR_ERR_OPERATION_FAILED, \"%s\", wfd->err_msg);\n\n    wfd->closed = true;\n\n    return ret;\n}"
  },
  {
    "function_name": "virFileWrapperFdNew",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "323-331",
    "snippet": "virFileWrapperFdPtr\nvirFileWrapperFdNew(int *fd G_GNUC_UNUSED,\n                    const char *name G_GNUC_UNUSED,\n                    unsigned int fdflags G_GNUC_UNUSED)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                   _(\"virFileWrapperFd unsupported on this platform\"));\n    return NULL;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"virFileWrapperFd unsupported on this platform\")"
          ],
          "line": 328
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"virFileWrapperFd unsupported on this platform\""
          ],
          "line": 329
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nvirFileWrapperFdPtr\nvirFileWrapperFdNew(int *fd G_GNUC_UNUSED,\n                    const char *name G_GNUC_UNUSED,\n                    unsigned int fdflags G_GNUC_UNUSED)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                   _(\"virFileWrapperFd unsupported on this platform\"));\n    return NULL;\n}"
  },
  {
    "function_name": "virFileWrapperFdNew",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "232-321",
    "snippet": "virFileWrapperFdPtr\nvirFileWrapperFdNew(int *fd, const char *name, unsigned int flags)\n{\n    virFileWrapperFdPtr ret = NULL;\n    bool output = false;\n    int pipefd[2] = { -1, -1 };\n    int mode = -1;\n    g_autofree char *iohelper_path = NULL;\n\n    if (!flags) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"invalid use with no flags\"));\n        return NULL;\n    }\n\n    /* XXX support posix_fadvise rather than O_DIRECT, if the kernel support\n     * for that is decent enough. In that case, we will also need to\n     * explicitly support VIR_FILE_WRAPPER_NON_BLOCKING since\n     * VIR_FILE_WRAPPER_BYPASS_CACHE alone will no longer require spawning\n     * iohelper.\n     */\n\n    if ((flags & VIR_FILE_WRAPPER_BYPASS_CACHE) && !O_DIRECT) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"O_DIRECT unsupported on this platform\"));\n        return NULL;\n    }\n\n    if (VIR_ALLOC(ret) < 0)\n        return NULL;\n\n    mode = fcntl(*fd, F_GETFL);\n\n    if (mode < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, _(\"invalid fd %d for %s\"),\n                       *fd, name);\n        goto error;\n    } else if ((mode & O_ACCMODE) == O_WRONLY) {\n        output = true;\n    } else if ((mode & O_ACCMODE) != O_RDONLY) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, _(\"unexpected mode 0x%x for %s\"),\n                       mode & O_ACCMODE, name);\n        goto error;\n    }\n\n    if (virPipe(pipefd) < 0)\n        goto error;\n\n    if (!(iohelper_path = virFileFindResource(\"libvirt_iohelper\",\n                                              abs_top_builddir \"/src\",\n                                              LIBEXECDIR)))\n        goto error;\n\n    ret->cmd = virCommandNewArgList(iohelper_path, name, NULL);\n\n    if (output) {\n        virCommandSetInputFD(ret->cmd, pipefd[0]);\n        virCommandSetOutputFD(ret->cmd, fd);\n        virCommandAddArg(ret->cmd, \"1\");\n    } else {\n        virCommandSetInputFD(ret->cmd, *fd);\n        virCommandSetOutputFD(ret->cmd, &pipefd[1]);\n        virCommandAddArg(ret->cmd, \"0\");\n    }\n\n    /* In order to catch iohelper stderr, we must change\n     * iohelper's env so virLog functions print to stderr\n     */\n    virCommandAddEnvPair(ret->cmd, \"LIBVIRT_LOG_OUTPUTS\", \"1:stderr\");\n    virCommandSetErrorBuffer(ret->cmd, &ret->err_msg);\n    virCommandDoAsyncIO(ret->cmd);\n\n    if (virCommandRunAsync(ret->cmd, NULL) < 0)\n        goto error;\n\n    if (VIR_CLOSE(pipefd[!output]) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\", _(\"unable to close pipe\"));\n        goto error;\n    }\n\n    VIR_FORCE_CLOSE(*fd);\n    *fd = pipefd[output];\n    return ret;\n\n error:\n    VIR_FORCE_CLOSE(pipefd[0]);\n    VIR_FORCE_CLOSE(pipefd[1]);\n    virFileWrapperFdFree(ret);\n    return NULL;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virFileWrapperFdFree",
          "args": [
            "ret"
          ],
          "line": 319
        },
        "resolved": true,
        "details": {
          "function_name": "virFileWrapperFdFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "381-390",
          "snippet": "void\nvirFileWrapperFdFree(virFileWrapperFdPtr wfd)\n{\n    if (!wfd)\n        return;\n\n    VIR_FREE(wfd->err_msg);\n    virCommandFree(wfd->cmd);\n    VIR_FREE(wfd);\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nvoid\nvirFileWrapperFdFree(virFileWrapperFdPtr wfd)\n{\n    if (!wfd)\n        return;\n\n    VIR_FREE(wfd->err_msg);\n    virCommandFree(wfd->cmd);\n    VIR_FREE(wfd);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FORCE_CLOSE",
          "args": [
            "pipefd[1]"
          ],
          "line": 318
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FORCE_CLOSE",
          "args": [
            "pipefd[0]"
          ],
          "line": 317
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FORCE_CLOSE",
          "args": [
            "*fd"
          ],
          "line": 312
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"unable to close pipe\")"
          ],
          "line": 308
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"unable to close pipe\""
          ],
          "line": 308
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_CLOSE",
          "args": [
            "pipefd[!output]"
          ],
          "line": 307
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCommandRunAsync",
          "args": [
            "ret->cmd",
            "NULL"
          ],
          "line": 304
        },
        "resolved": true,
        "details": {
          "function_name": "virCommandRunAsync",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "2931-2937",
          "snippet": "int\nvirCommandRunAsync(virCommandPtr cmd G_GNUC_UNUSED, pid_t *pid G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Executing new processes is not supported on Win32 platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nint\nvirCommandRunAsync(virCommandPtr cmd G_GNUC_UNUSED, pid_t *pid G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Executing new processes is not supported on Win32 platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCommandDoAsyncIO",
          "args": [
            "ret->cmd"
          ],
          "line": 302
        },
        "resolved": true,
        "details": {
          "function_name": "virCommandDoAsyncIO",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "3084-3091",
          "snippet": "void\nvirCommandDoAsyncIO(virCommandPtr cmd)\n{\n    if (!cmd || cmd->has_error)\n        return;\n\n    cmd->flags |= VIR_EXEC_ASYNC_IO | VIR_EXEC_NONBLOCK;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nvoid\nvirCommandDoAsyncIO(virCommandPtr cmd)\n{\n    if (!cmd || cmd->has_error)\n        return;\n\n    cmd->flags |= VIR_EXEC_ASYNC_IO | VIR_EXEC_NONBLOCK;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCommandSetErrorBuffer",
          "args": [
            "ret->cmd",
            "&ret->err_msg"
          ],
          "line": 301
        },
        "resolved": true,
        "details": {
          "function_name": "virCommandSetErrorBuffer",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "1903-1918",
          "snippet": "void\nvirCommandSetErrorBuffer(virCommandPtr cmd, char **errbuf)\n{\n    *errbuf = NULL;\n    if (!cmd || cmd->has_error)\n        return;\n\n    if (cmd->errfdptr) {\n        cmd->has_error = -1;\n        VIR_DEBUG(\"cannot specify stderr twice\");\n        return;\n    }\n\n    cmd->errbuf = errbuf;\n    cmd->errfdptr = &cmd->errfd;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nvoid\nvirCommandSetErrorBuffer(virCommandPtr cmd, char **errbuf)\n{\n    *errbuf = NULL;\n    if (!cmd || cmd->has_error)\n        return;\n\n    if (cmd->errfdptr) {\n        cmd->has_error = -1;\n        VIR_DEBUG(\"cannot specify stderr twice\");\n        return;\n    }\n\n    cmd->errbuf = errbuf;\n    cmd->errfdptr = &cmd->errfd;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCommandAddEnvPair",
          "args": [
            "ret->cmd",
            "\"LIBVIRT_LOG_OUTPUTS\"",
            "\"1:stderr\""
          ],
          "line": 300
        },
        "resolved": true,
        "details": {
          "function_name": "virCommandAddEnvPair",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "1371-1375",
          "snippet": "void\nvirCommandAddEnvPair(virCommandPtr cmd, const char *name, const char *value)\n{\n    virCommandAddEnvFormat(cmd, \"%s=%s\", name, value);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nvoid\nvirCommandAddEnvPair(virCommandPtr cmd, const char *name, const char *value)\n{\n    virCommandAddEnvFormat(cmd, \"%s=%s\", name, value);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCommandAddArg",
          "args": [
            "ret->cmd",
            "\"0\""
          ],
          "line": 294
        },
        "resolved": true,
        "details": {
          "function_name": "virCommandAddArgList",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "1655-1684",
          "snippet": "void\nvirCommandAddArgList(virCommandPtr cmd, ...)\n{\n    va_list list;\n    int narg = 0;\n\n    if (!cmd || cmd->has_error)\n        return;\n\n    va_start(list, cmd);\n    while (va_arg(list, const char *) != NULL)\n        narg++;\n    va_end(list);\n\n    /* narg plus trailing NULL. */\n    if (VIR_RESIZE_N(cmd->args, cmd->maxargs, cmd->nargs, narg + 1) < 0) {\n        cmd->has_error = ENOMEM;\n        return;\n    }\n\n    va_start(list, cmd);\n    while (1) {\n        char *arg = va_arg(list, char *);\n        if (!arg)\n            break;\n        arg = g_strdup(arg);\n        cmd->args[cmd->nargs++] = arg;\n    }\n    va_end(list);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nvoid\nvirCommandAddArgList(virCommandPtr cmd, ...)\n{\n    va_list list;\n    int narg = 0;\n\n    if (!cmd || cmd->has_error)\n        return;\n\n    va_start(list, cmd);\n    while (va_arg(list, const char *) != NULL)\n        narg++;\n    va_end(list);\n\n    /* narg plus trailing NULL. */\n    if (VIR_RESIZE_N(cmd->args, cmd->maxargs, cmd->nargs, narg + 1) < 0) {\n        cmd->has_error = ENOMEM;\n        return;\n    }\n\n    va_start(list, cmd);\n    while (1) {\n        char *arg = va_arg(list, char *);\n        if (!arg)\n            break;\n        arg = g_strdup(arg);\n        cmd->args[cmd->nargs++] = arg;\n    }\n    va_end(list);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCommandSetOutputFD",
          "args": [
            "ret->cmd",
            "&pipefd[1]"
          ],
          "line": 293
        },
        "resolved": true,
        "details": {
          "function_name": "virCommandSetOutputFD",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "1958-1971",
          "snippet": "void\nvirCommandSetOutputFD(virCommandPtr cmd, int *outfd)\n{\n    if (!cmd || cmd->has_error)\n        return;\n\n    if (cmd->outfdptr) {\n        cmd->has_error = -1;\n        VIR_DEBUG(\"cannot specify output twice\");\n        return;\n    }\n\n    cmd->outfdptr = outfd;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nvoid\nvirCommandSetOutputFD(virCommandPtr cmd, int *outfd)\n{\n    if (!cmd || cmd->has_error)\n        return;\n\n    if (cmd->outfdptr) {\n        cmd->has_error = -1;\n        VIR_DEBUG(\"cannot specify output twice\");\n        return;\n    }\n\n    cmd->outfdptr = outfd;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCommandSetInputFD",
          "args": [
            "ret->cmd",
            "*fd"
          ],
          "line": 292
        },
        "resolved": true,
        "details": {
          "function_name": "virCommandSetInputFD",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "1928-1946",
          "snippet": "void\nvirCommandSetInputFD(virCommandPtr cmd, int infd)\n{\n    if (!cmd || cmd->has_error)\n        return;\n\n    if (cmd->infd != -1 || cmd->inbuf) {\n        cmd->has_error = -1;\n        VIR_DEBUG(\"cannot specify input twice\");\n        return;\n    }\n    if (infd < 0) {\n        cmd->has_error = -1;\n        VIR_DEBUG(\"cannot specify invalid input fd\");\n        return;\n    }\n\n    cmd->infd = infd;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nvoid\nvirCommandSetInputFD(virCommandPtr cmd, int infd)\n{\n    if (!cmd || cmd->has_error)\n        return;\n\n    if (cmd->infd != -1 || cmd->inbuf) {\n        cmd->has_error = -1;\n        VIR_DEBUG(\"cannot specify input twice\");\n        return;\n    }\n    if (infd < 0) {\n        cmd->has_error = -1;\n        VIR_DEBUG(\"cannot specify invalid input fd\");\n        return;\n    }\n\n    cmd->infd = infd;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCommandNewArgList",
          "args": [
            "iohelper_path",
            "name",
            "NULL"
          ],
          "line": 285
        },
        "resolved": true,
        "details": {
          "function_name": "virCommandNewArgList",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "969-980",
          "snippet": "virCommandPtr\nvirCommandNewArgList(const char *binary, ...)\n{\n    virCommandPtr cmd;\n    va_list list;\n\n    va_start(list, binary);\n    cmd = virCommandNewVAList(binary, list);\n    va_end(list);\n\n    return cmd;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nvirCommandPtr\nvirCommandNewArgList(const char *binary, ...)\n{\n    virCommandPtr cmd;\n    va_list list;\n\n    va_start(list, binary);\n    cmd = virCommandNewVAList(binary, list);\n    va_end(list);\n\n    return cmd;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virFileFindResource",
          "args": [
            "\"libvirt_iohelper\"",
            "abs_top_builddir \"/src\"",
            "LIBEXECDIR"
          ],
          "line": 280
        },
        "resolved": true,
        "details": {
          "function_name": "virFileFindResource",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1771-1777",
          "snippet": "char *\nvirFileFindResource(const char *filename,\n                    const char *builddir,\n                    const char *installdir)\n{\n    return virFileFindResourceFull(filename, NULL, NULL, builddir, installdir, NULL);\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nchar *\nvirFileFindResource(const char *filename,\n                    const char *builddir,\n                    const char *installdir)\n{\n    return virFileFindResourceFull(filename, NULL, NULL, builddir, installdir, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virPipe",
          "args": [
            "pipefd"
          ],
          "line": 277
        },
        "resolved": true,
        "details": {
          "function_name": "virPipeNonBlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
          "lines": "1813-1817",
          "snippet": "int\nvirPipeNonBlock(int fds[2])\n{\n    return virPipeImpl(fds, true, true);\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <sys/prctl.h>",
            "# include <cap-ng.h>",
            "# include <grp.h>",
            "# include <pwd.h>",
            "# include <libdevmapper.h>",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <conio.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nint\nvirPipeNonBlock(int fds[2])\n{\n    return virPipeImpl(fds, true, true);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"unexpected mode 0x%x for %s\")",
            "mode & O_ACCMODE",
            "name"
          ],
          "line": 272
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"invalid fd %d for %s\")",
            "*fd",
            "name"
          ],
          "line": 266
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fcntl",
          "args": [
            "*fd",
            "F_GETFL"
          ],
          "line": 263
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC",
          "args": [
            "ret"
          ],
          "line": 260
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"O_DIRECT unsupported on this platform\")"
          ],
          "line": 255
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"invalid use with no flags\")"
          ],
          "line": 242
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nvirFileWrapperFdPtr\nvirFileWrapperFdNew(int *fd, const char *name, unsigned int flags)\n{\n    virFileWrapperFdPtr ret = NULL;\n    bool output = false;\n    int pipefd[2] = { -1, -1 };\n    int mode = -1;\n    g_autofree char *iohelper_path = NULL;\n\n    if (!flags) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"invalid use with no flags\"));\n        return NULL;\n    }\n\n    /* XXX support posix_fadvise rather than O_DIRECT, if the kernel support\n     * for that is decent enough. In that case, we will also need to\n     * explicitly support VIR_FILE_WRAPPER_NON_BLOCKING since\n     * VIR_FILE_WRAPPER_BYPASS_CACHE alone will no longer require spawning\n     * iohelper.\n     */\n\n    if ((flags & VIR_FILE_WRAPPER_BYPASS_CACHE) && !O_DIRECT) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"O_DIRECT unsupported on this platform\"));\n        return NULL;\n    }\n\n    if (VIR_ALLOC(ret) < 0)\n        return NULL;\n\n    mode = fcntl(*fd, F_GETFL);\n\n    if (mode < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, _(\"invalid fd %d for %s\"),\n                       *fd, name);\n        goto error;\n    } else if ((mode & O_ACCMODE) == O_WRONLY) {\n        output = true;\n    } else if ((mode & O_ACCMODE) != O_RDONLY) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, _(\"unexpected mode 0x%x for %s\"),\n                       mode & O_ACCMODE, name);\n        goto error;\n    }\n\n    if (virPipe(pipefd) < 0)\n        goto error;\n\n    if (!(iohelper_path = virFileFindResource(\"libvirt_iohelper\",\n                                              abs_top_builddir \"/src\",\n                                              LIBEXECDIR)))\n        goto error;\n\n    ret->cmd = virCommandNewArgList(iohelper_path, name, NULL);\n\n    if (output) {\n        virCommandSetInputFD(ret->cmd, pipefd[0]);\n        virCommandSetOutputFD(ret->cmd, fd);\n        virCommandAddArg(ret->cmd, \"1\");\n    } else {\n        virCommandSetInputFD(ret->cmd, *fd);\n        virCommandSetOutputFD(ret->cmd, &pipefd[1]);\n        virCommandAddArg(ret->cmd, \"0\");\n    }\n\n    /* In order to catch iohelper stderr, we must change\n     * iohelper's env so virLog functions print to stderr\n     */\n    virCommandAddEnvPair(ret->cmd, \"LIBVIRT_LOG_OUTPUTS\", \"1:stderr\");\n    virCommandSetErrorBuffer(ret->cmd, &ret->err_msg);\n    virCommandDoAsyncIO(ret->cmd);\n\n    if (virCommandRunAsync(ret->cmd, NULL) < 0)\n        goto error;\n\n    if (VIR_CLOSE(pipefd[!output]) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\", _(\"unable to close pipe\"));\n        goto error;\n    }\n\n    VIR_FORCE_CLOSE(*fd);\n    *fd = pipefd[output];\n    return ret;\n\n error:\n    VIR_FORCE_CLOSE(pipefd[0]);\n    VIR_FORCE_CLOSE(pipefd[1]);\n    virFileWrapperFdFree(ret);\n    return NULL;\n}"
  },
  {
    "function_name": "virFileDirectFdFlag",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "188-194",
    "snippet": "int\nvirFileDirectFdFlag(void)\n{\n    /* XXX For now, Linux posix_fadvise is not powerful enough to\n     * avoid O_DIRECT.  */\n    return O_DIRECT ? O_DIRECT : -1;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileDirectFdFlag(void)\n{\n    /* XXX For now, Linux posix_fadvise is not powerful enough to\n     * avoid O_DIRECT.  */\n    return O_DIRECT ? O_DIRECT : -1;\n}"
  },
  {
    "function_name": "virFileFdopen",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "164-177",
    "snippet": "FILE *virFileFdopen(int *fdptr, const char *mode)\n{\n    FILE *file = NULL;\n\n    if (*fdptr >= 0) {\n        file = fdopen(*fdptr, mode);\n        if (file)\n            *fdptr = -1;\n    } else {\n        errno = EBADF;\n    }\n\n    return file;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fdopen",
          "args": [
            "*fdptr",
            "mode"
          ],
          "line": 169
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nFILE *virFileFdopen(int *fdptr, const char *mode)\n{\n    FILE *file = NULL;\n\n    if (*fdptr >= 0) {\n        file = fdopen(*fdptr, mode);\n        if (file)\n            *fdptr = -1;\n    } else {\n        errno = EBADF;\n    }\n\n    return file;\n}"
  },
  {
    "function_name": "virFileFclose",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "146-161",
    "snippet": "int virFileFclose(FILE **file, bool preserve_errno)\n{\n    int saved_errno = 0;\n    int rc = 0;\n\n    if (*file) {\n        if (preserve_errno)\n            saved_errno = errno;\n        rc = fclose(*file);\n        *file = NULL;\n        if (preserve_errno)\n            errno = saved_errno;\n    }\n\n    return rc;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fclose",
          "args": [
            "*file"
          ],
          "line": 154
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint virFileFclose(FILE **file, bool preserve_errno)\n{\n    int saved_errno = 0;\n    int rc = 0;\n\n    if (*file) {\n        if (preserve_errno)\n            saved_errno = errno;\n        rc = fclose(*file);\n        *file = NULL;\n        if (preserve_errno)\n            errno = saved_errno;\n    }\n\n    return rc;\n}"
  },
  {
    "function_name": "virFileClose",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
    "lines": "111-143",
    "snippet": "int virFileClose(int *fdptr, virFileCloseFlags flags)\n{\n    int saved_errno = 0;\n    int rc = 0;\n\n    if (*fdptr < 0)\n        return 0;\n\n    if (flags & VIR_FILE_CLOSE_PRESERVE_ERRNO)\n        saved_errno = errno;\n\n    rc = close(*fdptr);\n\n    if (!(flags & VIR_FILE_CLOSE_DONT_LOG)) {\n        if (rc < 0) {\n            if (errno == EBADF) {\n                if (!(flags & VIR_FILE_CLOSE_IGNORE_EBADF))\n                    VIR_WARN(\"Tried to close invalid fd %d\", *fdptr);\n            } else {\n                VIR_DEBUG(\"Failed to close fd %d: %s\",\n                          *fdptr, g_strerror(errno));\n            }\n        } else {\n            VIR_DEBUG(\"Closed fd %d\", *fdptr);\n        }\n    }\n    *fdptr = -1;\n\n    if (flags & VIR_FILE_CLOSE_PRESERVE_ERRNO)\n        errno = saved_errno;\n\n    return rc;\n}",
    "includes": [
      "#include \"virsocket.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virprocess.h\"",
      "#include \"virlog.h\"",
      "#include \"virkmod.h\"",
      "#include \"virfile.h\"",
      "#include \"virerror.h\"",
      "#include \"vircommand.h\"",
      "#include \"viralloc.h\"",
      "#include \"configmake.h\"",
      "# include <sys/xattr.h>",
      "# include <linux/cdrom.h>",
      "# include <sys/ioctl.h>",
      "#  include <linux/loop.h>",
      "# include <sys/statfs.h>",
      "#  include <linux/magic.h>",
      "#include <sys/file.h>",
      "# include <sys/acl.h>",
      "# include <sys/syscall.h>",
      "# include <sys/mman.h>",
      "# include <mntent.h>",
      "#include <dirent.h>",
      "#include <unistd.h>",
      "# include <sys/mount.h>",
      "#include <sys/stat.h>",
      "# include <libutil.h>",
      "# include <util.h>",
      "# include <pty.h>",
      "# include <termios.h>",
      "#include <fcntl.h>",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Closed fd %d\"",
            "*fdptr"
          ],
          "line": 134
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Failed to close fd %d: %s\"",
            "*fdptr",
            "g_strerror(errno)"
          ],
          "line": 130
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strerror",
          "args": [
            "errno"
          ],
          "line": 131
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_WARN",
          "args": [
            "\"Tried to close invalid fd %d\"",
            "*fdptr"
          ],
          "line": 128
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "close",
          "args": [
            "*fdptr"
          ],
          "line": 122
        },
        "resolved": true,
        "details": {
          "function_name": "vir_closesocket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsocket.c",
          "lines": "197-213",
          "snippet": "int\nvir_closesocket(int fd)\n{\n    SOCKET sk = FD2SK(fd);\n\n    if (sk == INVALID_SOCKET) {\n        errno = EBADF;\n        return -1;\n    }\n\n    if (closesocket(sk) < 0) {\n        set_errno();\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include <fcntl.h>",
            "#include \"virfile.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <fcntl.h>\n#include \"virfile.h\"\n#include \"virutil.h\"\n#include \"virsocket.h\"\n#include <config.h>\n\nint\nvir_closesocket(int fd)\n{\n    SOCKET sk = FD2SK(fd);\n\n    if (sk == INVALID_SOCKET) {\n        errno = EBADF;\n        return -1;\n    }\n\n    if (closesocket(sk) < 0) {\n        set_errno();\n        return -1;\n    }\n\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint virFileClose(int *fdptr, virFileCloseFlags flags)\n{\n    int saved_errno = 0;\n    int rc = 0;\n\n    if (*fdptr < 0)\n        return 0;\n\n    if (flags & VIR_FILE_CLOSE_PRESERVE_ERRNO)\n        saved_errno = errno;\n\n    rc = close(*fdptr);\n\n    if (!(flags & VIR_FILE_CLOSE_DONT_LOG)) {\n        if (rc < 0) {\n            if (errno == EBADF) {\n                if (!(flags & VIR_FILE_CLOSE_IGNORE_EBADF))\n                    VIR_WARN(\"Tried to close invalid fd %d\", *fdptr);\n            } else {\n                VIR_DEBUG(\"Failed to close fd %d: %s\",\n                          *fdptr, g_strerror(errno));\n            }\n        } else {\n            VIR_DEBUG(\"Closed fd %d\", *fdptr);\n        }\n    }\n    *fdptr = -1;\n\n    if (flags & VIR_FILE_CLOSE_PRESERVE_ERRNO)\n        errno = saved_errno;\n\n    return rc;\n}"
  }
]