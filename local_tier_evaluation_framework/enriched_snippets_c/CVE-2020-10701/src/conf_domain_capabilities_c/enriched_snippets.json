[
  {
    "function_name": "virDomainCapsDeviceDefValidate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_capabilities.c",
    "lines": "669-712",
    "snippet": "int\nvirDomainCapsDeviceDefValidate(const virDomainCaps *caps,\n                               const virDomainDeviceDef *dev,\n                               const virDomainDef *def G_GNUC_UNUSED)\n{\n    int ret = 0;\n\n    switch ((virDomainDeviceType) dev->type) {\n    case VIR_DOMAIN_DEVICE_RNG:\n        ret = virDomainCapsDeviceRNGDefValidate(caps, dev->data.rng);\n        break;\n    case VIR_DOMAIN_DEVICE_VIDEO:\n        ret = virDomainCapsDeviceVideoDefValidate(caps, dev->data.video);\n        break;\n\n    case VIR_DOMAIN_DEVICE_DISK:\n    case VIR_DOMAIN_DEVICE_REDIRDEV:\n    case VIR_DOMAIN_DEVICE_NET:\n    case VIR_DOMAIN_DEVICE_CONTROLLER:\n    case VIR_DOMAIN_DEVICE_CHR:\n    case VIR_DOMAIN_DEVICE_SMARTCARD:\n    case VIR_DOMAIN_DEVICE_HOSTDEV:\n    case VIR_DOMAIN_DEVICE_MEMORY:\n    case VIR_DOMAIN_DEVICE_VSOCK:\n    case VIR_DOMAIN_DEVICE_INPUT:\n    case VIR_DOMAIN_DEVICE_SHMEM:\n    case VIR_DOMAIN_DEVICE_LEASE:\n    case VIR_DOMAIN_DEVICE_FS:\n    case VIR_DOMAIN_DEVICE_SOUND:\n    case VIR_DOMAIN_DEVICE_WATCHDOG:\n    case VIR_DOMAIN_DEVICE_GRAPHICS:\n    case VIR_DOMAIN_DEVICE_HUB:\n    case VIR_DOMAIN_DEVICE_MEMBALLOON:\n    case VIR_DOMAIN_DEVICE_NVRAM:\n    case VIR_DOMAIN_DEVICE_TPM:\n    case VIR_DOMAIN_DEVICE_PANIC:\n    case VIR_DOMAIN_DEVICE_IOMMU:\n    case VIR_DOMAIN_DEVICE_NONE:\n    case VIR_DOMAIN_DEVICE_LAST:\n        break;\n    }\n\n    return ret;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"domain_conf.h\"",
      "#include \"domain_capabilities.h\"",
      "#include \"device_conf.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainCapsDeviceVideoDefValidate",
          "args": [
            "caps",
            "dev->data.video"
          ],
          "line": 681
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainCapsDeviceVideoDefValidate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_capabilities.c",
          "lines": "655-666",
          "snippet": "static int\nvirDomainCapsDeviceVideoDefValidate(const virDomainCaps *caps,\n                                    const virDomainVideoDef *dev)\n{\n    if (ENUM_VALUE_MISSING(caps->video.modelType, dev->type)) {\n        ENUM_VALUE_ERROR(\"video model\",\n                         virDomainVideoTypeToString(dev->type));\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_capabilities.h\"",
            "#include \"device_conf.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"domain_conf.h\"\n#include \"domain_capabilities.h\"\n#include \"device_conf.h\"\n#include <config.h>\n\nstatic int\nvirDomainCapsDeviceVideoDefValidate(const virDomainCaps *caps,\n                                    const virDomainVideoDef *dev)\n{\n    if (ENUM_VALUE_MISSING(caps->video.modelType, dev->type)) {\n        ENUM_VALUE_ERROR(\"video model\",\n                         virDomainVideoTypeToString(dev->type));\n        return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainCapsDeviceRNGDefValidate",
          "args": [
            "caps",
            "dev->data.rng"
          ],
          "line": 678
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainCapsDeviceRNGDefValidate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_capabilities.c",
          "lines": "641-652",
          "snippet": "static int\nvirDomainCapsDeviceRNGDefValidate(const virDomainCaps *caps,\n                                  const virDomainRNGDef *dev)\n{\n    if (ENUM_VALUE_MISSING(caps->rng.model, dev->model)) {\n        ENUM_VALUE_ERROR(\"rng model\",\n                         virDomainRNGModelTypeToString(dev->model));\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_capabilities.h\"",
            "#include \"device_conf.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"domain_conf.h\"\n#include \"domain_capabilities.h\"\n#include \"device_conf.h\"\n#include <config.h>\n\nstatic int\nvirDomainCapsDeviceRNGDefValidate(const virDomainCaps *caps,\n                                  const virDomainRNGDef *dev)\n{\n    if (ENUM_VALUE_MISSING(caps->rng.model, dev->model)) {\n        ENUM_VALUE_ERROR(\"rng model\",\n                         virDomainRNGModelTypeToString(dev->model));\n        return -1;\n    }\n\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"domain_conf.h\"\n#include \"domain_capabilities.h\"\n#include \"device_conf.h\"\n#include <config.h>\n\nint\nvirDomainCapsDeviceDefValidate(const virDomainCaps *caps,\n                               const virDomainDeviceDef *dev,\n                               const virDomainDef *def G_GNUC_UNUSED)\n{\n    int ret = 0;\n\n    switch ((virDomainDeviceType) dev->type) {\n    case VIR_DOMAIN_DEVICE_RNG:\n        ret = virDomainCapsDeviceRNGDefValidate(caps, dev->data.rng);\n        break;\n    case VIR_DOMAIN_DEVICE_VIDEO:\n        ret = virDomainCapsDeviceVideoDefValidate(caps, dev->data.video);\n        break;\n\n    case VIR_DOMAIN_DEVICE_DISK:\n    case VIR_DOMAIN_DEVICE_REDIRDEV:\n    case VIR_DOMAIN_DEVICE_NET:\n    case VIR_DOMAIN_DEVICE_CONTROLLER:\n    case VIR_DOMAIN_DEVICE_CHR:\n    case VIR_DOMAIN_DEVICE_SMARTCARD:\n    case VIR_DOMAIN_DEVICE_HOSTDEV:\n    case VIR_DOMAIN_DEVICE_MEMORY:\n    case VIR_DOMAIN_DEVICE_VSOCK:\n    case VIR_DOMAIN_DEVICE_INPUT:\n    case VIR_DOMAIN_DEVICE_SHMEM:\n    case VIR_DOMAIN_DEVICE_LEASE:\n    case VIR_DOMAIN_DEVICE_FS:\n    case VIR_DOMAIN_DEVICE_SOUND:\n    case VIR_DOMAIN_DEVICE_WATCHDOG:\n    case VIR_DOMAIN_DEVICE_GRAPHICS:\n    case VIR_DOMAIN_DEVICE_HUB:\n    case VIR_DOMAIN_DEVICE_MEMBALLOON:\n    case VIR_DOMAIN_DEVICE_NVRAM:\n    case VIR_DOMAIN_DEVICE_TPM:\n    case VIR_DOMAIN_DEVICE_PANIC:\n    case VIR_DOMAIN_DEVICE_IOMMU:\n    case VIR_DOMAIN_DEVICE_NONE:\n    case VIR_DOMAIN_DEVICE_LAST:\n        break;\n    }\n\n    return ret;\n}"
  },
  {
    "function_name": "virDomainCapsDeviceVideoDefValidate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_capabilities.c",
    "lines": "655-666",
    "snippet": "static int\nvirDomainCapsDeviceVideoDefValidate(const virDomainCaps *caps,\n                                    const virDomainVideoDef *dev)\n{\n    if (ENUM_VALUE_MISSING(caps->video.modelType, dev->type)) {\n        ENUM_VALUE_ERROR(\"video model\",\n                         virDomainVideoTypeToString(dev->type));\n        return -1;\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"domain_conf.h\"",
      "#include \"domain_capabilities.h\"",
      "#include \"device_conf.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ENUM_VALUE_ERROR",
          "args": [
            "\"video model\"",
            "virDomainVideoTypeToString(dev->type)"
          ],
          "line": 660
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainVideoTypeToString",
          "args": [
            "dev->type"
          ],
          "line": 661
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ENUM_VALUE_MISSING",
          "args": [
            "caps->video.modelType",
            "dev->type"
          ],
          "line": 659
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"domain_conf.h\"\n#include \"domain_capabilities.h\"\n#include \"device_conf.h\"\n#include <config.h>\n\nstatic int\nvirDomainCapsDeviceVideoDefValidate(const virDomainCaps *caps,\n                                    const virDomainVideoDef *dev)\n{\n    if (ENUM_VALUE_MISSING(caps->video.modelType, dev->type)) {\n        ENUM_VALUE_ERROR(\"video model\",\n                         virDomainVideoTypeToString(dev->type));\n        return -1;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virDomainCapsDeviceRNGDefValidate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_capabilities.c",
    "lines": "641-652",
    "snippet": "static int\nvirDomainCapsDeviceRNGDefValidate(const virDomainCaps *caps,\n                                  const virDomainRNGDef *dev)\n{\n    if (ENUM_VALUE_MISSING(caps->rng.model, dev->model)) {\n        ENUM_VALUE_ERROR(\"rng model\",\n                         virDomainRNGModelTypeToString(dev->model));\n        return -1;\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"domain_conf.h\"",
      "#include \"domain_capabilities.h\"",
      "#include \"device_conf.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ENUM_VALUE_ERROR",
          "args": [
            "\"rng model\"",
            "virDomainRNGModelTypeToString(dev->model)"
          ],
          "line": 646
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainRNGModelTypeToString",
          "args": [
            "dev->model"
          ],
          "line": 647
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ENUM_VALUE_MISSING",
          "args": [
            "caps->rng.model",
            "dev->model"
          ],
          "line": 645
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"domain_conf.h\"\n#include \"domain_capabilities.h\"\n#include \"device_conf.h\"\n#include <config.h>\n\nstatic int\nvirDomainCapsDeviceRNGDefValidate(const virDomainCaps *caps,\n                                  const virDomainRNGDef *dev)\n{\n    if (ENUM_VALUE_MISSING(caps->rng.model, dev->model)) {\n        ENUM_VALUE_ERROR(\"rng model\",\n                         virDomainRNGModelTypeToString(dev->model));\n        return -1;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virDomainCapsFormat",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_capabilities.c",
    "lines": "585-628",
    "snippet": "char *\nvirDomainCapsFormat(const virDomainCaps *caps)\n{\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n    const char *virttype_str = virDomainVirtTypeToString(caps->virttype);\n    const char *arch_str = virArchToString(caps->arch);\n\n    virBufferAddLit(&buf, \"<domainCapabilities>\\n\");\n    virBufferAdjustIndent(&buf, 2);\n\n    virBufferEscapeString(&buf, \"<path>%s</path>\\n\", caps->path);\n    virBufferAsprintf(&buf, \"<domain>%s</domain>\\n\", virttype_str);\n    if (caps->machine)\n        virBufferAsprintf(&buf, \"<machine>%s</machine>\\n\", caps->machine);\n    virBufferAsprintf(&buf, \"<arch>%s</arch>\\n\", arch_str);\n\n    if (caps->maxvcpus)\n        virBufferAsprintf(&buf, \"<vcpu max='%d'/>\\n\", caps->maxvcpus);\n\n    qemuDomainCapsFeatureFormatSimple(&buf, \"iothreads\",\n                                      caps->features[VIR_DOMAIN_CAPS_FEATURE_IOTHREADS]);\n\n    virDomainCapsOSFormat(&buf, &caps->os);\n    virDomainCapsCPUFormat(&buf, &caps->cpu);\n\n    virBufferAddLit(&buf, \"<devices>\\n\");\n    virBufferAdjustIndent(&buf, 2);\n\n    virDomainCapsDeviceDiskFormat(&buf, &caps->disk);\n    virDomainCapsDeviceGraphicsFormat(&buf, &caps->graphics);\n    virDomainCapsDeviceVideoFormat(&buf, &caps->video);\n    virDomainCapsDeviceHostdevFormat(&buf, &caps->hostdev);\n    virDomainCapsDeviceRNGFormat(&buf, &caps->rng);\n\n    virBufferAdjustIndent(&buf, -2);\n    virBufferAddLit(&buf, \"</devices>\\n\");\n\n    virDomainCapsFormatFeatures(caps, &buf);\n\n    virBufferAdjustIndent(&buf, -2);\n    virBufferAddLit(&buf, \"</domainCapabilities>\\n\");\n\n    return virBufferContentAndReset(&buf);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"domain_conf.h\"",
      "#include \"domain_capabilities.h\"",
      "#include \"device_conf.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virBufferContentAndReset",
          "args": [
            "&buf"
          ],
          "line": 627
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferContentAndReset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "247-260",
          "snippet": "char *\nvirBufferContentAndReset(virBufferPtr buf)\n{\n    char *str = NULL;\n\n    if (!buf)\n        return NULL;\n\n    if (buf->str)\n        str = g_string_free(buf->str, false);\n\n    memset(buf, 0, sizeof(*buf));\n    return str;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nchar *\nvirBufferContentAndReset(virBufferPtr buf)\n{\n    char *str = NULL;\n\n    if (!buf)\n        return NULL;\n\n    if (buf->str)\n        str = g_string_free(buf->str, false);\n\n    memset(buf, 0, sizeof(*buf));\n    return str;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "&buf",
            "\"</domainCapabilities>\\n\""
          ],
          "line": 625
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBufferAdjustIndent",
          "args": [
            "&buf",
            "-2"
          ],
          "line": 624
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferAdjustIndent",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "43-62",
          "snippet": "void\nvirBufferAdjustIndent(virBufferPtr buf, int indent)\n{\n    if (!buf)\n        return;\n\n    if (indent > 0) {\n        if (INT_MAX - indent < buf->indent) {\n            buf->indent = INT_MAX;\n            return;\n        }\n    } else {\n        if (buf->indent < -indent) {\n            buf->indent = 0;\n            return;\n        }\n    }\n\n    buf->indent += indent;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirBufferAdjustIndent(virBufferPtr buf, int indent)\n{\n    if (!buf)\n        return;\n\n    if (indent > 0) {\n        if (INT_MAX - indent < buf->indent) {\n            buf->indent = INT_MAX;\n            return;\n        }\n    } else {\n        if (buf->indent < -indent) {\n            buf->indent = 0;\n            return;\n        }\n    }\n\n    buf->indent += indent;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainCapsFormatFeatures",
          "args": [
            "caps",
            "&buf"
          ],
          "line": 622
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainCapsFormatFeatures",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_capabilities.c",
          "lines": "561-582",
          "snippet": "static void\nvirDomainCapsFormatFeatures(const virDomainCaps *caps,\n                            virBufferPtr buf)\n{\n    g_auto(virBuffer) childBuf = VIR_BUFFER_INIT_CHILD(buf);\n    size_t i;\n\n    virDomainCapsFeatureGICFormat(&childBuf, &caps->gic);\n\n    for (i = 0; i < VIR_DOMAIN_CAPS_FEATURE_LAST; i++) {\n        if (i == VIR_DOMAIN_CAPS_FEATURE_IOTHREADS)\n            continue;\n\n        qemuDomainCapsFeatureFormatSimple(&childBuf,\n                                          virDomainCapsFeatureTypeToString(i),\n                                          caps->features[i]);\n    }\n\n    virDomainCapsFeatureSEVFormat(&childBuf, caps->sev);\n\n    virXMLFormatElement(buf, \"features\", NULL, &childBuf);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_capabilities.h\"",
            "#include \"device_conf.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"domain_conf.h\"\n#include \"domain_capabilities.h\"\n#include \"device_conf.h\"\n#include <config.h>\n\nstatic void\nvirDomainCapsFormatFeatures(const virDomainCaps *caps,\n                            virBufferPtr buf)\n{\n    g_auto(virBuffer) childBuf = VIR_BUFFER_INIT_CHILD(buf);\n    size_t i;\n\n    virDomainCapsFeatureGICFormat(&childBuf, &caps->gic);\n\n    for (i = 0; i < VIR_DOMAIN_CAPS_FEATURE_LAST; i++) {\n        if (i == VIR_DOMAIN_CAPS_FEATURE_IOTHREADS)\n            continue;\n\n        qemuDomainCapsFeatureFormatSimple(&childBuf,\n                                          virDomainCapsFeatureTypeToString(i),\n                                          caps->features[i]);\n    }\n\n    virDomainCapsFeatureSEVFormat(&childBuf, caps->sev);\n\n    virXMLFormatElement(buf, \"features\", NULL, &childBuf);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "&buf",
            "\"</devices>\\n\""
          ],
          "line": 620
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainCapsDeviceRNGFormat",
          "args": [
            "&buf",
            "&caps->rng"
          ],
          "line": 617
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainCapsDeviceRNGFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_capabilities.c",
          "lines": "501-511",
          "snippet": "static void\nvirDomainCapsDeviceRNGFormat(virBufferPtr buf,\n                             const virDomainCapsDeviceRNG *rng)\n{\n    FORMAT_PROLOGUE(rng);\n\n    ENUM_PROCESS(rng, model, virDomainRNGModelTypeToString);\n    ENUM_PROCESS(rng, backendModel, virDomainRNGBackendTypeToString);\n\n    FORMAT_EPILOGUE(rng);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_capabilities.h\"",
            "#include \"device_conf.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"domain_conf.h\"\n#include \"domain_capabilities.h\"\n#include \"device_conf.h\"\n#include <config.h>\n\nstatic void\nvirDomainCapsDeviceRNGFormat(virBufferPtr buf,\n                             const virDomainCapsDeviceRNG *rng)\n{\n    FORMAT_PROLOGUE(rng);\n\n    ENUM_PROCESS(rng, model, virDomainRNGModelTypeToString);\n    ENUM_PROCESS(rng, backendModel, virDomainRNGBackendTypeToString);\n\n    FORMAT_EPILOGUE(rng);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainCapsDeviceHostdevFormat",
          "args": [
            "&buf",
            "&caps->hostdev"
          ],
          "line": 616
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainCapsDeviceHostdevFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_capabilities.c",
          "lines": "485-498",
          "snippet": "static void\nvirDomainCapsDeviceHostdevFormat(virBufferPtr buf,\n                                 const virDomainCapsDeviceHostdev *hostdev)\n{\n    FORMAT_PROLOGUE(hostdev);\n\n    ENUM_PROCESS(hostdev, mode, virDomainHostdevModeTypeToString);\n    ENUM_PROCESS(hostdev, startupPolicy, virDomainStartupPolicyTypeToString);\n    ENUM_PROCESS(hostdev, subsysType, virDomainHostdevSubsysTypeToString);\n    ENUM_PROCESS(hostdev, capsType, virDomainHostdevCapsTypeToString);\n    ENUM_PROCESS(hostdev, pciBackend, virDomainHostdevSubsysPCIBackendTypeToString);\n\n    FORMAT_EPILOGUE(hostdev);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_capabilities.h\"",
            "#include \"device_conf.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"domain_conf.h\"\n#include \"domain_capabilities.h\"\n#include \"device_conf.h\"\n#include <config.h>\n\nstatic void\nvirDomainCapsDeviceHostdevFormat(virBufferPtr buf,\n                                 const virDomainCapsDeviceHostdev *hostdev)\n{\n    FORMAT_PROLOGUE(hostdev);\n\n    ENUM_PROCESS(hostdev, mode, virDomainHostdevModeTypeToString);\n    ENUM_PROCESS(hostdev, startupPolicy, virDomainStartupPolicyTypeToString);\n    ENUM_PROCESS(hostdev, subsysType, virDomainHostdevSubsysTypeToString);\n    ENUM_PROCESS(hostdev, capsType, virDomainHostdevCapsTypeToString);\n    ENUM_PROCESS(hostdev, pciBackend, virDomainHostdevSubsysPCIBackendTypeToString);\n\n    FORMAT_EPILOGUE(hostdev);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainCapsDeviceVideoFormat",
          "args": [
            "&buf",
            "&caps->video"
          ],
          "line": 615
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainCapsDeviceVideoFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_capabilities.c",
          "lines": "473-482",
          "snippet": "static void\nvirDomainCapsDeviceVideoFormat(virBufferPtr buf,\n                               const virDomainCapsDeviceVideo *video)\n{\n    FORMAT_PROLOGUE(video);\n\n    ENUM_PROCESS(video, modelType, virDomainVideoTypeToString);\n\n    FORMAT_EPILOGUE(video);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_capabilities.h\"",
            "#include \"device_conf.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"domain_conf.h\"\n#include \"domain_capabilities.h\"\n#include \"device_conf.h\"\n#include <config.h>\n\nstatic void\nvirDomainCapsDeviceVideoFormat(virBufferPtr buf,\n                               const virDomainCapsDeviceVideo *video)\n{\n    FORMAT_PROLOGUE(video);\n\n    ENUM_PROCESS(video, modelType, virDomainVideoTypeToString);\n\n    FORMAT_EPILOGUE(video);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainCapsDeviceGraphicsFormat",
          "args": [
            "&buf",
            "&caps->graphics"
          ],
          "line": 614
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainCapsDeviceGraphicsFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_capabilities.c",
          "lines": "461-470",
          "snippet": "static void\nvirDomainCapsDeviceGraphicsFormat(virBufferPtr buf,\n                                  const virDomainCapsDeviceGraphics *graphics)\n{\n    FORMAT_PROLOGUE(graphics);\n\n    ENUM_PROCESS(graphics, type, virDomainGraphicsTypeToString);\n\n    FORMAT_EPILOGUE(graphics);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_capabilities.h\"",
            "#include \"device_conf.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"domain_conf.h\"\n#include \"domain_capabilities.h\"\n#include \"device_conf.h\"\n#include <config.h>\n\nstatic void\nvirDomainCapsDeviceGraphicsFormat(virBufferPtr buf,\n                                  const virDomainCapsDeviceGraphics *graphics)\n{\n    FORMAT_PROLOGUE(graphics);\n\n    ENUM_PROCESS(graphics, type, virDomainGraphicsTypeToString);\n\n    FORMAT_EPILOGUE(graphics);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainCapsDeviceDiskFormat",
          "args": [
            "&buf",
            "&caps->disk"
          ],
          "line": 613
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainCapsDeviceDiskFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_capabilities.c",
          "lines": "447-458",
          "snippet": "static void\nvirDomainCapsDeviceDiskFormat(virBufferPtr buf,\n                              const virDomainCapsDeviceDisk *disk)\n{\n    FORMAT_PROLOGUE(disk);\n\n    ENUM_PROCESS(disk, diskDevice, virDomainDiskDeviceTypeToString);\n    ENUM_PROCESS(disk, bus, virDomainDiskBusTypeToString);\n    ENUM_PROCESS(disk, model, virDomainDiskModelTypeToString);\n\n    FORMAT_EPILOGUE(disk);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_capabilities.h\"",
            "#include \"device_conf.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"domain_conf.h\"\n#include \"domain_capabilities.h\"\n#include \"device_conf.h\"\n#include <config.h>\n\nstatic void\nvirDomainCapsDeviceDiskFormat(virBufferPtr buf,\n                              const virDomainCapsDeviceDisk *disk)\n{\n    FORMAT_PROLOGUE(disk);\n\n    ENUM_PROCESS(disk, diskDevice, virDomainDiskDeviceTypeToString);\n    ENUM_PROCESS(disk, bus, virDomainDiskBusTypeToString);\n    ENUM_PROCESS(disk, model, virDomainDiskModelTypeToString);\n\n    FORMAT_EPILOGUE(disk);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "&buf",
            "\"<devices>\\n\""
          ],
          "line": 610
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainCapsCPUFormat",
          "args": [
            "&buf",
            "&caps->cpu"
          ],
          "line": 608
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainCapsCPUFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_capabilities.c",
          "lines": "408-445",
          "snippet": "static void\nvirDomainCapsCPUFormat(virBufferPtr buf,\n                       const virDomainCapsCPU *cpu)\n{\n    virBufferAddLit(buf, \"<cpu>\\n\");\n    virBufferAdjustIndent(buf, 2);\n\n    virBufferAsprintf(buf, \"<mode name='%s' supported='%s'/>\\n\",\n                      virCPUModeTypeToString(VIR_CPU_MODE_HOST_PASSTHROUGH),\n                      cpu->hostPassthrough ? \"yes\" : \"no\");\n\n    virBufferAsprintf(buf, \"<mode name='%s' \",\n                      virCPUModeTypeToString(VIR_CPU_MODE_HOST_MODEL));\n    if (cpu->hostModel) {\n        virBufferAddLit(buf, \"supported='yes'>\\n\");\n        virBufferAdjustIndent(buf, 2);\n\n        virCPUDefFormatBuf(buf, cpu->hostModel);\n\n        virBufferAdjustIndent(buf, -2);\n        virBufferAddLit(buf, \"</mode>\\n\");\n    } else {\n        virBufferAddLit(buf, \"supported='no'/>\\n\");\n    }\n\n    virBufferAsprintf(buf, \"<mode name='%s' \",\n                      virCPUModeTypeToString(VIR_CPU_MODE_CUSTOM));\n    if (cpu->custom && cpu->custom->nmodels) {\n        virBufferAddLit(buf, \"supported='yes'>\\n\");\n        virDomainCapsCPUCustomFormat(buf, cpu->custom);\n        virBufferAddLit(buf, \"</mode>\\n\");\n    } else {\n        virBufferAddLit(buf, \"supported='no'/>\\n\");\n    }\n\n    virBufferAdjustIndent(buf, -2);\n    virBufferAddLit(buf, \"</cpu>\\n\");\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_capabilities.h\"",
            "#include \"device_conf.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"domain_conf.h\"\n#include \"domain_capabilities.h\"\n#include \"device_conf.h\"\n#include <config.h>\n\nstatic void\nvirDomainCapsCPUFormat(virBufferPtr buf,\n                       const virDomainCapsCPU *cpu)\n{\n    virBufferAddLit(buf, \"<cpu>\\n\");\n    virBufferAdjustIndent(buf, 2);\n\n    virBufferAsprintf(buf, \"<mode name='%s' supported='%s'/>\\n\",\n                      virCPUModeTypeToString(VIR_CPU_MODE_HOST_PASSTHROUGH),\n                      cpu->hostPassthrough ? \"yes\" : \"no\");\n\n    virBufferAsprintf(buf, \"<mode name='%s' \",\n                      virCPUModeTypeToString(VIR_CPU_MODE_HOST_MODEL));\n    if (cpu->hostModel) {\n        virBufferAddLit(buf, \"supported='yes'>\\n\");\n        virBufferAdjustIndent(buf, 2);\n\n        virCPUDefFormatBuf(buf, cpu->hostModel);\n\n        virBufferAdjustIndent(buf, -2);\n        virBufferAddLit(buf, \"</mode>\\n\");\n    } else {\n        virBufferAddLit(buf, \"supported='no'/>\\n\");\n    }\n\n    virBufferAsprintf(buf, \"<mode name='%s' \",\n                      virCPUModeTypeToString(VIR_CPU_MODE_CUSTOM));\n    if (cpu->custom && cpu->custom->nmodels) {\n        virBufferAddLit(buf, \"supported='yes'>\\n\");\n        virDomainCapsCPUCustomFormat(buf, cpu->custom);\n        virBufferAddLit(buf, \"</mode>\\n\");\n    } else {\n        virBufferAddLit(buf, \"supported='no'/>\\n\");\n    }\n\n    virBufferAdjustIndent(buf, -2);\n    virBufferAddLit(buf, \"</cpu>\\n\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainCapsOSFormat",
          "args": [
            "&buf",
            "&caps->os"
          ],
          "line": 607
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainCapsOSFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_capabilities.c",
          "lines": "375-388",
          "snippet": "static void\nvirDomainCapsOSFormat(virBufferPtr buf,\n                      const virDomainCapsOS *os)\n{\n    const virDomainCapsLoader *loader = &os->loader;\n\n    FORMAT_PROLOGUE(os);\n\n    ENUM_PROCESS(os, firmware, virDomainOsDefFirmwareTypeToString);\n\n    virDomainCapsLoaderFormat(buf, loader);\n\n    FORMAT_EPILOGUE(os);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_capabilities.h\"",
            "#include \"device_conf.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"domain_conf.h\"\n#include \"domain_capabilities.h\"\n#include \"device_conf.h\"\n#include <config.h>\n\nstatic void\nvirDomainCapsOSFormat(virBufferPtr buf,\n                      const virDomainCapsOS *os)\n{\n    const virDomainCapsLoader *loader = &os->loader;\n\n    FORMAT_PROLOGUE(os);\n\n    ENUM_PROCESS(os, firmware, virDomainOsDefFirmwareTypeToString);\n\n    virDomainCapsLoaderFormat(buf, loader);\n\n    FORMAT_EPILOGUE(os);\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuDomainCapsFeatureFormatSimple",
          "args": [
            "&buf",
            "\"iothreads\"",
            "caps->features[VIR_DOMAIN_CAPS_FEATURE_IOTHREADS]"
          ],
          "line": 604
        },
        "resolved": true,
        "details": {
          "function_name": "qemuDomainCapsFeatureFormatSimple",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_capabilities.c",
          "lines": "348-358",
          "snippet": "static void\nqemuDomainCapsFeatureFormatSimple(virBufferPtr buf,\n                                  const char *featurename,\n                                  virTristateBool supported)\n{\n    if (supported == VIR_TRISTATE_BOOL_ABSENT)\n        return;\n\n    virBufferAsprintf(buf, \"<%s supported='%s'/>\\n\", featurename,\n                      virTristateBoolTypeToString(supported));\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_capabilities.h\"",
            "#include \"device_conf.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"domain_conf.h\"\n#include \"domain_capabilities.h\"\n#include \"device_conf.h\"\n#include <config.h>\n\nstatic void\nqemuDomainCapsFeatureFormatSimple(virBufferPtr buf,\n                                  const char *featurename,\n                                  virTristateBool supported)\n{\n    if (supported == VIR_TRISTATE_BOOL_ABSENT)\n        return;\n\n    virBufferAsprintf(buf, \"<%s supported='%s'/>\\n\", featurename,\n                      virTristateBoolTypeToString(supported));\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferAsprintf",
          "args": [
            "&buf",
            "\"<vcpu max='%d'/>\\n\"",
            "caps->maxvcpus"
          ],
          "line": 602
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferAsprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "302-309",
          "snippet": "void\nvirBufferAsprintf(virBufferPtr buf, const char *format, ...)\n{\n    va_list argptr;\n    va_start(argptr, format);\n    virBufferVasprintf(buf, format, argptr);\n    va_end(argptr);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirBufferAsprintf(virBufferPtr buf, const char *format, ...)\n{\n    va_list argptr;\n    va_start(argptr, format);\n    virBufferVasprintf(buf, format, argptr);\n    va_end(argptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferEscapeString",
          "args": [
            "&buf",
            "\"<path>%s</path>\\n\"",
            "caps->path"
          ],
          "line": 595
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferEscapeString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "343-418",
          "snippet": "void\nvirBufferEscapeString(virBufferPtr buf, const char *format, const char *str)\n{\n    int len;\n    g_autofree char *escaped = NULL;\n    char *out;\n    const char *cur;\n    const char forbidden_characters[] = {\n        0x01,   0x02,   0x03,   0x04,   0x05,   0x06,   0x07,   0x08,\n        /*\\t*/  /*\\n*/  0x0B,   0x0C,   /*\\r*/  0x0E,   0x0F,   0x10,\n        0x11,   0x12,   0x13,   0x14,   0x15,   0x16,   0x17,   0x18,\n        0x19,   '\"',    '&',    '\\'',   '<',    '>',\n        '\\0'\n    };\n\n    if ((format == NULL) || (buf == NULL) || (str == NULL))\n        return;\n\n    len = strlen(str);\n    if (strcspn(str, forbidden_characters) == len) {\n        virBufferAsprintf(buf, format, str);\n        return;\n    }\n\n    escaped = g_malloc0_n(len + 1, 6);\n\n    cur = str;\n    out = escaped;\n    while (*cur != 0) {\n        if (*cur == '<') {\n            *out++ = '&';\n            *out++ = 'l';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '>') {\n            *out++ = '&';\n            *out++ = 'g';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '&') {\n            *out++ = '&';\n            *out++ = 'a';\n            *out++ = 'm';\n            *out++ = 'p';\n            *out++ = ';';\n        } else if (*cur == '\"') {\n            *out++ = '&';\n            *out++ = 'q';\n            *out++ = 'u';\n            *out++ = 'o';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '\\'') {\n            *out++ = '&';\n            *out++ = 'a';\n            *out++ = 'p';\n            *out++ = 'o';\n            *out++ = 's';\n            *out++ = ';';\n        } else if (!strchr(forbidden_characters, *cur)) {\n            /*\n             * default case, just copy !\n             * Note that character over 0x80 are likely to give problem\n             * with UTF-8 XML, but since our string don't have an encoding\n             * it's hard to handle properly we have to assume it's UTF-8 too\n             */\n            *out++ = *cur;\n        } else {\n            /* silently ignore control characters */\n        }\n        cur++;\n    }\n    *out = 0;\n\n    virBufferAsprintf(buf, format, escaped);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirBufferEscapeString(virBufferPtr buf, const char *format, const char *str)\n{\n    int len;\n    g_autofree char *escaped = NULL;\n    char *out;\n    const char *cur;\n    const char forbidden_characters[] = {\n        0x01,   0x02,   0x03,   0x04,   0x05,   0x06,   0x07,   0x08,\n        /*\\t*/  /*\\n*/  0x0B,   0x0C,   /*\\r*/  0x0E,   0x0F,   0x10,\n        0x11,   0x12,   0x13,   0x14,   0x15,   0x16,   0x17,   0x18,\n        0x19,   '\"',    '&',    '\\'',   '<',    '>',\n        '\\0'\n    };\n\n    if ((format == NULL) || (buf == NULL) || (str == NULL))\n        return;\n\n    len = strlen(str);\n    if (strcspn(str, forbidden_characters) == len) {\n        virBufferAsprintf(buf, format, str);\n        return;\n    }\n\n    escaped = g_malloc0_n(len + 1, 6);\n\n    cur = str;\n    out = escaped;\n    while (*cur != 0) {\n        if (*cur == '<') {\n            *out++ = '&';\n            *out++ = 'l';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '>') {\n            *out++ = '&';\n            *out++ = 'g';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '&') {\n            *out++ = '&';\n            *out++ = 'a';\n            *out++ = 'm';\n            *out++ = 'p';\n            *out++ = ';';\n        } else if (*cur == '\"') {\n            *out++ = '&';\n            *out++ = 'q';\n            *out++ = 'u';\n            *out++ = 'o';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '\\'') {\n            *out++ = '&';\n            *out++ = 'a';\n            *out++ = 'p';\n            *out++ = 'o';\n            *out++ = 's';\n            *out++ = ';';\n        } else if (!strchr(forbidden_characters, *cur)) {\n            /*\n             * default case, just copy !\n             * Note that character over 0x80 are likely to give problem\n             * with UTF-8 XML, but since our string don't have an encoding\n             * it's hard to handle properly we have to assume it's UTF-8 too\n             */\n            *out++ = *cur;\n        } else {\n            /* silently ignore control characters */\n        }\n        cur++;\n    }\n    *out = 0;\n\n    virBufferAsprintf(buf, format, escaped);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "&buf",
            "\"<domainCapabilities>\\n\""
          ],
          "line": 592
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virArchToString",
          "args": [
            "caps->arch"
          ],
          "line": 590
        },
        "resolved": true,
        "details": {
          "function_name": "virArchToString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virarch.c",
          "lines": "126-132",
          "snippet": "const char *virArchToString(virArch arch)\n{\n    if (arch >= VIR_ARCH_LAST)\n        arch = VIR_ARCH_NONE;\n\n    return virArchData[arch].name;\n}",
          "includes": [
            "#include \"virarch.h\"",
            "#include \"virlog.h\"",
            "# include <sys/utsname.h>",
            "# include <windows.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static const struct virArchData {\n    const char *name;\n    unsigned int wordsize;\n    virArchEndian endian;\n} virArchData[] = {\n    { \"none\",          0, VIR_ARCH_LITTLE_ENDIAN },\n    { \"alpha\",        64, VIR_ARCH_BIG_ENDIAN },\n    { \"armv6l\",       32, VIR_ARCH_LITTLE_ENDIAN },\n    { \"armv7l\",       32, VIR_ARCH_LITTLE_ENDIAN },\n    { \"armv7b\",       32, VIR_ARCH_BIG_ENDIAN },\n\n    { \"aarch64\",      64, VIR_ARCH_LITTLE_ENDIAN },\n    { \"cris\",         32, VIR_ARCH_LITTLE_ENDIAN },\n    { \"i686\",         32, VIR_ARCH_LITTLE_ENDIAN },\n    { \"ia64\",         64, VIR_ARCH_LITTLE_ENDIAN },\n    { \"lm32\",         32, VIR_ARCH_BIG_ENDIAN },\n\n    { \"m68k\",         32, VIR_ARCH_BIG_ENDIAN },\n    { \"microblaze\",   32, VIR_ARCH_BIG_ENDIAN },\n    { \"microblazeel\", 32, VIR_ARCH_LITTLE_ENDIAN},\n    { \"mips\",         32, VIR_ARCH_BIG_ENDIAN },\n    { \"mipsel\",       32, VIR_ARCH_LITTLE_ENDIAN },\n\n    { \"mips64\",       64, VIR_ARCH_BIG_ENDIAN },\n    { \"mips64el\",     64, VIR_ARCH_LITTLE_ENDIAN },\n    { \"openrisc\",     32, VIR_ARCH_BIG_ENDIAN },\n    { \"parisc\",       32, VIR_ARCH_BIG_ENDIAN },\n    { \"parisc64\",     64, VIR_ARCH_BIG_ENDIAN },\n\n    { \"ppc\",          32, VIR_ARCH_BIG_ENDIAN },\n    { \"ppcle\",        32, VIR_ARCH_LITTLE_ENDIAN },\n    { \"ppc64\",        64, VIR_ARCH_BIG_ENDIAN },\n    { \"ppc64le\",      64, VIR_ARCH_LITTLE_ENDIAN },\n    { \"ppcemb\",       32, VIR_ARCH_BIG_ENDIAN },\n\n    { \"riscv32\",      32, VIR_ARCH_LITTLE_ENDIAN },\n    { \"riscv64\",      64, VIR_ARCH_LITTLE_ENDIAN },\n    { \"s390\",         32, VIR_ARCH_BIG_ENDIAN },\n    { \"s390x\",        64, VIR_ARCH_BIG_ENDIAN },\n    { \"sh4\",          32, VIR_ARCH_LITTLE_ENDIAN },\n\n    { \"sh4eb\",        64, VIR_ARCH_BIG_ENDIAN },\n    { \"sparc\",        32, VIR_ARCH_BIG_ENDIAN },\n    { \"sparc64\",      64, VIR_ARCH_BIG_ENDIAN },\n    { \"unicore32\",    32, VIR_ARCH_LITTLE_ENDIAN },\n    { \"x86_64\",       64, VIR_ARCH_LITTLE_ENDIAN },\n\n    { \"xtensa\",       32, VIR_ARCH_LITTLE_ENDIAN },\n    { \"xtensaeb\",     32, VIR_ARCH_BIG_ENDIAN },\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virarch.h\"\n#include \"virlog.h\"\n# include <sys/utsname.h>\n# include <windows.h>\n#include <config.h>\n\nstatic const struct virArchData {\n    const char *name;\n    unsigned int wordsize;\n    virArchEndian endian;\n} virArchData[] = {\n    { \"none\",          0, VIR_ARCH_LITTLE_ENDIAN },\n    { \"alpha\",        64, VIR_ARCH_BIG_ENDIAN },\n    { \"armv6l\",       32, VIR_ARCH_LITTLE_ENDIAN },\n    { \"armv7l\",       32, VIR_ARCH_LITTLE_ENDIAN },\n    { \"armv7b\",       32, VIR_ARCH_BIG_ENDIAN },\n\n    { \"aarch64\",      64, VIR_ARCH_LITTLE_ENDIAN },\n    { \"cris\",         32, VIR_ARCH_LITTLE_ENDIAN },\n    { \"i686\",         32, VIR_ARCH_LITTLE_ENDIAN },\n    { \"ia64\",         64, VIR_ARCH_LITTLE_ENDIAN },\n    { \"lm32\",         32, VIR_ARCH_BIG_ENDIAN },\n\n    { \"m68k\",         32, VIR_ARCH_BIG_ENDIAN },\n    { \"microblaze\",   32, VIR_ARCH_BIG_ENDIAN },\n    { \"microblazeel\", 32, VIR_ARCH_LITTLE_ENDIAN},\n    { \"mips\",         32, VIR_ARCH_BIG_ENDIAN },\n    { \"mipsel\",       32, VIR_ARCH_LITTLE_ENDIAN },\n\n    { \"mips64\",       64, VIR_ARCH_BIG_ENDIAN },\n    { \"mips64el\",     64, VIR_ARCH_LITTLE_ENDIAN },\n    { \"openrisc\",     32, VIR_ARCH_BIG_ENDIAN },\n    { \"parisc\",       32, VIR_ARCH_BIG_ENDIAN },\n    { \"parisc64\",     64, VIR_ARCH_BIG_ENDIAN },\n\n    { \"ppc\",          32, VIR_ARCH_BIG_ENDIAN },\n    { \"ppcle\",        32, VIR_ARCH_LITTLE_ENDIAN },\n    { \"ppc64\",        64, VIR_ARCH_BIG_ENDIAN },\n    { \"ppc64le\",      64, VIR_ARCH_LITTLE_ENDIAN },\n    { \"ppcemb\",       32, VIR_ARCH_BIG_ENDIAN },\n\n    { \"riscv32\",      32, VIR_ARCH_LITTLE_ENDIAN },\n    { \"riscv64\",      64, VIR_ARCH_LITTLE_ENDIAN },\n    { \"s390\",         32, VIR_ARCH_BIG_ENDIAN },\n    { \"s390x\",        64, VIR_ARCH_BIG_ENDIAN },\n    { \"sh4\",          32, VIR_ARCH_LITTLE_ENDIAN },\n\n    { \"sh4eb\",        64, VIR_ARCH_BIG_ENDIAN },\n    { \"sparc\",        32, VIR_ARCH_BIG_ENDIAN },\n    { \"sparc64\",      64, VIR_ARCH_BIG_ENDIAN },\n    { \"unicore32\",    32, VIR_ARCH_LITTLE_ENDIAN },\n    { \"x86_64\",       64, VIR_ARCH_LITTLE_ENDIAN },\n\n    { \"xtensa\",       32, VIR_ARCH_LITTLE_ENDIAN },\n    { \"xtensaeb\",     32, VIR_ARCH_BIG_ENDIAN },\n};\n\nconst char *virArchToString(virArch arch)\n{\n    if (arch >= VIR_ARCH_LAST)\n        arch = VIR_ARCH_NONE;\n\n    return virArchData[arch].name;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainVirtTypeToString",
          "args": [
            "caps->virttype"
          ],
          "line": 589
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"domain_conf.h\"\n#include \"domain_capabilities.h\"\n#include \"device_conf.h\"\n#include <config.h>\n\nchar *\nvirDomainCapsFormat(const virDomainCaps *caps)\n{\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n    const char *virttype_str = virDomainVirtTypeToString(caps->virttype);\n    const char *arch_str = virArchToString(caps->arch);\n\n    virBufferAddLit(&buf, \"<domainCapabilities>\\n\");\n    virBufferAdjustIndent(&buf, 2);\n\n    virBufferEscapeString(&buf, \"<path>%s</path>\\n\", caps->path);\n    virBufferAsprintf(&buf, \"<domain>%s</domain>\\n\", virttype_str);\n    if (caps->machine)\n        virBufferAsprintf(&buf, \"<machine>%s</machine>\\n\", caps->machine);\n    virBufferAsprintf(&buf, \"<arch>%s</arch>\\n\", arch_str);\n\n    if (caps->maxvcpus)\n        virBufferAsprintf(&buf, \"<vcpu max='%d'/>\\n\", caps->maxvcpus);\n\n    qemuDomainCapsFeatureFormatSimple(&buf, \"iothreads\",\n                                      caps->features[VIR_DOMAIN_CAPS_FEATURE_IOTHREADS]);\n\n    virDomainCapsOSFormat(&buf, &caps->os);\n    virDomainCapsCPUFormat(&buf, &caps->cpu);\n\n    virBufferAddLit(&buf, \"<devices>\\n\");\n    virBufferAdjustIndent(&buf, 2);\n\n    virDomainCapsDeviceDiskFormat(&buf, &caps->disk);\n    virDomainCapsDeviceGraphicsFormat(&buf, &caps->graphics);\n    virDomainCapsDeviceVideoFormat(&buf, &caps->video);\n    virDomainCapsDeviceHostdevFormat(&buf, &caps->hostdev);\n    virDomainCapsDeviceRNGFormat(&buf, &caps->rng);\n\n    virBufferAdjustIndent(&buf, -2);\n    virBufferAddLit(&buf, \"</devices>\\n\");\n\n    virDomainCapsFormatFeatures(caps, &buf);\n\n    virBufferAdjustIndent(&buf, -2);\n    virBufferAddLit(&buf, \"</domainCapabilities>\\n\");\n\n    return virBufferContentAndReset(&buf);\n}"
  },
  {
    "function_name": "virDomainCapsFormatFeatures",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_capabilities.c",
    "lines": "561-582",
    "snippet": "static void\nvirDomainCapsFormatFeatures(const virDomainCaps *caps,\n                            virBufferPtr buf)\n{\n    g_auto(virBuffer) childBuf = VIR_BUFFER_INIT_CHILD(buf);\n    size_t i;\n\n    virDomainCapsFeatureGICFormat(&childBuf, &caps->gic);\n\n    for (i = 0; i < VIR_DOMAIN_CAPS_FEATURE_LAST; i++) {\n        if (i == VIR_DOMAIN_CAPS_FEATURE_IOTHREADS)\n            continue;\n\n        qemuDomainCapsFeatureFormatSimple(&childBuf,\n                                          virDomainCapsFeatureTypeToString(i),\n                                          caps->features[i]);\n    }\n\n    virDomainCapsFeatureSEVFormat(&childBuf, caps->sev);\n\n    virXMLFormatElement(buf, \"features\", NULL, &childBuf);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"domain_conf.h\"",
      "#include \"domain_capabilities.h\"",
      "#include \"device_conf.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virXMLFormatElement",
          "args": [
            "buf",
            "\"features\"",
            "NULL",
            "&childBuf"
          ],
          "line": 581
        },
        "resolved": true,
        "details": {
          "function_name": "virXMLFormatElement",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
          "lines": "1374-1399",
          "snippet": "void\nvirXMLFormatElement(virBufferPtr buf,\n                    const char *name,\n                    virBufferPtr attrBuf,\n                    virBufferPtr childBuf)\n{\n    if ((!attrBuf || virBufferUse(attrBuf) == 0) &&\n        (!childBuf || virBufferUse(childBuf) == 0))\n        return;\n\n    virBufferAsprintf(buf, \"<%s\", name);\n\n    if (attrBuf && virBufferUse(attrBuf) > 0)\n        virBufferAddBuffer(buf, attrBuf);\n\n    if (childBuf && virBufferUse(childBuf) > 0) {\n        virBufferAddLit(buf, \">\\n\");\n        virBufferAddBuffer(buf, childBuf);\n        virBufferAsprintf(buf, \"</%s>\\n\", name);\n    } else {\n        virBufferAddLit(buf, \"/>\\n\");\n    }\n\n    virBufferFreeAndReset(attrBuf);\n    virBufferFreeAndReset(childBuf);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virxml.h\"",
            "#include \"virerror.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <sys/stat.h>",
            "#include <math.h>               /* for isnan() */",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirXMLFormatElement(virBufferPtr buf,\n                    const char *name,\n                    virBufferPtr attrBuf,\n                    virBufferPtr childBuf)\n{\n    if ((!attrBuf || virBufferUse(attrBuf) == 0) &&\n        (!childBuf || virBufferUse(childBuf) == 0))\n        return;\n\n    virBufferAsprintf(buf, \"<%s\", name);\n\n    if (attrBuf && virBufferUse(attrBuf) > 0)\n        virBufferAddBuffer(buf, attrBuf);\n\n    if (childBuf && virBufferUse(childBuf) > 0) {\n        virBufferAddLit(buf, \">\\n\");\n        virBufferAddBuffer(buf, childBuf);\n        virBufferAsprintf(buf, \"</%s>\\n\", name);\n    } else {\n        virBufferAddLit(buf, \"/>\\n\");\n    }\n\n    virBufferFreeAndReset(attrBuf);\n    virBufferFreeAndReset(childBuf);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainCapsFeatureSEVFormat",
          "args": [
            "&childBuf",
            "caps->sev"
          ],
          "line": 579
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainCapsFeatureSEVFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_capabilities.c",
          "lines": "541-558",
          "snippet": "static void\nvirDomainCapsFeatureSEVFormat(virBufferPtr buf,\n                              const virSEVCapability *sev)\n{\n    if (!sev) {\n        virBufferAddLit(buf, \"<sev supported='no'/>\\n\");\n    } else {\n        virBufferAddLit(buf, \"<sev supported='yes'>\\n\");\n        virBufferAdjustIndent(buf, 2);\n        virBufferAsprintf(buf, \"<cbitpos>%d</cbitpos>\\n\", sev->cbitpos);\n        virBufferAsprintf(buf, \"<reducedPhysBits>%d</reducedPhysBits>\\n\",\n                          sev->reduced_phys_bits);\n        virBufferAdjustIndent(buf, -2);\n        virBufferAddLit(buf, \"</sev>\\n\");\n    }\n\n    return;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_capabilities.h\"",
            "#include \"device_conf.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"domain_conf.h\"\n#include \"domain_capabilities.h\"\n#include \"device_conf.h\"\n#include <config.h>\n\nstatic void\nvirDomainCapsFeatureSEVFormat(virBufferPtr buf,\n                              const virSEVCapability *sev)\n{\n    if (!sev) {\n        virBufferAddLit(buf, \"<sev supported='no'/>\\n\");\n    } else {\n        virBufferAddLit(buf, \"<sev supported='yes'>\\n\");\n        virBufferAdjustIndent(buf, 2);\n        virBufferAsprintf(buf, \"<cbitpos>%d</cbitpos>\\n\", sev->cbitpos);\n        virBufferAsprintf(buf, \"<reducedPhysBits>%d</reducedPhysBits>\\n\",\n                          sev->reduced_phys_bits);\n        virBufferAdjustIndent(buf, -2);\n        virBufferAddLit(buf, \"</sev>\\n\");\n    }\n\n    return;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuDomainCapsFeatureFormatSimple",
          "args": [
            "&childBuf",
            "virDomainCapsFeatureTypeToString(i)",
            "caps->features[i]"
          ],
          "line": 574
        },
        "resolved": true,
        "details": {
          "function_name": "qemuDomainCapsFeatureFormatSimple",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_capabilities.c",
          "lines": "348-358",
          "snippet": "static void\nqemuDomainCapsFeatureFormatSimple(virBufferPtr buf,\n                                  const char *featurename,\n                                  virTristateBool supported)\n{\n    if (supported == VIR_TRISTATE_BOOL_ABSENT)\n        return;\n\n    virBufferAsprintf(buf, \"<%s supported='%s'/>\\n\", featurename,\n                      virTristateBoolTypeToString(supported));\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_capabilities.h\"",
            "#include \"device_conf.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"domain_conf.h\"\n#include \"domain_capabilities.h\"\n#include \"device_conf.h\"\n#include <config.h>\n\nstatic void\nqemuDomainCapsFeatureFormatSimple(virBufferPtr buf,\n                                  const char *featurename,\n                                  virTristateBool supported)\n{\n    if (supported == VIR_TRISTATE_BOOL_ABSENT)\n        return;\n\n    virBufferAsprintf(buf, \"<%s supported='%s'/>\\n\", featurename,\n                      virTristateBoolTypeToString(supported));\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainCapsFeatureTypeToString",
          "args": [
            "i"
          ],
          "line": 575
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainCapsFeatureGICFormat",
          "args": [
            "&childBuf",
            "&caps->gic"
          ],
          "line": 568
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainCapsFeatureGICFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_capabilities.c",
          "lines": "530-539",
          "snippet": "static void\nvirDomainCapsFeatureGICFormat(virBufferPtr buf,\n                              const virDomainCapsFeatureGIC *gic)\n{\n    FORMAT_PROLOGUE(gic);\n\n    ENUM_PROCESS(gic, version, virGICVersionTypeToString);\n\n    FORMAT_EPILOGUE(gic);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_capabilities.h\"",
            "#include \"device_conf.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"domain_conf.h\"\n#include \"domain_capabilities.h\"\n#include \"device_conf.h\"\n#include <config.h>\n\nstatic void\nvirDomainCapsFeatureGICFormat(virBufferPtr buf,\n                              const virDomainCapsFeatureGIC *gic)\n{\n    FORMAT_PROLOGUE(gic);\n\n    ENUM_PROCESS(gic, version, virGICVersionTypeToString);\n\n    FORMAT_EPILOGUE(gic);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_BUFFER_INIT_CHILD",
          "args": [
            "buf"
          ],
          "line": 565
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"domain_conf.h\"\n#include \"domain_capabilities.h\"\n#include \"device_conf.h\"\n#include <config.h>\n\nstatic void\nvirDomainCapsFormatFeatures(const virDomainCaps *caps,\n                            virBufferPtr buf)\n{\n    g_auto(virBuffer) childBuf = VIR_BUFFER_INIT_CHILD(buf);\n    size_t i;\n\n    virDomainCapsFeatureGICFormat(&childBuf, &caps->gic);\n\n    for (i = 0; i < VIR_DOMAIN_CAPS_FEATURE_LAST; i++) {\n        if (i == VIR_DOMAIN_CAPS_FEATURE_IOTHREADS)\n            continue;\n\n        qemuDomainCapsFeatureFormatSimple(&childBuf,\n                                          virDomainCapsFeatureTypeToString(i),\n                                          caps->features[i]);\n    }\n\n    virDomainCapsFeatureSEVFormat(&childBuf, caps->sev);\n\n    virXMLFormatElement(buf, \"features\", NULL, &childBuf);\n}"
  },
  {
    "function_name": "virDomainCapsFeatureSEVFormat",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_capabilities.c",
    "lines": "541-558",
    "snippet": "static void\nvirDomainCapsFeatureSEVFormat(virBufferPtr buf,\n                              const virSEVCapability *sev)\n{\n    if (!sev) {\n        virBufferAddLit(buf, \"<sev supported='no'/>\\n\");\n    } else {\n        virBufferAddLit(buf, \"<sev supported='yes'>\\n\");\n        virBufferAdjustIndent(buf, 2);\n        virBufferAsprintf(buf, \"<cbitpos>%d</cbitpos>\\n\", sev->cbitpos);\n        virBufferAsprintf(buf, \"<reducedPhysBits>%d</reducedPhysBits>\\n\",\n                          sev->reduced_phys_bits);\n        virBufferAdjustIndent(buf, -2);\n        virBufferAddLit(buf, \"</sev>\\n\");\n    }\n\n    return;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"domain_conf.h\"",
      "#include \"domain_capabilities.h\"",
      "#include \"device_conf.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "buf",
            "\"</sev>\\n\""
          ],
          "line": 554
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBufferAdjustIndent",
          "args": [
            "buf",
            "-2"
          ],
          "line": 553
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferAdjustIndent",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "43-62",
          "snippet": "void\nvirBufferAdjustIndent(virBufferPtr buf, int indent)\n{\n    if (!buf)\n        return;\n\n    if (indent > 0) {\n        if (INT_MAX - indent < buf->indent) {\n            buf->indent = INT_MAX;\n            return;\n        }\n    } else {\n        if (buf->indent < -indent) {\n            buf->indent = 0;\n            return;\n        }\n    }\n\n    buf->indent += indent;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirBufferAdjustIndent(virBufferPtr buf, int indent)\n{\n    if (!buf)\n        return;\n\n    if (indent > 0) {\n        if (INT_MAX - indent < buf->indent) {\n            buf->indent = INT_MAX;\n            return;\n        }\n    } else {\n        if (buf->indent < -indent) {\n            buf->indent = 0;\n            return;\n        }\n    }\n\n    buf->indent += indent;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferAsprintf",
          "args": [
            "buf",
            "\"<reducedPhysBits>%d</reducedPhysBits>\\n\"",
            "sev->reduced_phys_bits"
          ],
          "line": 551
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferAsprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "302-309",
          "snippet": "void\nvirBufferAsprintf(virBufferPtr buf, const char *format, ...)\n{\n    va_list argptr;\n    va_start(argptr, format);\n    virBufferVasprintf(buf, format, argptr);\n    va_end(argptr);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirBufferAsprintf(virBufferPtr buf, const char *format, ...)\n{\n    va_list argptr;\n    va_start(argptr, format);\n    virBufferVasprintf(buf, format, argptr);\n    va_end(argptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "buf",
            "\"<sev supported='yes'>\\n\""
          ],
          "line": 548
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "buf",
            "\"<sev supported='no'/>\\n\""
          ],
          "line": 546
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"domain_conf.h\"\n#include \"domain_capabilities.h\"\n#include \"device_conf.h\"\n#include <config.h>\n\nstatic void\nvirDomainCapsFeatureSEVFormat(virBufferPtr buf,\n                              const virSEVCapability *sev)\n{\n    if (!sev) {\n        virBufferAddLit(buf, \"<sev supported='no'/>\\n\");\n    } else {\n        virBufferAddLit(buf, \"<sev supported='yes'>\\n\");\n        virBufferAdjustIndent(buf, 2);\n        virBufferAsprintf(buf, \"<cbitpos>%d</cbitpos>\\n\", sev->cbitpos);\n        virBufferAsprintf(buf, \"<reducedPhysBits>%d</reducedPhysBits>\\n\",\n                          sev->reduced_phys_bits);\n        virBufferAdjustIndent(buf, -2);\n        virBufferAddLit(buf, \"</sev>\\n\");\n    }\n\n    return;\n}"
  },
  {
    "function_name": "virDomainCapsFeatureGICFormat",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_capabilities.c",
    "lines": "530-539",
    "snippet": "static void\nvirDomainCapsFeatureGICFormat(virBufferPtr buf,\n                              const virDomainCapsFeatureGIC *gic)\n{\n    FORMAT_PROLOGUE(gic);\n\n    ENUM_PROCESS(gic, version, virGICVersionTypeToString);\n\n    FORMAT_EPILOGUE(gic);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"domain_conf.h\"",
      "#include \"domain_capabilities.h\"",
      "#include \"device_conf.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "FORMAT_EPILOGUE",
          "args": [
            "gic"
          ],
          "line": 538
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ENUM_PROCESS",
          "args": [
            "gic",
            "version",
            "virGICVersionTypeToString"
          ],
          "line": 536
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "FORMAT_PROLOGUE",
          "args": [
            "gic"
          ],
          "line": 534
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"domain_conf.h\"\n#include \"domain_capabilities.h\"\n#include \"device_conf.h\"\n#include <config.h>\n\nstatic void\nvirDomainCapsFeatureGICFormat(virBufferPtr buf,\n                              const virDomainCapsFeatureGIC *gic)\n{\n    FORMAT_PROLOGUE(gic);\n\n    ENUM_PROCESS(gic, version, virGICVersionTypeToString);\n\n    FORMAT_EPILOGUE(gic);\n}"
  },
  {
    "function_name": "virDomainCapsDeviceRNGFormat",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_capabilities.c",
    "lines": "501-511",
    "snippet": "static void\nvirDomainCapsDeviceRNGFormat(virBufferPtr buf,\n                             const virDomainCapsDeviceRNG *rng)\n{\n    FORMAT_PROLOGUE(rng);\n\n    ENUM_PROCESS(rng, model, virDomainRNGModelTypeToString);\n    ENUM_PROCESS(rng, backendModel, virDomainRNGBackendTypeToString);\n\n    FORMAT_EPILOGUE(rng);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"domain_conf.h\"",
      "#include \"domain_capabilities.h\"",
      "#include \"device_conf.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "FORMAT_EPILOGUE",
          "args": [
            "rng"
          ],
          "line": 510
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ENUM_PROCESS",
          "args": [
            "rng",
            "backendModel",
            "virDomainRNGBackendTypeToString"
          ],
          "line": 508
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ENUM_PROCESS",
          "args": [
            "rng",
            "model",
            "virDomainRNGModelTypeToString"
          ],
          "line": 507
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "FORMAT_PROLOGUE",
          "args": [
            "rng"
          ],
          "line": 505
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"domain_conf.h\"\n#include \"domain_capabilities.h\"\n#include \"device_conf.h\"\n#include <config.h>\n\nstatic void\nvirDomainCapsDeviceRNGFormat(virBufferPtr buf,\n                             const virDomainCapsDeviceRNG *rng)\n{\n    FORMAT_PROLOGUE(rng);\n\n    ENUM_PROCESS(rng, model, virDomainRNGModelTypeToString);\n    ENUM_PROCESS(rng, backendModel, virDomainRNGBackendTypeToString);\n\n    FORMAT_EPILOGUE(rng);\n}"
  },
  {
    "function_name": "virDomainCapsDeviceHostdevFormat",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_capabilities.c",
    "lines": "485-498",
    "snippet": "static void\nvirDomainCapsDeviceHostdevFormat(virBufferPtr buf,\n                                 const virDomainCapsDeviceHostdev *hostdev)\n{\n    FORMAT_PROLOGUE(hostdev);\n\n    ENUM_PROCESS(hostdev, mode, virDomainHostdevModeTypeToString);\n    ENUM_PROCESS(hostdev, startupPolicy, virDomainStartupPolicyTypeToString);\n    ENUM_PROCESS(hostdev, subsysType, virDomainHostdevSubsysTypeToString);\n    ENUM_PROCESS(hostdev, capsType, virDomainHostdevCapsTypeToString);\n    ENUM_PROCESS(hostdev, pciBackend, virDomainHostdevSubsysPCIBackendTypeToString);\n\n    FORMAT_EPILOGUE(hostdev);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"domain_conf.h\"",
      "#include \"domain_capabilities.h\"",
      "#include \"device_conf.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "FORMAT_EPILOGUE",
          "args": [
            "hostdev"
          ],
          "line": 497
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ENUM_PROCESS",
          "args": [
            "hostdev",
            "pciBackend",
            "virDomainHostdevSubsysPCIBackendTypeToString"
          ],
          "line": 495
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ENUM_PROCESS",
          "args": [
            "hostdev",
            "capsType",
            "virDomainHostdevCapsTypeToString"
          ],
          "line": 494
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ENUM_PROCESS",
          "args": [
            "hostdev",
            "subsysType",
            "virDomainHostdevSubsysTypeToString"
          ],
          "line": 493
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ENUM_PROCESS",
          "args": [
            "hostdev",
            "startupPolicy",
            "virDomainStartupPolicyTypeToString"
          ],
          "line": 492
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ENUM_PROCESS",
          "args": [
            "hostdev",
            "mode",
            "virDomainHostdevModeTypeToString"
          ],
          "line": 491
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "FORMAT_PROLOGUE",
          "args": [
            "hostdev"
          ],
          "line": 489
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"domain_conf.h\"\n#include \"domain_capabilities.h\"\n#include \"device_conf.h\"\n#include <config.h>\n\nstatic void\nvirDomainCapsDeviceHostdevFormat(virBufferPtr buf,\n                                 const virDomainCapsDeviceHostdev *hostdev)\n{\n    FORMAT_PROLOGUE(hostdev);\n\n    ENUM_PROCESS(hostdev, mode, virDomainHostdevModeTypeToString);\n    ENUM_PROCESS(hostdev, startupPolicy, virDomainStartupPolicyTypeToString);\n    ENUM_PROCESS(hostdev, subsysType, virDomainHostdevSubsysTypeToString);\n    ENUM_PROCESS(hostdev, capsType, virDomainHostdevCapsTypeToString);\n    ENUM_PROCESS(hostdev, pciBackend, virDomainHostdevSubsysPCIBackendTypeToString);\n\n    FORMAT_EPILOGUE(hostdev);\n}"
  },
  {
    "function_name": "virDomainCapsDeviceVideoFormat",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_capabilities.c",
    "lines": "473-482",
    "snippet": "static void\nvirDomainCapsDeviceVideoFormat(virBufferPtr buf,\n                               const virDomainCapsDeviceVideo *video)\n{\n    FORMAT_PROLOGUE(video);\n\n    ENUM_PROCESS(video, modelType, virDomainVideoTypeToString);\n\n    FORMAT_EPILOGUE(video);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"domain_conf.h\"",
      "#include \"domain_capabilities.h\"",
      "#include \"device_conf.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "FORMAT_EPILOGUE",
          "args": [
            "video"
          ],
          "line": 481
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ENUM_PROCESS",
          "args": [
            "video",
            "modelType",
            "virDomainVideoTypeToString"
          ],
          "line": 479
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "FORMAT_PROLOGUE",
          "args": [
            "video"
          ],
          "line": 477
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"domain_conf.h\"\n#include \"domain_capabilities.h\"\n#include \"device_conf.h\"\n#include <config.h>\n\nstatic void\nvirDomainCapsDeviceVideoFormat(virBufferPtr buf,\n                               const virDomainCapsDeviceVideo *video)\n{\n    FORMAT_PROLOGUE(video);\n\n    ENUM_PROCESS(video, modelType, virDomainVideoTypeToString);\n\n    FORMAT_EPILOGUE(video);\n}"
  },
  {
    "function_name": "virDomainCapsDeviceGraphicsFormat",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_capabilities.c",
    "lines": "461-470",
    "snippet": "static void\nvirDomainCapsDeviceGraphicsFormat(virBufferPtr buf,\n                                  const virDomainCapsDeviceGraphics *graphics)\n{\n    FORMAT_PROLOGUE(graphics);\n\n    ENUM_PROCESS(graphics, type, virDomainGraphicsTypeToString);\n\n    FORMAT_EPILOGUE(graphics);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"domain_conf.h\"",
      "#include \"domain_capabilities.h\"",
      "#include \"device_conf.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "FORMAT_EPILOGUE",
          "args": [
            "graphics"
          ],
          "line": 469
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ENUM_PROCESS",
          "args": [
            "graphics",
            "type",
            "virDomainGraphicsTypeToString"
          ],
          "line": 467
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "FORMAT_PROLOGUE",
          "args": [
            "graphics"
          ],
          "line": 465
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"domain_conf.h\"\n#include \"domain_capabilities.h\"\n#include \"device_conf.h\"\n#include <config.h>\n\nstatic void\nvirDomainCapsDeviceGraphicsFormat(virBufferPtr buf,\n                                  const virDomainCapsDeviceGraphics *graphics)\n{\n    FORMAT_PROLOGUE(graphics);\n\n    ENUM_PROCESS(graphics, type, virDomainGraphicsTypeToString);\n\n    FORMAT_EPILOGUE(graphics);\n}"
  },
  {
    "function_name": "virDomainCapsDeviceDiskFormat",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_capabilities.c",
    "lines": "447-458",
    "snippet": "static void\nvirDomainCapsDeviceDiskFormat(virBufferPtr buf,\n                              const virDomainCapsDeviceDisk *disk)\n{\n    FORMAT_PROLOGUE(disk);\n\n    ENUM_PROCESS(disk, diskDevice, virDomainDiskDeviceTypeToString);\n    ENUM_PROCESS(disk, bus, virDomainDiskBusTypeToString);\n    ENUM_PROCESS(disk, model, virDomainDiskModelTypeToString);\n\n    FORMAT_EPILOGUE(disk);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"domain_conf.h\"",
      "#include \"domain_capabilities.h\"",
      "#include \"device_conf.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "FORMAT_EPILOGUE",
          "args": [
            "disk"
          ],
          "line": 457
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ENUM_PROCESS",
          "args": [
            "disk",
            "model",
            "virDomainDiskModelTypeToString"
          ],
          "line": 455
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ENUM_PROCESS",
          "args": [
            "disk",
            "bus",
            "virDomainDiskBusTypeToString"
          ],
          "line": 454
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ENUM_PROCESS",
          "args": [
            "disk",
            "diskDevice",
            "virDomainDiskDeviceTypeToString"
          ],
          "line": 453
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "FORMAT_PROLOGUE",
          "args": [
            "disk"
          ],
          "line": 451
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"domain_conf.h\"\n#include \"domain_capabilities.h\"\n#include \"device_conf.h\"\n#include <config.h>\n\nstatic void\nvirDomainCapsDeviceDiskFormat(virBufferPtr buf,\n                              const virDomainCapsDeviceDisk *disk)\n{\n    FORMAT_PROLOGUE(disk);\n\n    ENUM_PROCESS(disk, diskDevice, virDomainDiskDeviceTypeToString);\n    ENUM_PROCESS(disk, bus, virDomainDiskBusTypeToString);\n    ENUM_PROCESS(disk, model, virDomainDiskModelTypeToString);\n\n    FORMAT_EPILOGUE(disk);\n}"
  },
  {
    "function_name": "virDomainCapsCPUFormat",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_capabilities.c",
    "lines": "408-445",
    "snippet": "static void\nvirDomainCapsCPUFormat(virBufferPtr buf,\n                       const virDomainCapsCPU *cpu)\n{\n    virBufferAddLit(buf, \"<cpu>\\n\");\n    virBufferAdjustIndent(buf, 2);\n\n    virBufferAsprintf(buf, \"<mode name='%s' supported='%s'/>\\n\",\n                      virCPUModeTypeToString(VIR_CPU_MODE_HOST_PASSTHROUGH),\n                      cpu->hostPassthrough ? \"yes\" : \"no\");\n\n    virBufferAsprintf(buf, \"<mode name='%s' \",\n                      virCPUModeTypeToString(VIR_CPU_MODE_HOST_MODEL));\n    if (cpu->hostModel) {\n        virBufferAddLit(buf, \"supported='yes'>\\n\");\n        virBufferAdjustIndent(buf, 2);\n\n        virCPUDefFormatBuf(buf, cpu->hostModel);\n\n        virBufferAdjustIndent(buf, -2);\n        virBufferAddLit(buf, \"</mode>\\n\");\n    } else {\n        virBufferAddLit(buf, \"supported='no'/>\\n\");\n    }\n\n    virBufferAsprintf(buf, \"<mode name='%s' \",\n                      virCPUModeTypeToString(VIR_CPU_MODE_CUSTOM));\n    if (cpu->custom && cpu->custom->nmodels) {\n        virBufferAddLit(buf, \"supported='yes'>\\n\");\n        virDomainCapsCPUCustomFormat(buf, cpu->custom);\n        virBufferAddLit(buf, \"</mode>\\n\");\n    } else {\n        virBufferAddLit(buf, \"supported='no'/>\\n\");\n    }\n\n    virBufferAdjustIndent(buf, -2);\n    virBufferAddLit(buf, \"</cpu>\\n\");\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"domain_conf.h\"",
      "#include \"domain_capabilities.h\"",
      "#include \"device_conf.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "buf",
            "\"</cpu>\\n\""
          ],
          "line": 444
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBufferAdjustIndent",
          "args": [
            "buf",
            "-2"
          ],
          "line": 443
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferAdjustIndent",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "43-62",
          "snippet": "void\nvirBufferAdjustIndent(virBufferPtr buf, int indent)\n{\n    if (!buf)\n        return;\n\n    if (indent > 0) {\n        if (INT_MAX - indent < buf->indent) {\n            buf->indent = INT_MAX;\n            return;\n        }\n    } else {\n        if (buf->indent < -indent) {\n            buf->indent = 0;\n            return;\n        }\n    }\n\n    buf->indent += indent;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirBufferAdjustIndent(virBufferPtr buf, int indent)\n{\n    if (!buf)\n        return;\n\n    if (indent > 0) {\n        if (INT_MAX - indent < buf->indent) {\n            buf->indent = INT_MAX;\n            return;\n        }\n    } else {\n        if (buf->indent < -indent) {\n            buf->indent = 0;\n            return;\n        }\n    }\n\n    buf->indent += indent;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "buf",
            "\"supported='no'/>\\n\""
          ],
          "line": 440
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "buf",
            "\"</mode>\\n\""
          ],
          "line": 438
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainCapsCPUCustomFormat",
          "args": [
            "buf",
            "cpu->custom"
          ],
          "line": 437
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainCapsCPUCustomFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_capabilities.c",
          "lines": "390-406",
          "snippet": "static void\nvirDomainCapsCPUCustomFormat(virBufferPtr buf,\n                             virDomainCapsCPUModelsPtr custom)\n{\n    size_t i;\n\n    virBufferAdjustIndent(buf, 2);\n\n    for (i = 0; i < custom->nmodels; i++) {\n        virDomainCapsCPUModelPtr model = custom->models + i;\n        virBufferAsprintf(buf, \"<model usable='%s'>%s</model>\\n\",\n                          virDomainCapsCPUUsableTypeToString(model->usable),\n                          model->name);\n    }\n\n    virBufferAdjustIndent(buf, -2);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_capabilities.h\"",
            "#include \"device_conf.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"domain_conf.h\"\n#include \"domain_capabilities.h\"\n#include \"device_conf.h\"\n#include <config.h>\n\nstatic void\nvirDomainCapsCPUCustomFormat(virBufferPtr buf,\n                             virDomainCapsCPUModelsPtr custom)\n{\n    size_t i;\n\n    virBufferAdjustIndent(buf, 2);\n\n    for (i = 0; i < custom->nmodels; i++) {\n        virDomainCapsCPUModelPtr model = custom->models + i;\n        virBufferAsprintf(buf, \"<model usable='%s'>%s</model>\\n\",\n                          virDomainCapsCPUUsableTypeToString(model->usable),\n                          model->name);\n    }\n\n    virBufferAdjustIndent(buf, -2);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "buf",
            "\"supported='yes'>\\n\""
          ],
          "line": 436
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBufferAsprintf",
          "args": [
            "buf",
            "\"<mode name='%s' \"",
            "virCPUModeTypeToString(VIR_CPU_MODE_CUSTOM)"
          ],
          "line": 433
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferAsprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "302-309",
          "snippet": "void\nvirBufferAsprintf(virBufferPtr buf, const char *format, ...)\n{\n    va_list argptr;\n    va_start(argptr, format);\n    virBufferVasprintf(buf, format, argptr);\n    va_end(argptr);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirBufferAsprintf(virBufferPtr buf, const char *format, ...)\n{\n    va_list argptr;\n    va_start(argptr, format);\n    virBufferVasprintf(buf, format, argptr);\n    va_end(argptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCPUModeTypeToString",
          "args": [
            "VIR_CPU_MODE_CUSTOM"
          ],
          "line": 434
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "buf",
            "\"supported='no'/>\\n\""
          ],
          "line": 430
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "buf",
            "\"</mode>\\n\""
          ],
          "line": 428
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCPUDefFormatBuf",
          "args": [
            "buf",
            "cpu->hostModel"
          ],
          "line": 425
        },
        "resolved": true,
        "details": {
          "function_name": "virCPUDefFormatBuf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/cpu_conf.c",
          "lines": "775-882",
          "snippet": "int\nvirCPUDefFormatBuf(virBufferPtr buf,\n                   virCPUDefPtr def)\n{\n    size_t i;\n    bool formatModel;\n\n    if (!def)\n        return 0;\n\n    formatModel = (def->mode == VIR_CPU_MODE_CUSTOM ||\n                   def->mode == VIR_CPU_MODE_HOST_MODEL);\n\n    if (!def->model && def->mode == VIR_CPU_MODE_CUSTOM && def->nfeatures) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Non-empty feature list specified without CPU model\"));\n        return -1;\n    }\n\n    if (formatModel && (def->model || def->vendor_id)) {\n        virBufferAddLit(buf, \"<model\");\n\n        if (def->type == VIR_CPU_TYPE_GUEST && def->model) {\n            const char *fallback;\n\n            fallback = virCPUFallbackTypeToString(def->fallback);\n            if (!fallback) {\n                virReportError(VIR_ERR_INTERNAL_ERROR,\n                               _(\"Unexpected CPU fallback value: %d\"),\n                               def->fallback);\n                return -1;\n            }\n            virBufferAsprintf(buf, \" fallback='%s'\", fallback);\n        }\n\n        if (def->type == VIR_CPU_TYPE_GUEST)\n            virBufferEscapeString(buf, \" vendor_id='%s'\", def->vendor_id);\n\n        if (def->model)\n            virBufferEscapeString(buf, \">%s</model>\\n\", def->model);\n        else\n            virBufferAddLit(buf, \"/>\\n\");\n    }\n\n    if (formatModel && def->vendor)\n        virBufferEscapeString(buf, \"<vendor>%s</vendor>\\n\", def->vendor);\n\n    if (def->type == VIR_CPU_TYPE_HOST && def->microcodeVersion)\n        virBufferAsprintf(buf, \"<microcode version='%u'/>\\n\",\n                          def->microcodeVersion);\n\n    if (def->type == VIR_CPU_TYPE_HOST && def->tsc) {\n        virBufferAddLit(buf, \"<counter name='tsc'\");\n        virBufferAsprintf(buf, \" frequency='%llu'\", def->tsc->frequency);\n        if (def->tsc->scaling) {\n            virBufferAsprintf(buf, \" scaling='%s'\",\n                              virTristateBoolTypeToString(def->tsc->scaling));\n        }\n        virBufferAddLit(buf, \"/>\\n\");\n    }\n\n    if (def->sockets && def->dies && def->cores && def->threads) {\n        virBufferAddLit(buf, \"<topology\");\n        virBufferAsprintf(buf, \" sockets='%u'\", def->sockets);\n        virBufferAsprintf(buf, \" dies='%u'\", def->dies);\n        virBufferAsprintf(buf, \" cores='%u'\", def->cores);\n        virBufferAsprintf(buf, \" threads='%u'\", def->threads);\n        virBufferAddLit(buf, \"/>\\n\");\n    }\n\n    if (def->cache) {\n        virBufferAddLit(buf, \"<cache \");\n        if (def->cache->level != -1)\n            virBufferAsprintf(buf, \"level='%d' \", def->cache->level);\n        virBufferAsprintf(buf, \"mode='%s'\",\n                          virCPUCacheModeTypeToString(def->cache->mode));\n        virBufferAddLit(buf, \"/>\\n\");\n    }\n\n    for (i = 0; i < def->nfeatures; i++) {\n        virCPUFeatureDefPtr feature = def->features + i;\n\n        if (!feature->name) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"Missing CPU feature name\"));\n            return -1;\n        }\n\n        if (def->type == VIR_CPU_TYPE_GUEST) {\n            const char *policy;\n\n            policy = virCPUFeaturePolicyTypeToString(feature->policy);\n            if (!policy) {\n                virReportError(VIR_ERR_INTERNAL_ERROR,\n                               _(\"Unexpected CPU feature policy %d\"),\n                               feature->policy);\n                return -1;\n            }\n            virBufferAsprintf(buf, \"<feature policy='%s' name='%s'/>\\n\",\n                              policy, feature->name);\n        } else {\n            virBufferAsprintf(buf, \"<feature name='%s'/>\\n\",\n                              feature->name);\n        }\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint\nvirCPUDefFormatBuf(virBufferPtr buf,\n                   virCPUDefPtr def)\n{\n    size_t i;\n    bool formatModel;\n\n    if (!def)\n        return 0;\n\n    formatModel = (def->mode == VIR_CPU_MODE_CUSTOM ||\n                   def->mode == VIR_CPU_MODE_HOST_MODEL);\n\n    if (!def->model && def->mode == VIR_CPU_MODE_CUSTOM && def->nfeatures) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Non-empty feature list specified without CPU model\"));\n        return -1;\n    }\n\n    if (formatModel && (def->model || def->vendor_id)) {\n        virBufferAddLit(buf, \"<model\");\n\n        if (def->type == VIR_CPU_TYPE_GUEST && def->model) {\n            const char *fallback;\n\n            fallback = virCPUFallbackTypeToString(def->fallback);\n            if (!fallback) {\n                virReportError(VIR_ERR_INTERNAL_ERROR,\n                               _(\"Unexpected CPU fallback value: %d\"),\n                               def->fallback);\n                return -1;\n            }\n            virBufferAsprintf(buf, \" fallback='%s'\", fallback);\n        }\n\n        if (def->type == VIR_CPU_TYPE_GUEST)\n            virBufferEscapeString(buf, \" vendor_id='%s'\", def->vendor_id);\n\n        if (def->model)\n            virBufferEscapeString(buf, \">%s</model>\\n\", def->model);\n        else\n            virBufferAddLit(buf, \"/>\\n\");\n    }\n\n    if (formatModel && def->vendor)\n        virBufferEscapeString(buf, \"<vendor>%s</vendor>\\n\", def->vendor);\n\n    if (def->type == VIR_CPU_TYPE_HOST && def->microcodeVersion)\n        virBufferAsprintf(buf, \"<microcode version='%u'/>\\n\",\n                          def->microcodeVersion);\n\n    if (def->type == VIR_CPU_TYPE_HOST && def->tsc) {\n        virBufferAddLit(buf, \"<counter name='tsc'\");\n        virBufferAsprintf(buf, \" frequency='%llu'\", def->tsc->frequency);\n        if (def->tsc->scaling) {\n            virBufferAsprintf(buf, \" scaling='%s'\",\n                              virTristateBoolTypeToString(def->tsc->scaling));\n        }\n        virBufferAddLit(buf, \"/>\\n\");\n    }\n\n    if (def->sockets && def->dies && def->cores && def->threads) {\n        virBufferAddLit(buf, \"<topology\");\n        virBufferAsprintf(buf, \" sockets='%u'\", def->sockets);\n        virBufferAsprintf(buf, \" dies='%u'\", def->dies);\n        virBufferAsprintf(buf, \" cores='%u'\", def->cores);\n        virBufferAsprintf(buf, \" threads='%u'\", def->threads);\n        virBufferAddLit(buf, \"/>\\n\");\n    }\n\n    if (def->cache) {\n        virBufferAddLit(buf, \"<cache \");\n        if (def->cache->level != -1)\n            virBufferAsprintf(buf, \"level='%d' \", def->cache->level);\n        virBufferAsprintf(buf, \"mode='%s'\",\n                          virCPUCacheModeTypeToString(def->cache->mode));\n        virBufferAddLit(buf, \"/>\\n\");\n    }\n\n    for (i = 0; i < def->nfeatures; i++) {\n        virCPUFeatureDefPtr feature = def->features + i;\n\n        if (!feature->name) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"Missing CPU feature name\"));\n            return -1;\n        }\n\n        if (def->type == VIR_CPU_TYPE_GUEST) {\n            const char *policy;\n\n            policy = virCPUFeaturePolicyTypeToString(feature->policy);\n            if (!policy) {\n                virReportError(VIR_ERR_INTERNAL_ERROR,\n                               _(\"Unexpected CPU feature policy %d\"),\n                               feature->policy);\n                return -1;\n            }\n            virBufferAsprintf(buf, \"<feature policy='%s' name='%s'/>\\n\",\n                              policy, feature->name);\n        } else {\n            virBufferAsprintf(buf, \"<feature name='%s'/>\\n\",\n                              feature->name);\n        }\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "buf",
            "\"supported='yes'>\\n\""
          ],
          "line": 422
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCPUModeTypeToString",
          "args": [
            "VIR_CPU_MODE_HOST_MODEL"
          ],
          "line": 420
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCPUModeTypeToString",
          "args": [
            "VIR_CPU_MODE_HOST_PASSTHROUGH"
          ],
          "line": 416
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "buf",
            "\"<cpu>\\n\""
          ],
          "line": 412
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"domain_conf.h\"\n#include \"domain_capabilities.h\"\n#include \"device_conf.h\"\n#include <config.h>\n\nstatic void\nvirDomainCapsCPUFormat(virBufferPtr buf,\n                       const virDomainCapsCPU *cpu)\n{\n    virBufferAddLit(buf, \"<cpu>\\n\");\n    virBufferAdjustIndent(buf, 2);\n\n    virBufferAsprintf(buf, \"<mode name='%s' supported='%s'/>\\n\",\n                      virCPUModeTypeToString(VIR_CPU_MODE_HOST_PASSTHROUGH),\n                      cpu->hostPassthrough ? \"yes\" : \"no\");\n\n    virBufferAsprintf(buf, \"<mode name='%s' \",\n                      virCPUModeTypeToString(VIR_CPU_MODE_HOST_MODEL));\n    if (cpu->hostModel) {\n        virBufferAddLit(buf, \"supported='yes'>\\n\");\n        virBufferAdjustIndent(buf, 2);\n\n        virCPUDefFormatBuf(buf, cpu->hostModel);\n\n        virBufferAdjustIndent(buf, -2);\n        virBufferAddLit(buf, \"</mode>\\n\");\n    } else {\n        virBufferAddLit(buf, \"supported='no'/>\\n\");\n    }\n\n    virBufferAsprintf(buf, \"<mode name='%s' \",\n                      virCPUModeTypeToString(VIR_CPU_MODE_CUSTOM));\n    if (cpu->custom && cpu->custom->nmodels) {\n        virBufferAddLit(buf, \"supported='yes'>\\n\");\n        virDomainCapsCPUCustomFormat(buf, cpu->custom);\n        virBufferAddLit(buf, \"</mode>\\n\");\n    } else {\n        virBufferAddLit(buf, \"supported='no'/>\\n\");\n    }\n\n    virBufferAdjustIndent(buf, -2);\n    virBufferAddLit(buf, \"</cpu>\\n\");\n}"
  },
  {
    "function_name": "virDomainCapsCPUCustomFormat",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_capabilities.c",
    "lines": "390-406",
    "snippet": "static void\nvirDomainCapsCPUCustomFormat(virBufferPtr buf,\n                             virDomainCapsCPUModelsPtr custom)\n{\n    size_t i;\n\n    virBufferAdjustIndent(buf, 2);\n\n    for (i = 0; i < custom->nmodels; i++) {\n        virDomainCapsCPUModelPtr model = custom->models + i;\n        virBufferAsprintf(buf, \"<model usable='%s'>%s</model>\\n\",\n                          virDomainCapsCPUUsableTypeToString(model->usable),\n                          model->name);\n    }\n\n    virBufferAdjustIndent(buf, -2);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"domain_conf.h\"",
      "#include \"domain_capabilities.h\"",
      "#include \"device_conf.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virBufferAdjustIndent",
          "args": [
            "buf",
            "-2"
          ],
          "line": 405
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferAdjustIndent",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "43-62",
          "snippet": "void\nvirBufferAdjustIndent(virBufferPtr buf, int indent)\n{\n    if (!buf)\n        return;\n\n    if (indent > 0) {\n        if (INT_MAX - indent < buf->indent) {\n            buf->indent = INT_MAX;\n            return;\n        }\n    } else {\n        if (buf->indent < -indent) {\n            buf->indent = 0;\n            return;\n        }\n    }\n\n    buf->indent += indent;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirBufferAdjustIndent(virBufferPtr buf, int indent)\n{\n    if (!buf)\n        return;\n\n    if (indent > 0) {\n        if (INT_MAX - indent < buf->indent) {\n            buf->indent = INT_MAX;\n            return;\n        }\n    } else {\n        if (buf->indent < -indent) {\n            buf->indent = 0;\n            return;\n        }\n    }\n\n    buf->indent += indent;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferAsprintf",
          "args": [
            "buf",
            "\"<model usable='%s'>%s</model>\\n\"",
            "virDomainCapsCPUUsableTypeToString(model->usable)",
            "model->name"
          ],
          "line": 400
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferAsprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "302-309",
          "snippet": "void\nvirBufferAsprintf(virBufferPtr buf, const char *format, ...)\n{\n    va_list argptr;\n    va_start(argptr, format);\n    virBufferVasprintf(buf, format, argptr);\n    va_end(argptr);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirBufferAsprintf(virBufferPtr buf, const char *format, ...)\n{\n    va_list argptr;\n    va_start(argptr, format);\n    virBufferVasprintf(buf, format, argptr);\n    va_end(argptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainCapsCPUUsableTypeToString",
          "args": [
            "model->usable"
          ],
          "line": 401
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"domain_conf.h\"\n#include \"domain_capabilities.h\"\n#include \"device_conf.h\"\n#include <config.h>\n\nstatic void\nvirDomainCapsCPUCustomFormat(virBufferPtr buf,\n                             virDomainCapsCPUModelsPtr custom)\n{\n    size_t i;\n\n    virBufferAdjustIndent(buf, 2);\n\n    for (i = 0; i < custom->nmodels; i++) {\n        virDomainCapsCPUModelPtr model = custom->models + i;\n        virBufferAsprintf(buf, \"<model usable='%s'>%s</model>\\n\",\n                          virDomainCapsCPUUsableTypeToString(model->usable),\n                          model->name);\n    }\n\n    virBufferAdjustIndent(buf, -2);\n}"
  },
  {
    "function_name": "virDomainCapsOSFormat",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_capabilities.c",
    "lines": "375-388",
    "snippet": "static void\nvirDomainCapsOSFormat(virBufferPtr buf,\n                      const virDomainCapsOS *os)\n{\n    const virDomainCapsLoader *loader = &os->loader;\n\n    FORMAT_PROLOGUE(os);\n\n    ENUM_PROCESS(os, firmware, virDomainOsDefFirmwareTypeToString);\n\n    virDomainCapsLoaderFormat(buf, loader);\n\n    FORMAT_EPILOGUE(os);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"domain_conf.h\"",
      "#include \"domain_capabilities.h\"",
      "#include \"device_conf.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "FORMAT_EPILOGUE",
          "args": [
            "os"
          ],
          "line": 387
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainCapsLoaderFormat",
          "args": [
            "buf",
            "loader"
          ],
          "line": 385
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainCapsLoaderFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_capabilities.c",
          "lines": "361-373",
          "snippet": "static void\nvirDomainCapsLoaderFormat(virBufferPtr buf,\n                          const virDomainCapsLoader *loader)\n{\n    FORMAT_PROLOGUE(loader);\n\n    virDomainCapsStringValuesFormat(buf, &loader->values);\n    ENUM_PROCESS(loader, type, virDomainLoaderTypeToString);\n    ENUM_PROCESS(loader, readonly, virTristateBoolTypeToString);\n    ENUM_PROCESS(loader, secure, virTristateBoolTypeToString);\n\n    FORMAT_EPILOGUE(loader);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_capabilities.h\"",
            "#include \"device_conf.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"domain_conf.h\"\n#include \"domain_capabilities.h\"\n#include \"device_conf.h\"\n#include <config.h>\n\nstatic void\nvirDomainCapsLoaderFormat(virBufferPtr buf,\n                          const virDomainCapsLoader *loader)\n{\n    FORMAT_PROLOGUE(loader);\n\n    virDomainCapsStringValuesFormat(buf, &loader->values);\n    ENUM_PROCESS(loader, type, virDomainLoaderTypeToString);\n    ENUM_PROCESS(loader, readonly, virTristateBoolTypeToString);\n    ENUM_PROCESS(loader, secure, virTristateBoolTypeToString);\n\n    FORMAT_EPILOGUE(loader);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ENUM_PROCESS",
          "args": [
            "os",
            "firmware",
            "virDomainOsDefFirmwareTypeToString"
          ],
          "line": 383
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "FORMAT_PROLOGUE",
          "args": [
            "os"
          ],
          "line": 381
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"domain_conf.h\"\n#include \"domain_capabilities.h\"\n#include \"device_conf.h\"\n#include <config.h>\n\nstatic void\nvirDomainCapsOSFormat(virBufferPtr buf,\n                      const virDomainCapsOS *os)\n{\n    const virDomainCapsLoader *loader = &os->loader;\n\n    FORMAT_PROLOGUE(os);\n\n    ENUM_PROCESS(os, firmware, virDomainOsDefFirmwareTypeToString);\n\n    virDomainCapsLoaderFormat(buf, loader);\n\n    FORMAT_EPILOGUE(os);\n}"
  },
  {
    "function_name": "virDomainCapsLoaderFormat",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_capabilities.c",
    "lines": "361-373",
    "snippet": "static void\nvirDomainCapsLoaderFormat(virBufferPtr buf,\n                          const virDomainCapsLoader *loader)\n{\n    FORMAT_PROLOGUE(loader);\n\n    virDomainCapsStringValuesFormat(buf, &loader->values);\n    ENUM_PROCESS(loader, type, virDomainLoaderTypeToString);\n    ENUM_PROCESS(loader, readonly, virTristateBoolTypeToString);\n    ENUM_PROCESS(loader, secure, virTristateBoolTypeToString);\n\n    FORMAT_EPILOGUE(loader);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"domain_conf.h\"",
      "#include \"domain_capabilities.h\"",
      "#include \"device_conf.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "FORMAT_EPILOGUE",
          "args": [
            "loader"
          ],
          "line": 372
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ENUM_PROCESS",
          "args": [
            "loader",
            "secure",
            "virTristateBoolTypeToString"
          ],
          "line": 370
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ENUM_PROCESS",
          "args": [
            "loader",
            "readonly",
            "virTristateBoolTypeToString"
          ],
          "line": 369
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ENUM_PROCESS",
          "args": [
            "loader",
            "type",
            "virDomainLoaderTypeToString"
          ],
          "line": 368
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainCapsStringValuesFormat",
          "args": [
            "buf",
            "&loader->values"
          ],
          "line": 367
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainCapsStringValuesFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_capabilities.c",
          "lines": "312-320",
          "snippet": "static void\nvirDomainCapsStringValuesFormat(virBufferPtr buf,\n                                const virDomainCapsStringValues *values)\n{\n    size_t i;\n\n    for (i = 0; i < values->nvalues; i++)\n        virBufferEscapeString(buf, \"<value>%s</value>\\n\", values->values[i]);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_capabilities.h\"",
            "#include \"device_conf.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"domain_conf.h\"\n#include \"domain_capabilities.h\"\n#include \"device_conf.h\"\n#include <config.h>\n\nstatic void\nvirDomainCapsStringValuesFormat(virBufferPtr buf,\n                                const virDomainCapsStringValues *values)\n{\n    size_t i;\n\n    for (i = 0; i < values->nvalues; i++)\n        virBufferEscapeString(buf, \"<value>%s</value>\\n\", values->values[i]);\n}"
        }
      },
      {
        "call_info": {
          "callee": "FORMAT_PROLOGUE",
          "args": [
            "loader"
          ],
          "line": 365
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"domain_conf.h\"\n#include \"domain_capabilities.h\"\n#include \"device_conf.h\"\n#include <config.h>\n\nstatic void\nvirDomainCapsLoaderFormat(virBufferPtr buf,\n                          const virDomainCapsLoader *loader)\n{\n    FORMAT_PROLOGUE(loader);\n\n    virDomainCapsStringValuesFormat(buf, &loader->values);\n    ENUM_PROCESS(loader, type, virDomainLoaderTypeToString);\n    ENUM_PROCESS(loader, readonly, virTristateBoolTypeToString);\n    ENUM_PROCESS(loader, secure, virTristateBoolTypeToString);\n\n    FORMAT_EPILOGUE(loader);\n}"
  },
  {
    "function_name": "qemuDomainCapsFeatureFormatSimple",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_capabilities.c",
    "lines": "348-358",
    "snippet": "static void\nqemuDomainCapsFeatureFormatSimple(virBufferPtr buf,\n                                  const char *featurename,\n                                  virTristateBool supported)\n{\n    if (supported == VIR_TRISTATE_BOOL_ABSENT)\n        return;\n\n    virBufferAsprintf(buf, \"<%s supported='%s'/>\\n\", featurename,\n                      virTristateBoolTypeToString(supported));\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"domain_conf.h\"",
      "#include \"domain_capabilities.h\"",
      "#include \"device_conf.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virBufferAsprintf",
          "args": [
            "buf",
            "\"<%s supported='%s'/>\\n\"",
            "featurename",
            "virTristateBoolTypeToString(supported)"
          ],
          "line": 356
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferAsprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "302-309",
          "snippet": "void\nvirBufferAsprintf(virBufferPtr buf, const char *format, ...)\n{\n    va_list argptr;\n    va_start(argptr, format);\n    virBufferVasprintf(buf, format, argptr);\n    va_end(argptr);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirBufferAsprintf(virBufferPtr buf, const char *format, ...)\n{\n    va_list argptr;\n    va_start(argptr, format);\n    virBufferVasprintf(buf, format, argptr);\n    va_end(argptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virTristateBoolTypeToString",
          "args": [
            "supported"
          ],
          "line": 357
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"domain_conf.h\"\n#include \"domain_capabilities.h\"\n#include \"device_conf.h\"\n#include <config.h>\n\nstatic void\nqemuDomainCapsFeatureFormatSimple(virBufferPtr buf,\n                                  const char *featurename,\n                                  virTristateBool supported)\n{\n    if (supported == VIR_TRISTATE_BOOL_ABSENT)\n        return;\n\n    virBufferAsprintf(buf, \"<%s supported='%s'/>\\n\", featurename,\n                      virTristateBoolTypeToString(supported));\n}"
  },
  {
    "function_name": "virDomainCapsStringValuesFormat",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_capabilities.c",
    "lines": "312-320",
    "snippet": "static void\nvirDomainCapsStringValuesFormat(virBufferPtr buf,\n                                const virDomainCapsStringValues *values)\n{\n    size_t i;\n\n    for (i = 0; i < values->nvalues; i++)\n        virBufferEscapeString(buf, \"<value>%s</value>\\n\", values->values[i]);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"domain_conf.h\"",
      "#include \"domain_capabilities.h\"",
      "#include \"device_conf.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virBufferEscapeString",
          "args": [
            "buf",
            "\"<value>%s</value>\\n\"",
            "values->values[i]"
          ],
          "line": 319
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferEscapeString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "343-418",
          "snippet": "void\nvirBufferEscapeString(virBufferPtr buf, const char *format, const char *str)\n{\n    int len;\n    g_autofree char *escaped = NULL;\n    char *out;\n    const char *cur;\n    const char forbidden_characters[] = {\n        0x01,   0x02,   0x03,   0x04,   0x05,   0x06,   0x07,   0x08,\n        /*\\t*/  /*\\n*/  0x0B,   0x0C,   /*\\r*/  0x0E,   0x0F,   0x10,\n        0x11,   0x12,   0x13,   0x14,   0x15,   0x16,   0x17,   0x18,\n        0x19,   '\"',    '&',    '\\'',   '<',    '>',\n        '\\0'\n    };\n\n    if ((format == NULL) || (buf == NULL) || (str == NULL))\n        return;\n\n    len = strlen(str);\n    if (strcspn(str, forbidden_characters) == len) {\n        virBufferAsprintf(buf, format, str);\n        return;\n    }\n\n    escaped = g_malloc0_n(len + 1, 6);\n\n    cur = str;\n    out = escaped;\n    while (*cur != 0) {\n        if (*cur == '<') {\n            *out++ = '&';\n            *out++ = 'l';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '>') {\n            *out++ = '&';\n            *out++ = 'g';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '&') {\n            *out++ = '&';\n            *out++ = 'a';\n            *out++ = 'm';\n            *out++ = 'p';\n            *out++ = ';';\n        } else if (*cur == '\"') {\n            *out++ = '&';\n            *out++ = 'q';\n            *out++ = 'u';\n            *out++ = 'o';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '\\'') {\n            *out++ = '&';\n            *out++ = 'a';\n            *out++ = 'p';\n            *out++ = 'o';\n            *out++ = 's';\n            *out++ = ';';\n        } else if (!strchr(forbidden_characters, *cur)) {\n            /*\n             * default case, just copy !\n             * Note that character over 0x80 are likely to give problem\n             * with UTF-8 XML, but since our string don't have an encoding\n             * it's hard to handle properly we have to assume it's UTF-8 too\n             */\n            *out++ = *cur;\n        } else {\n            /* silently ignore control characters */\n        }\n        cur++;\n    }\n    *out = 0;\n\n    virBufferAsprintf(buf, format, escaped);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirBufferEscapeString(virBufferPtr buf, const char *format, const char *str)\n{\n    int len;\n    g_autofree char *escaped = NULL;\n    char *out;\n    const char *cur;\n    const char forbidden_characters[] = {\n        0x01,   0x02,   0x03,   0x04,   0x05,   0x06,   0x07,   0x08,\n        /*\\t*/  /*\\n*/  0x0B,   0x0C,   /*\\r*/  0x0E,   0x0F,   0x10,\n        0x11,   0x12,   0x13,   0x14,   0x15,   0x16,   0x17,   0x18,\n        0x19,   '\"',    '&',    '\\'',   '<',    '>',\n        '\\0'\n    };\n\n    if ((format == NULL) || (buf == NULL) || (str == NULL))\n        return;\n\n    len = strlen(str);\n    if (strcspn(str, forbidden_characters) == len) {\n        virBufferAsprintf(buf, format, str);\n        return;\n    }\n\n    escaped = g_malloc0_n(len + 1, 6);\n\n    cur = str;\n    out = escaped;\n    while (*cur != 0) {\n        if (*cur == '<') {\n            *out++ = '&';\n            *out++ = 'l';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '>') {\n            *out++ = '&';\n            *out++ = 'g';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '&') {\n            *out++ = '&';\n            *out++ = 'a';\n            *out++ = 'm';\n            *out++ = 'p';\n            *out++ = ';';\n        } else if (*cur == '\"') {\n            *out++ = '&';\n            *out++ = 'q';\n            *out++ = 'u';\n            *out++ = 'o';\n            *out++ = 't';\n            *out++ = ';';\n        } else if (*cur == '\\'') {\n            *out++ = '&';\n            *out++ = 'a';\n            *out++ = 'p';\n            *out++ = 'o';\n            *out++ = 's';\n            *out++ = ';';\n        } else if (!strchr(forbidden_characters, *cur)) {\n            /*\n             * default case, just copy !\n             * Note that character over 0x80 are likely to give problem\n             * with UTF-8 XML, but since our string don't have an encoding\n             * it's hard to handle properly we have to assume it's UTF-8 too\n             */\n            *out++ = *cur;\n        } else {\n            /* silently ignore control characters */\n        }\n        cur++;\n    }\n    *out = 0;\n\n    virBufferAsprintf(buf, format, escaped);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"domain_conf.h\"\n#include \"domain_capabilities.h\"\n#include \"device_conf.h\"\n#include <config.h>\n\nstatic void\nvirDomainCapsStringValuesFormat(virBufferPtr buf,\n                                const virDomainCapsStringValues *values)\n{\n    size_t i;\n\n    for (i = 0; i < values->nvalues; i++)\n        virBufferEscapeString(buf, \"<value>%s</value>\\n\", values->values[i]);\n}"
  },
  {
    "function_name": "virDomainCapsEnumFormat",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_capabilities.c",
    "lines": "277-309",
    "snippet": "static int\nvirDomainCapsEnumFormat(virBufferPtr buf,\n                        const virDomainCapsEnum *capsEnum,\n                        const char *capsEnumName,\n                        virDomainCapsValToStr valToStr)\n{\n    size_t i;\n\n    if (!capsEnum->report)\n        return 0;\n\n    virBufferAsprintf(buf, \"<enum name='%s'\", capsEnumName);\n    if (!capsEnum->values) {\n        virBufferAddLit(buf, \"/>\\n\");\n        return 0;\n    }\n    virBufferAddLit(buf, \">\\n\");\n    virBufferAdjustIndent(buf, 2);\n\n    for (i = 0; i < sizeof(capsEnum->values) * CHAR_BIT; i++) {\n        const char *val;\n\n        if (!(capsEnum->values & (1 << i)))\n            continue;\n\n        if ((val = (valToStr)(i)))\n            virBufferAsprintf(buf, \"<value>%s</value>\\n\", val);\n    }\n    virBufferAdjustIndent(buf, -2);\n    virBufferAddLit(buf, \"</enum>\\n\");\n\n    return 0;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"domain_conf.h\"",
      "#include \"domain_capabilities.h\"",
      "#include \"device_conf.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "buf",
            "\"</enum>\\n\""
          ],
          "line": 306
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBufferAdjustIndent",
          "args": [
            "buf",
            "-2"
          ],
          "line": 305
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferAdjustIndent",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "43-62",
          "snippet": "void\nvirBufferAdjustIndent(virBufferPtr buf, int indent)\n{\n    if (!buf)\n        return;\n\n    if (indent > 0) {\n        if (INT_MAX - indent < buf->indent) {\n            buf->indent = INT_MAX;\n            return;\n        }\n    } else {\n        if (buf->indent < -indent) {\n            buf->indent = 0;\n            return;\n        }\n    }\n\n    buf->indent += indent;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirBufferAdjustIndent(virBufferPtr buf, int indent)\n{\n    if (!buf)\n        return;\n\n    if (indent > 0) {\n        if (INT_MAX - indent < buf->indent) {\n            buf->indent = INT_MAX;\n            return;\n        }\n    } else {\n        if (buf->indent < -indent) {\n            buf->indent = 0;\n            return;\n        }\n    }\n\n    buf->indent += indent;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferAsprintf",
          "args": [
            "buf",
            "\"<value>%s</value>\\n\"",
            "val"
          ],
          "line": 303
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferAsprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "302-309",
          "snippet": "void\nvirBufferAsprintf(virBufferPtr buf, const char *format, ...)\n{\n    va_list argptr;\n    va_start(argptr, format);\n    virBufferVasprintf(buf, format, argptr);\n    va_end(argptr);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirBufferAsprintf(virBufferPtr buf, const char *format, ...)\n{\n    va_list argptr;\n    va_start(argptr, format);\n    virBufferVasprintf(buf, format, argptr);\n    va_end(argptr);\n}"
        }
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "i"
          ],
          "line": 302
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "buf",
            "\">\\n\""
          ],
          "line": 293
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "buf",
            "\"/>\\n\""
          ],
          "line": 290
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"domain_conf.h\"\n#include \"domain_capabilities.h\"\n#include \"device_conf.h\"\n#include <config.h>\n\nstatic int\nvirDomainCapsEnumFormat(virBufferPtr buf,\n                        const virDomainCapsEnum *capsEnum,\n                        const char *capsEnumName,\n                        virDomainCapsValToStr valToStr)\n{\n    size_t i;\n\n    if (!capsEnum->report)\n        return 0;\n\n    virBufferAsprintf(buf, \"<enum name='%s'\", capsEnumName);\n    if (!capsEnum->values) {\n        virBufferAddLit(buf, \"/>\\n\");\n        return 0;\n    }\n    virBufferAddLit(buf, \">\\n\");\n    virBufferAdjustIndent(buf, 2);\n\n    for (i = 0; i < sizeof(capsEnum->values) * CHAR_BIT; i++) {\n        const char *val;\n\n        if (!(capsEnum->values & (1 << i)))\n            continue;\n\n        if ((val = (valToStr)(i)))\n            virBufferAsprintf(buf, \"<value>%s</value>\\n\", val);\n    }\n    virBufferAdjustIndent(buf, -2);\n    virBufferAddLit(buf, \"</enum>\\n\");\n\n    return 0;\n}"
  },
  {
    "function_name": "virDomainCapsEnumClear",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_capabilities.c",
    "lines": "270-274",
    "snippet": "void\nvirDomainCapsEnumClear(virDomainCapsEnumPtr capsEnum)\n{\n    capsEnum->values = 0;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"domain_conf.h\"",
      "#include \"domain_capabilities.h\"",
      "#include \"device_conf.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"domain_conf.h\"\n#include \"domain_capabilities.h\"\n#include \"device_conf.h\"\n#include <config.h>\n\nvoid\nvirDomainCapsEnumClear(virDomainCapsEnumPtr capsEnum)\n{\n    capsEnum->values = 0;\n}"
  },
  {
    "function_name": "virDomainCapsEnumSet",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_capabilities.c",
    "lines": "243-267",
    "snippet": "int\nvirDomainCapsEnumSet(virDomainCapsEnumPtr capsEnum,\n                     const char *capsEnumName,\n                     size_t nvalues,\n                     unsigned int *values)\n{\n    size_t i;\n\n    for (i = 0; i < nvalues; i++) {\n        unsigned int val = 1 << values[i];\n\n        if (!val) {\n            /* Integer overflow */\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"integer overflow on %s. Please contact the \"\n                             \"libvirt development team at libvir-list@redhat.com\"),\n                           capsEnumName);\n            return -1;\n        }\n\n        capsEnum->values |= val;\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"domain_conf.h\"",
      "#include \"domain_capabilities.h\"",
      "#include \"device_conf.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"integer overflow on %s. Please contact the \"\n                             \"libvirt development team at libvir-list@redhat.com\")",
            "capsEnumName"
          ],
          "line": 256
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"integer overflow on %s. Please contact the \"\n                             \"libvirt development team at libvir-list@redhat.com\""
          ],
          "line": 257
        },
        "resolved": true,
        "details": {
          "function_name": "ATTRIBUTE_NONNULL",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/cpu_conf.c",
          "lines": "135-141",
          "snippet": "int ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"domain_conf.h\"\n#include \"domain_capabilities.h\"\n#include \"device_conf.h\"\n#include <config.h>\n\nint\nvirDomainCapsEnumSet(virDomainCapsEnumPtr capsEnum,\n                     const char *capsEnumName,\n                     size_t nvalues,\n                     unsigned int *values)\n{\n    size_t i;\n\n    for (i = 0; i < nvalues; i++) {\n        unsigned int val = 1 << values[i];\n\n        if (!val) {\n            /* Integer overflow */\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"integer overflow on %s. Please contact the \"\n                             \"libvirt development team at libvir-list@redhat.com\"),\n                           capsEnumName);\n            return -1;\n        }\n\n        capsEnum->values |= val;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virDomainCapsCPUModelsGet",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_capabilities.c",
    "lines": "225-240",
    "snippet": "virDomainCapsCPUModelPtr\nvirDomainCapsCPUModelsGet(virDomainCapsCPUModelsPtr cpuModels,\n                          const char *name)\n{\n    size_t i;\n\n    if (!cpuModels)\n        return NULL;\n\n    for (i = 0; i < cpuModels->nmodels; i++) {\n        if (STREQ(cpuModels->models[i].name, name))\n            return cpuModels->models + i;\n    }\n\n    return NULL;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"domain_conf.h\"",
      "#include \"domain_capabilities.h\"",
      "#include \"device_conf.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "cpuModels->models[i].name",
            "name"
          ],
          "line": 235
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"domain_conf.h\"\n#include \"domain_capabilities.h\"\n#include \"device_conf.h\"\n#include <config.h>\n\nvirDomainCapsCPUModelPtr\nvirDomainCapsCPUModelsGet(virDomainCapsCPUModelsPtr cpuModels,\n                          const char *name)\n{\n    size_t i;\n\n    if (!cpuModels)\n        return NULL;\n\n    for (i = 0; i < cpuModels->nmodels; i++) {\n        if (STREQ(cpuModels->models[i].name, name))\n            return cpuModels->models + i;\n    }\n\n    return NULL;\n}"
  },
  {
    "function_name": "virDomainCapsCPUModelsAdd",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_capabilities.c",
    "lines": "195-222",
    "snippet": "int\nvirDomainCapsCPUModelsAdd(virDomainCapsCPUModelsPtr cpuModels,\n                          const char *name,\n                          virDomainCapsCPUUsable usable,\n                          char **blockers)\n{\n    g_autofree char * nameCopy = NULL;\n    VIR_AUTOSTRINGLIST blockersCopy = NULL;\n    virDomainCapsCPUModelPtr cpu;\n\n    nameCopy = g_strdup(name);\n\n    if (virStringListCopy(&blockersCopy, (const char **)blockers) < 0)\n        return -1;\n\n    if (VIR_RESIZE_N(cpuModels->models, cpuModels->nmodels_max,\n                     cpuModels->nmodels, 1) < 0)\n        return -1;\n\n    cpu = cpuModels->models + cpuModels->nmodels;\n    cpuModels->nmodels++;\n\n    cpu->usable = usable;\n    cpu->name = g_steal_pointer(&nameCopy);\n    cpu->blockers = g_steal_pointer(&blockersCopy);\n\n    return 0;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"domain_conf.h\"",
      "#include \"domain_capabilities.h\"",
      "#include \"device_conf.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_steal_pointer",
          "args": [
            "&blockersCopy"
          ],
          "line": 219
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_steal_pointer",
          "args": [
            "&nameCopy"
          ],
          "line": 218
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_RESIZE_N",
          "args": [
            "cpuModels->models",
            "cpuModels->nmodels_max",
            "cpuModels->nmodels",
            "1"
          ],
          "line": 210
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStringListCopy",
          "args": [
            "&blockersCopy",
            "(const char **)blockers"
          ],
          "line": 207
        },
        "resolved": true,
        "details": {
          "function_name": "virStringListCopy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "272-296",
          "snippet": "int\nvirStringListCopy(char ***dst,\n                  const char **src)\n{\n    char **copy = NULL;\n    size_t i;\n\n    *dst = NULL;\n\n    if (!src)\n        return 0;\n\n    if (VIR_ALLOC_N(copy, virStringListLength(src) + 1) < 0)\n        goto error;\n\n    for (i = 0; src[i]; i++)\n        copy[i] = g_strdup(src[i]);\n\n    *dst = copy;\n    return 0;\n\n error:\n    virStringListFree(copy);\n    return -1;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStringListCopy(char ***dst,\n                  const char **src)\n{\n    char **copy = NULL;\n    size_t i;\n\n    *dst = NULL;\n\n    if (!src)\n        return 0;\n\n    if (VIR_ALLOC_N(copy, virStringListLength(src) + 1) < 0)\n        goto error;\n\n    for (i = 0; src[i]; i++)\n        copy[i] = g_strdup(src[i]);\n\n    *dst = copy;\n    return 0;\n\n error:\n    virStringListFree(copy);\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "name"
          ],
          "line": 205
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"domain_conf.h\"\n#include \"domain_capabilities.h\"\n#include \"device_conf.h\"\n#include <config.h>\n\nint\nvirDomainCapsCPUModelsAdd(virDomainCapsCPUModelsPtr cpuModels,\n                          const char *name,\n                          virDomainCapsCPUUsable usable,\n                          char **blockers)\n{\n    g_autofree char * nameCopy = NULL;\n    VIR_AUTOSTRINGLIST blockersCopy = NULL;\n    virDomainCapsCPUModelPtr cpu;\n\n    nameCopy = g_strdup(name);\n\n    if (virStringListCopy(&blockersCopy, (const char **)blockers) < 0)\n        return -1;\n\n    if (VIR_RESIZE_N(cpuModels->models, cpuModels->nmodels_max,\n                     cpuModels->nmodels, 1) < 0)\n        return -1;\n\n    cpu = cpuModels->models + cpuModels->nmodels;\n    cpuModels->nmodels++;\n\n    cpu->usable = usable;\n    cpu->name = g_steal_pointer(&nameCopy);\n    cpu->blockers = g_steal_pointer(&blockersCopy);\n\n    return 0;\n}"
  },
  {
    "function_name": "virDomainCapsCPUModelsCopy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_capabilities.c",
    "lines": "170-192",
    "snippet": "virDomainCapsCPUModelsPtr\nvirDomainCapsCPUModelsCopy(virDomainCapsCPUModelsPtr old)\n{\n    virDomainCapsCPUModelsPtr cpuModels;\n    size_t i;\n\n    if (!(cpuModels = virDomainCapsCPUModelsNew(old->nmodels)))\n        return NULL;\n\n    for (i = 0; i < old->nmodels; i++) {\n        if (virDomainCapsCPUModelsAdd(cpuModels,\n                                      old->models[i].name,\n                                      old->models[i].usable,\n                                      old->models[i].blockers) < 0)\n            goto error;\n    }\n\n    return cpuModels;\n\n error:\n    virObjectUnref(cpuModels);\n    return NULL;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"domain_conf.h\"",
      "#include \"domain_capabilities.h\"",
      "#include \"device_conf.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "cpuModels"
          ],
          "line": 190
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainCapsCPUModelsAdd",
          "args": [
            "cpuModels",
            "old->models[i].name",
            "old->models[i].usable",
            "old->models[i].blockers"
          ],
          "line": 180
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainCapsCPUModelsAdd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_capabilities.c",
          "lines": "195-222",
          "snippet": "int\nvirDomainCapsCPUModelsAdd(virDomainCapsCPUModelsPtr cpuModels,\n                          const char *name,\n                          virDomainCapsCPUUsable usable,\n                          char **blockers)\n{\n    g_autofree char * nameCopy = NULL;\n    VIR_AUTOSTRINGLIST blockersCopy = NULL;\n    virDomainCapsCPUModelPtr cpu;\n\n    nameCopy = g_strdup(name);\n\n    if (virStringListCopy(&blockersCopy, (const char **)blockers) < 0)\n        return -1;\n\n    if (VIR_RESIZE_N(cpuModels->models, cpuModels->nmodels_max,\n                     cpuModels->nmodels, 1) < 0)\n        return -1;\n\n    cpu = cpuModels->models + cpuModels->nmodels;\n    cpuModels->nmodels++;\n\n    cpu->usable = usable;\n    cpu->name = g_steal_pointer(&nameCopy);\n    cpu->blockers = g_steal_pointer(&blockersCopy);\n\n    return 0;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_capabilities.h\"",
            "#include \"device_conf.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"domain_conf.h\"\n#include \"domain_capabilities.h\"\n#include \"device_conf.h\"\n#include <config.h>\n\nint\nvirDomainCapsCPUModelsAdd(virDomainCapsCPUModelsPtr cpuModels,\n                          const char *name,\n                          virDomainCapsCPUUsable usable,\n                          char **blockers)\n{\n    g_autofree char * nameCopy = NULL;\n    VIR_AUTOSTRINGLIST blockersCopy = NULL;\n    virDomainCapsCPUModelPtr cpu;\n\n    nameCopy = g_strdup(name);\n\n    if (virStringListCopy(&blockersCopy, (const char **)blockers) < 0)\n        return -1;\n\n    if (VIR_RESIZE_N(cpuModels->models, cpuModels->nmodels_max,\n                     cpuModels->nmodels, 1) < 0)\n        return -1;\n\n    cpu = cpuModels->models + cpuModels->nmodels;\n    cpuModels->nmodels++;\n\n    cpu->usable = usable;\n    cpu->name = g_steal_pointer(&nameCopy);\n    cpu->blockers = g_steal_pointer(&blockersCopy);\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainCapsCPUModelsNew",
          "args": [
            "old->nmodels"
          ],
          "line": 176
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainCapsCPUModelsNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_capabilities.c",
          "lines": "147-167",
          "snippet": "virDomainCapsCPUModelsPtr\nvirDomainCapsCPUModelsNew(size_t nmodels)\n{\n    virDomainCapsCPUModelsPtr cpuModels = NULL;\n\n    if (virDomainCapsInitialize() < 0)\n        return NULL;\n\n    if (!(cpuModels = virObjectNew(virDomainCapsCPUModelsClass)))\n        return NULL;\n\n    if (VIR_ALLOC_N(cpuModels->models, nmodels) < 0)\n        goto error;\n    cpuModels->nmodels_max = nmodels;\n\n    return cpuModels;\n\n error:\n    virObjectUnref(cpuModels);\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_capabilities.h\"",
            "#include \"device_conf.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virClassPtr virDomainCapsCPUModelsClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"domain_conf.h\"\n#include \"domain_capabilities.h\"\n#include \"device_conf.h\"\n#include <config.h>\n\nstatic virClassPtr virDomainCapsCPUModelsClass;\n\nvirDomainCapsCPUModelsPtr\nvirDomainCapsCPUModelsNew(size_t nmodels)\n{\n    virDomainCapsCPUModelsPtr cpuModels = NULL;\n\n    if (virDomainCapsInitialize() < 0)\n        return NULL;\n\n    if (!(cpuModels = virObjectNew(virDomainCapsCPUModelsClass)))\n        return NULL;\n\n    if (VIR_ALLOC_N(cpuModels->models, nmodels) < 0)\n        goto error;\n    cpuModels->nmodels_max = nmodels;\n\n    return cpuModels;\n\n error:\n    virObjectUnref(cpuModels);\n    return NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"domain_conf.h\"\n#include \"domain_capabilities.h\"\n#include \"device_conf.h\"\n#include <config.h>\n\nvirDomainCapsCPUModelsPtr\nvirDomainCapsCPUModelsCopy(virDomainCapsCPUModelsPtr old)\n{\n    virDomainCapsCPUModelsPtr cpuModels;\n    size_t i;\n\n    if (!(cpuModels = virDomainCapsCPUModelsNew(old->nmodels)))\n        return NULL;\n\n    for (i = 0; i < old->nmodels; i++) {\n        if (virDomainCapsCPUModelsAdd(cpuModels,\n                                      old->models[i].name,\n                                      old->models[i].usable,\n                                      old->models[i].blockers) < 0)\n            goto error;\n    }\n\n    return cpuModels;\n\n error:\n    virObjectUnref(cpuModels);\n    return NULL;\n}"
  },
  {
    "function_name": "virDomainCapsCPUModelsNew",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_capabilities.c",
    "lines": "147-167",
    "snippet": "virDomainCapsCPUModelsPtr\nvirDomainCapsCPUModelsNew(size_t nmodels)\n{\n    virDomainCapsCPUModelsPtr cpuModels = NULL;\n\n    if (virDomainCapsInitialize() < 0)\n        return NULL;\n\n    if (!(cpuModels = virObjectNew(virDomainCapsCPUModelsClass)))\n        return NULL;\n\n    if (VIR_ALLOC_N(cpuModels->models, nmodels) < 0)\n        goto error;\n    cpuModels->nmodels_max = nmodels;\n\n    return cpuModels;\n\n error:\n    virObjectUnref(cpuModels);\n    return NULL;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"domain_conf.h\"",
      "#include \"domain_capabilities.h\"",
      "#include \"device_conf.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virClassPtr virDomainCapsCPUModelsClass;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "cpuModels"
          ],
          "line": 165
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC_N",
          "args": [
            "cpuModels->models",
            "nmodels"
          ],
          "line": 158
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virObjectNew",
          "args": [
            "virDomainCapsCPUModelsClass"
          ],
          "line": 155
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "236-253",
          "snippet": "void *\nvirObjectNew(virClassPtr klass)\n{\n    virObjectPtr obj = NULL;\n\n    if (VIR_ALLOC_VAR(obj,\n                      char,\n                      klass->objectSize - sizeof(virObject)) < 0)\n        return NULL;\n\n    obj->u.s.magic = klass->magic;\n    obj->klass = klass;\n    g_atomic_int_set(&obj->u.s.refs, 1);\n\n    PROBE(OBJECT_NEW, \"obj=%p classname=%s\", obj, obj->klass->name);\n\n    return obj;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nvoid *\nvirObjectNew(virClassPtr klass)\n{\n    virObjectPtr obj = NULL;\n\n    if (VIR_ALLOC_VAR(obj,\n                      char,\n                      klass->objectSize - sizeof(virObject)) < 0)\n        return NULL;\n\n    obj->u.s.magic = klass->magic;\n    obj->klass = klass;\n    g_atomic_int_set(&obj->u.s.refs, 1);\n\n    PROBE(OBJECT_NEW, \"obj=%p classname=%s\", obj, obj->klass->name);\n\n    return obj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainCapsInitialize",
          "args": [],
          "line": 152
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"domain_conf.h\"\n#include \"domain_capabilities.h\"\n#include \"device_conf.h\"\n#include <config.h>\n\nstatic virClassPtr virDomainCapsCPUModelsClass;\n\nvirDomainCapsCPUModelsPtr\nvirDomainCapsCPUModelsNew(size_t nmodels)\n{\n    virDomainCapsCPUModelsPtr cpuModels = NULL;\n\n    if (virDomainCapsInitialize() < 0)\n        return NULL;\n\n    if (!(cpuModels = virObjectNew(virDomainCapsCPUModelsClass)))\n        return NULL;\n\n    if (VIR_ALLOC_N(cpuModels->models, nmodels) < 0)\n        goto error;\n    cpuModels->nmodels_max = nmodels;\n\n    return cpuModels;\n\n error:\n    virObjectUnref(cpuModels);\n    return NULL;\n}"
  },
  {
    "function_name": "virDomainCapsNew",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_capabilities.c",
    "lines": "124-144",
    "snippet": "virDomainCapsPtr\nvirDomainCapsNew(const char *path,\n                 const char *machine,\n                 virArch arch,\n                 virDomainVirtType virttype)\n{\n    virDomainCapsPtr caps = NULL;\n\n    if (virDomainCapsInitialize() < 0)\n        return NULL;\n\n    if (!(caps = virObjectLockableNew(virDomainCapsClass)))\n        return NULL;\n\n    caps->path = g_strdup(path);\n    caps->machine = g_strdup(machine);\n    caps->arch = arch;\n    caps->virttype = virttype;\n\n    return caps;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"domain_conf.h\"",
      "#include \"domain_capabilities.h\"",
      "#include \"device_conf.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virClassPtr virDomainCapsClass;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "machine"
          ],
          "line": 139
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectLockableNew",
          "args": [
            "virDomainCapsClass"
          ],
          "line": 135
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectLockableNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "256-279",
          "snippet": "void *\nvirObjectLockableNew(virClassPtr klass)\n{\n    virObjectLockablePtr obj;\n\n    if (!virClassIsDerivedFrom(klass, virClassForObjectLockable())) {\n        virReportInvalidArg(klass,\n                            _(\"Class %s must derive from virObjectLockable\"),\n                            virClassName(klass));\n        return NULL;\n    }\n\n    if (!(obj = virObjectNew(klass)))\n        return NULL;\n\n    if (virMutexInit(&obj->lock) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Unable to initialize mutex\"));\n        virObjectUnref(obj);\n        return NULL;\n    }\n\n    return obj;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nvoid *\nvirObjectLockableNew(virClassPtr klass)\n{\n    virObjectLockablePtr obj;\n\n    if (!virClassIsDerivedFrom(klass, virClassForObjectLockable())) {\n        virReportInvalidArg(klass,\n                            _(\"Class %s must derive from virObjectLockable\"),\n                            virClassName(klass));\n        return NULL;\n    }\n\n    if (!(obj = virObjectNew(klass)))\n        return NULL;\n\n    if (virMutexInit(&obj->lock) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"Unable to initialize mutex\"));\n        virObjectUnref(obj);\n        return NULL;\n    }\n\n    return obj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainCapsInitialize",
          "args": [],
          "line": 132
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"domain_conf.h\"\n#include \"domain_capabilities.h\"\n#include \"device_conf.h\"\n#include <config.h>\n\nstatic virClassPtr virDomainCapsClass;\n\nvirDomainCapsPtr\nvirDomainCapsNew(const char *path,\n                 const char *machine,\n                 virArch arch,\n                 virDomainVirtType virttype)\n{\n    virDomainCapsPtr caps = NULL;\n\n    if (virDomainCapsInitialize() < 0)\n        return NULL;\n\n    if (!(caps = virObjectLockableNew(virDomainCapsClass)))\n        return NULL;\n\n    caps->path = g_strdup(path);\n    caps->machine = g_strdup(machine);\n    caps->arch = arch;\n    caps->virttype = virttype;\n\n    return caps;\n}"
  },
  {
    "function_name": "virDomainCapsCPUModelsDispose",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_capabilities.c",
    "lines": "109-121",
    "snippet": "static void\nvirDomainCapsCPUModelsDispose(void *obj)\n{\n    virDomainCapsCPUModelsPtr cpuModels = obj;\n    size_t i;\n\n    for (i = 0; i < cpuModels->nmodels; i++) {\n        VIR_FREE(cpuModels->models[i].name);\n        virStringListFree(cpuModels->models[i].blockers);\n    }\n\n    VIR_FREE(cpuModels->models);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"domain_conf.h\"",
      "#include \"domain_capabilities.h\"",
      "#include \"device_conf.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virDomainCapsDispose(void *obj);",
      "static void virDomainCapsCPUModelsDispose(void *obj);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "cpuModels->models"
          ],
          "line": 120
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStringListFree",
          "args": [
            "cpuModels->models[i].blockers"
          ],
          "line": 117
        },
        "resolved": true,
        "details": {
          "function_name": "virStringListFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "306-314",
          "snippet": "void virStringListFree(char **strings)\n{\n    char **tmp = strings;\n    while (tmp && *tmp) {\n        VIR_FREE(*tmp);\n        tmp++;\n    }\n    VIR_FREE(strings);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nvoid virStringListFree(char **strings)\n{\n    char **tmp = strings;\n    while (tmp && *tmp) {\n        VIR_FREE(*tmp);\n        tmp++;\n    }\n    VIR_FREE(strings);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "cpuModels->models[i].name"
          ],
          "line": 116
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"domain_conf.h\"\n#include \"domain_capabilities.h\"\n#include \"device_conf.h\"\n#include <config.h>\n\nstatic void virDomainCapsDispose(void *obj);\nstatic void virDomainCapsCPUModelsDispose(void *obj);\n\nstatic void\nvirDomainCapsCPUModelsDispose(void *obj)\n{\n    virDomainCapsCPUModelsPtr cpuModels = obj;\n    size_t i;\n\n    for (i = 0; i < cpuModels->nmodels; i++) {\n        VIR_FREE(cpuModels->models[i].name);\n        virStringListFree(cpuModels->models[i].blockers);\n    }\n\n    VIR_FREE(cpuModels->models);\n}"
  },
  {
    "function_name": "virDomainCapsDispose",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_capabilities.c",
    "lines": "94-106",
    "snippet": "static void\nvirDomainCapsDispose(void *obj)\n{\n    virDomainCapsPtr caps = obj;\n\n    VIR_FREE(caps->path);\n    VIR_FREE(caps->machine);\n    virObjectUnref(caps->cpu.custom);\n    virCPUDefFree(caps->cpu.hostModel);\n    virSEVCapabilitiesFree(caps->sev);\n\n    virDomainCapsStringValuesFree(&caps->os.loader.values);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"domain_conf.h\"",
      "#include \"domain_capabilities.h\"",
      "#include \"device_conf.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virDomainCapsDispose(void *obj);",
      "static void virDomainCapsCPUModelsDispose(void *obj);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainCapsStringValuesFree",
          "args": [
            "&caps->os.loader.values"
          ],
          "line": 105
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainCapsStringValuesFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_capabilities.c",
          "lines": "68-79",
          "snippet": "static void\nvirDomainCapsStringValuesFree(virDomainCapsStringValuesPtr values)\n{\n    size_t i;\n\n    if (!values || !values->values)\n        return;\n\n    for (i = 0; i < values->nvalues; i++)\n        VIR_FREE(values->values[i]);\n    VIR_FREE(values->values);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_capabilities.h\"",
            "#include \"device_conf.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"domain_conf.h\"\n#include \"domain_capabilities.h\"\n#include \"device_conf.h\"\n#include <config.h>\n\nstatic void\nvirDomainCapsStringValuesFree(virDomainCapsStringValuesPtr values)\n{\n    size_t i;\n\n    if (!values || !values->values)\n        return;\n\n    for (i = 0; i < values->nvalues; i++)\n        VIR_FREE(values->values[i]);\n    VIR_FREE(values->values);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSEVCapabilitiesFree",
          "args": [
            "caps->sev"
          ],
          "line": 103
        },
        "resolved": true,
        "details": {
          "function_name": "virSEVCapabilitiesFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_capabilities.c",
          "lines": "82-91",
          "snippet": "void\nvirSEVCapabilitiesFree(virSEVCapability *cap)\n{\n    if (!cap)\n        return;\n\n    VIR_FREE(cap->pdh);\n    VIR_FREE(cap->cert_chain);\n    VIR_FREE(cap);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_capabilities.h\"",
            "#include \"device_conf.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"domain_conf.h\"\n#include \"domain_capabilities.h\"\n#include \"device_conf.h\"\n#include <config.h>\n\nvoid\nvirSEVCapabilitiesFree(virSEVCapability *cap)\n{\n    if (!cap)\n        return;\n\n    VIR_FREE(cap->pdh);\n    VIR_FREE(cap->cert_chain);\n    VIR_FREE(cap);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCPUDefFree",
          "args": [
            "caps->cpu.hostModel"
          ],
          "line": 102
        },
        "resolved": true,
        "details": {
          "function_name": "virCPUDefFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/cpu_conf.c",
          "lines": "120-132",
          "snippet": "void\nvirCPUDefFree(virCPUDefPtr def)\n{\n    if (!def)\n        return;\n\n    if (g_atomic_int_dec_and_test(&def->refs)) {\n        virCPUDefFreeModel(def);\n        VIR_FREE(def->cache);\n        VIR_FREE(def->tsc);\n        VIR_FREE(def);\n    }\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvoid\nvirCPUDefFree(virCPUDefPtr def)\n{\n    if (!def)\n        return;\n\n    if (g_atomic_int_dec_and_test(&def->refs)) {\n        virCPUDefFreeModel(def);\n        VIR_FREE(def->cache);\n        VIR_FREE(def->tsc);\n        VIR_FREE(def);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "caps->cpu.custom"
          ],
          "line": 101
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "caps->machine"
          ],
          "line": 100
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "caps->path"
          ],
          "line": 99
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"domain_conf.h\"\n#include \"domain_capabilities.h\"\n#include \"device_conf.h\"\n#include <config.h>\n\nstatic void virDomainCapsDispose(void *obj);\nstatic void virDomainCapsCPUModelsDispose(void *obj);\n\nstatic void\nvirDomainCapsDispose(void *obj)\n{\n    virDomainCapsPtr caps = obj;\n\n    VIR_FREE(caps->path);\n    VIR_FREE(caps->machine);\n    virObjectUnref(caps->cpu.custom);\n    virCPUDefFree(caps->cpu.hostModel);\n    virSEVCapabilitiesFree(caps->sev);\n\n    virDomainCapsStringValuesFree(&caps->os.loader.values);\n}"
  },
  {
    "function_name": "virSEVCapabilitiesFree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_capabilities.c",
    "lines": "82-91",
    "snippet": "void\nvirSEVCapabilitiesFree(virSEVCapability *cap)\n{\n    if (!cap)\n        return;\n\n    VIR_FREE(cap->pdh);\n    VIR_FREE(cap->cert_chain);\n    VIR_FREE(cap);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"domain_conf.h\"",
      "#include \"domain_capabilities.h\"",
      "#include \"device_conf.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "cap"
          ],
          "line": 90
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "cap->cert_chain"
          ],
          "line": 89
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "cap->pdh"
          ],
          "line": 88
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"domain_conf.h\"\n#include \"domain_capabilities.h\"\n#include \"device_conf.h\"\n#include <config.h>\n\nvoid\nvirSEVCapabilitiesFree(virSEVCapability *cap)\n{\n    if (!cap)\n        return;\n\n    VIR_FREE(cap->pdh);\n    VIR_FREE(cap->cert_chain);\n    VIR_FREE(cap);\n}"
  },
  {
    "function_name": "virDomainCapsStringValuesFree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_capabilities.c",
    "lines": "68-79",
    "snippet": "static void\nvirDomainCapsStringValuesFree(virDomainCapsStringValuesPtr values)\n{\n    size_t i;\n\n    if (!values || !values->values)\n        return;\n\n    for (i = 0; i < values->nvalues; i++)\n        VIR_FREE(values->values[i]);\n    VIR_FREE(values->values);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"domain_conf.h\"",
      "#include \"domain_capabilities.h\"",
      "#include \"device_conf.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "values->values"
          ],
          "line": 78
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "values->values[i]"
          ],
          "line": 77
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"domain_conf.h\"\n#include \"domain_capabilities.h\"\n#include \"device_conf.h\"\n#include <config.h>\n\nstatic void\nvirDomainCapsStringValuesFree(virDomainCapsStringValuesPtr values)\n{\n    size_t i;\n\n    if (!values || !values->values)\n        return;\n\n    for (i = 0; i < values->nvalues; i++)\n        VIR_FREE(values->values[i]);\n    VIR_FREE(values->values);\n}"
  },
  {
    "function_name": "virDomainCapsOnceInit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_capabilities.c",
    "lines": "53-62",
    "snippet": "static int virDomainCapsOnceInit(void)\n{\n    if (!VIR_CLASS_NEW(virDomainCaps, virClassForObjectLockable()))\n        return -1;\n\n    if (!VIR_CLASS_NEW(virDomainCapsCPUModels, virClassForObject()))\n        return -1;\n\n    return 0;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"domain_conf.h\"",
      "#include \"domain_capabilities.h\"",
      "#include \"device_conf.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_CLASS_NEW",
          "args": [
            "virDomainCapsCPUModels",
            "virClassForObject()"
          ],
          "line": 58
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virClassForObject",
          "args": [],
          "line": 58
        },
        "resolved": true,
        "details": {
          "function_name": "virClassForObjectEvent",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/object_event.c",
          "lines": "110-116",
          "snippet": "virClassPtr\nvirClassForObjectEvent(void)\n{\n    if (virObjectEventInitialize() < 0)\n        return NULL;\n    return virObjectEventClass;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virobject.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"object_event_private.h\"",
            "#include \"object_event.h\"",
            "#include \"network_event.h\"",
            "#include \"domain_event.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virClassPtr virObjectEventClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virobject.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"object_event_private.h\"\n#include \"object_event.h\"\n#include \"network_event.h\"\n#include \"domain_event.h\"\n#include <config.h>\n\nstatic virClassPtr virObjectEventClass;\n\nvirClassPtr\nvirClassForObjectEvent(void)\n{\n    if (virObjectEventInitialize() < 0)\n        return NULL;\n    return virObjectEventClass;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_CLASS_NEW",
          "args": [
            "virDomainCaps",
            "virClassForObjectLockable()"
          ],
          "line": 55
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virClassForObjectLockable",
          "args": [],
          "line": 55
        },
        "resolved": true,
        "details": {
          "function_name": "virClassForObjectLockable",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "116-123",
          "snippet": "virClassPtr\nvirClassForObjectLockable(void)\n{\n    if (virObjectInitialize() < 0)\n        return NULL;\n\n    return virObjectLockableClass;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virClassPtr virObjectLockableClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic virClassPtr virObjectLockableClass;\n\nvirClassPtr\nvirClassForObjectLockable(void)\n{\n    if (virObjectInitialize() < 0)\n        return NULL;\n\n    return virObjectLockableClass;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"domain_conf.h\"\n#include \"domain_capabilities.h\"\n#include \"device_conf.h\"\n#include <config.h>\n\nstatic int virDomainCapsOnceInit(void)\n{\n    if (!VIR_CLASS_NEW(virDomainCaps, virClassForObjectLockable()))\n        return -1;\n\n    if (!VIR_CLASS_NEW(virDomainCapsCPUModels, virClassForObject()))\n        return -1;\n\n    return 0;\n}"
  }
]