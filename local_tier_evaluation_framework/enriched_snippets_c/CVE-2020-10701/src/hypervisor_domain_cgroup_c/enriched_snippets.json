[
  {
    "function_name": "virDomainCgroupSetMemoryLimitParameters",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/hypervisor/domain_cgroup.c",
    "lines": "192-270",
    "snippet": "int\nvirDomainCgroupSetMemoryLimitParameters(virCgroupPtr cgroup,\n                                        virDomainObjPtr vm,\n                                        virDomainDefPtr liveDef,\n                                        virDomainDefPtr persistentDef,\n                                        virTypedParameterPtr params,\n                                        int nparams)\n{\n    unsigned long long swap_hard_limit;\n    unsigned long long hard_limit = 0;\n    unsigned long long soft_limit = 0;\n    bool set_swap_hard_limit = false;\n    bool set_hard_limit = false;\n    bool set_soft_limit = false;\n    int rc;\n\n#define VIR_GET_LIMIT_PARAMETER(PARAM, VALUE) \\\n    if ((rc = virTypedParamsGetULLong(params, nparams, PARAM, &VALUE)) < 0) \\\n        return -1; \\\n \\\n    if (rc == 1) \\\n        set_ ## VALUE = true;\n\n    VIR_GET_LIMIT_PARAMETER(VIR_DOMAIN_MEMORY_SWAP_HARD_LIMIT, swap_hard_limit)\n    VIR_GET_LIMIT_PARAMETER(VIR_DOMAIN_MEMORY_HARD_LIMIT, hard_limit)\n    VIR_GET_LIMIT_PARAMETER(VIR_DOMAIN_MEMORY_SOFT_LIMIT, soft_limit)\n\n#undef VIR_GET_LIMIT_PARAMETER\n\n    /* Swap hard limit must be greater than hard limit. */\n    if (set_swap_hard_limit || set_hard_limit) {\n        unsigned long long mem_limit = vm->def->mem.hard_limit;\n        unsigned long long swap_limit = vm->def->mem.swap_hard_limit;\n\n        if (set_swap_hard_limit)\n            swap_limit = swap_hard_limit;\n\n        if (set_hard_limit)\n            mem_limit = hard_limit;\n\n        if (mem_limit > swap_limit) {\n            virReportError(VIR_ERR_INVALID_ARG, \"%s\",\n                           _(\"memory hard_limit tunable value must be lower \"\n                             \"than or equal to swap_hard_limit\"));\n            return -1;\n        }\n    }\n\n#define VIR_SET_MEM_PARAMETER(FUNC, VALUE) \\\n    if (set_ ## VALUE) { \\\n        if (liveDef) { \\\n            if ((rc = FUNC(cgroup, VALUE)) < 0) \\\n                return -1; \\\n            liveDef->mem.VALUE = VALUE; \\\n        } \\\n \\\n        if (persistentDef) \\\n            persistentDef->mem.VALUE = VALUE; \\\n    }\n\n    /* Soft limit doesn't clash with the others */\n    VIR_SET_MEM_PARAMETER(virCgroupSetMemorySoftLimit, soft_limit);\n\n    /* set hard limit before swap hard limit if decreasing it */\n    if (liveDef && liveDef->mem.hard_limit > hard_limit) {\n        VIR_SET_MEM_PARAMETER(virCgroupSetMemoryHardLimit, hard_limit);\n        /* inhibit changing the limit a second time */\n        set_hard_limit = false;\n    }\n\n    VIR_SET_MEM_PARAMETER(virCgroupSetMemSwapHardLimit, swap_hard_limit);\n\n    /* otherwise increase it after swap hard limit */\n    VIR_SET_MEM_PARAMETER(virCgroupSetMemoryHardLimit, hard_limit);\n\n#undef VIR_SET_MEM_PARAMETER\n\n    return 0;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_SET_MEM_PARAMETER",
          "args": [
            "virCgroupSetMemoryHardLimit",
            "hard_limit"
          ],
          "line": 265
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_SET_MEM_PARAMETER",
          "args": [
            "virCgroupSetMemSwapHardLimit",
            "swap_hard_limit"
          ],
          "line": 262
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_SET_MEM_PARAMETER",
          "args": [
            "virCgroupSetMemoryHardLimit",
            "hard_limit"
          ],
          "line": 257
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_SET_MEM_PARAMETER",
          "args": [
            "virCgroupSetMemorySoftLimit",
            "soft_limit"
          ],
          "line": 253
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INVALID_ARG",
            "\"%s\"",
            "_(\"memory hard_limit tunable value must be lower \"\n                             \"than or equal to swap_hard_limit\")"
          ],
          "line": 233
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"memory hard_limit tunable value must be lower \"\n                             \"than or equal to swap_hard_limit\""
          ],
          "line": 234
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_GET_LIMIT_PARAMETER",
          "args": [
            "VIR_DOMAIN_MEMORY_SOFT_LIMIT",
            "soft_limit"
          ],
          "line": 217
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_GET_LIMIT_PARAMETER",
          "args": [
            "VIR_DOMAIN_MEMORY_HARD_LIMIT",
            "hard_limit"
          ],
          "line": 216
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_GET_LIMIT_PARAMETER",
          "args": [
            "VIR_DOMAIN_MEMORY_SWAP_HARD_LIMIT",
            "swap_hard_limit"
          ],
          "line": 215
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include <config.h>\n\nint\nvirDomainCgroupSetMemoryLimitParameters(virCgroupPtr cgroup,\n                                        virDomainObjPtr vm,\n                                        virDomainDefPtr liveDef,\n                                        virDomainDefPtr persistentDef,\n                                        virTypedParameterPtr params,\n                                        int nparams)\n{\n    unsigned long long swap_hard_limit;\n    unsigned long long hard_limit = 0;\n    unsigned long long soft_limit = 0;\n    bool set_swap_hard_limit = false;\n    bool set_hard_limit = false;\n    bool set_soft_limit = false;\n    int rc;\n\n#define VIR_GET_LIMIT_PARAMETER(PARAM, VALUE) \\\n    if ((rc = virTypedParamsGetULLong(params, nparams, PARAM, &VALUE)) < 0) \\\n        return -1; \\\n \\\n    if (rc == 1) \\\n        set_ ## VALUE = true;\n\n    VIR_GET_LIMIT_PARAMETER(VIR_DOMAIN_MEMORY_SWAP_HARD_LIMIT, swap_hard_limit)\n    VIR_GET_LIMIT_PARAMETER(VIR_DOMAIN_MEMORY_HARD_LIMIT, hard_limit)\n    VIR_GET_LIMIT_PARAMETER(VIR_DOMAIN_MEMORY_SOFT_LIMIT, soft_limit)\n\n#undef VIR_GET_LIMIT_PARAMETER\n\n    /* Swap hard limit must be greater than hard limit. */\n    if (set_swap_hard_limit || set_hard_limit) {\n        unsigned long long mem_limit = vm->def->mem.hard_limit;\n        unsigned long long swap_limit = vm->def->mem.swap_hard_limit;\n\n        if (set_swap_hard_limit)\n            swap_limit = swap_hard_limit;\n\n        if (set_hard_limit)\n            mem_limit = hard_limit;\n\n        if (mem_limit > swap_limit) {\n            virReportError(VIR_ERR_INVALID_ARG, \"%s\",\n                           _(\"memory hard_limit tunable value must be lower \"\n                             \"than or equal to swap_hard_limit\"));\n            return -1;\n        }\n    }\n\n#define VIR_SET_MEM_PARAMETER(FUNC, VALUE) \\\n    if (set_ ## VALUE) { \\\n        if (liveDef) { \\\n            if ((rc = FUNC(cgroup, VALUE)) < 0) \\\n                return -1; \\\n            liveDef->mem.VALUE = VALUE; \\\n        } \\\n \\\n        if (persistentDef) \\\n            persistentDef->mem.VALUE = VALUE; \\\n    }\n\n    /* Soft limit doesn't clash with the others */\n    VIR_SET_MEM_PARAMETER(virCgroupSetMemorySoftLimit, soft_limit);\n\n    /* set hard limit before swap hard limit if decreasing it */\n    if (liveDef && liveDef->mem.hard_limit > hard_limit) {\n        VIR_SET_MEM_PARAMETER(virCgroupSetMemoryHardLimit, hard_limit);\n        /* inhibit changing the limit a second time */\n        set_hard_limit = false;\n    }\n\n    VIR_SET_MEM_PARAMETER(virCgroupSetMemSwapHardLimit, swap_hard_limit);\n\n    /* otherwise increase it after swap hard limit */\n    VIR_SET_MEM_PARAMETER(virCgroupSetMemoryHardLimit, hard_limit);\n\n#undef VIR_SET_MEM_PARAMETER\n\n    return 0;\n}"
  },
  {
    "function_name": "virDomainCgroupSetupDomainBlkioParameters",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/hypervisor/domain_cgroup.c",
    "lines": "94-189",
    "snippet": "int\nvirDomainCgroupSetupDomainBlkioParameters(virCgroupPtr cgroup,\n                                          virDomainDefPtr def,\n                                          virTypedParameterPtr params,\n                                          int nparams)\n{\n    size_t i;\n    int ret = 0;\n\n    for (i = 0; i < nparams; i++) {\n        virTypedParameterPtr param = &params[i];\n\n        if (STREQ(param->field, VIR_DOMAIN_BLKIO_WEIGHT)) {\n            if (virCgroupSetBlkioWeight(cgroup, params[i].value.ui) < 0)\n                ret = -1;\n        } else if (STREQ(param->field, VIR_DOMAIN_BLKIO_DEVICE_WEIGHT) ||\n                   STREQ(param->field, VIR_DOMAIN_BLKIO_DEVICE_READ_IOPS) ||\n                   STREQ(param->field, VIR_DOMAIN_BLKIO_DEVICE_WRITE_IOPS) ||\n                   STREQ(param->field, VIR_DOMAIN_BLKIO_DEVICE_READ_BPS) ||\n                   STREQ(param->field, VIR_DOMAIN_BLKIO_DEVICE_WRITE_BPS)) {\n            size_t ndevices;\n            virBlkioDevicePtr devices = NULL;\n            size_t j;\n\n            if (virDomainDriverParseBlkioDeviceStr(params[i].value.s,\n                                                   param->field,\n                                                   &devices,\n                                                   &ndevices) < 0) {\n                ret = -1;\n                continue;\n            }\n\n            if (STREQ(param->field, VIR_DOMAIN_BLKIO_DEVICE_WEIGHT)) {\n                for (j = 0; j < ndevices; j++) {\n                    if (virCgroupSetupBlkioDeviceWeight(cgroup, devices[j].path,\n                                                        &devices[j].weight) < 0) {\n                        ret = -1;\n                        break;\n                    }\n                }\n            } else if (STREQ(param->field, VIR_DOMAIN_BLKIO_DEVICE_READ_IOPS)) {\n                for (j = 0; j < ndevices; j++) {\n                    if (virCgroupSetupBlkioDeviceReadIops(cgroup, devices[j].path,\n                                                          &devices[j].riops) < 0) {\n                        ret = -1;\n                        break;\n                    }\n                }\n            } else if (STREQ(param->field, VIR_DOMAIN_BLKIO_DEVICE_WRITE_IOPS)) {\n                for (j = 0; j < ndevices; j++) {\n                    if (virCgroupSetupBlkioDeviceWriteIops(cgroup, devices[j].path,\n                                                           &devices[j].wiops) < 0) {\n                        ret = -1;\n                        break;\n                    }\n                }\n            } else if (STREQ(param->field, VIR_DOMAIN_BLKIO_DEVICE_READ_BPS)) {\n                for (j = 0; j < ndevices; j++) {\n                    if (virCgroupSetupBlkioDeviceReadBps(cgroup, devices[j].path,\n                                                         &devices[j].rbps) < 0) {\n                        ret = -1;\n                        break;\n                    }\n                }\n            } else if (STREQ(param->field, VIR_DOMAIN_BLKIO_DEVICE_WRITE_BPS)) {\n                for (j = 0; j < ndevices; j++) {\n                    if (virCgroupSetupBlkioDeviceWriteBps(cgroup, devices[j].path,\n                                                          &devices[j].wbps) < 0) {\n                        ret = -1;\n                        break;\n                    }\n                }\n            } else {\n                virReportError(VIR_ERR_INVALID_ARG, _(\"Unknown blkio parameter %s\"),\n                               param->field);\n                ret = -1;\n                virBlkioDeviceArrayClear(devices, ndevices);\n                g_free(devices);\n\n                continue;\n            }\n\n            if (j != ndevices ||\n                virDomainDriverMergeBlkioDevice(&def->blkio.devices,\n                                                &def->blkio.ndevices,\n                                                devices, ndevices,\n                                                param->field) < 0)\n                ret = -1;\n\n            virBlkioDeviceArrayClear(devices, ndevices);\n            g_free(devices);\n        }\n    }\n\n    return ret;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_free",
          "args": [
            "devices"
          ],
          "line": 184
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBlkioDeviceArrayClear",
          "args": [
            "devices",
            "ndevices"
          ],
          "line": 183
        },
        "resolved": true,
        "details": {
          "function_name": "virBlkioDeviceArrayClear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "1538-1546",
          "snippet": "void\nvirBlkioDeviceArrayClear(virBlkioDevicePtr devices,\n                         int ndevices)\n{\n    size_t i;\n\n    for (i = 0; i < ndevices; i++)\n        VIR_FREE(devices[i].path);\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirBlkioDeviceArrayClear(virBlkioDevicePtr devices,\n                         int ndevices)\n{\n    size_t i;\n\n    for (i = 0; i < ndevices; i++)\n        VIR_FREE(devices[i].path);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDriverMergeBlkioDevice",
          "args": [
            "&def->blkio.devices",
            "&def->blkio.ndevices",
            "devices",
            "ndevices",
            "param->field"
          ],
          "line": 177
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDriverMergeBlkioDevice",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/hypervisor/domain_driver.c",
          "lines": "32-97",
          "snippet": "int\nvirDomainDriverMergeBlkioDevice(virBlkioDevicePtr *dest_array,\n                                size_t *dest_size,\n                                virBlkioDevicePtr src_array,\n                                size_t src_size,\n                                const char *type)\n{\n    size_t i, j;\n    virBlkioDevicePtr dest, src;\n\n    for (i = 0; i < src_size; i++) {\n        bool found = false;\n\n        src = &src_array[i];\n        for (j = 0; j < *dest_size; j++) {\n            dest = &(*dest_array)[j];\n            if (STREQ(src->path, dest->path)) {\n                found = true;\n\n                if (STREQ(type, VIR_DOMAIN_BLKIO_DEVICE_WEIGHT)) {\n                    dest->weight = src->weight;\n                } else if (STREQ(type, VIR_DOMAIN_BLKIO_DEVICE_READ_IOPS)) {\n                    dest->riops = src->riops;\n                } else if (STREQ(type, VIR_DOMAIN_BLKIO_DEVICE_WRITE_IOPS)) {\n                    dest->wiops = src->wiops;\n                } else if (STREQ(type, VIR_DOMAIN_BLKIO_DEVICE_READ_BPS)) {\n                    dest->rbps = src->rbps;\n                } else if (STREQ(type, VIR_DOMAIN_BLKIO_DEVICE_WRITE_BPS)) {\n                    dest->wbps = src->wbps;\n                } else {\n                    virReportError(VIR_ERR_INVALID_ARG, _(\"Unknown parameter %s\"),\n                                   type);\n                    return -1;\n                }\n                break;\n            }\n        }\n        if (!found) {\n            if (!src->weight && !src->riops && !src->wiops && !src->rbps && !src->wbps)\n                continue;\n            if (VIR_EXPAND_N(*dest_array, *dest_size, 1) < 0)\n                return -1;\n            dest = &(*dest_array)[*dest_size - 1];\n\n            if (STREQ(type, VIR_DOMAIN_BLKIO_DEVICE_WEIGHT)) {\n                dest->weight = src->weight;\n            } else if (STREQ(type, VIR_DOMAIN_BLKIO_DEVICE_READ_IOPS)) {\n                dest->riops = src->riops;\n            } else if (STREQ(type, VIR_DOMAIN_BLKIO_DEVICE_WRITE_IOPS)) {\n                dest->wiops = src->wiops;\n            } else if (STREQ(type, VIR_DOMAIN_BLKIO_DEVICE_READ_BPS)) {\n                dest->rbps = src->rbps;\n            } else if (STREQ(type, VIR_DOMAIN_BLKIO_DEVICE_WRITE_BPS)) {\n                dest->wbps = src->wbps;\n            } else {\n                *dest_size = *dest_size - 1;\n                return -1;\n            }\n\n            dest->path = src->path;\n            src->path = NULL;\n        }\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"domain_driver.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"domain_driver.h\"\n#include <config.h>\n\nint\nvirDomainDriverMergeBlkioDevice(virBlkioDevicePtr *dest_array,\n                                size_t *dest_size,\n                                virBlkioDevicePtr src_array,\n                                size_t src_size,\n                                const char *type)\n{\n    size_t i, j;\n    virBlkioDevicePtr dest, src;\n\n    for (i = 0; i < src_size; i++) {\n        bool found = false;\n\n        src = &src_array[i];\n        for (j = 0; j < *dest_size; j++) {\n            dest = &(*dest_array)[j];\n            if (STREQ(src->path, dest->path)) {\n                found = true;\n\n                if (STREQ(type, VIR_DOMAIN_BLKIO_DEVICE_WEIGHT)) {\n                    dest->weight = src->weight;\n                } else if (STREQ(type, VIR_DOMAIN_BLKIO_DEVICE_READ_IOPS)) {\n                    dest->riops = src->riops;\n                } else if (STREQ(type, VIR_DOMAIN_BLKIO_DEVICE_WRITE_IOPS)) {\n                    dest->wiops = src->wiops;\n                } else if (STREQ(type, VIR_DOMAIN_BLKIO_DEVICE_READ_BPS)) {\n                    dest->rbps = src->rbps;\n                } else if (STREQ(type, VIR_DOMAIN_BLKIO_DEVICE_WRITE_BPS)) {\n                    dest->wbps = src->wbps;\n                } else {\n                    virReportError(VIR_ERR_INVALID_ARG, _(\"Unknown parameter %s\"),\n                                   type);\n                    return -1;\n                }\n                break;\n            }\n        }\n        if (!found) {\n            if (!src->weight && !src->riops && !src->wiops && !src->rbps && !src->wbps)\n                continue;\n            if (VIR_EXPAND_N(*dest_array, *dest_size, 1) < 0)\n                return -1;\n            dest = &(*dest_array)[*dest_size - 1];\n\n            if (STREQ(type, VIR_DOMAIN_BLKIO_DEVICE_WEIGHT)) {\n                dest->weight = src->weight;\n            } else if (STREQ(type, VIR_DOMAIN_BLKIO_DEVICE_READ_IOPS)) {\n                dest->riops = src->riops;\n            } else if (STREQ(type, VIR_DOMAIN_BLKIO_DEVICE_WRITE_IOPS)) {\n                dest->wiops = src->wiops;\n            } else if (STREQ(type, VIR_DOMAIN_BLKIO_DEVICE_READ_BPS)) {\n                dest->rbps = src->rbps;\n            } else if (STREQ(type, VIR_DOMAIN_BLKIO_DEVICE_WRITE_BPS)) {\n                dest->wbps = src->wbps;\n            } else {\n                *dest_size = *dest_size - 1;\n                return -1;\n            }\n\n            dest->path = src->path;\n            src->path = NULL;\n        }\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_free",
          "args": [
            "devices"
          ],
          "line": 171
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INVALID_ARG",
            "_(\"Unknown blkio parameter %s\")",
            "param->field"
          ],
          "line": 167
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unknown blkio parameter %s\""
          ],
          "line": 167
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupSetupBlkioDeviceWriteBps",
          "args": [
            "cgroup",
            "devices[j].path",
            "&devices[j].wbps"
          ],
          "line": 160
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupSetupBlkioDeviceWriteBps",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3659-3668",
          "snippet": "int\nvirCgroupSetupBlkioDeviceWriteBps(virCgroupPtr cgroup, const char *path,\n                                  unsigned long long *wbps)\n{\n    if (virCgroupSetBlkioDeviceWriteBps(cgroup, path, *wbps) < 0 ||\n        virCgroupGetBlkioDeviceWriteBps(cgroup, path, wbps) < 0)\n        return -1;\n\n    return 0;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupSetupBlkioDeviceWriteBps(virCgroupPtr cgroup, const char *path,\n                                  unsigned long long *wbps)\n{\n    if (virCgroupSetBlkioDeviceWriteBps(cgroup, path, *wbps) < 0 ||\n        virCgroupGetBlkioDeviceWriteBps(cgroup, path, wbps) < 0)\n        return -1;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "param->field",
            "VIR_DOMAIN_BLKIO_DEVICE_WRITE_BPS"
          ],
          "line": 158
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCgroupSetupBlkioDeviceReadBps",
          "args": [
            "cgroup",
            "devices[j].path",
            "&devices[j].rbps"
          ],
          "line": 152
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupSetupBlkioDeviceReadBps",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3642-3651",
          "snippet": "int\nvirCgroupSetupBlkioDeviceReadBps(virCgroupPtr cgroup, const char *path,\n                                 unsigned long long *rbps)\n{\n    if (virCgroupSetBlkioDeviceReadBps(cgroup, path, *rbps) < 0 ||\n        virCgroupGetBlkioDeviceReadBps(cgroup, path, rbps) < 0)\n        return -1;\n\n    return 0;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupSetupBlkioDeviceReadBps(virCgroupPtr cgroup, const char *path,\n                                 unsigned long long *rbps)\n{\n    if (virCgroupSetBlkioDeviceReadBps(cgroup, path, *rbps) < 0 ||\n        virCgroupGetBlkioDeviceReadBps(cgroup, path, rbps) < 0)\n        return -1;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "param->field",
            "VIR_DOMAIN_BLKIO_DEVICE_READ_BPS"
          ],
          "line": 150
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCgroupSetupBlkioDeviceWriteIops",
          "args": [
            "cgroup",
            "devices[j].path",
            "&devices[j].wiops"
          ],
          "line": 144
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupSetupBlkioDeviceWriteIops",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3625-3634",
          "snippet": "int\nvirCgroupSetupBlkioDeviceWriteIops(virCgroupPtr cgroup, const char *path,\n                                   unsigned int *wiops)\n{\n    if (virCgroupSetBlkioDeviceWriteIops(cgroup, path, *wiops) < 0 ||\n        virCgroupGetBlkioDeviceWriteIops(cgroup, path, wiops) < 0)\n        return -1;\n\n    return 0;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupSetupBlkioDeviceWriteIops(virCgroupPtr cgroup, const char *path,\n                                   unsigned int *wiops)\n{\n    if (virCgroupSetBlkioDeviceWriteIops(cgroup, path, *wiops) < 0 ||\n        virCgroupGetBlkioDeviceWriteIops(cgroup, path, wiops) < 0)\n        return -1;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "param->field",
            "VIR_DOMAIN_BLKIO_DEVICE_WRITE_IOPS"
          ],
          "line": 142
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCgroupSetupBlkioDeviceReadIops",
          "args": [
            "cgroup",
            "devices[j].path",
            "&devices[j].riops"
          ],
          "line": 136
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupSetupBlkioDeviceReadIops",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3608-3617",
          "snippet": "int\nvirCgroupSetupBlkioDeviceReadIops(virCgroupPtr cgroup, const char *path,\n                                  unsigned int *riops)\n{\n    if (virCgroupSetBlkioDeviceReadIops(cgroup, path, *riops) < 0 ||\n        virCgroupGetBlkioDeviceReadIops(cgroup, path, riops) < 0)\n        return -1;\n\n    return 0;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupSetupBlkioDeviceReadIops(virCgroupPtr cgroup, const char *path,\n                                  unsigned int *riops)\n{\n    if (virCgroupSetBlkioDeviceReadIops(cgroup, path, *riops) < 0 ||\n        virCgroupGetBlkioDeviceReadIops(cgroup, path, riops) < 0)\n        return -1;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "param->field",
            "VIR_DOMAIN_BLKIO_DEVICE_READ_IOPS"
          ],
          "line": 134
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCgroupSetupBlkioDeviceWeight",
          "args": [
            "cgroup",
            "devices[j].path",
            "&devices[j].weight"
          ],
          "line": 128
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupSetupBlkioDeviceWeight",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3591-3600",
          "snippet": "int\nvirCgroupSetupBlkioDeviceWeight(virCgroupPtr cgroup, const char *path,\n                                unsigned int *weight)\n{\n    if (virCgroupSetBlkioDeviceWeight(cgroup, path, *weight) < 0 ||\n        virCgroupGetBlkioDeviceWeight(cgroup, path, weight) < 0)\n        return -1;\n\n    return 0;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupSetupBlkioDeviceWeight(virCgroupPtr cgroup, const char *path,\n                                unsigned int *weight)\n{\n    if (virCgroupSetBlkioDeviceWeight(cgroup, path, *weight) < 0 ||\n        virCgroupGetBlkioDeviceWeight(cgroup, path, weight) < 0)\n        return -1;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "param->field",
            "VIR_DOMAIN_BLKIO_DEVICE_WEIGHT"
          ],
          "line": 126
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainDriverParseBlkioDeviceStr",
          "args": [
            "params[i].value.s",
            "param->field",
            "&devices",
            "&ndevices"
          ],
          "line": 118
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDriverParseBlkioDeviceStr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/hypervisor/domain_driver.c",
          "lines": "103-208",
          "snippet": "int\nvirDomainDriverParseBlkioDeviceStr(char *blkioDeviceStr, const char *type,\n                                   virBlkioDevicePtr *dev, size_t *size)\n{\n    char *temp;\n    int ndevices = 0;\n    int nsep = 0;\n    size_t i;\n    virBlkioDevicePtr result = NULL;\n\n    *dev = NULL;\n    *size = 0;\n\n    if (STREQ(blkioDeviceStr, \"\"))\n        return 0;\n\n    temp = blkioDeviceStr;\n    while (temp) {\n        temp = strchr(temp, ',');\n        if (temp) {\n            temp++;\n            nsep++;\n        }\n    }\n\n    /* A valid string must have even number of fields, hence an odd\n     * number of commas.  */\n    if (!(nsep & 1))\n        goto parse_error;\n\n    ndevices = (nsep + 1) / 2;\n\n    if (VIR_ALLOC_N(result, ndevices) < 0)\n        return -1;\n\n    i = 0;\n    temp = blkioDeviceStr;\n    while (temp) {\n        char *p = temp;\n\n        /* device path */\n        p = strchr(p, ',');\n        if (!p)\n            goto parse_error;\n\n        result[i].path = g_strndup(temp, p - temp);\n\n        /* value */\n        temp = p + 1;\n\n        if (STREQ(type, VIR_DOMAIN_BLKIO_DEVICE_WEIGHT)) {\n            if (virStrToLong_uip(temp, &p, 10, &result[i].weight) < 0)\n                goto number_error;\n        } else if (STREQ(type, VIR_DOMAIN_BLKIO_DEVICE_READ_IOPS)) {\n            if (virStrToLong_uip(temp, &p, 10, &result[i].riops) < 0)\n                goto number_error;\n        } else if (STREQ(type, VIR_DOMAIN_BLKIO_DEVICE_WRITE_IOPS)) {\n            if (virStrToLong_uip(temp, &p, 10, &result[i].wiops) < 0)\n                goto number_error;\n        } else if (STREQ(type, VIR_DOMAIN_BLKIO_DEVICE_READ_BPS)) {\n            if (virStrToLong_ullp(temp, &p, 10, &result[i].rbps) < 0)\n                goto number_error;\n        } else if (STREQ(type, VIR_DOMAIN_BLKIO_DEVICE_WRITE_BPS)) {\n            if (virStrToLong_ullp(temp, &p, 10, &result[i].wbps) < 0)\n                goto number_error;\n        } else {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"unknown parameter '%s'\"), type);\n            goto cleanup;\n        }\n\n        i++;\n\n        if (*p == '\\0')\n            break;\n        else if (*p != ',')\n            goto parse_error;\n        temp = p + 1;\n    }\n\n    if (!i)\n        VIR_FREE(result);\n\n    *dev = result;\n    *size = i;\n\n    return 0;\n\n parse_error:\n    virReportError(VIR_ERR_INVALID_ARG,\n                   _(\"unable to parse blkio device '%s' '%s'\"),\n                   type, blkioDeviceStr);\n    goto cleanup;\n\n number_error:\n    virReportError(VIR_ERR_INVALID_ARG,\n                   _(\"invalid value '%s' for parameter '%s' of device '%s'\"),\n                   temp, type, result[i].path);\n\n cleanup:\n    if (result) {\n        virBlkioDeviceArrayClear(result, ndevices);\n        VIR_FREE(result);\n    }\n    return -1;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"domain_driver.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"domain_driver.h\"\n#include <config.h>\n\nint\nvirDomainDriverParseBlkioDeviceStr(char *blkioDeviceStr, const char *type,\n                                   virBlkioDevicePtr *dev, size_t *size)\n{\n    char *temp;\n    int ndevices = 0;\n    int nsep = 0;\n    size_t i;\n    virBlkioDevicePtr result = NULL;\n\n    *dev = NULL;\n    *size = 0;\n\n    if (STREQ(blkioDeviceStr, \"\"))\n        return 0;\n\n    temp = blkioDeviceStr;\n    while (temp) {\n        temp = strchr(temp, ',');\n        if (temp) {\n            temp++;\n            nsep++;\n        }\n    }\n\n    /* A valid string must have even number of fields, hence an odd\n     * number of commas.  */\n    if (!(nsep & 1))\n        goto parse_error;\n\n    ndevices = (nsep + 1) / 2;\n\n    if (VIR_ALLOC_N(result, ndevices) < 0)\n        return -1;\n\n    i = 0;\n    temp = blkioDeviceStr;\n    while (temp) {\n        char *p = temp;\n\n        /* device path */\n        p = strchr(p, ',');\n        if (!p)\n            goto parse_error;\n\n        result[i].path = g_strndup(temp, p - temp);\n\n        /* value */\n        temp = p + 1;\n\n        if (STREQ(type, VIR_DOMAIN_BLKIO_DEVICE_WEIGHT)) {\n            if (virStrToLong_uip(temp, &p, 10, &result[i].weight) < 0)\n                goto number_error;\n        } else if (STREQ(type, VIR_DOMAIN_BLKIO_DEVICE_READ_IOPS)) {\n            if (virStrToLong_uip(temp, &p, 10, &result[i].riops) < 0)\n                goto number_error;\n        } else if (STREQ(type, VIR_DOMAIN_BLKIO_DEVICE_WRITE_IOPS)) {\n            if (virStrToLong_uip(temp, &p, 10, &result[i].wiops) < 0)\n                goto number_error;\n        } else if (STREQ(type, VIR_DOMAIN_BLKIO_DEVICE_READ_BPS)) {\n            if (virStrToLong_ullp(temp, &p, 10, &result[i].rbps) < 0)\n                goto number_error;\n        } else if (STREQ(type, VIR_DOMAIN_BLKIO_DEVICE_WRITE_BPS)) {\n            if (virStrToLong_ullp(temp, &p, 10, &result[i].wbps) < 0)\n                goto number_error;\n        } else {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"unknown parameter '%s'\"), type);\n            goto cleanup;\n        }\n\n        i++;\n\n        if (*p == '\\0')\n            break;\n        else if (*p != ',')\n            goto parse_error;\n        temp = p + 1;\n    }\n\n    if (!i)\n        VIR_FREE(result);\n\n    *dev = result;\n    *size = i;\n\n    return 0;\n\n parse_error:\n    virReportError(VIR_ERR_INVALID_ARG,\n                   _(\"unable to parse blkio device '%s' '%s'\"),\n                   type, blkioDeviceStr);\n    goto cleanup;\n\n number_error:\n    virReportError(VIR_ERR_INVALID_ARG,\n                   _(\"invalid value '%s' for parameter '%s' of device '%s'\"),\n                   temp, type, result[i].path);\n\n cleanup:\n    if (result) {\n        virBlkioDeviceArrayClear(result, ndevices);\n        VIR_FREE(result);\n    }\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "param->field",
            "VIR_DOMAIN_BLKIO_DEVICE_WRITE_BPS"
          ],
          "line": 113
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "param->field",
            "VIR_DOMAIN_BLKIO_DEVICE_READ_BPS"
          ],
          "line": 112
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "param->field",
            "VIR_DOMAIN_BLKIO_DEVICE_WRITE_IOPS"
          ],
          "line": 111
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "param->field",
            "VIR_DOMAIN_BLKIO_DEVICE_READ_IOPS"
          ],
          "line": 110
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "param->field",
            "VIR_DOMAIN_BLKIO_DEVICE_WEIGHT"
          ],
          "line": 109
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCgroupSetBlkioWeight",
          "args": [
            "cgroup",
            "params[i].value.ui"
          ],
          "line": 107
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupSetBlkioWeight",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "2976-2983",
          "snippet": "int\nvirCgroupSetBlkioWeight(virCgroupPtr group G_GNUC_UNUSED,\n                        unsigned int weight G_GNUC_UNUSED)\n{\n    virReportSystemError(ENXIO, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupSetBlkioWeight(virCgroupPtr group G_GNUC_UNUSED,\n                        unsigned int weight G_GNUC_UNUSED)\n{\n    virReportSystemError(ENXIO, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "param->field",
            "VIR_DOMAIN_BLKIO_WEIGHT"
          ],
          "line": 106
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include <config.h>\n\nint\nvirDomainCgroupSetupDomainBlkioParameters(virCgroupPtr cgroup,\n                                          virDomainDefPtr def,\n                                          virTypedParameterPtr params,\n                                          int nparams)\n{\n    size_t i;\n    int ret = 0;\n\n    for (i = 0; i < nparams; i++) {\n        virTypedParameterPtr param = &params[i];\n\n        if (STREQ(param->field, VIR_DOMAIN_BLKIO_WEIGHT)) {\n            if (virCgroupSetBlkioWeight(cgroup, params[i].value.ui) < 0)\n                ret = -1;\n        } else if (STREQ(param->field, VIR_DOMAIN_BLKIO_DEVICE_WEIGHT) ||\n                   STREQ(param->field, VIR_DOMAIN_BLKIO_DEVICE_READ_IOPS) ||\n                   STREQ(param->field, VIR_DOMAIN_BLKIO_DEVICE_WRITE_IOPS) ||\n                   STREQ(param->field, VIR_DOMAIN_BLKIO_DEVICE_READ_BPS) ||\n                   STREQ(param->field, VIR_DOMAIN_BLKIO_DEVICE_WRITE_BPS)) {\n            size_t ndevices;\n            virBlkioDevicePtr devices = NULL;\n            size_t j;\n\n            if (virDomainDriverParseBlkioDeviceStr(params[i].value.s,\n                                                   param->field,\n                                                   &devices,\n                                                   &ndevices) < 0) {\n                ret = -1;\n                continue;\n            }\n\n            if (STREQ(param->field, VIR_DOMAIN_BLKIO_DEVICE_WEIGHT)) {\n                for (j = 0; j < ndevices; j++) {\n                    if (virCgroupSetupBlkioDeviceWeight(cgroup, devices[j].path,\n                                                        &devices[j].weight) < 0) {\n                        ret = -1;\n                        break;\n                    }\n                }\n            } else if (STREQ(param->field, VIR_DOMAIN_BLKIO_DEVICE_READ_IOPS)) {\n                for (j = 0; j < ndevices; j++) {\n                    if (virCgroupSetupBlkioDeviceReadIops(cgroup, devices[j].path,\n                                                          &devices[j].riops) < 0) {\n                        ret = -1;\n                        break;\n                    }\n                }\n            } else if (STREQ(param->field, VIR_DOMAIN_BLKIO_DEVICE_WRITE_IOPS)) {\n                for (j = 0; j < ndevices; j++) {\n                    if (virCgroupSetupBlkioDeviceWriteIops(cgroup, devices[j].path,\n                                                           &devices[j].wiops) < 0) {\n                        ret = -1;\n                        break;\n                    }\n                }\n            } else if (STREQ(param->field, VIR_DOMAIN_BLKIO_DEVICE_READ_BPS)) {\n                for (j = 0; j < ndevices; j++) {\n                    if (virCgroupSetupBlkioDeviceReadBps(cgroup, devices[j].path,\n                                                         &devices[j].rbps) < 0) {\n                        ret = -1;\n                        break;\n                    }\n                }\n            } else if (STREQ(param->field, VIR_DOMAIN_BLKIO_DEVICE_WRITE_BPS)) {\n                for (j = 0; j < ndevices; j++) {\n                    if (virCgroupSetupBlkioDeviceWriteBps(cgroup, devices[j].path,\n                                                          &devices[j].wbps) < 0) {\n                        ret = -1;\n                        break;\n                    }\n                }\n            } else {\n                virReportError(VIR_ERR_INVALID_ARG, _(\"Unknown blkio parameter %s\"),\n                               param->field);\n                ret = -1;\n                virBlkioDeviceArrayClear(devices, ndevices);\n                g_free(devices);\n\n                continue;\n            }\n\n            if (j != ndevices ||\n                virDomainDriverMergeBlkioDevice(&def->blkio.devices,\n                                                &def->blkio.ndevices,\n                                                devices, ndevices,\n                                                param->field) < 0)\n                ret = -1;\n\n            virBlkioDeviceArrayClear(devices, ndevices);\n            g_free(devices);\n        }\n    }\n\n    return ret;\n}"
  },
  {
    "function_name": "virDomainCgroupSetupMemtune",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/hypervisor/domain_cgroup.c",
    "lines": "75-91",
    "snippet": "int\nvirDomainCgroupSetupMemtune(virCgroupPtr cgroup, virDomainMemtune mem)\n{\n    if (virMemoryLimitIsSet(mem.hard_limit))\n        if (virCgroupSetMemoryHardLimit(cgroup, mem.hard_limit) < 0)\n            return -1;\n\n    if (virMemoryLimitIsSet(mem.soft_limit))\n        if (virCgroupSetMemorySoftLimit(cgroup, mem.soft_limit) < 0)\n            return -1;\n\n    if (virMemoryLimitIsSet(mem.swap_hard_limit))\n        if (virCgroupSetMemSwapHardLimit(cgroup, mem.swap_hard_limit) < 0)\n            return -1;\n\n    return 0;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCgroupSetMemSwapHardLimit",
          "args": [
            "cgroup",
            "mem.swap_hard_limit"
          ],
          "line": 87
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupSetMemSwapHardLimit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3171-3178",
          "snippet": "int\nvirCgroupSetMemSwapHardLimit(virCgroupPtr group G_GNUC_UNUSED,\n                             unsigned long long kb G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupSetMemSwapHardLimit(virCgroupPtr group G_GNUC_UNUSED,\n                             unsigned long long kb G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virMemoryLimitIsSet",
          "args": [
            "mem.swap_hard_limit"
          ],
          "line": 86
        },
        "resolved": true,
        "details": {
          "function_name": "virMemoryLimitIsSet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
          "lines": "1628-1632",
          "snippet": "bool\nvirMemoryLimitIsSet(unsigned long long value)\n{\n    return value < VIR_DOMAIN_MEMORY_PARAM_UNLIMITED;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <sys/prctl.h>",
            "# include <cap-ng.h>",
            "# include <grp.h>",
            "# include <pwd.h>",
            "# include <libdevmapper.h>",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <conio.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nbool\nvirMemoryLimitIsSet(unsigned long long value)\n{\n    return value < VIR_DOMAIN_MEMORY_PARAM_UNLIMITED;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupSetMemorySoftLimit",
          "args": [
            "cgroup",
            "mem.soft_limit"
          ],
          "line": 83
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupSetMemorySoftLimit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3151-3158",
          "snippet": "int\nvirCgroupSetMemorySoftLimit(virCgroupPtr group G_GNUC_UNUSED,\n                            unsigned long long kb G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupSetMemorySoftLimit(virCgroupPtr group G_GNUC_UNUSED,\n                            unsigned long long kb G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupSetMemoryHardLimit",
          "args": [
            "cgroup",
            "mem.hard_limit"
          ],
          "line": 79
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupSetMemoryHardLimit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3131-3138",
          "snippet": "int\nvirCgroupSetMemoryHardLimit(virCgroupPtr group G_GNUC_UNUSED,\n                            unsigned long long kb G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupSetMemoryHardLimit(virCgroupPtr group G_GNUC_UNUSED,\n                            unsigned long long kb G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include <config.h>\n\nint\nvirDomainCgroupSetupMemtune(virCgroupPtr cgroup, virDomainMemtune mem)\n{\n    if (virMemoryLimitIsSet(mem.hard_limit))\n        if (virCgroupSetMemoryHardLimit(cgroup, mem.hard_limit) < 0)\n            return -1;\n\n    if (virMemoryLimitIsSet(mem.soft_limit))\n        if (virCgroupSetMemorySoftLimit(cgroup, mem.soft_limit) < 0)\n            return -1;\n\n    if (virMemoryLimitIsSet(mem.swap_hard_limit))\n        if (virCgroupSetMemSwapHardLimit(cgroup, mem.swap_hard_limit) < 0)\n            return -1;\n\n    return 0;\n}"
  },
  {
    "function_name": "virDomainCgroupSetupBlkio",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/hypervisor/domain_cgroup.c",
    "lines": "31-72",
    "snippet": "int\nvirDomainCgroupSetupBlkio(virCgroupPtr cgroup, virDomainBlkiotune blkio)\n{\n    size_t i;\n\n    if (blkio.weight != 0 &&\n        virCgroupSetBlkioWeight(cgroup, blkio.weight) < 0)\n        return -1;\n\n    if (blkio.ndevices) {\n        for (i = 0; i < blkio.ndevices; i++) {\n            virBlkioDevicePtr dev = &blkio.devices[i];\n\n            if (dev->weight &&\n                virCgroupSetupBlkioDeviceWeight(cgroup, dev->path,\n                                                &dev->weight) < 0)\n                return -1;\n\n            if (dev->riops &&\n                virCgroupSetupBlkioDeviceReadIops(cgroup, dev->path,\n                                                  &dev->riops) < 0)\n                return -1;\n\n            if (dev->wiops &&\n                virCgroupSetupBlkioDeviceWriteIops(cgroup, dev->path,\n                                                   &dev->wiops) < 0)\n                return -1;\n\n            if (dev->rbps &&\n                virCgroupSetupBlkioDeviceReadBps(cgroup, dev->path,\n                                                 &dev->rbps) < 0)\n                return -1;\n\n            if (dev->wbps &&\n                virCgroupSetupBlkioDeviceWriteBps(cgroup, dev->path,\n                                                  &dev->wbps) < 0)\n                return -1;\n        }\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virutil.h\"",
      "#include \"domain_driver.h\"",
      "#include \"domain_cgroup.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCgroupSetupBlkioDeviceWriteBps",
          "args": [
            "cgroup",
            "dev->path",
            "&dev->wbps"
          ],
          "line": 65
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupSetupBlkioDeviceWriteBps",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3659-3668",
          "snippet": "int\nvirCgroupSetupBlkioDeviceWriteBps(virCgroupPtr cgroup, const char *path,\n                                  unsigned long long *wbps)\n{\n    if (virCgroupSetBlkioDeviceWriteBps(cgroup, path, *wbps) < 0 ||\n        virCgroupGetBlkioDeviceWriteBps(cgroup, path, wbps) < 0)\n        return -1;\n\n    return 0;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupSetupBlkioDeviceWriteBps(virCgroupPtr cgroup, const char *path,\n                                  unsigned long long *wbps)\n{\n    if (virCgroupSetBlkioDeviceWriteBps(cgroup, path, *wbps) < 0 ||\n        virCgroupGetBlkioDeviceWriteBps(cgroup, path, wbps) < 0)\n        return -1;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupSetupBlkioDeviceReadBps",
          "args": [
            "cgroup",
            "dev->path",
            "&dev->rbps"
          ],
          "line": 60
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupSetupBlkioDeviceReadBps",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3642-3651",
          "snippet": "int\nvirCgroupSetupBlkioDeviceReadBps(virCgroupPtr cgroup, const char *path,\n                                 unsigned long long *rbps)\n{\n    if (virCgroupSetBlkioDeviceReadBps(cgroup, path, *rbps) < 0 ||\n        virCgroupGetBlkioDeviceReadBps(cgroup, path, rbps) < 0)\n        return -1;\n\n    return 0;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupSetupBlkioDeviceReadBps(virCgroupPtr cgroup, const char *path,\n                                 unsigned long long *rbps)\n{\n    if (virCgroupSetBlkioDeviceReadBps(cgroup, path, *rbps) < 0 ||\n        virCgroupGetBlkioDeviceReadBps(cgroup, path, rbps) < 0)\n        return -1;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupSetupBlkioDeviceWriteIops",
          "args": [
            "cgroup",
            "dev->path",
            "&dev->wiops"
          ],
          "line": 55
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupSetupBlkioDeviceWriteIops",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3625-3634",
          "snippet": "int\nvirCgroupSetupBlkioDeviceWriteIops(virCgroupPtr cgroup, const char *path,\n                                   unsigned int *wiops)\n{\n    if (virCgroupSetBlkioDeviceWriteIops(cgroup, path, *wiops) < 0 ||\n        virCgroupGetBlkioDeviceWriteIops(cgroup, path, wiops) < 0)\n        return -1;\n\n    return 0;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupSetupBlkioDeviceWriteIops(virCgroupPtr cgroup, const char *path,\n                                   unsigned int *wiops)\n{\n    if (virCgroupSetBlkioDeviceWriteIops(cgroup, path, *wiops) < 0 ||\n        virCgroupGetBlkioDeviceWriteIops(cgroup, path, wiops) < 0)\n        return -1;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupSetupBlkioDeviceReadIops",
          "args": [
            "cgroup",
            "dev->path",
            "&dev->riops"
          ],
          "line": 50
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupSetupBlkioDeviceReadIops",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3608-3617",
          "snippet": "int\nvirCgroupSetupBlkioDeviceReadIops(virCgroupPtr cgroup, const char *path,\n                                  unsigned int *riops)\n{\n    if (virCgroupSetBlkioDeviceReadIops(cgroup, path, *riops) < 0 ||\n        virCgroupGetBlkioDeviceReadIops(cgroup, path, riops) < 0)\n        return -1;\n\n    return 0;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupSetupBlkioDeviceReadIops(virCgroupPtr cgroup, const char *path,\n                                  unsigned int *riops)\n{\n    if (virCgroupSetBlkioDeviceReadIops(cgroup, path, *riops) < 0 ||\n        virCgroupGetBlkioDeviceReadIops(cgroup, path, riops) < 0)\n        return -1;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupSetupBlkioDeviceWeight",
          "args": [
            "cgroup",
            "dev->path",
            "&dev->weight"
          ],
          "line": 45
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupSetupBlkioDeviceWeight",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3591-3600",
          "snippet": "int\nvirCgroupSetupBlkioDeviceWeight(virCgroupPtr cgroup, const char *path,\n                                unsigned int *weight)\n{\n    if (virCgroupSetBlkioDeviceWeight(cgroup, path, *weight) < 0 ||\n        virCgroupGetBlkioDeviceWeight(cgroup, path, weight) < 0)\n        return -1;\n\n    return 0;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupSetupBlkioDeviceWeight(virCgroupPtr cgroup, const char *path,\n                                unsigned int *weight)\n{\n    if (virCgroupSetBlkioDeviceWeight(cgroup, path, *weight) < 0 ||\n        virCgroupGetBlkioDeviceWeight(cgroup, path, weight) < 0)\n        return -1;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupSetBlkioWeight",
          "args": [
            "cgroup",
            "blkio.weight"
          ],
          "line": 37
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupSetBlkioWeight",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "2976-2983",
          "snippet": "int\nvirCgroupSetBlkioWeight(virCgroupPtr group G_GNUC_UNUSED,\n                        unsigned int weight G_GNUC_UNUSED)\n{\n    virReportSystemError(ENXIO, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupSetBlkioWeight(virCgroupPtr group G_GNUC_UNUSED,\n                        unsigned int weight G_GNUC_UNUSED)\n{\n    virReportSystemError(ENXIO, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virutil.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include <config.h>\n\nint\nvirDomainCgroupSetupBlkio(virCgroupPtr cgroup, virDomainBlkiotune blkio)\n{\n    size_t i;\n\n    if (blkio.weight != 0 &&\n        virCgroupSetBlkioWeight(cgroup, blkio.weight) < 0)\n        return -1;\n\n    if (blkio.ndevices) {\n        for (i = 0; i < blkio.ndevices; i++) {\n            virBlkioDevicePtr dev = &blkio.devices[i];\n\n            if (dev->weight &&\n                virCgroupSetupBlkioDeviceWeight(cgroup, dev->path,\n                                                &dev->weight) < 0)\n                return -1;\n\n            if (dev->riops &&\n                virCgroupSetupBlkioDeviceReadIops(cgroup, dev->path,\n                                                  &dev->riops) < 0)\n                return -1;\n\n            if (dev->wiops &&\n                virCgroupSetupBlkioDeviceWriteIops(cgroup, dev->path,\n                                                   &dev->wiops) < 0)\n                return -1;\n\n            if (dev->rbps &&\n                virCgroupSetupBlkioDeviceReadBps(cgroup, dev->path,\n                                                 &dev->rbps) < 0)\n                return -1;\n\n            if (dev->wbps &&\n                virCgroupSetupBlkioDeviceWriteBps(cgroup, dev->path,\n                                                  &dev->wbps) < 0)\n                return -1;\n        }\n    }\n\n    return 0;\n}"
  }
]