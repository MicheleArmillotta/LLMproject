[
  {
    "function_name": "virTypedParamListAddDouble",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam.c",
    "lines": "909-928",
    "snippet": "int\nvirTypedParamListAddDouble(virTypedParamListPtr list,\n                           double value,\n                           const char *namefmt,\n                           ...)\n{\n    virTypedParameterPtr par;\n    va_list ap;\n    int ret;\n\n    if (!(par = virTypedParamListExtend(list)) ||\n        virTypedParameterAssignValue(par, true, VIR_TYPED_PARAM_DOUBLE, value) < 0)\n        return -1;\n\n    va_start(ap, namefmt);\n    ret = virTypedParamSetNameVPrintf(par, namefmt, ap);\n    va_end(ap);\n\n    return ret;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include <stdarg.h>",
      "#include \"virtypedparam.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "va_end",
          "args": [
            "ap"
          ],
          "line": 925
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virTypedParamSetNameVPrintf",
          "args": [
            "par",
            "namefmt",
            "ap"
          ],
          "line": 924
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_start",
          "args": [
            "ap",
            "namefmt"
          ],
          "line": 923
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virTypedParameterAssignValue",
          "args": [
            "par",
            "true",
            "VIR_TYPED_PARAM_DOUBLE",
            "value"
          ],
          "line": 920
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParameterAssignValue",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam.c",
          "lines": "255-269",
          "snippet": "static int\nvirTypedParameterAssignValue(virTypedParameterPtr param,\n                             bool copystr,\n                             int type,\n                             ...)\n{\n    int ret;\n    va_list ap;\n\n    va_start(ap, type);\n    ret = virTypedParameterAssignValueVArgs(param, type, ap, copystr);\n    va_end(ap);\n\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <stdarg.h>",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <stdarg.h>\n#include \"virtypedparam.h\"\n#include <config.h>\n\nstatic int\nvirTypedParameterAssignValue(virTypedParameterPtr param,\n                             bool copystr,\n                             int type,\n                             ...)\n{\n    int ret;\n    va_list ap;\n\n    va_start(ap, type);\n    ret = virTypedParameterAssignValueVArgs(param, type, ap, copystr);\n    va_end(ap);\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virTypedParamListExtend",
          "args": [
            "list"
          ],
          "line": 919
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <stdarg.h>\n#include \"virtypedparam.h\"\n#include <config.h>\n\nint\nvirTypedParamListAddDouble(virTypedParamListPtr list,\n                           double value,\n                           const char *namefmt,\n                           ...)\n{\n    virTypedParameterPtr par;\n    va_list ap;\n    int ret;\n\n    if (!(par = virTypedParamListExtend(list)) ||\n        virTypedParameterAssignValue(par, true, VIR_TYPED_PARAM_DOUBLE, value) < 0)\n        return -1;\n\n    va_start(ap, namefmt);\n    ret = virTypedParamSetNameVPrintf(par, namefmt, ap);\n    va_end(ap);\n\n    return ret;\n}"
  },
  {
    "function_name": "virTypedParamListAddBoolean",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam.c",
    "lines": "887-906",
    "snippet": "int\nvirTypedParamListAddBoolean(virTypedParamListPtr list,\n                            bool value,\n                            const char *namefmt,\n                            ...)\n{\n    virTypedParameterPtr par;\n    va_list ap;\n    int ret;\n\n    if (!(par = virTypedParamListExtend(list)) ||\n        virTypedParameterAssignValue(par, true, VIR_TYPED_PARAM_BOOLEAN, value) < 0)\n        return -1;\n\n    va_start(ap, namefmt);\n    ret = virTypedParamSetNameVPrintf(par, namefmt, ap);\n    va_end(ap);\n\n    return ret;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include <stdarg.h>",
      "#include \"virtypedparam.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "va_end",
          "args": [
            "ap"
          ],
          "line": 903
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virTypedParamSetNameVPrintf",
          "args": [
            "par",
            "namefmt",
            "ap"
          ],
          "line": 902
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_start",
          "args": [
            "ap",
            "namefmt"
          ],
          "line": 901
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virTypedParameterAssignValue",
          "args": [
            "par",
            "true",
            "VIR_TYPED_PARAM_BOOLEAN",
            "value"
          ],
          "line": 898
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParameterAssignValue",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam.c",
          "lines": "255-269",
          "snippet": "static int\nvirTypedParameterAssignValue(virTypedParameterPtr param,\n                             bool copystr,\n                             int type,\n                             ...)\n{\n    int ret;\n    va_list ap;\n\n    va_start(ap, type);\n    ret = virTypedParameterAssignValueVArgs(param, type, ap, copystr);\n    va_end(ap);\n\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <stdarg.h>",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <stdarg.h>\n#include \"virtypedparam.h\"\n#include <config.h>\n\nstatic int\nvirTypedParameterAssignValue(virTypedParameterPtr param,\n                             bool copystr,\n                             int type,\n                             ...)\n{\n    int ret;\n    va_list ap;\n\n    va_start(ap, type);\n    ret = virTypedParameterAssignValueVArgs(param, type, ap, copystr);\n    va_end(ap);\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virTypedParamListExtend",
          "args": [
            "list"
          ],
          "line": 897
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <stdarg.h>\n#include \"virtypedparam.h\"\n#include <config.h>\n\nint\nvirTypedParamListAddBoolean(virTypedParamListPtr list,\n                            bool value,\n                            const char *namefmt,\n                            ...)\n{\n    virTypedParameterPtr par;\n    va_list ap;\n    int ret;\n\n    if (!(par = virTypedParamListExtend(list)) ||\n        virTypedParameterAssignValue(par, true, VIR_TYPED_PARAM_BOOLEAN, value) < 0)\n        return -1;\n\n    va_start(ap, namefmt);\n    ret = virTypedParamSetNameVPrintf(par, namefmt, ap);\n    va_end(ap);\n\n    return ret;\n}"
  },
  {
    "function_name": "virTypedParamListAddString",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam.c",
    "lines": "865-884",
    "snippet": "int\nvirTypedParamListAddString(virTypedParamListPtr list,\n                           const char *value,\n                           const char *namefmt,\n                           ...)\n{\n    virTypedParameterPtr par;\n    va_list ap;\n    int ret;\n\n    if (!(par = virTypedParamListExtend(list)) ||\n        virTypedParameterAssignValue(par, true, VIR_TYPED_PARAM_STRING, value) < 0)\n        return -1;\n\n    va_start(ap, namefmt);\n    ret = virTypedParamSetNameVPrintf(par, namefmt, ap);\n    va_end(ap);\n\n    return ret;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include <stdarg.h>",
      "#include \"virtypedparam.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "va_end",
          "args": [
            "ap"
          ],
          "line": 881
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virTypedParamSetNameVPrintf",
          "args": [
            "par",
            "namefmt",
            "ap"
          ],
          "line": 880
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_start",
          "args": [
            "ap",
            "namefmt"
          ],
          "line": 879
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virTypedParameterAssignValue",
          "args": [
            "par",
            "true",
            "VIR_TYPED_PARAM_STRING",
            "value"
          ],
          "line": 876
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParameterAssignValue",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam.c",
          "lines": "255-269",
          "snippet": "static int\nvirTypedParameterAssignValue(virTypedParameterPtr param,\n                             bool copystr,\n                             int type,\n                             ...)\n{\n    int ret;\n    va_list ap;\n\n    va_start(ap, type);\n    ret = virTypedParameterAssignValueVArgs(param, type, ap, copystr);\n    va_end(ap);\n\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <stdarg.h>",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <stdarg.h>\n#include \"virtypedparam.h\"\n#include <config.h>\n\nstatic int\nvirTypedParameterAssignValue(virTypedParameterPtr param,\n                             bool copystr,\n                             int type,\n                             ...)\n{\n    int ret;\n    va_list ap;\n\n    va_start(ap, type);\n    ret = virTypedParameterAssignValueVArgs(param, type, ap, copystr);\n    va_end(ap);\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virTypedParamListExtend",
          "args": [
            "list"
          ],
          "line": 875
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <stdarg.h>\n#include \"virtypedparam.h\"\n#include <config.h>\n\nint\nvirTypedParamListAddString(virTypedParamListPtr list,\n                           const char *value,\n                           const char *namefmt,\n                           ...)\n{\n    virTypedParameterPtr par;\n    va_list ap;\n    int ret;\n\n    if (!(par = virTypedParamListExtend(list)) ||\n        virTypedParameterAssignValue(par, true, VIR_TYPED_PARAM_STRING, value) < 0)\n        return -1;\n\n    va_start(ap, namefmt);\n    ret = virTypedParamSetNameVPrintf(par, namefmt, ap);\n    va_end(ap);\n\n    return ret;\n}"
  },
  {
    "function_name": "virTypedParamListAddULLong",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam.c",
    "lines": "843-862",
    "snippet": "int\nvirTypedParamListAddULLong(virTypedParamListPtr list,\n                           unsigned long long value,\n                           const char *namefmt,\n                           ...)\n{\n    virTypedParameterPtr par;\n    va_list ap;\n    int ret;\n\n    if (!(par = virTypedParamListExtend(list)) ||\n        virTypedParameterAssignValue(par, true, VIR_TYPED_PARAM_ULLONG, value) < 0)\n        return -1;\n\n    va_start(ap, namefmt);\n    ret = virTypedParamSetNameVPrintf(par, namefmt, ap);\n    va_end(ap);\n\n    return ret;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include <stdarg.h>",
      "#include \"virtypedparam.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "va_end",
          "args": [
            "ap"
          ],
          "line": 859
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virTypedParamSetNameVPrintf",
          "args": [
            "par",
            "namefmt",
            "ap"
          ],
          "line": 858
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_start",
          "args": [
            "ap",
            "namefmt"
          ],
          "line": 857
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virTypedParameterAssignValue",
          "args": [
            "par",
            "true",
            "VIR_TYPED_PARAM_ULLONG",
            "value"
          ],
          "line": 854
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParameterAssignValue",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam.c",
          "lines": "255-269",
          "snippet": "static int\nvirTypedParameterAssignValue(virTypedParameterPtr param,\n                             bool copystr,\n                             int type,\n                             ...)\n{\n    int ret;\n    va_list ap;\n\n    va_start(ap, type);\n    ret = virTypedParameterAssignValueVArgs(param, type, ap, copystr);\n    va_end(ap);\n\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <stdarg.h>",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <stdarg.h>\n#include \"virtypedparam.h\"\n#include <config.h>\n\nstatic int\nvirTypedParameterAssignValue(virTypedParameterPtr param,\n                             bool copystr,\n                             int type,\n                             ...)\n{\n    int ret;\n    va_list ap;\n\n    va_start(ap, type);\n    ret = virTypedParameterAssignValueVArgs(param, type, ap, copystr);\n    va_end(ap);\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virTypedParamListExtend",
          "args": [
            "list"
          ],
          "line": 853
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <stdarg.h>\n#include \"virtypedparam.h\"\n#include <config.h>\n\nint\nvirTypedParamListAddULLong(virTypedParamListPtr list,\n                           unsigned long long value,\n                           const char *namefmt,\n                           ...)\n{\n    virTypedParameterPtr par;\n    va_list ap;\n    int ret;\n\n    if (!(par = virTypedParamListExtend(list)) ||\n        virTypedParameterAssignValue(par, true, VIR_TYPED_PARAM_ULLONG, value) < 0)\n        return -1;\n\n    va_start(ap, namefmt);\n    ret = virTypedParamSetNameVPrintf(par, namefmt, ap);\n    va_end(ap);\n\n    return ret;\n}"
  },
  {
    "function_name": "virTypedParamListAddLLong",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam.c",
    "lines": "821-840",
    "snippet": "int\nvirTypedParamListAddLLong(virTypedParamListPtr list,\n                          long long value,\n                          const char *namefmt,\n                          ...)\n{\n    virTypedParameterPtr par;\n    va_list ap;\n    int ret;\n\n    if (!(par = virTypedParamListExtend(list)) ||\n        virTypedParameterAssignValue(par, true, VIR_TYPED_PARAM_LLONG, value) < 0)\n        return -1;\n\n    va_start(ap, namefmt);\n    ret = virTypedParamSetNameVPrintf(par, namefmt, ap);\n    va_end(ap);\n\n    return ret;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include <stdarg.h>",
      "#include \"virtypedparam.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "va_end",
          "args": [
            "ap"
          ],
          "line": 837
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virTypedParamSetNameVPrintf",
          "args": [
            "par",
            "namefmt",
            "ap"
          ],
          "line": 836
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_start",
          "args": [
            "ap",
            "namefmt"
          ],
          "line": 835
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virTypedParameterAssignValue",
          "args": [
            "par",
            "true",
            "VIR_TYPED_PARAM_LLONG",
            "value"
          ],
          "line": 832
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParameterAssignValue",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam.c",
          "lines": "255-269",
          "snippet": "static int\nvirTypedParameterAssignValue(virTypedParameterPtr param,\n                             bool copystr,\n                             int type,\n                             ...)\n{\n    int ret;\n    va_list ap;\n\n    va_start(ap, type);\n    ret = virTypedParameterAssignValueVArgs(param, type, ap, copystr);\n    va_end(ap);\n\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <stdarg.h>",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <stdarg.h>\n#include \"virtypedparam.h\"\n#include <config.h>\n\nstatic int\nvirTypedParameterAssignValue(virTypedParameterPtr param,\n                             bool copystr,\n                             int type,\n                             ...)\n{\n    int ret;\n    va_list ap;\n\n    va_start(ap, type);\n    ret = virTypedParameterAssignValueVArgs(param, type, ap, copystr);\n    va_end(ap);\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virTypedParamListExtend",
          "args": [
            "list"
          ],
          "line": 831
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <stdarg.h>\n#include \"virtypedparam.h\"\n#include <config.h>\n\nint\nvirTypedParamListAddLLong(virTypedParamListPtr list,\n                          long long value,\n                          const char *namefmt,\n                          ...)\n{\n    virTypedParameterPtr par;\n    va_list ap;\n    int ret;\n\n    if (!(par = virTypedParamListExtend(list)) ||\n        virTypedParameterAssignValue(par, true, VIR_TYPED_PARAM_LLONG, value) < 0)\n        return -1;\n\n    va_start(ap, namefmt);\n    ret = virTypedParamSetNameVPrintf(par, namefmt, ap);\n    va_end(ap);\n\n    return ret;\n}"
  },
  {
    "function_name": "virTypedParamListAddUInt",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam.c",
    "lines": "799-818",
    "snippet": "int\nvirTypedParamListAddUInt(virTypedParamListPtr list,\n                         unsigned int value,\n                         const char *namefmt,\n                         ...)\n{\n    virTypedParameterPtr par;\n    va_list ap;\n    int ret;\n\n    if (!(par = virTypedParamListExtend(list)) ||\n        virTypedParameterAssignValue(par, true, VIR_TYPED_PARAM_UINT, value) < 0)\n        return -1;\n\n    va_start(ap, namefmt);\n    ret = virTypedParamSetNameVPrintf(par, namefmt, ap);\n    va_end(ap);\n\n    return ret;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include <stdarg.h>",
      "#include \"virtypedparam.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "va_end",
          "args": [
            "ap"
          ],
          "line": 815
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virTypedParamSetNameVPrintf",
          "args": [
            "par",
            "namefmt",
            "ap"
          ],
          "line": 814
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_start",
          "args": [
            "ap",
            "namefmt"
          ],
          "line": 813
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virTypedParameterAssignValue",
          "args": [
            "par",
            "true",
            "VIR_TYPED_PARAM_UINT",
            "value"
          ],
          "line": 810
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParameterAssignValue",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam.c",
          "lines": "255-269",
          "snippet": "static int\nvirTypedParameterAssignValue(virTypedParameterPtr param,\n                             bool copystr,\n                             int type,\n                             ...)\n{\n    int ret;\n    va_list ap;\n\n    va_start(ap, type);\n    ret = virTypedParameterAssignValueVArgs(param, type, ap, copystr);\n    va_end(ap);\n\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <stdarg.h>",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <stdarg.h>\n#include \"virtypedparam.h\"\n#include <config.h>\n\nstatic int\nvirTypedParameterAssignValue(virTypedParameterPtr param,\n                             bool copystr,\n                             int type,\n                             ...)\n{\n    int ret;\n    va_list ap;\n\n    va_start(ap, type);\n    ret = virTypedParameterAssignValueVArgs(param, type, ap, copystr);\n    va_end(ap);\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virTypedParamListExtend",
          "args": [
            "list"
          ],
          "line": 809
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <stdarg.h>\n#include \"virtypedparam.h\"\n#include <config.h>\n\nint\nvirTypedParamListAddUInt(virTypedParamListPtr list,\n                         unsigned int value,\n                         const char *namefmt,\n                         ...)\n{\n    virTypedParameterPtr par;\n    va_list ap;\n    int ret;\n\n    if (!(par = virTypedParamListExtend(list)) ||\n        virTypedParameterAssignValue(par, true, VIR_TYPED_PARAM_UINT, value) < 0)\n        return -1;\n\n    va_start(ap, namefmt);\n    ret = virTypedParamSetNameVPrintf(par, namefmt, ap);\n    va_end(ap);\n\n    return ret;\n}"
  },
  {
    "function_name": "G_GNUC_PRINTF",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam.c",
    "lines": "751-796",
    "snippet": "static int G_GNUC_PRINTF(2, 0)\nvirTypedParamSetNameVPrintf(virTypedParameterPtr par,\n                            const char *fmt,\n                            va_list ap)\n{\n    if (g_vsnprintf(par->field, VIR_TYPED_PARAM_FIELD_LENGTH, fmt, ap) > VIR_TYPED_PARAM_FIELD_LENGTH) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\", _(\"Field name too long\"));\n        return -1;\n    }\n\n    return 0;\n}\n\n\nstatic virTypedParameterPtr\nvirTypedParamListExtend(virTypedParamListPtr list)\n{\n    if (VIR_RESIZE_N(list->par, list->par_alloc, list->npar, 1) < 0)\n        return NULL;\n\n    list->npar++;\n\n    return list->par + (list->npar - 1);\n}\n\n\nint\nvirTypedParamListAddInt(virTypedParamListPtr list,\n                        int value,\n                        const char *namefmt,\n                        ...)\n{\n    virTypedParameterPtr par;\n    va_list ap;\n    int ret;\n\n    if (!(par = virTypedParamListExtend(list)) ||\n        virTypedParameterAssignValue(par, true, VIR_TYPED_PARAM_INT, value) < 0)\n        return -1;\n\n    va_start(ap, namefmt);\n    ret = virTypedParamSetNameVPrintf(par, namefmt, ap);\n    va_end(ap);\n\n    return ret;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include <stdarg.h>",
      "#include \"virtypedparam.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "va_end",
          "args": [
            "ap"
          ],
          "line": 793
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virTypedParamSetNameVPrintf",
          "args": [
            "par",
            "namefmt",
            "ap"
          ],
          "line": 792
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_start",
          "args": [
            "ap",
            "namefmt"
          ],
          "line": 791
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virTypedParameterAssignValue",
          "args": [
            "par",
            "true",
            "VIR_TYPED_PARAM_INT",
            "value"
          ],
          "line": 788
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParameterAssignValue",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam.c",
          "lines": "255-269",
          "snippet": "static int\nvirTypedParameterAssignValue(virTypedParameterPtr param,\n                             bool copystr,\n                             int type,\n                             ...)\n{\n    int ret;\n    va_list ap;\n\n    va_start(ap, type);\n    ret = virTypedParameterAssignValueVArgs(param, type, ap, copystr);\n    va_end(ap);\n\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <stdarg.h>",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <stdarg.h>\n#include \"virtypedparam.h\"\n#include <config.h>\n\nstatic int\nvirTypedParameterAssignValue(virTypedParameterPtr param,\n                             bool copystr,\n                             int type,\n                             ...)\n{\n    int ret;\n    va_list ap;\n\n    va_start(ap, type);\n    ret = virTypedParameterAssignValueVArgs(param, type, ap, copystr);\n    va_end(ap);\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virTypedParamListExtend",
          "args": [
            "list"
          ],
          "line": 787
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <stdarg.h>\n#include \"virtypedparam.h\"\n#include <config.h>\n\nstatic int G_GNUC_PRINTF(2, 0)\nvirTypedParamSetNameVPrintf(virTypedParameterPtr par,\n                            const char *fmt,\n                            va_list ap)\n{\n    if (g_vsnprintf(par->field, VIR_TYPED_PARAM_FIELD_LENGTH, fmt, ap) > VIR_TYPED_PARAM_FIELD_LENGTH) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\", _(\"Field name too long\"));\n        return -1;\n    }\n\n    return 0;\n}\n\n\nstatic virTypedParameterPtr\nvirTypedParamListExtend(virTypedParamListPtr list)\n{\n    if (VIR_RESIZE_N(list->par, list->par_alloc, list->npar, 1) < 0)\n        return NULL;\n\n    list->npar++;\n\n    return list->par + (list->npar - 1);\n}\n\n\nint\nvirTypedParamListAddInt(virTypedParamListPtr list,\n                        int value,\n                        const char *namefmt,\n                        ...)\n{\n    virTypedParameterPtr par;\n    va_list ap;\n    int ret;\n\n    if (!(par = virTypedParamListExtend(list)) ||\n        virTypedParameterAssignValue(par, true, VIR_TYPED_PARAM_INT, value) < 0)\n        return -1;\n\n    va_start(ap, namefmt);\n    ret = virTypedParamSetNameVPrintf(par, namefmt, ap);\n    va_end(ap);\n\n    return ret;\n}"
  },
  {
    "function_name": "virTypedParamListStealParams",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam.c",
    "lines": "737-748",
    "snippet": "size_t\nvirTypedParamListStealParams(virTypedParamListPtr list,\n                             virTypedParameterPtr *params)\n{\n    size_t ret = list->npar;\n\n    *params = g_steal_pointer(&list->par);\n    list->npar = 0;\n    list->par_alloc = 0;\n\n    return ret;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include <stdarg.h>",
      "#include \"virtypedparam.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_steal_pointer",
          "args": [
            "&list->par"
          ],
          "line": 743
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <stdarg.h>\n#include \"virtypedparam.h\"\n#include <config.h>\n\nsize_t\nvirTypedParamListStealParams(virTypedParamListPtr list,\n                             virTypedParameterPtr *params)\n{\n    size_t ret = list->npar;\n\n    *params = g_steal_pointer(&list->par);\n    list->npar = 0;\n    list->par_alloc = 0;\n\n    return ret;\n}"
  },
  {
    "function_name": "virTypedParamListFree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam.c",
    "lines": "726-734",
    "snippet": "void\nvirTypedParamListFree(virTypedParamListPtr list)\n{\n    if (!list)\n        return;\n\n    virTypedParamsFree(list->par, list->npar);\n    VIR_FREE(list);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include <stdarg.h>",
      "#include \"virtypedparam.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "list"
          ],
          "line": 733
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virTypedParamsFree",
          "args": [
            "list->par",
            "list->npar"
          ],
          "line": 732
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParamsFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam-public.c",
          "lines": "878-884",
          "snippet": "void\nvirTypedParamsFree(virTypedParameterPtr params,\n                   int nparams)\n{\n    virTypedParamsClear(params, nparams);\n    VIR_FREE(params);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtypedparam.h\"\n#include <config.h>\n\nvoid\nvirTypedParamsFree(virTypedParameterPtr params,\n                   int nparams)\n{\n    virTypedParamsClear(params, nparams);\n    VIR_FREE(params);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <stdarg.h>\n#include \"virtypedparam.h\"\n#include <config.h>\n\nvoid\nvirTypedParamListFree(virTypedParamListPtr list)\n{\n    if (!list)\n        return;\n\n    virTypedParamsFree(list->par, list->npar);\n    VIR_FREE(list);\n}"
  },
  {
    "function_name": "virTypedParamsSerialize",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam.c",
    "lines": "644-723",
    "snippet": "int\nvirTypedParamsSerialize(virTypedParameterPtr params,\n                        int nparams,\n                        int limit,\n                        virTypedParameterRemotePtr *remote_params_val,\n                        unsigned int *remote_params_len,\n                        unsigned int flags)\n{\n    size_t i;\n    size_t j;\n    int rv = -1;\n    virTypedParameterRemotePtr params_val = NULL;\n    int params_len = nparams;\n\n    if (nparams > limit) {\n        virReportError(VIR_ERR_RPC,\n                       _(\"too many parameters '%d' for limit '%d'\"),\n                       nparams, limit);\n        goto cleanup;\n    }\n\n    if (VIR_ALLOC_N(params_val, nparams) < 0)\n        goto cleanup;\n\n    for (i = 0, j = 0; i < nparams; ++i) {\n        virTypedParameterPtr param = params + i;\n        virTypedParameterRemotePtr val = params_val + j;\n        /* NOTE: Following snippet is relevant to server only, because\n         * virDomainGetCPUStats can return a sparse array; also, we can't pass\n         * back strings to older clients. */\n        if (!param->type ||\n            (!(flags & VIR_TYPED_PARAM_STRING_OKAY) &&\n             param->type == VIR_TYPED_PARAM_STRING)) {\n            --params_len;\n            continue;\n        }\n\n        /* This will be either freed by virNetServerDispatchCall or call(),\n         * depending on the calling side, i.e. server or client */\n        val->field = g_strdup(param->field);\n        val->value.type = param->type;\n        switch (param->type) {\n        case VIR_TYPED_PARAM_INT:\n            val->value.remote_typed_param_value.i = param->value.i;\n            break;\n        case VIR_TYPED_PARAM_UINT:\n            val->value.remote_typed_param_value.ui = param->value.ui;\n            break;\n        case VIR_TYPED_PARAM_LLONG:\n            val->value.remote_typed_param_value.l = param->value.l;\n            break;\n        case VIR_TYPED_PARAM_ULLONG:\n            val->value.remote_typed_param_value.ul = param->value.ul;\n            break;\n        case VIR_TYPED_PARAM_DOUBLE:\n            val->value.remote_typed_param_value.d = param->value.d;\n            break;\n        case VIR_TYPED_PARAM_BOOLEAN:\n            val->value.remote_typed_param_value.b = param->value.b;\n            break;\n        case VIR_TYPED_PARAM_STRING:\n            val->value.remote_typed_param_value.s = g_strdup(param->value.s);\n            break;\n        default:\n            virReportError(VIR_ERR_RPC, _(\"unknown parameter type: %d\"),\n                           param->type);\n            goto cleanup;\n        }\n        j++;\n    }\n\n    *remote_params_val = params_val;\n    *remote_params_len = params_len;\n    params_val = NULL;\n    rv = 0;\n\n cleanup:\n    virTypedParamsRemoteFree(params_val, nparams);\n    return rv;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include <stdarg.h>",
      "#include \"virtypedparam.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virTypedParamsRemoteFree",
          "args": [
            "params_val",
            "nparams"
          ],
          "line": 721
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParamsRemoteFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam.c",
          "lines": "482-497",
          "snippet": "void\nvirTypedParamsRemoteFree(virTypedParameterRemotePtr remote_params_val,\n                         unsigned int remote_params_len)\n{\n    size_t i;\n\n    if (!remote_params_val)\n        return;\n\n    for (i = 0; i < remote_params_len; i++) {\n        VIR_FREE(remote_params_val[i].field);\n        if (remote_params_val[i].value.type == VIR_TYPED_PARAM_STRING)\n            VIR_FREE(remote_params_val[i].value.remote_typed_param_value.s);\n    }\n    VIR_FREE(remote_params_val);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <stdarg.h>",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <stdarg.h>\n#include \"virtypedparam.h\"\n#include <config.h>\n\nvoid\nvirTypedParamsRemoteFree(virTypedParameterRemotePtr remote_params_val,\n                         unsigned int remote_params_len)\n{\n    size_t i;\n\n    if (!remote_params_val)\n        return;\n\n    for (i = 0; i < remote_params_len; i++) {\n        VIR_FREE(remote_params_val[i].field);\n        if (remote_params_val[i].value.type == VIR_TYPED_PARAM_STRING)\n            VIR_FREE(remote_params_val[i].value.remote_typed_param_value.s);\n    }\n    VIR_FREE(remote_params_val);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_RPC",
            "_(\"unknown parameter type: %d\")",
            "param->type"
          ],
          "line": 708
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"unknown parameter type: %d\""
          ],
          "line": 708
        },
        "resolved": true,
        "details": {
          "function_name": "G_GNUC_PRINTF",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam.c",
          "lines": "751-796",
          "snippet": "static int G_GNUC_PRINTF(2, 0)\nvirTypedParamSetNameVPrintf(virTypedParameterPtr par,\n                            const char *fmt,\n                            va_list ap)\n{\n    if (g_vsnprintf(par->field, VIR_TYPED_PARAM_FIELD_LENGTH, fmt, ap) > VIR_TYPED_PARAM_FIELD_LENGTH) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\", _(\"Field name too long\"));\n        return -1;\n    }\n\n    return 0;\n}\n\n\nstatic virTypedParameterPtr\nvirTypedParamListExtend(virTypedParamListPtr list)\n{\n    if (VIR_RESIZE_N(list->par, list->par_alloc, list->npar, 1) < 0)\n        return NULL;\n\n    list->npar++;\n\n    return list->par + (list->npar - 1);\n}\n\n\nint\nvirTypedParamListAddInt(virTypedParamListPtr list,\n                        int value,\n                        const char *namefmt,\n                        ...)\n{\n    virTypedParameterPtr par;\n    va_list ap;\n    int ret;\n\n    if (!(par = virTypedParamListExtend(list)) ||\n        virTypedParameterAssignValue(par, true, VIR_TYPED_PARAM_INT, value) < 0)\n        return -1;\n\n    va_start(ap, namefmt);\n    ret = virTypedParamSetNameVPrintf(par, namefmt, ap);\n    va_end(ap);\n\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <stdarg.h>",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <stdarg.h>\n#include \"virtypedparam.h\"\n#include <config.h>\n\nstatic int G_GNUC_PRINTF(2, 0)\nvirTypedParamSetNameVPrintf(virTypedParameterPtr par,\n                            const char *fmt,\n                            va_list ap)\n{\n    if (g_vsnprintf(par->field, VIR_TYPED_PARAM_FIELD_LENGTH, fmt, ap) > VIR_TYPED_PARAM_FIELD_LENGTH) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\", _(\"Field name too long\"));\n        return -1;\n    }\n\n    return 0;\n}\n\n\nstatic virTypedParameterPtr\nvirTypedParamListExtend(virTypedParamListPtr list)\n{\n    if (VIR_RESIZE_N(list->par, list->par_alloc, list->npar, 1) < 0)\n        return NULL;\n\n    list->npar++;\n\n    return list->par + (list->npar - 1);\n}\n\n\nint\nvirTypedParamListAddInt(virTypedParamListPtr list,\n                        int value,\n                        const char *namefmt,\n                        ...)\n{\n    virTypedParameterPtr par;\n    va_list ap;\n    int ret;\n\n    if (!(par = virTypedParamListExtend(list)) ||\n        virTypedParameterAssignValue(par, true, VIR_TYPED_PARAM_INT, value) < 0)\n        return -1;\n\n    va_start(ap, namefmt);\n    ret = virTypedParamSetNameVPrintf(par, namefmt, ap);\n    va_end(ap);\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "param->value.s"
          ],
          "line": 705
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC_N",
          "args": [
            "params_val",
            "nparams"
          ],
          "line": 665
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_RPC",
            "_(\"too many parameters '%d' for limit '%d'\")",
            "nparams",
            "limit"
          ],
          "line": 659
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <stdarg.h>\n#include \"virtypedparam.h\"\n#include <config.h>\n\nint\nvirTypedParamsSerialize(virTypedParameterPtr params,\n                        int nparams,\n                        int limit,\n                        virTypedParameterRemotePtr *remote_params_val,\n                        unsigned int *remote_params_len,\n                        unsigned int flags)\n{\n    size_t i;\n    size_t j;\n    int rv = -1;\n    virTypedParameterRemotePtr params_val = NULL;\n    int params_len = nparams;\n\n    if (nparams > limit) {\n        virReportError(VIR_ERR_RPC,\n                       _(\"too many parameters '%d' for limit '%d'\"),\n                       nparams, limit);\n        goto cleanup;\n    }\n\n    if (VIR_ALLOC_N(params_val, nparams) < 0)\n        goto cleanup;\n\n    for (i = 0, j = 0; i < nparams; ++i) {\n        virTypedParameterPtr param = params + i;\n        virTypedParameterRemotePtr val = params_val + j;\n        /* NOTE: Following snippet is relevant to server only, because\n         * virDomainGetCPUStats can return a sparse array; also, we can't pass\n         * back strings to older clients. */\n        if (!param->type ||\n            (!(flags & VIR_TYPED_PARAM_STRING_OKAY) &&\n             param->type == VIR_TYPED_PARAM_STRING)) {\n            --params_len;\n            continue;\n        }\n\n        /* This will be either freed by virNetServerDispatchCall or call(),\n         * depending on the calling side, i.e. server or client */\n        val->field = g_strdup(param->field);\n        val->value.type = param->type;\n        switch (param->type) {\n        case VIR_TYPED_PARAM_INT:\n            val->value.remote_typed_param_value.i = param->value.i;\n            break;\n        case VIR_TYPED_PARAM_UINT:\n            val->value.remote_typed_param_value.ui = param->value.ui;\n            break;\n        case VIR_TYPED_PARAM_LLONG:\n            val->value.remote_typed_param_value.l = param->value.l;\n            break;\n        case VIR_TYPED_PARAM_ULLONG:\n            val->value.remote_typed_param_value.ul = param->value.ul;\n            break;\n        case VIR_TYPED_PARAM_DOUBLE:\n            val->value.remote_typed_param_value.d = param->value.d;\n            break;\n        case VIR_TYPED_PARAM_BOOLEAN:\n            val->value.remote_typed_param_value.b = param->value.b;\n            break;\n        case VIR_TYPED_PARAM_STRING:\n            val->value.remote_typed_param_value.s = g_strdup(param->value.s);\n            break;\n        default:\n            virReportError(VIR_ERR_RPC, _(\"unknown parameter type: %d\"),\n                           param->type);\n            goto cleanup;\n        }\n        j++;\n    }\n\n    *remote_params_val = params_val;\n    *remote_params_len = params_len;\n    params_val = NULL;\n    rv = 0;\n\n cleanup:\n    virTypedParamsRemoteFree(params_val, nparams);\n    return rv;\n}"
  },
  {
    "function_name": "virTypedParamsDeserialize",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam.c",
    "lines": "527-621",
    "snippet": "int\nvirTypedParamsDeserialize(virTypedParameterRemotePtr remote_params,\n                          unsigned int remote_params_len,\n                          int limit,\n                          virTypedParameterPtr *params,\n                          int *nparams)\n{\n    size_t i = 0;\n    int rv = -1;\n    bool userAllocated = *params != NULL;\n\n    if (limit && remote_params_len > limit) {\n        virReportError(VIR_ERR_RPC,\n                       _(\"too many parameters '%u' for limit '%d'\"),\n                       remote_params_len, limit);\n        goto cleanup;\n    }\n\n    if (userAllocated) {\n        /* Check the length of the returned list carefully. */\n        if (remote_params_len > *nparams) {\n            virReportError(VIR_ERR_RPC,\n                           _(\"too many parameters '%u' for nparams '%d'\"),\n                           remote_params_len, *nparams);\n            goto cleanup;\n        }\n    } else {\n        if (VIR_ALLOC_N(*params, remote_params_len) < 0)\n            goto cleanup;\n    }\n    *nparams = remote_params_len;\n\n    /* Deserialize the result. */\n    for (i = 0; i < remote_params_len; ++i) {\n        virTypedParameterPtr param = *params + i;\n        virTypedParameterRemotePtr remote_param = remote_params + i;\n\n        if (virStrcpyStatic(param->field,\n                            remote_param->field) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"parameter %s too big for destination\"),\n                           remote_param->field);\n            goto cleanup;\n        }\n\n        param->type = remote_param->value.type;\n        switch (param->type) {\n        case VIR_TYPED_PARAM_INT:\n            param->value.i =\n                remote_param->value.remote_typed_param_value.i;\n            break;\n        case VIR_TYPED_PARAM_UINT:\n            param->value.ui =\n                remote_param->value.remote_typed_param_value.ui;\n            break;\n        case VIR_TYPED_PARAM_LLONG:\n            param->value.l =\n                remote_param->value.remote_typed_param_value.l;\n            break;\n        case VIR_TYPED_PARAM_ULLONG:\n            param->value.ul =\n                remote_param->value.remote_typed_param_value.ul;\n            break;\n        case VIR_TYPED_PARAM_DOUBLE:\n            param->value.d =\n                remote_param->value.remote_typed_param_value.d;\n            break;\n        case VIR_TYPED_PARAM_BOOLEAN:\n            param->value.b =\n                remote_param->value.remote_typed_param_value.b;\n            break;\n        case VIR_TYPED_PARAM_STRING:\n            param->value.s = g_strdup(remote_param->value.remote_typed_param_value.s);\n            break;\n        default:\n            virReportError(VIR_ERR_RPC, _(\"unknown parameter type: %d\"),\n                           param->type);\n            goto cleanup;\n        }\n    }\n\n    rv = 0;\n\n cleanup:\n    if (rv < 0) {\n        if (userAllocated) {\n            virTypedParamsClear(*params, i);\n        } else {\n            virTypedParamsFree(*params, i);\n            *params = NULL;\n            *nparams = 0;\n        }\n    }\n    return rv;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include <stdarg.h>",
      "#include \"virtypedparam.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virTypedParamsFree",
          "args": [
            "*params",
            "i"
          ],
          "line": 615
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParamsFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam-public.c",
          "lines": "878-884",
          "snippet": "void\nvirTypedParamsFree(virTypedParameterPtr params,\n                   int nparams)\n{\n    virTypedParamsClear(params, nparams);\n    VIR_FREE(params);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtypedparam.h\"\n#include <config.h>\n\nvoid\nvirTypedParamsFree(virTypedParameterPtr params,\n                   int nparams)\n{\n    virTypedParamsClear(params, nparams);\n    VIR_FREE(params);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virTypedParamsClear",
          "args": [
            "*params",
            "i"
          ],
          "line": 613
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParamsClear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam-public.c",
          "lines": "852-865",
          "snippet": "void\nvirTypedParamsClear(virTypedParameterPtr params,\n                    int nparams)\n{\n    size_t i;\n\n    if (!params)\n        return;\n\n    for (i = 0; i < nparams; i++) {\n        if (params[i].type == VIR_TYPED_PARAM_STRING)\n            VIR_FREE(params[i].value.s);\n    }\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtypedparam.h\"\n#include <config.h>\n\nvoid\nvirTypedParamsClear(virTypedParameterPtr params,\n                    int nparams)\n{\n    size_t i;\n\n    if (!params)\n        return;\n\n    for (i = 0; i < nparams; i++) {\n        if (params[i].type == VIR_TYPED_PARAM_STRING)\n            VIR_FREE(params[i].value.s);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_RPC",
            "_(\"unknown parameter type: %d\")",
            "param->type"
          ],
          "line": 602
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"unknown parameter type: %d\""
          ],
          "line": 602
        },
        "resolved": true,
        "details": {
          "function_name": "G_GNUC_PRINTF",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam.c",
          "lines": "751-796",
          "snippet": "static int G_GNUC_PRINTF(2, 0)\nvirTypedParamSetNameVPrintf(virTypedParameterPtr par,\n                            const char *fmt,\n                            va_list ap)\n{\n    if (g_vsnprintf(par->field, VIR_TYPED_PARAM_FIELD_LENGTH, fmt, ap) > VIR_TYPED_PARAM_FIELD_LENGTH) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\", _(\"Field name too long\"));\n        return -1;\n    }\n\n    return 0;\n}\n\n\nstatic virTypedParameterPtr\nvirTypedParamListExtend(virTypedParamListPtr list)\n{\n    if (VIR_RESIZE_N(list->par, list->par_alloc, list->npar, 1) < 0)\n        return NULL;\n\n    list->npar++;\n\n    return list->par + (list->npar - 1);\n}\n\n\nint\nvirTypedParamListAddInt(virTypedParamListPtr list,\n                        int value,\n                        const char *namefmt,\n                        ...)\n{\n    virTypedParameterPtr par;\n    va_list ap;\n    int ret;\n\n    if (!(par = virTypedParamListExtend(list)) ||\n        virTypedParameterAssignValue(par, true, VIR_TYPED_PARAM_INT, value) < 0)\n        return -1;\n\n    va_start(ap, namefmt);\n    ret = virTypedParamSetNameVPrintf(par, namefmt, ap);\n    va_end(ap);\n\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <stdarg.h>",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <stdarg.h>\n#include \"virtypedparam.h\"\n#include <config.h>\n\nstatic int G_GNUC_PRINTF(2, 0)\nvirTypedParamSetNameVPrintf(virTypedParameterPtr par,\n                            const char *fmt,\n                            va_list ap)\n{\n    if (g_vsnprintf(par->field, VIR_TYPED_PARAM_FIELD_LENGTH, fmt, ap) > VIR_TYPED_PARAM_FIELD_LENGTH) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\", _(\"Field name too long\"));\n        return -1;\n    }\n\n    return 0;\n}\n\n\nstatic virTypedParameterPtr\nvirTypedParamListExtend(virTypedParamListPtr list)\n{\n    if (VIR_RESIZE_N(list->par, list->par_alloc, list->npar, 1) < 0)\n        return NULL;\n\n    list->npar++;\n\n    return list->par + (list->npar - 1);\n}\n\n\nint\nvirTypedParamListAddInt(virTypedParamListPtr list,\n                        int value,\n                        const char *namefmt,\n                        ...)\n{\n    virTypedParameterPtr par;\n    va_list ap;\n    int ret;\n\n    if (!(par = virTypedParamListExtend(list)) ||\n        virTypedParameterAssignValue(par, true, VIR_TYPED_PARAM_INT, value) < 0)\n        return -1;\n\n    va_start(ap, namefmt);\n    ret = virTypedParamSetNameVPrintf(par, namefmt, ap);\n    va_end(ap);\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "remote_param->value.remote_typed_param_value.s"
          ],
          "line": 599
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"parameter %s too big for destination\")",
            "remote_param->field"
          ],
          "line": 566
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStrcpyStatic",
          "args": [
            "param->field",
            "remote_param->field"
          ],
          "line": 564
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC_N",
          "args": [
            "*params",
            "remote_params_len"
          ],
          "line": 554
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_RPC",
            "_(\"too many parameters '%u' for nparams '%d'\")",
            "remote_params_len",
            "*nparams"
          ],
          "line": 548
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_RPC",
            "_(\"too many parameters '%u' for limit '%d'\")",
            "remote_params_len",
            "limit"
          ],
          "line": 539
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <stdarg.h>\n#include \"virtypedparam.h\"\n#include <config.h>\n\nint\nvirTypedParamsDeserialize(virTypedParameterRemotePtr remote_params,\n                          unsigned int remote_params_len,\n                          int limit,\n                          virTypedParameterPtr *params,\n                          int *nparams)\n{\n    size_t i = 0;\n    int rv = -1;\n    bool userAllocated = *params != NULL;\n\n    if (limit && remote_params_len > limit) {\n        virReportError(VIR_ERR_RPC,\n                       _(\"too many parameters '%u' for limit '%d'\"),\n                       remote_params_len, limit);\n        goto cleanup;\n    }\n\n    if (userAllocated) {\n        /* Check the length of the returned list carefully. */\n        if (remote_params_len > *nparams) {\n            virReportError(VIR_ERR_RPC,\n                           _(\"too many parameters '%u' for nparams '%d'\"),\n                           remote_params_len, *nparams);\n            goto cleanup;\n        }\n    } else {\n        if (VIR_ALLOC_N(*params, remote_params_len) < 0)\n            goto cleanup;\n    }\n    *nparams = remote_params_len;\n\n    /* Deserialize the result. */\n    for (i = 0; i < remote_params_len; ++i) {\n        virTypedParameterPtr param = *params + i;\n        virTypedParameterRemotePtr remote_param = remote_params + i;\n\n        if (virStrcpyStatic(param->field,\n                            remote_param->field) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"parameter %s too big for destination\"),\n                           remote_param->field);\n            goto cleanup;\n        }\n\n        param->type = remote_param->value.type;\n        switch (param->type) {\n        case VIR_TYPED_PARAM_INT:\n            param->value.i =\n                remote_param->value.remote_typed_param_value.i;\n            break;\n        case VIR_TYPED_PARAM_UINT:\n            param->value.ui =\n                remote_param->value.remote_typed_param_value.ui;\n            break;\n        case VIR_TYPED_PARAM_LLONG:\n            param->value.l =\n                remote_param->value.remote_typed_param_value.l;\n            break;\n        case VIR_TYPED_PARAM_ULLONG:\n            param->value.ul =\n                remote_param->value.remote_typed_param_value.ul;\n            break;\n        case VIR_TYPED_PARAM_DOUBLE:\n            param->value.d =\n                remote_param->value.remote_typed_param_value.d;\n            break;\n        case VIR_TYPED_PARAM_BOOLEAN:\n            param->value.b =\n                remote_param->value.remote_typed_param_value.b;\n            break;\n        case VIR_TYPED_PARAM_STRING:\n            param->value.s = g_strdup(remote_param->value.remote_typed_param_value.s);\n            break;\n        default:\n            virReportError(VIR_ERR_RPC, _(\"unknown parameter type: %d\"),\n                           param->type);\n            goto cleanup;\n        }\n    }\n\n    rv = 0;\n\n cleanup:\n    if (rv < 0) {\n        if (userAllocated) {\n            virTypedParamsClear(*params, i);\n        } else {\n            virTypedParamsFree(*params, i);\n            *params = NULL;\n            *nparams = 0;\n        }\n    }\n    return rv;\n}"
  },
  {
    "function_name": "virTypedParamsRemoteFree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam.c",
    "lines": "482-497",
    "snippet": "void\nvirTypedParamsRemoteFree(virTypedParameterRemotePtr remote_params_val,\n                         unsigned int remote_params_len)\n{\n    size_t i;\n\n    if (!remote_params_val)\n        return;\n\n    for (i = 0; i < remote_params_len; i++) {\n        VIR_FREE(remote_params_val[i].field);\n        if (remote_params_val[i].value.type == VIR_TYPED_PARAM_STRING)\n            VIR_FREE(remote_params_val[i].value.remote_typed_param_value.s);\n    }\n    VIR_FREE(remote_params_val);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include <stdarg.h>",
      "#include \"virtypedparam.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "remote_params_val"
          ],
          "line": 496
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "remote_params_val[i].value.remote_typed_param_value.s"
          ],
          "line": 494
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "remote_params_val[i].field"
          ],
          "line": 492
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <stdarg.h>\n#include \"virtypedparam.h\"\n#include <config.h>\n\nvoid\nvirTypedParamsRemoteFree(virTypedParameterRemotePtr remote_params_val,\n                         unsigned int remote_params_len)\n{\n    size_t i;\n\n    if (!remote_params_val)\n        return;\n\n    for (i = 0; i < remote_params_len; i++) {\n        VIR_FREE(remote_params_val[i].field);\n        if (remote_params_val[i].value.type == VIR_TYPED_PARAM_STRING)\n            VIR_FREE(remote_params_val[i].value.remote_typed_param_value.s);\n    }\n    VIR_FREE(remote_params_val);\n}"
  },
  {
    "function_name": "virTypedParamsGetStringList",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam.c",
    "lines": "432-467",
    "snippet": "int\nvirTypedParamsGetStringList(virTypedParameterPtr params,\n                            int nparams,\n                            const char *name,\n                            const char ***values)\n{\n    size_t i, n;\n    int nfiltered;\n    virTypedParameterPtr *filtered = NULL;\n\n    virCheckNonNullArgGoto(values, error);\n    *values = NULL;\n\n    nfiltered = virTypedParamsFilter(params, nparams, name, &filtered);\n\n    if (nfiltered < 0)\n        goto error;\n\n    if (nfiltered &&\n        VIR_ALLOC_N(*values, nfiltered) < 0)\n        goto error;\n\n    for (n = 0, i = 0; i < nfiltered; i++) {\n        if (filtered[i]->type == VIR_TYPED_PARAM_STRING)\n            (*values)[n++] = filtered[i]->value.s;\n    }\n\n    VIR_FREE(filtered);\n    return n;\n\n error:\n    if (values)\n        VIR_FREE(*values);\n    VIR_FREE(filtered);\n    return -1;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include <stdarg.h>",
      "#include \"virtypedparam.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "filtered"
          ],
          "line": 465
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "*values"
          ],
          "line": 464
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "filtered"
          ],
          "line": 459
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC_N",
          "args": [
            "*values",
            "nfiltered"
          ],
          "line": 451
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virTypedParamsFilter",
          "args": [
            "params",
            "nparams",
            "name",
            "&filtered"
          ],
          "line": 445
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParamsFilter",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam.c",
          "lines": "394-413",
          "snippet": "int\nvirTypedParamsFilter(virTypedParameterPtr params,\n                     int nparams,\n                     const char *name,\n                     virTypedParameterPtr **ret)\n{\n    size_t i, n = 0;\n\n    if (VIR_ALLOC_N(*ret, nparams) < 0)\n        return -1;\n\n    for (i = 0; i < nparams; i++) {\n        if (STREQ(params[i].field, name)) {\n            (*ret)[n] = &params[i];\n            n++;\n        }\n    }\n\n    return n;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <stdarg.h>",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <stdarg.h>\n#include \"virtypedparam.h\"\n#include <config.h>\n\nint\nvirTypedParamsFilter(virTypedParameterPtr params,\n                     int nparams,\n                     const char *name,\n                     virTypedParameterPtr **ret)\n{\n    size_t i, n = 0;\n\n    if (VIR_ALLOC_N(*ret, nparams) < 0)\n        return -1;\n\n    for (i = 0; i < nparams; i++) {\n        if (STREQ(params[i].field, name)) {\n            (*ret)[n] = &params[i];\n            n++;\n        }\n    }\n\n    return n;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckNonNullArgGoto",
          "args": [
            "values",
            "error"
          ],
          "line": 442
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <stdarg.h>\n#include \"virtypedparam.h\"\n#include <config.h>\n\nint\nvirTypedParamsGetStringList(virTypedParameterPtr params,\n                            int nparams,\n                            const char *name,\n                            const char ***values)\n{\n    size_t i, n;\n    int nfiltered;\n    virTypedParameterPtr *filtered = NULL;\n\n    virCheckNonNullArgGoto(values, error);\n    *values = NULL;\n\n    nfiltered = virTypedParamsFilter(params, nparams, name, &filtered);\n\n    if (nfiltered < 0)\n        goto error;\n\n    if (nfiltered &&\n        VIR_ALLOC_N(*values, nfiltered) < 0)\n        goto error;\n\n    for (n = 0, i = 0; i < nfiltered; i++) {\n        if (filtered[i]->type == VIR_TYPED_PARAM_STRING)\n            (*values)[n++] = filtered[i]->value.s;\n    }\n\n    VIR_FREE(filtered);\n    return n;\n\n error:\n    if (values)\n        VIR_FREE(*values);\n    VIR_FREE(filtered);\n    return -1;\n}"
  },
  {
    "function_name": "virTypedParamsFilter",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam.c",
    "lines": "394-413",
    "snippet": "int\nvirTypedParamsFilter(virTypedParameterPtr params,\n                     int nparams,\n                     const char *name,\n                     virTypedParameterPtr **ret)\n{\n    size_t i, n = 0;\n\n    if (VIR_ALLOC_N(*ret, nparams) < 0)\n        return -1;\n\n    for (i = 0; i < nparams; i++) {\n        if (STREQ(params[i].field, name)) {\n            (*ret)[n] = &params[i];\n            n++;\n        }\n    }\n\n    return n;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include <stdarg.h>",
      "#include \"virtypedparam.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "params[i].field",
            "name"
          ],
          "line": 406
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC_N",
          "args": [
            "*ret",
            "nparams"
          ],
          "line": 402
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <stdarg.h>\n#include \"virtypedparam.h\"\n#include <config.h>\n\nint\nvirTypedParamsFilter(virTypedParameterPtr params,\n                     int nparams,\n                     const char *name,\n                     virTypedParameterPtr **ret)\n{\n    size_t i, n = 0;\n\n    if (VIR_ALLOC_N(*ret, nparams) < 0)\n        return -1;\n\n    for (i = 0; i < nparams; i++) {\n        if (STREQ(params[i].field, name)) {\n            (*ret)[n] = &params[i];\n            n++;\n        }\n    }\n\n    return n;\n}"
  },
  {
    "function_name": "virTypedParamsCopy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam.c",
    "lines": "353-378",
    "snippet": "int\nvirTypedParamsCopy(virTypedParameterPtr *dst,\n                   virTypedParameterPtr src,\n                   int nparams)\n{\n    size_t i;\n\n    *dst = NULL;\n    if (!src || nparams <= 0)\n        return 0;\n\n    if (VIR_ALLOC_N(*dst, nparams) < 0)\n        return -1;\n\n    for (i = 0; i < nparams; i++) {\n        ignore_value(virStrcpyStatic((*dst)[i].field, src[i].field));\n        (*dst)[i].type = src[i].type;\n        if (src[i].type == VIR_TYPED_PARAM_STRING) {\n            (*dst)[i].value.s = g_strdup(src[i].value.s);\n        } else {\n            (*dst)[i].value = src[i].value;\n        }\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include <stdarg.h>",
      "#include \"virtypedparam.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "src[i].value.s"
          ],
          "line": 371
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ignore_value",
          "args": [
            "virStrcpyStatic((*dst)[i].field, src[i].field)"
          ],
          "line": 368
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStrcpyStatic",
          "args": [
            "(*dst)[i].field",
            "src[i].field"
          ],
          "line": 368
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC_N",
          "args": [
            "*dst",
            "nparams"
          ],
          "line": 364
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <stdarg.h>\n#include \"virtypedparam.h\"\n#include <config.h>\n\nint\nvirTypedParamsCopy(virTypedParameterPtr *dst,\n                   virTypedParameterPtr src,\n                   int nparams)\n{\n    size_t i;\n\n    *dst = NULL;\n    if (!src || nparams <= 0)\n        return 0;\n\n    if (VIR_ALLOC_N(*dst, nparams) < 0)\n        return -1;\n\n    for (i = 0; i < nparams; i++) {\n        ignore_value(virStrcpyStatic((*dst)[i].field, src[i].field));\n        (*dst)[i].type = src[i].type;\n        if (src[i].type == VIR_TYPED_PARAM_STRING) {\n            (*dst)[i].value.s = g_strdup(src[i].value.s);\n        } else {\n            (*dst)[i].value = src[i].value;\n        }\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virTypedParamsReplaceString",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam.c",
    "lines": "312-350",
    "snippet": "int\nvirTypedParamsReplaceString(virTypedParameterPtr *params,\n                            int *nparams,\n                            const char *name,\n                            const char *value)\n{\n    char *str = NULL;\n    char *old = NULL;\n    size_t n = *nparams;\n    virTypedParameterPtr param;\n\n    param = virTypedParamsGet(*params, n, name);\n    if (param) {\n        if (param->type != VIR_TYPED_PARAM_STRING) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Parameter '%s' is not a string\"),\n                           param->field);\n            return -1;\n        }\n        old = param->value.s;\n    } else {\n        if (VIR_EXPAND_N(*params, n, 1) < 0)\n            return -1;\n        param = *params + n - 1;\n    }\n\n    str = g_strdup(value);\n\n    if (virTypedParameterAssign(param, name,\n                                VIR_TYPED_PARAM_STRING, str) < 0) {\n        param->value.s = old;\n        VIR_FREE(str);\n        return -1;\n    }\n    VIR_FREE(old);\n\n    *nparams = n;\n    return 0;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include <stdarg.h>",
      "#include \"virtypedparam.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "old"
          ],
          "line": 346
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "str"
          ],
          "line": 343
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virTypedParameterAssign",
          "args": [
            "param",
            "name",
            "VIR_TYPED_PARAM_STRING",
            "str"
          ],
          "line": 340
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParameterAssign",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam.c",
          "lines": "276-294",
          "snippet": "int\nvirTypedParameterAssign(virTypedParameterPtr param, const char *name,\n                        int type, ...)\n{\n    va_list ap;\n    int ret = -1;\n\n    if (virStrcpyStatic(param->field, name) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, _(\"Field name '%s' too long\"),\n                       name);\n        return -1;\n    }\n\n    va_start(ap, type);\n    ret = virTypedParameterAssignValueVArgs(param, type, ap, false);\n    va_end(ap);\n\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <stdarg.h>",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <stdarg.h>\n#include \"virtypedparam.h\"\n#include <config.h>\n\nint\nvirTypedParameterAssign(virTypedParameterPtr param, const char *name,\n                        int type, ...)\n{\n    va_list ap;\n    int ret = -1;\n\n    if (virStrcpyStatic(param->field, name) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, _(\"Field name '%s' too long\"),\n                       name);\n        return -1;\n    }\n\n    va_start(ap, type);\n    ret = virTypedParameterAssignValueVArgs(param, type, ap, false);\n    va_end(ap);\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "value"
          ],
          "line": 338
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_EXPAND_N",
          "args": [
            "*params",
            "n",
            "1"
          ],
          "line": 333
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INVALID_ARG",
            "_(\"Parameter '%s' is not a string\")",
            "param->field"
          ],
          "line": 326
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Parameter '%s' is not a string\""
          ],
          "line": 327
        },
        "resolved": true,
        "details": {
          "function_name": "G_GNUC_PRINTF",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam.c",
          "lines": "751-796",
          "snippet": "static int G_GNUC_PRINTF(2, 0)\nvirTypedParamSetNameVPrintf(virTypedParameterPtr par,\n                            const char *fmt,\n                            va_list ap)\n{\n    if (g_vsnprintf(par->field, VIR_TYPED_PARAM_FIELD_LENGTH, fmt, ap) > VIR_TYPED_PARAM_FIELD_LENGTH) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\", _(\"Field name too long\"));\n        return -1;\n    }\n\n    return 0;\n}\n\n\nstatic virTypedParameterPtr\nvirTypedParamListExtend(virTypedParamListPtr list)\n{\n    if (VIR_RESIZE_N(list->par, list->par_alloc, list->npar, 1) < 0)\n        return NULL;\n\n    list->npar++;\n\n    return list->par + (list->npar - 1);\n}\n\n\nint\nvirTypedParamListAddInt(virTypedParamListPtr list,\n                        int value,\n                        const char *namefmt,\n                        ...)\n{\n    virTypedParameterPtr par;\n    va_list ap;\n    int ret;\n\n    if (!(par = virTypedParamListExtend(list)) ||\n        virTypedParameterAssignValue(par, true, VIR_TYPED_PARAM_INT, value) < 0)\n        return -1;\n\n    va_start(ap, namefmt);\n    ret = virTypedParamSetNameVPrintf(par, namefmt, ap);\n    va_end(ap);\n\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <stdarg.h>",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <stdarg.h>\n#include \"virtypedparam.h\"\n#include <config.h>\n\nstatic int G_GNUC_PRINTF(2, 0)\nvirTypedParamSetNameVPrintf(virTypedParameterPtr par,\n                            const char *fmt,\n                            va_list ap)\n{\n    if (g_vsnprintf(par->field, VIR_TYPED_PARAM_FIELD_LENGTH, fmt, ap) > VIR_TYPED_PARAM_FIELD_LENGTH) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\", _(\"Field name too long\"));\n        return -1;\n    }\n\n    return 0;\n}\n\n\nstatic virTypedParameterPtr\nvirTypedParamListExtend(virTypedParamListPtr list)\n{\n    if (VIR_RESIZE_N(list->par, list->par_alloc, list->npar, 1) < 0)\n        return NULL;\n\n    list->npar++;\n\n    return list->par + (list->npar - 1);\n}\n\n\nint\nvirTypedParamListAddInt(virTypedParamListPtr list,\n                        int value,\n                        const char *namefmt,\n                        ...)\n{\n    virTypedParameterPtr par;\n    va_list ap;\n    int ret;\n\n    if (!(par = virTypedParamListExtend(list)) ||\n        virTypedParameterAssignValue(par, true, VIR_TYPED_PARAM_INT, value) < 0)\n        return -1;\n\n    va_start(ap, namefmt);\n    ret = virTypedParamSetNameVPrintf(par, namefmt, ap);\n    va_end(ap);\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virTypedParamsGet",
          "args": [
            "*params",
            "n",
            "name"
          ],
          "line": 323
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParamsGet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam-public.c",
          "lines": "131-149",
          "snippet": "virTypedParameterPtr\nvirTypedParamsGet(virTypedParameterPtr params,\n                  int nparams,\n                  const char *name)\n{\n    size_t i;\n\n    /* No need to reset errors, since this function doesn't report any.  */\n\n    if (!params || !name)\n        return NULL;\n\n    for (i = 0; i < nparams; i++) {\n        if (STREQ(params[i].field, name))\n            return params + i;\n    }\n\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virtypedparam.h\"\n#include <config.h>\n\nvirTypedParameterPtr\nvirTypedParamsGet(virTypedParameterPtr params,\n                  int nparams,\n                  const char *name)\n{\n    size_t i;\n\n    /* No need to reset errors, since this function doesn't report any.  */\n\n    if (!params || !name)\n        return NULL;\n\n    for (i = 0; i < nparams; i++) {\n        if (STREQ(params[i].field, name))\n            return params + i;\n    }\n\n    return NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <stdarg.h>\n#include \"virtypedparam.h\"\n#include <config.h>\n\nint\nvirTypedParamsReplaceString(virTypedParameterPtr *params,\n                            int *nparams,\n                            const char *name,\n                            const char *value)\n{\n    char *str = NULL;\n    char *old = NULL;\n    size_t n = *nparams;\n    virTypedParameterPtr param;\n\n    param = virTypedParamsGet(*params, n, name);\n    if (param) {\n        if (param->type != VIR_TYPED_PARAM_STRING) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"Parameter '%s' is not a string\"),\n                           param->field);\n            return -1;\n        }\n        old = param->value.s;\n    } else {\n        if (VIR_EXPAND_N(*params, n, 1) < 0)\n            return -1;\n        param = *params + n - 1;\n    }\n\n    str = g_strdup(value);\n\n    if (virTypedParameterAssign(param, name,\n                                VIR_TYPED_PARAM_STRING, str) < 0) {\n        param->value.s = old;\n        VIR_FREE(str);\n        return -1;\n    }\n    VIR_FREE(old);\n\n    *nparams = n;\n    return 0;\n}"
  },
  {
    "function_name": "virTypedParameterAssign",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam.c",
    "lines": "276-294",
    "snippet": "int\nvirTypedParameterAssign(virTypedParameterPtr param, const char *name,\n                        int type, ...)\n{\n    va_list ap;\n    int ret = -1;\n\n    if (virStrcpyStatic(param->field, name) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, _(\"Field name '%s' too long\"),\n                       name);\n        return -1;\n    }\n\n    va_start(ap, type);\n    ret = virTypedParameterAssignValueVArgs(param, type, ap, false);\n    va_end(ap);\n\n    return ret;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include <stdarg.h>",
      "#include \"virtypedparam.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "va_end",
          "args": [
            "ap"
          ],
          "line": 291
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virTypedParameterAssignValueVArgs",
          "args": [
            "param",
            "type",
            "ap",
            "false"
          ],
          "line": 290
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParameterAssignValueVArgs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam.c",
          "lines": "208-252",
          "snippet": "static int\nvirTypedParameterAssignValueVArgs(virTypedParameterPtr param,\n                                  int type,\n                                  va_list ap,\n                                  bool copystr)\n{\n    param->type = type;\n    switch (type) {\n    case VIR_TYPED_PARAM_INT:\n        param->value.i = va_arg(ap, int);\n        break;\n    case VIR_TYPED_PARAM_UINT:\n        param->value.ui = va_arg(ap, unsigned int);\n        break;\n    case VIR_TYPED_PARAM_LLONG:\n        param->value.l = va_arg(ap, long long int);\n        break;\n    case VIR_TYPED_PARAM_ULLONG:\n        param->value.ul = va_arg(ap, unsigned long long int);\n        break;\n    case VIR_TYPED_PARAM_DOUBLE:\n        param->value.d = va_arg(ap, double);\n        break;\n    case VIR_TYPED_PARAM_BOOLEAN:\n        param->value.b = !!va_arg(ap, int);\n        break;\n    case VIR_TYPED_PARAM_STRING:\n        if (copystr) {\n            param->value.s = g_strdup(va_arg(ap, char *));\n        } else {\n            param->value.s = va_arg(ap, char *);\n        }\n\n        if (!param->value.s)\n            param->value.s = g_strdup(\"\");\n        break;\n    default:\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"unexpected type %d for field %s\"), type,\n                       NULLSTR(param->field));\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <stdarg.h>",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <stdarg.h>\n#include \"virtypedparam.h\"\n#include <config.h>\n\nstatic int\nvirTypedParameterAssignValueVArgs(virTypedParameterPtr param,\n                                  int type,\n                                  va_list ap,\n                                  bool copystr)\n{\n    param->type = type;\n    switch (type) {\n    case VIR_TYPED_PARAM_INT:\n        param->value.i = va_arg(ap, int);\n        break;\n    case VIR_TYPED_PARAM_UINT:\n        param->value.ui = va_arg(ap, unsigned int);\n        break;\n    case VIR_TYPED_PARAM_LLONG:\n        param->value.l = va_arg(ap, long long int);\n        break;\n    case VIR_TYPED_PARAM_ULLONG:\n        param->value.ul = va_arg(ap, unsigned long long int);\n        break;\n    case VIR_TYPED_PARAM_DOUBLE:\n        param->value.d = va_arg(ap, double);\n        break;\n    case VIR_TYPED_PARAM_BOOLEAN:\n        param->value.b = !!va_arg(ap, int);\n        break;\n    case VIR_TYPED_PARAM_STRING:\n        if (copystr) {\n            param->value.s = g_strdup(va_arg(ap, char *));\n        } else {\n            param->value.s = va_arg(ap, char *);\n        }\n\n        if (!param->value.s)\n            param->value.s = g_strdup(\"\");\n        break;\n    default:\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"unexpected type %d for field %s\"), type,\n                       NULLSTR(param->field));\n        return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "va_start",
          "args": [
            "ap",
            "type"
          ],
          "line": 289
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Field name '%s' too long\")",
            "name"
          ],
          "line": 284
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Field name '%s' too long\""
          ],
          "line": 284
        },
        "resolved": true,
        "details": {
          "function_name": "G_GNUC_PRINTF",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam.c",
          "lines": "751-796",
          "snippet": "static int G_GNUC_PRINTF(2, 0)\nvirTypedParamSetNameVPrintf(virTypedParameterPtr par,\n                            const char *fmt,\n                            va_list ap)\n{\n    if (g_vsnprintf(par->field, VIR_TYPED_PARAM_FIELD_LENGTH, fmt, ap) > VIR_TYPED_PARAM_FIELD_LENGTH) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\", _(\"Field name too long\"));\n        return -1;\n    }\n\n    return 0;\n}\n\n\nstatic virTypedParameterPtr\nvirTypedParamListExtend(virTypedParamListPtr list)\n{\n    if (VIR_RESIZE_N(list->par, list->par_alloc, list->npar, 1) < 0)\n        return NULL;\n\n    list->npar++;\n\n    return list->par + (list->npar - 1);\n}\n\n\nint\nvirTypedParamListAddInt(virTypedParamListPtr list,\n                        int value,\n                        const char *namefmt,\n                        ...)\n{\n    virTypedParameterPtr par;\n    va_list ap;\n    int ret;\n\n    if (!(par = virTypedParamListExtend(list)) ||\n        virTypedParameterAssignValue(par, true, VIR_TYPED_PARAM_INT, value) < 0)\n        return -1;\n\n    va_start(ap, namefmt);\n    ret = virTypedParamSetNameVPrintf(par, namefmt, ap);\n    va_end(ap);\n\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <stdarg.h>",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <stdarg.h>\n#include \"virtypedparam.h\"\n#include <config.h>\n\nstatic int G_GNUC_PRINTF(2, 0)\nvirTypedParamSetNameVPrintf(virTypedParameterPtr par,\n                            const char *fmt,\n                            va_list ap)\n{\n    if (g_vsnprintf(par->field, VIR_TYPED_PARAM_FIELD_LENGTH, fmt, ap) > VIR_TYPED_PARAM_FIELD_LENGTH) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\", _(\"Field name too long\"));\n        return -1;\n    }\n\n    return 0;\n}\n\n\nstatic virTypedParameterPtr\nvirTypedParamListExtend(virTypedParamListPtr list)\n{\n    if (VIR_RESIZE_N(list->par, list->par_alloc, list->npar, 1) < 0)\n        return NULL;\n\n    list->npar++;\n\n    return list->par + (list->npar - 1);\n}\n\n\nint\nvirTypedParamListAddInt(virTypedParamListPtr list,\n                        int value,\n                        const char *namefmt,\n                        ...)\n{\n    virTypedParameterPtr par;\n    va_list ap;\n    int ret;\n\n    if (!(par = virTypedParamListExtend(list)) ||\n        virTypedParameterAssignValue(par, true, VIR_TYPED_PARAM_INT, value) < 0)\n        return -1;\n\n    va_start(ap, namefmt);\n    ret = virTypedParamSetNameVPrintf(par, namefmt, ap);\n    va_end(ap);\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStrcpyStatic",
          "args": [
            "param->field",
            "name"
          ],
          "line": 283
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <stdarg.h>\n#include \"virtypedparam.h\"\n#include <config.h>\n\nint\nvirTypedParameterAssign(virTypedParameterPtr param, const char *name,\n                        int type, ...)\n{\n    va_list ap;\n    int ret = -1;\n\n    if (virStrcpyStatic(param->field, name) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, _(\"Field name '%s' too long\"),\n                       name);\n        return -1;\n    }\n\n    va_start(ap, type);\n    ret = virTypedParameterAssignValueVArgs(param, type, ap, false);\n    va_end(ap);\n\n    return ret;\n}"
  },
  {
    "function_name": "virTypedParameterAssignValue",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam.c",
    "lines": "255-269",
    "snippet": "static int\nvirTypedParameterAssignValue(virTypedParameterPtr param,\n                             bool copystr,\n                             int type,\n                             ...)\n{\n    int ret;\n    va_list ap;\n\n    va_start(ap, type);\n    ret = virTypedParameterAssignValueVArgs(param, type, ap, copystr);\n    va_end(ap);\n\n    return ret;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include <stdarg.h>",
      "#include \"virtypedparam.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "va_end",
          "args": [
            "ap"
          ],
          "line": 266
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virTypedParameterAssignValueVArgs",
          "args": [
            "param",
            "type",
            "ap",
            "copystr"
          ],
          "line": 265
        },
        "resolved": true,
        "details": {
          "function_name": "virTypedParameterAssignValueVArgs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam.c",
          "lines": "208-252",
          "snippet": "static int\nvirTypedParameterAssignValueVArgs(virTypedParameterPtr param,\n                                  int type,\n                                  va_list ap,\n                                  bool copystr)\n{\n    param->type = type;\n    switch (type) {\n    case VIR_TYPED_PARAM_INT:\n        param->value.i = va_arg(ap, int);\n        break;\n    case VIR_TYPED_PARAM_UINT:\n        param->value.ui = va_arg(ap, unsigned int);\n        break;\n    case VIR_TYPED_PARAM_LLONG:\n        param->value.l = va_arg(ap, long long int);\n        break;\n    case VIR_TYPED_PARAM_ULLONG:\n        param->value.ul = va_arg(ap, unsigned long long int);\n        break;\n    case VIR_TYPED_PARAM_DOUBLE:\n        param->value.d = va_arg(ap, double);\n        break;\n    case VIR_TYPED_PARAM_BOOLEAN:\n        param->value.b = !!va_arg(ap, int);\n        break;\n    case VIR_TYPED_PARAM_STRING:\n        if (copystr) {\n            param->value.s = g_strdup(va_arg(ap, char *));\n        } else {\n            param->value.s = va_arg(ap, char *);\n        }\n\n        if (!param->value.s)\n            param->value.s = g_strdup(\"\");\n        break;\n    default:\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"unexpected type %d for field %s\"), type,\n                       NULLSTR(param->field));\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <stdarg.h>",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <stdarg.h>\n#include \"virtypedparam.h\"\n#include <config.h>\n\nstatic int\nvirTypedParameterAssignValueVArgs(virTypedParameterPtr param,\n                                  int type,\n                                  va_list ap,\n                                  bool copystr)\n{\n    param->type = type;\n    switch (type) {\n    case VIR_TYPED_PARAM_INT:\n        param->value.i = va_arg(ap, int);\n        break;\n    case VIR_TYPED_PARAM_UINT:\n        param->value.ui = va_arg(ap, unsigned int);\n        break;\n    case VIR_TYPED_PARAM_LLONG:\n        param->value.l = va_arg(ap, long long int);\n        break;\n    case VIR_TYPED_PARAM_ULLONG:\n        param->value.ul = va_arg(ap, unsigned long long int);\n        break;\n    case VIR_TYPED_PARAM_DOUBLE:\n        param->value.d = va_arg(ap, double);\n        break;\n    case VIR_TYPED_PARAM_BOOLEAN:\n        param->value.b = !!va_arg(ap, int);\n        break;\n    case VIR_TYPED_PARAM_STRING:\n        if (copystr) {\n            param->value.s = g_strdup(va_arg(ap, char *));\n        } else {\n            param->value.s = va_arg(ap, char *);\n        }\n\n        if (!param->value.s)\n            param->value.s = g_strdup(\"\");\n        break;\n    default:\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"unexpected type %d for field %s\"), type,\n                       NULLSTR(param->field));\n        return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "va_start",
          "args": [
            "ap",
            "type"
          ],
          "line": 264
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <stdarg.h>\n#include \"virtypedparam.h\"\n#include <config.h>\n\nstatic int\nvirTypedParameterAssignValue(virTypedParameterPtr param,\n                             bool copystr,\n                             int type,\n                             ...)\n{\n    int ret;\n    va_list ap;\n\n    va_start(ap, type);\n    ret = virTypedParameterAssignValueVArgs(param, type, ap, copystr);\n    va_end(ap);\n\n    return ret;\n}"
  },
  {
    "function_name": "virTypedParameterAssignValueVArgs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam.c",
    "lines": "208-252",
    "snippet": "static int\nvirTypedParameterAssignValueVArgs(virTypedParameterPtr param,\n                                  int type,\n                                  va_list ap,\n                                  bool copystr)\n{\n    param->type = type;\n    switch (type) {\n    case VIR_TYPED_PARAM_INT:\n        param->value.i = va_arg(ap, int);\n        break;\n    case VIR_TYPED_PARAM_UINT:\n        param->value.ui = va_arg(ap, unsigned int);\n        break;\n    case VIR_TYPED_PARAM_LLONG:\n        param->value.l = va_arg(ap, long long int);\n        break;\n    case VIR_TYPED_PARAM_ULLONG:\n        param->value.ul = va_arg(ap, unsigned long long int);\n        break;\n    case VIR_TYPED_PARAM_DOUBLE:\n        param->value.d = va_arg(ap, double);\n        break;\n    case VIR_TYPED_PARAM_BOOLEAN:\n        param->value.b = !!va_arg(ap, int);\n        break;\n    case VIR_TYPED_PARAM_STRING:\n        if (copystr) {\n            param->value.s = g_strdup(va_arg(ap, char *));\n        } else {\n            param->value.s = va_arg(ap, char *);\n        }\n\n        if (!param->value.s)\n            param->value.s = g_strdup(\"\");\n        break;\n    default:\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"unexpected type %d for field %s\"), type,\n                       NULLSTR(param->field));\n        return -1;\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include <stdarg.h>",
      "#include \"virtypedparam.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"unexpected type %d for field %s\")",
            "type",
            "NULLSTR(param->field)"
          ],
          "line": 245
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "param->field"
          ],
          "line": 247
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"unexpected type %d for field %s\""
          ],
          "line": 246
        },
        "resolved": true,
        "details": {
          "function_name": "G_GNUC_PRINTF",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam.c",
          "lines": "751-796",
          "snippet": "static int G_GNUC_PRINTF(2, 0)\nvirTypedParamSetNameVPrintf(virTypedParameterPtr par,\n                            const char *fmt,\n                            va_list ap)\n{\n    if (g_vsnprintf(par->field, VIR_TYPED_PARAM_FIELD_LENGTH, fmt, ap) > VIR_TYPED_PARAM_FIELD_LENGTH) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\", _(\"Field name too long\"));\n        return -1;\n    }\n\n    return 0;\n}\n\n\nstatic virTypedParameterPtr\nvirTypedParamListExtend(virTypedParamListPtr list)\n{\n    if (VIR_RESIZE_N(list->par, list->par_alloc, list->npar, 1) < 0)\n        return NULL;\n\n    list->npar++;\n\n    return list->par + (list->npar - 1);\n}\n\n\nint\nvirTypedParamListAddInt(virTypedParamListPtr list,\n                        int value,\n                        const char *namefmt,\n                        ...)\n{\n    virTypedParameterPtr par;\n    va_list ap;\n    int ret;\n\n    if (!(par = virTypedParamListExtend(list)) ||\n        virTypedParameterAssignValue(par, true, VIR_TYPED_PARAM_INT, value) < 0)\n        return -1;\n\n    va_start(ap, namefmt);\n    ret = virTypedParamSetNameVPrintf(par, namefmt, ap);\n    va_end(ap);\n\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <stdarg.h>",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <stdarg.h>\n#include \"virtypedparam.h\"\n#include <config.h>\n\nstatic int G_GNUC_PRINTF(2, 0)\nvirTypedParamSetNameVPrintf(virTypedParameterPtr par,\n                            const char *fmt,\n                            va_list ap)\n{\n    if (g_vsnprintf(par->field, VIR_TYPED_PARAM_FIELD_LENGTH, fmt, ap) > VIR_TYPED_PARAM_FIELD_LENGTH) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\", _(\"Field name too long\"));\n        return -1;\n    }\n\n    return 0;\n}\n\n\nstatic virTypedParameterPtr\nvirTypedParamListExtend(virTypedParamListPtr list)\n{\n    if (VIR_RESIZE_N(list->par, list->par_alloc, list->npar, 1) < 0)\n        return NULL;\n\n    list->npar++;\n\n    return list->par + (list->npar - 1);\n}\n\n\nint\nvirTypedParamListAddInt(virTypedParamListPtr list,\n                        int value,\n                        const char *namefmt,\n                        ...)\n{\n    virTypedParameterPtr par;\n    va_list ap;\n    int ret;\n\n    if (!(par = virTypedParamListExtend(list)) ||\n        virTypedParameterAssignValue(par, true, VIR_TYPED_PARAM_INT, value) < 0)\n        return -1;\n\n    va_start(ap, namefmt);\n    ret = virTypedParamSetNameVPrintf(par, namefmt, ap);\n    va_end(ap);\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "\"\""
          ],
          "line": 242
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "va_arg",
          "args": [
            "ap",
            "char*"
          ],
          "line": 238
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_arg",
          "args": [
            "ap",
            "char*"
          ],
          "line": 236
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_arg",
          "args": [
            "ap",
            "int"
          ],
          "line": 232
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_arg",
          "args": [
            "ap",
            "double"
          ],
          "line": 229
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_arg",
          "args": [
            "ap",
            "unsignedlong long int"
          ],
          "line": 226
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_arg",
          "args": [
            "ap",
            "longlong int"
          ],
          "line": 223
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_arg",
          "args": [
            "ap",
            "unsignedint"
          ],
          "line": 220
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_arg",
          "args": [
            "ap",
            "int"
          ],
          "line": 217
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <stdarg.h>\n#include \"virtypedparam.h\"\n#include <config.h>\n\nstatic int\nvirTypedParameterAssignValueVArgs(virTypedParameterPtr param,\n                                  int type,\n                                  va_list ap,\n                                  bool copystr)\n{\n    param->type = type;\n    switch (type) {\n    case VIR_TYPED_PARAM_INT:\n        param->value.i = va_arg(ap, int);\n        break;\n    case VIR_TYPED_PARAM_UINT:\n        param->value.ui = va_arg(ap, unsigned int);\n        break;\n    case VIR_TYPED_PARAM_LLONG:\n        param->value.l = va_arg(ap, long long int);\n        break;\n    case VIR_TYPED_PARAM_ULLONG:\n        param->value.ul = va_arg(ap, unsigned long long int);\n        break;\n    case VIR_TYPED_PARAM_DOUBLE:\n        param->value.d = va_arg(ap, double);\n        break;\n    case VIR_TYPED_PARAM_BOOLEAN:\n        param->value.b = !!va_arg(ap, int);\n        break;\n    case VIR_TYPED_PARAM_STRING:\n        if (copystr) {\n            param->value.s = g_strdup(va_arg(ap, char *));\n        } else {\n            param->value.s = va_arg(ap, char *);\n        }\n\n        if (!param->value.s)\n            param->value.s = g_strdup(\"\");\n        break;\n    default:\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"unexpected type %d for field %s\"), type,\n                       NULLSTR(param->field));\n        return -1;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virTypedParameterToString",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam.c",
    "lines": "171-205",
    "snippet": "char *\nvirTypedParameterToString(virTypedParameterPtr param)\n{\n    char *value = NULL;\n\n    switch (param->type) {\n    case VIR_TYPED_PARAM_INT:\n        value = g_strdup_printf(\"%d\", param->value.i);\n        break;\n    case VIR_TYPED_PARAM_UINT:\n        value = g_strdup_printf(\"%u\", param->value.ui);\n        break;\n    case VIR_TYPED_PARAM_LLONG:\n        value = g_strdup_printf(\"%lld\", param->value.l);\n        break;\n    case VIR_TYPED_PARAM_ULLONG:\n        value = g_strdup_printf(\"%llu\", param->value.ul);\n        break;\n    case VIR_TYPED_PARAM_DOUBLE:\n        value = g_strdup_printf(\"%g\", param->value.d);\n        break;\n    case VIR_TYPED_PARAM_BOOLEAN:\n        value = g_strdup_printf(\"%d\", param->value.b);\n        break;\n    case VIR_TYPED_PARAM_STRING:\n        value = g_strdup(param->value.s);\n        break;\n    default:\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"unexpected type %d for field %s\"),\n                       param->type, param->field);\n    }\n\n    return value;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include <stdarg.h>",
      "#include \"virtypedparam.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"unexpected type %d for field %s\")",
            "param->type",
            "param->field"
          ],
          "line": 199
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"unexpected type %d for field %s\""
          ],
          "line": 200
        },
        "resolved": true,
        "details": {
          "function_name": "G_GNUC_PRINTF",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam.c",
          "lines": "751-796",
          "snippet": "static int G_GNUC_PRINTF(2, 0)\nvirTypedParamSetNameVPrintf(virTypedParameterPtr par,\n                            const char *fmt,\n                            va_list ap)\n{\n    if (g_vsnprintf(par->field, VIR_TYPED_PARAM_FIELD_LENGTH, fmt, ap) > VIR_TYPED_PARAM_FIELD_LENGTH) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\", _(\"Field name too long\"));\n        return -1;\n    }\n\n    return 0;\n}\n\n\nstatic virTypedParameterPtr\nvirTypedParamListExtend(virTypedParamListPtr list)\n{\n    if (VIR_RESIZE_N(list->par, list->par_alloc, list->npar, 1) < 0)\n        return NULL;\n\n    list->npar++;\n\n    return list->par + (list->npar - 1);\n}\n\n\nint\nvirTypedParamListAddInt(virTypedParamListPtr list,\n                        int value,\n                        const char *namefmt,\n                        ...)\n{\n    virTypedParameterPtr par;\n    va_list ap;\n    int ret;\n\n    if (!(par = virTypedParamListExtend(list)) ||\n        virTypedParameterAssignValue(par, true, VIR_TYPED_PARAM_INT, value) < 0)\n        return -1;\n\n    va_start(ap, namefmt);\n    ret = virTypedParamSetNameVPrintf(par, namefmt, ap);\n    va_end(ap);\n\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <stdarg.h>",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <stdarg.h>\n#include \"virtypedparam.h\"\n#include <config.h>\n\nstatic int G_GNUC_PRINTF(2, 0)\nvirTypedParamSetNameVPrintf(virTypedParameterPtr par,\n                            const char *fmt,\n                            va_list ap)\n{\n    if (g_vsnprintf(par->field, VIR_TYPED_PARAM_FIELD_LENGTH, fmt, ap) > VIR_TYPED_PARAM_FIELD_LENGTH) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\", _(\"Field name too long\"));\n        return -1;\n    }\n\n    return 0;\n}\n\n\nstatic virTypedParameterPtr\nvirTypedParamListExtend(virTypedParamListPtr list)\n{\n    if (VIR_RESIZE_N(list->par, list->par_alloc, list->npar, 1) < 0)\n        return NULL;\n\n    list->npar++;\n\n    return list->par + (list->npar - 1);\n}\n\n\nint\nvirTypedParamListAddInt(virTypedParamListPtr list,\n                        int value,\n                        const char *namefmt,\n                        ...)\n{\n    virTypedParameterPtr par;\n    va_list ap;\n    int ret;\n\n    if (!(par = virTypedParamListExtend(list)) ||\n        virTypedParameterAssignValue(par, true, VIR_TYPED_PARAM_INT, value) < 0)\n        return -1;\n\n    va_start(ap, namefmt);\n    ret = virTypedParamSetNameVPrintf(par, namefmt, ap);\n    va_end(ap);\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "param->value.s"
          ],
          "line": 196
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <stdarg.h>\n#include \"virtypedparam.h\"\n#include <config.h>\n\nchar *\nvirTypedParameterToString(virTypedParameterPtr param)\n{\n    char *value = NULL;\n\n    switch (param->type) {\n    case VIR_TYPED_PARAM_INT:\n        value = g_strdup_printf(\"%d\", param->value.i);\n        break;\n    case VIR_TYPED_PARAM_UINT:\n        value = g_strdup_printf(\"%u\", param->value.ui);\n        break;\n    case VIR_TYPED_PARAM_LLONG:\n        value = g_strdup_printf(\"%lld\", param->value.l);\n        break;\n    case VIR_TYPED_PARAM_ULLONG:\n        value = g_strdup_printf(\"%llu\", param->value.ul);\n        break;\n    case VIR_TYPED_PARAM_DOUBLE:\n        value = g_strdup_printf(\"%g\", param->value.d);\n        break;\n    case VIR_TYPED_PARAM_BOOLEAN:\n        value = g_strdup_printf(\"%d\", param->value.b);\n        break;\n    case VIR_TYPED_PARAM_STRING:\n        value = g_strdup(param->value.s);\n        break;\n    default:\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"unexpected type %d for field %s\"),\n                       param->type, param->field);\n    }\n\n    return value;\n}"
  },
  {
    "function_name": "virTypedParamsCheck",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam.c",
    "lines": "148-169",
    "snippet": "bool\nvirTypedParamsCheck(virTypedParameterPtr params,\n                    int nparams,\n                    const char **names,\n                    int nnames)\n{\n    size_t i, j;\n\n    for (i = 0; i < nparams; i++) {\n        bool found = false;\n        for (j = 0; j < nnames; j++) {\n            if (STREQ(params[i].field, names[j])) {\n                found = true;\n                break;\n            }\n        }\n        if (!found)\n            return false;\n    }\n\n    return true;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include <stdarg.h>",
      "#include \"virtypedparam.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "params[i].field",
            "names[j]"
          ],
          "line": 159
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <stdarg.h>\n#include \"virtypedparam.h\"\n#include <config.h>\n\nbool\nvirTypedParamsCheck(virTypedParameterPtr params,\n                    int nparams,\n                    const char **names,\n                    int nnames)\n{\n    size_t i, j;\n\n    for (i = 0; i < nparams; i++) {\n        bool found = false;\n        for (j = 0; j < nnames; j++) {\n            if (STREQ(params[i].field, names[j])) {\n                found = true;\n                break;\n            }\n        }\n        if (!found)\n            return false;\n    }\n\n    return true;\n}"
  },
  {
    "function_name": "virTypedParamsValidate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam.c",
    "lines": "58-142",
    "snippet": "int\nvirTypedParamsValidate(virTypedParameterPtr params, int nparams, ...)\n{\n    va_list ap;\n    int ret = -1;\n    size_t i, j;\n    const char *name, *last_name = NULL;\n    int type;\n    size_t nkeys = 0, nkeysalloc = 0;\n    virTypedParameterPtr sorted = NULL, keys = NULL;\n\n    va_start(ap, nparams);\n\n    if (VIR_ALLOC_N(sorted, nparams) < 0)\n        goto cleanup;\n\n    /* Here we intentionally don't copy values */\n    memcpy(sorted, params, sizeof(*params) * nparams);\n    qsort(sorted, nparams, sizeof(*sorted), virTypedParamsSortName);\n\n    name = va_arg(ap, const char *);\n    while (name) {\n        type = va_arg(ap, int);\n        if (VIR_RESIZE_N(keys, nkeysalloc, nkeys, 1) < 0)\n            goto cleanup;\n\n        if (virStrcpyStatic(keys[nkeys].field, name) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Field name '%s' too long\"), name);\n            goto cleanup;\n        }\n\n        keys[nkeys].type = type & ~VIR_TYPED_PARAM_MULTIPLE;\n        /* Value is not used anyway */\n        keys[nkeys].value.i = type & VIR_TYPED_PARAM_MULTIPLE;\n\n        nkeys++;\n        name = va_arg(ap, const char *);\n    }\n\n    qsort(keys, nkeys, sizeof(*keys), virTypedParamsSortName);\n\n    for (i = 0, j = 0; i < nparams && j < nkeys;) {\n        if (STRNEQ(sorted[i].field, keys[j].field)) {\n            j++;\n        } else {\n            if (STREQ_NULLABLE(last_name, sorted[i].field) &&\n                !(keys[j].value.i & VIR_TYPED_PARAM_MULTIPLE)) {\n                virReportError(VIR_ERR_INVALID_ARG,\n                               _(\"parameter '%s' occurs multiple times\"),\n                               sorted[i].field);\n                goto cleanup;\n            }\n            if (sorted[i].type != keys[j].type) {\n                const char *badtype;\n\n                badtype = virTypedParameterTypeToString(sorted[i].type);\n                if (!badtype)\n                    badtype = virTypedParameterTypeToString(0);\n                virReportError(VIR_ERR_INVALID_ARG,\n                               _(\"invalid type '%s' for parameter '%s', \"\n                                 \"expected '%s'\"),\n                               badtype, sorted[i].field,\n                               virTypedParameterTypeToString(keys[j].type));\n                goto cleanup;\n            }\n            last_name = sorted[i].field;\n            i++;\n        }\n    }\n\n    if (j == nkeys && i != nparams) {\n        virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED,\n                       _(\"parameter '%s' not supported\"),\n                       sorted[i].field);\n        goto cleanup;\n    }\n\n    ret = 0;\n cleanup:\n    va_end(ap);\n    VIR_FREE(sorted);\n    VIR_FREE(keys);\n    return ret;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include <stdarg.h>",
      "#include \"virtypedparam.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "keys"
          ],
          "line": 140
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "sorted"
          ],
          "line": 139
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_end",
          "args": [
            "ap"
          ],
          "line": 138
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_ARGUMENT_UNSUPPORTED",
            "_(\"parameter '%s' not supported\")",
            "sorted[i].field"
          ],
          "line": 130
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"parameter '%s' not supported\""
          ],
          "line": 131
        },
        "resolved": true,
        "details": {
          "function_name": "G_GNUC_PRINTF",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam.c",
          "lines": "751-796",
          "snippet": "static int G_GNUC_PRINTF(2, 0)\nvirTypedParamSetNameVPrintf(virTypedParameterPtr par,\n                            const char *fmt,\n                            va_list ap)\n{\n    if (g_vsnprintf(par->field, VIR_TYPED_PARAM_FIELD_LENGTH, fmt, ap) > VIR_TYPED_PARAM_FIELD_LENGTH) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\", _(\"Field name too long\"));\n        return -1;\n    }\n\n    return 0;\n}\n\n\nstatic virTypedParameterPtr\nvirTypedParamListExtend(virTypedParamListPtr list)\n{\n    if (VIR_RESIZE_N(list->par, list->par_alloc, list->npar, 1) < 0)\n        return NULL;\n\n    list->npar++;\n\n    return list->par + (list->npar - 1);\n}\n\n\nint\nvirTypedParamListAddInt(virTypedParamListPtr list,\n                        int value,\n                        const char *namefmt,\n                        ...)\n{\n    virTypedParameterPtr par;\n    va_list ap;\n    int ret;\n\n    if (!(par = virTypedParamListExtend(list)) ||\n        virTypedParameterAssignValue(par, true, VIR_TYPED_PARAM_INT, value) < 0)\n        return -1;\n\n    va_start(ap, namefmt);\n    ret = virTypedParamSetNameVPrintf(par, namefmt, ap);\n    va_end(ap);\n\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <stdarg.h>",
            "#include \"virtypedparam.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <stdarg.h>\n#include \"virtypedparam.h\"\n#include <config.h>\n\nstatic int G_GNUC_PRINTF(2, 0)\nvirTypedParamSetNameVPrintf(virTypedParameterPtr par,\n                            const char *fmt,\n                            va_list ap)\n{\n    if (g_vsnprintf(par->field, VIR_TYPED_PARAM_FIELD_LENGTH, fmt, ap) > VIR_TYPED_PARAM_FIELD_LENGTH) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\", _(\"Field name too long\"));\n        return -1;\n    }\n\n    return 0;\n}\n\n\nstatic virTypedParameterPtr\nvirTypedParamListExtend(virTypedParamListPtr list)\n{\n    if (VIR_RESIZE_N(list->par, list->par_alloc, list->npar, 1) < 0)\n        return NULL;\n\n    list->npar++;\n\n    return list->par + (list->npar - 1);\n}\n\n\nint\nvirTypedParamListAddInt(virTypedParamListPtr list,\n                        int value,\n                        const char *namefmt,\n                        ...)\n{\n    virTypedParameterPtr par;\n    va_list ap;\n    int ret;\n\n    if (!(par = virTypedParamListExtend(list)) ||\n        virTypedParameterAssignValue(par, true, VIR_TYPED_PARAM_INT, value) < 0)\n        return -1;\n\n    va_start(ap, namefmt);\n    ret = virTypedParamSetNameVPrintf(par, namefmt, ap);\n    va_end(ap);\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INVALID_ARG",
            "_(\"invalid type '%s' for parameter '%s', \"\n                                 \"expected '%s'\")",
            "badtype",
            "sorted[i].field",
            "virTypedParameterTypeToString(keys[j].type)"
          ],
          "line": 117
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virTypedParameterTypeToString",
          "args": [
            "keys[j].type"
          ],
          "line": 121
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virTypedParameterTypeToString",
          "args": [
            "0"
          ],
          "line": 116
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virTypedParameterTypeToString",
          "args": [
            "sorted[i].type"
          ],
          "line": 114
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INVALID_ARG",
            "_(\"parameter '%s' occurs multiple times\")",
            "sorted[i].field"
          ],
          "line": 106
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ_NULLABLE",
          "args": [
            "last_name",
            "sorted[i].field"
          ],
          "line": 104
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STRNEQ",
          "args": [
            "sorted[i].field",
            "keys[j].field"
          ],
          "line": 101
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qsort",
          "args": [
            "keys",
            "nkeys",
            "sizeof(*keys)",
            "virTypedParamsSortName"
          ],
          "line": 98
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_arg",
          "args": [
            "ap",
            "constchar *"
          ],
          "line": 95
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Field name '%s' too long\")",
            "name"
          ],
          "line": 85
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStrcpyStatic",
          "args": [
            "keys[nkeys].field",
            "name"
          ],
          "line": 84
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_RESIZE_N",
          "args": [
            "keys",
            "nkeysalloc",
            "nkeys",
            "1"
          ],
          "line": 81
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_arg",
          "args": [
            "ap",
            "int"
          ],
          "line": 80
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_arg",
          "args": [
            "ap",
            "constchar *"
          ],
          "line": 78
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qsort",
          "args": [
            "sorted",
            "nparams",
            "sizeof(*sorted)",
            "virTypedParamsSortName"
          ],
          "line": 76
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "sorted",
            "params",
            "sizeof(*params) * nparams"
          ],
          "line": 75
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC_N",
          "args": [
            "sorted",
            "nparams"
          ],
          "line": 71
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "va_start",
          "args": [
            "ap",
            "nparams"
          ],
          "line": 69
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <stdarg.h>\n#include \"virtypedparam.h\"\n#include <config.h>\n\nint\nvirTypedParamsValidate(virTypedParameterPtr params, int nparams, ...)\n{\n    va_list ap;\n    int ret = -1;\n    size_t i, j;\n    const char *name, *last_name = NULL;\n    int type;\n    size_t nkeys = 0, nkeysalloc = 0;\n    virTypedParameterPtr sorted = NULL, keys = NULL;\n\n    va_start(ap, nparams);\n\n    if (VIR_ALLOC_N(sorted, nparams) < 0)\n        goto cleanup;\n\n    /* Here we intentionally don't copy values */\n    memcpy(sorted, params, sizeof(*params) * nparams);\n    qsort(sorted, nparams, sizeof(*sorted), virTypedParamsSortName);\n\n    name = va_arg(ap, const char *);\n    while (name) {\n        type = va_arg(ap, int);\n        if (VIR_RESIZE_N(keys, nkeysalloc, nkeys, 1) < 0)\n            goto cleanup;\n\n        if (virStrcpyStatic(keys[nkeys].field, name) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Field name '%s' too long\"), name);\n            goto cleanup;\n        }\n\n        keys[nkeys].type = type & ~VIR_TYPED_PARAM_MULTIPLE;\n        /* Value is not used anyway */\n        keys[nkeys].value.i = type & VIR_TYPED_PARAM_MULTIPLE;\n\n        nkeys++;\n        name = va_arg(ap, const char *);\n    }\n\n    qsort(keys, nkeys, sizeof(*keys), virTypedParamsSortName);\n\n    for (i = 0, j = 0; i < nparams && j < nkeys;) {\n        if (STRNEQ(sorted[i].field, keys[j].field)) {\n            j++;\n        } else {\n            if (STREQ_NULLABLE(last_name, sorted[i].field) &&\n                !(keys[j].value.i & VIR_TYPED_PARAM_MULTIPLE)) {\n                virReportError(VIR_ERR_INVALID_ARG,\n                               _(\"parameter '%s' occurs multiple times\"),\n                               sorted[i].field);\n                goto cleanup;\n            }\n            if (sorted[i].type != keys[j].type) {\n                const char *badtype;\n\n                badtype = virTypedParameterTypeToString(sorted[i].type);\n                if (!badtype)\n                    badtype = virTypedParameterTypeToString(0);\n                virReportError(VIR_ERR_INVALID_ARG,\n                               _(\"invalid type '%s' for parameter '%s', \"\n                                 \"expected '%s'\"),\n                               badtype, sorted[i].field,\n                               virTypedParameterTypeToString(keys[j].type));\n                goto cleanup;\n            }\n            last_name = sorted[i].field;\n            i++;\n        }\n    }\n\n    if (j == nkeys && i != nparams) {\n        virReportError(VIR_ERR_ARGUMENT_UNSUPPORTED,\n                       _(\"parameter '%s' not supported\"),\n                       sorted[i].field);\n        goto cleanup;\n    }\n\n    ret = 0;\n cleanup:\n    va_end(ap);\n    VIR_FREE(sorted);\n    VIR_FREE(keys);\n    return ret;\n}"
  },
  {
    "function_name": "virTypedParamsSortName",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virtypedparam.c",
    "lines": "45-50",
    "snippet": "static int\nvirTypedParamsSortName(const void *left, const void *right)\n{\n    const virTypedParameter *param_left = left, *param_right = right;\n    return strcmp(param_left->field, param_right->field);\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"viralloc.h\"",
      "#include <stdarg.h>",
      "#include \"virtypedparam.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "param_left->field",
            "param_right->field"
          ],
          "line": 49
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <stdarg.h>\n#include \"virtypedparam.h\"\n#include <config.h>\n\nstatic int\nvirTypedParamsSortName(const void *left, const void *right)\n{\n    const virTypedParameter *param_left = left, *param_right = right;\n    return strcmp(param_left->field, param_right->field);\n}"
  }
]