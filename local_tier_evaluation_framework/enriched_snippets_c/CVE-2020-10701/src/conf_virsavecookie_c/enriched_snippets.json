[
  {
    "function_name": "virSaveCookieFormat",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virsavecookie.c",
    "lines": "127-141",
    "snippet": "char *\nvirSaveCookieFormat(virObjectPtr obj,\n                    virSaveCookieCallbacksPtr saveCookie)\n{\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n\n    if (virSaveCookieFormatBuf(&buf, obj, saveCookie) < 0)\n        goto error;\n\n    return virBufferContentAndReset(&buf);\n\n error:\n    virBufferFreeAndReset(&buf);\n    return NULL;\n}",
    "includes": [
      "#include \"virsavecookie.h\"",
      "#include \"virxml.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virobject.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virBufferFreeAndReset",
          "args": [
            "&buf"
          ],
          "line": 139
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferFreeAndReset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "268-277",
          "snippet": "void virBufferFreeAndReset(virBufferPtr buf)\n{\n    if (!buf)\n        return;\n\n    if (buf->str)\n        g_string_free(buf->str, true);\n\n    memset(buf, 0, sizeof(*buf));\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid virBufferFreeAndReset(virBufferPtr buf)\n{\n    if (!buf)\n        return;\n\n    if (buf->str)\n        g_string_free(buf->str, true);\n\n    memset(buf, 0, sizeof(*buf));\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBufferContentAndReset",
          "args": [
            "&buf"
          ],
          "line": 136
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferContentAndReset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "247-260",
          "snippet": "char *\nvirBufferContentAndReset(virBufferPtr buf)\n{\n    char *str = NULL;\n\n    if (!buf)\n        return NULL;\n\n    if (buf->str)\n        str = g_string_free(buf->str, false);\n\n    memset(buf, 0, sizeof(*buf));\n    return str;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nchar *\nvirBufferContentAndReset(virBufferPtr buf)\n{\n    char *str = NULL;\n\n    if (!buf)\n        return NULL;\n\n    if (buf->str)\n        str = g_string_free(buf->str, false);\n\n    memset(buf, 0, sizeof(*buf));\n    return str;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSaveCookieFormatBuf",
          "args": [
            "&buf",
            "obj",
            "saveCookie"
          ],
          "line": 133
        },
        "resolved": true,
        "details": {
          "function_name": "virSaveCookieFormatBuf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virsavecookie.c",
          "lines": "106-124",
          "snippet": "int\nvirSaveCookieFormatBuf(virBufferPtr buf,\n                       virObjectPtr obj,\n                       virSaveCookieCallbacksPtr saveCookie)\n{\n    if (!obj || !saveCookie || !saveCookie->format)\n        return 0;\n\n    virBufferAddLit(buf, \"<cookie>\\n\");\n    virBufferAdjustIndent(buf, 2);\n\n    if (saveCookie->format(buf, obj) < 0)\n        return -1;\n\n    virBufferAdjustIndent(buf, -2);\n    virBufferAddLit(buf, \"</cookie>\\n\");\n\n    return 0;\n}",
          "includes": [
            "#include \"virsavecookie.h\"",
            "#include \"virxml.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virobject.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsavecookie.h\"\n#include \"virxml.h\"\n#include \"virbuffer.h\"\n#include \"virobject.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint\nvirSaveCookieFormatBuf(virBufferPtr buf,\n                       virObjectPtr obj,\n                       virSaveCookieCallbacksPtr saveCookie)\n{\n    if (!obj || !saveCookie || !saveCookie->format)\n        return 0;\n\n    virBufferAddLit(buf, \"<cookie>\\n\");\n    virBufferAdjustIndent(buf, 2);\n\n    if (saveCookie->format(buf, obj) < 0)\n        return -1;\n\n    virBufferAdjustIndent(buf, -2);\n    virBufferAddLit(buf, \"</cookie>\\n\");\n\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsavecookie.h\"\n#include \"virxml.h\"\n#include \"virbuffer.h\"\n#include \"virobject.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nchar *\nvirSaveCookieFormat(virObjectPtr obj,\n                    virSaveCookieCallbacksPtr saveCookie)\n{\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n\n    if (virSaveCookieFormatBuf(&buf, obj, saveCookie) < 0)\n        goto error;\n\n    return virBufferContentAndReset(&buf);\n\n error:\n    virBufferFreeAndReset(&buf);\n    return NULL;\n}"
  },
  {
    "function_name": "virSaveCookieFormatBuf",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virsavecookie.c",
    "lines": "106-124",
    "snippet": "int\nvirSaveCookieFormatBuf(virBufferPtr buf,\n                       virObjectPtr obj,\n                       virSaveCookieCallbacksPtr saveCookie)\n{\n    if (!obj || !saveCookie || !saveCookie->format)\n        return 0;\n\n    virBufferAddLit(buf, \"<cookie>\\n\");\n    virBufferAdjustIndent(buf, 2);\n\n    if (saveCookie->format(buf, obj) < 0)\n        return -1;\n\n    virBufferAdjustIndent(buf, -2);\n    virBufferAddLit(buf, \"</cookie>\\n\");\n\n    return 0;\n}",
    "includes": [
      "#include \"virsavecookie.h\"",
      "#include \"virxml.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virobject.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "buf",
            "\"</cookie>\\n\""
          ],
          "line": 121
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBufferAdjustIndent",
          "args": [
            "buf",
            "-2"
          ],
          "line": 120
        },
        "resolved": true,
        "details": {
          "function_name": "virBufferAdjustIndent",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbuffer.c",
          "lines": "43-62",
          "snippet": "void\nvirBufferAdjustIndent(virBufferPtr buf, int indent)\n{\n    if (!buf)\n        return;\n\n    if (indent > 0) {\n        if (INT_MAX - indent < buf->indent) {\n            buf->indent = INT_MAX;\n            return;\n        }\n    } else {\n        if (buf->indent < -indent) {\n            buf->indent = 0;\n            return;\n        }\n    }\n\n    buf->indent += indent;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirBufferAdjustIndent(virBufferPtr buf, int indent)\n{\n    if (!buf)\n        return;\n\n    if (indent > 0) {\n        if (INT_MAX - indent < buf->indent) {\n            buf->indent = INT_MAX;\n            return;\n        }\n    } else {\n        if (buf->indent < -indent) {\n            buf->indent = 0;\n            return;\n        }\n    }\n\n    buf->indent += indent;\n}"
        }
      },
      {
        "call_info": {
          "callee": "saveCookie->format",
          "args": [
            "buf",
            "obj"
          ],
          "line": 117
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBufferAddLit",
          "args": [
            "buf",
            "\"<cookie>\\n\""
          ],
          "line": 114
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virsavecookie.h\"\n#include \"virxml.h\"\n#include \"virbuffer.h\"\n#include \"virobject.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint\nvirSaveCookieFormatBuf(virBufferPtr buf,\n                       virObjectPtr obj,\n                       virSaveCookieCallbacksPtr saveCookie)\n{\n    if (!obj || !saveCookie || !saveCookie->format)\n        return 0;\n\n    virBufferAddLit(buf, \"<cookie>\\n\");\n    virBufferAdjustIndent(buf, 2);\n\n    if (saveCookie->format(buf, obj) < 0)\n        return -1;\n\n    virBufferAdjustIndent(buf, -2);\n    virBufferAddLit(buf, \"</cookie>\\n\");\n\n    return 0;\n}"
  },
  {
    "function_name": "virSaveCookieParseString",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virsavecookie.c",
    "lines": "78-103",
    "snippet": "int\nvirSaveCookieParseString(const char *xml,\n                         virObjectPtr *obj,\n                         virSaveCookieCallbacksPtr saveCookie)\n{\n    xmlDocPtr doc = NULL;\n    xmlXPathContextPtr ctxt = NULL;\n    int ret = -1;\n\n    *obj = NULL;\n\n    if (!xml) {\n        ret = 0;\n        goto cleanup;\n    }\n\n    if (!(doc = virXMLParseStringCtxt(xml, _(\"(save cookie)\"), &ctxt)))\n        goto cleanup;\n\n    ret = virSaveCookieParseNode(ctxt, obj, saveCookie);\n\n cleanup:\n    xmlXPathFreeContext(ctxt);\n    xmlFreeDoc(doc);\n    return ret;\n}",
    "includes": [
      "#include \"virsavecookie.h\"",
      "#include \"virxml.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virobject.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "xmlFreeDoc",
          "args": [
            "doc"
          ],
          "line": 101
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xmlXPathFreeContext",
          "args": [
            "ctxt"
          ],
          "line": 100
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virSaveCookieParseNode",
          "args": [
            "ctxt",
            "obj",
            "saveCookie"
          ],
          "line": 97
        },
        "resolved": true,
        "details": {
          "function_name": "virSaveCookieParseNode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virsavecookie.c",
          "lines": "35-52",
          "snippet": "static int\nvirSaveCookieParseNode(xmlXPathContextPtr ctxt,\n                       virObjectPtr *obj,\n                       virSaveCookieCallbacksPtr saveCookie)\n{\n    *obj = NULL;\n\n    if (!virXMLNodeNameEqual(ctxt->node, \"cookie\")) {\n        virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                       _(\"XML does not contain expected 'cookie' element\"));\n        return -1;\n    }\n\n    if (!saveCookie || !saveCookie->parse)\n        return 0;\n\n    return saveCookie->parse(ctxt, obj);\n}",
          "includes": [
            "#include \"virsavecookie.h\"",
            "#include \"virxml.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virobject.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsavecookie.h\"\n#include \"virxml.h\"\n#include \"virbuffer.h\"\n#include \"virobject.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nstatic int\nvirSaveCookieParseNode(xmlXPathContextPtr ctxt,\n                       virObjectPtr *obj,\n                       virSaveCookieCallbacksPtr saveCookie)\n{\n    *obj = NULL;\n\n    if (!virXMLNodeNameEqual(ctxt->node, \"cookie\")) {\n        virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                       _(\"XML does not contain expected 'cookie' element\"));\n        return -1;\n    }\n\n    if (!saveCookie || !saveCookie->parse)\n        return 0;\n\n    return saveCookie->parse(ctxt, obj);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virXMLParseStringCtxt",
          "args": [
            "xml",
            "_(\"(save cookie)\")",
            "&ctxt"
          ],
          "line": 94
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"(save cookie)\""
          ],
          "line": 94
        },
        "resolved": true,
        "details": {
          "function_name": "ATTRIBUTE_NONNULL",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/cpu_conf.c",
          "lines": "135-141",
          "snippet": "int ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsavecookie.h\"\n#include \"virxml.h\"\n#include \"virbuffer.h\"\n#include \"virobject.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint\nvirSaveCookieParseString(const char *xml,\n                         virObjectPtr *obj,\n                         virSaveCookieCallbacksPtr saveCookie)\n{\n    xmlDocPtr doc = NULL;\n    xmlXPathContextPtr ctxt = NULL;\n    int ret = -1;\n\n    *obj = NULL;\n\n    if (!xml) {\n        ret = 0;\n        goto cleanup;\n    }\n\n    if (!(doc = virXMLParseStringCtxt(xml, _(\"(save cookie)\"), &ctxt)))\n        goto cleanup;\n\n    ret = virSaveCookieParseNode(ctxt, obj, saveCookie);\n\n cleanup:\n    xmlXPathFreeContext(ctxt);\n    xmlFreeDoc(doc);\n    return ret;\n}"
  },
  {
    "function_name": "virSaveCookieParse",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virsavecookie.c",
    "lines": "55-75",
    "snippet": "int\nvirSaveCookieParse(xmlXPathContextPtr ctxt,\n                   virObjectPtr *obj,\n                   virSaveCookieCallbacksPtr saveCookie)\n{\n    xmlNodePtr node = ctxt->node;\n    int ret = -1;\n\n    *obj = NULL;\n\n    if (!(ctxt->node = virXPathNode(\"./cookie\", ctxt))) {\n        ret = 0;\n        goto cleanup;\n    }\n\n    ret = virSaveCookieParseNode(ctxt, obj, saveCookie);\n\n cleanup:\n    ctxt->node = node;\n    return ret;\n}",
    "includes": [
      "#include \"virsavecookie.h\"",
      "#include \"virxml.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virobject.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virSaveCookieParseNode",
          "args": [
            "ctxt",
            "obj",
            "saveCookie"
          ],
          "line": 70
        },
        "resolved": true,
        "details": {
          "function_name": "virSaveCookieParseNode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virsavecookie.c",
          "lines": "35-52",
          "snippet": "static int\nvirSaveCookieParseNode(xmlXPathContextPtr ctxt,\n                       virObjectPtr *obj,\n                       virSaveCookieCallbacksPtr saveCookie)\n{\n    *obj = NULL;\n\n    if (!virXMLNodeNameEqual(ctxt->node, \"cookie\")) {\n        virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                       _(\"XML does not contain expected 'cookie' element\"));\n        return -1;\n    }\n\n    if (!saveCookie || !saveCookie->parse)\n        return 0;\n\n    return saveCookie->parse(ctxt, obj);\n}",
          "includes": [
            "#include \"virsavecookie.h\"",
            "#include \"virxml.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virobject.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsavecookie.h\"\n#include \"virxml.h\"\n#include \"virbuffer.h\"\n#include \"virobject.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nstatic int\nvirSaveCookieParseNode(xmlXPathContextPtr ctxt,\n                       virObjectPtr *obj,\n                       virSaveCookieCallbacksPtr saveCookie)\n{\n    *obj = NULL;\n\n    if (!virXMLNodeNameEqual(ctxt->node, \"cookie\")) {\n        virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                       _(\"XML does not contain expected 'cookie' element\"));\n        return -1;\n    }\n\n    if (!saveCookie || !saveCookie->parse)\n        return 0;\n\n    return saveCookie->parse(ctxt, obj);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virXPathNode",
          "args": [
            "\"./cookie\"",
            "ctxt"
          ],
          "line": 65
        },
        "resolved": true,
        "details": {
          "function_name": "virXPathNode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
          "lines": "608-634",
          "snippet": "xmlNodePtr\nvirXPathNode(const char *xpath,\n             xmlXPathContextPtr ctxt)\n{\n    xmlXPathObjectPtr obj;\n    xmlNodePtr relnode;\n    xmlNodePtr ret;\n\n    if ((ctxt == NULL) || (xpath == NULL)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"Invalid parameter to virXPathNode()\"));\n        return NULL;\n    }\n    relnode = ctxt->node;\n    obj = xmlXPathEval(BAD_CAST xpath, ctxt);\n    ctxt->node = relnode;\n    if ((obj == NULL) || (obj->type != XPATH_NODESET) ||\n        (obj->nodesetval == NULL) || (obj->nodesetval->nodeNr <= 0) ||\n        (obj->nodesetval->nodeTab == NULL)) {\n        xmlXPathFreeObject(obj);\n        return NULL;\n    }\n\n    ret = obj->nodesetval->nodeTab[0];\n    xmlXPathFreeObject(obj);\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virxml.h\"",
            "#include \"virerror.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <sys/stat.h>",
            "#include <math.h>               /* for isnan() */",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nxmlNodePtr\nvirXPathNode(const char *xpath,\n             xmlXPathContextPtr ctxt)\n{\n    xmlXPathObjectPtr obj;\n    xmlNodePtr relnode;\n    xmlNodePtr ret;\n\n    if ((ctxt == NULL) || (xpath == NULL)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"Invalid parameter to virXPathNode()\"));\n        return NULL;\n    }\n    relnode = ctxt->node;\n    obj = xmlXPathEval(BAD_CAST xpath, ctxt);\n    ctxt->node = relnode;\n    if ((obj == NULL) || (obj->type != XPATH_NODESET) ||\n        (obj->nodesetval == NULL) || (obj->nodesetval->nodeNr <= 0) ||\n        (obj->nodesetval->nodeTab == NULL)) {\n        xmlXPathFreeObject(obj);\n        return NULL;\n    }\n\n    ret = obj->nodesetval->nodeTab[0];\n    xmlXPathFreeObject(obj);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsavecookie.h\"\n#include \"virxml.h\"\n#include \"virbuffer.h\"\n#include \"virobject.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint\nvirSaveCookieParse(xmlXPathContextPtr ctxt,\n                   virObjectPtr *obj,\n                   virSaveCookieCallbacksPtr saveCookie)\n{\n    xmlNodePtr node = ctxt->node;\n    int ret = -1;\n\n    *obj = NULL;\n\n    if (!(ctxt->node = virXPathNode(\"./cookie\", ctxt))) {\n        ret = 0;\n        goto cleanup;\n    }\n\n    ret = virSaveCookieParseNode(ctxt, obj, saveCookie);\n\n cleanup:\n    ctxt->node = node;\n    return ret;\n}"
  },
  {
    "function_name": "virSaveCookieParseNode",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virsavecookie.c",
    "lines": "35-52",
    "snippet": "static int\nvirSaveCookieParseNode(xmlXPathContextPtr ctxt,\n                       virObjectPtr *obj,\n                       virSaveCookieCallbacksPtr saveCookie)\n{\n    *obj = NULL;\n\n    if (!virXMLNodeNameEqual(ctxt->node, \"cookie\")) {\n        virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                       _(\"XML does not contain expected 'cookie' element\"));\n        return -1;\n    }\n\n    if (!saveCookie || !saveCookie->parse)\n        return 0;\n\n    return saveCookie->parse(ctxt, obj);\n}",
    "includes": [
      "#include \"virsavecookie.h\"",
      "#include \"virxml.h\"",
      "#include \"virbuffer.h\"",
      "#include \"virobject.h\"",
      "#include \"virlog.h\"",
      "#include \"virerror.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "saveCookie->parse",
          "args": [
            "ctxt",
            "obj"
          ],
          "line": 51
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_XML_ERROR",
            "\"%s\"",
            "_(\"XML does not contain expected 'cookie' element\")"
          ],
          "line": 43
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"XML does not contain expected 'cookie' element\""
          ],
          "line": 44
        },
        "resolved": true,
        "details": {
          "function_name": "ATTRIBUTE_NONNULL",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/cpu_conf.c",
          "lines": "135-141",
          "snippet": "int ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virXMLNodeNameEqual",
          "args": [
            "ctxt->node",
            "\"cookie\""
          ],
          "line": 42
        },
        "resolved": true,
        "details": {
          "function_name": "virXMLNodeNameEqual",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virxml.c",
          "lines": "1013-1018",
          "snippet": "bool\nvirXMLNodeNameEqual(xmlNodePtr node,\n                    const char *name)\n{\n    return xmlStrEqual(node->name, BAD_CAST name);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virxml.h\"",
            "#include \"virerror.h\"",
            "#include <libxml/xpathInternals.h>",
            "#include <sys/stat.h>",
            "#include <math.h>               /* for isnan() */",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virxml.h\"\n#include \"virerror.h\"\n#include <libxml/xpathInternals.h>\n#include <sys/stat.h>\n#include <math.h>               /* for isnan() */\n#include <stdarg.h>\n#include <config.h>\n\nbool\nvirXMLNodeNameEqual(xmlNodePtr node,\n                    const char *name)\n{\n    return xmlStrEqual(node->name, BAD_CAST name);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virsavecookie.h\"\n#include \"virxml.h\"\n#include \"virbuffer.h\"\n#include \"virobject.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nstatic int\nvirSaveCookieParseNode(xmlXPathContextPtr ctxt,\n                       virObjectPtr *obj,\n                       virSaveCookieCallbacksPtr saveCookie)\n{\n    *obj = NULL;\n\n    if (!virXMLNodeNameEqual(ctxt->node, \"cookie\")) {\n        virReportError(VIR_ERR_XML_ERROR, \"%s\",\n                       _(\"XML does not contain expected 'cookie' element\"));\n        return -1;\n    }\n\n    if (!saveCookie || !saveCookie->parse)\n        return 0;\n\n    return saveCookie->parse(ctxt, obj);\n}"
  }
]