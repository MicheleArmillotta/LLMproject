[
  {
    "function_name": "virCgroupV1Register",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv1.c",
    "lines": "2187-2191",
    "snippet": "void\nvirCgroupV1Register(void)\n{\n    VIR_INFO(\"Control groups not supported on this platform\");\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"vircgroupv1.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <sys/stat.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_INFO",
          "args": [
            "\"Control groups not supported on this platform\""
          ],
          "line": 2190
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"vircgroupv1.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <sys/stat.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nvoid\nvirCgroupV1Register(void)\n{\n    VIR_INFO(\"Control groups not supported on this platform\");\n}"
  },
  {
    "function_name": "virCgroupV1Register",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv1.c",
    "lines": "2179-2183",
    "snippet": "void\nvirCgroupV1Register(void)\n{\n    virCgroupBackendRegister(&virCgroupV1Backend);\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"vircgroupv1.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <sys/stat.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCgroupBackendRegister",
          "args": [
            "&virCgroupV1Backend"
          ],
          "line": 2182
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupBackendRegister",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupbackend.c",
          "lines": "42-53",
          "snippet": "void\nvirCgroupBackendRegister(virCgroupBackendPtr backend)\n{\n    if (virCgroupBackends[backend->type]) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Cgroup backend '%s' already registered.\"),\n                       virCgroupBackendTypeToString(backend->type));\n        return;\n    }\n\n    virCgroupBackends[backend->type] = backend;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupv2.h\"",
            "#include \"vircgroupv1.h\"",
            "#include \"vircgrouppriv.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virCgroupBackendPtr virCgroupBackends[VIR_CGROUP_BACKEND_TYPE_LAST] = { 0 };"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"vircgroupv2.h\"\n#include \"vircgroupv1.h\"\n#include \"vircgrouppriv.h\"\n#include \"vircgroupbackend.h\"\n#include <config.h>\n\nstatic virCgroupBackendPtr virCgroupBackends[VIR_CGROUP_BACKEND_TYPE_LAST] = { 0 };\n\nvoid\nvirCgroupBackendRegister(virCgroupBackendPtr backend)\n{\n    if (virCgroupBackends[backend->type]) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Cgroup backend '%s' already registered.\"),\n                       virCgroupBackendTypeToString(backend->type));\n        return;\n    }\n\n    virCgroupBackends[backend->type] = backend;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"vircgroupv1.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <sys/stat.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nvoid\nvirCgroupV1Register(void)\n{\n    virCgroupBackendRegister(&virCgroupV1Backend);\n}"
  },
  {
    "function_name": "virCgroupV1GetCpusetCpus",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv1.c",
    "lines": "2090-2098",
    "snippet": "static int\nvirCgroupV1GetCpusetCpus(virCgroupPtr group,\n                         char **cpus)\n{\n    return virCgroupGetValueStr(group,\n                                VIR_CGROUP_CONTROLLER_CPUSET,\n                                \"cpuset.cpus\",\n                                cpus);\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"vircgroupv1.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <sys/stat.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCgroupGetValueStr",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_CPUSET",
            "\"cpuset.cpus\"",
            "cpus"
          ],
          "line": 2094
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupGetValueStr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "514-526",
          "snippet": "int\nvirCgroupGetValueStr(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     char **value)\n{\n    g_autofree char *keypath = NULL;\n\n    if (virCgroupPathOfController(group, controller, key, &keypath) < 0)\n        return -1;\n\n    return virCgroupGetValueRaw(keypath, value);\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetValueStr(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     char **value)\n{\n    g_autofree char *keypath = NULL;\n\n    if (virCgroupPathOfController(group, controller, key, &keypath) < 0)\n        return -1;\n\n    return virCgroupGetValueRaw(keypath, value);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"vircgroupv1.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <sys/stat.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV1GetCpusetCpus(virCgroupPtr group,\n                         char **cpus)\n{\n    return virCgroupGetValueStr(group,\n                                VIR_CGROUP_CONTROLLER_CPUSET,\n                                \"cpuset.cpus\",\n                                cpus);\n}"
  },
  {
    "function_name": "virCgroupV1SetCpusetCpus",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv1.c",
    "lines": "2079-2087",
    "snippet": "static int\nvirCgroupV1SetCpusetCpus(virCgroupPtr group,\n                         const char *cpus)\n{\n    return virCgroupSetValueStr(group,\n                                VIR_CGROUP_CONTROLLER_CPUSET,\n                                \"cpuset.cpus\",\n                                cpus);\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"vircgroupv1.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <sys/stat.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCgroupSetValueStr",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_CPUSET",
            "\"cpuset.cpus\"",
            "cpus"
          ],
          "line": 2083
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupSetValueStr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "499-511",
          "snippet": "int\nvirCgroupSetValueStr(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     const char *value)\n{\n    g_autofree char *keypath = NULL;\n\n    if (virCgroupPathOfController(group, controller, key, &keypath) < 0)\n        return -1;\n\n    return virCgroupSetValueRaw(keypath, value);\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupSetValueStr(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     const char *value)\n{\n    g_autofree char *keypath = NULL;\n\n    if (virCgroupPathOfController(group, controller, key, &keypath) < 0)\n        return -1;\n\n    return virCgroupSetValueRaw(keypath, value);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"vircgroupv1.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <sys/stat.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV1SetCpusetCpus(virCgroupPtr group,\n                         const char *cpus)\n{\n    return virCgroupSetValueStr(group,\n                                VIR_CGROUP_CONTROLLER_CPUSET,\n                                \"cpuset.cpus\",\n                                cpus);\n}"
  },
  {
    "function_name": "virCgroupV1GetCpusetMemoryMigrate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv1.c",
    "lines": "2065-2076",
    "snippet": "static int\nvirCgroupV1GetCpusetMemoryMigrate(virCgroupPtr group,\n                                  bool *migrate)\n{\n    unsigned long long value = 0;\n    int ret = virCgroupGetValueU64(group,\n                                   VIR_CGROUP_CONTROLLER_CPUSET,\n                                   \"cpuset.memory_migrate\",\n                                   &value);\n    *migrate = !!value;\n    return ret;\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"vircgroupv1.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <sys/stat.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCgroupGetValueU64",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_CPUSET",
            "\"cpuset.memory_migrate\"",
            "&value"
          ],
          "line": 2070
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupGetValueU64",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "603-622",
          "snippet": "int\nvirCgroupGetValueU64(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     unsigned long long int *value)\n{\n    g_autofree char *strval = NULL;\n\n    if (virCgroupGetValueStr(group, controller, key, &strval) < 0)\n        return -1;\n\n    if (virStrToLong_ull(strval, NULL, 10, value) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Unable to parse '%s' as an integer\"),\n                       strval);\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetValueU64(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     unsigned long long int *value)\n{\n    g_autofree char *strval = NULL;\n\n    if (virCgroupGetValueStr(group, controller, key, &strval) < 0)\n        return -1;\n\n    if (virStrToLong_ull(strval, NULL, 10, value) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Unable to parse '%s' as an integer\"),\n                       strval);\n        return -1;\n    }\n\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"vircgroupv1.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <sys/stat.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV1GetCpusetMemoryMigrate(virCgroupPtr group,\n                                  bool *migrate)\n{\n    unsigned long long value = 0;\n    int ret = virCgroupGetValueU64(group,\n                                   VIR_CGROUP_CONTROLLER_CPUSET,\n                                   \"cpuset.memory_migrate\",\n                                   &value);\n    *migrate = !!value;\n    return ret;\n}"
  },
  {
    "function_name": "virCgroupV1SetCpusetMemoryMigrate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv1.c",
    "lines": "2054-2062",
    "snippet": "static int\nvirCgroupV1SetCpusetMemoryMigrate(virCgroupPtr group,\n                                  bool migrate)\n{\n    return virCgroupSetValueStr(group,\n                                VIR_CGROUP_CONTROLLER_CPUSET,\n                                \"cpuset.memory_migrate\",\n                                migrate ? \"1\" : \"0\");\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"vircgroupv1.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <sys/stat.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCgroupSetValueStr",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_CPUSET",
            "\"cpuset.memory_migrate\"",
            "migrate ? \"1\" : \"0\""
          ],
          "line": 2058
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupSetValueStr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "499-511",
          "snippet": "int\nvirCgroupSetValueStr(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     const char *value)\n{\n    g_autofree char *keypath = NULL;\n\n    if (virCgroupPathOfController(group, controller, key, &keypath) < 0)\n        return -1;\n\n    return virCgroupSetValueRaw(keypath, value);\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupSetValueStr(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     const char *value)\n{\n    g_autofree char *keypath = NULL;\n\n    if (virCgroupPathOfController(group, controller, key, &keypath) < 0)\n        return -1;\n\n    return virCgroupSetValueRaw(keypath, value);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"vircgroupv1.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <sys/stat.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV1SetCpusetMemoryMigrate(virCgroupPtr group,\n                                  bool migrate)\n{\n    return virCgroupSetValueStr(group,\n                                VIR_CGROUP_CONTROLLER_CPUSET,\n                                \"cpuset.memory_migrate\",\n                                migrate ? \"1\" : \"0\");\n}"
  },
  {
    "function_name": "virCgroupV1GetCpusetMems",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv1.c",
    "lines": "2043-2051",
    "snippet": "static int\nvirCgroupV1GetCpusetMems(virCgroupPtr group,\n                         char **mems)\n{\n    return virCgroupGetValueStr(group,\n                                VIR_CGROUP_CONTROLLER_CPUSET,\n                                \"cpuset.mems\",\n                                mems);\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"vircgroupv1.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <sys/stat.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCgroupGetValueStr",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_CPUSET",
            "\"cpuset.mems\"",
            "mems"
          ],
          "line": 2047
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupGetValueStr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "514-526",
          "snippet": "int\nvirCgroupGetValueStr(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     char **value)\n{\n    g_autofree char *keypath = NULL;\n\n    if (virCgroupPathOfController(group, controller, key, &keypath) < 0)\n        return -1;\n\n    return virCgroupGetValueRaw(keypath, value);\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetValueStr(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     char **value)\n{\n    g_autofree char *keypath = NULL;\n\n    if (virCgroupPathOfController(group, controller, key, &keypath) < 0)\n        return -1;\n\n    return virCgroupGetValueRaw(keypath, value);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"vircgroupv1.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <sys/stat.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV1GetCpusetMems(virCgroupPtr group,\n                         char **mems)\n{\n    return virCgroupGetValueStr(group,\n                                VIR_CGROUP_CONTROLLER_CPUSET,\n                                \"cpuset.mems\",\n                                mems);\n}"
  },
  {
    "function_name": "virCgroupV1SetCpusetMems",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv1.c",
    "lines": "2032-2040",
    "snippet": "static int\nvirCgroupV1SetCpusetMems(virCgroupPtr group,\n                         const char *mems)\n{\n    return virCgroupSetValueStr(group,\n                                VIR_CGROUP_CONTROLLER_CPUSET,\n                                \"cpuset.mems\",\n                                mems);\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"vircgroupv1.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <sys/stat.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCgroupSetValueStr",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_CPUSET",
            "\"cpuset.mems\"",
            "mems"
          ],
          "line": 2036
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupSetValueStr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "499-511",
          "snippet": "int\nvirCgroupSetValueStr(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     const char *value)\n{\n    g_autofree char *keypath = NULL;\n\n    if (virCgroupPathOfController(group, controller, key, &keypath) < 0)\n        return -1;\n\n    return virCgroupSetValueRaw(keypath, value);\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupSetValueStr(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     const char *value)\n{\n    g_autofree char *keypath = NULL;\n\n    if (virCgroupPathOfController(group, controller, key, &keypath) < 0)\n        return -1;\n\n    return virCgroupSetValueRaw(keypath, value);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"vircgroupv1.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <sys/stat.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV1SetCpusetMems(virCgroupPtr group,\n                         const char *mems)\n{\n    return virCgroupSetValueStr(group,\n                                VIR_CGROUP_CONTROLLER_CPUSET,\n                                \"cpuset.mems\",\n                                mems);\n}"
  },
  {
    "function_name": "virCgroupV1GetFreezerState",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv1.c",
    "lines": "2022-2029",
    "snippet": "static int\nvirCgroupV1GetFreezerState(virCgroupPtr group,\n                           char **state)\n{\n    return virCgroupGetValueStr(group,\n                                VIR_CGROUP_CONTROLLER_FREEZER,\n                                \"freezer.state\", state);\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"vircgroupv1.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <sys/stat.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCgroupGetValueStr",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_FREEZER",
            "\"freezer.state\"",
            "state"
          ],
          "line": 2026
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupGetValueStr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "514-526",
          "snippet": "int\nvirCgroupGetValueStr(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     char **value)\n{\n    g_autofree char *keypath = NULL;\n\n    if (virCgroupPathOfController(group, controller, key, &keypath) < 0)\n        return -1;\n\n    return virCgroupGetValueRaw(keypath, value);\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetValueStr(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     char **value)\n{\n    g_autofree char *keypath = NULL;\n\n    if (virCgroupPathOfController(group, controller, key, &keypath) < 0)\n        return -1;\n\n    return virCgroupGetValueRaw(keypath, value);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"vircgroupv1.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <sys/stat.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV1GetFreezerState(virCgroupPtr group,\n                           char **state)\n{\n    return virCgroupGetValueStr(group,\n                                VIR_CGROUP_CONTROLLER_FREEZER,\n                                \"freezer.state\", state);\n}"
  },
  {
    "function_name": "virCgroupV1SetFreezerState",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv1.c",
    "lines": "2012-2019",
    "snippet": "static int\nvirCgroupV1SetFreezerState(virCgroupPtr group,\n                           const char *state)\n{\n    return virCgroupSetValueStr(group,\n                                VIR_CGROUP_CONTROLLER_FREEZER,\n                                \"freezer.state\", state);\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"vircgroupv1.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <sys/stat.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCgroupSetValueStr",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_FREEZER",
            "\"freezer.state\"",
            "state"
          ],
          "line": 2016
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupSetValueStr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "499-511",
          "snippet": "int\nvirCgroupSetValueStr(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     const char *value)\n{\n    g_autofree char *keypath = NULL;\n\n    if (virCgroupPathOfController(group, controller, key, &keypath) < 0)\n        return -1;\n\n    return virCgroupSetValueRaw(keypath, value);\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupSetValueStr(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     const char *value)\n{\n    g_autofree char *keypath = NULL;\n\n    if (virCgroupPathOfController(group, controller, key, &keypath) < 0)\n        return -1;\n\n    return virCgroupSetValueRaw(keypath, value);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"vircgroupv1.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <sys/stat.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV1SetFreezerState(virCgroupPtr group,\n                           const char *state)\n{\n    return virCgroupSetValueStr(group,\n                                VIR_CGROUP_CONTROLLER_FREEZER,\n                                \"freezer.state\", state);\n}"
  },
  {
    "function_name": "virCgroupV1GetCpuacctStat",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv1.c",
    "lines": "1966-2009",
    "snippet": "static int\nvirCgroupV1GetCpuacctStat(virCgroupPtr group,\n                          unsigned long long *user,\n                          unsigned long long *sys)\n{\n    g_autofree char *str = NULL;\n    char *p;\n    static double scale = -1.0;\n\n    if (virCgroupGetValueStr(group, VIR_CGROUP_CONTROLLER_CPUACCT,\n                             \"cpuacct.stat\", &str) < 0)\n        return -1;\n\n    if (!(p = STRSKIP(str, \"user \")) ||\n        virStrToLong_ull(p, &p, 10, user) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Cannot parse user stat '%s'\"),\n                       p);\n        return -1;\n    }\n    if (!(p = STRSKIP(p, \"\\nsystem \")) ||\n        virStrToLong_ull(p, NULL, 10, sys) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Cannot parse sys stat '%s'\"),\n                       p);\n        return -1;\n    }\n    /* times reported are in system ticks (generally 100 Hz), but that\n     * rate can theoretically vary between machines.  Scale things\n     * into approximate nanoseconds.  */\n    if (scale < 0) {\n        long ticks_per_sec = sysconf(_SC_CLK_TCK);\n        if (ticks_per_sec == -1) {\n            virReportSystemError(errno, \"%s\",\n                                 _(\"Cannot determine system clock HZ\"));\n            return -1;\n        }\n        scale = 1000000000.0 / ticks_per_sec;\n    }\n    *user *= scale;\n    *sys *= scale;\n\n    return 0;\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"vircgroupv1.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <sys/stat.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "\"%s\"",
            "_(\"Cannot determine system clock HZ\")"
          ],
          "line": 1999
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Cannot determine system clock HZ\""
          ],
          "line": 2000
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "sysconf",
          "args": [
            "_SC_CLK_TCK"
          ],
          "line": 1997
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Cannot parse sys stat '%s'\")",
            "p"
          ],
          "line": 1988
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStrToLong_ull",
          "args": [
            "p",
            "NULL",
            "10",
            "sys"
          ],
          "line": 1987
        },
        "resolved": true,
        "details": {
          "function_name": "virStrToLong_ullp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "568-586",
          "snippet": "int\nvirStrToLong_ullp(char const *s, char **end_ptr, int base,\n                  unsigned long long *result)\n{\n    unsigned long long val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtoull(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToLong_ullp(char const *s, char **end_ptr, int base,\n                  unsigned long long *result)\n{\n    unsigned long long val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtoull(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "STRSKIP",
          "args": [
            "p",
            "\"\\nsystem \""
          ],
          "line": 1986
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Cannot parse user stat '%s'\")",
            "p"
          ],
          "line": 1981
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STRSKIP",
          "args": [
            "str",
            "\"user \""
          ],
          "line": 1979
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCgroupGetValueStr",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_CPUACCT",
            "\"cpuacct.stat\"",
            "&str"
          ],
          "line": 1975
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupGetValueStr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "514-526",
          "snippet": "int\nvirCgroupGetValueStr(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     char **value)\n{\n    g_autofree char *keypath = NULL;\n\n    if (virCgroupPathOfController(group, controller, key, &keypath) < 0)\n        return -1;\n\n    return virCgroupGetValueRaw(keypath, value);\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetValueStr(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     char **value)\n{\n    g_autofree char *keypath = NULL;\n\n    if (virCgroupPathOfController(group, controller, key, &keypath) < 0)\n        return -1;\n\n    return virCgroupGetValueRaw(keypath, value);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"vircgroupv1.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <sys/stat.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV1GetCpuacctStat(virCgroupPtr group,\n                          unsigned long long *user,\n                          unsigned long long *sys)\n{\n    g_autofree char *str = NULL;\n    char *p;\n    static double scale = -1.0;\n\n    if (virCgroupGetValueStr(group, VIR_CGROUP_CONTROLLER_CPUACCT,\n                             \"cpuacct.stat\", &str) < 0)\n        return -1;\n\n    if (!(p = STRSKIP(str, \"user \")) ||\n        virStrToLong_ull(p, &p, 10, user) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Cannot parse user stat '%s'\"),\n                       p);\n        return -1;\n    }\n    if (!(p = STRSKIP(p, \"\\nsystem \")) ||\n        virStrToLong_ull(p, NULL, 10, sys) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Cannot parse sys stat '%s'\"),\n                       p);\n        return -1;\n    }\n    /* times reported are in system ticks (generally 100 Hz), but that\n     * rate can theoretically vary between machines.  Scale things\n     * into approximate nanoseconds.  */\n    if (scale < 0) {\n        long ticks_per_sec = sysconf(_SC_CLK_TCK);\n        if (ticks_per_sec == -1) {\n            virReportSystemError(errno, \"%s\",\n                                 _(\"Cannot determine system clock HZ\"));\n            return -1;\n        }\n        scale = 1000000000.0 / ticks_per_sec;\n    }\n    *user *= scale;\n    *sys *= scale;\n\n    return 0;\n}"
  },
  {
    "function_name": "virCgroupV1GetCpuacctPercpuUsage",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv1.c",
    "lines": "1957-1963",
    "snippet": "static int\nvirCgroupV1GetCpuacctPercpuUsage(virCgroupPtr group,\n                                 char **usage)\n{\n    return virCgroupGetValueStr(group, VIR_CGROUP_CONTROLLER_CPUACCT,\n                                \"cpuacct.usage_percpu\", usage);\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"vircgroupv1.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <sys/stat.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCgroupGetValueStr",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_CPUACCT",
            "\"cpuacct.usage_percpu\"",
            "usage"
          ],
          "line": 1961
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupGetValueStr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "514-526",
          "snippet": "int\nvirCgroupGetValueStr(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     char **value)\n{\n    g_autofree char *keypath = NULL;\n\n    if (virCgroupPathOfController(group, controller, key, &keypath) < 0)\n        return -1;\n\n    return virCgroupGetValueRaw(keypath, value);\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetValueStr(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     char **value)\n{\n    g_autofree char *keypath = NULL;\n\n    if (virCgroupPathOfController(group, controller, key, &keypath) < 0)\n        return -1;\n\n    return virCgroupGetValueRaw(keypath, value);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"vircgroupv1.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <sys/stat.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV1GetCpuacctPercpuUsage(virCgroupPtr group,\n                                 char **usage)\n{\n    return virCgroupGetValueStr(group, VIR_CGROUP_CONTROLLER_CPUACCT,\n                                \"cpuacct.usage_percpu\", usage);\n}"
  },
  {
    "function_name": "virCgroupV1GetCpuacctUsage",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv1.c",
    "lines": "1947-1954",
    "snippet": "static int\nvirCgroupV1GetCpuacctUsage(virCgroupPtr group,\n                           unsigned long long *usage)\n{\n    return virCgroupGetValueU64(group,\n                                VIR_CGROUP_CONTROLLER_CPUACCT,\n                                \"cpuacct.usage\", usage);\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"vircgroupv1.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <sys/stat.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCgroupGetValueU64",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_CPUACCT",
            "\"cpuacct.usage\"",
            "usage"
          ],
          "line": 1951
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupGetValueU64",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "603-622",
          "snippet": "int\nvirCgroupGetValueU64(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     unsigned long long int *value)\n{\n    g_autofree char *strval = NULL;\n\n    if (virCgroupGetValueStr(group, controller, key, &strval) < 0)\n        return -1;\n\n    if (virStrToLong_ull(strval, NULL, 10, value) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Unable to parse '%s' as an integer\"),\n                       strval);\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetValueU64(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     unsigned long long int *value)\n{\n    g_autofree char *strval = NULL;\n\n    if (virCgroupGetValueStr(group, controller, key, &strval) < 0)\n        return -1;\n\n    if (virStrToLong_ull(strval, NULL, 10, value) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Unable to parse '%s' as an integer\"),\n                       strval);\n        return -1;\n    }\n\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"vircgroupv1.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <sys/stat.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV1GetCpuacctUsage(virCgroupPtr group,\n                           unsigned long long *usage)\n{\n    return virCgroupGetValueU64(group,\n                                VIR_CGROUP_CONTROLLER_CPUACCT,\n                                \"cpuacct.usage\", usage);\n}"
  },
  {
    "function_name": "virCgroupV1SupportsCpuBW",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv1.c",
    "lines": "1929-1944",
    "snippet": "static bool\nvirCgroupV1SupportsCpuBW(virCgroupPtr cgroup)\n{\n    g_autofree char *path = NULL;\n\n    if (!cgroup)\n        return false;\n\n    if (virCgroupV1PathOfController(cgroup, VIR_CGROUP_CONTROLLER_CPU,\n                                    \"cpu.cfs_period_us\", &path) < 0) {\n        virResetLastError();\n        return false;\n    }\n\n    return virFileExists(path);\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"vircgroupv1.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <sys/stat.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virFileExists",
          "args": [
            "path"
          ],
          "line": 1943
        },
        "resolved": true,
        "details": {
          "function_name": "virFileExists",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1873-1877",
          "snippet": "bool\nvirFileExists(const char *path)\n{\n    return access(path, F_OK) == 0;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nbool\nvirFileExists(const char *path)\n{\n    return access(path, F_OK) == 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 1939
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupV1PathOfController",
          "args": [
            "cgroup",
            "VIR_CGROUP_CONTROLLER_CPU",
            "\"cpu.cfs_period_us\"",
            "&path"
          ],
          "line": 1937
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupV1PathOfController",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv1.c",
          "lines": "510-534",
          "snippet": "static int\nvirCgroupV1PathOfController(virCgroupPtr group,\n                            int controller,\n                            const char *key,\n                            char **path)\n{\n    if (group->legacy[controller].mountPoint == NULL) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"v1 controller '%s' is not mounted\"),\n                       virCgroupV1ControllerTypeToString(controller));\n        return -1;\n    }\n\n    if (group->legacy[controller].placement == NULL) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"v1 controller '%s' is not enabled for group\"),\n                       virCgroupV1ControllerTypeToString(controller));\n        return -1;\n    }\n\n    *path = g_strdup_printf(\"%s%s/%s\", group->legacy[controller].mountPoint,\n                            group->legacy[controller].placement, NULLSTR_EMPTY(key));\n\n    return 0;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"vircgroupv1.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"vircgroup.h\"",
            "#include \"vircgrouppriv.h\"",
            "#include \"internal.h\"",
            "# include <sys/mount.h>",
            "# include <sys/stat.h>",
            "# include <mntent.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"vircgroupv1.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <sys/stat.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV1PathOfController(virCgroupPtr group,\n                            int controller,\n                            const char *key,\n                            char **path)\n{\n    if (group->legacy[controller].mountPoint == NULL) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"v1 controller '%s' is not mounted\"),\n                       virCgroupV1ControllerTypeToString(controller));\n        return -1;\n    }\n\n    if (group->legacy[controller].placement == NULL) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"v1 controller '%s' is not enabled for group\"),\n                       virCgroupV1ControllerTypeToString(controller));\n        return -1;\n    }\n\n    *path = g_strdup_printf(\"%s%s/%s\", group->legacy[controller].mountPoint,\n                            group->legacy[controller].placement, NULLSTR_EMPTY(key));\n\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"vircgroupv1.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <sys/stat.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic bool\nvirCgroupV1SupportsCpuBW(virCgroupPtr cgroup)\n{\n    g_autofree char *path = NULL;\n\n    if (!cgroup)\n        return false;\n\n    if (virCgroupV1PathOfController(cgroup, VIR_CGROUP_CONTROLLER_CPU,\n                                    \"cpu.cfs_period_us\", &path) < 0) {\n        virResetLastError();\n        return false;\n    }\n\n    return virFileExists(path);\n}"
  },
  {
    "function_name": "virCgroupV1GetCpuCfsQuota",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv1.c",
    "lines": "1919-1926",
    "snippet": "static int\nvirCgroupV1GetCpuCfsQuota(virCgroupPtr group,\n                          long long *cfs_quota)\n{\n    return virCgroupGetValueI64(group,\n                                VIR_CGROUP_CONTROLLER_CPU,\n                                \"cpu.cfs_quota_us\", cfs_quota);\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"vircgroupv1.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <sys/stat.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCgroupGetValueI64",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_CPU",
            "\"cpu.cfs_quota_us\"",
            "cfs_quota"
          ],
          "line": 1923
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupGetValueI64",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "581-600",
          "snippet": "int\nvirCgroupGetValueI64(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     long long int *value)\n{\n    g_autofree char *strval = NULL;\n\n    if (virCgroupGetValueStr(group, controller, key, &strval) < 0)\n        return -1;\n\n    if (virStrToLong_ll(strval, NULL, 10, value) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Unable to parse '%s' as an integer\"),\n                       strval);\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetValueI64(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     long long int *value)\n{\n    g_autofree char *strval = NULL;\n\n    if (virCgroupGetValueStr(group, controller, key, &strval) < 0)\n        return -1;\n\n    if (virStrToLong_ll(strval, NULL, 10, value) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Unable to parse '%s' as an integer\"),\n                       strval);\n        return -1;\n    }\n\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"vircgroupv1.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <sys/stat.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV1GetCpuCfsQuota(virCgroupPtr group,\n                          long long *cfs_quota)\n{\n    return virCgroupGetValueI64(group,\n                                VIR_CGROUP_CONTROLLER_CPU,\n                                \"cpu.cfs_quota_us\", cfs_quota);\n}"
  },
  {
    "function_name": "virCgroupV1SetCpuCfsQuota",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv1.c",
    "lines": "1899-1916",
    "snippet": "static int\nvirCgroupV1SetCpuCfsQuota(virCgroupPtr group,\n                          long long cfs_quota)\n{\n    /* The cfs_quota should be greater or equal than 1ms */\n    if (cfs_quota >= 0 &&\n        (cfs_quota < 1000 ||\n         cfs_quota > ULLONG_MAX / 1000)) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"cfs_quota '%lld' must be in range (1000, %llu)\"),\n                       cfs_quota, ULLONG_MAX / 1000);\n        return -1;\n    }\n\n    return virCgroupSetValueI64(group,\n                                VIR_CGROUP_CONTROLLER_CPU,\n                                \"cpu.cfs_quota_us\", cfs_quota);\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"vircgroupv1.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <sys/stat.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCgroupSetValueI64",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_CPU",
            "\"cpu.cfs_quota_us\"",
            "cfs_quota"
          ],
          "line": 1913
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupSetValueI64",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "567-578",
          "snippet": "int\nvirCgroupSetValueI64(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     long long int value)\n{\n    g_autofree char *strval = NULL;\n\n    strval = g_strdup_printf(\"%lld\", value);\n\n    return virCgroupSetValueStr(group, controller, key, strval);\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupSetValueI64(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     long long int value)\n{\n    g_autofree char *strval = NULL;\n\n    strval = g_strdup_printf(\"%lld\", value);\n\n    return virCgroupSetValueStr(group, controller, key, strval);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INVALID_ARG",
            "_(\"cfs_quota '%lld' must be in range (1000, %llu)\")",
            "cfs_quota",
            "ULLONG_MAX / 1000"
          ],
          "line": 1907
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"cfs_quota '%lld' must be in range (1000, %llu)\""
          ],
          "line": 1908
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"vircgroupv1.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <sys/stat.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV1SetCpuCfsQuota(virCgroupPtr group,\n                          long long cfs_quota)\n{\n    /* The cfs_quota should be greater or equal than 1ms */\n    if (cfs_quota >= 0 &&\n        (cfs_quota < 1000 ||\n         cfs_quota > ULLONG_MAX / 1000)) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"cfs_quota '%lld' must be in range (1000, %llu)\"),\n                       cfs_quota, ULLONG_MAX / 1000);\n        return -1;\n    }\n\n    return virCgroupSetValueI64(group,\n                                VIR_CGROUP_CONTROLLER_CPU,\n                                \"cpu.cfs_quota_us\", cfs_quota);\n}"
  },
  {
    "function_name": "virCgroupV1GetCpuCfsPeriod",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv1.c",
    "lines": "1889-1896",
    "snippet": "static int\nvirCgroupV1GetCpuCfsPeriod(virCgroupPtr group,\n                           unsigned long long *cfs_period)\n{\n    return virCgroupGetValueU64(group,\n                                VIR_CGROUP_CONTROLLER_CPU,\n                                \"cpu.cfs_period_us\", cfs_period);\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"vircgroupv1.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <sys/stat.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCgroupGetValueU64",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_CPU",
            "\"cpu.cfs_period_us\"",
            "cfs_period"
          ],
          "line": 1893
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupGetValueU64",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "603-622",
          "snippet": "int\nvirCgroupGetValueU64(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     unsigned long long int *value)\n{\n    g_autofree char *strval = NULL;\n\n    if (virCgroupGetValueStr(group, controller, key, &strval) < 0)\n        return -1;\n\n    if (virStrToLong_ull(strval, NULL, 10, value) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Unable to parse '%s' as an integer\"),\n                       strval);\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetValueU64(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     unsigned long long int *value)\n{\n    g_autofree char *strval = NULL;\n\n    if (virCgroupGetValueStr(group, controller, key, &strval) < 0)\n        return -1;\n\n    if (virStrToLong_ull(strval, NULL, 10, value) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Unable to parse '%s' as an integer\"),\n                       strval);\n        return -1;\n    }\n\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"vircgroupv1.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <sys/stat.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV1GetCpuCfsPeriod(virCgroupPtr group,\n                           unsigned long long *cfs_period)\n{\n    return virCgroupGetValueU64(group,\n                                VIR_CGROUP_CONTROLLER_CPU,\n                                \"cpu.cfs_period_us\", cfs_period);\n}"
  },
  {
    "function_name": "virCgroupV1SetCpuCfsPeriod",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv1.c",
    "lines": "1869-1886",
    "snippet": "static int\nvirCgroupV1SetCpuCfsPeriod(virCgroupPtr group,\n                           unsigned long long cfs_period)\n{\n    /* The cfs_period should be greater or equal than 1ms, and less or equal\n     * than 1s.\n     */\n    if (cfs_period < 1000 || cfs_period > 1000000) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"cfs_period '%llu' must be in range (1000, 1000000)\"),\n                       cfs_period);\n        return -1;\n    }\n\n    return virCgroupSetValueU64(group,\n                                VIR_CGROUP_CONTROLLER_CPU,\n                                \"cpu.cfs_period_us\", cfs_period);\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"vircgroupv1.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <sys/stat.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCgroupSetValueU64",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_CPU",
            "\"cpu.cfs_period_us\"",
            "cfs_period"
          ],
          "line": 1883
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupSetValueU64",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "553-564",
          "snippet": "int\nvirCgroupSetValueU64(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     unsigned long long int value)\n{\n    g_autofree char *strval = NULL;\n\n    strval = g_strdup_printf(\"%llu\", value);\n\n    return virCgroupSetValueStr(group, controller, key, strval);\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupSetValueU64(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     unsigned long long int value)\n{\n    g_autofree char *strval = NULL;\n\n    strval = g_strdup_printf(\"%llu\", value);\n\n    return virCgroupSetValueStr(group, controller, key, strval);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INVALID_ARG",
            "_(\"cfs_period '%llu' must be in range (1000, 1000000)\")",
            "cfs_period"
          ],
          "line": 1877
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"cfs_period '%llu' must be in range (1000, 1000000)\""
          ],
          "line": 1878
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"vircgroupv1.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <sys/stat.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV1SetCpuCfsPeriod(virCgroupPtr group,\n                           unsigned long long cfs_period)\n{\n    /* The cfs_period should be greater or equal than 1ms, and less or equal\n     * than 1s.\n     */\n    if (cfs_period < 1000 || cfs_period > 1000000) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"cfs_period '%llu' must be in range (1000, 1000000)\"),\n                       cfs_period);\n        return -1;\n    }\n\n    return virCgroupSetValueU64(group,\n                                VIR_CGROUP_CONTROLLER_CPU,\n                                \"cpu.cfs_period_us\", cfs_period);\n}"
  },
  {
    "function_name": "virCgroupV1GetCpuShares",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv1.c",
    "lines": "1859-1866",
    "snippet": "static int\nvirCgroupV1GetCpuShares(virCgroupPtr group,\n                        unsigned long long *shares)\n{\n    return virCgroupGetValueU64(group,\n                                VIR_CGROUP_CONTROLLER_CPU,\n                                \"cpu.shares\", shares);\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"vircgroupv1.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <sys/stat.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCgroupGetValueU64",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_CPU",
            "\"cpu.shares\"",
            "shares"
          ],
          "line": 1863
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupGetValueU64",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "603-622",
          "snippet": "int\nvirCgroupGetValueU64(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     unsigned long long int *value)\n{\n    g_autofree char *strval = NULL;\n\n    if (virCgroupGetValueStr(group, controller, key, &strval) < 0)\n        return -1;\n\n    if (virStrToLong_ull(strval, NULL, 10, value) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Unable to parse '%s' as an integer\"),\n                       strval);\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetValueU64(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     unsigned long long int *value)\n{\n    g_autofree char *strval = NULL;\n\n    if (virCgroupGetValueStr(group, controller, key, &strval) < 0)\n        return -1;\n\n    if (virStrToLong_ull(strval, NULL, 10, value) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Unable to parse '%s' as an integer\"),\n                       strval);\n        return -1;\n    }\n\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"vircgroupv1.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <sys/stat.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV1GetCpuShares(virCgroupPtr group,\n                        unsigned long long *shares)\n{\n    return virCgroupGetValueU64(group,\n                                VIR_CGROUP_CONTROLLER_CPU,\n                                \"cpu.shares\", shares);\n}"
  },
  {
    "function_name": "virCgroupV1SetCpuShares",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv1.c",
    "lines": "1849-1856",
    "snippet": "static int\nvirCgroupV1SetCpuShares(virCgroupPtr group,\n                        unsigned long long shares)\n{\n    return virCgroupSetValueU64(group,\n                                VIR_CGROUP_CONTROLLER_CPU,\n                                \"cpu.shares\", shares);\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"vircgroupv1.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <sys/stat.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCgroupSetValueU64",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_CPU",
            "\"cpu.shares\"",
            "shares"
          ],
          "line": 1853
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupSetValueU64",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "553-564",
          "snippet": "int\nvirCgroupSetValueU64(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     unsigned long long int value)\n{\n    g_autofree char *strval = NULL;\n\n    strval = g_strdup_printf(\"%llu\", value);\n\n    return virCgroupSetValueStr(group, controller, key, strval);\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupSetValueU64(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     unsigned long long int value)\n{\n    g_autofree char *strval = NULL;\n\n    strval = g_strdup_printf(\"%llu\", value);\n\n    return virCgroupSetValueStr(group, controller, key, strval);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"vircgroupv1.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <sys/stat.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV1SetCpuShares(virCgroupPtr group,\n                        unsigned long long shares)\n{\n    return virCgroupSetValueU64(group,\n                                VIR_CGROUP_CONTROLLER_CPU,\n                                \"cpu.shares\", shares);\n}"
  },
  {
    "function_name": "virCgroupV1DenyAllDevices",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv1.c",
    "lines": "1839-1846",
    "snippet": "static int\nvirCgroupV1DenyAllDevices(virCgroupPtr group)\n{\n    return virCgroupSetValueStr(group,\n                                VIR_CGROUP_CONTROLLER_DEVICES,\n                                \"devices.deny\",\n                                \"a\");\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"vircgroupv1.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <sys/stat.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCgroupSetValueStr",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_DEVICES",
            "\"devices.deny\"",
            "\"a\""
          ],
          "line": 1842
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupSetValueStr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "499-511",
          "snippet": "int\nvirCgroupSetValueStr(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     const char *value)\n{\n    g_autofree char *keypath = NULL;\n\n    if (virCgroupPathOfController(group, controller, key, &keypath) < 0)\n        return -1;\n\n    return virCgroupSetValueRaw(keypath, value);\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupSetValueStr(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     const char *value)\n{\n    g_autofree char *keypath = NULL;\n\n    if (virCgroupPathOfController(group, controller, key, &keypath) < 0)\n        return -1;\n\n    return virCgroupSetValueRaw(keypath, value);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"vircgroupv1.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <sys/stat.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV1DenyAllDevices(virCgroupPtr group)\n{\n    return virCgroupSetValueStr(group,\n                                VIR_CGROUP_CONTROLLER_DEVICES,\n                                \"devices.deny\",\n                                \"a\");\n}"
  },
  {
    "function_name": "virCgroupV1AllowAllDevices",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv1.c",
    "lines": "1825-1836",
    "snippet": "static int\nvirCgroupV1AllowAllDevices(virCgroupPtr group,\n                           int perms)\n{\n    if (virCgroupV1AllowDevice(group, 'b', -1, -1, perms) < 0)\n        return -1;\n\n    if (virCgroupV1AllowDevice(group, 'c', -1, -1, perms) < 0)\n        return -1;\n\n    return 0;\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"vircgroupv1.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <sys/stat.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCgroupV1AllowDevice",
          "args": [
            "group",
            "'c'",
            "-1",
            "-1",
            "perms"
          ],
          "line": 1832
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupV1AllowDevice",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv1.c",
          "lines": "1757-1788",
          "snippet": "static int\nvirCgroupV1AllowDevice(virCgroupPtr group,\n                       char type,\n                       int major,\n                       int minor,\n                       int perms)\n{\n    g_autofree char *devstr = NULL;\n    g_autofree char *majorstr = NULL;\n    g_autofree char *minorstr = NULL;\n\n    if (major < 0)\n        majorstr = g_strdup(\"*\");\n    else\n        majorstr = g_strdup_printf(\"%i\", major);\n\n    if (minor < 0)\n        minorstr = g_strdup(\"*\");\n    else\n        minorstr = g_strdup_printf(\"%i\", minor);\n\n    devstr = g_strdup_printf(\"%c %s:%s %s\", type, majorstr, minorstr,\n                             virCgroupGetDevicePermsString(perms));\n\n    if (virCgroupSetValueStr(group,\n                             VIR_CGROUP_CONTROLLER_DEVICES,\n                             \"devices.allow\",\n                             devstr) < 0)\n        return -1;\n\n    return 0;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"vircgroupv1.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"vircgroup.h\"",
            "#include \"vircgrouppriv.h\"",
            "#include \"internal.h\"",
            "# include <sys/mount.h>",
            "# include <sys/stat.h>",
            "# include <mntent.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"vircgroupv1.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <sys/stat.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV1AllowDevice(virCgroupPtr group,\n                       char type,\n                       int major,\n                       int minor,\n                       int perms)\n{\n    g_autofree char *devstr = NULL;\n    g_autofree char *majorstr = NULL;\n    g_autofree char *minorstr = NULL;\n\n    if (major < 0)\n        majorstr = g_strdup(\"*\");\n    else\n        majorstr = g_strdup_printf(\"%i\", major);\n\n    if (minor < 0)\n        minorstr = g_strdup(\"*\");\n    else\n        minorstr = g_strdup_printf(\"%i\", minor);\n\n    devstr = g_strdup_printf(\"%c %s:%s %s\", type, majorstr, minorstr,\n                             virCgroupGetDevicePermsString(perms));\n\n    if (virCgroupSetValueStr(group,\n                             VIR_CGROUP_CONTROLLER_DEVICES,\n                             \"devices.allow\",\n                             devstr) < 0)\n        return -1;\n\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"vircgroupv1.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <sys/stat.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV1AllowAllDevices(virCgroupPtr group,\n                           int perms)\n{\n    if (virCgroupV1AllowDevice(group, 'b', -1, -1, perms) < 0)\n        return -1;\n\n    if (virCgroupV1AllowDevice(group, 'c', -1, -1, perms) < 0)\n        return -1;\n\n    return 0;\n}"
  },
  {
    "function_name": "virCgroupV1DenyDevice",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv1.c",
    "lines": "1791-1822",
    "snippet": "static int\nvirCgroupV1DenyDevice(virCgroupPtr group,\n                      char type,\n                      int major,\n                      int minor,\n                      int perms)\n{\n    g_autofree char *devstr = NULL;\n    g_autofree char *majorstr = NULL;\n    g_autofree char *minorstr = NULL;\n\n    if (major < 0)\n        majorstr = g_strdup(\"*\");\n    else\n        majorstr = g_strdup_printf(\"%i\", major);\n\n    if (minor < 0)\n        minorstr = g_strdup(\"*\");\n    else\n        minorstr = g_strdup_printf(\"%i\", minor);\n\n    devstr = g_strdup_printf(\"%c %s:%s %s\", type, majorstr, minorstr,\n                             virCgroupGetDevicePermsString(perms));\n\n    if (virCgroupSetValueStr(group,\n                             VIR_CGROUP_CONTROLLER_DEVICES,\n                             \"devices.deny\",\n                             devstr) < 0)\n        return -1;\n\n    return 0;\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"vircgroupv1.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <sys/stat.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCgroupSetValueStr",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_DEVICES",
            "\"devices.deny\"",
            "devstr"
          ],
          "line": 1815
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupSetValueStr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "499-511",
          "snippet": "int\nvirCgroupSetValueStr(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     const char *value)\n{\n    g_autofree char *keypath = NULL;\n\n    if (virCgroupPathOfController(group, controller, key, &keypath) < 0)\n        return -1;\n\n    return virCgroupSetValueRaw(keypath, value);\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupSetValueStr(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     const char *value)\n{\n    g_autofree char *keypath = NULL;\n\n    if (virCgroupPathOfController(group, controller, key, &keypath) < 0)\n        return -1;\n\n    return virCgroupSetValueRaw(keypath, value);\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"%c %s:%s %s\"",
            "type",
            "majorstr",
            "minorstr",
            "virCgroupGetDevicePermsString(perms)"
          ],
          "line": 1812
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupGetDevicePermsString",
          "args": [
            "perms"
          ],
          "line": 1813
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupGetDevicePermsString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "74-102",
          "snippet": "const char *\nvirCgroupGetDevicePermsString(int perms)\n{\n    if (perms & VIR_CGROUP_DEVICE_READ) {\n        if (perms & VIR_CGROUP_DEVICE_WRITE) {\n            if (perms & VIR_CGROUP_DEVICE_MKNOD)\n                return \"rwm\";\n            else\n                return \"rw\";\n        } else {\n            if (perms & VIR_CGROUP_DEVICE_MKNOD)\n                return \"rm\";\n            else\n                return \"r\";\n        }\n    } else {\n        if (perms & VIR_CGROUP_DEVICE_WRITE) {\n            if (perms & VIR_CGROUP_DEVICE_MKNOD)\n                return \"wm\";\n            else\n                return \"w\";\n        } else {\n            if (perms & VIR_CGROUP_DEVICE_MKNOD)\n                return \"m\";\n            else\n                return \"\";\n        }\n    }\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nconst char *\nvirCgroupGetDevicePermsString(int perms)\n{\n    if (perms & VIR_CGROUP_DEVICE_READ) {\n        if (perms & VIR_CGROUP_DEVICE_WRITE) {\n            if (perms & VIR_CGROUP_DEVICE_MKNOD)\n                return \"rwm\";\n            else\n                return \"rw\";\n        } else {\n            if (perms & VIR_CGROUP_DEVICE_MKNOD)\n                return \"rm\";\n            else\n                return \"r\";\n        }\n    } else {\n        if (perms & VIR_CGROUP_DEVICE_WRITE) {\n            if (perms & VIR_CGROUP_DEVICE_MKNOD)\n                return \"wm\";\n            else\n                return \"w\";\n        } else {\n            if (perms & VIR_CGROUP_DEVICE_MKNOD)\n                return \"m\";\n            else\n                return \"\";\n        }\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"vircgroupv1.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <sys/stat.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV1DenyDevice(virCgroupPtr group,\n                      char type,\n                      int major,\n                      int minor,\n                      int perms)\n{\n    g_autofree char *devstr = NULL;\n    g_autofree char *majorstr = NULL;\n    g_autofree char *minorstr = NULL;\n\n    if (major < 0)\n        majorstr = g_strdup(\"*\");\n    else\n        majorstr = g_strdup_printf(\"%i\", major);\n\n    if (minor < 0)\n        minorstr = g_strdup(\"*\");\n    else\n        minorstr = g_strdup_printf(\"%i\", minor);\n\n    devstr = g_strdup_printf(\"%c %s:%s %s\", type, majorstr, minorstr,\n                             virCgroupGetDevicePermsString(perms));\n\n    if (virCgroupSetValueStr(group,\n                             VIR_CGROUP_CONTROLLER_DEVICES,\n                             \"devices.deny\",\n                             devstr) < 0)\n        return -1;\n\n    return 0;\n}"
  },
  {
    "function_name": "virCgroupV1AllowDevice",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv1.c",
    "lines": "1757-1788",
    "snippet": "static int\nvirCgroupV1AllowDevice(virCgroupPtr group,\n                       char type,\n                       int major,\n                       int minor,\n                       int perms)\n{\n    g_autofree char *devstr = NULL;\n    g_autofree char *majorstr = NULL;\n    g_autofree char *minorstr = NULL;\n\n    if (major < 0)\n        majorstr = g_strdup(\"*\");\n    else\n        majorstr = g_strdup_printf(\"%i\", major);\n\n    if (minor < 0)\n        minorstr = g_strdup(\"*\");\n    else\n        minorstr = g_strdup_printf(\"%i\", minor);\n\n    devstr = g_strdup_printf(\"%c %s:%s %s\", type, majorstr, minorstr,\n                             virCgroupGetDevicePermsString(perms));\n\n    if (virCgroupSetValueStr(group,\n                             VIR_CGROUP_CONTROLLER_DEVICES,\n                             \"devices.allow\",\n                             devstr) < 0)\n        return -1;\n\n    return 0;\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"vircgroupv1.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <sys/stat.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCgroupSetValueStr",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_DEVICES",
            "\"devices.allow\"",
            "devstr"
          ],
          "line": 1781
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupSetValueStr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "499-511",
          "snippet": "int\nvirCgroupSetValueStr(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     const char *value)\n{\n    g_autofree char *keypath = NULL;\n\n    if (virCgroupPathOfController(group, controller, key, &keypath) < 0)\n        return -1;\n\n    return virCgroupSetValueRaw(keypath, value);\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupSetValueStr(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     const char *value)\n{\n    g_autofree char *keypath = NULL;\n\n    if (virCgroupPathOfController(group, controller, key, &keypath) < 0)\n        return -1;\n\n    return virCgroupSetValueRaw(keypath, value);\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"%c %s:%s %s\"",
            "type",
            "majorstr",
            "minorstr",
            "virCgroupGetDevicePermsString(perms)"
          ],
          "line": 1778
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupGetDevicePermsString",
          "args": [
            "perms"
          ],
          "line": 1779
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupGetDevicePermsString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "74-102",
          "snippet": "const char *\nvirCgroupGetDevicePermsString(int perms)\n{\n    if (perms & VIR_CGROUP_DEVICE_READ) {\n        if (perms & VIR_CGROUP_DEVICE_WRITE) {\n            if (perms & VIR_CGROUP_DEVICE_MKNOD)\n                return \"rwm\";\n            else\n                return \"rw\";\n        } else {\n            if (perms & VIR_CGROUP_DEVICE_MKNOD)\n                return \"rm\";\n            else\n                return \"r\";\n        }\n    } else {\n        if (perms & VIR_CGROUP_DEVICE_WRITE) {\n            if (perms & VIR_CGROUP_DEVICE_MKNOD)\n                return \"wm\";\n            else\n                return \"w\";\n        } else {\n            if (perms & VIR_CGROUP_DEVICE_MKNOD)\n                return \"m\";\n            else\n                return \"\";\n        }\n    }\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nconst char *\nvirCgroupGetDevicePermsString(int perms)\n{\n    if (perms & VIR_CGROUP_DEVICE_READ) {\n        if (perms & VIR_CGROUP_DEVICE_WRITE) {\n            if (perms & VIR_CGROUP_DEVICE_MKNOD)\n                return \"rwm\";\n            else\n                return \"rw\";\n        } else {\n            if (perms & VIR_CGROUP_DEVICE_MKNOD)\n                return \"rm\";\n            else\n                return \"r\";\n        }\n    } else {\n        if (perms & VIR_CGROUP_DEVICE_WRITE) {\n            if (perms & VIR_CGROUP_DEVICE_MKNOD)\n                return \"wm\";\n            else\n                return \"w\";\n        } else {\n            if (perms & VIR_CGROUP_DEVICE_MKNOD)\n                return \"m\";\n            else\n                return \"\";\n        }\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"vircgroupv1.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <sys/stat.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV1AllowDevice(virCgroupPtr group,\n                       char type,\n                       int major,\n                       int minor,\n                       int perms)\n{\n    g_autofree char *devstr = NULL;\n    g_autofree char *majorstr = NULL;\n    g_autofree char *minorstr = NULL;\n\n    if (major < 0)\n        majorstr = g_strdup(\"*\");\n    else\n        majorstr = g_strdup_printf(\"%i\", major);\n\n    if (minor < 0)\n        minorstr = g_strdup(\"*\");\n    else\n        minorstr = g_strdup_printf(\"%i\", minor);\n\n    devstr = g_strdup_printf(\"%c %s:%s %s\", type, majorstr, minorstr,\n                             virCgroupGetDevicePermsString(perms));\n\n    if (virCgroupSetValueStr(group,\n                             VIR_CGROUP_CONTROLLER_DEVICES,\n                             \"devices.allow\",\n                             devstr) < 0)\n        return -1;\n\n    return 0;\n}"
  },
  {
    "function_name": "virCgroupV1GetMemSwapUsage",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv1.c",
    "lines": "1742-1754",
    "snippet": "static int\nvirCgroupV1GetMemSwapUsage(virCgroupPtr group,\n                           unsigned long long *kb)\n{\n    long long unsigned int usage_in_bytes;\n    int ret;\n    ret = virCgroupGetValueU64(group,\n                               VIR_CGROUP_CONTROLLER_MEMORY,\n                               \"memory.memsw.usage_in_bytes\", &usage_in_bytes);\n    if (ret == 0)\n        *kb = usage_in_bytes >> 10;\n    return ret;\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"vircgroupv1.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <sys/stat.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCgroupGetValueU64",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_MEMORY",
            "\"memory.memsw.usage_in_bytes\"",
            "&usage_in_bytes"
          ],
          "line": 1748
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupGetValueU64",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "603-622",
          "snippet": "int\nvirCgroupGetValueU64(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     unsigned long long int *value)\n{\n    g_autofree char *strval = NULL;\n\n    if (virCgroupGetValueStr(group, controller, key, &strval) < 0)\n        return -1;\n\n    if (virStrToLong_ull(strval, NULL, 10, value) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Unable to parse '%s' as an integer\"),\n                       strval);\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetValueU64(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     unsigned long long int *value)\n{\n    g_autofree char *strval = NULL;\n\n    if (virCgroupGetValueStr(group, controller, key, &strval) < 0)\n        return -1;\n\n    if (virStrToLong_ull(strval, NULL, 10, value) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Unable to parse '%s' as an integer\"),\n                       strval);\n        return -1;\n    }\n\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"vircgroupv1.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <sys/stat.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV1GetMemSwapUsage(virCgroupPtr group,\n                           unsigned long long *kb)\n{\n    long long unsigned int usage_in_bytes;\n    int ret;\n    ret = virCgroupGetValueU64(group,\n                               VIR_CGROUP_CONTROLLER_MEMORY,\n                               \"memory.memsw.usage_in_bytes\", &usage_in_bytes);\n    if (ret == 0)\n        *kb = usage_in_bytes >> 10;\n    return ret;\n}"
  },
  {
    "function_name": "virCgroupV1GetMemSwapHardLimit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv1.c",
    "lines": "1723-1739",
    "snippet": "static int\nvirCgroupV1GetMemSwapHardLimit(virCgroupPtr group,\n                               unsigned long long *kb)\n{\n    long long unsigned int limit_in_bytes;\n\n    if (virCgroupGetValueU64(group,\n                             VIR_CGROUP_CONTROLLER_MEMORY,\n                             \"memory.memsw.limit_in_bytes\", &limit_in_bytes) < 0)\n        return -1;\n\n    *kb = limit_in_bytes >> 10;\n    if (*kb >= virCgroupV1GetMemoryUnlimitedKB())\n        *kb = VIR_DOMAIN_MEMORY_PARAM_UNLIMITED;\n\n    return 0;\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"vircgroupv1.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <sys/stat.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCgroupV1GetMemoryUnlimitedKB",
          "args": [],
          "line": 1735
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupV1GetMemoryUnlimitedKB",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv1.c",
          "lines": "1491-1501",
          "snippet": "static unsigned long long int\nvirCgroupV1GetMemoryUnlimitedKB(void)\n{\n    if (virOnce(&virCgroupV1MemoryOnce, virCgroupV1MemoryOnceInit) < 0)\n        VIR_DEBUG(\"Init failed, will fall back to defaults.\");\n\n    if (virCgroupV1MemoryUnlimitedKB)\n        return virCgroupV1MemoryUnlimitedKB;\n    else\n        return VIR_DOMAIN_MEMORY_PARAM_UNLIMITED;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"vircgroupv1.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"vircgroup.h\"",
            "#include \"vircgrouppriv.h\"",
            "#include \"internal.h\"",
            "# include <sys/mount.h>",
            "# include <sys/stat.h>",
            "# include <mntent.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"vircgroupv1.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <sys/stat.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic unsigned long long int\nvirCgroupV1GetMemoryUnlimitedKB(void)\n{\n    if (virOnce(&virCgroupV1MemoryOnce, virCgroupV1MemoryOnceInit) < 0)\n        VIR_DEBUG(\"Init failed, will fall back to defaults.\");\n\n    if (virCgroupV1MemoryUnlimitedKB)\n        return virCgroupV1MemoryUnlimitedKB;\n    else\n        return VIR_DOMAIN_MEMORY_PARAM_UNLIMITED;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupGetValueU64",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_MEMORY",
            "\"memory.memsw.limit_in_bytes\"",
            "&limit_in_bytes"
          ],
          "line": 1729
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupGetValueU64",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "603-622",
          "snippet": "int\nvirCgroupGetValueU64(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     unsigned long long int *value)\n{\n    g_autofree char *strval = NULL;\n\n    if (virCgroupGetValueStr(group, controller, key, &strval) < 0)\n        return -1;\n\n    if (virStrToLong_ull(strval, NULL, 10, value) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Unable to parse '%s' as an integer\"),\n                       strval);\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetValueU64(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     unsigned long long int *value)\n{\n    g_autofree char *strval = NULL;\n\n    if (virCgroupGetValueStr(group, controller, key, &strval) < 0)\n        return -1;\n\n    if (virStrToLong_ull(strval, NULL, 10, value) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Unable to parse '%s' as an integer\"),\n                       strval);\n        return -1;\n    }\n\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"vircgroupv1.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <sys/stat.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV1GetMemSwapHardLimit(virCgroupPtr group,\n                               unsigned long long *kb)\n{\n    long long unsigned int limit_in_bytes;\n\n    if (virCgroupGetValueU64(group,\n                             VIR_CGROUP_CONTROLLER_MEMORY,\n                             \"memory.memsw.limit_in_bytes\", &limit_in_bytes) < 0)\n        return -1;\n\n    *kb = limit_in_bytes >> 10;\n    if (*kb >= virCgroupV1GetMemoryUnlimitedKB())\n        *kb = VIR_DOMAIN_MEMORY_PARAM_UNLIMITED;\n\n    return 0;\n}"
  },
  {
    "function_name": "virCgroupV1SetMemSwapHardLimit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv1.c",
    "lines": "1697-1720",
    "snippet": "static int\nvirCgroupV1SetMemSwapHardLimit(virCgroupPtr group,\n                               unsigned long long kb)\n{\n    unsigned long long maxkb = VIR_DOMAIN_MEMORY_PARAM_UNLIMITED;\n\n    if (kb > maxkb) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"Memory '%llu' must be less than %llu\"),\n                       kb, maxkb);\n        return -1;\n    }\n\n    if (kb == maxkb)\n        return virCgroupSetValueI64(group,\n                                    VIR_CGROUP_CONTROLLER_MEMORY,\n                                    \"memory.memsw.limit_in_bytes\",\n                                    -1);\n    else\n        return virCgroupSetValueU64(group,\n                                    VIR_CGROUP_CONTROLLER_MEMORY,\n                                    \"memory.memsw.limit_in_bytes\",\n                                    kb << 10);\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"vircgroupv1.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <sys/stat.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCgroupSetValueU64",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_MEMORY",
            "\"memory.memsw.limit_in_bytes\"",
            "kb << 10"
          ],
          "line": 1716
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupSetValueU64",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "553-564",
          "snippet": "int\nvirCgroupSetValueU64(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     unsigned long long int value)\n{\n    g_autofree char *strval = NULL;\n\n    strval = g_strdup_printf(\"%llu\", value);\n\n    return virCgroupSetValueStr(group, controller, key, strval);\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupSetValueU64(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     unsigned long long int value)\n{\n    g_autofree char *strval = NULL;\n\n    strval = g_strdup_printf(\"%llu\", value);\n\n    return virCgroupSetValueStr(group, controller, key, strval);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupSetValueI64",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_MEMORY",
            "\"memory.memsw.limit_in_bytes\"",
            "-1"
          ],
          "line": 1711
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupSetValueI64",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "567-578",
          "snippet": "int\nvirCgroupSetValueI64(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     long long int value)\n{\n    g_autofree char *strval = NULL;\n\n    strval = g_strdup_printf(\"%lld\", value);\n\n    return virCgroupSetValueStr(group, controller, key, strval);\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupSetValueI64(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     long long int value)\n{\n    g_autofree char *strval = NULL;\n\n    strval = g_strdup_printf(\"%lld\", value);\n\n    return virCgroupSetValueStr(group, controller, key, strval);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INVALID_ARG",
            "_(\"Memory '%llu' must be less than %llu\")",
            "kb",
            "maxkb"
          ],
          "line": 1704
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Memory '%llu' must be less than %llu\""
          ],
          "line": 1705
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"vircgroupv1.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <sys/stat.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV1SetMemSwapHardLimit(virCgroupPtr group,\n                               unsigned long long kb)\n{\n    unsigned long long maxkb = VIR_DOMAIN_MEMORY_PARAM_UNLIMITED;\n\n    if (kb > maxkb) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"Memory '%llu' must be less than %llu\"),\n                       kb, maxkb);\n        return -1;\n    }\n\n    if (kb == maxkb)\n        return virCgroupSetValueI64(group,\n                                    VIR_CGROUP_CONTROLLER_MEMORY,\n                                    \"memory.memsw.limit_in_bytes\",\n                                    -1);\n    else\n        return virCgroupSetValueU64(group,\n                                    VIR_CGROUP_CONTROLLER_MEMORY,\n                                    \"memory.memsw.limit_in_bytes\",\n                                    kb << 10);\n}"
  },
  {
    "function_name": "virCgroupV1GetMemorySoftLimit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv1.c",
    "lines": "1678-1694",
    "snippet": "static int\nvirCgroupV1GetMemorySoftLimit(virCgroupPtr group,\n                              unsigned long long *kb)\n{\n    long long unsigned int limit_in_bytes;\n\n    if (virCgroupGetValueU64(group,\n                             VIR_CGROUP_CONTROLLER_MEMORY,\n                             \"memory.soft_limit_in_bytes\", &limit_in_bytes) < 0)\n        return -1;\n\n    *kb = limit_in_bytes >> 10;\n    if (*kb >= virCgroupV1GetMemoryUnlimitedKB())\n        *kb = VIR_DOMAIN_MEMORY_PARAM_UNLIMITED;\n\n    return 0;\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"vircgroupv1.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <sys/stat.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCgroupV1GetMemoryUnlimitedKB",
          "args": [],
          "line": 1690
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupV1GetMemoryUnlimitedKB",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv1.c",
          "lines": "1491-1501",
          "snippet": "static unsigned long long int\nvirCgroupV1GetMemoryUnlimitedKB(void)\n{\n    if (virOnce(&virCgroupV1MemoryOnce, virCgroupV1MemoryOnceInit) < 0)\n        VIR_DEBUG(\"Init failed, will fall back to defaults.\");\n\n    if (virCgroupV1MemoryUnlimitedKB)\n        return virCgroupV1MemoryUnlimitedKB;\n    else\n        return VIR_DOMAIN_MEMORY_PARAM_UNLIMITED;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"vircgroupv1.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"vircgroup.h\"",
            "#include \"vircgrouppriv.h\"",
            "#include \"internal.h\"",
            "# include <sys/mount.h>",
            "# include <sys/stat.h>",
            "# include <mntent.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"vircgroupv1.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <sys/stat.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic unsigned long long int\nvirCgroupV1GetMemoryUnlimitedKB(void)\n{\n    if (virOnce(&virCgroupV1MemoryOnce, virCgroupV1MemoryOnceInit) < 0)\n        VIR_DEBUG(\"Init failed, will fall back to defaults.\");\n\n    if (virCgroupV1MemoryUnlimitedKB)\n        return virCgroupV1MemoryUnlimitedKB;\n    else\n        return VIR_DOMAIN_MEMORY_PARAM_UNLIMITED;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupGetValueU64",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_MEMORY",
            "\"memory.soft_limit_in_bytes\"",
            "&limit_in_bytes"
          ],
          "line": 1684
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupGetValueU64",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "603-622",
          "snippet": "int\nvirCgroupGetValueU64(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     unsigned long long int *value)\n{\n    g_autofree char *strval = NULL;\n\n    if (virCgroupGetValueStr(group, controller, key, &strval) < 0)\n        return -1;\n\n    if (virStrToLong_ull(strval, NULL, 10, value) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Unable to parse '%s' as an integer\"),\n                       strval);\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetValueU64(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     unsigned long long int *value)\n{\n    g_autofree char *strval = NULL;\n\n    if (virCgroupGetValueStr(group, controller, key, &strval) < 0)\n        return -1;\n\n    if (virStrToLong_ull(strval, NULL, 10, value) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Unable to parse '%s' as an integer\"),\n                       strval);\n        return -1;\n    }\n\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"vircgroupv1.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <sys/stat.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV1GetMemorySoftLimit(virCgroupPtr group,\n                              unsigned long long *kb)\n{\n    long long unsigned int limit_in_bytes;\n\n    if (virCgroupGetValueU64(group,\n                             VIR_CGROUP_CONTROLLER_MEMORY,\n                             \"memory.soft_limit_in_bytes\", &limit_in_bytes) < 0)\n        return -1;\n\n    *kb = limit_in_bytes >> 10;\n    if (*kb >= virCgroupV1GetMemoryUnlimitedKB())\n        *kb = VIR_DOMAIN_MEMORY_PARAM_UNLIMITED;\n\n    return 0;\n}"
  },
  {
    "function_name": "virCgroupV1SetMemorySoftLimit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv1.c",
    "lines": "1652-1675",
    "snippet": "static int\nvirCgroupV1SetMemorySoftLimit(virCgroupPtr group,\n                              unsigned long long kb)\n{\n    unsigned long long maxkb = VIR_DOMAIN_MEMORY_PARAM_UNLIMITED;\n\n    if (kb > maxkb) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"Memory '%llu' must be less than %llu\"),\n                       kb, maxkb);\n        return -1;\n    }\n\n    if (kb == maxkb)\n        return virCgroupSetValueI64(group,\n                                    VIR_CGROUP_CONTROLLER_MEMORY,\n                                    \"memory.soft_limit_in_bytes\",\n                                    -1);\n    else\n        return virCgroupSetValueU64(group,\n                                    VIR_CGROUP_CONTROLLER_MEMORY,\n                                    \"memory.soft_limit_in_bytes\",\n                                    kb << 10);\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"vircgroupv1.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <sys/stat.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCgroupSetValueU64",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_MEMORY",
            "\"memory.soft_limit_in_bytes\"",
            "kb << 10"
          ],
          "line": 1671
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupSetValueU64",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "553-564",
          "snippet": "int\nvirCgroupSetValueU64(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     unsigned long long int value)\n{\n    g_autofree char *strval = NULL;\n\n    strval = g_strdup_printf(\"%llu\", value);\n\n    return virCgroupSetValueStr(group, controller, key, strval);\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupSetValueU64(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     unsigned long long int value)\n{\n    g_autofree char *strval = NULL;\n\n    strval = g_strdup_printf(\"%llu\", value);\n\n    return virCgroupSetValueStr(group, controller, key, strval);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupSetValueI64",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_MEMORY",
            "\"memory.soft_limit_in_bytes\"",
            "-1"
          ],
          "line": 1666
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupSetValueI64",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "567-578",
          "snippet": "int\nvirCgroupSetValueI64(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     long long int value)\n{\n    g_autofree char *strval = NULL;\n\n    strval = g_strdup_printf(\"%lld\", value);\n\n    return virCgroupSetValueStr(group, controller, key, strval);\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupSetValueI64(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     long long int value)\n{\n    g_autofree char *strval = NULL;\n\n    strval = g_strdup_printf(\"%lld\", value);\n\n    return virCgroupSetValueStr(group, controller, key, strval);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INVALID_ARG",
            "_(\"Memory '%llu' must be less than %llu\")",
            "kb",
            "maxkb"
          ],
          "line": 1659
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Memory '%llu' must be less than %llu\""
          ],
          "line": 1660
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"vircgroupv1.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <sys/stat.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV1SetMemorySoftLimit(virCgroupPtr group,\n                              unsigned long long kb)\n{\n    unsigned long long maxkb = VIR_DOMAIN_MEMORY_PARAM_UNLIMITED;\n\n    if (kb > maxkb) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"Memory '%llu' must be less than %llu\"),\n                       kb, maxkb);\n        return -1;\n    }\n\n    if (kb == maxkb)\n        return virCgroupSetValueI64(group,\n                                    VIR_CGROUP_CONTROLLER_MEMORY,\n                                    \"memory.soft_limit_in_bytes\",\n                                    -1);\n    else\n        return virCgroupSetValueU64(group,\n                                    VIR_CGROUP_CONTROLLER_MEMORY,\n                                    \"memory.soft_limit_in_bytes\",\n                                    kb << 10);\n}"
  },
  {
    "function_name": "virCgroupV1GetMemoryHardLimit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv1.c",
    "lines": "1633-1649",
    "snippet": "static int\nvirCgroupV1GetMemoryHardLimit(virCgroupPtr group,\n                              unsigned long long *kb)\n{\n    long long unsigned int limit_in_bytes;\n\n    if (virCgroupGetValueU64(group,\n                             VIR_CGROUP_CONTROLLER_MEMORY,\n                             \"memory.limit_in_bytes\", &limit_in_bytes) < 0)\n        return -1;\n\n    *kb = limit_in_bytes >> 10;\n    if (*kb >= virCgroupV1GetMemoryUnlimitedKB())\n        *kb = VIR_DOMAIN_MEMORY_PARAM_UNLIMITED;\n\n    return 0;\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"vircgroupv1.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <sys/stat.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCgroupV1GetMemoryUnlimitedKB",
          "args": [],
          "line": 1645
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupV1GetMemoryUnlimitedKB",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv1.c",
          "lines": "1491-1501",
          "snippet": "static unsigned long long int\nvirCgroupV1GetMemoryUnlimitedKB(void)\n{\n    if (virOnce(&virCgroupV1MemoryOnce, virCgroupV1MemoryOnceInit) < 0)\n        VIR_DEBUG(\"Init failed, will fall back to defaults.\");\n\n    if (virCgroupV1MemoryUnlimitedKB)\n        return virCgroupV1MemoryUnlimitedKB;\n    else\n        return VIR_DOMAIN_MEMORY_PARAM_UNLIMITED;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"vircgroupv1.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"vircgroup.h\"",
            "#include \"vircgrouppriv.h\"",
            "#include \"internal.h\"",
            "# include <sys/mount.h>",
            "# include <sys/stat.h>",
            "# include <mntent.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"vircgroupv1.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <sys/stat.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic unsigned long long int\nvirCgroupV1GetMemoryUnlimitedKB(void)\n{\n    if (virOnce(&virCgroupV1MemoryOnce, virCgroupV1MemoryOnceInit) < 0)\n        VIR_DEBUG(\"Init failed, will fall back to defaults.\");\n\n    if (virCgroupV1MemoryUnlimitedKB)\n        return virCgroupV1MemoryUnlimitedKB;\n    else\n        return VIR_DOMAIN_MEMORY_PARAM_UNLIMITED;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupGetValueU64",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_MEMORY",
            "\"memory.limit_in_bytes\"",
            "&limit_in_bytes"
          ],
          "line": 1639
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupGetValueU64",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "603-622",
          "snippet": "int\nvirCgroupGetValueU64(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     unsigned long long int *value)\n{\n    g_autofree char *strval = NULL;\n\n    if (virCgroupGetValueStr(group, controller, key, &strval) < 0)\n        return -1;\n\n    if (virStrToLong_ull(strval, NULL, 10, value) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Unable to parse '%s' as an integer\"),\n                       strval);\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetValueU64(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     unsigned long long int *value)\n{\n    g_autofree char *strval = NULL;\n\n    if (virCgroupGetValueStr(group, controller, key, &strval) < 0)\n        return -1;\n\n    if (virStrToLong_ull(strval, NULL, 10, value) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Unable to parse '%s' as an integer\"),\n                       strval);\n        return -1;\n    }\n\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"vircgroupv1.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <sys/stat.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV1GetMemoryHardLimit(virCgroupPtr group,\n                              unsigned long long *kb)\n{\n    long long unsigned int limit_in_bytes;\n\n    if (virCgroupGetValueU64(group,\n                             VIR_CGROUP_CONTROLLER_MEMORY,\n                             \"memory.limit_in_bytes\", &limit_in_bytes) < 0)\n        return -1;\n\n    *kb = limit_in_bytes >> 10;\n    if (*kb >= virCgroupV1GetMemoryUnlimitedKB())\n        *kb = VIR_DOMAIN_MEMORY_PARAM_UNLIMITED;\n\n    return 0;\n}"
  },
  {
    "function_name": "virCgroupV1SetMemoryHardLimit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv1.c",
    "lines": "1625-1630",
    "snippet": "static int\nvirCgroupV1SetMemoryHardLimit(virCgroupPtr group,\n                              unsigned long long kb)\n{\n    return virCgroupV1SetMemory(group, kb);\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"vircgroupv1.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <sys/stat.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCgroupV1SetMemory",
          "args": [
            "group",
            "kb"
          ],
          "line": 1629
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupV1SetMemorySoftLimit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv1.c",
          "lines": "1652-1675",
          "snippet": "static int\nvirCgroupV1SetMemorySoftLimit(virCgroupPtr group,\n                              unsigned long long kb)\n{\n    unsigned long long maxkb = VIR_DOMAIN_MEMORY_PARAM_UNLIMITED;\n\n    if (kb > maxkb) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"Memory '%llu' must be less than %llu\"),\n                       kb, maxkb);\n        return -1;\n    }\n\n    if (kb == maxkb)\n        return virCgroupSetValueI64(group,\n                                    VIR_CGROUP_CONTROLLER_MEMORY,\n                                    \"memory.soft_limit_in_bytes\",\n                                    -1);\n    else\n        return virCgroupSetValueU64(group,\n                                    VIR_CGROUP_CONTROLLER_MEMORY,\n                                    \"memory.soft_limit_in_bytes\",\n                                    kb << 10);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"vircgroupv1.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"vircgroup.h\"",
            "#include \"vircgrouppriv.h\"",
            "#include \"internal.h\"",
            "# include <sys/mount.h>",
            "# include <sys/stat.h>",
            "# include <mntent.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"vircgroupv1.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <sys/stat.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV1SetMemorySoftLimit(virCgroupPtr group,\n                              unsigned long long kb)\n{\n    unsigned long long maxkb = VIR_DOMAIN_MEMORY_PARAM_UNLIMITED;\n\n    if (kb > maxkb) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"Memory '%llu' must be less than %llu\"),\n                       kb, maxkb);\n        return -1;\n    }\n\n    if (kb == maxkb)\n        return virCgroupSetValueI64(group,\n                                    VIR_CGROUP_CONTROLLER_MEMORY,\n                                    \"memory.soft_limit_in_bytes\",\n                                    -1);\n    else\n        return virCgroupSetValueU64(group,\n                                    VIR_CGROUP_CONTROLLER_MEMORY,\n                                    \"memory.soft_limit_in_bytes\",\n                                    kb << 10);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"vircgroupv1.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <sys/stat.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV1SetMemoryHardLimit(virCgroupPtr group,\n                              unsigned long long kb)\n{\n    return virCgroupV1SetMemory(group, kb);\n}"
  },
  {
    "function_name": "virCgroupV1GetMemoryUsage",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv1.c",
    "lines": "1610-1622",
    "snippet": "static int\nvirCgroupV1GetMemoryUsage(virCgroupPtr group,\n                          unsigned long *kb)\n{\n    long long unsigned int usage_in_bytes;\n    int ret;\n    ret = virCgroupGetValueU64(group,\n                               VIR_CGROUP_CONTROLLER_MEMORY,\n                               \"memory.usage_in_bytes\", &usage_in_bytes);\n    if (ret == 0)\n        *kb = (unsigned long) usage_in_bytes >> 10;\n    return ret;\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"vircgroupv1.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <sys/stat.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCgroupGetValueU64",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_MEMORY",
            "\"memory.usage_in_bytes\"",
            "&usage_in_bytes"
          ],
          "line": 1616
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupGetValueU64",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "603-622",
          "snippet": "int\nvirCgroupGetValueU64(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     unsigned long long int *value)\n{\n    g_autofree char *strval = NULL;\n\n    if (virCgroupGetValueStr(group, controller, key, &strval) < 0)\n        return -1;\n\n    if (virStrToLong_ull(strval, NULL, 10, value) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Unable to parse '%s' as an integer\"),\n                       strval);\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetValueU64(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     unsigned long long int *value)\n{\n    g_autofree char *strval = NULL;\n\n    if (virCgroupGetValueStr(group, controller, key, &strval) < 0)\n        return -1;\n\n    if (virStrToLong_ull(strval, NULL, 10, value) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Unable to parse '%s' as an integer\"),\n                       strval);\n        return -1;\n    }\n\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"vircgroupv1.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <sys/stat.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV1GetMemoryUsage(virCgroupPtr group,\n                          unsigned long *kb)\n{\n    long long unsigned int usage_in_bytes;\n    int ret;\n    ret = virCgroupGetValueU64(group,\n                               VIR_CGROUP_CONTROLLER_MEMORY,\n                               \"memory.usage_in_bytes\", &usage_in_bytes);\n    if (ret == 0)\n        *kb = (unsigned long) usage_in_bytes >> 10;\n    return ret;\n}"
  },
  {
    "function_name": "virCgroupV1GetMemoryStat",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv1.c",
    "lines": "1530-1607",
    "snippet": "static int\nvirCgroupV1GetMemoryStat(virCgroupPtr group,\n                         unsigned long long *cache,\n                         unsigned long long *activeAnon,\n                         unsigned long long *inactiveAnon,\n                         unsigned long long *activeFile,\n                         unsigned long long *inactiveFile,\n                         unsigned long long *unevictable)\n{\n    int ret = -1;\n    char *stat = NULL;\n    char *line = NULL;\n    unsigned long long cacheVal = 0;\n    unsigned long long activeAnonVal = 0;\n    unsigned long long inactiveAnonVal = 0;\n    unsigned long long activeFileVal = 0;\n    unsigned long long inactiveFileVal = 0;\n    unsigned long long unevictableVal = 0;\n\n    if (virCgroupGetValueStr(group,\n                             VIR_CGROUP_CONTROLLER_MEMORY,\n                             \"memory.stat\",\n                             &stat) < 0) {\n        return -1;\n    }\n\n    line = stat;\n\n    while (*line) {\n        char *newLine = strchr(line, '\\n');\n        char *valueStr = strchr(line, ' ');\n        unsigned long long value;\n\n        if (newLine)\n            *newLine = '\\0';\n\n        if (!valueStr) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"Cannot parse 'memory.stat' cgroup file.\"));\n            goto cleanup;\n        }\n        *valueStr = '\\0';\n\n        if (virStrToLong_ull(valueStr + 1, NULL, 10, &value) < 0)\n            goto cleanup;\n\n        if (STREQ(line, \"cache\"))\n            cacheVal = value >> 10;\n        else if (STREQ(line, \"active_anon\"))\n            activeAnonVal = value >> 10;\n        else if (STREQ(line, \"inactive_anon\"))\n            inactiveAnonVal = value >> 10;\n        else if (STREQ(line, \"active_file\"))\n            activeFileVal = value >> 10;\n        else if (STREQ(line, \"inactive_file\"))\n            inactiveFileVal = value >> 10;\n        else if (STREQ(line, \"unevictable\"))\n            unevictableVal = value >> 10;\n\n        if (newLine)\n            line = newLine + 1;\n        else\n            break;\n    }\n\n    *cache = cacheVal;\n    *activeAnon = activeAnonVal;\n    *inactiveAnon = inactiveAnonVal;\n    *activeFile = activeFileVal;\n    *inactiveFile = inactiveFileVal;\n    *unevictable = unevictableVal;\n\n    ret = 0;\n\n cleanup:\n    VIR_FREE(stat);\n    return ret;\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"vircgroupv1.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <sys/stat.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "stat"
          ],
          "line": 1605
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "line",
            "\"unevictable\""
          ],
          "line": 1586
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "line",
            "\"inactive_file\""
          ],
          "line": 1584
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "line",
            "\"active_file\""
          ],
          "line": 1582
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "line",
            "\"inactive_anon\""
          ],
          "line": 1580
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "line",
            "\"active_anon\""
          ],
          "line": 1578
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "line",
            "\"cache\""
          ],
          "line": 1576
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStrToLong_ull",
          "args": [
            "valueStr + 1",
            "NULL",
            "10",
            "&value"
          ],
          "line": 1573
        },
        "resolved": true,
        "details": {
          "function_name": "virStrToLong_ullp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "568-586",
          "snippet": "int\nvirStrToLong_ullp(char const *s, char **end_ptr, int base,\n                  unsigned long long *result)\n{\n    unsigned long long val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtoull(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToLong_ullp(char const *s, char **end_ptr, int base,\n                  unsigned long long *result)\n{\n    unsigned long long val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtoull(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"Cannot parse 'memory.stat' cgroup file.\")"
          ],
          "line": 1567
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Cannot parse 'memory.stat' cgroup file.\""
          ],
          "line": 1568
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "line",
            "' '"
          ],
          "line": 1560
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "line",
            "'\\n'"
          ],
          "line": 1559
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCgroupGetValueStr",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_MEMORY",
            "\"memory.stat\"",
            "&stat"
          ],
          "line": 1549
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupGetValueStr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "514-526",
          "snippet": "int\nvirCgroupGetValueStr(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     char **value)\n{\n    g_autofree char *keypath = NULL;\n\n    if (virCgroupPathOfController(group, controller, key, &keypath) < 0)\n        return -1;\n\n    return virCgroupGetValueRaw(keypath, value);\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetValueStr(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     char **value)\n{\n    g_autofree char *keypath = NULL;\n\n    if (virCgroupPathOfController(group, controller, key, &keypath) < 0)\n        return -1;\n\n    return virCgroupGetValueRaw(keypath, value);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"vircgroupv1.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <sys/stat.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV1GetMemoryStat(virCgroupPtr group,\n                         unsigned long long *cache,\n                         unsigned long long *activeAnon,\n                         unsigned long long *inactiveAnon,\n                         unsigned long long *activeFile,\n                         unsigned long long *inactiveFile,\n                         unsigned long long *unevictable)\n{\n    int ret = -1;\n    char *stat = NULL;\n    char *line = NULL;\n    unsigned long long cacheVal = 0;\n    unsigned long long activeAnonVal = 0;\n    unsigned long long inactiveAnonVal = 0;\n    unsigned long long activeFileVal = 0;\n    unsigned long long inactiveFileVal = 0;\n    unsigned long long unevictableVal = 0;\n\n    if (virCgroupGetValueStr(group,\n                             VIR_CGROUP_CONTROLLER_MEMORY,\n                             \"memory.stat\",\n                             &stat) < 0) {\n        return -1;\n    }\n\n    line = stat;\n\n    while (*line) {\n        char *newLine = strchr(line, '\\n');\n        char *valueStr = strchr(line, ' ');\n        unsigned long long value;\n\n        if (newLine)\n            *newLine = '\\0';\n\n        if (!valueStr) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"Cannot parse 'memory.stat' cgroup file.\"));\n            goto cleanup;\n        }\n        *valueStr = '\\0';\n\n        if (virStrToLong_ull(valueStr + 1, NULL, 10, &value) < 0)\n            goto cleanup;\n\n        if (STREQ(line, \"cache\"))\n            cacheVal = value >> 10;\n        else if (STREQ(line, \"active_anon\"))\n            activeAnonVal = value >> 10;\n        else if (STREQ(line, \"inactive_anon\"))\n            inactiveAnonVal = value >> 10;\n        else if (STREQ(line, \"active_file\"))\n            activeFileVal = value >> 10;\n        else if (STREQ(line, \"inactive_file\"))\n            inactiveFileVal = value >> 10;\n        else if (STREQ(line, \"unevictable\"))\n            unevictableVal = value >> 10;\n\n        if (newLine)\n            line = newLine + 1;\n        else\n            break;\n    }\n\n    *cache = cacheVal;\n    *activeAnon = activeAnonVal;\n    *inactiveAnon = inactiveAnonVal;\n    *activeFile = activeFileVal;\n    *inactiveFile = inactiveFileVal;\n    *unevictable = unevictableVal;\n\n    ret = 0;\n\n cleanup:\n    VIR_FREE(stat);\n    return ret;\n}"
  },
  {
    "function_name": "virCgroupV1SetMemory",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv1.c",
    "lines": "1504-1527",
    "snippet": "static int\nvirCgroupV1SetMemory(virCgroupPtr group,\n                     unsigned long long kb)\n{\n    unsigned long long maxkb = VIR_DOMAIN_MEMORY_PARAM_UNLIMITED;\n\n    if (kb > maxkb) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"Memory '%llu' must be less than %llu\"),\n                       kb, maxkb);\n        return -1;\n    }\n\n    if (kb == maxkb)\n        return virCgroupSetValueI64(group,\n                                    VIR_CGROUP_CONTROLLER_MEMORY,\n                                    \"memory.limit_in_bytes\",\n                                    -1);\n    else\n        return virCgroupSetValueU64(group,\n                                    VIR_CGROUP_CONTROLLER_MEMORY,\n                                    \"memory.limit_in_bytes\",\n                                    kb << 10);\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"vircgroupv1.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <sys/stat.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCgroupSetValueU64",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_MEMORY",
            "\"memory.limit_in_bytes\"",
            "kb << 10"
          ],
          "line": 1523
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupSetValueU64",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "553-564",
          "snippet": "int\nvirCgroupSetValueU64(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     unsigned long long int value)\n{\n    g_autofree char *strval = NULL;\n\n    strval = g_strdup_printf(\"%llu\", value);\n\n    return virCgroupSetValueStr(group, controller, key, strval);\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupSetValueU64(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     unsigned long long int value)\n{\n    g_autofree char *strval = NULL;\n\n    strval = g_strdup_printf(\"%llu\", value);\n\n    return virCgroupSetValueStr(group, controller, key, strval);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupSetValueI64",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_MEMORY",
            "\"memory.limit_in_bytes\"",
            "-1"
          ],
          "line": 1518
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupSetValueI64",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "567-578",
          "snippet": "int\nvirCgroupSetValueI64(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     long long int value)\n{\n    g_autofree char *strval = NULL;\n\n    strval = g_strdup_printf(\"%lld\", value);\n\n    return virCgroupSetValueStr(group, controller, key, strval);\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupSetValueI64(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     long long int value)\n{\n    g_autofree char *strval = NULL;\n\n    strval = g_strdup_printf(\"%lld\", value);\n\n    return virCgroupSetValueStr(group, controller, key, strval);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INVALID_ARG",
            "_(\"Memory '%llu' must be less than %llu\")",
            "kb",
            "maxkb"
          ],
          "line": 1511
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Memory '%llu' must be less than %llu\""
          ],
          "line": 1512
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"vircgroupv1.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <sys/stat.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV1SetMemory(virCgroupPtr group,\n                     unsigned long long kb)\n{\n    unsigned long long maxkb = VIR_DOMAIN_MEMORY_PARAM_UNLIMITED;\n\n    if (kb > maxkb) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"Memory '%llu' must be less than %llu\"),\n                       kb, maxkb);\n        return -1;\n    }\n\n    if (kb == maxkb)\n        return virCgroupSetValueI64(group,\n                                    VIR_CGROUP_CONTROLLER_MEMORY,\n                                    \"memory.limit_in_bytes\",\n                                    -1);\n    else\n        return virCgroupSetValueU64(group,\n                                    VIR_CGROUP_CONTROLLER_MEMORY,\n                                    \"memory.limit_in_bytes\",\n                                    kb << 10);\n}"
  },
  {
    "function_name": "virCgroupV1GetMemoryUnlimitedKB",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv1.c",
    "lines": "1491-1501",
    "snippet": "static unsigned long long int\nvirCgroupV1GetMemoryUnlimitedKB(void)\n{\n    if (virOnce(&virCgroupV1MemoryOnce, virCgroupV1MemoryOnceInit) < 0)\n        VIR_DEBUG(\"Init failed, will fall back to defaults.\");\n\n    if (virCgroupV1MemoryUnlimitedKB)\n        return virCgroupV1MemoryUnlimitedKB;\n    else\n        return VIR_DOMAIN_MEMORY_PARAM_UNLIMITED;\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"vircgroupv1.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <sys/stat.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Init failed, will fall back to defaults.\""
          ],
          "line": 1495
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virOnce",
          "args": [
            "&virCgroupV1MemoryOnce",
            "virCgroupV1MemoryOnceInit"
          ],
          "line": 1494
        },
        "resolved": true,
        "details": {
          "function_name": "virOnce",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virthread.c",
          "lines": "40-43",
          "snippet": "int virOnce(virOnceControlPtr once, virOnceFunc init)\n{\n    return pthread_once(&once->once, init);\n}",
          "includes": [
            "#include \"virthreadjob.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/syscall.h>",
            "#include <inttypes.h>",
            "#include <unistd.h>",
            "# include <pthread_np.h>",
            "#include \"virthread.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthreadjob.h\"\n#include \"viralloc.h\"\n# include <sys/syscall.h>\n#include <inttypes.h>\n#include <unistd.h>\n# include <pthread_np.h>\n#include \"virthread.h\"\n#include <config.h>\n\nint virOnce(virOnceControlPtr once, virOnceFunc init)\n{\n    return pthread_once(&once->once, init);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"vircgroupv1.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <sys/stat.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic unsigned long long int\nvirCgroupV1GetMemoryUnlimitedKB(void)\n{\n    if (virOnce(&virCgroupV1MemoryOnce, virCgroupV1MemoryOnceInit) < 0)\n        VIR_DEBUG(\"Init failed, will fall back to defaults.\");\n\n    if (virCgroupV1MemoryUnlimitedKB)\n        return virCgroupV1MemoryUnlimitedKB;\n    else\n        return VIR_DOMAIN_MEMORY_PARAM_UNLIMITED;\n}"
  },
  {
    "function_name": "virCgroupV1MemoryOnceInit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv1.c",
    "lines": "1470-1489",
    "snippet": "static void\nvirCgroupV1MemoryOnceInit(void)\n{\n    virCgroupPtr group;\n    unsigned long long int mem_unlimited = 0ULL;\n\n    if (virCgroupNew(-1, \"/\", NULL, -1, &group) < 0)\n        goto cleanup;\n\n    if (!virCgroupV1HasController(group, VIR_CGROUP_CONTROLLER_MEMORY))\n        goto cleanup;\n\n    ignore_value(virCgroupGetValueU64(group,\n                                      VIR_CGROUP_CONTROLLER_MEMORY,\n                                      \"memory.limit_in_bytes\",\n                                      &mem_unlimited));\n cleanup:\n    virCgroupFree(&group);\n    virCgroupV1MemoryUnlimitedKB = mem_unlimited >> 10;\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"vircgroupv1.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <sys/stat.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCgroupFree",
          "args": [
            "&group"
          ],
          "line": 1487
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "3544-3563",
          "snippet": "void\nvirCgroupFree(virCgroupPtr *group)\n{\n    size_t i;\n\n    if (*group == NULL)\n        return;\n\n    for (i = 0; i < VIR_CGROUP_CONTROLLER_LAST; i++) {\n        VIR_FREE((*group)->legacy[i].mountPoint);\n        VIR_FREE((*group)->legacy[i].linkPoint);\n        VIR_FREE((*group)->legacy[i].placement);\n    }\n\n    VIR_FREE((*group)->unified.mountPoint);\n    VIR_FREE((*group)->unified.placement);\n\n    VIR_FREE((*group)->path);\n    VIR_FREE(*group);\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nvoid\nvirCgroupFree(virCgroupPtr *group)\n{\n    size_t i;\n\n    if (*group == NULL)\n        return;\n\n    for (i = 0; i < VIR_CGROUP_CONTROLLER_LAST; i++) {\n        VIR_FREE((*group)->legacy[i].mountPoint);\n        VIR_FREE((*group)->legacy[i].linkPoint);\n        VIR_FREE((*group)->legacy[i].placement);\n    }\n\n    VIR_FREE((*group)->unified.mountPoint);\n    VIR_FREE((*group)->unified.placement);\n\n    VIR_FREE((*group)->path);\n    VIR_FREE(*group);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ignore_value",
          "args": [
            "virCgroupGetValueU64(group,\n                                      VIR_CGROUP_CONTROLLER_MEMORY,\n                                      \"memory.limit_in_bytes\",\n                                      &mem_unlimited)"
          ],
          "line": 1482
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCgroupGetValueU64",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_MEMORY",
            "\"memory.limit_in_bytes\"",
            "&mem_unlimited"
          ],
          "line": 1482
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupGetValueU64",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "603-622",
          "snippet": "int\nvirCgroupGetValueU64(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     unsigned long long int *value)\n{\n    g_autofree char *strval = NULL;\n\n    if (virCgroupGetValueStr(group, controller, key, &strval) < 0)\n        return -1;\n\n    if (virStrToLong_ull(strval, NULL, 10, value) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Unable to parse '%s' as an integer\"),\n                       strval);\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetValueU64(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     unsigned long long int *value)\n{\n    g_autofree char *strval = NULL;\n\n    if (virCgroupGetValueStr(group, controller, key, &strval) < 0)\n        return -1;\n\n    if (virStrToLong_ull(strval, NULL, 10, value) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Unable to parse '%s' as an integer\"),\n                       strval);\n        return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupV1HasController",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_MEMORY"
          ],
          "line": 1479
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupV1HasController",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv1.c",
          "lines": "481-486",
          "snippet": "static bool\nvirCgroupV1HasController(virCgroupPtr group,\n                         int controller)\n{\n    return group->legacy[controller].mountPoint != NULL;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"vircgroupv1.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"vircgroup.h\"",
            "#include \"vircgrouppriv.h\"",
            "#include \"internal.h\"",
            "# include <sys/mount.h>",
            "# include <sys/stat.h>",
            "# include <mntent.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"vircgroupv1.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <sys/stat.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic bool\nvirCgroupV1HasController(virCgroupPtr group,\n                         int controller)\n{\n    return group->legacy[controller].mountPoint != NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupNew",
          "args": [
            "-1",
            "\"/\"",
            "NULL",
            "-1",
            "&group"
          ],
          "line": 1476
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupNewThread",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "2825-2835",
          "snippet": "int\nvirCgroupNewThread(virCgroupPtr domain G_GNUC_UNUSED,\n                   virCgroupThreadName nameval G_GNUC_UNUSED,\n                   int id G_GNUC_UNUSED,\n                   bool create G_GNUC_UNUSED,\n                   virCgroupPtr *group G_GNUC_UNUSED)\n{\n    virReportSystemError(ENXIO, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupNewThread(virCgroupPtr domain G_GNUC_UNUSED,\n                   virCgroupThreadName nameval G_GNUC_UNUSED,\n                   int id G_GNUC_UNUSED,\n                   bool create G_GNUC_UNUSED,\n                   virCgroupPtr *group G_GNUC_UNUSED)\n{\n    virReportSystemError(ENXIO, \"%s\",\n                         _(\"Control groups not supported on this platform\"));\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"vircgroupv1.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <sys/stat.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic void\nvirCgroupV1MemoryOnceInit(void)\n{\n    virCgroupPtr group;\n    unsigned long long int mem_unlimited = 0ULL;\n\n    if (virCgroupNew(-1, \"/\", NULL, -1, &group) < 0)\n        goto cleanup;\n\n    if (!virCgroupV1HasController(group, VIR_CGROUP_CONTROLLER_MEMORY))\n        goto cleanup;\n\n    ignore_value(virCgroupGetValueU64(group,\n                                      VIR_CGROUP_CONTROLLER_MEMORY,\n                                      \"memory.limit_in_bytes\",\n                                      &mem_unlimited));\n cleanup:\n    virCgroupFree(&group);\n    virCgroupV1MemoryUnlimitedKB = mem_unlimited >> 10;\n}"
  },
  {
    "function_name": "virCgroupV1GetBlkioDeviceWriteBps",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv1.c",
    "lines": "1428-1456",
    "snippet": "static int\nvirCgroupV1GetBlkioDeviceWriteBps(virCgroupPtr group,\n                                  const char *path,\n                                  unsigned long long *wbps)\n{\n    g_autofree char *str = NULL;\n    g_autofree char *value = NULL;\n\n    if (virCgroupGetValueStr(group,\n                             VIR_CGROUP_CONTROLLER_BLKIO,\n                             \"blkio.throttle.write_bps_device\",\n                             &value) < 0) {\n        return -1;\n    }\n\n    if (virCgroupGetValueForBlkDev(value, path, &str) < 0)\n        return -1;\n\n    if (!str) {\n        *wbps = 0;\n    } else if (virStrToLong_ull(str, NULL, 10, wbps) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Unable to parse '%s' as an integer\"),\n                       str);\n        return -1;\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"vircgroupv1.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <sys/stat.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Unable to parse '%s' as an integer\")",
            "str"
          ],
          "line": 1449
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to parse '%s' as an integer\""
          ],
          "line": 1450
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStrToLong_ull",
          "args": [
            "str",
            "NULL",
            "10",
            "wbps"
          ],
          "line": 1448
        },
        "resolved": true,
        "details": {
          "function_name": "virStrToLong_ullp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "568-586",
          "snippet": "int\nvirStrToLong_ullp(char const *s, char **end_ptr, int base,\n                  unsigned long long *result)\n{\n    unsigned long long val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtoull(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToLong_ullp(char const *s, char **end_ptr, int base,\n                  unsigned long long *result)\n{\n    unsigned long long val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtoull(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupGetValueForBlkDev",
          "args": [
            "value",
            "path",
            "&str"
          ],
          "line": 1443
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupGetValueForBlkDev",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "529-550",
          "snippet": "int\nvirCgroupGetValueForBlkDev(const char *str,\n                           const char *path,\n                           char **value)\n{\n    g_autofree char *prefix = NULL;\n    char **lines = NULL;\n    int ret = -1;\n\n    if (!(prefix = virCgroupGetBlockDevString(path)))\n        goto error;\n\n    if (!(lines = virStringSplit(str, \"\\n\", -1)))\n        goto error;\n\n    *value = g_strdup(virStringListGetFirstWithPrefix(lines, prefix));\n\n    ret = 0;\n error:\n    virStringListFree(lines);\n    return ret;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetValueForBlkDev(const char *str,\n                           const char *path,\n                           char **value)\n{\n    g_autofree char *prefix = NULL;\n    char **lines = NULL;\n    int ret = -1;\n\n    if (!(prefix = virCgroupGetBlockDevString(path)))\n        goto error;\n\n    if (!(lines = virStringSplit(str, \"\\n\", -1)))\n        goto error;\n\n    *value = g_strdup(virStringListGetFirstWithPrefix(lines, prefix));\n\n    ret = 0;\n error:\n    virStringListFree(lines);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupGetValueStr",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_BLKIO",
            "\"blkio.throttle.write_bps_device\"",
            "&value"
          ],
          "line": 1436
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupGetValueStr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "514-526",
          "snippet": "int\nvirCgroupGetValueStr(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     char **value)\n{\n    g_autofree char *keypath = NULL;\n\n    if (virCgroupPathOfController(group, controller, key, &keypath) < 0)\n        return -1;\n\n    return virCgroupGetValueRaw(keypath, value);\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetValueStr(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     char **value)\n{\n    g_autofree char *keypath = NULL;\n\n    if (virCgroupPathOfController(group, controller, key, &keypath) < 0)\n        return -1;\n\n    return virCgroupGetValueRaw(keypath, value);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"vircgroupv1.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <sys/stat.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV1GetBlkioDeviceWriteBps(virCgroupPtr group,\n                                  const char *path,\n                                  unsigned long long *wbps)\n{\n    g_autofree char *str = NULL;\n    g_autofree char *value = NULL;\n\n    if (virCgroupGetValueStr(group,\n                             VIR_CGROUP_CONTROLLER_BLKIO,\n                             \"blkio.throttle.write_bps_device\",\n                             &value) < 0) {\n        return -1;\n    }\n\n    if (virCgroupGetValueForBlkDev(value, path, &str) < 0)\n        return -1;\n\n    if (!str) {\n        *wbps = 0;\n    } else if (virStrToLong_ull(str, NULL, 10, wbps) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Unable to parse '%s' as an integer\"),\n                       str);\n        return -1;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virCgroupV1SetBlkioDeviceWriteBps",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv1.c",
    "lines": "1408-1425",
    "snippet": "static int\nvirCgroupV1SetBlkioDeviceWriteBps(virCgroupPtr group,\n                                  const char *path,\n                                  unsigned long long wbps)\n{\n    g_autofree char *str = NULL;\n    g_autofree char *blkstr = NULL;\n\n    if (!(blkstr = virCgroupGetBlockDevString(path)))\n        return -1;\n\n    str = g_strdup_printf(\"%s%llu\", blkstr, wbps);\n\n    return virCgroupSetValueStr(group,\n                                VIR_CGROUP_CONTROLLER_BLKIO,\n                                \"blkio.throttle.write_bps_device\",\n                                str);\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"vircgroupv1.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <sys/stat.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCgroupSetValueStr",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_BLKIO",
            "\"blkio.throttle.write_bps_device\"",
            "str"
          ],
          "line": 1421
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupSetValueStr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "499-511",
          "snippet": "int\nvirCgroupSetValueStr(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     const char *value)\n{\n    g_autofree char *keypath = NULL;\n\n    if (virCgroupPathOfController(group, controller, key, &keypath) < 0)\n        return -1;\n\n    return virCgroupSetValueRaw(keypath, value);\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupSetValueStr(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     const char *value)\n{\n    g_autofree char *keypath = NULL;\n\n    if (virCgroupPathOfController(group, controller, key, &keypath) < 0)\n        return -1;\n\n    return virCgroupSetValueRaw(keypath, value);\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"%s%llu\"",
            "blkstr",
            "wbps"
          ],
          "line": 1419
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupGetBlockDevString",
          "args": [
            "path"
          ],
          "line": 1416
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupGetBlockDevString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "423-448",
          "snippet": "char *\nvirCgroupGetBlockDevString(const char *path)\n{\n    char *ret = NULL;\n    struct stat sb;\n\n    if (stat(path, &sb) < 0) {\n        virReportSystemError(errno,\n                             _(\"Path '%s' is not accessible\"),\n                             path);\n        return NULL;\n    }\n\n    if (!S_ISBLK(sb.st_mode)) {\n        virReportSystemError(EINVAL,\n                             _(\"Path '%s' must be a block device\"),\n                             path);\n        return NULL;\n    }\n\n    /* Automatically append space after the string since all callers\n     * use it anyway */\n    ret = g_strdup_printf(\"%d:%d \", major(sb.st_rdev), minor(sb.st_rdev));\n\n    return ret;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nchar *\nvirCgroupGetBlockDevString(const char *path)\n{\n    char *ret = NULL;\n    struct stat sb;\n\n    if (stat(path, &sb) < 0) {\n        virReportSystemError(errno,\n                             _(\"Path '%s' is not accessible\"),\n                             path);\n        return NULL;\n    }\n\n    if (!S_ISBLK(sb.st_mode)) {\n        virReportSystemError(EINVAL,\n                             _(\"Path '%s' must be a block device\"),\n                             path);\n        return NULL;\n    }\n\n    /* Automatically append space after the string since all callers\n     * use it anyway */\n    ret = g_strdup_printf(\"%d:%d \", major(sb.st_rdev), minor(sb.st_rdev));\n\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"vircgroupv1.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <sys/stat.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV1SetBlkioDeviceWriteBps(virCgroupPtr group,\n                                  const char *path,\n                                  unsigned long long wbps)\n{\n    g_autofree char *str = NULL;\n    g_autofree char *blkstr = NULL;\n\n    if (!(blkstr = virCgroupGetBlockDevString(path)))\n        return -1;\n\n    str = g_strdup_printf(\"%s%llu\", blkstr, wbps);\n\n    return virCgroupSetValueStr(group,\n                                VIR_CGROUP_CONTROLLER_BLKIO,\n                                \"blkio.throttle.write_bps_device\",\n                                str);\n}"
  },
  {
    "function_name": "virCgroupV1GetBlkioDeviceReadBps",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv1.c",
    "lines": "1377-1405",
    "snippet": "static int\nvirCgroupV1GetBlkioDeviceReadBps(virCgroupPtr group,\n                                 const char *path,\n                                 unsigned long long *rbps)\n{\n    g_autofree char *str = NULL;\n    g_autofree char *value = NULL;\n\n    if (virCgroupGetValueStr(group,\n                             VIR_CGROUP_CONTROLLER_BLKIO,\n                             \"blkio.throttle.read_bps_device\",\n                             &value) < 0) {\n        return -1;\n    }\n\n    if (virCgroupGetValueForBlkDev(value, path, &str) < 0)\n        return -1;\n\n    if (!str) {\n        *rbps = 0;\n    } else if (virStrToLong_ull(str, NULL, 10, rbps) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Unable to parse '%s' as an integer\"),\n                       str);\n        return -1;\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"vircgroupv1.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <sys/stat.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Unable to parse '%s' as an integer\")",
            "str"
          ],
          "line": 1398
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to parse '%s' as an integer\""
          ],
          "line": 1399
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStrToLong_ull",
          "args": [
            "str",
            "NULL",
            "10",
            "rbps"
          ],
          "line": 1397
        },
        "resolved": true,
        "details": {
          "function_name": "virStrToLong_ullp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "568-586",
          "snippet": "int\nvirStrToLong_ullp(char const *s, char **end_ptr, int base,\n                  unsigned long long *result)\n{\n    unsigned long long val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtoull(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToLong_ullp(char const *s, char **end_ptr, int base,\n                  unsigned long long *result)\n{\n    unsigned long long val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtoull(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupGetValueForBlkDev",
          "args": [
            "value",
            "path",
            "&str"
          ],
          "line": 1392
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupGetValueForBlkDev",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "529-550",
          "snippet": "int\nvirCgroupGetValueForBlkDev(const char *str,\n                           const char *path,\n                           char **value)\n{\n    g_autofree char *prefix = NULL;\n    char **lines = NULL;\n    int ret = -1;\n\n    if (!(prefix = virCgroupGetBlockDevString(path)))\n        goto error;\n\n    if (!(lines = virStringSplit(str, \"\\n\", -1)))\n        goto error;\n\n    *value = g_strdup(virStringListGetFirstWithPrefix(lines, prefix));\n\n    ret = 0;\n error:\n    virStringListFree(lines);\n    return ret;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetValueForBlkDev(const char *str,\n                           const char *path,\n                           char **value)\n{\n    g_autofree char *prefix = NULL;\n    char **lines = NULL;\n    int ret = -1;\n\n    if (!(prefix = virCgroupGetBlockDevString(path)))\n        goto error;\n\n    if (!(lines = virStringSplit(str, \"\\n\", -1)))\n        goto error;\n\n    *value = g_strdup(virStringListGetFirstWithPrefix(lines, prefix));\n\n    ret = 0;\n error:\n    virStringListFree(lines);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupGetValueStr",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_BLKIO",
            "\"blkio.throttle.read_bps_device\"",
            "&value"
          ],
          "line": 1385
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupGetValueStr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "514-526",
          "snippet": "int\nvirCgroupGetValueStr(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     char **value)\n{\n    g_autofree char *keypath = NULL;\n\n    if (virCgroupPathOfController(group, controller, key, &keypath) < 0)\n        return -1;\n\n    return virCgroupGetValueRaw(keypath, value);\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetValueStr(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     char **value)\n{\n    g_autofree char *keypath = NULL;\n\n    if (virCgroupPathOfController(group, controller, key, &keypath) < 0)\n        return -1;\n\n    return virCgroupGetValueRaw(keypath, value);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"vircgroupv1.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <sys/stat.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV1GetBlkioDeviceReadBps(virCgroupPtr group,\n                                 const char *path,\n                                 unsigned long long *rbps)\n{\n    g_autofree char *str = NULL;\n    g_autofree char *value = NULL;\n\n    if (virCgroupGetValueStr(group,\n                             VIR_CGROUP_CONTROLLER_BLKIO,\n                             \"blkio.throttle.read_bps_device\",\n                             &value) < 0) {\n        return -1;\n    }\n\n    if (virCgroupGetValueForBlkDev(value, path, &str) < 0)\n        return -1;\n\n    if (!str) {\n        *rbps = 0;\n    } else if (virStrToLong_ull(str, NULL, 10, rbps) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Unable to parse '%s' as an integer\"),\n                       str);\n        return -1;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virCgroupV1SetBlkioDeviceReadBps",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv1.c",
    "lines": "1357-1374",
    "snippet": "static int\nvirCgroupV1SetBlkioDeviceReadBps(virCgroupPtr group,\n                                 const char *path,\n                                 unsigned long long rbps)\n{\n    g_autofree char *str = NULL;\n    g_autofree char *blkstr = NULL;\n\n    if (!(blkstr = virCgroupGetBlockDevString(path)))\n        return -1;\n\n    str = g_strdup_printf(\"%s%llu\", blkstr, rbps);\n\n    return virCgroupSetValueStr(group,\n                                VIR_CGROUP_CONTROLLER_BLKIO,\n                                \"blkio.throttle.read_bps_device\",\n                                str);\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"vircgroupv1.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <sys/stat.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCgroupSetValueStr",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_BLKIO",
            "\"blkio.throttle.read_bps_device\"",
            "str"
          ],
          "line": 1370
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupSetValueStr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "499-511",
          "snippet": "int\nvirCgroupSetValueStr(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     const char *value)\n{\n    g_autofree char *keypath = NULL;\n\n    if (virCgroupPathOfController(group, controller, key, &keypath) < 0)\n        return -1;\n\n    return virCgroupSetValueRaw(keypath, value);\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupSetValueStr(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     const char *value)\n{\n    g_autofree char *keypath = NULL;\n\n    if (virCgroupPathOfController(group, controller, key, &keypath) < 0)\n        return -1;\n\n    return virCgroupSetValueRaw(keypath, value);\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"%s%llu\"",
            "blkstr",
            "rbps"
          ],
          "line": 1368
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupGetBlockDevString",
          "args": [
            "path"
          ],
          "line": 1365
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupGetBlockDevString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "423-448",
          "snippet": "char *\nvirCgroupGetBlockDevString(const char *path)\n{\n    char *ret = NULL;\n    struct stat sb;\n\n    if (stat(path, &sb) < 0) {\n        virReportSystemError(errno,\n                             _(\"Path '%s' is not accessible\"),\n                             path);\n        return NULL;\n    }\n\n    if (!S_ISBLK(sb.st_mode)) {\n        virReportSystemError(EINVAL,\n                             _(\"Path '%s' must be a block device\"),\n                             path);\n        return NULL;\n    }\n\n    /* Automatically append space after the string since all callers\n     * use it anyway */\n    ret = g_strdup_printf(\"%d:%d \", major(sb.st_rdev), minor(sb.st_rdev));\n\n    return ret;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nchar *\nvirCgroupGetBlockDevString(const char *path)\n{\n    char *ret = NULL;\n    struct stat sb;\n\n    if (stat(path, &sb) < 0) {\n        virReportSystemError(errno,\n                             _(\"Path '%s' is not accessible\"),\n                             path);\n        return NULL;\n    }\n\n    if (!S_ISBLK(sb.st_mode)) {\n        virReportSystemError(EINVAL,\n                             _(\"Path '%s' must be a block device\"),\n                             path);\n        return NULL;\n    }\n\n    /* Automatically append space after the string since all callers\n     * use it anyway */\n    ret = g_strdup_printf(\"%d:%d \", major(sb.st_rdev), minor(sb.st_rdev));\n\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"vircgroupv1.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <sys/stat.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV1SetBlkioDeviceReadBps(virCgroupPtr group,\n                                 const char *path,\n                                 unsigned long long rbps)\n{\n    g_autofree char *str = NULL;\n    g_autofree char *blkstr = NULL;\n\n    if (!(blkstr = virCgroupGetBlockDevString(path)))\n        return -1;\n\n    str = g_strdup_printf(\"%s%llu\", blkstr, rbps);\n\n    return virCgroupSetValueStr(group,\n                                VIR_CGROUP_CONTROLLER_BLKIO,\n                                \"blkio.throttle.read_bps_device\",\n                                str);\n}"
  },
  {
    "function_name": "virCgroupV1GetBlkioDeviceWriteIops",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv1.c",
    "lines": "1326-1354",
    "snippet": "static int\nvirCgroupV1GetBlkioDeviceWriteIops(virCgroupPtr group,\n                                   const char *path,\n                                   unsigned int *wiops)\n{\n    g_autofree char *str = NULL;\n    g_autofree char *value = NULL;\n\n    if (virCgroupGetValueStr(group,\n                             VIR_CGROUP_CONTROLLER_BLKIO,\n                             \"blkio.throttle.write_iops_device\",\n                             &value) < 0) {\n        return -1;\n    }\n\n    if (virCgroupGetValueForBlkDev(value, path, &str) < 0)\n        return -1;\n\n    if (!str) {\n        *wiops = 0;\n    } else if (virStrToLong_ui(str, NULL, 10, wiops) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Unable to parse '%s' as an integer\"),\n                       str);\n        return -1;\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"vircgroupv1.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <sys/stat.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Unable to parse '%s' as an integer\")",
            "str"
          ],
          "line": 1347
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to parse '%s' as an integer\""
          ],
          "line": 1348
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStrToLong_ui",
          "args": [
            "str",
            "NULL",
            "10",
            "wiops"
          ],
          "line": 1346
        },
        "resolved": true,
        "details": {
          "function_name": "virStrToLong_uip",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "444-461",
          "snippet": "int\nvirStrToLong_uip(char const *s, char **end_ptr, int base, unsigned int *result)\n{\n    unsigned long int val;\n    char *p;\n    bool err = false;\n\n    errno = 0;\n    val = strtoul(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s || (unsigned int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToLong_uip(char const *s, char **end_ptr, int base, unsigned int *result)\n{\n    unsigned long int val;\n    char *p;\n    bool err = false;\n\n    errno = 0;\n    val = strtoul(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s || (unsigned int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupGetValueForBlkDev",
          "args": [
            "value",
            "path",
            "&str"
          ],
          "line": 1341
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupGetValueForBlkDev",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "529-550",
          "snippet": "int\nvirCgroupGetValueForBlkDev(const char *str,\n                           const char *path,\n                           char **value)\n{\n    g_autofree char *prefix = NULL;\n    char **lines = NULL;\n    int ret = -1;\n\n    if (!(prefix = virCgroupGetBlockDevString(path)))\n        goto error;\n\n    if (!(lines = virStringSplit(str, \"\\n\", -1)))\n        goto error;\n\n    *value = g_strdup(virStringListGetFirstWithPrefix(lines, prefix));\n\n    ret = 0;\n error:\n    virStringListFree(lines);\n    return ret;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetValueForBlkDev(const char *str,\n                           const char *path,\n                           char **value)\n{\n    g_autofree char *prefix = NULL;\n    char **lines = NULL;\n    int ret = -1;\n\n    if (!(prefix = virCgroupGetBlockDevString(path)))\n        goto error;\n\n    if (!(lines = virStringSplit(str, \"\\n\", -1)))\n        goto error;\n\n    *value = g_strdup(virStringListGetFirstWithPrefix(lines, prefix));\n\n    ret = 0;\n error:\n    virStringListFree(lines);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupGetValueStr",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_BLKIO",
            "\"blkio.throttle.write_iops_device\"",
            "&value"
          ],
          "line": 1334
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupGetValueStr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "514-526",
          "snippet": "int\nvirCgroupGetValueStr(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     char **value)\n{\n    g_autofree char *keypath = NULL;\n\n    if (virCgroupPathOfController(group, controller, key, &keypath) < 0)\n        return -1;\n\n    return virCgroupGetValueRaw(keypath, value);\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetValueStr(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     char **value)\n{\n    g_autofree char *keypath = NULL;\n\n    if (virCgroupPathOfController(group, controller, key, &keypath) < 0)\n        return -1;\n\n    return virCgroupGetValueRaw(keypath, value);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"vircgroupv1.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <sys/stat.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV1GetBlkioDeviceWriteIops(virCgroupPtr group,\n                                   const char *path,\n                                   unsigned int *wiops)\n{\n    g_autofree char *str = NULL;\n    g_autofree char *value = NULL;\n\n    if (virCgroupGetValueStr(group,\n                             VIR_CGROUP_CONTROLLER_BLKIO,\n                             \"blkio.throttle.write_iops_device\",\n                             &value) < 0) {\n        return -1;\n    }\n\n    if (virCgroupGetValueForBlkDev(value, path, &str) < 0)\n        return -1;\n\n    if (!str) {\n        *wiops = 0;\n    } else if (virStrToLong_ui(str, NULL, 10, wiops) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Unable to parse '%s' as an integer\"),\n                       str);\n        return -1;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virCgroupV1SetBlkioDeviceWriteIops",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv1.c",
    "lines": "1306-1323",
    "snippet": "static int\nvirCgroupV1SetBlkioDeviceWriteIops(virCgroupPtr group,\n                                   const char *path,\n                                   unsigned int wiops)\n{\n    g_autofree char *str = NULL;\n    g_autofree char *blkstr = NULL;\n\n    if (!(blkstr = virCgroupGetBlockDevString(path)))\n        return -1;\n\n    str = g_strdup_printf(\"%s%u\", blkstr, wiops);\n\n    return virCgroupSetValueStr(group,\n                                VIR_CGROUP_CONTROLLER_BLKIO,\n                                \"blkio.throttle.write_iops_device\",\n                                str);\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"vircgroupv1.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <sys/stat.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCgroupSetValueStr",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_BLKIO",
            "\"blkio.throttle.write_iops_device\"",
            "str"
          ],
          "line": 1319
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupSetValueStr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "499-511",
          "snippet": "int\nvirCgroupSetValueStr(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     const char *value)\n{\n    g_autofree char *keypath = NULL;\n\n    if (virCgroupPathOfController(group, controller, key, &keypath) < 0)\n        return -1;\n\n    return virCgroupSetValueRaw(keypath, value);\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupSetValueStr(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     const char *value)\n{\n    g_autofree char *keypath = NULL;\n\n    if (virCgroupPathOfController(group, controller, key, &keypath) < 0)\n        return -1;\n\n    return virCgroupSetValueRaw(keypath, value);\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"%s%u\"",
            "blkstr",
            "wiops"
          ],
          "line": 1317
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupGetBlockDevString",
          "args": [
            "path"
          ],
          "line": 1314
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupGetBlockDevString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "423-448",
          "snippet": "char *\nvirCgroupGetBlockDevString(const char *path)\n{\n    char *ret = NULL;\n    struct stat sb;\n\n    if (stat(path, &sb) < 0) {\n        virReportSystemError(errno,\n                             _(\"Path '%s' is not accessible\"),\n                             path);\n        return NULL;\n    }\n\n    if (!S_ISBLK(sb.st_mode)) {\n        virReportSystemError(EINVAL,\n                             _(\"Path '%s' must be a block device\"),\n                             path);\n        return NULL;\n    }\n\n    /* Automatically append space after the string since all callers\n     * use it anyway */\n    ret = g_strdup_printf(\"%d:%d \", major(sb.st_rdev), minor(sb.st_rdev));\n\n    return ret;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nchar *\nvirCgroupGetBlockDevString(const char *path)\n{\n    char *ret = NULL;\n    struct stat sb;\n\n    if (stat(path, &sb) < 0) {\n        virReportSystemError(errno,\n                             _(\"Path '%s' is not accessible\"),\n                             path);\n        return NULL;\n    }\n\n    if (!S_ISBLK(sb.st_mode)) {\n        virReportSystemError(EINVAL,\n                             _(\"Path '%s' must be a block device\"),\n                             path);\n        return NULL;\n    }\n\n    /* Automatically append space after the string since all callers\n     * use it anyway */\n    ret = g_strdup_printf(\"%d:%d \", major(sb.st_rdev), minor(sb.st_rdev));\n\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"vircgroupv1.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <sys/stat.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV1SetBlkioDeviceWriteIops(virCgroupPtr group,\n                                   const char *path,\n                                   unsigned int wiops)\n{\n    g_autofree char *str = NULL;\n    g_autofree char *blkstr = NULL;\n\n    if (!(blkstr = virCgroupGetBlockDevString(path)))\n        return -1;\n\n    str = g_strdup_printf(\"%s%u\", blkstr, wiops);\n\n    return virCgroupSetValueStr(group,\n                                VIR_CGROUP_CONTROLLER_BLKIO,\n                                \"blkio.throttle.write_iops_device\",\n                                str);\n}"
  },
  {
    "function_name": "virCgroupV1GetBlkioDeviceReadIops",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv1.c",
    "lines": "1275-1303",
    "snippet": "static int\nvirCgroupV1GetBlkioDeviceReadIops(virCgroupPtr group,\n                                  const char *path,\n                                  unsigned int *riops)\n{\n    g_autofree char *str = NULL;\n    g_autofree char *value = NULL;\n\n    if (virCgroupGetValueStr(group,\n                             VIR_CGROUP_CONTROLLER_BLKIO,\n                             \"blkio.throttle.read_iops_device\",\n                             &value) < 0) {\n        return -1;\n    }\n\n    if (virCgroupGetValueForBlkDev(value, path, &str) < 0)\n        return -1;\n\n    if (!str) {\n        *riops = 0;\n    } else if (virStrToLong_ui(str, NULL, 10, riops) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Unable to parse '%s' as an integer\"),\n                       str);\n        return -1;\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"vircgroupv1.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <sys/stat.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Unable to parse '%s' as an integer\")",
            "str"
          ],
          "line": 1296
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to parse '%s' as an integer\""
          ],
          "line": 1297
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStrToLong_ui",
          "args": [
            "str",
            "NULL",
            "10",
            "riops"
          ],
          "line": 1295
        },
        "resolved": true,
        "details": {
          "function_name": "virStrToLong_uip",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "444-461",
          "snippet": "int\nvirStrToLong_uip(char const *s, char **end_ptr, int base, unsigned int *result)\n{\n    unsigned long int val;\n    char *p;\n    bool err = false;\n\n    errno = 0;\n    val = strtoul(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s || (unsigned int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToLong_uip(char const *s, char **end_ptr, int base, unsigned int *result)\n{\n    unsigned long int val;\n    char *p;\n    bool err = false;\n\n    errno = 0;\n    val = strtoul(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s || (unsigned int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupGetValueForBlkDev",
          "args": [
            "value",
            "path",
            "&str"
          ],
          "line": 1290
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupGetValueForBlkDev",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "529-550",
          "snippet": "int\nvirCgroupGetValueForBlkDev(const char *str,\n                           const char *path,\n                           char **value)\n{\n    g_autofree char *prefix = NULL;\n    char **lines = NULL;\n    int ret = -1;\n\n    if (!(prefix = virCgroupGetBlockDevString(path)))\n        goto error;\n\n    if (!(lines = virStringSplit(str, \"\\n\", -1)))\n        goto error;\n\n    *value = g_strdup(virStringListGetFirstWithPrefix(lines, prefix));\n\n    ret = 0;\n error:\n    virStringListFree(lines);\n    return ret;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetValueForBlkDev(const char *str,\n                           const char *path,\n                           char **value)\n{\n    g_autofree char *prefix = NULL;\n    char **lines = NULL;\n    int ret = -1;\n\n    if (!(prefix = virCgroupGetBlockDevString(path)))\n        goto error;\n\n    if (!(lines = virStringSplit(str, \"\\n\", -1)))\n        goto error;\n\n    *value = g_strdup(virStringListGetFirstWithPrefix(lines, prefix));\n\n    ret = 0;\n error:\n    virStringListFree(lines);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupGetValueStr",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_BLKIO",
            "\"blkio.throttle.read_iops_device\"",
            "&value"
          ],
          "line": 1283
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupGetValueStr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "514-526",
          "snippet": "int\nvirCgroupGetValueStr(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     char **value)\n{\n    g_autofree char *keypath = NULL;\n\n    if (virCgroupPathOfController(group, controller, key, &keypath) < 0)\n        return -1;\n\n    return virCgroupGetValueRaw(keypath, value);\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetValueStr(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     char **value)\n{\n    g_autofree char *keypath = NULL;\n\n    if (virCgroupPathOfController(group, controller, key, &keypath) < 0)\n        return -1;\n\n    return virCgroupGetValueRaw(keypath, value);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"vircgroupv1.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <sys/stat.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV1GetBlkioDeviceReadIops(virCgroupPtr group,\n                                  const char *path,\n                                  unsigned int *riops)\n{\n    g_autofree char *str = NULL;\n    g_autofree char *value = NULL;\n\n    if (virCgroupGetValueStr(group,\n                             VIR_CGROUP_CONTROLLER_BLKIO,\n                             \"blkio.throttle.read_iops_device\",\n                             &value) < 0) {\n        return -1;\n    }\n\n    if (virCgroupGetValueForBlkDev(value, path, &str) < 0)\n        return -1;\n\n    if (!str) {\n        *riops = 0;\n    } else if (virStrToLong_ui(str, NULL, 10, riops) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Unable to parse '%s' as an integer\"),\n                       str);\n        return -1;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virCgroupV1SetBlkioDeviceReadIops",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv1.c",
    "lines": "1255-1272",
    "snippet": "static int\nvirCgroupV1SetBlkioDeviceReadIops(virCgroupPtr group,\n                                  const char *path,\n                                  unsigned int riops)\n{\n    g_autofree char *str = NULL;\n    g_autofree char *blkstr = NULL;\n\n    if (!(blkstr = virCgroupGetBlockDevString(path)))\n        return -1;\n\n    str = g_strdup_printf(\"%s%u\", blkstr, riops);\n\n    return virCgroupSetValueStr(group,\n                                VIR_CGROUP_CONTROLLER_BLKIO,\n                                \"blkio.throttle.read_iops_device\",\n                                str);\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"vircgroupv1.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <sys/stat.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCgroupSetValueStr",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_BLKIO",
            "\"blkio.throttle.read_iops_device\"",
            "str"
          ],
          "line": 1268
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupSetValueStr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "499-511",
          "snippet": "int\nvirCgroupSetValueStr(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     const char *value)\n{\n    g_autofree char *keypath = NULL;\n\n    if (virCgroupPathOfController(group, controller, key, &keypath) < 0)\n        return -1;\n\n    return virCgroupSetValueRaw(keypath, value);\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupSetValueStr(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     const char *value)\n{\n    g_autofree char *keypath = NULL;\n\n    if (virCgroupPathOfController(group, controller, key, &keypath) < 0)\n        return -1;\n\n    return virCgroupSetValueRaw(keypath, value);\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"%s%u\"",
            "blkstr",
            "riops"
          ],
          "line": 1266
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupGetBlockDevString",
          "args": [
            "path"
          ],
          "line": 1263
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupGetBlockDevString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "423-448",
          "snippet": "char *\nvirCgroupGetBlockDevString(const char *path)\n{\n    char *ret = NULL;\n    struct stat sb;\n\n    if (stat(path, &sb) < 0) {\n        virReportSystemError(errno,\n                             _(\"Path '%s' is not accessible\"),\n                             path);\n        return NULL;\n    }\n\n    if (!S_ISBLK(sb.st_mode)) {\n        virReportSystemError(EINVAL,\n                             _(\"Path '%s' must be a block device\"),\n                             path);\n        return NULL;\n    }\n\n    /* Automatically append space after the string since all callers\n     * use it anyway */\n    ret = g_strdup_printf(\"%d:%d \", major(sb.st_rdev), minor(sb.st_rdev));\n\n    return ret;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nchar *\nvirCgroupGetBlockDevString(const char *path)\n{\n    char *ret = NULL;\n    struct stat sb;\n\n    if (stat(path, &sb) < 0) {\n        virReportSystemError(errno,\n                             _(\"Path '%s' is not accessible\"),\n                             path);\n        return NULL;\n    }\n\n    if (!S_ISBLK(sb.st_mode)) {\n        virReportSystemError(EINVAL,\n                             _(\"Path '%s' must be a block device\"),\n                             path);\n        return NULL;\n    }\n\n    /* Automatically append space after the string since all callers\n     * use it anyway */\n    ret = g_strdup_printf(\"%d:%d \", major(sb.st_rdev), minor(sb.st_rdev));\n\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"vircgroupv1.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <sys/stat.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV1SetBlkioDeviceReadIops(virCgroupPtr group,\n                                  const char *path,\n                                  unsigned int riops)\n{\n    g_autofree char *str = NULL;\n    g_autofree char *blkstr = NULL;\n\n    if (!(blkstr = virCgroupGetBlockDevString(path)))\n        return -1;\n\n    str = g_strdup_printf(\"%s%u\", blkstr, riops);\n\n    return virCgroupSetValueStr(group,\n                                VIR_CGROUP_CONTROLLER_BLKIO,\n                                \"blkio.throttle.read_iops_device\",\n                                str);\n}"
  },
  {
    "function_name": "virCgroupV1GetBlkioDeviceWeight",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv1.c",
    "lines": "1216-1252",
    "snippet": "static int\nvirCgroupV1GetBlkioDeviceWeight(virCgroupPtr group,\n                                const char *devPath,\n                                unsigned int *weight)\n{\n    g_autofree char *str = NULL;\n    g_autofree char *value = NULL;\n    g_autofree char *path = NULL;\n\n    if (virCgroupV1PathOfController(group, VIR_CGROUP_CONTROLLER_BLKIO,\n                                    \"blkio.weight_device\", &path) < 0) {\n        return -1;\n    }\n\n    if (!virFileExists(path)) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"blkio device weight is valid only for cfq scheduler\"));\n        return -1;\n    }\n\n    if (virCgroupGetValueRaw(path, &value) < 0)\n        return -1;\n\n    if (virCgroupGetValueForBlkDev(value, devPath, &str) < 0)\n        return -1;\n\n    if (!str) {\n        *weight = 0;\n    } else if (virStrToLong_ui(str, NULL, 10, weight) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Unable to parse '%s' as an integer\"),\n                       str);\n        return -1;\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"vircgroupv1.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <sys/stat.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Unable to parse '%s' as an integer\")",
            "str"
          ],
          "line": 1245
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to parse '%s' as an integer\""
          ],
          "line": 1246
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStrToLong_ui",
          "args": [
            "str",
            "NULL",
            "10",
            "weight"
          ],
          "line": 1244
        },
        "resolved": true,
        "details": {
          "function_name": "virStrToLong_uip",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "444-461",
          "snippet": "int\nvirStrToLong_uip(char const *s, char **end_ptr, int base, unsigned int *result)\n{\n    unsigned long int val;\n    char *p;\n    bool err = false;\n\n    errno = 0;\n    val = strtoul(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s || (unsigned int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToLong_uip(char const *s, char **end_ptr, int base, unsigned int *result)\n{\n    unsigned long int val;\n    char *p;\n    bool err = false;\n\n    errno = 0;\n    val = strtoul(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s || (unsigned int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupGetValueForBlkDev",
          "args": [
            "value",
            "devPath",
            "&str"
          ],
          "line": 1239
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupGetValueForBlkDev",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "529-550",
          "snippet": "int\nvirCgroupGetValueForBlkDev(const char *str,\n                           const char *path,\n                           char **value)\n{\n    g_autofree char *prefix = NULL;\n    char **lines = NULL;\n    int ret = -1;\n\n    if (!(prefix = virCgroupGetBlockDevString(path)))\n        goto error;\n\n    if (!(lines = virStringSplit(str, \"\\n\", -1)))\n        goto error;\n\n    *value = g_strdup(virStringListGetFirstWithPrefix(lines, prefix));\n\n    ret = 0;\n error:\n    virStringListFree(lines);\n    return ret;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetValueForBlkDev(const char *str,\n                           const char *path,\n                           char **value)\n{\n    g_autofree char *prefix = NULL;\n    char **lines = NULL;\n    int ret = -1;\n\n    if (!(prefix = virCgroupGetBlockDevString(path)))\n        goto error;\n\n    if (!(lines = virStringSplit(str, \"\\n\", -1)))\n        goto error;\n\n    *value = g_strdup(virStringListGetFirstWithPrefix(lines, prefix));\n\n    ret = 0;\n error:\n    virStringListFree(lines);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupGetValueRaw",
          "args": [
            "path",
            "&value"
          ],
          "line": 1236
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupGetValueRaw",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "475-496",
          "snippet": "int\nvirCgroupGetValueRaw(const char *path,\n                     char **value)\n{\n    int rc;\n\n    *value = NULL;\n\n    VIR_DEBUG(\"Get value %s\", path);\n\n    if ((rc = virFileReadAll(path, 1024*1024, value)) < 0) {\n        virReportSystemError(errno,\n                             _(\"Unable to read from '%s'\"), path);\n        return -1;\n    }\n\n    /* Terminated with '\\n' has sometimes harmful effects to the caller */\n    if (rc > 0 && (*value)[rc - 1] == '\\n')\n        (*value)[rc - 1] = '\\0';\n\n    return 0;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetValueRaw(const char *path,\n                     char **value)\n{\n    int rc;\n\n    *value = NULL;\n\n    VIR_DEBUG(\"Get value %s\", path);\n\n    if ((rc = virFileReadAll(path, 1024*1024, value)) < 0) {\n        virReportSystemError(errno,\n                             _(\"Unable to read from '%s'\"), path);\n        return -1;\n    }\n\n    /* Terminated with '\\n' has sometimes harmful effects to the caller */\n    if (rc > 0 && (*value)[rc - 1] == '\\n')\n        (*value)[rc - 1] = '\\0';\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_INVALID",
            "\"%s\"",
            "_(\"blkio device weight is valid only for cfq scheduler\")"
          ],
          "line": 1231
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virFileExists",
          "args": [
            "path"
          ],
          "line": 1230
        },
        "resolved": true,
        "details": {
          "function_name": "virFileExists",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1873-1877",
          "snippet": "bool\nvirFileExists(const char *path)\n{\n    return access(path, F_OK) == 0;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nbool\nvirFileExists(const char *path)\n{\n    return access(path, F_OK) == 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupV1PathOfController",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_BLKIO",
            "\"blkio.weight_device\"",
            "&path"
          ],
          "line": 1225
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupV1PathOfController",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv1.c",
          "lines": "510-534",
          "snippet": "static int\nvirCgroupV1PathOfController(virCgroupPtr group,\n                            int controller,\n                            const char *key,\n                            char **path)\n{\n    if (group->legacy[controller].mountPoint == NULL) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"v1 controller '%s' is not mounted\"),\n                       virCgroupV1ControllerTypeToString(controller));\n        return -1;\n    }\n\n    if (group->legacy[controller].placement == NULL) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"v1 controller '%s' is not enabled for group\"),\n                       virCgroupV1ControllerTypeToString(controller));\n        return -1;\n    }\n\n    *path = g_strdup_printf(\"%s%s/%s\", group->legacy[controller].mountPoint,\n                            group->legacy[controller].placement, NULLSTR_EMPTY(key));\n\n    return 0;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"vircgroupv1.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"vircgroup.h\"",
            "#include \"vircgrouppriv.h\"",
            "#include \"internal.h\"",
            "# include <sys/mount.h>",
            "# include <sys/stat.h>",
            "# include <mntent.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"vircgroupv1.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <sys/stat.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV1PathOfController(virCgroupPtr group,\n                            int controller,\n                            const char *key,\n                            char **path)\n{\n    if (group->legacy[controller].mountPoint == NULL) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"v1 controller '%s' is not mounted\"),\n                       virCgroupV1ControllerTypeToString(controller));\n        return -1;\n    }\n\n    if (group->legacy[controller].placement == NULL) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"v1 controller '%s' is not enabled for group\"),\n                       virCgroupV1ControllerTypeToString(controller));\n        return -1;\n    }\n\n    *path = g_strdup_printf(\"%s%s/%s\", group->legacy[controller].mountPoint,\n                            group->legacy[controller].placement, NULLSTR_EMPTY(key));\n\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"vircgroupv1.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <sys/stat.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV1GetBlkioDeviceWeight(virCgroupPtr group,\n                                const char *devPath,\n                                unsigned int *weight)\n{\n    g_autofree char *str = NULL;\n    g_autofree char *value = NULL;\n    g_autofree char *path = NULL;\n\n    if (virCgroupV1PathOfController(group, VIR_CGROUP_CONTROLLER_BLKIO,\n                                    \"blkio.weight_device\", &path) < 0) {\n        return -1;\n    }\n\n    if (!virFileExists(path)) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"blkio device weight is valid only for cfq scheduler\"));\n        return -1;\n    }\n\n    if (virCgroupGetValueRaw(path, &value) < 0)\n        return -1;\n\n    if (virCgroupGetValueForBlkDev(value, devPath, &str) < 0)\n        return -1;\n\n    if (!str) {\n        *weight = 0;\n    } else if (virStrToLong_ui(str, NULL, 10, weight) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Unable to parse '%s' as an integer\"),\n                       str);\n        return -1;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virCgroupV1SetBlkioDeviceWeight",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv1.c",
    "lines": "1187-1213",
    "snippet": "static int\nvirCgroupV1SetBlkioDeviceWeight(virCgroupPtr group,\n                                const char *devPath,\n                                unsigned int weight)\n{\n    g_autofree char *str = NULL;\n    g_autofree char *blkstr = NULL;\n    g_autofree char *path = NULL;\n\n    if (!(blkstr = virCgroupGetBlockDevString(devPath)))\n        return -1;\n\n    str = g_strdup_printf(\"%s%d\", blkstr, weight);\n\n    if (virCgroupV1PathOfController(group, VIR_CGROUP_CONTROLLER_BLKIO,\n                                    \"blkio.weight_device\", &path) < 0) {\n        return -1;\n    }\n\n    if (!virFileExists(path)) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"blkio device weight is valid only for cfq scheduler\"));\n        return -1;\n    }\n\n    return virCgroupSetValueRaw(path, str);\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"vircgroupv1.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <sys/stat.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCgroupSetValueRaw",
          "args": [
            "path",
            "str"
          ],
          "line": 1212
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupSetValueRaw",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "451-472",
          "snippet": "int\nvirCgroupSetValueRaw(const char *path,\n                     const char *value)\n{\n    char *tmp;\n\n    VIR_DEBUG(\"Set value '%s' to '%s'\", path, value);\n    if (virFileWriteStr(path, value, 0) < 0) {\n        if (errno == EINVAL &&\n            (tmp = strrchr(path, '/'))) {\n            virReportSystemError(errno,\n                                 _(\"Invalid value '%s' for '%s'\"),\n                                 value, tmp + 1);\n            return -1;\n        }\n        virReportSystemError(errno,\n                             _(\"Unable to write to '%s'\"), path);\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupSetValueRaw(const char *path,\n                     const char *value)\n{\n    char *tmp;\n\n    VIR_DEBUG(\"Set value '%s' to '%s'\", path, value);\n    if (virFileWriteStr(path, value, 0) < 0) {\n        if (errno == EINVAL &&\n            (tmp = strrchr(path, '/'))) {\n            virReportSystemError(errno,\n                                 _(\"Invalid value '%s' for '%s'\"),\n                                 value, tmp + 1);\n            return -1;\n        }\n        virReportSystemError(errno,\n                             _(\"Unable to write to '%s'\"), path);\n        return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_INVALID",
            "\"%s\"",
            "_(\"blkio device weight is valid only for cfq scheduler\")"
          ],
          "line": 1207
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"blkio device weight is valid only for cfq scheduler\""
          ],
          "line": 1208
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virFileExists",
          "args": [
            "path"
          ],
          "line": 1206
        },
        "resolved": true,
        "details": {
          "function_name": "virFileExists",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1873-1877",
          "snippet": "bool\nvirFileExists(const char *path)\n{\n    return access(path, F_OK) == 0;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nbool\nvirFileExists(const char *path)\n{\n    return access(path, F_OK) == 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupV1PathOfController",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_BLKIO",
            "\"blkio.weight_device\"",
            "&path"
          ],
          "line": 1201
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupV1PathOfController",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv1.c",
          "lines": "510-534",
          "snippet": "static int\nvirCgroupV1PathOfController(virCgroupPtr group,\n                            int controller,\n                            const char *key,\n                            char **path)\n{\n    if (group->legacy[controller].mountPoint == NULL) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"v1 controller '%s' is not mounted\"),\n                       virCgroupV1ControllerTypeToString(controller));\n        return -1;\n    }\n\n    if (group->legacy[controller].placement == NULL) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"v1 controller '%s' is not enabled for group\"),\n                       virCgroupV1ControllerTypeToString(controller));\n        return -1;\n    }\n\n    *path = g_strdup_printf(\"%s%s/%s\", group->legacy[controller].mountPoint,\n                            group->legacy[controller].placement, NULLSTR_EMPTY(key));\n\n    return 0;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"vircgroupv1.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"vircgroup.h\"",
            "#include \"vircgrouppriv.h\"",
            "#include \"internal.h\"",
            "# include <sys/mount.h>",
            "# include <sys/stat.h>",
            "# include <mntent.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"vircgroupv1.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <sys/stat.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV1PathOfController(virCgroupPtr group,\n                            int controller,\n                            const char *key,\n                            char **path)\n{\n    if (group->legacy[controller].mountPoint == NULL) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"v1 controller '%s' is not mounted\"),\n                       virCgroupV1ControllerTypeToString(controller));\n        return -1;\n    }\n\n    if (group->legacy[controller].placement == NULL) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"v1 controller '%s' is not enabled for group\"),\n                       virCgroupV1ControllerTypeToString(controller));\n        return -1;\n    }\n\n    *path = g_strdup_printf(\"%s%s/%s\", group->legacy[controller].mountPoint,\n                            group->legacy[controller].placement, NULLSTR_EMPTY(key));\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupGetBlockDevString",
          "args": [
            "devPath"
          ],
          "line": 1196
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupGetBlockDevString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "423-448",
          "snippet": "char *\nvirCgroupGetBlockDevString(const char *path)\n{\n    char *ret = NULL;\n    struct stat sb;\n\n    if (stat(path, &sb) < 0) {\n        virReportSystemError(errno,\n                             _(\"Path '%s' is not accessible\"),\n                             path);\n        return NULL;\n    }\n\n    if (!S_ISBLK(sb.st_mode)) {\n        virReportSystemError(EINVAL,\n                             _(\"Path '%s' must be a block device\"),\n                             path);\n        return NULL;\n    }\n\n    /* Automatically append space after the string since all callers\n     * use it anyway */\n    ret = g_strdup_printf(\"%d:%d \", major(sb.st_rdev), minor(sb.st_rdev));\n\n    return ret;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nchar *\nvirCgroupGetBlockDevString(const char *path)\n{\n    char *ret = NULL;\n    struct stat sb;\n\n    if (stat(path, &sb) < 0) {\n        virReportSystemError(errno,\n                             _(\"Path '%s' is not accessible\"),\n                             path);\n        return NULL;\n    }\n\n    if (!S_ISBLK(sb.st_mode)) {\n        virReportSystemError(EINVAL,\n                             _(\"Path '%s' must be a block device\"),\n                             path);\n        return NULL;\n    }\n\n    /* Automatically append space after the string since all callers\n     * use it anyway */\n    ret = g_strdup_printf(\"%d:%d \", major(sb.st_rdev), minor(sb.st_rdev));\n\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"vircgroupv1.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <sys/stat.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV1SetBlkioDeviceWeight(virCgroupPtr group,\n                                const char *devPath,\n                                unsigned int weight)\n{\n    g_autofree char *str = NULL;\n    g_autofree char *blkstr = NULL;\n    g_autofree char *path = NULL;\n\n    if (!(blkstr = virCgroupGetBlockDevString(devPath)))\n        return -1;\n\n    str = g_strdup_printf(\"%s%d\", blkstr, weight);\n\n    if (virCgroupV1PathOfController(group, VIR_CGROUP_CONTROLLER_BLKIO,\n                                    \"blkio.weight_device\", &path) < 0) {\n        return -1;\n    }\n\n    if (!virFileExists(path)) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"blkio device weight is valid only for cfq scheduler\"));\n        return -1;\n    }\n\n    return virCgroupSetValueRaw(path, str);\n}"
  },
  {
    "function_name": "virCgroupV1GetBlkioIoDeviceServiced",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv1.c",
    "lines": "1098-1184",
    "snippet": "static int\nvirCgroupV1GetBlkioIoDeviceServiced(virCgroupPtr group,\n                                    const char *path,\n                                    long long *bytes_read,\n                                    long long *bytes_write,\n                                    long long *requests_read,\n                                    long long *requests_write)\n{\n    g_autofree char *str1 = NULL;\n    g_autofree char *str2 = NULL;\n    g_autofree char *str3 = NULL;\n    char *p1 = NULL;\n    char *p2 = NULL;\n    size_t i;\n\n    const char *value_names[] = {\n        \"Read \",\n        \"Write \"\n    };\n    long long *bytes_ptrs[] = {\n        bytes_read,\n        bytes_write\n    };\n    long long *requests_ptrs[] = {\n        requests_read,\n        requests_write\n    };\n\n    if (virCgroupGetValueStr(group,\n                             VIR_CGROUP_CONTROLLER_BLKIO,\n                             \"blkio.throttle.io_service_bytes\", &str1) < 0)\n        return -1;\n\n    if (virCgroupGetValueStr(group,\n                             VIR_CGROUP_CONTROLLER_BLKIO,\n                             \"blkio.throttle.io_serviced\", &str2) < 0)\n        return -1;\n\n    if (!(str3 = virCgroupGetBlockDevString(path)))\n        return -1;\n\n    if (!(p1 = strstr(str1, str3))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Cannot find byte stats for block device '%s'\"),\n                       str3);\n        return -1;\n    }\n\n    if (!(p2 = strstr(str2, str3))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Cannot find request stats for block device '%s'\"),\n                       str3);\n        return -1;\n    }\n\n    for (i = 0; i < G_N_ELEMENTS(value_names); i++) {\n        if (!(p1 = strstr(p1, value_names[i]))) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Cannot find byte %sstats for block device '%s'\"),\n                           value_names[i], str3);\n            return -1;\n        }\n\n        if (virStrToLong_ll(p1 + strlen(value_names[i]), &p1, 10, bytes_ptrs[i]) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Cannot parse %sstat '%s'\"),\n                           value_names[i], p1 + strlen(value_names[i]));\n            return -1;\n        }\n\n        if (!(p2 = strstr(p2, value_names[i]))) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Cannot find request %sstats for block device '%s'\"),\n                           value_names[i], str3);\n            return -1;\n        }\n\n        if (virStrToLong_ll(p2 + strlen(value_names[i]), &p2, 10, requests_ptrs[i]) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Cannot parse %sstat '%s'\"),\n                           value_names[i], p2 + strlen(value_names[i]));\n            return -1;\n        }\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"vircgroupv1.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <sys/stat.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Cannot parse %sstat '%s'\")",
            "value_names[i]",
            "p2 + strlen(value_names[i])"
          ],
          "line": 1176
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "value_names[i]"
          ],
          "line": 1178
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Cannot parse %sstat '%s'\""
          ],
          "line": 1177
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStrToLong_ll",
          "args": [
            "p2 + strlen(value_names[i])",
            "&p2",
            "10",
            "requests_ptrs[i]"
          ],
          "line": 1175
        },
        "resolved": true,
        "details": {
          "function_name": "virStrToLong_ll",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "526-542",
          "snippet": "int\nvirStrToLong_ll(char const *s, char **end_ptr, int base, long long *result)\n{\n    long long val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtoll(s, &p, base); /* exempt from syntax-check */\n    err = (errno || (!end_ptr && *p) || p == s);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToLong_ll(char const *s, char **end_ptr, int base, long long *result)\n{\n    long long val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtoll(s, &p, base); /* exempt from syntax-check */\n    err = (errno || (!end_ptr && *p) || p == s);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "value_names[i]"
          ],
          "line": 1175
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Cannot find request %sstats for block device '%s'\")",
            "value_names[i]",
            "str3"
          ],
          "line": 1169
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "p2",
            "value_names[i]"
          ],
          "line": 1168
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Cannot parse %sstat '%s'\")",
            "value_names[i]",
            "p1 + strlen(value_names[i])"
          ],
          "line": 1162
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "value_names[i]"
          ],
          "line": 1164
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "value_names[i]"
          ],
          "line": 1161
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Cannot find byte %sstats for block device '%s'\")",
            "value_names[i]",
            "str3"
          ],
          "line": 1155
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "p1",
            "value_names[i]"
          ],
          "line": 1154
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "G_N_ELEMENTS",
          "args": [
            "value_names"
          ],
          "line": 1153
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Cannot find request stats for block device '%s'\")",
            "str3"
          ],
          "line": 1147
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "str2",
            "str3"
          ],
          "line": 1146
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Cannot find byte stats for block device '%s'\")",
            "str3"
          ],
          "line": 1140
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "str1",
            "str3"
          ],
          "line": 1139
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCgroupGetBlockDevString",
          "args": [
            "path"
          ],
          "line": 1136
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupGetBlockDevString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "423-448",
          "snippet": "char *\nvirCgroupGetBlockDevString(const char *path)\n{\n    char *ret = NULL;\n    struct stat sb;\n\n    if (stat(path, &sb) < 0) {\n        virReportSystemError(errno,\n                             _(\"Path '%s' is not accessible\"),\n                             path);\n        return NULL;\n    }\n\n    if (!S_ISBLK(sb.st_mode)) {\n        virReportSystemError(EINVAL,\n                             _(\"Path '%s' must be a block device\"),\n                             path);\n        return NULL;\n    }\n\n    /* Automatically append space after the string since all callers\n     * use it anyway */\n    ret = g_strdup_printf(\"%d:%d \", major(sb.st_rdev), minor(sb.st_rdev));\n\n    return ret;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nchar *\nvirCgroupGetBlockDevString(const char *path)\n{\n    char *ret = NULL;\n    struct stat sb;\n\n    if (stat(path, &sb) < 0) {\n        virReportSystemError(errno,\n                             _(\"Path '%s' is not accessible\"),\n                             path);\n        return NULL;\n    }\n\n    if (!S_ISBLK(sb.st_mode)) {\n        virReportSystemError(EINVAL,\n                             _(\"Path '%s' must be a block device\"),\n                             path);\n        return NULL;\n    }\n\n    /* Automatically append space after the string since all callers\n     * use it anyway */\n    ret = g_strdup_printf(\"%d:%d \", major(sb.st_rdev), minor(sb.st_rdev));\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupGetValueStr",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_BLKIO",
            "\"blkio.throttle.io_serviced\"",
            "&str2"
          ],
          "line": 1131
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupGetValueStr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "514-526",
          "snippet": "int\nvirCgroupGetValueStr(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     char **value)\n{\n    g_autofree char *keypath = NULL;\n\n    if (virCgroupPathOfController(group, controller, key, &keypath) < 0)\n        return -1;\n\n    return virCgroupGetValueRaw(keypath, value);\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetValueStr(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     char **value)\n{\n    g_autofree char *keypath = NULL;\n\n    if (virCgroupPathOfController(group, controller, key, &keypath) < 0)\n        return -1;\n\n    return virCgroupGetValueRaw(keypath, value);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"vircgroupv1.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <sys/stat.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV1GetBlkioIoDeviceServiced(virCgroupPtr group,\n                                    const char *path,\n                                    long long *bytes_read,\n                                    long long *bytes_write,\n                                    long long *requests_read,\n                                    long long *requests_write)\n{\n    g_autofree char *str1 = NULL;\n    g_autofree char *str2 = NULL;\n    g_autofree char *str3 = NULL;\n    char *p1 = NULL;\n    char *p2 = NULL;\n    size_t i;\n\n    const char *value_names[] = {\n        \"Read \",\n        \"Write \"\n    };\n    long long *bytes_ptrs[] = {\n        bytes_read,\n        bytes_write\n    };\n    long long *requests_ptrs[] = {\n        requests_read,\n        requests_write\n    };\n\n    if (virCgroupGetValueStr(group,\n                             VIR_CGROUP_CONTROLLER_BLKIO,\n                             \"blkio.throttle.io_service_bytes\", &str1) < 0)\n        return -1;\n\n    if (virCgroupGetValueStr(group,\n                             VIR_CGROUP_CONTROLLER_BLKIO,\n                             \"blkio.throttle.io_serviced\", &str2) < 0)\n        return -1;\n\n    if (!(str3 = virCgroupGetBlockDevString(path)))\n        return -1;\n\n    if (!(p1 = strstr(str1, str3))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Cannot find byte stats for block device '%s'\"),\n                       str3);\n        return -1;\n    }\n\n    if (!(p2 = strstr(str2, str3))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Cannot find request stats for block device '%s'\"),\n                       str3);\n        return -1;\n    }\n\n    for (i = 0; i < G_N_ELEMENTS(value_names); i++) {\n        if (!(p1 = strstr(p1, value_names[i]))) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Cannot find byte %sstats for block device '%s'\"),\n                           value_names[i], str3);\n            return -1;\n        }\n\n        if (virStrToLong_ll(p1 + strlen(value_names[i]), &p1, 10, bytes_ptrs[i]) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Cannot parse %sstat '%s'\"),\n                           value_names[i], p1 + strlen(value_names[i]));\n            return -1;\n        }\n\n        if (!(p2 = strstr(p2, value_names[i]))) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Cannot find request %sstats for block device '%s'\"),\n                           value_names[i], str3);\n            return -1;\n        }\n\n        if (virStrToLong_ll(p2 + strlen(value_names[i]), &p2, 10, requests_ptrs[i]) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Cannot parse %sstat '%s'\"),\n                           value_names[i], p2 + strlen(value_names[i]));\n            return -1;\n        }\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virCgroupV1GetBlkioIoServiced",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv1.c",
    "lines": "1004-1095",
    "snippet": "static int\nvirCgroupV1GetBlkioIoServiced(virCgroupPtr group,\n                              long long *bytes_read,\n                              long long *bytes_write,\n                              long long *requests_read,\n                              long long *requests_write)\n{\n    long long stats_val;\n    g_autofree char *str1 = NULL;\n    g_autofree char *str2 = NULL;\n    char *p1 = NULL;\n    char *p2 = NULL;\n    size_t i;\n\n    const char *value_names[] = {\n        \"Read \",\n        \"Write \"\n    };\n    long long *bytes_ptrs[] = {\n        bytes_read,\n        bytes_write\n    };\n    long long *requests_ptrs[] = {\n        requests_read,\n        requests_write\n    };\n\n    *bytes_read = 0;\n    *bytes_write = 0;\n    *requests_read = 0;\n    *requests_write = 0;\n\n    if (virCgroupGetValueStr(group,\n                             VIR_CGROUP_CONTROLLER_BLKIO,\n                             \"blkio.throttle.io_service_bytes\", &str1) < 0)\n        return -1;\n\n    if (virCgroupGetValueStr(group,\n                             VIR_CGROUP_CONTROLLER_BLKIO,\n                             \"blkio.throttle.io_serviced\", &str2) < 0)\n        return -1;\n\n    /* sum up all entries of the same kind, from all devices */\n    for (i = 0; i < G_N_ELEMENTS(value_names); i++) {\n        p1 = str1;\n        p2 = str2;\n\n        while ((p1 = strstr(p1, value_names[i]))) {\n            p1 += strlen(value_names[i]);\n            if (virStrToLong_ll(p1, &p1, 10, &stats_val) < 0) {\n                virReportError(VIR_ERR_INTERNAL_ERROR,\n                               _(\"Cannot parse byte %sstat '%s'\"),\n                               value_names[i],\n                               p1);\n                return -1;\n            }\n\n            if (stats_val < 0 ||\n                (stats_val > 0 && *bytes_ptrs[i] > (LLONG_MAX - stats_val)))\n            {\n                virReportError(VIR_ERR_OVERFLOW,\n                               _(\"Sum of byte %sstat overflows\"),\n                               value_names[i]);\n                return -1;\n            }\n            *bytes_ptrs[i] += stats_val;\n        }\n\n        while ((p2 = strstr(p2, value_names[i]))) {\n            p2 += strlen(value_names[i]);\n            if (virStrToLong_ll(p2, &p2, 10, &stats_val) < 0) {\n                virReportError(VIR_ERR_INTERNAL_ERROR,\n                               _(\"Cannot parse %srequest stat '%s'\"),\n                               value_names[i],\n                               p2);\n                return -1;\n            }\n\n            if (stats_val < 0 ||\n                (stats_val > 0 && *requests_ptrs[i] > (LLONG_MAX - stats_val)))\n            {\n                virReportError(VIR_ERR_OVERFLOW,\n                               _(\"Sum of %srequest stat overflows\"),\n                               value_names[i]);\n                return -1;\n            }\n            *requests_ptrs[i] += stats_val;\n        }\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"vircgroupv1.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <sys/stat.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OVERFLOW",
            "_(\"Sum of %srequest stat overflows\")",
            "value_names[i]"
          ],
          "line": 1085
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Sum of %srequest stat overflows\""
          ],
          "line": 1086
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Cannot parse %srequest stat '%s'\")",
            "value_names[i]",
            "p2"
          ],
          "line": 1075
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStrToLong_ll",
          "args": [
            "p2",
            "&p2",
            "10",
            "&stats_val"
          ],
          "line": 1074
        },
        "resolved": true,
        "details": {
          "function_name": "virStrToLong_ll",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "526-542",
          "snippet": "int\nvirStrToLong_ll(char const *s, char **end_ptr, int base, long long *result)\n{\n    long long val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtoll(s, &p, base); /* exempt from syntax-check */\n    err = (errno || (!end_ptr && *p) || p == s);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToLong_ll(char const *s, char **end_ptr, int base, long long *result)\n{\n    long long val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtoll(s, &p, base); /* exempt from syntax-check */\n    err = (errno || (!end_ptr && *p) || p == s);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "value_names[i]"
          ],
          "line": 1073
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "p2",
            "value_names[i]"
          ],
          "line": 1072
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OVERFLOW",
            "_(\"Sum of byte %sstat overflows\")",
            "value_names[i]"
          ],
          "line": 1064
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Cannot parse byte %sstat '%s'\")",
            "value_names[i]",
            "p1"
          ],
          "line": 1054
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "value_names[i]"
          ],
          "line": 1052
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "p1",
            "value_names[i]"
          ],
          "line": 1051
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "G_N_ELEMENTS",
          "args": [
            "value_names"
          ],
          "line": 1047
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCgroupGetValueStr",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_BLKIO",
            "\"blkio.throttle.io_serviced\"",
            "&str2"
          ],
          "line": 1041
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupGetValueStr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "514-526",
          "snippet": "int\nvirCgroupGetValueStr(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     char **value)\n{\n    g_autofree char *keypath = NULL;\n\n    if (virCgroupPathOfController(group, controller, key, &keypath) < 0)\n        return -1;\n\n    return virCgroupGetValueRaw(keypath, value);\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetValueStr(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     char **value)\n{\n    g_autofree char *keypath = NULL;\n\n    if (virCgroupPathOfController(group, controller, key, &keypath) < 0)\n        return -1;\n\n    return virCgroupGetValueRaw(keypath, value);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"vircgroupv1.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <sys/stat.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV1GetBlkioIoServiced(virCgroupPtr group,\n                              long long *bytes_read,\n                              long long *bytes_write,\n                              long long *requests_read,\n                              long long *requests_write)\n{\n    long long stats_val;\n    g_autofree char *str1 = NULL;\n    g_autofree char *str2 = NULL;\n    char *p1 = NULL;\n    char *p2 = NULL;\n    size_t i;\n\n    const char *value_names[] = {\n        \"Read \",\n        \"Write \"\n    };\n    long long *bytes_ptrs[] = {\n        bytes_read,\n        bytes_write\n    };\n    long long *requests_ptrs[] = {\n        requests_read,\n        requests_write\n    };\n\n    *bytes_read = 0;\n    *bytes_write = 0;\n    *requests_read = 0;\n    *requests_write = 0;\n\n    if (virCgroupGetValueStr(group,\n                             VIR_CGROUP_CONTROLLER_BLKIO,\n                             \"blkio.throttle.io_service_bytes\", &str1) < 0)\n        return -1;\n\n    if (virCgroupGetValueStr(group,\n                             VIR_CGROUP_CONTROLLER_BLKIO,\n                             \"blkio.throttle.io_serviced\", &str2) < 0)\n        return -1;\n\n    /* sum up all entries of the same kind, from all devices */\n    for (i = 0; i < G_N_ELEMENTS(value_names); i++) {\n        p1 = str1;\n        p2 = str2;\n\n        while ((p1 = strstr(p1, value_names[i]))) {\n            p1 += strlen(value_names[i]);\n            if (virStrToLong_ll(p1, &p1, 10, &stats_val) < 0) {\n                virReportError(VIR_ERR_INTERNAL_ERROR,\n                               _(\"Cannot parse byte %sstat '%s'\"),\n                               value_names[i],\n                               p1);\n                return -1;\n            }\n\n            if (stats_val < 0 ||\n                (stats_val > 0 && *bytes_ptrs[i] > (LLONG_MAX - stats_val)))\n            {\n                virReportError(VIR_ERR_OVERFLOW,\n                               _(\"Sum of byte %sstat overflows\"),\n                               value_names[i]);\n                return -1;\n            }\n            *bytes_ptrs[i] += stats_val;\n        }\n\n        while ((p2 = strstr(p2, value_names[i]))) {\n            p2 += strlen(value_names[i]);\n            if (virStrToLong_ll(p2, &p2, 10, &stats_val) < 0) {\n                virReportError(VIR_ERR_INTERNAL_ERROR,\n                               _(\"Cannot parse %srequest stat '%s'\"),\n                               value_names[i],\n                               p2);\n                return -1;\n            }\n\n            if (stats_val < 0 ||\n                (stats_val > 0 && *requests_ptrs[i] > (LLONG_MAX - stats_val)))\n            {\n                virReportError(VIR_ERR_OVERFLOW,\n                               _(\"Sum of %srequest stat overflows\"),\n                               value_names[i]);\n                return -1;\n            }\n            *requests_ptrs[i] += stats_val;\n        }\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virCgroupV1GetBlkioWeight",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv1.c",
    "lines": "963-1001",
    "snippet": "static int\nvirCgroupV1GetBlkioWeight(virCgroupPtr group,\n                          unsigned int *weight)\n{\n    g_autofree char *path = NULL;\n    g_autofree char *value = NULL;\n\n    if (virCgroupV1PathOfController(group, VIR_CGROUP_CONTROLLER_BLKIO,\n                                    \"blkio.bfq.weight\", &path) < 0) {\n        return -1;\n    }\n\n    if (!virFileExists(path)) {\n        VIR_FREE(path);\n\n        if (virCgroupV1PathOfController(group, VIR_CGROUP_CONTROLLER_BLKIO,\n                                        \"blkio.weight\", &path) < 0) {\n            return -1;\n        }\n    }\n\n    if (!virFileExists(path)) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"blkio device weight is valid only for bfq or cfq scheduler\"));\n        return -1;\n    }\n\n    if (virCgroupGetValueRaw(path, &value) < 0)\n        return -1;\n\n    if (virStrToLong_ui(value, NULL, 10, weight) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Unable to parse '%s' as an integer\"),\n                       value);\n        return -1;\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"vircgroupv1.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <sys/stat.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Unable to parse '%s' as an integer\")",
            "value"
          ],
          "line": 994
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to parse '%s' as an integer\""
          ],
          "line": 995
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStrToLong_ui",
          "args": [
            "value",
            "NULL",
            "10",
            "weight"
          ],
          "line": 993
        },
        "resolved": true,
        "details": {
          "function_name": "virStrToLong_uip",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "444-461",
          "snippet": "int\nvirStrToLong_uip(char const *s, char **end_ptr, int base, unsigned int *result)\n{\n    unsigned long int val;\n    char *p;\n    bool err = false;\n\n    errno = 0;\n    val = strtoul(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s || (unsigned int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToLong_uip(char const *s, char **end_ptr, int base, unsigned int *result)\n{\n    unsigned long int val;\n    char *p;\n    bool err = false;\n\n    errno = 0;\n    val = strtoul(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s || (unsigned int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupGetValueRaw",
          "args": [
            "path",
            "&value"
          ],
          "line": 990
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupGetValueRaw",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "475-496",
          "snippet": "int\nvirCgroupGetValueRaw(const char *path,\n                     char **value)\n{\n    int rc;\n\n    *value = NULL;\n\n    VIR_DEBUG(\"Get value %s\", path);\n\n    if ((rc = virFileReadAll(path, 1024*1024, value)) < 0) {\n        virReportSystemError(errno,\n                             _(\"Unable to read from '%s'\"), path);\n        return -1;\n    }\n\n    /* Terminated with '\\n' has sometimes harmful effects to the caller */\n    if (rc > 0 && (*value)[rc - 1] == '\\n')\n        (*value)[rc - 1] = '\\0';\n\n    return 0;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetValueRaw(const char *path,\n                     char **value)\n{\n    int rc;\n\n    *value = NULL;\n\n    VIR_DEBUG(\"Get value %s\", path);\n\n    if ((rc = virFileReadAll(path, 1024*1024, value)) < 0) {\n        virReportSystemError(errno,\n                             _(\"Unable to read from '%s'\"), path);\n        return -1;\n    }\n\n    /* Terminated with '\\n' has sometimes harmful effects to the caller */\n    if (rc > 0 && (*value)[rc - 1] == '\\n')\n        (*value)[rc - 1] = '\\0';\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_INVALID",
            "\"%s\"",
            "_(\"blkio device weight is valid only for bfq or cfq scheduler\")"
          ],
          "line": 985
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virFileExists",
          "args": [
            "path"
          ],
          "line": 984
        },
        "resolved": true,
        "details": {
          "function_name": "virFileExists",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1873-1877",
          "snippet": "bool\nvirFileExists(const char *path)\n{\n    return access(path, F_OK) == 0;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nbool\nvirFileExists(const char *path)\n{\n    return access(path, F_OK) == 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupV1PathOfController",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_BLKIO",
            "\"blkio.weight\"",
            "&path"
          ],
          "line": 978
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupV1PathOfController",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv1.c",
          "lines": "510-534",
          "snippet": "static int\nvirCgroupV1PathOfController(virCgroupPtr group,\n                            int controller,\n                            const char *key,\n                            char **path)\n{\n    if (group->legacy[controller].mountPoint == NULL) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"v1 controller '%s' is not mounted\"),\n                       virCgroupV1ControllerTypeToString(controller));\n        return -1;\n    }\n\n    if (group->legacy[controller].placement == NULL) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"v1 controller '%s' is not enabled for group\"),\n                       virCgroupV1ControllerTypeToString(controller));\n        return -1;\n    }\n\n    *path = g_strdup_printf(\"%s%s/%s\", group->legacy[controller].mountPoint,\n                            group->legacy[controller].placement, NULLSTR_EMPTY(key));\n\n    return 0;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"vircgroupv1.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"vircgroup.h\"",
            "#include \"vircgrouppriv.h\"",
            "#include \"internal.h\"",
            "# include <sys/mount.h>",
            "# include <sys/stat.h>",
            "# include <mntent.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"vircgroupv1.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <sys/stat.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV1PathOfController(virCgroupPtr group,\n                            int controller,\n                            const char *key,\n                            char **path)\n{\n    if (group->legacy[controller].mountPoint == NULL) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"v1 controller '%s' is not mounted\"),\n                       virCgroupV1ControllerTypeToString(controller));\n        return -1;\n    }\n\n    if (group->legacy[controller].placement == NULL) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"v1 controller '%s' is not enabled for group\"),\n                       virCgroupV1ControllerTypeToString(controller));\n        return -1;\n    }\n\n    *path = g_strdup_printf(\"%s%s/%s\", group->legacy[controller].mountPoint,\n                            group->legacy[controller].placement, NULLSTR_EMPTY(key));\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "path"
          ],
          "line": 976
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"vircgroupv1.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <sys/stat.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV1GetBlkioWeight(virCgroupPtr group,\n                          unsigned int *weight)\n{\n    g_autofree char *path = NULL;\n    g_autofree char *value = NULL;\n\n    if (virCgroupV1PathOfController(group, VIR_CGROUP_CONTROLLER_BLKIO,\n                                    \"blkio.bfq.weight\", &path) < 0) {\n        return -1;\n    }\n\n    if (!virFileExists(path)) {\n        VIR_FREE(path);\n\n        if (virCgroupV1PathOfController(group, VIR_CGROUP_CONTROLLER_BLKIO,\n                                        \"blkio.weight\", &path) < 0) {\n            return -1;\n        }\n    }\n\n    if (!virFileExists(path)) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"blkio device weight is valid only for bfq or cfq scheduler\"));\n        return -1;\n    }\n\n    if (virCgroupGetValueRaw(path, &value) < 0)\n        return -1;\n\n    if (virStrToLong_ui(value, NULL, 10, weight) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Unable to parse '%s' as an integer\"),\n                       value);\n        return -1;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virCgroupV1SetBlkioWeight",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv1.c",
    "lines": "930-960",
    "snippet": "static int\nvirCgroupV1SetBlkioWeight(virCgroupPtr group,\n                          unsigned int weight)\n{\n    g_autofree char *path = NULL;\n    g_autofree char *value = NULL;\n\n    if (virCgroupV1PathOfController(group, VIR_CGROUP_CONTROLLER_BLKIO,\n                                    \"blkio.bfq.weight\", &path) < 0) {\n        return -1;\n    }\n\n    if (!virFileExists(path)) {\n        VIR_FREE(path);\n\n        if (virCgroupV1PathOfController(group, VIR_CGROUP_CONTROLLER_BLKIO,\n                                        \"blkio.weight\", &path) < 0) {\n            return -1;\n        }\n    }\n\n    if (!virFileExists(path)) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"blkio device weight is valid only for bfq or cfq scheduler\"));\n        return -1;\n    }\n\n    value = g_strdup_printf(\"%u\", weight);\n\n    return virCgroupSetValueRaw(path, value);\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"vircgroupv1.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <sys/stat.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCgroupSetValueRaw",
          "args": [
            "path",
            "value"
          ],
          "line": 959
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupSetValueRaw",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "451-472",
          "snippet": "int\nvirCgroupSetValueRaw(const char *path,\n                     const char *value)\n{\n    char *tmp;\n\n    VIR_DEBUG(\"Set value '%s' to '%s'\", path, value);\n    if (virFileWriteStr(path, value, 0) < 0) {\n        if (errno == EINVAL &&\n            (tmp = strrchr(path, '/'))) {\n            virReportSystemError(errno,\n                                 _(\"Invalid value '%s' for '%s'\"),\n                                 value, tmp + 1);\n            return -1;\n        }\n        virReportSystemError(errno,\n                             _(\"Unable to write to '%s'\"), path);\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupSetValueRaw(const char *path,\n                     const char *value)\n{\n    char *tmp;\n\n    VIR_DEBUG(\"Set value '%s' to '%s'\", path, value);\n    if (virFileWriteStr(path, value, 0) < 0) {\n        if (errno == EINVAL &&\n            (tmp = strrchr(path, '/'))) {\n            virReportSystemError(errno,\n                                 _(\"Invalid value '%s' for '%s'\"),\n                                 value, tmp + 1);\n            return -1;\n        }\n        virReportSystemError(errno,\n                             _(\"Unable to write to '%s'\"), path);\n        return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"%u\"",
            "weight"
          ],
          "line": 957
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_INVALID",
            "\"%s\"",
            "_(\"blkio device weight is valid only for bfq or cfq scheduler\")"
          ],
          "line": 952
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virFileExists",
          "args": [
            "path"
          ],
          "line": 951
        },
        "resolved": true,
        "details": {
          "function_name": "virFileExists",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1873-1877",
          "snippet": "bool\nvirFileExists(const char *path)\n{\n    return access(path, F_OK) == 0;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nbool\nvirFileExists(const char *path)\n{\n    return access(path, F_OK) == 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupV1PathOfController",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_BLKIO",
            "\"blkio.weight\"",
            "&path"
          ],
          "line": 945
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupV1PathOfController",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv1.c",
          "lines": "510-534",
          "snippet": "static int\nvirCgroupV1PathOfController(virCgroupPtr group,\n                            int controller,\n                            const char *key,\n                            char **path)\n{\n    if (group->legacy[controller].mountPoint == NULL) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"v1 controller '%s' is not mounted\"),\n                       virCgroupV1ControllerTypeToString(controller));\n        return -1;\n    }\n\n    if (group->legacy[controller].placement == NULL) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"v1 controller '%s' is not enabled for group\"),\n                       virCgroupV1ControllerTypeToString(controller));\n        return -1;\n    }\n\n    *path = g_strdup_printf(\"%s%s/%s\", group->legacy[controller].mountPoint,\n                            group->legacy[controller].placement, NULLSTR_EMPTY(key));\n\n    return 0;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"vircgroupv1.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"vircgroup.h\"",
            "#include \"vircgrouppriv.h\"",
            "#include \"internal.h\"",
            "# include <sys/mount.h>",
            "# include <sys/stat.h>",
            "# include <mntent.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"vircgroupv1.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <sys/stat.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV1PathOfController(virCgroupPtr group,\n                            int controller,\n                            const char *key,\n                            char **path)\n{\n    if (group->legacy[controller].mountPoint == NULL) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"v1 controller '%s' is not mounted\"),\n                       virCgroupV1ControllerTypeToString(controller));\n        return -1;\n    }\n\n    if (group->legacy[controller].placement == NULL) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"v1 controller '%s' is not enabled for group\"),\n                       virCgroupV1ControllerTypeToString(controller));\n        return -1;\n    }\n\n    *path = g_strdup_printf(\"%s%s/%s\", group->legacy[controller].mountPoint,\n                            group->legacy[controller].placement, NULLSTR_EMPTY(key));\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "path"
          ],
          "line": 943
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"vircgroupv1.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <sys/stat.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV1SetBlkioWeight(virCgroupPtr group,\n                          unsigned int weight)\n{\n    g_autofree char *path = NULL;\n    g_autofree char *value = NULL;\n\n    if (virCgroupV1PathOfController(group, VIR_CGROUP_CONTROLLER_BLKIO,\n                                    \"blkio.bfq.weight\", &path) < 0) {\n        return -1;\n    }\n\n    if (!virFileExists(path)) {\n        VIR_FREE(path);\n\n        if (virCgroupV1PathOfController(group, VIR_CGROUP_CONTROLLER_BLKIO,\n                                        \"blkio.weight\", &path) < 0) {\n            return -1;\n        }\n    }\n\n    if (!virFileExists(path)) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"blkio device weight is valid only for bfq or cfq scheduler\"));\n        return -1;\n    }\n\n    value = g_strdup_printf(\"%u\", weight);\n\n    return virCgroupSetValueRaw(path, value);\n}"
  },
  {
    "function_name": "virCgroupV1SetOwner",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv1.c",
    "lines": "870-927",
    "snippet": "static int\nvirCgroupV1SetOwner(virCgroupPtr cgroup,\n                    uid_t uid,\n                    gid_t gid,\n                    int controllers)\n{\n    int ret = -1;\n    size_t i;\n    DIR *dh = NULL;\n    int direrr;\n\n    for (i = 0; i < VIR_CGROUP_CONTROLLER_LAST; i++) {\n        g_autofree char *base = NULL;\n        struct dirent *de;\n\n        if (!((1 << i) & controllers))\n            continue;\n\n        if (!cgroup->legacy[i].mountPoint)\n            continue;\n\n        base = g_strdup_printf(\"%s%s\", cgroup->legacy[i].mountPoint,\n                               cgroup->legacy[i].placement);\n\n        if (virDirOpen(&dh, base) < 0)\n            goto cleanup;\n\n        while ((direrr = virDirRead(dh, &de, base)) > 0) {\n            g_autofree char *entry = NULL;\n\n            entry = g_strdup_printf(\"%s/%s\", base, de->d_name);\n\n            if (chown(entry, uid, gid) < 0) {\n                virReportSystemError(errno,\n                                     _(\"cannot chown '%s' to (%u, %u)\"),\n                                     entry, uid, gid);\n                goto cleanup;\n            }\n        }\n        if (direrr < 0)\n            goto cleanup;\n\n        if (chown(base, uid, gid) < 0) {\n            virReportSystemError(errno,\n                                 _(\"cannot chown '%s' to (%u, %u)\"),\n                                 base, uid, gid);\n            goto cleanup;\n        }\n\n        VIR_DIR_CLOSE(dh);\n    }\n\n    ret = 0;\n\n cleanup:\n    VIR_DIR_CLOSE(dh);\n    return ret;\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"vircgroupv1.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <sys/stat.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_DIR_CLOSE",
          "args": [
            "dh"
          ],
          "line": 925
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DIR_CLOSE",
          "args": [
            "dh"
          ],
          "line": 919
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"cannot chown '%s' to (%u, %u)\")",
            "base",
            "uid",
            "gid"
          ],
          "line": 913
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"cannot chown '%s' to (%u, %u)\""
          ],
          "line": 914
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "chown",
          "args": [
            "base",
            "uid",
            "gid"
          ],
          "line": 912
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"cannot chown '%s' to (%u, %u)\")",
            "entry",
            "uid",
            "gid"
          ],
          "line": 903
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "chown",
          "args": [
            "entry",
            "uid",
            "gid"
          ],
          "line": 902
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDirRead",
          "args": [
            "dh",
            "&de",
            "base"
          ],
          "line": 897
        },
        "resolved": true,
        "details": {
          "function_name": "virDirRead",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "2940-2954",
          "snippet": "int virDirRead(DIR *dirp, struct dirent **ent, const char *name)\n{\n    do {\n        errno = 0;\n        *ent = readdir(dirp); /* exempt from syntax-check */\n        if (!*ent && errno) {\n            if (name)\n                virReportSystemError(errno, _(\"Unable to read directory '%s'\"),\n                                     name);\n            return -1;\n        }\n    } while (*ent && (STREQ((*ent)->d_name, \".\") ||\n                      STREQ((*ent)->d_name, \"..\")));\n    return !!*ent;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint virDirRead(DIR *dirp, struct dirent **ent, const char *name)\n{\n    do {\n        errno = 0;\n        *ent = readdir(dirp); /* exempt from syntax-check */\n        if (!*ent && errno) {\n            if (name)\n                virReportSystemError(errno, _(\"Unable to read directory '%s'\"),\n                                     name);\n            return -1;\n        }\n    } while (*ent && (STREQ((*ent)->d_name, \".\") ||\n                      STREQ((*ent)->d_name, \"..\")));\n    return !!*ent;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDirOpen",
          "args": [
            "&dh",
            "base"
          ],
          "line": 894
        },
        "resolved": true,
        "details": {
          "function_name": "virDirOpenQuiet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "2914-2918",
          "snippet": "int\nvirDirOpenQuiet(DIR **dirp, const char *name)\n{\n    return virDirOpenInternal(dirp, name, false, true);\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirDirOpenQuiet(DIR **dirp, const char *name)\n{\n    return virDirOpenInternal(dirp, name, false, true);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"vircgroupv1.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <sys/stat.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV1SetOwner(virCgroupPtr cgroup,\n                    uid_t uid,\n                    gid_t gid,\n                    int controllers)\n{\n    int ret = -1;\n    size_t i;\n    DIR *dh = NULL;\n    int direrr;\n\n    for (i = 0; i < VIR_CGROUP_CONTROLLER_LAST; i++) {\n        g_autofree char *base = NULL;\n        struct dirent *de;\n\n        if (!((1 << i) & controllers))\n            continue;\n\n        if (!cgroup->legacy[i].mountPoint)\n            continue;\n\n        base = g_strdup_printf(\"%s%s\", cgroup->legacy[i].mountPoint,\n                               cgroup->legacy[i].placement);\n\n        if (virDirOpen(&dh, base) < 0)\n            goto cleanup;\n\n        while ((direrr = virDirRead(dh, &de, base)) > 0) {\n            g_autofree char *entry = NULL;\n\n            entry = g_strdup_printf(\"%s/%s\", base, de->d_name);\n\n            if (chown(entry, uid, gid) < 0) {\n                virReportSystemError(errno,\n                                     _(\"cannot chown '%s' to (%u, %u)\"),\n                                     entry, uid, gid);\n                goto cleanup;\n            }\n        }\n        if (direrr < 0)\n            goto cleanup;\n\n        if (chown(base, uid, gid) < 0) {\n            virReportSystemError(errno,\n                                 _(\"cannot chown '%s' to (%u, %u)\"),\n                                 base, uid, gid);\n            goto cleanup;\n        }\n\n        VIR_DIR_CLOSE(dh);\n    }\n\n    ret = 0;\n\n cleanup:\n    VIR_DIR_CLOSE(dh);\n    return ret;\n}"
  },
  {
    "function_name": "virCgroupV1BindMount",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv1.c",
    "lines": "795-867",
    "snippet": "static int\nvirCgroupV1BindMount(virCgroupPtr group,\n                     const char *oldroot,\n                     const char *mountopts)\n{\n    size_t i;\n    g_autofree char *opts = NULL;\n    g_autofree char *root = NULL;\n\n    if (!(root = virCgroupV1IdentifyRoot(group)))\n        return -1;\n\n    VIR_DEBUG(\"Mounting cgroups at '%s'\", root);\n\n    if (virFileMakePath(root) < 0) {\n        virReportSystemError(errno,\n                             _(\"Unable to create directory %s\"),\n                             root);\n        return -1;\n    }\n\n    opts = g_strdup_printf(\"mode=755,size=65536%s\", mountopts);\n\n    if (mount(\"tmpfs\", root, \"tmpfs\", MS_NOSUID|MS_NODEV|MS_NOEXEC, opts) < 0) {\n        virReportSystemError(errno,\n                             _(\"Failed to mount %s on %s type %s\"),\n                             \"tmpfs\", root, \"tmpfs\");\n        return -1;\n    }\n\n    for (i = 0; i < VIR_CGROUP_CONTROLLER_LAST; i++) {\n        if (!group->legacy[i].mountPoint)\n            continue;\n\n        if (!virFileExists(group->legacy[i].mountPoint)) {\n            g_autofree char *src = NULL;\n            src = g_strdup_printf(\"%s%s\", oldroot, group->legacy[i].mountPoint);\n\n            VIR_DEBUG(\"Create mount point '%s'\",\n                      group->legacy[i].mountPoint);\n            if (virFileMakePath(group->legacy[i].mountPoint) < 0) {\n                virReportSystemError(errno,\n                                     _(\"Unable to create directory %s\"),\n                                     group->legacy[i].mountPoint);\n                return -1;\n            }\n\n            if (mount(src, group->legacy[i].mountPoint, \"none\", MS_BIND,\n                      NULL) < 0) {\n                virReportSystemError(errno,\n                                     _(\"Failed to bind cgroup '%s' on '%s'\"),\n                                     src, group->legacy[i].mountPoint);\n                return -1;\n            }\n        }\n\n        if (group->legacy[i].linkPoint) {\n            VIR_DEBUG(\"Link mount point '%s' to '%s'\",\n                      group->legacy[i].mountPoint,\n                      group->legacy[i].linkPoint);\n            if (symlink(group->legacy[i].mountPoint,\n                        group->legacy[i].linkPoint) < 0) {\n                virReportSystemError(errno,\n                                     _(\"Unable to symlink directory %s to %s\"),\n                                     group->legacy[i].mountPoint,\n                                     group->legacy[i].linkPoint);\n                return -1;\n            }\n        }\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"vircgroupv1.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <sys/stat.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"Unable to symlink directory %s to %s\")",
            "group->legacy[i].mountPoint",
            "group->legacy[i].linkPoint"
          ],
          "line": 857
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to symlink directory %s to %s\""
          ],
          "line": 858
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "symlink",
          "args": [
            "group->legacy[i].mountPoint",
            "group->legacy[i].linkPoint"
          ],
          "line": 855
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Link mount point '%s' to '%s'\"",
            "group->legacy[i].mountPoint",
            "group->legacy[i].linkPoint"
          ],
          "line": 852
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"Failed to bind cgroup '%s' on '%s'\")",
            "src",
            "group->legacy[i].mountPoint"
          ],
          "line": 844
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mount",
          "args": [
            "src",
            "group->legacy[i].mountPoint",
            "\"none\"",
            "MS_BIND",
            "NULL"
          ],
          "line": 842
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"Unable to create directory %s\")",
            "group->legacy[i].mountPoint"
          ],
          "line": 836
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virFileMakePath",
          "args": [
            "group->legacy[i].mountPoint"
          ],
          "line": 835
        },
        "resolved": true,
        "details": {
          "function_name": "virFileMakePath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "3076-3080",
          "snippet": "int\nvirFileMakePath(const char *path)\n{\n    return virFileMakePathWithMode(path, 0777);\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileMakePath(const char *path)\n{\n    return virFileMakePathWithMode(path, 0777);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Create mount point '%s'\"",
            "group->legacy[i].mountPoint"
          ],
          "line": 833
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virFileExists",
          "args": [
            "group->legacy[i].mountPoint"
          ],
          "line": 829
        },
        "resolved": true,
        "details": {
          "function_name": "virFileExists",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1873-1877",
          "snippet": "bool\nvirFileExists(const char *path)\n{\n    return access(path, F_OK) == 0;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nbool\nvirFileExists(const char *path)\n{\n    return access(path, F_OK) == 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"Failed to mount %s on %s type %s\")",
            "\"tmpfs\"",
            "root",
            "\"tmpfs\""
          ],
          "line": 819
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mount",
          "args": [
            "\"tmpfs\"",
            "root",
            "\"tmpfs\"",
            "MS_NOSUID|MS_NODEV|MS_NOEXEC",
            "opts"
          ],
          "line": 818
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"Unable to create directory %s\")",
            "root"
          ],
          "line": 810
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Mounting cgroups at '%s'\"",
            "root"
          ],
          "line": 807
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCgroupV1IdentifyRoot",
          "args": [
            "group"
          ],
          "line": 804
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupV1IdentifyRoot",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv1.c",
          "lines": "767-792",
          "snippet": "static char *\nvirCgroupV1IdentifyRoot(virCgroupPtr group)\n{\n    char *ret = NULL;\n    size_t i;\n\n    for (i = 0; i < VIR_CGROUP_CONTROLLER_LAST; i++) {\n        char *tmp;\n        if (!group->legacy[i].mountPoint)\n            continue;\n        if (!(tmp = strrchr(group->legacy[i].mountPoint, '/'))) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Could not find directory separator in %s\"),\n                           group->legacy[i].mountPoint);\n            return NULL;\n        }\n\n        ret = g_strndup(group->legacy[i].mountPoint,\n                        tmp - group->legacy[i].mountPoint);\n        return ret;\n    }\n\n    virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                   _(\"Could not find any mounted v1 controllers\"));\n    return NULL;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"vircgroupv1.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"vircgroup.h\"",
            "#include \"vircgrouppriv.h\"",
            "#include \"internal.h\"",
            "# include <sys/mount.h>",
            "# include <sys/stat.h>",
            "# include <mntent.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"vircgroupv1.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <sys/stat.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic char *\nvirCgroupV1IdentifyRoot(virCgroupPtr group)\n{\n    char *ret = NULL;\n    size_t i;\n\n    for (i = 0; i < VIR_CGROUP_CONTROLLER_LAST; i++) {\n        char *tmp;\n        if (!group->legacy[i].mountPoint)\n            continue;\n        if (!(tmp = strrchr(group->legacy[i].mountPoint, '/'))) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Could not find directory separator in %s\"),\n                           group->legacy[i].mountPoint);\n            return NULL;\n        }\n\n        ret = g_strndup(group->legacy[i].mountPoint,\n                        tmp - group->legacy[i].mountPoint);\n        return ret;\n    }\n\n    virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                   _(\"Could not find any mounted v1 controllers\"));\n    return NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"vircgroupv1.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <sys/stat.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV1BindMount(virCgroupPtr group,\n                     const char *oldroot,\n                     const char *mountopts)\n{\n    size_t i;\n    g_autofree char *opts = NULL;\n    g_autofree char *root = NULL;\n\n    if (!(root = virCgroupV1IdentifyRoot(group)))\n        return -1;\n\n    VIR_DEBUG(\"Mounting cgroups at '%s'\", root);\n\n    if (virFileMakePath(root) < 0) {\n        virReportSystemError(errno,\n                             _(\"Unable to create directory %s\"),\n                             root);\n        return -1;\n    }\n\n    opts = g_strdup_printf(\"mode=755,size=65536%s\", mountopts);\n\n    if (mount(\"tmpfs\", root, \"tmpfs\", MS_NOSUID|MS_NODEV|MS_NOEXEC, opts) < 0) {\n        virReportSystemError(errno,\n                             _(\"Failed to mount %s on %s type %s\"),\n                             \"tmpfs\", root, \"tmpfs\");\n        return -1;\n    }\n\n    for (i = 0; i < VIR_CGROUP_CONTROLLER_LAST; i++) {\n        if (!group->legacy[i].mountPoint)\n            continue;\n\n        if (!virFileExists(group->legacy[i].mountPoint)) {\n            g_autofree char *src = NULL;\n            src = g_strdup_printf(\"%s%s\", oldroot, group->legacy[i].mountPoint);\n\n            VIR_DEBUG(\"Create mount point '%s'\",\n                      group->legacy[i].mountPoint);\n            if (virFileMakePath(group->legacy[i].mountPoint) < 0) {\n                virReportSystemError(errno,\n                                     _(\"Unable to create directory %s\"),\n                                     group->legacy[i].mountPoint);\n                return -1;\n            }\n\n            if (mount(src, group->legacy[i].mountPoint, \"none\", MS_BIND,\n                      NULL) < 0) {\n                virReportSystemError(errno,\n                                     _(\"Failed to bind cgroup '%s' on '%s'\"),\n                                     src, group->legacy[i].mountPoint);\n                return -1;\n            }\n        }\n\n        if (group->legacy[i].linkPoint) {\n            VIR_DEBUG(\"Link mount point '%s' to '%s'\",\n                      group->legacy[i].mountPoint,\n                      group->legacy[i].linkPoint);\n            if (symlink(group->legacy[i].mountPoint,\n                        group->legacy[i].linkPoint) < 0) {\n                virReportSystemError(errno,\n                                     _(\"Unable to symlink directory %s to %s\"),\n                                     group->legacy[i].mountPoint,\n                                     group->legacy[i].linkPoint);\n                return -1;\n            }\n        }\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virCgroupV1IdentifyRoot",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv1.c",
    "lines": "767-792",
    "snippet": "static char *\nvirCgroupV1IdentifyRoot(virCgroupPtr group)\n{\n    char *ret = NULL;\n    size_t i;\n\n    for (i = 0; i < VIR_CGROUP_CONTROLLER_LAST; i++) {\n        char *tmp;\n        if (!group->legacy[i].mountPoint)\n            continue;\n        if (!(tmp = strrchr(group->legacy[i].mountPoint, '/'))) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Could not find directory separator in %s\"),\n                           group->legacy[i].mountPoint);\n            return NULL;\n        }\n\n        ret = g_strndup(group->legacy[i].mountPoint,\n                        tmp - group->legacy[i].mountPoint);\n        return ret;\n    }\n\n    virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                   _(\"Could not find any mounted v1 controllers\"));\n    return NULL;\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"vircgroupv1.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <sys/stat.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"Could not find any mounted v1 controllers\")"
          ],
          "line": 789
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Could not find any mounted v1 controllers\""
          ],
          "line": 790
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strndup",
          "args": [
            "group->legacy[i].mountPoint",
            "tmp - group->legacy[i].mountPoint"
          ],
          "line": 784
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Could not find directory separator in %s\")",
            "group->legacy[i].mountPoint"
          ],
          "line": 778
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strrchr",
          "args": [
            "group->legacy[i].mountPoint",
            "'/'"
          ],
          "line": 777
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"vircgroupv1.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <sys/stat.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic char *\nvirCgroupV1IdentifyRoot(virCgroupPtr group)\n{\n    char *ret = NULL;\n    size_t i;\n\n    for (i = 0; i < VIR_CGROUP_CONTROLLER_LAST; i++) {\n        char *tmp;\n        if (!group->legacy[i].mountPoint)\n            continue;\n        if (!(tmp = strrchr(group->legacy[i].mountPoint, '/'))) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Could not find directory separator in %s\"),\n                           group->legacy[i].mountPoint);\n            return NULL;\n        }\n\n        ret = g_strndup(group->legacy[i].mountPoint,\n                        tmp - group->legacy[i].mountPoint);\n        return ret;\n    }\n\n    virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                   _(\"Could not find any mounted v1 controllers\"));\n    return NULL;\n}"
  },
  {
    "function_name": "virCgroupV1KillRecursive",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv1.c",
    "lines": "752-764",
    "snippet": "static int\nvirCgroupV1KillRecursive(virCgroupPtr group,\n                         int signum,\n                         virHashTablePtr pids)\n{\n    int controller = virCgroupV1GetAnyController(group);\n\n    if (controller < 0)\n        return -1;\n\n    return virCgroupKillRecursiveInternal(group, signum, pids, controller,\n                                          \"tasks\", false);\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"vircgroupv1.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <sys/stat.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCgroupKillRecursiveInternal",
          "args": [
            "group",
            "signum",
            "pids",
            "controller",
            "\"tasks\"",
            "false"
          ],
          "line": 762
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupKillRecursiveInternal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "2510-2579",
          "snippet": "int\nvirCgroupKillRecursiveInternal(virCgroupPtr group,\n                               int signum,\n                               virHashTablePtr pids,\n                               int controller,\n                               const char *taskFile,\n                               bool dormdir)\n{\n    int ret = -1;\n    int rc;\n    bool killedAny = false;\n    g_autofree char *keypath = NULL;\n    DIR *dp = NULL;\n    virCgroupPtr subgroup = NULL;\n    struct dirent *ent;\n    int direrr;\n    VIR_DEBUG(\"group=%p path=%s signum=%d pids=%p\",\n              group, group->path, signum, pids);\n\n    if (virCgroupPathOfController(group, controller, \"\", &keypath) < 0)\n        return -1;\n\n    if ((rc = virCgroupKillInternal(group, signum, pids,\n                                    controller, taskFile)) < 0) {\n        goto cleanup;\n    }\n    if (rc == 1)\n        killedAny = true;\n\n    VIR_DEBUG(\"Iterate over children of %s (killedAny=%d)\", keypath, killedAny);\n    if ((rc = virDirOpenIfExists(&dp, keypath)) < 0)\n        goto cleanup;\n\n    if (rc == 0) {\n        VIR_DEBUG(\"Path %s does not exist, assuming done\", keypath);\n        killedAny = false;\n        goto done;\n    }\n\n    while ((direrr = virDirRead(dp, &ent, keypath)) > 0) {\n        if (ent->d_type != DT_DIR)\n            continue;\n\n        VIR_DEBUG(\"Process subdir %s\", ent->d_name);\n\n        if (virCgroupNew(-1, ent->d_name, group, -1, &subgroup) < 0)\n            goto cleanup;\n\n        if ((rc = virCgroupKillRecursiveInternal(subgroup, signum, pids,\n                                                 controller, taskFile, true)) < 0)\n            goto cleanup;\n        if (rc == 1)\n            killedAny = true;\n\n        if (dormdir)\n            virCgroupRemove(subgroup);\n\n        virCgroupFree(&subgroup);\n    }\n    if (direrr < 0)\n        goto cleanup;\n\n done:\n    ret = killedAny ? 1 : 0;\n\n cleanup:\n    virCgroupFree(&subgroup);\n    VIR_DIR_CLOSE(dp);\n    return ret;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupKillRecursiveInternal(virCgroupPtr group,\n                               int signum,\n                               virHashTablePtr pids,\n                               int controller,\n                               const char *taskFile,\n                               bool dormdir)\n{\n    int ret = -1;\n    int rc;\n    bool killedAny = false;\n    g_autofree char *keypath = NULL;\n    DIR *dp = NULL;\n    virCgroupPtr subgroup = NULL;\n    struct dirent *ent;\n    int direrr;\n    VIR_DEBUG(\"group=%p path=%s signum=%d pids=%p\",\n              group, group->path, signum, pids);\n\n    if (virCgroupPathOfController(group, controller, \"\", &keypath) < 0)\n        return -1;\n\n    if ((rc = virCgroupKillInternal(group, signum, pids,\n                                    controller, taskFile)) < 0) {\n        goto cleanup;\n    }\n    if (rc == 1)\n        killedAny = true;\n\n    VIR_DEBUG(\"Iterate over children of %s (killedAny=%d)\", keypath, killedAny);\n    if ((rc = virDirOpenIfExists(&dp, keypath)) < 0)\n        goto cleanup;\n\n    if (rc == 0) {\n        VIR_DEBUG(\"Path %s does not exist, assuming done\", keypath);\n        killedAny = false;\n        goto done;\n    }\n\n    while ((direrr = virDirRead(dp, &ent, keypath)) > 0) {\n        if (ent->d_type != DT_DIR)\n            continue;\n\n        VIR_DEBUG(\"Process subdir %s\", ent->d_name);\n\n        if (virCgroupNew(-1, ent->d_name, group, -1, &subgroup) < 0)\n            goto cleanup;\n\n        if ((rc = virCgroupKillRecursiveInternal(subgroup, signum, pids,\n                                                 controller, taskFile, true)) < 0)\n            goto cleanup;\n        if (rc == 1)\n            killedAny = true;\n\n        if (dormdir)\n            virCgroupRemove(subgroup);\n\n        virCgroupFree(&subgroup);\n    }\n    if (direrr < 0)\n        goto cleanup;\n\n done:\n    ret = killedAny ? 1 : 0;\n\n cleanup:\n    virCgroupFree(&subgroup);\n    VIR_DIR_CLOSE(dp);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupV1GetAnyController",
          "args": [
            "group"
          ],
          "line": 757
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupV1GetAnyController",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv1.c",
          "lines": "489-507",
          "snippet": "static int\nvirCgroupV1GetAnyController(virCgroupPtr group)\n{\n    size_t i;\n\n    for (i = 0; i < VIR_CGROUP_CONTROLLER_LAST; i++) {\n        /* Reject any controller with a placement\n         * of '/' to avoid doing bad stuff to the root\n         * cgroup\n         */\n        if (group->legacy[i].mountPoint &&\n            group->legacy[i].placement &&\n            STRNEQ(group->legacy[i].placement, \"/\")) {\n            return i;\n        }\n    }\n\n    return -1;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"vircgroupv1.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"vircgroup.h\"",
            "#include \"vircgrouppriv.h\"",
            "#include \"internal.h\"",
            "# include <sys/mount.h>",
            "# include <sys/stat.h>",
            "# include <mntent.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"vircgroupv1.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <sys/stat.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV1GetAnyController(virCgroupPtr group)\n{\n    size_t i;\n\n    for (i = 0; i < VIR_CGROUP_CONTROLLER_LAST; i++) {\n        /* Reject any controller with a placement\n         * of '/' to avoid doing bad stuff to the root\n         * cgroup\n         */\n        if (group->legacy[i].mountPoint &&\n            group->legacy[i].placement &&\n            STRNEQ(group->legacy[i].placement, \"/\")) {\n            return i;\n        }\n    }\n\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"vircgroupv1.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <sys/stat.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV1KillRecursive(virCgroupPtr group,\n                         int signum,\n                         virHashTablePtr pids)\n{\n    int controller = virCgroupV1GetAnyController(group);\n\n    if (controller < 0)\n        return -1;\n\n    return virCgroupKillRecursiveInternal(group, signum, pids, controller,\n                                          \"tasks\", false);\n}"
  },
  {
    "function_name": "virCgroupV1HasEmptyTasks",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv1.c",
    "lines": "733-749",
    "snippet": "static int\nvirCgroupV1HasEmptyTasks(virCgroupPtr cgroup,\n                         int controller)\n{\n    int ret = -1;\n    g_autofree char *content = NULL;\n\n    if (!cgroup)\n        return -1;\n\n    ret = virCgroupGetValueStr(cgroup, controller, \"tasks\", &content);\n\n    if (ret == 0 && content[0] == '\\0')\n        ret = 1;\n\n    return ret;\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"vircgroupv1.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <sys/stat.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCgroupGetValueStr",
          "args": [
            "cgroup",
            "controller",
            "\"tasks\"",
            "&content"
          ],
          "line": 743
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupGetValueStr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "514-526",
          "snippet": "int\nvirCgroupGetValueStr(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     char **value)\n{\n    g_autofree char *keypath = NULL;\n\n    if (virCgroupPathOfController(group, controller, key, &keypath) < 0)\n        return -1;\n\n    return virCgroupGetValueRaw(keypath, value);\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetValueStr(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     char **value)\n{\n    g_autofree char *keypath = NULL;\n\n    if (virCgroupPathOfController(group, controller, key, &keypath) < 0)\n        return -1;\n\n    return virCgroupGetValueRaw(keypath, value);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"vircgroupv1.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <sys/stat.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV1HasEmptyTasks(virCgroupPtr cgroup,\n                         int controller)\n{\n    int ret = -1;\n    g_autofree char *content = NULL;\n\n    if (!cgroup)\n        return -1;\n\n    ret = virCgroupGetValueStr(cgroup, controller, \"tasks\", &content);\n\n    if (ret == 0 && content[0] == '\\0')\n        ret = 1;\n\n    return ret;\n}"
  },
  {
    "function_name": "virCgroupV1AddTask",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv1.c",
    "lines": "706-730",
    "snippet": "static int\nvirCgroupV1AddTask(virCgroupPtr group,\n                   pid_t pid,\n                   unsigned int flags)\n{\n    size_t i;\n\n    for (i = 0; i < VIR_CGROUP_CONTROLLER_LAST; i++) {\n        /* Skip over controllers not mounted */\n        if (!group->legacy[i].mountPoint)\n            continue;\n\n        /* We must never add tasks in systemd's hierarchy\n         * unless we're intentionally trying to move a\n         * task into a systemd machine scope */\n        if (i == VIR_CGROUP_CONTROLLER_SYSTEMD &&\n            !(flags & VIR_CGROUP_TASK_SYSTEMD))\n            continue;\n\n        if (virCgroupSetValueI64(group, i, \"tasks\", pid) < 0)\n            return -1;\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"vircgroupv1.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <sys/stat.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCgroupSetValueI64",
          "args": [
            "group",
            "i",
            "\"tasks\"",
            "pid"
          ],
          "line": 725
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupSetValueI64",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "567-578",
          "snippet": "int\nvirCgroupSetValueI64(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     long long int value)\n{\n    g_autofree char *strval = NULL;\n\n    strval = g_strdup_printf(\"%lld\", value);\n\n    return virCgroupSetValueStr(group, controller, key, strval);\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupSetValueI64(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     long long int value)\n{\n    g_autofree char *strval = NULL;\n\n    strval = g_strdup_printf(\"%lld\", value);\n\n    return virCgroupSetValueStr(group, controller, key, strval);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"vircgroupv1.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <sys/stat.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV1AddTask(virCgroupPtr group,\n                   pid_t pid,\n                   unsigned int flags)\n{\n    size_t i;\n\n    for (i = 0; i < VIR_CGROUP_CONTROLLER_LAST; i++) {\n        /* Skip over controllers not mounted */\n        if (!group->legacy[i].mountPoint)\n            continue;\n\n        /* We must never add tasks in systemd's hierarchy\n         * unless we're intentionally trying to move a\n         * task into a systemd machine scope */\n        if (i == VIR_CGROUP_CONTROLLER_SYSTEMD &&\n            !(flags & VIR_CGROUP_TASK_SYSTEMD))\n            continue;\n\n        if (virCgroupSetValueI64(group, i, \"tasks\", pid) < 0)\n            return -1;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virCgroupV1Remove",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv1.c",
    "lines": "668-703",
    "snippet": "static int\nvirCgroupV1Remove(virCgroupPtr group)\n{\n    int rc = 0;\n    size_t i;\n\n    VIR_DEBUG(\"Removing cgroup %s\", group->path);\n    for (i = 0; i < VIR_CGROUP_CONTROLLER_LAST; i++) {\n        g_autofree char *grppath = NULL;\n\n        /* Skip over controllers not mounted */\n        if (!group->legacy[i].mountPoint)\n            continue;\n\n        /* We must never rmdir() in systemd's hierarchy */\n        if (i == VIR_CGROUP_CONTROLLER_SYSTEMD)\n            continue;\n\n        /* Don't delete the root group, if we accidentally\n           ended up in it for some reason */\n        if (STREQ(group->legacy[i].placement, \"/\"))\n            continue;\n\n        if (virCgroupV1PathOfController(group,\n                                        i,\n                                        NULL,\n                                        &grppath) != 0)\n            continue;\n\n        VIR_DEBUG(\"Removing cgroup %s and all child cgroups\", grppath);\n        rc = virCgroupRemoveRecursively(grppath);\n    }\n    VIR_DEBUG(\"Done removing cgroup %s\", group->path);\n\n    return rc;\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"vircgroupv1.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <sys/stat.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Done removing cgroup %s\"",
            "group->path"
          ],
          "line": 700
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCgroupRemoveRecursively",
          "args": [
            "grppath"
          ],
          "line": 698
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupRemoveRecursively",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "2324-2367",
          "snippet": "int\nvirCgroupRemoveRecursively(char *grppath)\n{\n    DIR *grpdir;\n    struct dirent *ent;\n    int rc = 0;\n    int direrr;\n\n    if (virDirOpenQuiet(&grpdir, grppath) < 0) {\n        if (errno == ENOENT)\n            return 0;\n        rc = -errno;\n        VIR_ERROR(_(\"Unable to open %s (%d)\"), grppath, errno);\n        return rc;\n    }\n\n    /* This is best-effort cleanup: we want to log failures with just\n     * VIR_ERROR instead of normal virReportError */\n    while ((direrr = virDirRead(grpdir, &ent, NULL)) > 0) {\n        g_autofree char *path = NULL;\n\n        if (ent->d_type != DT_DIR) continue;\n\n        path = g_strdup_printf(\"%s/%s\", grppath, ent->d_name);\n\n        rc = virCgroupRemoveRecursively(path);\n        if (rc != 0)\n            break;\n    }\n    if (direrr < 0) {\n        rc = -errno;\n        VIR_ERROR(_(\"Failed to readdir for %s (%d)\"), grppath, errno);\n    }\n\n    VIR_DIR_CLOSE(grpdir);\n\n    VIR_DEBUG(\"Removing cgroup %s\", grppath);\n    if (rmdir(grppath) != 0 && errno != ENOENT) {\n        rc = -errno;\n        VIR_ERROR(_(\"Unable to remove %s (%d)\"), grppath, errno);\n    }\n\n    return rc;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupRemoveRecursively(char *grppath)\n{\n    DIR *grpdir;\n    struct dirent *ent;\n    int rc = 0;\n    int direrr;\n\n    if (virDirOpenQuiet(&grpdir, grppath) < 0) {\n        if (errno == ENOENT)\n            return 0;\n        rc = -errno;\n        VIR_ERROR(_(\"Unable to open %s (%d)\"), grppath, errno);\n        return rc;\n    }\n\n    /* This is best-effort cleanup: we want to log failures with just\n     * VIR_ERROR instead of normal virReportError */\n    while ((direrr = virDirRead(grpdir, &ent, NULL)) > 0) {\n        g_autofree char *path = NULL;\n\n        if (ent->d_type != DT_DIR) continue;\n\n        path = g_strdup_printf(\"%s/%s\", grppath, ent->d_name);\n\n        rc = virCgroupRemoveRecursively(path);\n        if (rc != 0)\n            break;\n    }\n    if (direrr < 0) {\n        rc = -errno;\n        VIR_ERROR(_(\"Failed to readdir for %s (%d)\"), grppath, errno);\n    }\n\n    VIR_DIR_CLOSE(grpdir);\n\n    VIR_DEBUG(\"Removing cgroup %s\", grppath);\n    if (rmdir(grppath) != 0 && errno != ENOENT) {\n        rc = -errno;\n        VIR_ERROR(_(\"Unable to remove %s (%d)\"), grppath, errno);\n    }\n\n    return rc;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Removing cgroup %s and all child cgroups\"",
            "grppath"
          ],
          "line": 697
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCgroupV1PathOfController",
          "args": [
            "group",
            "i",
            "NULL",
            "&grppath"
          ],
          "line": 691
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupV1PathOfController",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv1.c",
          "lines": "510-534",
          "snippet": "static int\nvirCgroupV1PathOfController(virCgroupPtr group,\n                            int controller,\n                            const char *key,\n                            char **path)\n{\n    if (group->legacy[controller].mountPoint == NULL) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"v1 controller '%s' is not mounted\"),\n                       virCgroupV1ControllerTypeToString(controller));\n        return -1;\n    }\n\n    if (group->legacy[controller].placement == NULL) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"v1 controller '%s' is not enabled for group\"),\n                       virCgroupV1ControllerTypeToString(controller));\n        return -1;\n    }\n\n    *path = g_strdup_printf(\"%s%s/%s\", group->legacy[controller].mountPoint,\n                            group->legacy[controller].placement, NULLSTR_EMPTY(key));\n\n    return 0;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"vircgroupv1.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"vircgroup.h\"",
            "#include \"vircgrouppriv.h\"",
            "#include \"internal.h\"",
            "# include <sys/mount.h>",
            "# include <sys/stat.h>",
            "# include <mntent.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"vircgroupv1.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <sys/stat.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV1PathOfController(virCgroupPtr group,\n                            int controller,\n                            const char *key,\n                            char **path)\n{\n    if (group->legacy[controller].mountPoint == NULL) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"v1 controller '%s' is not mounted\"),\n                       virCgroupV1ControllerTypeToString(controller));\n        return -1;\n    }\n\n    if (group->legacy[controller].placement == NULL) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"v1 controller '%s' is not enabled for group\"),\n                       virCgroupV1ControllerTypeToString(controller));\n        return -1;\n    }\n\n    *path = g_strdup_printf(\"%s%s/%s\", group->legacy[controller].mountPoint,\n                            group->legacy[controller].placement, NULLSTR_EMPTY(key));\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "group->legacy[i].placement",
            "\"/\""
          ],
          "line": 688
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Removing cgroup %s\"",
            "group->path"
          ],
          "line": 674
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"vircgroupv1.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <sys/stat.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV1Remove(virCgroupPtr group)\n{\n    int rc = 0;\n    size_t i;\n\n    VIR_DEBUG(\"Removing cgroup %s\", group->path);\n    for (i = 0; i < VIR_CGROUP_CONTROLLER_LAST; i++) {\n        g_autofree char *grppath = NULL;\n\n        /* Skip over controllers not mounted */\n        if (!group->legacy[i].mountPoint)\n            continue;\n\n        /* We must never rmdir() in systemd's hierarchy */\n        if (i == VIR_CGROUP_CONTROLLER_SYSTEMD)\n            continue;\n\n        /* Don't delete the root group, if we accidentally\n           ended up in it for some reason */\n        if (STREQ(group->legacy[i].placement, \"/\"))\n            continue;\n\n        if (virCgroupV1PathOfController(group,\n                                        i,\n                                        NULL,\n                                        &grppath) != 0)\n            continue;\n\n        VIR_DEBUG(\"Removing cgroup %s and all child cgroups\", grppath);\n        rc = virCgroupRemoveRecursively(grppath);\n    }\n    VIR_DEBUG(\"Done removing cgroup %s\", group->path);\n\n    return rc;\n}"
  },
  {
    "function_name": "virCgroupV1MakeGroup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv1.c",
    "lines": "596-665",
    "snippet": "static int\nvirCgroupV1MakeGroup(virCgroupPtr parent,\n                     virCgroupPtr group,\n                     bool create,\n                     unsigned int flags)\n{\n    size_t i;\n\n    VIR_DEBUG(\"Make group %s\", group->path);\n    for (i = 0; i < VIR_CGROUP_CONTROLLER_LAST; i++) {\n        g_autofree char *path = NULL;\n\n        /* We must never mkdir() in systemd's hierarchy */\n        if (i == VIR_CGROUP_CONTROLLER_SYSTEMD) {\n            VIR_DEBUG(\"Not creating systemd controller group\");\n            continue;\n        }\n\n        /* Skip over controllers that aren't mounted */\n        if (!group->legacy[i].mountPoint) {\n            VIR_DEBUG(\"Skipping unmounted controller %s\",\n                      virCgroupV1ControllerTypeToString(i));\n            continue;\n        }\n\n        if (virCgroupV1PathOfController(group, i, \"\", &path) < 0)\n            return -1;\n\n        VIR_DEBUG(\"Make controller %s\", path);\n        if (!virFileExists(path)) {\n            if (!create ||\n                mkdir(path, 0755) < 0) {\n                if (errno == EEXIST)\n                    continue;\n                /* With a kernel that doesn't support multi-level directory\n                 * for blkio controller, libvirt will fail and disable all\n                 * other controllers even though they are available. So\n                 * treat blkio as unmounted if mkdir fails. */\n                if (i == VIR_CGROUP_CONTROLLER_BLKIO) {\n                    VIR_DEBUG(\"Ignoring mkdir failure with blkio controller. Kernel probably too old\");\n                    VIR_FREE(group->legacy[i].mountPoint);\n                    continue;\n                } else {\n                    virReportSystemError(errno,\n                                         _(\"Failed to create v1 controller %s for group\"),\n                                         virCgroupV1ControllerTypeToString(i));\n                    return -1;\n                }\n            }\n            if (i == VIR_CGROUP_CONTROLLER_CPUSET &&\n                group->legacy[i].mountPoint != NULL &&\n                virCgroupV1CpuSetInherit(parent, group) < 0) {\n                return -1;\n            }\n            /*\n             * Note that virCgroupV1SetMemoryUseHierarchy should always be\n             * called prior to creating subcgroups and attaching tasks.\n             */\n            if ((flags & VIR_CGROUP_MEM_HIERACHY) &&\n                i == VIR_CGROUP_CONTROLLER_MEMORY &&\n                group->legacy[i].mountPoint != NULL &&\n                virCgroupV1SetMemoryUseHierarchy(group) < 0) {\n                return -1;\n            }\n        }\n    }\n\n    VIR_DEBUG(\"Done making controllers for group\");\n    return 0;\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"vircgroupv1.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <sys/stat.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Done making controllers for group\""
          ],
          "line": 663
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCgroupV1SetMemoryUseHierarchy",
          "args": [
            "group"
          ],
          "line": 657
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupV1SetMemoryUseHierarchy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv1.c",
          "lines": "571-593",
          "snippet": "static int\nvirCgroupV1SetMemoryUseHierarchy(virCgroupPtr group)\n{\n    unsigned long long value;\n    const char *filename = \"memory.use_hierarchy\";\n\n    if (virCgroupGetValueU64(group,\n                             VIR_CGROUP_CONTROLLER_MEMORY,\n                             filename, &value) < 0)\n        return -1;\n\n    /* Setting twice causes error, so if already enabled, skip setting */\n    if (value == 1)\n        return 0;\n\n    VIR_DEBUG(\"Setting up %s/%s\", group->path, filename);\n    if (virCgroupSetValueU64(group,\n                             VIR_CGROUP_CONTROLLER_MEMORY,\n                             filename, 1) < 0)\n        return -1;\n\n    return 0;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"vircgroupv1.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"vircgroup.h\"",
            "#include \"vircgrouppriv.h\"",
            "#include \"internal.h\"",
            "# include <sys/mount.h>",
            "# include <sys/stat.h>",
            "# include <mntent.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"vircgroupv1.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <sys/stat.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV1SetMemoryUseHierarchy(virCgroupPtr group)\n{\n    unsigned long long value;\n    const char *filename = \"memory.use_hierarchy\";\n\n    if (virCgroupGetValueU64(group,\n                             VIR_CGROUP_CONTROLLER_MEMORY,\n                             filename, &value) < 0)\n        return -1;\n\n    /* Setting twice causes error, so if already enabled, skip setting */\n    if (value == 1)\n        return 0;\n\n    VIR_DEBUG(\"Setting up %s/%s\", group->path, filename);\n    if (virCgroupSetValueU64(group,\n                             VIR_CGROUP_CONTROLLER_MEMORY,\n                             filename, 1) < 0)\n        return -1;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupV1CpuSetInherit",
          "args": [
            "parent",
            "group"
          ],
          "line": 647
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupV1CpuSetInherit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv1.c",
          "lines": "537-568",
          "snippet": "static int\nvirCgroupV1CpuSetInherit(virCgroupPtr parent,\n                         virCgroupPtr group)\n{\n    size_t i;\n    const char *inherit_values[] = {\n        \"cpuset.cpus\",\n        \"cpuset.mems\",\n        \"cpuset.memory_migrate\",\n    };\n\n    VIR_DEBUG(\"Setting up inheritance %s -> %s\", parent->path, group->path);\n    for (i = 0; i < G_N_ELEMENTS(inherit_values); i++) {\n        g_autofree char *value = NULL;\n\n        if (virCgroupGetValueStr(parent,\n                                 VIR_CGROUP_CONTROLLER_CPUSET,\n                                 inherit_values[i],\n                                 &value) < 0)\n            return -1;\n\n        VIR_DEBUG(\"Inherit %s = %s\", inherit_values[i], value);\n\n        if (virCgroupSetValueStr(group,\n                                 VIR_CGROUP_CONTROLLER_CPUSET,\n                                 inherit_values[i],\n                                 value) < 0)\n            return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"vircgroupv1.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"vircgroup.h\"",
            "#include \"vircgrouppriv.h\"",
            "#include \"internal.h\"",
            "# include <sys/mount.h>",
            "# include <sys/stat.h>",
            "# include <mntent.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"vircgroupv1.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <sys/stat.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV1CpuSetInherit(virCgroupPtr parent,\n                         virCgroupPtr group)\n{\n    size_t i;\n    const char *inherit_values[] = {\n        \"cpuset.cpus\",\n        \"cpuset.mems\",\n        \"cpuset.memory_migrate\",\n    };\n\n    VIR_DEBUG(\"Setting up inheritance %s -> %s\", parent->path, group->path);\n    for (i = 0; i < G_N_ELEMENTS(inherit_values); i++) {\n        g_autofree char *value = NULL;\n\n        if (virCgroupGetValueStr(parent,\n                                 VIR_CGROUP_CONTROLLER_CPUSET,\n                                 inherit_values[i],\n                                 &value) < 0)\n            return -1;\n\n        VIR_DEBUG(\"Inherit %s = %s\", inherit_values[i], value);\n\n        if (virCgroupSetValueStr(group,\n                                 VIR_CGROUP_CONTROLLER_CPUSET,\n                                 inherit_values[i],\n                                 value) < 0)\n            return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"Failed to create v1 controller %s for group\")",
            "virCgroupV1ControllerTypeToString(i)"
          ],
          "line": 639
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCgroupV1ControllerTypeToString",
          "args": [
            "i"
          ],
          "line": 641
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Failed to create v1 controller %s for group\""
          ],
          "line": 640
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "group->legacy[i].mountPoint"
          ],
          "line": 636
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Ignoring mkdir failure with blkio controller. Kernel probably too old\""
          ],
          "line": 635
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mkdir",
          "args": [
            "path",
            "0755"
          ],
          "line": 627
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virFileExists",
          "args": [
            "path"
          ],
          "line": 625
        },
        "resolved": true,
        "details": {
          "function_name": "virFileExists",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1873-1877",
          "snippet": "bool\nvirFileExists(const char *path)\n{\n    return access(path, F_OK) == 0;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nbool\nvirFileExists(const char *path)\n{\n    return access(path, F_OK) == 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Make controller %s\"",
            "path"
          ],
          "line": 624
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCgroupV1PathOfController",
          "args": [
            "group",
            "i",
            "\"\"",
            "&path"
          ],
          "line": 621
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupV1PathOfController",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv1.c",
          "lines": "510-534",
          "snippet": "static int\nvirCgroupV1PathOfController(virCgroupPtr group,\n                            int controller,\n                            const char *key,\n                            char **path)\n{\n    if (group->legacy[controller].mountPoint == NULL) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"v1 controller '%s' is not mounted\"),\n                       virCgroupV1ControllerTypeToString(controller));\n        return -1;\n    }\n\n    if (group->legacy[controller].placement == NULL) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"v1 controller '%s' is not enabled for group\"),\n                       virCgroupV1ControllerTypeToString(controller));\n        return -1;\n    }\n\n    *path = g_strdup_printf(\"%s%s/%s\", group->legacy[controller].mountPoint,\n                            group->legacy[controller].placement, NULLSTR_EMPTY(key));\n\n    return 0;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"vircgroupv1.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"vircgroup.h\"",
            "#include \"vircgrouppriv.h\"",
            "#include \"internal.h\"",
            "# include <sys/mount.h>",
            "# include <sys/stat.h>",
            "# include <mntent.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"vircgroupv1.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <sys/stat.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV1PathOfController(virCgroupPtr group,\n                            int controller,\n                            const char *key,\n                            char **path)\n{\n    if (group->legacy[controller].mountPoint == NULL) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"v1 controller '%s' is not mounted\"),\n                       virCgroupV1ControllerTypeToString(controller));\n        return -1;\n    }\n\n    if (group->legacy[controller].placement == NULL) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"v1 controller '%s' is not enabled for group\"),\n                       virCgroupV1ControllerTypeToString(controller));\n        return -1;\n    }\n\n    *path = g_strdup_printf(\"%s%s/%s\", group->legacy[controller].mountPoint,\n                            group->legacy[controller].placement, NULLSTR_EMPTY(key));\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Skipping unmounted controller %s\"",
            "virCgroupV1ControllerTypeToString(i)"
          ],
          "line": 616
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCgroupV1ControllerTypeToString",
          "args": [
            "i"
          ],
          "line": 617
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Not creating systemd controller group\""
          ],
          "line": 610
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Make group %s\"",
            "group->path"
          ],
          "line": 604
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"vircgroupv1.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <sys/stat.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV1MakeGroup(virCgroupPtr parent,\n                     virCgroupPtr group,\n                     bool create,\n                     unsigned int flags)\n{\n    size_t i;\n\n    VIR_DEBUG(\"Make group %s\", group->path);\n    for (i = 0; i < VIR_CGROUP_CONTROLLER_LAST; i++) {\n        g_autofree char *path = NULL;\n\n        /* We must never mkdir() in systemd's hierarchy */\n        if (i == VIR_CGROUP_CONTROLLER_SYSTEMD) {\n            VIR_DEBUG(\"Not creating systemd controller group\");\n            continue;\n        }\n\n        /* Skip over controllers that aren't mounted */\n        if (!group->legacy[i].mountPoint) {\n            VIR_DEBUG(\"Skipping unmounted controller %s\",\n                      virCgroupV1ControllerTypeToString(i));\n            continue;\n        }\n\n        if (virCgroupV1PathOfController(group, i, \"\", &path) < 0)\n            return -1;\n\n        VIR_DEBUG(\"Make controller %s\", path);\n        if (!virFileExists(path)) {\n            if (!create ||\n                mkdir(path, 0755) < 0) {\n                if (errno == EEXIST)\n                    continue;\n                /* With a kernel that doesn't support multi-level directory\n                 * for blkio controller, libvirt will fail and disable all\n                 * other controllers even though they are available. So\n                 * treat blkio as unmounted if mkdir fails. */\n                if (i == VIR_CGROUP_CONTROLLER_BLKIO) {\n                    VIR_DEBUG(\"Ignoring mkdir failure with blkio controller. Kernel probably too old\");\n                    VIR_FREE(group->legacy[i].mountPoint);\n                    continue;\n                } else {\n                    virReportSystemError(errno,\n                                         _(\"Failed to create v1 controller %s for group\"),\n                                         virCgroupV1ControllerTypeToString(i));\n                    return -1;\n                }\n            }\n            if (i == VIR_CGROUP_CONTROLLER_CPUSET &&\n                group->legacy[i].mountPoint != NULL &&\n                virCgroupV1CpuSetInherit(parent, group) < 0) {\n                return -1;\n            }\n            /*\n             * Note that virCgroupV1SetMemoryUseHierarchy should always be\n             * called prior to creating subcgroups and attaching tasks.\n             */\n            if ((flags & VIR_CGROUP_MEM_HIERACHY) &&\n                i == VIR_CGROUP_CONTROLLER_MEMORY &&\n                group->legacy[i].mountPoint != NULL &&\n                virCgroupV1SetMemoryUseHierarchy(group) < 0) {\n                return -1;\n            }\n        }\n    }\n\n    VIR_DEBUG(\"Done making controllers for group\");\n    return 0;\n}"
  },
  {
    "function_name": "virCgroupV1SetMemoryUseHierarchy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv1.c",
    "lines": "571-593",
    "snippet": "static int\nvirCgroupV1SetMemoryUseHierarchy(virCgroupPtr group)\n{\n    unsigned long long value;\n    const char *filename = \"memory.use_hierarchy\";\n\n    if (virCgroupGetValueU64(group,\n                             VIR_CGROUP_CONTROLLER_MEMORY,\n                             filename, &value) < 0)\n        return -1;\n\n    /* Setting twice causes error, so if already enabled, skip setting */\n    if (value == 1)\n        return 0;\n\n    VIR_DEBUG(\"Setting up %s/%s\", group->path, filename);\n    if (virCgroupSetValueU64(group,\n                             VIR_CGROUP_CONTROLLER_MEMORY,\n                             filename, 1) < 0)\n        return -1;\n\n    return 0;\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"vircgroupv1.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <sys/stat.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCgroupSetValueU64",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_MEMORY",
            "filename",
            "1"
          ],
          "line": 587
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupSetValueU64",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "553-564",
          "snippet": "int\nvirCgroupSetValueU64(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     unsigned long long int value)\n{\n    g_autofree char *strval = NULL;\n\n    strval = g_strdup_printf(\"%llu\", value);\n\n    return virCgroupSetValueStr(group, controller, key, strval);\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupSetValueU64(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     unsigned long long int value)\n{\n    g_autofree char *strval = NULL;\n\n    strval = g_strdup_printf(\"%llu\", value);\n\n    return virCgroupSetValueStr(group, controller, key, strval);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Setting up %s/%s\"",
            "group->path",
            "filename"
          ],
          "line": 586
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCgroupGetValueU64",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_MEMORY",
            "filename",
            "&value"
          ],
          "line": 577
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupGetValueU64",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "603-622",
          "snippet": "int\nvirCgroupGetValueU64(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     unsigned long long int *value)\n{\n    g_autofree char *strval = NULL;\n\n    if (virCgroupGetValueStr(group, controller, key, &strval) < 0)\n        return -1;\n\n    if (virStrToLong_ull(strval, NULL, 10, value) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Unable to parse '%s' as an integer\"),\n                       strval);\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetValueU64(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     unsigned long long int *value)\n{\n    g_autofree char *strval = NULL;\n\n    if (virCgroupGetValueStr(group, controller, key, &strval) < 0)\n        return -1;\n\n    if (virStrToLong_ull(strval, NULL, 10, value) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Unable to parse '%s' as an integer\"),\n                       strval);\n        return -1;\n    }\n\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"vircgroupv1.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <sys/stat.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV1SetMemoryUseHierarchy(virCgroupPtr group)\n{\n    unsigned long long value;\n    const char *filename = \"memory.use_hierarchy\";\n\n    if (virCgroupGetValueU64(group,\n                             VIR_CGROUP_CONTROLLER_MEMORY,\n                             filename, &value) < 0)\n        return -1;\n\n    /* Setting twice causes error, so if already enabled, skip setting */\n    if (value == 1)\n        return 0;\n\n    VIR_DEBUG(\"Setting up %s/%s\", group->path, filename);\n    if (virCgroupSetValueU64(group,\n                             VIR_CGROUP_CONTROLLER_MEMORY,\n                             filename, 1) < 0)\n        return -1;\n\n    return 0;\n}"
  },
  {
    "function_name": "virCgroupV1CpuSetInherit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv1.c",
    "lines": "537-568",
    "snippet": "static int\nvirCgroupV1CpuSetInherit(virCgroupPtr parent,\n                         virCgroupPtr group)\n{\n    size_t i;\n    const char *inherit_values[] = {\n        \"cpuset.cpus\",\n        \"cpuset.mems\",\n        \"cpuset.memory_migrate\",\n    };\n\n    VIR_DEBUG(\"Setting up inheritance %s -> %s\", parent->path, group->path);\n    for (i = 0; i < G_N_ELEMENTS(inherit_values); i++) {\n        g_autofree char *value = NULL;\n\n        if (virCgroupGetValueStr(parent,\n                                 VIR_CGROUP_CONTROLLER_CPUSET,\n                                 inherit_values[i],\n                                 &value) < 0)\n            return -1;\n\n        VIR_DEBUG(\"Inherit %s = %s\", inherit_values[i], value);\n\n        if (virCgroupSetValueStr(group,\n                                 VIR_CGROUP_CONTROLLER_CPUSET,\n                                 inherit_values[i],\n                                 value) < 0)\n            return -1;\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"vircgroupv1.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <sys/stat.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCgroupSetValueStr",
          "args": [
            "group",
            "VIR_CGROUP_CONTROLLER_CPUSET",
            "inherit_values[i]",
            "value"
          ],
          "line": 560
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupSetValueStr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "499-511",
          "snippet": "int\nvirCgroupSetValueStr(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     const char *value)\n{\n    g_autofree char *keypath = NULL;\n\n    if (virCgroupPathOfController(group, controller, key, &keypath) < 0)\n        return -1;\n\n    return virCgroupSetValueRaw(keypath, value);\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupSetValueStr(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     const char *value)\n{\n    g_autofree char *keypath = NULL;\n\n    if (virCgroupPathOfController(group, controller, key, &keypath) < 0)\n        return -1;\n\n    return virCgroupSetValueRaw(keypath, value);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Inherit %s = %s\"",
            "inherit_values[i]",
            "value"
          ],
          "line": 558
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCgroupGetValueStr",
          "args": [
            "parent",
            "VIR_CGROUP_CONTROLLER_CPUSET",
            "inherit_values[i]",
            "&value"
          ],
          "line": 552
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupGetValueStr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "514-526",
          "snippet": "int\nvirCgroupGetValueStr(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     char **value)\n{\n    g_autofree char *keypath = NULL;\n\n    if (virCgroupPathOfController(group, controller, key, &keypath) < 0)\n        return -1;\n\n    return virCgroupGetValueRaw(keypath, value);\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupGetValueStr(virCgroupPtr group,\n                     int controller,\n                     const char *key,\n                     char **value)\n{\n    g_autofree char *keypath = NULL;\n\n    if (virCgroupPathOfController(group, controller, key, &keypath) < 0)\n        return -1;\n\n    return virCgroupGetValueRaw(keypath, value);\n}"
        }
      },
      {
        "call_info": {
          "callee": "G_N_ELEMENTS",
          "args": [
            "inherit_values"
          ],
          "line": 549
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Setting up inheritance %s -> %s\"",
            "parent->path",
            "group->path"
          ],
          "line": 548
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"vircgroupv1.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <sys/stat.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV1CpuSetInherit(virCgroupPtr parent,\n                         virCgroupPtr group)\n{\n    size_t i;\n    const char *inherit_values[] = {\n        \"cpuset.cpus\",\n        \"cpuset.mems\",\n        \"cpuset.memory_migrate\",\n    };\n\n    VIR_DEBUG(\"Setting up inheritance %s -> %s\", parent->path, group->path);\n    for (i = 0; i < G_N_ELEMENTS(inherit_values); i++) {\n        g_autofree char *value = NULL;\n\n        if (virCgroupGetValueStr(parent,\n                                 VIR_CGROUP_CONTROLLER_CPUSET,\n                                 inherit_values[i],\n                                 &value) < 0)\n            return -1;\n\n        VIR_DEBUG(\"Inherit %s = %s\", inherit_values[i], value);\n\n        if (virCgroupSetValueStr(group,\n                                 VIR_CGROUP_CONTROLLER_CPUSET,\n                                 inherit_values[i],\n                                 value) < 0)\n            return -1;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virCgroupV1PathOfController",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv1.c",
    "lines": "510-534",
    "snippet": "static int\nvirCgroupV1PathOfController(virCgroupPtr group,\n                            int controller,\n                            const char *key,\n                            char **path)\n{\n    if (group->legacy[controller].mountPoint == NULL) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"v1 controller '%s' is not mounted\"),\n                       virCgroupV1ControllerTypeToString(controller));\n        return -1;\n    }\n\n    if (group->legacy[controller].placement == NULL) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"v1 controller '%s' is not enabled for group\"),\n                       virCgroupV1ControllerTypeToString(controller));\n        return -1;\n    }\n\n    *path = g_strdup_printf(\"%s%s/%s\", group->legacy[controller].mountPoint,\n                            group->legacy[controller].placement, NULLSTR_EMPTY(key));\n\n    return 0;\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"vircgroupv1.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <sys/stat.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"%s%s/%s\"",
            "group->legacy[controller].mountPoint",
            "group->legacy[controller].placement",
            "NULLSTR_EMPTY(key)"
          ],
          "line": 530
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "NULLSTR_EMPTY",
          "args": [
            "key"
          ],
          "line": 531
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"v1 controller '%s' is not enabled for group\")",
            "virCgroupV1ControllerTypeToString(controller)"
          ],
          "line": 524
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCgroupV1ControllerTypeToString",
          "args": [
            "controller"
          ],
          "line": 526
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"v1 controller '%s' is not mounted\")",
            "virCgroupV1ControllerTypeToString(controller)"
          ],
          "line": 517
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCgroupV1ControllerTypeToString",
          "args": [
            "controller"
          ],
          "line": 519
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"vircgroupv1.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <sys/stat.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV1PathOfController(virCgroupPtr group,\n                            int controller,\n                            const char *key,\n                            char **path)\n{\n    if (group->legacy[controller].mountPoint == NULL) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"v1 controller '%s' is not mounted\"),\n                       virCgroupV1ControllerTypeToString(controller));\n        return -1;\n    }\n\n    if (group->legacy[controller].placement == NULL) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"v1 controller '%s' is not enabled for group\"),\n                       virCgroupV1ControllerTypeToString(controller));\n        return -1;\n    }\n\n    *path = g_strdup_printf(\"%s%s/%s\", group->legacy[controller].mountPoint,\n                            group->legacy[controller].placement, NULLSTR_EMPTY(key));\n\n    return 0;\n}"
  },
  {
    "function_name": "virCgroupV1GetAnyController",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv1.c",
    "lines": "489-507",
    "snippet": "static int\nvirCgroupV1GetAnyController(virCgroupPtr group)\n{\n    size_t i;\n\n    for (i = 0; i < VIR_CGROUP_CONTROLLER_LAST; i++) {\n        /* Reject any controller with a placement\n         * of '/' to avoid doing bad stuff to the root\n         * cgroup\n         */\n        if (group->legacy[i].mountPoint &&\n            group->legacy[i].placement &&\n            STRNEQ(group->legacy[i].placement, \"/\")) {\n            return i;\n        }\n    }\n\n    return -1;\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"vircgroupv1.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <sys/stat.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "STRNEQ",
          "args": [
            "group->legacy[i].placement",
            "\"/\""
          ],
          "line": 501
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"vircgroupv1.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <sys/stat.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV1GetAnyController(virCgroupPtr group)\n{\n    size_t i;\n\n    for (i = 0; i < VIR_CGROUP_CONTROLLER_LAST; i++) {\n        /* Reject any controller with a placement\n         * of '/' to avoid doing bad stuff to the root\n         * cgroup\n         */\n        if (group->legacy[i].mountPoint &&\n            group->legacy[i].placement &&\n            STRNEQ(group->legacy[i].placement, \"/\")) {\n            return i;\n        }\n    }\n\n    return -1;\n}"
  },
  {
    "function_name": "virCgroupV1HasController",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv1.c",
    "lines": "481-486",
    "snippet": "static bool\nvirCgroupV1HasController(virCgroupPtr group,\n                         int controller)\n{\n    return group->legacy[controller].mountPoint != NULL;\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"vircgroupv1.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <sys/stat.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"vircgroupv1.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <sys/stat.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic bool\nvirCgroupV1HasController(virCgroupPtr group,\n                         int controller)\n{\n    return group->legacy[controller].mountPoint != NULL;\n}"
  },
  {
    "function_name": "virCgroupV1DetectControllers",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv1.c",
    "lines": "404-478",
    "snippet": "static int\nvirCgroupV1DetectControllers(virCgroupPtr group,\n                             int controllers,\n                             virCgroupPtr parent G_GNUC_UNUSED,\n                             int detected)\n{\n    size_t i;\n    size_t j;\n\n    if (controllers >= 0) {\n        VIR_DEBUG(\"Filtering controllers %d\", controllers);\n        /* First mark requested but non-existing controllers to be ignored */\n        for (i = 0; i < VIR_CGROUP_CONTROLLER_LAST; i++) {\n            if (((1 << i) & controllers)) {\n                int type = 1 << i;\n                if (type & detected) {\n                    VIR_FREE(group->legacy[i].mountPoint);\n                    VIR_FREE(group->legacy[i].placement);\n                }\n                /* Remove non-existent controllers  */\n                if (!group->legacy[i].mountPoint) {\n                    VIR_DEBUG(\"Requested controller '%s' not mounted, ignoring\",\n                              virCgroupV1ControllerTypeToString(i));\n                    controllers &= ~(1 << i);\n                }\n            }\n        }\n        for (i = 0; i < VIR_CGROUP_CONTROLLER_LAST; i++) {\n            VIR_DEBUG(\"Controller '%s' wanted=%s, mount='%s'\",\n                      virCgroupV1ControllerTypeToString(i),\n                      (1 << i) & controllers ? \"yes\" : \"no\",\n                      NULLSTR(group->legacy[i].mountPoint));\n            if (!((1 << i) & controllers) &&\n                group->legacy[i].mountPoint) {\n                /* Check whether a request to disable a controller\n                 * clashes with co-mounting of controllers */\n                for (j = 0; j < VIR_CGROUP_CONTROLLER_LAST; j++) {\n                    if (j == i)\n                        continue;\n                    if (!((1 << j) & controllers))\n                        continue;\n\n                    if (STREQ_NULLABLE(group->legacy[i].mountPoint,\n                                       group->legacy[j].mountPoint)) {\n                        virReportSystemError(EINVAL,\n                                             _(\"V1 controller '%s' is not wanted, but '%s' is co-mounted\"),\n                                             virCgroupV1ControllerTypeToString(i),\n                                             virCgroupV1ControllerTypeToString(j));\n                        return -1;\n                    }\n                }\n                VIR_FREE(group->legacy[i].mountPoint);\n                VIR_FREE(group->legacy[i].placement);\n            }\n        }\n    } else {\n        VIR_DEBUG(\"Auto-detecting controllers\");\n        controllers = 0;\n        for (i = 0; i < VIR_CGROUP_CONTROLLER_LAST; i++) {\n            int type = 1 << i;\n            if (type & detected) {\n                VIR_FREE(group->legacy[i].mountPoint);\n                VIR_FREE(group->legacy[i].placement);\n            }\n            VIR_DEBUG(\"Controller '%s' present=%s\",\n                      virCgroupV1ControllerTypeToString(i),\n                      group->legacy[i].mountPoint ? \"yes\" : \"no\");\n            if (group->legacy[i].mountPoint == NULL)\n                continue;\n            controllers |= (1 << i);\n        }\n    }\n\n    return controllers;\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"vircgroupv1.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <sys/stat.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Controller '%s' present=%s\"",
            "virCgroupV1ControllerTypeToString(i)",
            "group->legacy[i].mountPoint ? \"yes\" : \"no\""
          ],
          "line": 468
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCgroupV1ControllerTypeToString",
          "args": [
            "i"
          ],
          "line": 469
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "group->legacy[i].placement"
          ],
          "line": 466
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "group->legacy[i].mountPoint"
          ],
          "line": 465
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Auto-detecting controllers\""
          ],
          "line": 460
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "group->legacy[i].placement"
          ],
          "line": 456
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "group->legacy[i].mountPoint"
          ],
          "line": 455
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "EINVAL",
            "_(\"V1 controller '%s' is not wanted, but '%s' is co-mounted\")",
            "virCgroupV1ControllerTypeToString(i)",
            "virCgroupV1ControllerTypeToString(j)"
          ],
          "line": 448
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCgroupV1ControllerTypeToString",
          "args": [
            "j"
          ],
          "line": 451
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCgroupV1ControllerTypeToString",
          "args": [
            "i"
          ],
          "line": 450
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"V1 controller '%s' is not wanted, but '%s' is co-mounted\""
          ],
          "line": 449
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "STREQ_NULLABLE",
          "args": [
            "group->legacy[i].mountPoint",
            "group->legacy[j].mountPoint"
          ],
          "line": 446
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Controller '%s' wanted=%s, mount='%s'\"",
            "virCgroupV1ControllerTypeToString(i)",
            "(1 << i) & controllers ? \"yes\" : \"no\"",
            "NULLSTR(group->legacy[i].mountPoint)"
          ],
          "line": 432
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NULLSTR",
          "args": [
            "group->legacy[i].mountPoint"
          ],
          "line": 435
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCgroupV1ControllerTypeToString",
          "args": [
            "i"
          ],
          "line": 433
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Requested controller '%s' not mounted, ignoring\"",
            "virCgroupV1ControllerTypeToString(i)"
          ],
          "line": 425
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCgroupV1ControllerTypeToString",
          "args": [
            "i"
          ],
          "line": 426
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "group->legacy[i].placement"
          ],
          "line": 421
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "group->legacy[i].mountPoint"
          ],
          "line": 420
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Filtering controllers %d\"",
            "controllers"
          ],
          "line": 414
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"vircgroupv1.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <sys/stat.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV1DetectControllers(virCgroupPtr group,\n                             int controllers,\n                             virCgroupPtr parent G_GNUC_UNUSED,\n                             int detected)\n{\n    size_t i;\n    size_t j;\n\n    if (controllers >= 0) {\n        VIR_DEBUG(\"Filtering controllers %d\", controllers);\n        /* First mark requested but non-existing controllers to be ignored */\n        for (i = 0; i < VIR_CGROUP_CONTROLLER_LAST; i++) {\n            if (((1 << i) & controllers)) {\n                int type = 1 << i;\n                if (type & detected) {\n                    VIR_FREE(group->legacy[i].mountPoint);\n                    VIR_FREE(group->legacy[i].placement);\n                }\n                /* Remove non-existent controllers  */\n                if (!group->legacy[i].mountPoint) {\n                    VIR_DEBUG(\"Requested controller '%s' not mounted, ignoring\",\n                              virCgroupV1ControllerTypeToString(i));\n                    controllers &= ~(1 << i);\n                }\n            }\n        }\n        for (i = 0; i < VIR_CGROUP_CONTROLLER_LAST; i++) {\n            VIR_DEBUG(\"Controller '%s' wanted=%s, mount='%s'\",\n                      virCgroupV1ControllerTypeToString(i),\n                      (1 << i) & controllers ? \"yes\" : \"no\",\n                      NULLSTR(group->legacy[i].mountPoint));\n            if (!((1 << i) & controllers) &&\n                group->legacy[i].mountPoint) {\n                /* Check whether a request to disable a controller\n                 * clashes with co-mounting of controllers */\n                for (j = 0; j < VIR_CGROUP_CONTROLLER_LAST; j++) {\n                    if (j == i)\n                        continue;\n                    if (!((1 << j) & controllers))\n                        continue;\n\n                    if (STREQ_NULLABLE(group->legacy[i].mountPoint,\n                                       group->legacy[j].mountPoint)) {\n                        virReportSystemError(EINVAL,\n                                             _(\"V1 controller '%s' is not wanted, but '%s' is co-mounted\"),\n                                             virCgroupV1ControllerTypeToString(i),\n                                             virCgroupV1ControllerTypeToString(j));\n                        return -1;\n                    }\n                }\n                VIR_FREE(group->legacy[i].mountPoint);\n                VIR_FREE(group->legacy[i].placement);\n            }\n        }\n    } else {\n        VIR_DEBUG(\"Auto-detecting controllers\");\n        controllers = 0;\n        for (i = 0; i < VIR_CGROUP_CONTROLLER_LAST; i++) {\n            int type = 1 << i;\n            if (type & detected) {\n                VIR_FREE(group->legacy[i].mountPoint);\n                VIR_FREE(group->legacy[i].placement);\n            }\n            VIR_DEBUG(\"Controller '%s' present=%s\",\n                      virCgroupV1ControllerTypeToString(i),\n                      group->legacy[i].mountPoint ? \"yes\" : \"no\");\n            if (group->legacy[i].mountPoint == NULL)\n                continue;\n            controllers |= (1 << i);\n        }\n    }\n\n    return controllers;\n}"
  },
  {
    "function_name": "virCgroupV1StealPlacement",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv1.c",
    "lines": "397-401",
    "snippet": "static char *\nvirCgroupV1StealPlacement(virCgroupPtr group)\n{\n    return g_steal_pointer(&group->legacy[VIR_CGROUP_CONTROLLER_SYSTEMD].placement);\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"vircgroupv1.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <sys/stat.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_steal_pointer",
          "args": [
            "&group->legacy[VIR_CGROUP_CONTROLLER_SYSTEMD].placement"
          ],
          "line": 400
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"vircgroupv1.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <sys/stat.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic char *\nvirCgroupV1StealPlacement(virCgroupPtr group)\n{\n    return g_steal_pointer(&group->legacy[VIR_CGROUP_CONTROLLER_SYSTEMD].placement);\n}"
  },
  {
    "function_name": "virCgroupV1ValidatePlacement",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv1.c",
    "lines": "367-394",
    "snippet": "static int\nvirCgroupV1ValidatePlacement(virCgroupPtr group,\n                             pid_t pid)\n{\n    size_t i;\n\n    for (i = 0; i < VIR_CGROUP_CONTROLLER_LAST; i++) {\n        if (!group->legacy[i].mountPoint)\n            continue;\n\n        if (!group->legacy[i].placement) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Could not find placement for v1 controller %s at %s\"),\n                           virCgroupV1ControllerTypeToString(i),\n                           group->legacy[i].placement);\n            return -1;\n        }\n\n        VIR_DEBUG(\"Detected mount/mapping %zu:%s at %s in %s for pid %lld\",\n                  i,\n                  virCgroupV1ControllerTypeToString(i),\n                  group->legacy[i].mountPoint,\n                  group->legacy[i].placement,\n                  (long long) pid);\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"vircgroupv1.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <sys/stat.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Detected mount/mapping %zu:%s at %s in %s for pid %lld\"",
            "i",
            "virCgroupV1ControllerTypeToString(i)",
            "group->legacy[i].mountPoint",
            "group->legacy[i].placement",
            "(long long) pid"
          ],
          "line": 385
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCgroupV1ControllerTypeToString",
          "args": [
            "i"
          ],
          "line": 387
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Could not find placement for v1 controller %s at %s\")",
            "virCgroupV1ControllerTypeToString(i)",
            "group->legacy[i].placement"
          ],
          "line": 378
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCgroupV1ControllerTypeToString",
          "args": [
            "i"
          ],
          "line": 380
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Could not find placement for v1 controller %s at %s\""
          ],
          "line": 379
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"vircgroupv1.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <sys/stat.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV1ValidatePlacement(virCgroupPtr group,\n                             pid_t pid)\n{\n    size_t i;\n\n    for (i = 0; i < VIR_CGROUP_CONTROLLER_LAST; i++) {\n        if (!group->legacy[i].mountPoint)\n            continue;\n\n        if (!group->legacy[i].placement) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Could not find placement for v1 controller %s at %s\"),\n                           virCgroupV1ControllerTypeToString(i),\n                           group->legacy[i].placement);\n            return -1;\n        }\n\n        VIR_DEBUG(\"Detected mount/mapping %zu:%s at %s in %s for pid %lld\",\n                  i,\n                  virCgroupV1ControllerTypeToString(i),\n                  group->legacy[i].mountPoint,\n                  group->legacy[i].placement,\n                  (long long) pid);\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virCgroupV1DetectPlacement",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv1.c",
    "lines": "332-364",
    "snippet": "static int\nvirCgroupV1DetectPlacement(virCgroupPtr group,\n                           const char *path,\n                           const char *controllers,\n                           const char *selfpath)\n{\n    size_t i;\n\n    for (i = 0; i < VIR_CGROUP_CONTROLLER_LAST; i++) {\n        const char *typestr = virCgroupV1ControllerTypeToString(i);\n\n        if (virCgroupV1MountOptsMatchController(controllers, typestr) &&\n            group->legacy[i].mountPoint != NULL &&\n            group->legacy[i].placement == NULL) {\n            /*\n             * selfpath == \"/\" + path=\"\" -> \"/\"\n             * selfpath == \"/libvirt.service\" + path == \"\" -> \"/libvirt.service\"\n             * selfpath == \"/libvirt.service\" + path == \"foo\" -> \"/libvirt.service/foo\"\n             */\n            if (i == VIR_CGROUP_CONTROLLER_SYSTEMD) {\n                group->legacy[i].placement = g_strdup(selfpath);\n            } else {\n                bool delim = STREQ(selfpath, \"/\") || STREQ(path, \"\");\n\n                group->legacy[i].placement = g_strdup_printf(\"%s%s%s\", selfpath,\n                                                             delim ? \"\" : \"/\",\n                                                             path);\n            }\n        }\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"vircgroupv1.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <sys/stat.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"%s%s%s\"",
            "selfpath",
            "delim ? \"\" : \"/\"",
            "path"
          ],
          "line": 356
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "path",
            "\"\""
          ],
          "line": 354
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "selfpath",
            "\"/\""
          ],
          "line": 354
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCgroupV1MountOptsMatchController",
          "args": [
            "controllers",
            "typestr"
          ],
          "line": 343
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupV1MountOptsMatchController",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv1.c",
          "lines": "266-290",
          "snippet": "static bool\nvirCgroupV1MountOptsMatchController(const char *mntOpts,\n                                    const char *typeStr)\n{\n    const char *tmp = mntOpts;\n    int typeLen = strlen(typeStr);\n\n    while (tmp) {\n        const char *next = strchr(tmp, ',');\n        int len;\n        if (next) {\n            len = next - tmp;\n            next++;\n        } else {\n            len = strlen(tmp);\n        }\n\n        if (typeLen == len && STREQLEN(typeStr, tmp, len))\n            return true;\n\n        tmp = next;\n    }\n\n    return false;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"vircgroupv1.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"vircgroup.h\"",
            "#include \"vircgrouppriv.h\"",
            "#include \"internal.h\"",
            "# include <sys/mount.h>",
            "# include <sys/stat.h>",
            "# include <mntent.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"vircgroupv1.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <sys/stat.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic bool\nvirCgroupV1MountOptsMatchController(const char *mntOpts,\n                                    const char *typeStr)\n{\n    const char *tmp = mntOpts;\n    int typeLen = strlen(typeStr);\n\n    while (tmp) {\n        const char *next = strchr(tmp, ',');\n        int len;\n        if (next) {\n            len = next - tmp;\n            next++;\n        } else {\n            len = strlen(tmp);\n        }\n\n        if (typeLen == len && STREQLEN(typeStr, tmp, len))\n            return true;\n\n        tmp = next;\n    }\n\n    return false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupV1ControllerTypeToString",
          "args": [
            "i"
          ],
          "line": 341
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"vircgroupv1.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <sys/stat.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV1DetectPlacement(virCgroupPtr group,\n                           const char *path,\n                           const char *controllers,\n                           const char *selfpath)\n{\n    size_t i;\n\n    for (i = 0; i < VIR_CGROUP_CONTROLLER_LAST; i++) {\n        const char *typestr = virCgroupV1ControllerTypeToString(i);\n\n        if (virCgroupV1MountOptsMatchController(controllers, typestr) &&\n            group->legacy[i].mountPoint != NULL &&\n            group->legacy[i].placement == NULL) {\n            /*\n             * selfpath == \"/\" + path=\"\" -> \"/\"\n             * selfpath == \"/libvirt.service\" + path == \"\" -> \"/libvirt.service\"\n             * selfpath == \"/libvirt.service\" + path == \"foo\" -> \"/libvirt.service/foo\"\n             */\n            if (i == VIR_CGROUP_CONTROLLER_SYSTEMD) {\n                group->legacy[i].placement = g_strdup(selfpath);\n            } else {\n                bool delim = STREQ(selfpath, \"/\") || STREQ(path, \"\");\n\n                group->legacy[i].placement = g_strdup_printf(\"%s%s%s\", selfpath,\n                                                             delim ? \"\" : \"/\",\n                                                             path);\n            }\n        }\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virCgroupV1DetectMounts",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv1.c",
    "lines": "293-329",
    "snippet": "static int\nvirCgroupV1DetectMounts(virCgroupPtr group,\n                        const char *mntType,\n                        const char *mntOpts,\n                        const char *mntDir)\n{\n    size_t i;\n\n    if (STRNEQ(mntType, \"cgroup\"))\n        return 0;\n\n    for (i = 0; i < VIR_CGROUP_CONTROLLER_LAST; i++) {\n        const char *typestr = virCgroupV1ControllerTypeToString(i);\n\n        if (virCgroupV1MountOptsMatchController(mntOpts, typestr)) {\n            /* Note that the lines in /proc/mounts have the same\n             * order than the mount operations, and that there may\n             * be duplicates due to bind mounts. This means\n             * that the same mount point may be processed more than\n             * once. We need to save the results of the last one,\n             * and we need to be careful to release the memory used\n             * by previous processing. */\n            virCgroupV1ControllerPtr controller = &group->legacy[i];\n\n            VIR_FREE(controller->mountPoint);\n            VIR_FREE(controller->linkPoint);\n            controller->mountPoint = g_strdup(mntDir);\n\n            /* If it is a co-mount it has a filename like \"cpu,cpuacct\"\n             * and we must identify the symlink path */\n            if (virCgroupV1ResolveMountLink(mntDir, typestr, controller) < 0)\n                return -1;\n        }\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"vircgroupv1.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <sys/stat.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCgroupV1ResolveMountLink",
          "args": [
            "mntDir",
            "typestr",
            "controller"
          ],
          "line": 323
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupV1ResolveMountLink",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv1.c",
          "lines": "219-263",
          "snippet": "static int\nvirCgroupV1ResolveMountLink(const char *mntDir,\n                            const char *typeStr,\n                            virCgroupV1ControllerPtr controller)\n{\n    g_autofree char *linkSrc = NULL;\n    g_autofree char *tmp = NULL;\n    char *dirName;\n    GStatBuf sb;\n\n    tmp = g_strdup(mntDir);\n\n    dirName = strrchr(tmp, '/');\n    if (!dirName) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Missing '/' separator in cgroup mount '%s'\"), tmp);\n        return -1;\n    }\n\n    if (!strchr(dirName + 1, ','))\n        return 0;\n\n    *dirName = '\\0';\n    linkSrc = g_strdup_printf(\"%s/%s\", tmp, typeStr);\n    *dirName = '/';\n\n    if (g_lstat(linkSrc, &sb) < 0) {\n        if (errno == ENOENT) {\n            VIR_WARN(\"Controller %s co-mounted at %s is missing symlink at %s\",\n                     typeStr, tmp, linkSrc);\n        } else {\n            virReportSystemError(errno, _(\"Cannot stat %s\"), linkSrc);\n            return -1;\n        }\n    } else {\n        if (!S_ISLNK(sb.st_mode)) {\n            VIR_WARN(\"Expecting a symlink at %s for controller %s\",\n                     linkSrc, typeStr);\n        } else {\n            controller->linkPoint = g_steal_pointer(&linkSrc);\n        }\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"vircgroupv1.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"vircgroup.h\"",
            "#include \"vircgrouppriv.h\"",
            "#include \"internal.h\"",
            "# include <sys/mount.h>",
            "# include <sys/stat.h>",
            "# include <mntent.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"vircgroupv1.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <sys/stat.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV1ResolveMountLink(const char *mntDir,\n                            const char *typeStr,\n                            virCgroupV1ControllerPtr controller)\n{\n    g_autofree char *linkSrc = NULL;\n    g_autofree char *tmp = NULL;\n    char *dirName;\n    GStatBuf sb;\n\n    tmp = g_strdup(mntDir);\n\n    dirName = strrchr(tmp, '/');\n    if (!dirName) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Missing '/' separator in cgroup mount '%s'\"), tmp);\n        return -1;\n    }\n\n    if (!strchr(dirName + 1, ','))\n        return 0;\n\n    *dirName = '\\0';\n    linkSrc = g_strdup_printf(\"%s/%s\", tmp, typeStr);\n    *dirName = '/';\n\n    if (g_lstat(linkSrc, &sb) < 0) {\n        if (errno == ENOENT) {\n            VIR_WARN(\"Controller %s co-mounted at %s is missing symlink at %s\",\n                     typeStr, tmp, linkSrc);\n        } else {\n            virReportSystemError(errno, _(\"Cannot stat %s\"), linkSrc);\n            return -1;\n        }\n    } else {\n        if (!S_ISLNK(sb.st_mode)) {\n            VIR_WARN(\"Expecting a symlink at %s for controller %s\",\n                     linkSrc, typeStr);\n        } else {\n            controller->linkPoint = g_steal_pointer(&linkSrc);\n        }\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "mntDir"
          ],
          "line": 319
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "controller->linkPoint"
          ],
          "line": 318
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "controller->mountPoint"
          ],
          "line": 317
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCgroupV1MountOptsMatchController",
          "args": [
            "mntOpts",
            "typestr"
          ],
          "line": 307
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupV1MountOptsMatchController",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv1.c",
          "lines": "266-290",
          "snippet": "static bool\nvirCgroupV1MountOptsMatchController(const char *mntOpts,\n                                    const char *typeStr)\n{\n    const char *tmp = mntOpts;\n    int typeLen = strlen(typeStr);\n\n    while (tmp) {\n        const char *next = strchr(tmp, ',');\n        int len;\n        if (next) {\n            len = next - tmp;\n            next++;\n        } else {\n            len = strlen(tmp);\n        }\n\n        if (typeLen == len && STREQLEN(typeStr, tmp, len))\n            return true;\n\n        tmp = next;\n    }\n\n    return false;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"vircgroupv1.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"vircgroup.h\"",
            "#include \"vircgrouppriv.h\"",
            "#include \"internal.h\"",
            "# include <sys/mount.h>",
            "# include <sys/stat.h>",
            "# include <mntent.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"vircgroupv1.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <sys/stat.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic bool\nvirCgroupV1MountOptsMatchController(const char *mntOpts,\n                                    const char *typeStr)\n{\n    const char *tmp = mntOpts;\n    int typeLen = strlen(typeStr);\n\n    while (tmp) {\n        const char *next = strchr(tmp, ',');\n        int len;\n        if (next) {\n            len = next - tmp;\n            next++;\n        } else {\n            len = strlen(tmp);\n        }\n\n        if (typeLen == len && STREQLEN(typeStr, tmp, len))\n            return true;\n\n        tmp = next;\n    }\n\n    return false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCgroupV1ControllerTypeToString",
          "args": [
            "i"
          ],
          "line": 305
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STRNEQ",
          "args": [
            "mntType",
            "\"cgroup\""
          ],
          "line": 301
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"vircgroupv1.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <sys/stat.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV1DetectMounts(virCgroupPtr group,\n                        const char *mntType,\n                        const char *mntOpts,\n                        const char *mntDir)\n{\n    size_t i;\n\n    if (STRNEQ(mntType, \"cgroup\"))\n        return 0;\n\n    for (i = 0; i < VIR_CGROUP_CONTROLLER_LAST; i++) {\n        const char *typestr = virCgroupV1ControllerTypeToString(i);\n\n        if (virCgroupV1MountOptsMatchController(mntOpts, typestr)) {\n            /* Note that the lines in /proc/mounts have the same\n             * order than the mount operations, and that there may\n             * be duplicates due to bind mounts. This means\n             * that the same mount point may be processed more than\n             * once. We need to save the results of the last one,\n             * and we need to be careful to release the memory used\n             * by previous processing. */\n            virCgroupV1ControllerPtr controller = &group->legacy[i];\n\n            VIR_FREE(controller->mountPoint);\n            VIR_FREE(controller->linkPoint);\n            controller->mountPoint = g_strdup(mntDir);\n\n            /* If it is a co-mount it has a filename like \"cpu,cpuacct\"\n             * and we must identify the symlink path */\n            if (virCgroupV1ResolveMountLink(mntDir, typestr, controller) < 0)\n                return -1;\n        }\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virCgroupV1MountOptsMatchController",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv1.c",
    "lines": "266-290",
    "snippet": "static bool\nvirCgroupV1MountOptsMatchController(const char *mntOpts,\n                                    const char *typeStr)\n{\n    const char *tmp = mntOpts;\n    int typeLen = strlen(typeStr);\n\n    while (tmp) {\n        const char *next = strchr(tmp, ',');\n        int len;\n        if (next) {\n            len = next - tmp;\n            next++;\n        } else {\n            len = strlen(tmp);\n        }\n\n        if (typeLen == len && STREQLEN(typeStr, tmp, len))\n            return true;\n\n        tmp = next;\n    }\n\n    return false;\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"vircgroupv1.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <sys/stat.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "STREQLEN",
          "args": [
            "typeStr",
            "tmp",
            "len"
          ],
          "line": 283
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "tmp"
          ],
          "line": 280
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "tmp",
            "','"
          ],
          "line": 274
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "typeStr"
          ],
          "line": 271
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"vircgroupv1.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <sys/stat.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic bool\nvirCgroupV1MountOptsMatchController(const char *mntOpts,\n                                    const char *typeStr)\n{\n    const char *tmp = mntOpts;\n    int typeLen = strlen(typeStr);\n\n    while (tmp) {\n        const char *next = strchr(tmp, ',');\n        int len;\n        if (next) {\n            len = next - tmp;\n            next++;\n        } else {\n            len = strlen(tmp);\n        }\n\n        if (typeLen == len && STREQLEN(typeStr, tmp, len))\n            return true;\n\n        tmp = next;\n    }\n\n    return false;\n}"
  },
  {
    "function_name": "virCgroupV1ResolveMountLink",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv1.c",
    "lines": "219-263",
    "snippet": "static int\nvirCgroupV1ResolveMountLink(const char *mntDir,\n                            const char *typeStr,\n                            virCgroupV1ControllerPtr controller)\n{\n    g_autofree char *linkSrc = NULL;\n    g_autofree char *tmp = NULL;\n    char *dirName;\n    GStatBuf sb;\n\n    tmp = g_strdup(mntDir);\n\n    dirName = strrchr(tmp, '/');\n    if (!dirName) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Missing '/' separator in cgroup mount '%s'\"), tmp);\n        return -1;\n    }\n\n    if (!strchr(dirName + 1, ','))\n        return 0;\n\n    *dirName = '\\0';\n    linkSrc = g_strdup_printf(\"%s/%s\", tmp, typeStr);\n    *dirName = '/';\n\n    if (g_lstat(linkSrc, &sb) < 0) {\n        if (errno == ENOENT) {\n            VIR_WARN(\"Controller %s co-mounted at %s is missing symlink at %s\",\n                     typeStr, tmp, linkSrc);\n        } else {\n            virReportSystemError(errno, _(\"Cannot stat %s\"), linkSrc);\n            return -1;\n        }\n    } else {\n        if (!S_ISLNK(sb.st_mode)) {\n            VIR_WARN(\"Expecting a symlink at %s for controller %s\",\n                     linkSrc, typeStr);\n        } else {\n            controller->linkPoint = g_steal_pointer(&linkSrc);\n        }\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"vircgroupv1.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <sys/stat.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_steal_pointer",
          "args": [
            "&linkSrc"
          ],
          "line": 258
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_WARN",
          "args": [
            "\"Expecting a symlink at %s for controller %s\"",
            "linkSrc",
            "typeStr"
          ],
          "line": 255
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "S_ISLNK",
          "args": [
            "sb.st_mode"
          ],
          "line": 254
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"Cannot stat %s\")",
            "linkSrc"
          ],
          "line": 250
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Cannot stat %s\""
          ],
          "line": 250
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_WARN",
          "args": [
            "\"Controller %s co-mounted at %s is missing symlink at %s\"",
            "typeStr",
            "tmp",
            "linkSrc"
          ],
          "line": 247
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_lstat",
          "args": [
            "linkSrc",
            "&sb"
          ],
          "line": 245
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "dirName + 1",
            "','"
          ],
          "line": 238
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Missing '/' separator in cgroup mount '%s'\")",
            "tmp"
          ],
          "line": 233
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strrchr",
          "args": [
            "tmp",
            "'/'"
          ],
          "line": 231
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"vircgroupv1.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <sys/stat.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV1ResolveMountLink(const char *mntDir,\n                            const char *typeStr,\n                            virCgroupV1ControllerPtr controller)\n{\n    g_autofree char *linkSrc = NULL;\n    g_autofree char *tmp = NULL;\n    char *dirName;\n    GStatBuf sb;\n\n    tmp = g_strdup(mntDir);\n\n    dirName = strrchr(tmp, '/');\n    if (!dirName) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Missing '/' separator in cgroup mount '%s'\"), tmp);\n        return -1;\n    }\n\n    if (!strchr(dirName + 1, ','))\n        return 0;\n\n    *dirName = '\\0';\n    linkSrc = g_strdup_printf(\"%s/%s\", tmp, typeStr);\n    *dirName = '/';\n\n    if (g_lstat(linkSrc, &sb) < 0) {\n        if (errno == ENOENT) {\n            VIR_WARN(\"Controller %s co-mounted at %s is missing symlink at %s\",\n                     typeStr, tmp, linkSrc);\n        } else {\n            virReportSystemError(errno, _(\"Cannot stat %s\"), linkSrc);\n            return -1;\n        }\n    } else {\n        if (!S_ISLNK(sb.st_mode)) {\n            VIR_WARN(\"Expecting a symlink at %s for controller %s\",\n                     linkSrc, typeStr);\n        } else {\n            controller->linkPoint = g_steal_pointer(&linkSrc);\n        }\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virCgroupV1CopyPlacement",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv1.c",
    "lines": "186-216",
    "snippet": "static int\nvirCgroupV1CopyPlacement(virCgroupPtr group,\n                         const char *path,\n                         virCgroupPtr parent)\n{\n    size_t i;\n    for (i = 0; i < VIR_CGROUP_CONTROLLER_LAST; i++) {\n        if (!group->legacy[i].mountPoint)\n            continue;\n\n        if (i == VIR_CGROUP_CONTROLLER_SYSTEMD)\n            continue;\n\n        if (path[0] == '/') {\n            group->legacy[i].placement = g_strdup(path);\n        } else {\n            bool delim = STREQ(parent->legacy[i].placement, \"/\") || STREQ(path, \"\");\n            /*\n             * parent == \"/\" + path=\"\" => \"/\"\n             * parent == \"/libvirt.service\" + path == \"\" => \"/libvirt.service\"\n             * parent == \"/libvirt.service\" + path == \"foo\" => \"/libvirt.service/foo\"\n             */\n            group->legacy[i].placement = g_strdup_printf(\"%s%s%s\",\n                                                         parent->legacy[i].placement,\n                                                         delim ? \"\" : \"/\",\n                                                         path);\n        }\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"vircgroupv1.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <sys/stat.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"%s%s%s\"",
            "parent->legacy[i].placement",
            "delim ? \"\" : \"/\"",
            "path"
          ],
          "line": 208
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "path",
            "\"\""
          ],
          "line": 202
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "parent->legacy[i].placement",
            "\"/\""
          ],
          "line": 202
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"vircgroupv1.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <sys/stat.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV1CopyPlacement(virCgroupPtr group,\n                         const char *path,\n                         virCgroupPtr parent)\n{\n    size_t i;\n    for (i = 0; i < VIR_CGROUP_CONTROLLER_LAST; i++) {\n        if (!group->legacy[i].mountPoint)\n            continue;\n\n        if (i == VIR_CGROUP_CONTROLLER_SYSTEMD)\n            continue;\n\n        if (path[0] == '/') {\n            group->legacy[i].placement = g_strdup(path);\n        } else {\n            bool delim = STREQ(parent->legacy[i].placement, \"/\") || STREQ(path, \"\");\n            /*\n             * parent == \"/\" + path=\"\" => \"/\"\n             * parent == \"/libvirt.service\" + path == \"\" => \"/libvirt.service\"\n             * parent == \"/libvirt.service\" + path == \"foo\" => \"/libvirt.service/foo\"\n             */\n            group->legacy[i].placement = g_strdup_printf(\"%s%s%s\",\n                                                         parent->legacy[i].placement,\n                                                         delim ? \"\" : \"/\",\n                                                         path);\n        }\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virCgroupV1CopyMounts",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv1.c",
    "lines": "169-183",
    "snippet": "static int\nvirCgroupV1CopyMounts(virCgroupPtr group,\n                      virCgroupPtr parent)\n{\n    size_t i;\n    for (i = 0; i < VIR_CGROUP_CONTROLLER_LAST; i++) {\n        if (!parent->legacy[i].mountPoint)\n            continue;\n\n        group->legacy[i].mountPoint = g_strdup(parent->legacy[i].mountPoint);\n\n        group->legacy[i].linkPoint = g_strdup(parent->legacy[i].linkPoint);\n    }\n    return 0;\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"vircgroupv1.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <sys/stat.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "parent->legacy[i].linkPoint"
          ],
          "line": 180
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"vircgroupv1.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <sys/stat.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic int\nvirCgroupV1CopyMounts(virCgroupPtr group,\n                      virCgroupPtr parent)\n{\n    size_t i;\n    for (i = 0; i < VIR_CGROUP_CONTROLLER_LAST; i++) {\n        if (!parent->legacy[i].mountPoint)\n            continue;\n\n        group->legacy[i].mountPoint = g_strdup(parent->legacy[i].mountPoint);\n\n        group->legacy[i].linkPoint = g_strdup(parent->legacy[i].linkPoint);\n    }\n    return 0;\n}"
  },
  {
    "function_name": "virCgroupV1ValidateMachineGroup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv1.c",
    "lines": "89-166",
    "snippet": "static bool\nvirCgroupV1ValidateMachineGroup(virCgroupPtr group,\n                                const char *name,\n                                const char *drivername,\n                                const char *machinename)\n{\n    size_t i;\n    g_autofree char *partname = NULL;\n    g_autofree char *scopename_old = NULL;\n    g_autofree char *scopename_new = NULL;\n    g_autofree char *partmachinename = NULL;\n\n    partname = g_strdup_printf(\"%s.libvirt-%s\", name, drivername);\n\n    if (virCgroupPartitionEscape(&partname) < 0)\n        return false;\n\n    partmachinename = g_strdup_printf(\"%s.libvirt-%s\",\n                                      machinename, drivername);\n\n    if (virCgroupPartitionEscape(&partmachinename) < 0)\n        return false;\n\n    if (!(scopename_old = virSystemdMakeScopeName(name, drivername, true)))\n        return false;\n\n    if (!(scopename_new = virSystemdMakeScopeName(machinename,\n                                                  drivername, false)))\n        return false;\n\n    if (virCgroupPartitionEscape(&scopename_old) < 0)\n        return false;\n\n    if (virCgroupPartitionEscape(&scopename_new) < 0)\n        return false;\n\n    for (i = 0; i < VIR_CGROUP_CONTROLLER_LAST; i++) {\n        char *tmp;\n\n        if (i == VIR_CGROUP_CONTROLLER_SYSTEMD)\n            continue;\n\n        if (!group->legacy[i].placement)\n            continue;\n\n        tmp = strrchr(group->legacy[i].placement, '/');\n        if (!tmp)\n            return false;\n\n        if (i == VIR_CGROUP_CONTROLLER_CPU ||\n            i == VIR_CGROUP_CONTROLLER_CPUACCT ||\n            i == VIR_CGROUP_CONTROLLER_CPUSET) {\n            if (STREQ(tmp, \"/emulator\"))\n                *tmp = '\\0';\n            tmp = strrchr(group->legacy[i].placement, '/');\n            if (!tmp)\n                return false;\n        }\n\n        tmp++;\n\n        if (STRNEQ(tmp, name) &&\n            STRNEQ(tmp, machinename) &&\n            STRNEQ(tmp, partname) &&\n            STRNEQ(tmp, partmachinename) &&\n            STRNEQ(tmp, scopename_old) &&\n            STRNEQ(tmp, scopename_new)) {\n            VIR_DEBUG(\"Name '%s' for controller '%s' does not match \"\n                      \"'%s', '%s', '%s', '%s' or '%s'\",\n                      tmp, virCgroupV1ControllerTypeToString(i),\n                      name, machinename, partname,\n                      scopename_old, scopename_new);\n            return false;\n        }\n    }\n\n    return true;\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"vircgroupv1.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <sys/stat.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Name '%s' for controller '%s' does not match \"\n                      \"'%s', '%s', '%s', '%s' or '%s'\"",
            "tmp",
            "virCgroupV1ControllerTypeToString(i)",
            "name",
            "machinename",
            "partname",
            "scopename_old",
            "scopename_new"
          ],
          "line": 156
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCgroupV1ControllerTypeToString",
          "args": [
            "i"
          ],
          "line": 158
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STRNEQ",
          "args": [
            "tmp",
            "scopename_new"
          ],
          "line": 155
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STRNEQ",
          "args": [
            "tmp",
            "scopename_old"
          ],
          "line": 154
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STRNEQ",
          "args": [
            "tmp",
            "partmachinename"
          ],
          "line": 153
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STRNEQ",
          "args": [
            "tmp",
            "partname"
          ],
          "line": 152
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STRNEQ",
          "args": [
            "tmp",
            "machinename"
          ],
          "line": 151
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STRNEQ",
          "args": [
            "tmp",
            "name"
          ],
          "line": 150
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strrchr",
          "args": [
            "group->legacy[i].placement",
            "'/'"
          ],
          "line": 143
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "tmp",
            "\"/emulator\""
          ],
          "line": 141
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strrchr",
          "args": [
            "group->legacy[i].placement",
            "'/'"
          ],
          "line": 134
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCgroupPartitionEscape",
          "args": [
            "&scopename_new"
          ],
          "line": 122
        },
        "resolved": true,
        "details": {
          "function_name": "virCgroupPartitionEscape",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroup.c",
          "lines": "198-213",
          "snippet": "int\nvirCgroupPartitionEscape(char **path)\n{\n    int rc;\n    char *newstr = NULL;\n\n    if ((rc = virCgroupPartitionNeedsEscaping(*path)) <= 0)\n        return rc;\n\n    newstr = g_strdup_printf(\"_%s\", *path);\n\n    VIR_FREE(*path);\n    *path = newstr;\n\n    return 0;\n}",
          "includes": [
            "#include \"virthread.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virstring.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"vircgroupbackend.h\"",
            "#include \"viralloc.h\"",
            "#include \"virutil.h\"",
            "#include \"vircgrouppriv.h\"",
            "# include <unistd.h>",
            "# include <dirent.h>",
            "# include <signal.h>",
            "# include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <sys/stat.h>",
            "# include <fcntl.h>",
            "# include <sys/mount.h>",
            "# include <mntent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthread.h\"\n#include \"virhostcpu.h\"\n#include \"virtypedparam.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virhashcode.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"vircgroupbackend.h\"\n#include \"viralloc.h\"\n#include \"virutil.h\"\n#include \"vircgrouppriv.h\"\n# include <unistd.h>\n# include <dirent.h>\n# include <signal.h>\n# include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <sys/stat.h>\n# include <fcntl.h>\n# include <sys/mount.h>\n# include <mntent.h>\n#include <config.h>\n\nint\nvirCgroupPartitionEscape(char **path)\n{\n    int rc;\n    char *newstr = NULL;\n\n    if ((rc = virCgroupPartitionNeedsEscaping(*path)) <= 0)\n        return rc;\n\n    newstr = g_strdup_printf(\"_%s\", *path);\n\n    VIR_FREE(*path);\n    *path = newstr;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSystemdMakeScopeName",
          "args": [
            "machinename",
            "drivername",
            "false"
          ],
          "line": 115
        },
        "resolved": true,
        "details": {
          "function_name": "virSystemdMakeScopeName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsystemd.c",
          "lines": "99-114",
          "snippet": "char *virSystemdMakeScopeName(const char *name,\n                              const char *drivername,\n                              bool legacy_behaviour)\n{\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n\n    virBufferAddLit(&buf, \"machine-\");\n    if (legacy_behaviour) {\n        virSystemdEscapeName(&buf, drivername);\n        virBufferAddLit(&buf, \"\\\\x2d\");\n    }\n    virSystemdEscapeName(&buf, name);\n    virBufferAddLit(&buf, \".scope\");\n\n    return virBufferContentAndReset(&buf);\n}",
          "includes": [
            "#include \"virsocketaddr.h\"",
            "#include \"virhash.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virdbus.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virsystemdpriv.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocketaddr.h\"\n#include \"virhash.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virdbus.h\"\n#include \"virbuffer.h\"\n#include \"virsystemd.h\"\n#include \"virsystemdpriv.h\"\n#include <config.h>\n\nchar *virSystemdMakeScopeName(const char *name,\n                              const char *drivername,\n                              bool legacy_behaviour)\n{\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n\n    virBufferAddLit(&buf, \"machine-\");\n    if (legacy_behaviour) {\n        virSystemdEscapeName(&buf, drivername);\n        virBufferAddLit(&buf, \"\\\\x2d\");\n    }\n    virSystemdEscapeName(&buf, name);\n    virBufferAddLit(&buf, \".scope\");\n\n    return virBufferContentAndReset(&buf);\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"%s.libvirt-%s\"",
            "machinename",
            "drivername"
          ],
          "line": 106
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"vircgroupv1.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <sys/stat.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic bool\nvirCgroupV1ValidateMachineGroup(virCgroupPtr group,\n                                const char *name,\n                                const char *drivername,\n                                const char *machinename)\n{\n    size_t i;\n    g_autofree char *partname = NULL;\n    g_autofree char *scopename_old = NULL;\n    g_autofree char *scopename_new = NULL;\n    g_autofree char *partmachinename = NULL;\n\n    partname = g_strdup_printf(\"%s.libvirt-%s\", name, drivername);\n\n    if (virCgroupPartitionEscape(&partname) < 0)\n        return false;\n\n    partmachinename = g_strdup_printf(\"%s.libvirt-%s\",\n                                      machinename, drivername);\n\n    if (virCgroupPartitionEscape(&partmachinename) < 0)\n        return false;\n\n    if (!(scopename_old = virSystemdMakeScopeName(name, drivername, true)))\n        return false;\n\n    if (!(scopename_new = virSystemdMakeScopeName(machinename,\n                                                  drivername, false)))\n        return false;\n\n    if (virCgroupPartitionEscape(&scopename_old) < 0)\n        return false;\n\n    if (virCgroupPartitionEscape(&scopename_new) < 0)\n        return false;\n\n    for (i = 0; i < VIR_CGROUP_CONTROLLER_LAST; i++) {\n        char *tmp;\n\n        if (i == VIR_CGROUP_CONTROLLER_SYSTEMD)\n            continue;\n\n        if (!group->legacy[i].placement)\n            continue;\n\n        tmp = strrchr(group->legacy[i].placement, '/');\n        if (!tmp)\n            return false;\n\n        if (i == VIR_CGROUP_CONTROLLER_CPU ||\n            i == VIR_CGROUP_CONTROLLER_CPUACCT ||\n            i == VIR_CGROUP_CONTROLLER_CPUSET) {\n            if (STREQ(tmp, \"/emulator\"))\n                *tmp = '\\0';\n            tmp = strrchr(group->legacy[i].placement, '/');\n            if (!tmp)\n                return false;\n        }\n\n        tmp++;\n\n        if (STRNEQ(tmp, name) &&\n            STRNEQ(tmp, machinename) &&\n            STRNEQ(tmp, partname) &&\n            STRNEQ(tmp, partmachinename) &&\n            STRNEQ(tmp, scopename_old) &&\n            STRNEQ(tmp, scopename_new)) {\n            VIR_DEBUG(\"Name '%s' for controller '%s' does not match \"\n                      \"'%s', '%s', '%s', '%s' or '%s'\",\n                      tmp, virCgroupV1ControllerTypeToString(i),\n                      name, machinename, partname,\n                      scopename_old, scopename_new);\n            return false;\n        }\n    }\n\n    return true;\n}"
  },
  {
    "function_name": "virCgroupV1Available",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircgroupv1.c",
    "lines": "63-86",
    "snippet": "static bool\nvirCgroupV1Available(void)\n{\n    bool ret = false;\n    FILE *mounts = NULL;\n    struct mntent entry;\n    char buf[CGROUP_MAX_VAL];\n\n    if (!virFileExists(\"/proc/cgroups\"))\n        return false;\n\n    if (!(mounts = fopen(\"/proc/mounts\", \"r\")))\n        return false;\n\n    while (getmntent_r(mounts, &entry, buf, sizeof(buf)) != NULL) {\n        if (STREQ(entry.mnt_type, \"cgroup\") && !strstr(entry.mnt_opts, \"name=\")) {\n            ret = true;\n            break;\n        }\n    }\n\n    VIR_FORCE_FCLOSE(mounts);\n    return ret;\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virerror.h\"",
      "#include \"virsystemd.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virfile.h\"",
      "#include \"vircgroupv1.h\"",
      "#include \"vircgroupbackend.h\"",
      "#include \"vircgroup.h\"",
      "#include \"vircgrouppriv.h\"",
      "#include \"internal.h\"",
      "# include <sys/mount.h>",
      "# include <sys/stat.h>",
      "# include <mntent.h>",
      "#include <unistd.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FORCE_FCLOSE",
          "args": [
            "mounts"
          ],
          "line": 84
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strstr",
          "args": [
            "entry.mnt_opts",
            "\"name=\""
          ],
          "line": 78
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "entry.mnt_type",
            "\"cgroup\""
          ],
          "line": 78
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getmntent_r",
          "args": [
            "mounts",
            "&entry",
            "buf",
            "sizeof(buf)"
          ],
          "line": 77
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fopen",
          "args": [
            "\"/proc/mounts\"",
            "\"r\""
          ],
          "line": 74
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virFileExists",
          "args": [
            "\"/proc/cgroups\""
          ],
          "line": 71
        },
        "resolved": true,
        "details": {
          "function_name": "virFileExists",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1873-1877",
          "snippet": "bool\nvirFileExists(const char *path)\n{\n    return access(path, F_OK) == 0;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nbool\nvirFileExists(const char *path)\n{\n    return access(path, F_OK) == 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virsystemd.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"vircgroupv1.h\"\n#include \"vircgroupbackend.h\"\n#include \"vircgroup.h\"\n#include \"vircgrouppriv.h\"\n#include \"internal.h\"\n# include <sys/mount.h>\n# include <sys/stat.h>\n# include <mntent.h>\n#include <unistd.h>\n#include <config.h>\n\nstatic bool\nvirCgroupV1Available(void)\n{\n    bool ret = false;\n    FILE *mounts = NULL;\n    struct mntent entry;\n    char buf[CGROUP_MAX_VAL];\n\n    if (!virFileExists(\"/proc/cgroups\"))\n        return false;\n\n    if (!(mounts = fopen(\"/proc/mounts\", \"r\")))\n        return false;\n\n    while (getmntent_r(mounts, &entry, buf, sizeof(buf)) != NULL) {\n        if (STREQ(entry.mnt_type, \"cgroup\") && !strstr(entry.mnt_opts, \"name=\")) {\n            ret = true;\n            break;\n        }\n    }\n\n    VIR_FORCE_FCLOSE(mounts);\n    return ret;\n}"
  }
]