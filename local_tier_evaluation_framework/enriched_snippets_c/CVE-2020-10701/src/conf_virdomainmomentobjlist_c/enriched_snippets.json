[
  {
    "function_name": "virDomainMomentFindLeaf",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainmomentobjlist.c",
    "lines": "590-602",
    "snippet": "virDomainMomentObjPtr\nvirDomainMomentFindLeaf(virDomainMomentObjListPtr list)\n{\n    virDomainMomentObjPtr moment = &list->metaroot;\n\n    if (moment->nchildren != 1)\n        return NULL;\n    while (moment->nchildren == 1)\n        moment = moment->first_child;\n    if (moment->nchildren == 0)\n        return moment;\n    return NULL;\n}",
    "includes": [
      "#include \"virdomaincheckpointobjlist.h\"",
      "#include \"virdomainsnapshotobjlist.h\"",
      "#include \"viralloc.h\"",
      "#include \"moment_conf.h\"",
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"virdomainmomentobjlist.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"viralloc.h\"\n#include \"moment_conf.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virdomainmomentobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvirDomainMomentObjPtr\nvirDomainMomentFindLeaf(virDomainMomentObjListPtr list)\n{\n    virDomainMomentObjPtr moment = &list->metaroot;\n\n    if (moment->nchildren != 1)\n        return NULL;\n    while (moment->nchildren == 1)\n        moment = moment->first_child;\n    if (moment->nchildren == 0)\n        return moment;\n    return NULL;\n}"
  },
  {
    "function_name": "virDomainMomentCheckCycles",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainmomentobjlist.c",
    "lines": "550-587",
    "snippet": "int\nvirDomainMomentCheckCycles(virDomainMomentObjListPtr list,\n                           virDomainMomentDefPtr def,\n                           const char *domname)\n{\n    virDomainMomentObjPtr other;\n\n    if (def->parent_name) {\n        if (STREQ(def->name, def->parent_name)) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"cannot set moment %s as its own parent\"),\n                           def->name);\n            return -1;\n        }\n        other = virDomainMomentFindByName(list, def->parent_name);\n        if (!other) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"parent %s for moment %s not found\"),\n                           def->parent_name, def->name);\n            return -1;\n        }\n        while (other->def->parent_name) {\n            if (STREQ(other->def->parent_name, def->name)) {\n                virReportError(VIR_ERR_INVALID_ARG,\n                               _(\"parent %s would create cycle to %s\"),\n                               other->def->name, def->name);\n                return -1;\n            }\n            other = virDomainMomentFindByName(list, other->def->parent_name);\n            if (!other) {\n                VIR_WARN(\"moments are inconsistent for domain %s\",\n                         domname);\n                break;\n            }\n        }\n    }\n    return 0;\n}",
    "includes": [
      "#include \"virdomaincheckpointobjlist.h\"",
      "#include \"virdomainsnapshotobjlist.h\"",
      "#include \"viralloc.h\"",
      "#include \"moment_conf.h\"",
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"virdomainmomentobjlist.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_WARN",
          "args": [
            "\"moments are inconsistent for domain %s\"",
            "domname"
          ],
          "line": 580
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainMomentFindByName",
          "args": [
            "list",
            "other->def->parent_name"
          ],
          "line": 578
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainMomentFindByName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainmomentobjlist.c",
          "lines": "406-413",
          "snippet": "virDomainMomentObjPtr\nvirDomainMomentFindByName(virDomainMomentObjListPtr moments,\n                          const char *name)\n{\n    if (name)\n        return virHashLookup(moments->objs, name);\n    return NULL;\n}",
          "includes": [
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"viralloc.h\"",
            "#include \"moment_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"virdomainmomentobjlist.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"viralloc.h\"\n#include \"moment_conf.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virdomainmomentobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvirDomainMomentObjPtr\nvirDomainMomentFindByName(virDomainMomentObjListPtr moments,\n                          const char *name)\n{\n    if (name)\n        return virHashLookup(moments->objs, name);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INVALID_ARG",
            "_(\"parent %s would create cycle to %s\")",
            "other->def->name",
            "def->name"
          ],
          "line": 573
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"parent %s would create cycle to %s\""
          ],
          "line": 574
        },
        "resolved": true,
        "details": {
          "function_name": "ATTRIBUTE_NONNULL",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/cpu_conf.c",
          "lines": "135-141",
          "snippet": "int ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "other->def->parent_name",
            "def->name"
          ],
          "line": 572
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INVALID_ARG",
            "_(\"parent %s for moment %s not found\")",
            "def->parent_name",
            "def->name"
          ],
          "line": 566
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INVALID_ARG",
            "_(\"cannot set moment %s as its own parent\")",
            "def->name"
          ],
          "line": 559
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "def->name",
            "def->parent_name"
          ],
          "line": 558
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"viralloc.h\"\n#include \"moment_conf.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virdomainmomentobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirDomainMomentCheckCycles(virDomainMomentObjListPtr list,\n                           virDomainMomentDefPtr def,\n                           const char *domname)\n{\n    virDomainMomentObjPtr other;\n\n    if (def->parent_name) {\n        if (STREQ(def->name, def->parent_name)) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"cannot set moment %s as its own parent\"),\n                           def->name);\n            return -1;\n        }\n        other = virDomainMomentFindByName(list, def->parent_name);\n        if (!other) {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"parent %s for moment %s not found\"),\n                           def->parent_name, def->name);\n            return -1;\n        }\n        while (other->def->parent_name) {\n            if (STREQ(other->def->parent_name, def->name)) {\n                virReportError(VIR_ERR_INVALID_ARG,\n                               _(\"parent %s would create cycle to %s\"),\n                               other->def->name, def->name);\n                return -1;\n            }\n            other = virDomainMomentFindByName(list, other->def->parent_name);\n            if (!other) {\n                VIR_WARN(\"moments are inconsistent for domain %s\",\n                         domname);\n                break;\n            }\n        }\n    }\n    return 0;\n}"
  },
  {
    "function_name": "virDomainMomentUpdateRelations",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainmomentobjlist.c",
    "lines": "533-543",
    "snippet": "int\nvirDomainMomentUpdateRelations(virDomainMomentObjListPtr moments)\n{\n    struct moment_set_relation act = { moments, 0 };\n\n    virDomainMomentDropChildren(&moments->metaroot);\n    virHashForEach(moments->objs, virDomainMomentSetRelations, &act);\n    if (act.err)\n        moments->current = NULL;\n    return act.err;\n}",
    "includes": [
      "#include \"virdomaincheckpointobjlist.h\"",
      "#include \"virdomainsnapshotobjlist.h\"",
      "#include \"viralloc.h\"",
      "#include \"moment_conf.h\"",
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"virdomainmomentobjlist.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virHashForEach",
          "args": [
            "moments->objs",
            "virDomainMomentSetRelations",
            "&act"
          ],
          "line": 539
        },
        "resolved": true,
        "details": {
          "function_name": "virHashForEach",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "626-649",
          "snippet": "int\nvirHashForEach(virHashTablePtr table, virHashIterator iter, void *data)\n{\n    size_t i;\n    int ret = -1;\n\n    if (table == NULL || iter == NULL)\n        return -1;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr entry = table->table[i];\n        while (entry) {\n            virHashEntryPtr next = entry->next;\n            ret = iter(entry->payload, entry->name, data);\n\n            if (ret < 0)\n                return ret;\n\n            entry = next;\n        }\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint\nvirHashForEach(virHashTablePtr table, virHashIterator iter, void *data)\n{\n    size_t i;\n    int ret = -1;\n\n    if (table == NULL || iter == NULL)\n        return -1;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr entry = table->table[i];\n        while (entry) {\n            virHashEntryPtr next = entry->next;\n            ret = iter(entry->payload, entry->name, data);\n\n            if (ret < 0)\n                return ret;\n\n            entry = next;\n        }\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainMomentDropChildren",
          "args": [
            "&moments->metaroot"
          ],
          "line": 538
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainMomentDropChildren",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainmomentobjlist.c",
          "lines": "145-150",
          "snippet": "void\nvirDomainMomentDropChildren(virDomainMomentObjPtr moment)\n{\n    moment->nchildren = 0;\n    moment->first_child = NULL;\n}",
          "includes": [
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"viralloc.h\"",
            "#include \"moment_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"virdomainmomentobjlist.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"viralloc.h\"\n#include \"moment_conf.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virdomainmomentobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvoid\nvirDomainMomentDropChildren(virDomainMomentObjPtr moment)\n{\n    moment->nchildren = 0;\n    moment->first_child = NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"viralloc.h\"\n#include \"moment_conf.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virdomainmomentobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirDomainMomentUpdateRelations(virDomainMomentObjListPtr moments)\n{\n    struct moment_set_relation act = { moments, 0 };\n\n    virDomainMomentDropChildren(&moments->metaroot);\n    virHashForEach(moments->objs, virDomainMomentSetRelations, &act);\n    if (act.err)\n        moments->current = NULL;\n    return act.err;\n}"
  },
  {
    "function_name": "virDomainMomentSetRelations",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainmomentobjlist.c",
    "lines": "494-526",
    "snippet": "static int\nvirDomainMomentSetRelations(void *payload,\n                            const void *name G_GNUC_UNUSED,\n                            void *data)\n{\n    virDomainMomentObjPtr obj = payload;\n    struct moment_set_relation *curr = data;\n    virDomainMomentObjPtr tmp;\n    virDomainMomentObjPtr parent;\n\n    parent = virDomainMomentFindByName(curr->moments, obj->def->parent_name);\n    if (!parent) {\n        parent = &curr->moments->metaroot;\n        if (obj->def->parent_name) {\n            curr->err = -1;\n            VIR_WARN(\"moment %s lacks parent %s\", obj->def->name,\n                     obj->def->parent_name);\n        }\n    } else {\n        tmp = parent;\n        while (tmp && tmp->def) {\n            if (tmp == obj) {\n                curr->err = -1;\n                parent = &curr->moments->metaroot;\n                VIR_WARN(\"moment %s in circular chain\", obj->def->name);\n                break;\n            }\n            tmp = tmp->parent;\n        }\n    }\n    virDomainMomentSetParent(obj, parent);\n    return 0;\n}",
    "includes": [
      "#include \"virdomaincheckpointobjlist.h\"",
      "#include \"virdomainsnapshotobjlist.h\"",
      "#include \"viralloc.h\"",
      "#include \"moment_conf.h\"",
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"virdomainmomentobjlist.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainMomentSetParent",
          "args": [
            "obj",
            "parent"
          ],
          "line": 524
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainMomentSetParent",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainmomentobjlist.c",
          "lines": "154-162",
          "snippet": "static void\nvirDomainMomentSetParent(virDomainMomentObjPtr moment,\n                         virDomainMomentObjPtr parent)\n{\n    moment->parent = parent;\n    parent->nchildren++;\n    moment->sibling = parent->first_child;\n    parent->first_child = moment;\n}",
          "includes": [
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"viralloc.h\"",
            "#include \"moment_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"virdomainmomentobjlist.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"viralloc.h\"\n#include \"moment_conf.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virdomainmomentobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic void\nvirDomainMomentSetParent(virDomainMomentObjPtr moment,\n                         virDomainMomentObjPtr parent)\n{\n    moment->parent = parent;\n    parent->nchildren++;\n    moment->sibling = parent->first_child;\n    parent->first_child = moment;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_WARN",
          "args": [
            "\"moment %s in circular chain\"",
            "obj->def->name"
          ],
          "line": 518
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_WARN",
          "args": [
            "\"moment %s lacks parent %s\"",
            "obj->def->name",
            "obj->def->parent_name"
          ],
          "line": 509
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainMomentFindByName",
          "args": [
            "curr->moments",
            "obj->def->parent_name"
          ],
          "line": 504
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainMomentFindByName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainmomentobjlist.c",
          "lines": "406-413",
          "snippet": "virDomainMomentObjPtr\nvirDomainMomentFindByName(virDomainMomentObjListPtr moments,\n                          const char *name)\n{\n    if (name)\n        return virHashLookup(moments->objs, name);\n    return NULL;\n}",
          "includes": [
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"viralloc.h\"",
            "#include \"moment_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"virdomainmomentobjlist.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"viralloc.h\"\n#include \"moment_conf.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virdomainmomentobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvirDomainMomentObjPtr\nvirDomainMomentFindByName(virDomainMomentObjListPtr moments,\n                          const char *name)\n{\n    if (name)\n        return virHashLookup(moments->objs, name);\n    return NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"viralloc.h\"\n#include \"moment_conf.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virdomainmomentobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nvirDomainMomentSetRelations(void *payload,\n                            const void *name G_GNUC_UNUSED,\n                            void *data)\n{\n    virDomainMomentObjPtr obj = payload;\n    struct moment_set_relation *curr = data;\n    virDomainMomentObjPtr tmp;\n    virDomainMomentObjPtr parent;\n\n    parent = virDomainMomentFindByName(curr->moments, obj->def->parent_name);\n    if (!parent) {\n        parent = &curr->moments->metaroot;\n        if (obj->def->parent_name) {\n            curr->err = -1;\n            VIR_WARN(\"moment %s lacks parent %s\", obj->def->name,\n                     obj->def->parent_name);\n        }\n    } else {\n        tmp = parent;\n        while (tmp && tmp->def) {\n            if (tmp == obj) {\n                curr->err = -1;\n                parent = &curr->moments->metaroot;\n                VIR_WARN(\"moment %s in circular chain\", obj->def->name);\n                break;\n            }\n            tmp = tmp->parent;\n        }\n    }\n    virDomainMomentSetParent(obj, parent);\n    return 0;\n}"
  },
  {
    "function_name": "virDomainMomentForEach",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainmomentobjlist.c",
    "lines": "475-481",
    "snippet": "int\nvirDomainMomentForEach(virDomainMomentObjListPtr moments,\n                       virHashIterator iter,\n                       void *data)\n{\n    return virHashForEach(moments->objs, iter, data);\n}",
    "includes": [
      "#include \"virdomaincheckpointobjlist.h\"",
      "#include \"virdomainsnapshotobjlist.h\"",
      "#include \"viralloc.h\"",
      "#include \"moment_conf.h\"",
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"virdomainmomentobjlist.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virHashForEach",
          "args": [
            "moments->objs",
            "iter",
            "data"
          ],
          "line": 480
        },
        "resolved": true,
        "details": {
          "function_name": "virHashForEach",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "626-649",
          "snippet": "int\nvirHashForEach(virHashTablePtr table, virHashIterator iter, void *data)\n{\n    size_t i;\n    int ret = -1;\n\n    if (table == NULL || iter == NULL)\n        return -1;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr entry = table->table[i];\n        while (entry) {\n            virHashEntryPtr next = entry->next;\n            ret = iter(entry->payload, entry->name, data);\n\n            if (ret < 0)\n                return ret;\n\n            entry = next;\n        }\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint\nvirHashForEach(virHashTablePtr table, virHashIterator iter, void *data)\n{\n    size_t i;\n    int ret = -1;\n\n    if (table == NULL || iter == NULL)\n        return -1;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr entry = table->table[i];\n        while (entry) {\n            virHashEntryPtr next = entry->next;\n            ret = iter(entry->payload, entry->name, data);\n\n            if (ret < 0)\n                return ret;\n\n            entry = next;\n        }\n    }\n\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"viralloc.h\"\n#include \"moment_conf.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virdomainmomentobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirDomainMomentForEach(virDomainMomentObjListPtr moments,\n                       virHashIterator iter,\n                       void *data)\n{\n    return virHashForEach(moments->objs, iter, data);\n}"
  },
  {
    "function_name": "virDomainMomentObjListRemoveAll",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainmomentobjlist.c",
    "lines": "466-471",
    "snippet": "void\nvirDomainMomentObjListRemoveAll(virDomainMomentObjListPtr moments)\n{\n    virHashRemoveAll(moments->objs);\n    virDomainMomentDropChildren(&moments->metaroot);\n}",
    "includes": [
      "#include \"virdomaincheckpointobjlist.h\"",
      "#include \"virdomainsnapshotobjlist.h\"",
      "#include \"viralloc.h\"",
      "#include \"moment_conf.h\"",
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"virdomainmomentobjlist.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainMomentDropChildren",
          "args": [
            "&moments->metaroot"
          ],
          "line": 470
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainMomentDropChildren",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainmomentobjlist.c",
          "lines": "145-150",
          "snippet": "void\nvirDomainMomentDropChildren(virDomainMomentObjPtr moment)\n{\n    moment->nchildren = 0;\n    moment->first_child = NULL;\n}",
          "includes": [
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"viralloc.h\"",
            "#include \"moment_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"virdomainmomentobjlist.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"viralloc.h\"\n#include \"moment_conf.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virdomainmomentobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvoid\nvirDomainMomentDropChildren(virDomainMomentObjPtr moment)\n{\n    moment->nchildren = 0;\n    moment->first_child = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashRemoveAll",
          "args": [
            "moments->objs"
          ],
          "line": 469
        },
        "resolved": true,
        "details": {
          "function_name": "virHashRemoveAll",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "715-721",
          "snippet": "ssize_t\nvirHashRemoveAll(virHashTablePtr table)\n{\n    return virHashRemoveSet(table,\n                            _virHashRemoveAllIter,\n                            NULL);\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nssize_t\nvirHashRemoveAll(virHashTablePtr table)\n{\n    return virHashRemoveSet(table,\n                            _virHashRemoveAllIter,\n                            NULL);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"viralloc.h\"\n#include \"moment_conf.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virdomainmomentobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvoid\nvirDomainMomentObjListRemoveAll(virDomainMomentObjListPtr moments)\n{\n    virHashRemoveAll(moments->objs);\n    virDomainMomentDropChildren(&moments->metaroot);\n}"
  },
  {
    "function_name": "virDomainMomentObjListRemove",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainmomentobjlist.c",
    "lines": "452-462",
    "snippet": "bool\nvirDomainMomentObjListRemove(virDomainMomentObjListPtr moments,\n                             virDomainMomentObjPtr moment)\n{\n    bool ret = moments->current == moment;\n\n    virHashRemoveEntry(moments->objs, moment->def->name);\n    if (ret)\n        moments->current = NULL;\n    return ret;\n}",
    "includes": [
      "#include \"virdomaincheckpointobjlist.h\"",
      "#include \"virdomainsnapshotobjlist.h\"",
      "#include \"viralloc.h\"",
      "#include \"moment_conf.h\"",
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"virdomainmomentobjlist.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virHashRemoveEntry",
          "args": [
            "moments->objs",
            "moment->def->name"
          ],
          "line": 458
        },
        "resolved": true,
        "details": {
          "function_name": "virHashRemoveEntry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "584-609",
          "snippet": "int\nvirHashRemoveEntry(virHashTablePtr table, const void *name)\n{\n    virHashEntryPtr entry;\n    virHashEntryPtr *nextptr;\n\n    if (table == NULL || name == NULL)\n        return -1;\n\n    nextptr = table->table + virHashComputeKey(table, name);\n    for (entry = *nextptr; entry; entry = entry->next) {\n        if (table->keyEqual(entry->name, name)) {\n            if (table->dataFree)\n                table->dataFree(entry->payload);\n            if (table->keyFree)\n                table->keyFree(entry->name);\n            *nextptr = entry->next;\n            VIR_FREE(entry);\n            table->nbElems--;\n            return 0;\n        }\n        nextptr = &entry->next;\n    }\n\n    return -1;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint\nvirHashRemoveEntry(virHashTablePtr table, const void *name)\n{\n    virHashEntryPtr entry;\n    virHashEntryPtr *nextptr;\n\n    if (table == NULL || name == NULL)\n        return -1;\n\n    nextptr = table->table + virHashComputeKey(table, name);\n    for (entry = *nextptr; entry; entry = entry->next) {\n        if (table->keyEqual(entry->name, name)) {\n            if (table->dataFree)\n                table->dataFree(entry->payload);\n            if (table->keyFree)\n                table->keyFree(entry->name);\n            *nextptr = entry->next;\n            VIR_FREE(entry);\n            table->nbElems--;\n            return 0;\n        }\n        nextptr = &entry->next;\n    }\n\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"viralloc.h\"\n#include \"moment_conf.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virdomainmomentobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nbool\nvirDomainMomentObjListRemove(virDomainMomentObjListPtr moments,\n                             virDomainMomentObjPtr moment)\n{\n    bool ret = moments->current == moment;\n\n    virHashRemoveEntry(moments->objs, moment->def->name);\n    if (ret)\n        moments->current = NULL;\n    return ret;\n}"
  },
  {
    "function_name": "virDomainMomentObjListSize",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainmomentobjlist.c",
    "lines": "444-448",
    "snippet": "int\nvirDomainMomentObjListSize(virDomainMomentObjListPtr moments)\n{\n    return virHashSize(moments->objs);\n}",
    "includes": [
      "#include \"virdomaincheckpointobjlist.h\"",
      "#include \"virdomainsnapshotobjlist.h\"",
      "#include \"viralloc.h\"",
      "#include \"moment_conf.h\"",
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"virdomainmomentobjlist.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virHashSize",
          "args": [
            "moments->objs"
          ],
          "line": 447
        },
        "resolved": true,
        "details": {
          "function_name": "virHashSize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "547-553",
          "snippet": "ssize_t\nvirHashSize(const virHashTable *table)\n{\n    if (table == NULL)\n        return -1;\n    return table->nbElems;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nssize_t\nvirHashSize(const virHashTable *table)\n{\n    if (table == NULL)\n        return -1;\n    return table->nbElems;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"viralloc.h\"\n#include \"moment_conf.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virdomainmomentobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirDomainMomentObjListSize(virDomainMomentObjListPtr moments)\n{\n    return virHashSize(moments->objs);\n}"
  },
  {
    "function_name": "virDomainMomentSetCurrent",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainmomentobjlist.c",
    "lines": "435-440",
    "snippet": "void\nvirDomainMomentSetCurrent(virDomainMomentObjListPtr moments,\n                          virDomainMomentObjPtr moment)\n{\n    moments->current = moment;\n}",
    "includes": [
      "#include \"virdomaincheckpointobjlist.h\"",
      "#include \"virdomainsnapshotobjlist.h\"",
      "#include \"viralloc.h\"",
      "#include \"moment_conf.h\"",
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"virdomainmomentobjlist.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"viralloc.h\"\n#include \"moment_conf.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virdomainmomentobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvoid\nvirDomainMomentSetCurrent(virDomainMomentObjListPtr moments,\n                          virDomainMomentObjPtr moment)\n{\n    moments->current = moment;\n}"
  },
  {
    "function_name": "virDomainMomentGetCurrentName",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainmomentobjlist.c",
    "lines": "425-431",
    "snippet": "const char *\nvirDomainMomentGetCurrentName(virDomainMomentObjListPtr moments)\n{\n    if (moments->current)\n        return moments->current->def->name;\n    return NULL;\n}",
    "includes": [
      "#include \"virdomaincheckpointobjlist.h\"",
      "#include \"virdomainsnapshotobjlist.h\"",
      "#include \"viralloc.h\"",
      "#include \"moment_conf.h\"",
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"virdomainmomentobjlist.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"viralloc.h\"\n#include \"moment_conf.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virdomainmomentobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nconst char *\nvirDomainMomentGetCurrentName(virDomainMomentObjListPtr moments)\n{\n    if (moments->current)\n        return moments->current->def->name;\n    return NULL;\n}"
  },
  {
    "function_name": "virDomainMomentGetCurrent",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainmomentobjlist.c",
    "lines": "417-421",
    "snippet": "virDomainMomentObjPtr\nvirDomainMomentGetCurrent(virDomainMomentObjListPtr moments)\n{\n    return moments->current;\n}",
    "includes": [
      "#include \"virdomaincheckpointobjlist.h\"",
      "#include \"virdomainsnapshotobjlist.h\"",
      "#include \"viralloc.h\"",
      "#include \"moment_conf.h\"",
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"virdomainmomentobjlist.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"viralloc.h\"\n#include \"moment_conf.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virdomainmomentobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvirDomainMomentObjPtr\nvirDomainMomentGetCurrent(virDomainMomentObjListPtr moments)\n{\n    return moments->current;\n}"
  },
  {
    "function_name": "virDomainMomentFindByName",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainmomentobjlist.c",
    "lines": "406-413",
    "snippet": "virDomainMomentObjPtr\nvirDomainMomentFindByName(virDomainMomentObjListPtr moments,\n                          const char *name)\n{\n    if (name)\n        return virHashLookup(moments->objs, name);\n    return NULL;\n}",
    "includes": [
      "#include \"virdomaincheckpointobjlist.h\"",
      "#include \"virdomainsnapshotobjlist.h\"",
      "#include \"viralloc.h\"",
      "#include \"moment_conf.h\"",
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"virdomainmomentobjlist.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virHashLookup",
          "args": [
            "moments->objs",
            "name"
          ],
          "line": 411
        },
        "resolved": true,
        "details": {
          "function_name": "virHashLookup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "473-482",
          "snippet": "void *\nvirHashLookup(const virHashTable *table, const void *name)\n{\n    virHashEntryPtr entry = virHashGetEntry(table, name);\n\n    if (!entry)\n        return NULL;\n\n    return entry->payload;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvoid *\nvirHashLookup(const virHashTable *table, const void *name)\n{\n    virHashEntryPtr entry = virHashGetEntry(table, name);\n\n    if (!entry)\n        return NULL;\n\n    return entry->payload;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"viralloc.h\"\n#include \"moment_conf.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virdomainmomentobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvirDomainMomentObjPtr\nvirDomainMomentFindByName(virDomainMomentObjListPtr moments,\n                          const char *name)\n{\n    if (name)\n        return virHashLookup(moments->objs, name);\n    return NULL;\n}"
  },
  {
    "function_name": "virDomainMomentObjListGetNames",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainmomentobjlist.c",
    "lines": "337-403",
    "snippet": "int\nvirDomainMomentObjListGetNames(virDomainMomentObjListPtr moments,\n                               virDomainMomentObjPtr from,\n                               char **const names,\n                               int maxnames,\n                               unsigned int flags,\n                               virDomainMomentObjListFilter filter,\n                               unsigned int filter_flags)\n{\n    struct virDomainMomentNameData data = { names, maxnames, flags, 0,\n                                            false, filter, filter_flags };\n    size_t i;\n\n    virCheckFlags(VIR_DOMAIN_MOMENT_FILTERS_ALL, -1);\n    if (!from) {\n        /* LIST_ROOTS and LIST_DESCENDANTS have the same bit value,\n         * but opposite semantics.  Toggle here to get the correct\n         * traversal on the metaroot.  */\n        flags ^= VIR_DOMAIN_MOMENT_LIST_ROOTS;\n        from = &moments->metaroot;\n    }\n\n    /* We handle LIST_ROOT/LIST_DESCENDANTS and LIST_TOPOLOGICAL directly,\n     * mask those bits out to determine when we must use the filter callback. */\n    data.flags &= ~(VIR_DOMAIN_MOMENT_LIST_DESCENDANTS |\n                    VIR_DOMAIN_MOMENT_LIST_TOPOLOGICAL);\n\n    /* If this common code is being used, we assume that all moments\n     * have metadata, and thus can handle METADATA up front as an\n     * all-or-none filter.  XXX This might not always be true, if we\n     * add the ability to track qcow2 internal snapshots without the\n     * use of metadata, in which case this check should move into the\n     * filter callback.  */\n    if ((data.flags & VIR_DOMAIN_MOMENT_FILTERS_METADATA) ==\n        VIR_DOMAIN_MOMENT_LIST_NO_METADATA)\n        return 0;\n    data.flags &= ~VIR_DOMAIN_MOMENT_FILTERS_METADATA;\n\n    if (flags & VIR_DOMAIN_MOMENT_LIST_DESCENDANTS) {\n        /* We could just always do a topological visit; but it is\n         * possible to optimize for less stack usage and time when a\n         * simpler full hashtable visit or counter will do. */\n        if (from->def || (names &&\n                          (flags & VIR_DOMAIN_MOMENT_LIST_TOPOLOGICAL)))\n            virDomainMomentForEachDescendant(from,\n                                             virDomainMomentObjListCopyNames,\n                                             &data);\n        else if (names || data.flags || filter_flags)\n            virHashForEach(moments->objs, virDomainMomentObjListCopyNames,\n                           &data);\n        else\n            data.count = virHashSize(moments->objs);\n    } else if (names || data.flags || filter_flags) {\n        virDomainMomentForEachChild(from,\n                                    virDomainMomentObjListCopyNames, &data);\n    } else {\n        data.count = from->nchildren;\n    }\n\n    if (data.error) {\n        for (i = 0; i < data.count; i++)\n            VIR_FREE(names[i]);\n        return -1;\n    }\n\n    return data.count;\n}",
    "includes": [
      "#include \"virdomaincheckpointobjlist.h\"",
      "#include \"virdomainsnapshotobjlist.h\"",
      "#include \"viralloc.h\"",
      "#include \"moment_conf.h\"",
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"virdomainmomentobjlist.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "names[i]"
          ],
          "line": 398
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainMomentForEachChild",
          "args": [
            "from",
            "virDomainMomentObjListCopyNames",
            "&data"
          ],
          "line": 390
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainMomentForEachChild",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainmomentobjlist.c",
          "lines": "55-69",
          "snippet": "int\nvirDomainMomentForEachChild(virDomainMomentObjPtr moment,\n                            virHashIterator iter,\n                            void *data)\n{\n    virDomainMomentObjPtr child = moment->first_child;\n\n    while (child) {\n        virDomainMomentObjPtr next = child->sibling;\n        (iter)(child, child->def->name, data);\n        child = next;\n    }\n\n    return moment->nchildren;\n}",
          "includes": [
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"viralloc.h\"",
            "#include \"moment_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"virdomainmomentobjlist.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"viralloc.h\"\n#include \"moment_conf.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virdomainmomentobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirDomainMomentForEachChild(virDomainMomentObjPtr moment,\n                            virHashIterator iter,\n                            void *data)\n{\n    virDomainMomentObjPtr child = moment->first_child;\n\n    while (child) {\n        virDomainMomentObjPtr next = child->sibling;\n        (iter)(child, child->def->name, data);\n        child = next;\n    }\n\n    return moment->nchildren;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashSize",
          "args": [
            "moments->objs"
          ],
          "line": 388
        },
        "resolved": true,
        "details": {
          "function_name": "virHashSize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "547-553",
          "snippet": "ssize_t\nvirHashSize(const virHashTable *table)\n{\n    if (table == NULL)\n        return -1;\n    return table->nbElems;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nssize_t\nvirHashSize(const virHashTable *table)\n{\n    if (table == NULL)\n        return -1;\n    return table->nbElems;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashForEach",
          "args": [
            "moments->objs",
            "virDomainMomentObjListCopyNames",
            "&data"
          ],
          "line": 385
        },
        "resolved": true,
        "details": {
          "function_name": "virHashForEach",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "626-649",
          "snippet": "int\nvirHashForEach(virHashTablePtr table, virHashIterator iter, void *data)\n{\n    size_t i;\n    int ret = -1;\n\n    if (table == NULL || iter == NULL)\n        return -1;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr entry = table->table[i];\n        while (entry) {\n            virHashEntryPtr next = entry->next;\n            ret = iter(entry->payload, entry->name, data);\n\n            if (ret < 0)\n                return ret;\n\n            entry = next;\n        }\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint\nvirHashForEach(virHashTablePtr table, virHashIterator iter, void *data)\n{\n    size_t i;\n    int ret = -1;\n\n    if (table == NULL || iter == NULL)\n        return -1;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr entry = table->table[i];\n        while (entry) {\n            virHashEntryPtr next = entry->next;\n            ret = iter(entry->payload, entry->name, data);\n\n            if (ret < 0)\n                return ret;\n\n            entry = next;\n        }\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainMomentForEachDescendant",
          "args": [
            "from",
            "virDomainMomentObjListCopyNames",
            "&data"
          ],
          "line": 381
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainMomentForEachDescendant",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainmomentobjlist.c",
          "lines": "98-112",
          "snippet": "int\nvirDomainMomentForEachDescendant(virDomainMomentObjPtr moment,\n                                 virHashIterator iter,\n                                 void *data)\n{\n    struct moment_act_on_descendant act;\n\n    act.number = 0;\n    act.iter = iter;\n    act.data = data;\n    virDomainMomentForEachChild(moment,\n                                virDomainMomentActOnDescendant, &act);\n\n    return act.number;\n}",
          "includes": [
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"viralloc.h\"",
            "#include \"moment_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"virdomainmomentobjlist.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"viralloc.h\"\n#include \"moment_conf.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virdomainmomentobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirDomainMomentForEachDescendant(virDomainMomentObjPtr moment,\n                                 virHashIterator iter,\n                                 void *data)\n{\n    struct moment_act_on_descendant act;\n\n    act.number = 0;\n    act.iter = iter;\n    act.data = data;\n    virDomainMomentForEachChild(moment,\n                                virDomainMomentActOnDescendant, &act);\n\n    return act.number;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "VIR_DOMAIN_MOMENT_FILTERS_ALL",
            "-1"
          ],
          "line": 350
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"viralloc.h\"\n#include \"moment_conf.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virdomainmomentobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirDomainMomentObjListGetNames(virDomainMomentObjListPtr moments,\n                               virDomainMomentObjPtr from,\n                               char **const names,\n                               int maxnames,\n                               unsigned int flags,\n                               virDomainMomentObjListFilter filter,\n                               unsigned int filter_flags)\n{\n    struct virDomainMomentNameData data = { names, maxnames, flags, 0,\n                                            false, filter, filter_flags };\n    size_t i;\n\n    virCheckFlags(VIR_DOMAIN_MOMENT_FILTERS_ALL, -1);\n    if (!from) {\n        /* LIST_ROOTS and LIST_DESCENDANTS have the same bit value,\n         * but opposite semantics.  Toggle here to get the correct\n         * traversal on the metaroot.  */\n        flags ^= VIR_DOMAIN_MOMENT_LIST_ROOTS;\n        from = &moments->metaroot;\n    }\n\n    /* We handle LIST_ROOT/LIST_DESCENDANTS and LIST_TOPOLOGICAL directly,\n     * mask those bits out to determine when we must use the filter callback. */\n    data.flags &= ~(VIR_DOMAIN_MOMENT_LIST_DESCENDANTS |\n                    VIR_DOMAIN_MOMENT_LIST_TOPOLOGICAL);\n\n    /* If this common code is being used, we assume that all moments\n     * have metadata, and thus can handle METADATA up front as an\n     * all-or-none filter.  XXX This might not always be true, if we\n     * add the ability to track qcow2 internal snapshots without the\n     * use of metadata, in which case this check should move into the\n     * filter callback.  */\n    if ((data.flags & VIR_DOMAIN_MOMENT_FILTERS_METADATA) ==\n        VIR_DOMAIN_MOMENT_LIST_NO_METADATA)\n        return 0;\n    data.flags &= ~VIR_DOMAIN_MOMENT_FILTERS_METADATA;\n\n    if (flags & VIR_DOMAIN_MOMENT_LIST_DESCENDANTS) {\n        /* We could just always do a topological visit; but it is\n         * possible to optimize for less stack usage and time when a\n         * simpler full hashtable visit or counter will do. */\n        if (from->def || (names &&\n                          (flags & VIR_DOMAIN_MOMENT_LIST_TOPOLOGICAL)))\n            virDomainMomentForEachDescendant(from,\n                                             virDomainMomentObjListCopyNames,\n                                             &data);\n        else if (names || data.flags || filter_flags)\n            virHashForEach(moments->objs, virDomainMomentObjListCopyNames,\n                           &data);\n        else\n            data.count = virHashSize(moments->objs);\n    } else if (names || data.flags || filter_flags) {\n        virDomainMomentForEachChild(from,\n                                    virDomainMomentObjListCopyNames, &data);\n    } else {\n        data.count = from->nchildren;\n    }\n\n    if (data.error) {\n        for (i = 0; i < data.count; i++)\n            VIR_FREE(names[i]);\n        return -1;\n    }\n\n    return data.count;\n}"
  },
  {
    "function_name": "virDomainMomentObjListCopyNames",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainmomentobjlist.c",
    "lines": "311-334",
    "snippet": "static int virDomainMomentObjListCopyNames(void *payload,\n                                           const void *name G_GNUC_UNUSED,\n                                           void *opaque)\n{\n    virDomainMomentObjPtr obj = payload;\n    struct virDomainMomentNameData *data = opaque;\n\n    if (data->error)\n        return 0;\n    /* Caller already sanitized flags.  Filtering on DESCENDANTS was\n     * done by choice of iteration in the caller.  */\n    if ((data->flags & VIR_DOMAIN_MOMENT_LIST_LEAVES) && obj->nchildren)\n        return 0;\n    if ((data->flags & VIR_DOMAIN_MOMENT_LIST_NO_LEAVES) && !obj->nchildren)\n        return 0;\n\n    if (!data->filter(obj, data->filter_flags))\n        return 0;\n\n    if (data->names && data->count < data->maxnames)\n        data->names[data->count] = g_strdup(obj->def->name);\n    data->count++;\n    return 0;\n}",
    "includes": [
      "#include \"virdomaincheckpointobjlist.h\"",
      "#include \"virdomainsnapshotobjlist.h\"",
      "#include \"viralloc.h\"",
      "#include \"moment_conf.h\"",
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"virdomainmomentobjlist.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "obj->def->name"
          ],
          "line": 331
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "data->filter",
          "args": [
            "obj",
            "data->filter_flags"
          ],
          "line": 327
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"viralloc.h\"\n#include \"moment_conf.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virdomainmomentobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int virDomainMomentObjListCopyNames(void *payload,\n                                           const void *name G_GNUC_UNUSED,\n                                           void *opaque)\n{\n    virDomainMomentObjPtr obj = payload;\n    struct virDomainMomentNameData *data = opaque;\n\n    if (data->error)\n        return 0;\n    /* Caller already sanitized flags.  Filtering on DESCENDANTS was\n     * done by choice of iteration in the caller.  */\n    if ((data->flags & VIR_DOMAIN_MOMENT_LIST_LEAVES) && obj->nchildren)\n        return 0;\n    if ((data->flags & VIR_DOMAIN_MOMENT_LIST_NO_LEAVES) && !obj->nchildren)\n        return 0;\n\n    if (!data->filter(obj, data->filter_flags))\n        return 0;\n\n    if (data->names && data->count < data->maxnames)\n        data->names[data->count] = g_strdup(obj->def->name);\n    data->count++;\n    return 0;\n}"
  },
  {
    "function_name": "virDomainMomentObjListFree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainmomentobjlist.c",
    "lines": "288-295",
    "snippet": "void\nvirDomainMomentObjListFree(virDomainMomentObjListPtr moments)\n{\n    if (!moments)\n        return;\n    virHashFree(moments->objs);\n    VIR_FREE(moments);\n}",
    "includes": [
      "#include \"virdomaincheckpointobjlist.h\"",
      "#include \"virdomainsnapshotobjlist.h\"",
      "#include \"viralloc.h\"",
      "#include \"moment_conf.h\"",
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"virdomainmomentobjlist.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "moments"
          ],
          "line": 294
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virHashFree",
          "args": [
            "moments->objs"
          ],
          "line": 293
        },
        "resolved": true,
        "details": {
          "function_name": "virHashFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "313-337",
          "snippet": "void\nvirHashFree(virHashTablePtr table)\n{\n    size_t i;\n\n    if (table == NULL)\n        return;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr iter = table->table[i];\n        while (iter) {\n            virHashEntryPtr next = iter->next;\n\n            if (table->dataFree)\n                table->dataFree(iter->payload);\n            if (table->keyFree)\n                table->keyFree(iter->name);\n            VIR_FREE(iter);\n            iter = next;\n        }\n    }\n\n    VIR_FREE(table->table);\n    VIR_FREE(table);\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvoid\nvirHashFree(virHashTablePtr table)\n{\n    size_t i;\n\n    if (table == NULL)\n        return;\n\n    for (i = 0; i < table->size; i++) {\n        virHashEntryPtr iter = table->table[i];\n        while (iter) {\n            virHashEntryPtr next = iter->next;\n\n            if (table->dataFree)\n                table->dataFree(iter->payload);\n            if (table->keyFree)\n                table->keyFree(iter->name);\n            VIR_FREE(iter);\n            iter = next;\n        }\n    }\n\n    VIR_FREE(table->table);\n    VIR_FREE(table);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"viralloc.h\"\n#include \"moment_conf.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virdomainmomentobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvoid\nvirDomainMomentObjListFree(virDomainMomentObjListPtr moments)\n{\n    if (!moments)\n        return;\n    virHashFree(moments->objs);\n    VIR_FREE(moments);\n}"
  },
  {
    "function_name": "virDomainMomentObjListNew",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainmomentobjlist.c",
    "lines": "273-286",
    "snippet": "virDomainMomentObjListPtr\nvirDomainMomentObjListNew(void)\n{\n    virDomainMomentObjListPtr moments;\n\n    if (VIR_ALLOC(moments) < 0)\n        return NULL;\n    moments->objs = virHashCreate(50, virDomainMomentObjListDataFree);\n    if (!moments->objs) {\n        VIR_FREE(moments);\n        return NULL;\n    }\n    return moments;\n}",
    "includes": [
      "#include \"virdomaincheckpointobjlist.h\"",
      "#include \"virdomainsnapshotobjlist.h\"",
      "#include \"viralloc.h\"",
      "#include \"moment_conf.h\"",
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"virdomainmomentobjlist.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "moments"
          ],
          "line": 282
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virHashCreate",
          "args": [
            "50",
            "virDomainMomentObjListDataFree"
          ],
          "line": 280
        },
        "resolved": true,
        "details": {
          "function_name": "virHashCreate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "202-211",
          "snippet": "virHashTablePtr virHashCreate(ssize_t size, virHashDataFree dataFree)\n{\n    return virHashCreateFull(size,\n                             dataFree,\n                             virHashStrCode,\n                             virHashStrEqual,\n                             virHashStrCopy,\n                             virHashStrPrintHuman,\n                             virHashStrFree);\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvirHashTablePtr virHashCreate(ssize_t size, virHashDataFree dataFree)\n{\n    return virHashCreateFull(size,\n                             dataFree,\n                             virHashStrCode,\n                             virHashStrEqual,\n                             virHashStrCopy,\n                             virHashStrPrintHuman,\n                             virHashStrFree);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC",
          "args": [
            "moments"
          ],
          "line": 278
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"viralloc.h\"\n#include \"moment_conf.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virdomainmomentobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvirDomainMomentObjListPtr\nvirDomainMomentObjListNew(void)\n{\n    virDomainMomentObjListPtr moments;\n\n    if (VIR_ALLOC(moments) < 0)\n        return NULL;\n    moments->objs = virHashCreate(50, virDomainMomentObjListDataFree);\n    if (!moments->objs) {\n        VIR_FREE(moments);\n        return NULL;\n    }\n    return moments;\n}"
  },
  {
    "function_name": "virDomainMomentObjListDataFree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainmomentobjlist.c",
    "lines": "264-270",
    "snippet": "static void\nvirDomainMomentObjListDataFree(void *payload)\n{\n    virDomainMomentObjPtr obj = payload;\n\n    virDomainMomentObjFree(obj);\n}",
    "includes": [
      "#include \"virdomaincheckpointobjlist.h\"",
      "#include \"virdomainsnapshotobjlist.h\"",
      "#include \"viralloc.h\"",
      "#include \"moment_conf.h\"",
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"virdomainmomentobjlist.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainMomentObjFree",
          "args": [
            "obj"
          ],
          "line": 269
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainMomentObjFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainmomentobjlist.c",
          "lines": "224-234",
          "snippet": "static void\nvirDomainMomentObjFree(virDomainMomentObjPtr moment)\n{\n    if (!moment)\n        return;\n\n    VIR_DEBUG(\"obj=%p\", moment);\n\n    virObjectUnref(moment->def);\n    VIR_FREE(moment);\n}",
          "includes": [
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"viralloc.h\"",
            "#include \"moment_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"virdomainmomentobjlist.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"viralloc.h\"\n#include \"moment_conf.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virdomainmomentobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic void\nvirDomainMomentObjFree(virDomainMomentObjPtr moment)\n{\n    if (!moment)\n        return;\n\n    VIR_DEBUG(\"obj=%p\", moment);\n\n    virObjectUnref(moment->def);\n    VIR_FREE(moment);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"viralloc.h\"\n#include \"moment_conf.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virdomainmomentobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic void\nvirDomainMomentObjListDataFree(void *payload)\n{\n    virDomainMomentObjPtr obj = payload;\n\n    virDomainMomentObjFree(obj);\n}"
  },
  {
    "function_name": "virDomainMomentAssignDef",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainmomentobjlist.c",
    "lines": "238-261",
    "snippet": "virDomainMomentObjPtr\nvirDomainMomentAssignDef(virDomainMomentObjListPtr moments,\n                         virDomainMomentDefPtr def)\n{\n    virDomainMomentObjPtr moment;\n\n    if (virHashLookup(moments->objs, def->name) != NULL) {\n        virReportError(VIR_ERR_OPERATION_FAILED,\n                       _(\"domain moment %s already exists\"),\n                       def->name);\n        return NULL;\n    }\n\n    if (!(moment = virDomainMomentObjNew()))\n        return NULL;\n\n    if (virHashAddEntry(moments->objs, def->name, moment) < 0) {\n        VIR_FREE(moment);\n        return NULL;\n    }\n    moment->def = def;\n\n    return moment;\n}",
    "includes": [
      "#include \"virdomaincheckpointobjlist.h\"",
      "#include \"virdomainsnapshotobjlist.h\"",
      "#include \"viralloc.h\"",
      "#include \"moment_conf.h\"",
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"virdomainmomentobjlist.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "moment"
          ],
          "line": 255
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virHashAddEntry",
          "args": [
            "moments->objs",
            "def->name",
            "moment"
          ],
          "line": 254
        },
        "resolved": true,
        "details": {
          "function_name": "virHashAddEntry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "404-408",
          "snippet": "int\nvirHashAddEntry(virHashTablePtr table, const void *name, void *userdata)\n{\n    return virHashAddOrUpdateEntry(table, name, userdata, false);\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint\nvirHashAddEntry(virHashTablePtr table, const void *name, void *userdata)\n{\n    return virHashAddOrUpdateEntry(table, name, userdata, false);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainMomentObjNew",
          "args": [],
          "line": 251
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainMomentObjNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainmomentobjlist.c",
          "lines": "210-221",
          "snippet": "static virDomainMomentObjPtr\nvirDomainMomentObjNew(void)\n{\n    virDomainMomentObjPtr moment;\n\n    if (VIR_ALLOC(moment) < 0)\n        return NULL;\n\n    VIR_DEBUG(\"obj=%p\", moment);\n\n    return moment;\n}",
          "includes": [
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"viralloc.h\"",
            "#include \"moment_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"virdomainmomentobjlist.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"viralloc.h\"\n#include \"moment_conf.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virdomainmomentobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic virDomainMomentObjPtr\nvirDomainMomentObjNew(void)\n{\n    virDomainMomentObjPtr moment;\n\n    if (VIR_ALLOC(moment) < 0)\n        return NULL;\n\n    VIR_DEBUG(\"obj=%p\", moment);\n\n    return moment;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_FAILED",
            "_(\"domain moment %s already exists\")",
            "def->name"
          ],
          "line": 245
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"domain moment %s already exists\""
          ],
          "line": 246
        },
        "resolved": true,
        "details": {
          "function_name": "ATTRIBUTE_NONNULL",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/cpu_conf.c",
          "lines": "135-141",
          "snippet": "int ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint ATTRIBUTE_NONNULL(1) ATTRIBUTE_NONNULL(2)\nvirCPUDefCopyModel(virCPUDefPtr dst,\n                   const virCPUDef *src,\n                   bool resetPolicy)\n{\n    return virCPUDefCopyModelFilter(dst, src, resetPolicy, NULL, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashLookup",
          "args": [
            "moments->objs",
            "def->name"
          ],
          "line": 244
        },
        "resolved": true,
        "details": {
          "function_name": "virHashLookup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "473-482",
          "snippet": "void *\nvirHashLookup(const virHashTable *table, const void *name)\n{\n    virHashEntryPtr entry = virHashGetEntry(table, name);\n\n    if (!entry)\n        return NULL;\n\n    return entry->payload;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvoid *\nvirHashLookup(const virHashTable *table, const void *name)\n{\n    virHashEntryPtr entry = virHashGetEntry(table, name);\n\n    if (!entry)\n        return NULL;\n\n    return entry->payload;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"viralloc.h\"\n#include \"moment_conf.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virdomainmomentobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvirDomainMomentObjPtr\nvirDomainMomentAssignDef(virDomainMomentObjListPtr moments,\n                         virDomainMomentDefPtr def)\n{\n    virDomainMomentObjPtr moment;\n\n    if (virHashLookup(moments->objs, def->name) != NULL) {\n        virReportError(VIR_ERR_OPERATION_FAILED,\n                       _(\"domain moment %s already exists\"),\n                       def->name);\n        return NULL;\n    }\n\n    if (!(moment = virDomainMomentObjNew()))\n        return NULL;\n\n    if (virHashAddEntry(moments->objs, def->name, moment) < 0) {\n        VIR_FREE(moment);\n        return NULL;\n    }\n    moment->def = def;\n\n    return moment;\n}"
  },
  {
    "function_name": "virDomainMomentObjFree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainmomentobjlist.c",
    "lines": "224-234",
    "snippet": "static void\nvirDomainMomentObjFree(virDomainMomentObjPtr moment)\n{\n    if (!moment)\n        return;\n\n    VIR_DEBUG(\"obj=%p\", moment);\n\n    virObjectUnref(moment->def);\n    VIR_FREE(moment);\n}",
    "includes": [
      "#include \"virdomaincheckpointobjlist.h\"",
      "#include \"virdomainsnapshotobjlist.h\"",
      "#include \"viralloc.h\"",
      "#include \"moment_conf.h\"",
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"virdomainmomentobjlist.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "moment"
          ],
          "line": 233
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "moment->def"
          ],
          "line": 232
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"obj=%p\"",
            "moment"
          ],
          "line": 230
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"viralloc.h\"\n#include \"moment_conf.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virdomainmomentobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic void\nvirDomainMomentObjFree(virDomainMomentObjPtr moment)\n{\n    if (!moment)\n        return;\n\n    VIR_DEBUG(\"obj=%p\", moment);\n\n    virObjectUnref(moment->def);\n    VIR_FREE(moment);\n}"
  },
  {
    "function_name": "virDomainMomentObjNew",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainmomentobjlist.c",
    "lines": "210-221",
    "snippet": "static virDomainMomentObjPtr\nvirDomainMomentObjNew(void)\n{\n    virDomainMomentObjPtr moment;\n\n    if (VIR_ALLOC(moment) < 0)\n        return NULL;\n\n    VIR_DEBUG(\"obj=%p\", moment);\n\n    return moment;\n}",
    "includes": [
      "#include \"virdomaincheckpointobjlist.h\"",
      "#include \"virdomainsnapshotobjlist.h\"",
      "#include \"viralloc.h\"",
      "#include \"moment_conf.h\"",
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"virdomainmomentobjlist.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"obj=%p\"",
            "moment"
          ],
          "line": 218
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC",
          "args": [
            "moment"
          ],
          "line": 215
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"viralloc.h\"\n#include \"moment_conf.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virdomainmomentobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic virDomainMomentObjPtr\nvirDomainMomentObjNew(void)\n{\n    virDomainMomentObjPtr moment;\n\n    if (VIR_ALLOC(moment) < 0)\n        return NULL;\n\n    VIR_DEBUG(\"obj=%p\", moment);\n\n    return moment;\n}"
  },
  {
    "function_name": "virDomainMomentMoveChildren",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainmomentobjlist.c",
    "lines": "187-207",
    "snippet": "void\nvirDomainMomentMoveChildren(virDomainMomentObjPtr from,\n                            virDomainMomentObjPtr to)\n{\n    virDomainMomentObjPtr child = from->first_child;\n\n    if (!from->nchildren)\n        return;\n    while (child) {\n        child->parent = to;\n        if (!child->sibling) {\n            child->sibling = to->first_child;\n            break;\n        }\n        child = child->sibling;\n    }\n    to->nchildren += from->nchildren;\n    to->first_child = from->first_child;\n    from->nchildren = 0;\n    from->first_child = NULL;\n}",
    "includes": [
      "#include \"virdomaincheckpointobjlist.h\"",
      "#include \"virdomainsnapshotobjlist.h\"",
      "#include \"viralloc.h\"",
      "#include \"moment_conf.h\"",
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"virdomainmomentobjlist.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"viralloc.h\"\n#include \"moment_conf.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virdomainmomentobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvoid\nvirDomainMomentMoveChildren(virDomainMomentObjPtr from,\n                            virDomainMomentObjPtr to)\n{\n    virDomainMomentObjPtr child = from->first_child;\n\n    if (!from->nchildren)\n        return;\n    while (child) {\n        child->parent = to;\n        if (!child->sibling) {\n            child->sibling = to->first_child;\n            break;\n        }\n        child = child->sibling;\n    }\n    to->nchildren += from->nchildren;\n    to->first_child = from->first_child;\n    from->nchildren = 0;\n    from->first_child = NULL;\n}"
  },
  {
    "function_name": "virDomainMomentLinkParent",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainmomentobjlist.c",
    "lines": "169-183",
    "snippet": "void\nvirDomainMomentLinkParent(virDomainMomentObjListPtr moments,\n                          virDomainMomentObjPtr moment)\n{\n    virDomainMomentObjPtr parent;\n\n    parent = virDomainMomentFindByName(moments, moment->def->parent_name);\n    if (!parent) {\n        parent = &moments->metaroot;\n        if (moment->def->parent_name)\n            VIR_WARN(\"moment %s lacks parent %s\", moment->def->name,\n                     moment->def->parent_name);\n    }\n    virDomainMomentSetParent(moment, parent);\n}",
    "includes": [
      "#include \"virdomaincheckpointobjlist.h\"",
      "#include \"virdomainsnapshotobjlist.h\"",
      "#include \"viralloc.h\"",
      "#include \"moment_conf.h\"",
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"virdomainmomentobjlist.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainMomentSetParent",
          "args": [
            "moment",
            "parent"
          ],
          "line": 182
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainMomentSetParent",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainmomentobjlist.c",
          "lines": "154-162",
          "snippet": "static void\nvirDomainMomentSetParent(virDomainMomentObjPtr moment,\n                         virDomainMomentObjPtr parent)\n{\n    moment->parent = parent;\n    parent->nchildren++;\n    moment->sibling = parent->first_child;\n    parent->first_child = moment;\n}",
          "includes": [
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"viralloc.h\"",
            "#include \"moment_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"virdomainmomentobjlist.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"viralloc.h\"\n#include \"moment_conf.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virdomainmomentobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic void\nvirDomainMomentSetParent(virDomainMomentObjPtr moment,\n                         virDomainMomentObjPtr parent)\n{\n    moment->parent = parent;\n    parent->nchildren++;\n    moment->sibling = parent->first_child;\n    parent->first_child = moment;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_WARN",
          "args": [
            "\"moment %s lacks parent %s\"",
            "moment->def->name",
            "moment->def->parent_name"
          ],
          "line": 179
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainMomentFindByName",
          "args": [
            "moments",
            "moment->def->parent_name"
          ],
          "line": 175
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainMomentFindByName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainmomentobjlist.c",
          "lines": "406-413",
          "snippet": "virDomainMomentObjPtr\nvirDomainMomentFindByName(virDomainMomentObjListPtr moments,\n                          const char *name)\n{\n    if (name)\n        return virHashLookup(moments->objs, name);\n    return NULL;\n}",
          "includes": [
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"viralloc.h\"",
            "#include \"moment_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"virdomainmomentobjlist.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"viralloc.h\"\n#include \"moment_conf.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virdomainmomentobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvirDomainMomentObjPtr\nvirDomainMomentFindByName(virDomainMomentObjListPtr moments,\n                          const char *name)\n{\n    if (name)\n        return virHashLookup(moments->objs, name);\n    return NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"viralloc.h\"\n#include \"moment_conf.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virdomainmomentobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvoid\nvirDomainMomentLinkParent(virDomainMomentObjListPtr moments,\n                          virDomainMomentObjPtr moment)\n{\n    virDomainMomentObjPtr parent;\n\n    parent = virDomainMomentFindByName(moments, moment->def->parent_name);\n    if (!parent) {\n        parent = &moments->metaroot;\n        if (moment->def->parent_name)\n            VIR_WARN(\"moment %s lacks parent %s\", moment->def->name,\n                     moment->def->parent_name);\n    }\n    virDomainMomentSetParent(moment, parent);\n}"
  },
  {
    "function_name": "virDomainMomentSetParent",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainmomentobjlist.c",
    "lines": "154-162",
    "snippet": "static void\nvirDomainMomentSetParent(virDomainMomentObjPtr moment,\n                         virDomainMomentObjPtr parent)\n{\n    moment->parent = parent;\n    parent->nchildren++;\n    moment->sibling = parent->first_child;\n    parent->first_child = moment;\n}",
    "includes": [
      "#include \"virdomaincheckpointobjlist.h\"",
      "#include \"virdomainsnapshotobjlist.h\"",
      "#include \"viralloc.h\"",
      "#include \"moment_conf.h\"",
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"virdomainmomentobjlist.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"viralloc.h\"\n#include \"moment_conf.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virdomainmomentobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic void\nvirDomainMomentSetParent(virDomainMomentObjPtr moment,\n                         virDomainMomentObjPtr parent)\n{\n    moment->parent = parent;\n    parent->nchildren++;\n    moment->sibling = parent->first_child;\n    parent->first_child = moment;\n}"
  },
  {
    "function_name": "virDomainMomentDropChildren",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainmomentobjlist.c",
    "lines": "145-150",
    "snippet": "void\nvirDomainMomentDropChildren(virDomainMomentObjPtr moment)\n{\n    moment->nchildren = 0;\n    moment->first_child = NULL;\n}",
    "includes": [
      "#include \"virdomaincheckpointobjlist.h\"",
      "#include \"virdomainsnapshotobjlist.h\"",
      "#include \"viralloc.h\"",
      "#include \"moment_conf.h\"",
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"virdomainmomentobjlist.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"viralloc.h\"\n#include \"moment_conf.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virdomainmomentobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvoid\nvirDomainMomentDropChildren(virDomainMomentObjPtr moment)\n{\n    moment->nchildren = 0;\n    moment->first_child = NULL;\n}"
  },
  {
    "function_name": "virDomainMomentDropParent",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainmomentobjlist.c",
    "lines": "119-141",
    "snippet": "void\nvirDomainMomentDropParent(virDomainMomentObjPtr moment)\n{\n    virDomainMomentObjPtr prev = NULL;\n    virDomainMomentObjPtr curr = NULL;\n\n    moment->parent->nchildren--;\n    curr = moment->parent->first_child;\n    while (curr != moment) {\n        if (!curr) {\n            VIR_WARN(\"inconsistent moment relations\");\n            return;\n        }\n        prev = curr;\n        curr = curr->sibling;\n    }\n    if (prev)\n        prev->sibling = moment->sibling;\n    else\n        moment->parent->first_child = moment->sibling;\n    moment->parent = NULL;\n    moment->sibling = NULL;\n}",
    "includes": [
      "#include \"virdomaincheckpointobjlist.h\"",
      "#include \"virdomainsnapshotobjlist.h\"",
      "#include \"viralloc.h\"",
      "#include \"moment_conf.h\"",
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"virdomainmomentobjlist.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_WARN",
          "args": [
            "\"inconsistent moment relations\""
          ],
          "line": 129
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"viralloc.h\"\n#include \"moment_conf.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virdomainmomentobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvoid\nvirDomainMomentDropParent(virDomainMomentObjPtr moment)\n{\n    virDomainMomentObjPtr prev = NULL;\n    virDomainMomentObjPtr curr = NULL;\n\n    moment->parent->nchildren--;\n    curr = moment->parent->first_child;\n    while (curr != moment) {\n        if (!curr) {\n            VIR_WARN(\"inconsistent moment relations\");\n            return;\n        }\n        prev = curr;\n        curr = curr->sibling;\n    }\n    if (prev)\n        prev->sibling = moment->sibling;\n    else\n        moment->parent->first_child = moment->sibling;\n    moment->parent = NULL;\n    moment->sibling = NULL;\n}"
  },
  {
    "function_name": "virDomainMomentForEachDescendant",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainmomentobjlist.c",
    "lines": "98-112",
    "snippet": "int\nvirDomainMomentForEachDescendant(virDomainMomentObjPtr moment,\n                                 virHashIterator iter,\n                                 void *data)\n{\n    struct moment_act_on_descendant act;\n\n    act.number = 0;\n    act.iter = iter;\n    act.data = data;\n    virDomainMomentForEachChild(moment,\n                                virDomainMomentActOnDescendant, &act);\n\n    return act.number;\n}",
    "includes": [
      "#include \"virdomaincheckpointobjlist.h\"",
      "#include \"virdomainsnapshotobjlist.h\"",
      "#include \"viralloc.h\"",
      "#include \"moment_conf.h\"",
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"virdomainmomentobjlist.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainMomentForEachChild",
          "args": [
            "moment",
            "virDomainMomentActOnDescendant",
            "&act"
          ],
          "line": 108
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainMomentForEachChild",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainmomentobjlist.c",
          "lines": "55-69",
          "snippet": "int\nvirDomainMomentForEachChild(virDomainMomentObjPtr moment,\n                            virHashIterator iter,\n                            void *data)\n{\n    virDomainMomentObjPtr child = moment->first_child;\n\n    while (child) {\n        virDomainMomentObjPtr next = child->sibling;\n        (iter)(child, child->def->name, data);\n        child = next;\n    }\n\n    return moment->nchildren;\n}",
          "includes": [
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"viralloc.h\"",
            "#include \"moment_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"virdomainmomentobjlist.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"viralloc.h\"\n#include \"moment_conf.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virdomainmomentobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirDomainMomentForEachChild(virDomainMomentObjPtr moment,\n                            virHashIterator iter,\n                            void *data)\n{\n    virDomainMomentObjPtr child = moment->first_child;\n\n    while (child) {\n        virDomainMomentObjPtr next = child->sibling;\n        (iter)(child, child->def->name, data);\n        child = next;\n    }\n\n    return moment->nchildren;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"viralloc.h\"\n#include \"moment_conf.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virdomainmomentobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirDomainMomentForEachDescendant(virDomainMomentObjPtr moment,\n                                 virHashIterator iter,\n                                 void *data)\n{\n    struct moment_act_on_descendant act;\n\n    act.number = 0;\n    act.iter = iter;\n    act.data = data;\n    virDomainMomentForEachChild(moment,\n                                virDomainMomentActOnDescendant, &act);\n\n    return act.number;\n}"
  },
  {
    "function_name": "virDomainMomentActOnDescendant",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainmomentobjlist.c",
    "lines": "77-92",
    "snippet": "static int\nvirDomainMomentActOnDescendant(void *payload,\n                               const void *name,\n                               void *data)\n{\n    virDomainMomentObjPtr obj = payload;\n    struct moment_act_on_descendant *curr = data;\n    virDomainMomentObj tmp = *obj;\n\n    /* Careful: curr->iter can delete obj, hence the need for tmp */\n    (curr->iter)(payload, name, curr->data);\n    curr->number += 1 + virDomainMomentForEachDescendant(&tmp,\n                                                         curr->iter,\n                                                         curr->data);\n    return 0;\n}",
    "includes": [
      "#include \"virdomaincheckpointobjlist.h\"",
      "#include \"virdomainsnapshotobjlist.h\"",
      "#include \"viralloc.h\"",
      "#include \"moment_conf.h\"",
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"virdomainmomentobjlist.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainMomentForEachDescendant",
          "args": [
            "&tmp",
            "curr->iter",
            "curr->data"
          ],
          "line": 88
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainMomentForEachDescendant",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainmomentobjlist.c",
          "lines": "98-112",
          "snippet": "int\nvirDomainMomentForEachDescendant(virDomainMomentObjPtr moment,\n                                 virHashIterator iter,\n                                 void *data)\n{\n    struct moment_act_on_descendant act;\n\n    act.number = 0;\n    act.iter = iter;\n    act.data = data;\n    virDomainMomentForEachChild(moment,\n                                virDomainMomentActOnDescendant, &act);\n\n    return act.number;\n}",
          "includes": [
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"viralloc.h\"",
            "#include \"moment_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"virdomainmomentobjlist.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"viralloc.h\"\n#include \"moment_conf.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virdomainmomentobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirDomainMomentForEachDescendant(virDomainMomentObjPtr moment,\n                                 virHashIterator iter,\n                                 void *data)\n{\n    struct moment_act_on_descendant act;\n\n    act.number = 0;\n    act.iter = iter;\n    act.data = data;\n    virDomainMomentForEachChild(moment,\n                                virDomainMomentActOnDescendant, &act);\n\n    return act.number;\n}"
        }
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "payload",
            "name",
            "curr->data"
          ],
          "line": 87
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"viralloc.h\"\n#include \"moment_conf.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virdomainmomentobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int\nvirDomainMomentActOnDescendant(void *payload,\n                               const void *name,\n                               void *data)\n{\n    virDomainMomentObjPtr obj = payload;\n    struct moment_act_on_descendant *curr = data;\n    virDomainMomentObj tmp = *obj;\n\n    /* Careful: curr->iter can delete obj, hence the need for tmp */\n    (curr->iter)(payload, name, curr->data);\n    curr->number += 1 + virDomainMomentForEachDescendant(&tmp,\n                                                         curr->iter,\n                                                         curr->data);\n    return 0;\n}"
  },
  {
    "function_name": "virDomainMomentForEachChild",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virdomainmomentobjlist.c",
    "lines": "55-69",
    "snippet": "int\nvirDomainMomentForEachChild(virDomainMomentObjPtr moment,\n                            virHashIterator iter,\n                            void *data)\n{\n    virDomainMomentObjPtr child = moment->first_child;\n\n    while (child) {\n        virDomainMomentObjPtr next = child->sibling;\n        (iter)(child, child->def->name, data);\n        child = next;\n    }\n\n    return moment->nchildren;\n}",
    "includes": [
      "#include \"virdomaincheckpointobjlist.h\"",
      "#include \"virdomainsnapshotobjlist.h\"",
      "#include \"viralloc.h\"",
      "#include \"moment_conf.h\"",
      "#include \"virstring.h\"",
      "#include \"virerror.h\"",
      "#include \"virlog.h\"",
      "#include \"virdomainmomentobjlist.h\"",
      "#include \"internal.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "",
          "args": [
            "child",
            "child->def->name",
            "data"
          ],
          "line": 64
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"viralloc.h\"\n#include \"moment_conf.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virdomainmomentobjlist.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirDomainMomentForEachChild(virDomainMomentObjPtr moment,\n                            virHashIterator iter,\n                            void *data)\n{\n    virDomainMomentObjPtr child = moment->first_child;\n\n    while (child) {\n        virDomainMomentObjPtr next = child->sibling;\n        (iter)(child, child->def->name, data);\n        child = next;\n    }\n\n    return moment->nchildren;\n}"
  }
]