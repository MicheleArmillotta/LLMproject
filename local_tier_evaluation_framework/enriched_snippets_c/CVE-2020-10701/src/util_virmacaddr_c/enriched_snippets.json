[
  {
    "function_name": "virMacAddrFree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virmacaddr.c",
    "lines": "250-254",
    "snippet": "void\nvirMacAddrFree(virMacAddrPtr addr)\n{\n    VIR_FREE(addr);\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virrandom.h\"",
      "#include \"virmacaddr.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "addr"
          ],
          "line": 253
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virrandom.h\"\n#include \"virmacaddr.h\"\n#include <config.h>\n\nvoid\nvirMacAddrFree(virMacAddrPtr addr)\n{\n    VIR_FREE(addr);\n}"
  },
  {
    "function_name": "virMacAddrIsBroadcastRaw",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virmacaddr.c",
    "lines": "244-248",
    "snippet": "bool\nvirMacAddrIsBroadcastRaw(const unsigned char s[VIR_MAC_BUFLEN])\n{\n    return memcmp(virMacAddrBroadcastAddrRaw, s, sizeof(*s)) == 0;\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virrandom.h\"",
      "#include \"virmacaddr.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static const unsigned char virMacAddrBroadcastAddrRaw[VIR_MAC_BUFLEN] =\n    { 0xff, 0xff, 0xff, 0xff, 0xff, 0xff };"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcmp",
          "args": [
            "virMacAddrBroadcastAddrRaw",
            "s",
            "sizeof(*s)"
          ],
          "line": 247
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virrandom.h\"\n#include \"virmacaddr.h\"\n#include <config.h>\n\nstatic const unsigned char virMacAddrBroadcastAddrRaw[VIR_MAC_BUFLEN] =\n    { 0xff, 0xff, 0xff, 0xff, 0xff, 0xff };\n\nbool\nvirMacAddrIsBroadcastRaw(const unsigned char s[VIR_MAC_BUFLEN])\n{\n    return memcmp(virMacAddrBroadcastAddrRaw, s, sizeof(*s)) == 0;\n}"
  },
  {
    "function_name": "virMacAddrIsUnicast",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virmacaddr.c",
    "lines": "238-242",
    "snippet": "bool\nvirMacAddrIsUnicast(const virMacAddr *mac)\n{\n    return !(mac->addr[0] & 1);\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virrandom.h\"",
      "#include \"virmacaddr.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virrandom.h\"\n#include \"virmacaddr.h\"\n#include <config.h>\n\nbool\nvirMacAddrIsUnicast(const virMacAddr *mac)\n{\n    return !(mac->addr[0] & 1);\n}"
  },
  {
    "function_name": "virMacAddrIsMulticast",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virmacaddr.c",
    "lines": "232-236",
    "snippet": "bool\nvirMacAddrIsMulticast(const virMacAddr *mac)\n{\n    return !!(mac->addr[0] & 1);\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virrandom.h\"",
      "#include \"virmacaddr.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virrandom.h\"\n#include \"virmacaddr.h\"\n#include <config.h>\n\nbool\nvirMacAddrIsMulticast(const virMacAddr *mac)\n{\n    return !!(mac->addr[0] & 1);\n}"
  },
  {
    "function_name": "virMacAddrGenerate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virmacaddr.c",
    "lines": "220-229",
    "snippet": "void virMacAddrGenerate(const unsigned char prefix[VIR_MAC_PREFIX_BUFLEN],\n                        virMacAddrPtr addr)\n{\n    addr->addr[0] = prefix[0];\n    addr->addr[1] = prefix[1];\n    addr->addr[2] = prefix[2];\n    addr->addr[3] = virRandomBits(8);\n    addr->addr[4] = virRandomBits(8);\n    addr->addr[5] = virRandomBits(8);\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virrandom.h\"",
      "#include \"virmacaddr.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virRandomBits",
          "args": [
            "8"
          ],
          "line": 228
        },
        "resolved": true,
        "details": {
          "function_name": "virRandomBits",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virrandom.c",
          "lines": "50-64",
          "snippet": "uint64_t virRandomBits(int nbits)\n{\n    uint64_t ret = 0;\n\n    if (virRandomBytes((unsigned char *) &ret, sizeof(ret)) < 0) {\n        /* You're already hosed, so this particular non-random value\n         * isn't any worse.  */\n        return 0;\n    }\n\n    if (nbits < 64)\n        ret &= (1ULL << nbits) - 1;\n\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"virthread.h\"",
            "#include \"virrandom.h\"",
            "#include <gnutls/crypto.h>",
            "#include <gnutls/gnutls.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <time.h>",
            "#include <math.h>",
            "#include <inttypes.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virthread.h\"\n#include \"virrandom.h\"\n#include <gnutls/crypto.h>\n#include <gnutls/gnutls.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <time.h>\n#include <math.h>\n#include <inttypes.h>\n#include <config.h>\n\nuint64_t virRandomBits(int nbits)\n{\n    uint64_t ret = 0;\n\n    if (virRandomBytes((unsigned char *) &ret, sizeof(ret)) < 0) {\n        /* You're already hosed, so this particular non-random value\n         * isn't any worse.  */\n        return 0;\n    }\n\n    if (nbits < 64)\n        ret &= (1ULL << nbits) - 1;\n\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virrandom.h\"\n#include \"virmacaddr.h\"\n#include <config.h>\n\nvoid virMacAddrGenerate(const unsigned char prefix[VIR_MAC_PREFIX_BUFLEN],\n                        virMacAddrPtr addr)\n{\n    addr->addr[0] = prefix[0];\n    addr->addr[1] = prefix[1];\n    addr->addr[2] = prefix[2];\n    addr->addr[3] = virRandomBits(8);\n    addr->addr[4] = virRandomBits(8);\n    addr->addr[5] = virRandomBits(8);\n}"
  },
  {
    "function_name": "virMacAddrParseHex",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virmacaddr.c",
    "lines": "205-218",
    "snippet": "int\nvirMacAddrParseHex(const char *str, virMacAddrPtr addr)\n{\n    size_t i;\n\n    if (strspn(str, \"0123456789abcdefABCDEF\") != VIR_MAC_HEXLEN ||\n        str[VIR_MAC_HEXLEN])\n        return -1;\n\n    for (i = 0; i < VIR_MAC_BUFLEN; i++)\n        addr->addr[i] = (g_ascii_xdigit_value(str[2 * i]) << 4 |\n                         g_ascii_xdigit_value(str[2 * i + 1]));\n    return 0;\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virrandom.h\"",
      "#include \"virmacaddr.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_ascii_xdigit_value",
          "args": [
            "str[2 * i + 1]"
          ],
          "line": 216
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_ascii_xdigit_value",
          "args": [
            "str[2 * i]"
          ],
          "line": 215
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strspn",
          "args": [
            "str",
            "\"0123456789abcdefABCDEF\""
          ],
          "line": 210
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virrandom.h\"\n#include \"virmacaddr.h\"\n#include <config.h>\n\nint\nvirMacAddrParseHex(const char *str, virMacAddrPtr addr)\n{\n    size_t i;\n\n    if (strspn(str, \"0123456789abcdefABCDEF\") != VIR_MAC_HEXLEN ||\n        str[VIR_MAC_HEXLEN])\n        return -1;\n\n    for (i = 0; i < VIR_MAC_BUFLEN; i++)\n        addr->addr[i] = (g_ascii_xdigit_value(str[2 * i]) << 4 |\n                         g_ascii_xdigit_value(str[2 * i + 1]));\n    return 0;\n}"
  },
  {
    "function_name": "virMacAddrFormat",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virmacaddr.c",
    "lines": "184-194",
    "snippet": "const char *\nvirMacAddrFormat(const virMacAddr *addr,\n                 char *str)\n{\n    g_snprintf(str, VIR_MAC_STRING_BUFLEN,\n               \"%02x:%02x:%02x:%02x:%02x:%02x\",\n               addr->addr[0], addr->addr[1], addr->addr[2],\n               addr->addr[3], addr->addr[4], addr->addr[5]);\n    str[VIR_MAC_STRING_BUFLEN-1] = '\\0';\n    return str;\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virrandom.h\"",
      "#include \"virmacaddr.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_snprintf",
          "args": [
            "str",
            "VIR_MAC_STRING_BUFLEN",
            "\"%02x:%02x:%02x:%02x:%02x:%02x\"",
            "addr->addr[0]",
            "addr->addr[1]",
            "addr->addr[2]",
            "addr->addr[3]",
            "addr->addr[4]",
            "addr->addr[5]"
          ],
          "line": 188
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virrandom.h\"\n#include \"virmacaddr.h\"\n#include <config.h>\n\nconst char *\nvirMacAddrFormat(const virMacAddr *addr,\n                 char *str)\n{\n    g_snprintf(str, VIR_MAC_STRING_BUFLEN,\n               \"%02x:%02x:%02x:%02x:%02x:%02x\",\n               addr->addr[0], addr->addr[1], addr->addr[2],\n               addr->addr[3], addr->addr[4], addr->addr[5]);\n    str[VIR_MAC_STRING_BUFLEN-1] = '\\0';\n    return str;\n}"
  },
  {
    "function_name": "virMacAddrParse",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virmacaddr.c",
    "lines": "141-175",
    "snippet": "int\nvirMacAddrParse(const char* str, virMacAddrPtr addr)\n{\n    size_t i;\n\n    errno = 0;\n    for (i = 0; i < VIR_MAC_BUFLEN; i++) {\n        char *end_ptr;\n        unsigned long result;\n\n        /* This is solely to avoid accepting the leading\n         * space or \"+\" that strtoul would otherwise accept.\n         */\n        if (!g_ascii_isxdigit(*str))\n            break;\n\n        result = strtoul(str, &end_ptr, 16); /* exempt from syntax-check */\n\n        if ((end_ptr - str) < 1 || 2 < (end_ptr - str) ||\n            (errno != 0) ||\n            (0xFF < result))\n            break;\n\n        addr->addr[i] = (unsigned char) result;\n\n        if ((i == 5) && (*end_ptr <= ' '))\n            return 0;\n        if (*end_ptr != ':')\n            break;\n\n        str = end_ptr + 1;\n    }\n\n    return -1;\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virrandom.h\"",
      "#include \"virmacaddr.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strtoul",
          "args": [
            "str",
            "&end_ptr",
            "16"
          ],
          "line": 157
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_ascii_isxdigit",
          "args": [
            "*str"
          ],
          "line": 154
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virrandom.h\"\n#include \"virmacaddr.h\"\n#include <config.h>\n\nint\nvirMacAddrParse(const char* str, virMacAddrPtr addr)\n{\n    size_t i;\n\n    errno = 0;\n    for (i = 0; i < VIR_MAC_BUFLEN; i++) {\n        char *end_ptr;\n        unsigned long result;\n\n        /* This is solely to avoid accepting the leading\n         * space or \"+\" that strtoul would otherwise accept.\n         */\n        if (!g_ascii_isxdigit(*str))\n            break;\n\n        result = strtoul(str, &end_ptr, 16); /* exempt from syntax-check */\n\n        if ((end_ptr - str) < 1 || 2 < (end_ptr - str) ||\n            (errno != 0) ||\n            (0xFF < result))\n            break;\n\n        addr->addr[i] = (unsigned char) result;\n\n        if ((i == 5) && (*end_ptr <= ' '))\n            return 0;\n        if (*end_ptr != ':')\n            break;\n\n        str = end_ptr + 1;\n    }\n\n    return -1;\n}"
  },
  {
    "function_name": "virMacAddrGetRaw",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virmacaddr.c",
    "lines": "126-130",
    "snippet": "void\nvirMacAddrGetRaw(const virMacAddr *src, unsigned char dst[VIR_MAC_BUFLEN])\n{\n    memcpy(dst, src->addr, VIR_MAC_BUFLEN);\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virrandom.h\"",
      "#include \"virmacaddr.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "dst",
            "src->addr",
            "VIR_MAC_BUFLEN"
          ],
          "line": 129
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virrandom.h\"\n#include \"virmacaddr.h\"\n#include <config.h>\n\nvoid\nvirMacAddrGetRaw(const virMacAddr *src, unsigned char dst[VIR_MAC_BUFLEN])\n{\n    memcpy(dst, src->addr, VIR_MAC_BUFLEN);\n}"
  },
  {
    "function_name": "virMacAddrSetRaw",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virmacaddr.c",
    "lines": "113-117",
    "snippet": "void\nvirMacAddrSetRaw(virMacAddrPtr dst, const unsigned char src[VIR_MAC_BUFLEN])\n{\n    memcpy(dst->addr, src, VIR_MAC_BUFLEN);\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virrandom.h\"",
      "#include \"virmacaddr.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "dst->addr",
            "src",
            "VIR_MAC_BUFLEN"
          ],
          "line": 116
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virrandom.h\"\n#include \"virmacaddr.h\"\n#include <config.h>\n\nvoid\nvirMacAddrSetRaw(virMacAddrPtr dst, const unsigned char src[VIR_MAC_BUFLEN])\n{\n    memcpy(dst->addr, src, VIR_MAC_BUFLEN);\n}"
  },
  {
    "function_name": "virMacAddrSet",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virmacaddr.c",
    "lines": "100-104",
    "snippet": "void\nvirMacAddrSet(virMacAddrPtr dst, const virMacAddr *src)\n{\n    memcpy(dst, src, sizeof(*src));\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virrandom.h\"",
      "#include \"virmacaddr.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "dst",
            "src",
            "sizeof(*src)"
          ],
          "line": 103
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virrandom.h\"\n#include \"virmacaddr.h\"\n#include <config.h>\n\nvoid\nvirMacAddrSet(virMacAddrPtr dst, const virMacAddr *src)\n{\n    memcpy(dst, src, sizeof(*src));\n}"
  },
  {
    "function_name": "virMacAddrCmpRaw",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virmacaddr.c",
    "lines": "86-91",
    "snippet": "int\nvirMacAddrCmpRaw(const virMacAddr *mac1,\n                 const unsigned char mac2[VIR_MAC_BUFLEN])\n{\n    return memcmp(mac1->addr, mac2, VIR_MAC_BUFLEN);\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virrandom.h\"",
      "#include \"virmacaddr.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcmp",
          "args": [
            "mac1->addr",
            "mac2",
            "VIR_MAC_BUFLEN"
          ],
          "line": 90
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virrandom.h\"\n#include \"virmacaddr.h\"\n#include <config.h>\n\nint\nvirMacAddrCmpRaw(const virMacAddr *mac1,\n                 const unsigned char mac2[VIR_MAC_BUFLEN])\n{\n    return memcmp(mac1->addr, mac2, VIR_MAC_BUFLEN);\n}"
  },
  {
    "function_name": "virMacAddrCmp",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virmacaddr.c",
    "lines": "71-75",
    "snippet": "int\nvirMacAddrCmp(const virMacAddr *mac1, const virMacAddr *mac2)\n{\n    return memcmp(mac1->addr, mac2->addr, VIR_MAC_BUFLEN);\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virrandom.h\"",
      "#include \"virmacaddr.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcmp",
          "args": [
            "mac1->addr",
            "mac2->addr",
            "VIR_MAC_BUFLEN"
          ],
          "line": 74
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virrandom.h\"\n#include \"virmacaddr.h\"\n#include <config.h>\n\nint\nvirMacAddrCmp(const virMacAddr *mac1, const virMacAddr *mac2)\n{\n    return memcmp(mac1->addr, mac2->addr, VIR_MAC_BUFLEN);\n}"
  },
  {
    "function_name": "virMacAddrCompare",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virmacaddr.c",
    "lines": "34-60",
    "snippet": "int\nvirMacAddrCompare(const char *p, const char *q)\n{\n    unsigned char c, d;\n    do {\n        while (*p == '0' && g_ascii_isxdigit(p[1]))\n            ++p;\n        while (*q == '0' && g_ascii_isxdigit(q[1]))\n            ++q;\n        c = g_ascii_tolower(*p);\n        d = g_ascii_tolower(*q);\n\n        if (c == 0 || d == 0)\n            break;\n\n        ++p;\n        ++q;\n    } while (c == d);\n\n    if (UCHAR_MAX <= INT_MAX)\n        return c - d;\n\n    /* On machines where 'char' and 'int' are types of the same size, the\n       difference of two 'unsigned char' values - including the sign bit -\n       doesn't fit in an 'int'.  */\n    return c > d ? 1 : c < d ? -1 : 0;\n}",
    "includes": [
      "#include \"viralloc.h\"",
      "#include \"virrandom.h\"",
      "#include \"virmacaddr.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_ascii_tolower",
          "args": [
            "*q"
          ],
          "line": 44
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_ascii_tolower",
          "args": [
            "*p"
          ],
          "line": 43
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_ascii_isxdigit",
          "args": [
            "q[1]"
          ],
          "line": 41
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_ascii_isxdigit",
          "args": [
            "p[1]"
          ],
          "line": 39
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"viralloc.h\"\n#include \"virrandom.h\"\n#include \"virmacaddr.h\"\n#include <config.h>\n\nint\nvirMacAddrCompare(const char *p, const char *q)\n{\n    unsigned char c, d;\n    do {\n        while (*p == '0' && g_ascii_isxdigit(p[1]))\n            ++p;\n        while (*q == '0' && g_ascii_isxdigit(q[1]))\n            ++q;\n        c = g_ascii_tolower(*p);\n        d = g_ascii_tolower(*q);\n\n        if (c == 0 || d == 0)\n            break;\n\n        ++p;\n        ++q;\n    } while (c == d);\n\n    if (UCHAR_MAX <= INT_MAX)\n        return c - d;\n\n    /* On machines where 'char' and 'int' are types of the same size, the\n       difference of two 'unsigned char' values - including the sign bit -\n       doesn't fit in an 'int'.  */\n    return c > d ? 1 : c < d ? -1 : 0;\n}"
  }
]