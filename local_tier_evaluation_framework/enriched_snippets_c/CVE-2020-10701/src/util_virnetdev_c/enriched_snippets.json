[
  {
    "function_name": "virNetDevRunEthernetScript",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
    "lines": "3448-3470",
    "snippet": "int\nvirNetDevRunEthernetScript(const char *ifname, const char *script)\n{\n    virCommandPtr cmd;\n    int ret;\n\n    /* Not a bug! Previously we did accept script=\"\" as a NO-OP. */\n    if (STREQ(script, \"\"))\n        return 0;\n\n    cmd = virCommandNew(script);\n    virCommandAddArgFormat(cmd, \"%s\", ifname);\n    virCommandClearCaps(cmd);\n#ifdef CAP_NET_ADMIN\n    virCommandAllowCap(cmd, CAP_NET_ADMIN);\n#endif\n    virCommandAddEnvPassCommon(cmd);\n\n    ret = virCommandRun(cmd, NULL);\n\n    virCommandFree(cmd);\n    return ret;\n}",
    "includes": [
      "# include <linux/devlink.h>",
      "# include <net/if_dl.h>",
      "# include <sys/sockio.h>",
      "# include <linux/ethtool.h>",
      "# include <linux/types.h>",
      "# include <linux/if_vlan.h>",
      "# include <linux/sockios.h>",
      "#include <fcntl.h>",
      "# include <sys/ioctl.h>",
      "#include \"virjson.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virpci.h\"",
      "#include \"vircommand.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetlink.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetdev.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct ethtool_value cmd = { 0 };"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCommandFree",
          "args": [
            "cmd"
          ],
          "line": 3468
        },
        "resolved": true,
        "details": {
          "function_name": "virCommandFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "2992-3047",
          "snippet": "void\nvirCommandFree(virCommandPtr cmd)\n{\n    size_t i;\n    if (!cmd)\n        return;\n\n    for (i = 0; i < cmd->npassfd; i++) {\n        if (cmd->passfd[i].flags & VIR_COMMAND_PASS_FD_CLOSE_PARENT)\n            VIR_FORCE_CLOSE(cmd->passfd[i].fd);\n    }\n    cmd->npassfd = 0;\n    VIR_FREE(cmd->passfd);\n\n    if (cmd->asyncioThread) {\n        virThreadJoin(cmd->asyncioThread);\n        VIR_FREE(cmd->asyncioThread);\n    }\n    VIR_FREE(cmd->inbuf);\n    VIR_FORCE_CLOSE(cmd->outfd);\n    VIR_FORCE_CLOSE(cmd->errfd);\n\n    for (i = 0; i < cmd->nargs; i++)\n        VIR_FREE(cmd->args[i]);\n    VIR_FREE(cmd->args);\n\n    for (i = 0; i < cmd->nenv; i++)\n        VIR_FREE(cmd->env[i]);\n    VIR_FREE(cmd->env);\n\n    VIR_FREE(cmd->pwd);\n\n    if (cmd->handshake) {\n        /* The other 2 fds in these arrays are closed\n         * due to use with virCommandPassFD\n         */\n        VIR_FORCE_CLOSE(cmd->handshakeWait[0]);\n        VIR_FORCE_CLOSE(cmd->handshakeNotify[1]);\n    }\n\n    VIR_FREE(cmd->pidfile);\n\n    if (cmd->reap)\n        virCommandAbort(cmd);\n\n#if defined(WITH_SECDRIVER_SELINUX)\n    VIR_FREE(cmd->seLinuxLabel);\n#endif\n#if defined(WITH_SECDRIVER_APPARMOR)\n    VIR_FREE(cmd->appArmorProfile);\n#endif\n\n    virCommandFreeSendBuffers(cmd);\n\n    VIR_FREE(cmd);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nvoid\nvirCommandFree(virCommandPtr cmd)\n{\n    size_t i;\n    if (!cmd)\n        return;\n\n    for (i = 0; i < cmd->npassfd; i++) {\n        if (cmd->passfd[i].flags & VIR_COMMAND_PASS_FD_CLOSE_PARENT)\n            VIR_FORCE_CLOSE(cmd->passfd[i].fd);\n    }\n    cmd->npassfd = 0;\n    VIR_FREE(cmd->passfd);\n\n    if (cmd->asyncioThread) {\n        virThreadJoin(cmd->asyncioThread);\n        VIR_FREE(cmd->asyncioThread);\n    }\n    VIR_FREE(cmd->inbuf);\n    VIR_FORCE_CLOSE(cmd->outfd);\n    VIR_FORCE_CLOSE(cmd->errfd);\n\n    for (i = 0; i < cmd->nargs; i++)\n        VIR_FREE(cmd->args[i]);\n    VIR_FREE(cmd->args);\n\n    for (i = 0; i < cmd->nenv; i++)\n        VIR_FREE(cmd->env[i]);\n    VIR_FREE(cmd->env);\n\n    VIR_FREE(cmd->pwd);\n\n    if (cmd->handshake) {\n        /* The other 2 fds in these arrays are closed\n         * due to use with virCommandPassFD\n         */\n        VIR_FORCE_CLOSE(cmd->handshakeWait[0]);\n        VIR_FORCE_CLOSE(cmd->handshakeNotify[1]);\n    }\n\n    VIR_FREE(cmd->pidfile);\n\n    if (cmd->reap)\n        virCommandAbort(cmd);\n\n#if defined(WITH_SECDRIVER_SELINUX)\n    VIR_FREE(cmd->seLinuxLabel);\n#endif\n#if defined(WITH_SECDRIVER_APPARMOR)\n    VIR_FREE(cmd->appArmorProfile);\n#endif\n\n    virCommandFreeSendBuffers(cmd);\n\n    VIR_FREE(cmd);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCommandRun",
          "args": [
            "cmd",
            "NULL"
          ],
          "line": 3466
        },
        "resolved": true,
        "details": {
          "function_name": "virCommandRunAsync",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "2931-2937",
          "snippet": "int\nvirCommandRunAsync(virCommandPtr cmd G_GNUC_UNUSED, pid_t *pid G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Executing new processes is not supported on Win32 platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nint\nvirCommandRunAsync(virCommandPtr cmd G_GNUC_UNUSED, pid_t *pid G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Executing new processes is not supported on Win32 platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCommandAddEnvPassCommon",
          "args": [
            "cmd"
          ],
          "line": 3464
        },
        "resolved": true,
        "details": {
          "function_name": "virCommandAddEnvPassCommon",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "1454-1474",
          "snippet": "void\nvirCommandAddEnvPassCommon(virCommandPtr cmd)\n{\n    if (!cmd || cmd->has_error)\n        return;\n\n    if (VIR_RESIZE_N(cmd->env, cmd->maxenv, cmd->nenv, 9) < 0) {\n        cmd->has_error = ENOMEM;\n        return;\n    }\n\n    virCommandAddEnvPair(cmd, \"LC_ALL\", \"C\");\n\n    virCommandAddEnvPass(cmd, \"LD_PRELOAD\");\n    virCommandAddEnvPass(cmd, \"LD_LIBRARY_PATH\");\n    virCommandAddEnvPass(cmd, \"PATH\");\n    virCommandAddEnvPass(cmd, \"HOME\");\n    virCommandAddEnvPass(cmd, \"USER\");\n    virCommandAddEnvPass(cmd, \"LOGNAME\");\n    virCommandAddEnvPass(cmd, \"TMPDIR\");\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nvoid\nvirCommandAddEnvPassCommon(virCommandPtr cmd)\n{\n    if (!cmd || cmd->has_error)\n        return;\n\n    if (VIR_RESIZE_N(cmd->env, cmd->maxenv, cmd->nenv, 9) < 0) {\n        cmd->has_error = ENOMEM;\n        return;\n    }\n\n    virCommandAddEnvPair(cmd, \"LC_ALL\", \"C\");\n\n    virCommandAddEnvPass(cmd, \"LD_PRELOAD\");\n    virCommandAddEnvPass(cmd, \"LD_LIBRARY_PATH\");\n    virCommandAddEnvPass(cmd, \"PATH\");\n    virCommandAddEnvPass(cmd, \"HOME\");\n    virCommandAddEnvPass(cmd, \"USER\");\n    virCommandAddEnvPass(cmd, \"LOGNAME\");\n    virCommandAddEnvPass(cmd, \"TMPDIR\");\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCommandAllowCap",
          "args": [
            "cmd",
            "CAP_NET_ADMIN"
          ],
          "line": 3462
        },
        "resolved": true,
        "details": {
          "function_name": "virCommandAllowCap",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "1195-1203",
          "snippet": "void\nvirCommandAllowCap(virCommandPtr cmd,\n                   int capability)\n{\n    if (!cmd || cmd->has_error)\n        return;\n\n    cmd->capabilities |= (1ULL << capability);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nvoid\nvirCommandAllowCap(virCommandPtr cmd,\n                   int capability)\n{\n    if (!cmd || cmd->has_error)\n        return;\n\n    cmd->capabilities |= (1ULL << capability);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCommandClearCaps",
          "args": [
            "cmd"
          ],
          "line": 3460
        },
        "resolved": true,
        "details": {
          "function_name": "virCommandClearCaps",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "1179-1186",
          "snippet": "void\nvirCommandClearCaps(virCommandPtr cmd)\n{\n    if (!cmd || cmd->has_error)\n        return;\n\n    cmd->flags |= VIR_EXEC_CLEAR_CAPS;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nvoid\nvirCommandClearCaps(virCommandPtr cmd)\n{\n    if (!cmd || cmd->has_error)\n        return;\n\n    cmd->flags |= VIR_EXEC_CLEAR_CAPS;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCommandAddArgFormat",
          "args": [
            "cmd",
            "\"%s\"",
            "ifname"
          ],
          "line": 3459
        },
        "resolved": true,
        "details": {
          "function_name": "virCommandAddArgFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "1569-1590",
          "snippet": "void\nvirCommandAddArgFormat(virCommandPtr cmd, const char *format, ...)\n{\n    char *arg;\n    va_list list;\n\n    if (!cmd || cmd->has_error)\n        return;\n\n    va_start(list, format);\n    arg = g_strdup_vprintf(format, list);\n    va_end(list);\n\n    /* Arg plus trailing NULL. */\n    if (VIR_RESIZE_N(cmd->args, cmd->maxargs, cmd->nargs, 1 + 1) < 0) {\n        VIR_FREE(arg);\n        cmd->has_error = ENOMEM;\n        return;\n    }\n\n    cmd->args[cmd->nargs++] = arg;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nvoid\nvirCommandAddArgFormat(virCommandPtr cmd, const char *format, ...)\n{\n    char *arg;\n    va_list list;\n\n    if (!cmd || cmd->has_error)\n        return;\n\n    va_start(list, format);\n    arg = g_strdup_vprintf(format, list);\n    va_end(list);\n\n    /* Arg plus trailing NULL. */\n    if (VIR_RESIZE_N(cmd->args, cmd->maxargs, cmd->nargs, 1 + 1) < 0) {\n        VIR_FREE(arg);\n        cmd->has_error = ENOMEM;\n        return;\n    }\n\n    cmd->args[cmd->nargs++] = arg;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCommandNew",
          "args": [
            "script"
          ],
          "line": 3458
        },
        "resolved": true,
        "details": {
          "function_name": "virCommandNewArgList",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "969-980",
          "snippet": "virCommandPtr\nvirCommandNewArgList(const char *binary, ...)\n{\n    virCommandPtr cmd;\n    va_list list;\n\n    va_start(list, binary);\n    cmd = virCommandNewVAList(binary, list);\n    va_end(list);\n\n    return cmd;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nvirCommandPtr\nvirCommandNewArgList(const char *binary, ...)\n{\n    virCommandPtr cmd;\n    va_list list;\n\n    va_start(list, binary);\n    cmd = virCommandNewVAList(binary, list);\n    va_end(list);\n\n    return cmd;\n}"
        }
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "script",
            "\"\""
          ],
          "line": 3455
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nstruct ethtool_value cmd = { 0 };\n\nint\nvirNetDevRunEthernetScript(const char *ifname, const char *script)\n{\n    virCommandPtr cmd;\n    int ret;\n\n    /* Not a bug! Previously we did accept script=\"\" as a NO-OP. */\n    if (STREQ(script, \"\"))\n        return 0;\n\n    cmd = virCommandNew(script);\n    virCommandAddArgFormat(cmd, \"%s\", ifname);\n    virCommandClearCaps(cmd);\n#ifdef CAP_NET_ADMIN\n    virCommandAllowCap(cmd, CAP_NET_ADMIN);\n#endif\n    virCommandAddEnvPassCommon(cmd);\n\n    ret = virCommandRun(cmd, NULL);\n\n    virCommandFree(cmd);\n    return ret;\n}"
  },
  {
    "function_name": "virNetDevSetCoalesce",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
    "lines": "3425-3436",
    "snippet": "int virNetDevSetCoalesce(const char *ifname,\n                         virNetDevCoalescePtr coalesce,\n                         bool update)\n{\n    if (!coalesce && !update)\n        return 0;\n\n    virReportSystemError(ENOSYS,\n                         _(\"Cannot set coalesce info on interface '%s'\"),\n                         ifname);\n    return -1;\n}",
    "includes": [
      "# include <linux/devlink.h>",
      "# include <net/if_dl.h>",
      "# include <sys/sockio.h>",
      "# include <linux/ethtool.h>",
      "# include <linux/types.h>",
      "# include <linux/if_vlan.h>",
      "# include <linux/sockios.h>",
      "#include <fcntl.h>",
      "# include <sys/ioctl.h>",
      "#include \"virjson.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virpci.h\"",
      "#include \"vircommand.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetlink.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetdev.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "_(\"Cannot set coalesce info on interface '%s'\")",
            "ifname"
          ],
          "line": 3432
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Cannot set coalesce info on interface '%s'\""
          ],
          "line": 3433
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint virNetDevSetCoalesce(const char *ifname,\n                         virNetDevCoalescePtr coalesce,\n                         bool update)\n{\n    if (!coalesce && !update)\n        return 0;\n\n    virReportSystemError(ENOSYS,\n                         _(\"Cannot set coalesce info on interface '%s'\"),\n                         ifname);\n    return -1;\n}"
  },
  {
    "function_name": "virNetDevGetFeatures",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
    "lines": "3416-3423",
    "snippet": "int\nvirNetDevGetFeatures(const char *ifname G_GNUC_UNUSED,\n                     virBitmapPtr *out G_GNUC_UNUSED)\n{\n    VIR_DEBUG(\"Getting network device features on %s is not implemented on this platform\",\n              ifname);\n    return 0;\n}",
    "includes": [
      "# include <linux/devlink.h>",
      "# include <net/if_dl.h>",
      "# include <sys/sockio.h>",
      "# include <linux/ethtool.h>",
      "# include <linux/types.h>",
      "# include <linux/if_vlan.h>",
      "# include <linux/sockios.h>",
      "#include <fcntl.h>",
      "# include <sys/ioctl.h>",
      "#include \"virjson.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virpci.h\"",
      "#include \"vircommand.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetlink.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetdev.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Getting network device features on %s is not implemented on this platform\"",
            "ifname"
          ],
          "line": 3420
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint\nvirNetDevGetFeatures(const char *ifname G_GNUC_UNUSED,\n                     virBitmapPtr *out G_GNUC_UNUSED)\n{\n    VIR_DEBUG(\"Getting network device features on %s is not implemented on this platform\",\n              ifname);\n    return 0;\n}"
  },
  {
    "function_name": "virNetDevGetFeatures",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
    "lines": "3389-3414",
    "snippet": "int\nvirNetDevGetFeatures(const char *ifname,\n                     virBitmapPtr *out)\n{\n    struct ifreq ifr;\n    VIR_AUTOCLOSE fd = -1;\n\n    if (!(*out = virBitmapNew(VIR_NET_DEV_FEAT_LAST)))\n        return -1;\n\n    if ((fd = virNetDevSetupControl(ifname, &ifr)) < 0)\n        return -1;\n\n    virNetDevGetEthtoolFeatures(*out, fd, &ifr);\n\n    if (virNetDevGetEthtoolGFeatures(*out, fd, &ifr) < 0)\n        return -1;\n\n    if (virNetDevRDMAFeature(ifname, out) < 0)\n        return -1;\n\n    if (virNetDevSwitchdevFeature(ifname, out) < 0)\n        return -1;\n\n    return 0;\n}",
    "includes": [
      "# include <linux/devlink.h>",
      "# include <net/if_dl.h>",
      "# include <sys/sockio.h>",
      "# include <linux/ethtool.h>",
      "# include <linux/types.h>",
      "# include <linux/if_vlan.h>",
      "# include <linux/sockios.h>",
      "#include <fcntl.h>",
      "# include <sys/ioctl.h>",
      "#include \"virjson.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virpci.h\"",
      "#include \"vircommand.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetlink.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetdev.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNetDevSwitchdevFeature",
          "args": [
            "ifname",
            "out"
          ],
          "line": 3410
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevSwitchdevFeature",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
          "lines": "3206-3211",
          "snippet": "static int\nvirNetDevSwitchdevFeature(const char *ifname G_GNUC_UNUSED,\n                          virBitmapPtr *out G_GNUC_UNUSED)\n{\n    return 0;\n}",
          "includes": [
            "# include <linux/devlink.h>",
            "# include <net/if_dl.h>",
            "# include <sys/sockio.h>",
            "# include <linux/ethtool.h>",
            "# include <linux/types.h>",
            "# include <linux/if_vlan.h>",
            "# include <linux/sockios.h>",
            "#include <fcntl.h>",
            "# include <sys/ioctl.h>",
            "#include \"virjson.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virpci.h\"",
            "#include \"vircommand.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetlink.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetdev.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nstatic int\nvirNetDevSwitchdevFeature(const char *ifname G_GNUC_UNUSED,\n                          virBitmapPtr *out G_GNUC_UNUSED)\n{\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetDevRDMAFeature",
          "args": [
            "ifname",
            "out"
          ],
          "line": 3407
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevRDMAFeature",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
          "lines": "2882-2932",
          "snippet": "static int\nvirNetDevRDMAFeature(const char *ifname,\n                     virBitmapPtr *out)\n{\n    char *eth_devpath = NULL;\n    char *ib_devpath = NULL;\n    char *eth_res_buf = NULL;\n    char *ib_res_buf = NULL;\n    DIR *dirp = NULL;\n    struct dirent *dp;\n    int ret = -1;\n\n    if (!virFileExists(SYSFS_INFINIBAND_DIR))\n        return 0;\n\n    if (virDirOpen(&dirp, SYSFS_INFINIBAND_DIR) < 0)\n        return -1;\n\n    eth_devpath = g_strdup_printf(SYSFS_NET_DIR \"%s/device/resource\", ifname);\n\n    /* If /sys/class/net/<ifname>/device/resource doesn't exist it is not a PCI\n     * device and therefore it will not have RDMA. */\n    if (!virFileExists(eth_devpath)) {\n        ret = 0;\n        goto cleanup;\n    }\n\n    if (virFileReadAll(eth_devpath, RESOURCE_FILE_LEN, &eth_res_buf) < 0)\n        goto cleanup;\n\n    while (virDirRead(dirp, &dp, SYSFS_INFINIBAND_DIR) > 0) {\n        ib_devpath = g_strdup_printf(SYSFS_INFINIBAND_DIR \"%s/device/resource\",\n                                     dp->d_name);\n        if (virFileReadAll(ib_devpath, RESOURCE_FILE_LEN, &ib_res_buf) > 0 &&\n            STREQ(eth_res_buf, ib_res_buf)) {\n            ignore_value(virBitmapSetBit(*out, VIR_NET_DEV_FEAT_RDMA));\n            break;\n        }\n        VIR_FREE(ib_devpath);\n        VIR_FREE(ib_res_buf);\n    }\n    ret = 0;\n\n cleanup:\n    VIR_DIR_CLOSE(dirp);\n    VIR_FREE(eth_devpath);\n    VIR_FREE(ib_devpath);\n    VIR_FREE(eth_res_buf);\n    VIR_FREE(ib_res_buf);\n    return ret;\n}",
          "includes": [
            "# include <linux/devlink.h>",
            "# include <net/if_dl.h>",
            "# include <sys/sockio.h>",
            "# include <linux/ethtool.h>",
            "# include <linux/types.h>",
            "# include <linux/if_vlan.h>",
            "# include <linux/sockios.h>",
            "#include <fcntl.h>",
            "# include <sys/ioctl.h>",
            "#include \"virjson.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virpci.h\"",
            "#include \"vircommand.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetlink.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetdev.h\"",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define RESOURCE_FILE_LEN 4096"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\n#define RESOURCE_FILE_LEN 4096\n\nstatic int\nvirNetDevRDMAFeature(const char *ifname,\n                     virBitmapPtr *out)\n{\n    char *eth_devpath = NULL;\n    char *ib_devpath = NULL;\n    char *eth_res_buf = NULL;\n    char *ib_res_buf = NULL;\n    DIR *dirp = NULL;\n    struct dirent *dp;\n    int ret = -1;\n\n    if (!virFileExists(SYSFS_INFINIBAND_DIR))\n        return 0;\n\n    if (virDirOpen(&dirp, SYSFS_INFINIBAND_DIR) < 0)\n        return -1;\n\n    eth_devpath = g_strdup_printf(SYSFS_NET_DIR \"%s/device/resource\", ifname);\n\n    /* If /sys/class/net/<ifname>/device/resource doesn't exist it is not a PCI\n     * device and therefore it will not have RDMA. */\n    if (!virFileExists(eth_devpath)) {\n        ret = 0;\n        goto cleanup;\n    }\n\n    if (virFileReadAll(eth_devpath, RESOURCE_FILE_LEN, &eth_res_buf) < 0)\n        goto cleanup;\n\n    while (virDirRead(dirp, &dp, SYSFS_INFINIBAND_DIR) > 0) {\n        ib_devpath = g_strdup_printf(SYSFS_INFINIBAND_DIR \"%s/device/resource\",\n                                     dp->d_name);\n        if (virFileReadAll(ib_devpath, RESOURCE_FILE_LEN, &ib_res_buf) > 0 &&\n            STREQ(eth_res_buf, ib_res_buf)) {\n            ignore_value(virBitmapSetBit(*out, VIR_NET_DEV_FEAT_RDMA));\n            break;\n        }\n        VIR_FREE(ib_devpath);\n        VIR_FREE(ib_res_buf);\n    }\n    ret = 0;\n\n cleanup:\n    VIR_DIR_CLOSE(dirp);\n    VIR_FREE(eth_devpath);\n    VIR_FREE(ib_devpath);\n    VIR_FREE(eth_res_buf);\n    VIR_FREE(ib_res_buf);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetDevGetEthtoolGFeatures",
          "args": [
            "*out",
            "fd",
            "&ifr"
          ],
          "line": 3404
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevGetEthtoolGFeatures",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
          "lines": "3257-3263",
          "snippet": "static int\nvirNetDevGetEthtoolGFeatures(virBitmapPtr bitmap G_GNUC_UNUSED,\n                             int fd G_GNUC_UNUSED,\n                             struct ifreq *ifr G_GNUC_UNUSED)\n{\n    return 0;\n}",
          "includes": [
            "# include <linux/devlink.h>",
            "# include <net/if_dl.h>",
            "# include <sys/sockio.h>",
            "# include <linux/ethtool.h>",
            "# include <linux/types.h>",
            "# include <linux/if_vlan.h>",
            "# include <linux/sockios.h>",
            "#include <fcntl.h>",
            "# include <sys/ioctl.h>",
            "#include \"virjson.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virpci.h\"",
            "#include \"vircommand.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetlink.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetdev.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nstatic int\nvirNetDevGetEthtoolGFeatures(virBitmapPtr bitmap G_GNUC_UNUSED,\n                             int fd G_GNUC_UNUSED,\n                             struct ifreq *ifr G_GNUC_UNUSED)\n{\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetDevGetEthtoolFeatures",
          "args": [
            "*out",
            "fd",
            "&ifr"
          ],
          "line": 3402
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNetDevSetupControl",
          "args": [
            "ifname",
            "&ifr"
          ],
          "line": 3399
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevSetupControl",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
          "lines": "177-185",
          "snippet": "int\nvirNetDevSetupControl(const char *ifname G_GNUC_UNUSED,\n                      void *ifr G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Network device configuration is not supported \"\n                           \"on this platform\"));\n    return -1;\n}",
          "includes": [
            "# include <linux/devlink.h>",
            "# include <net/if_dl.h>",
            "# include <sys/sockio.h>",
            "# include <linux/ethtool.h>",
            "# include <linux/types.h>",
            "# include <linux/if_vlan.h>",
            "# include <linux/sockios.h>",
            "#include <fcntl.h>",
            "# include <sys/ioctl.h>",
            "#include \"virjson.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virpci.h\"",
            "#include \"vircommand.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetlink.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetdev.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint\nvirNetDevSetupControl(const char *ifname G_GNUC_UNUSED,\n                      void *ifr G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Network device configuration is not supported \"\n                           \"on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBitmapNew",
          "args": [
            "VIR_NET_DEV_FEAT_LAST"
          ],
          "line": 3396
        },
        "resolved": true,
        "details": {
          "function_name": "virBitmapNewString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
          "lines": "1144-1168",
          "snippet": "virBitmapPtr\nvirBitmapNewString(const char *string)\n{\n    virBitmapPtr bitmap;\n    size_t i = 0;\n    size_t len = strlen(string);\n\n    if (strspn(string, \"0123456789abcdefABCDEF\") != len) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"Invalid hexadecimal string '%s'\"), string);\n        return NULL;\n    }\n\n    bitmap = virBitmapNew(len * 4);\n    if (!bitmap)\n        return NULL;\n\n    for (i = 0; i < len; i++) {\n        unsigned long nibble = g_ascii_xdigit_value(string[len - i - 1]);\n        nibble <<= VIR_BITMAP_BIT_OFFSET(i * 4);\n        bitmap->map[VIR_BITMAP_UNIT_OFFSET(i * 4)] |= nibble;\n    }\n\n    return bitmap;\n}",
          "includes": [
            "#include \"virerror.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbitmap.h\"",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\nvirBitmapPtr\nvirBitmapNewString(const char *string)\n{\n    virBitmapPtr bitmap;\n    size_t i = 0;\n    size_t len = strlen(string);\n\n    if (strspn(string, \"0123456789abcdefABCDEF\") != len) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"Invalid hexadecimal string '%s'\"), string);\n        return NULL;\n    }\n\n    bitmap = virBitmapNew(len * 4);\n    if (!bitmap)\n        return NULL;\n\n    for (i = 0; i < len; i++) {\n        unsigned long nibble = g_ascii_xdigit_value(string[len - i - 1]);\n        nibble <<= VIR_BITMAP_BIT_OFFSET(i * 4);\n        bitmap->map[VIR_BITMAP_UNIT_OFFSET(i * 4)] |= nibble;\n    }\n\n    return bitmap;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint\nvirNetDevGetFeatures(const char *ifname,\n                     virBitmapPtr *out)\n{\n    struct ifreq ifr;\n    VIR_AUTOCLOSE fd = -1;\n\n    if (!(*out = virBitmapNew(VIR_NET_DEV_FEAT_LAST)))\n        return -1;\n\n    if ((fd = virNetDevSetupControl(ifname, &ifr)) < 0)\n        return -1;\n\n    virNetDevGetEthtoolFeatures(*out, fd, &ifr);\n\n    if (virNetDevGetEthtoolGFeatures(*out, fd, &ifr) < 0)\n        return -1;\n\n    if (virNetDevRDMAFeature(ifname, out) < 0)\n        return -1;\n\n    if (virNetDevSwitchdevFeature(ifname, out) < 0)\n        return -1;\n\n    return 0;\n}"
  },
  {
    "function_name": "virNetDevSetCoalesce",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
    "lines": "3364-3375",
    "snippet": "int virNetDevSetCoalesce(const char *ifname,\n                         virNetDevCoalescePtr coalesce,\n                         bool update)\n{\n    if (!coalesce && !update)\n        return 0;\n\n    virReportSystemError(ENOSYS,\n                         _(\"Cannot set coalesce info on interface '%s'\"),\n                         ifname);\n    return -1;\n}",
    "includes": [
      "# include <linux/devlink.h>",
      "# include <net/if_dl.h>",
      "# include <sys/sockio.h>",
      "# include <linux/ethtool.h>",
      "# include <linux/types.h>",
      "# include <linux/if_vlan.h>",
      "# include <linux/sockios.h>",
      "#include <fcntl.h>",
      "# include <sys/ioctl.h>",
      "#include \"virjson.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virpci.h\"",
      "#include \"vircommand.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetlink.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetdev.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "_(\"Cannot set coalesce info on interface '%s'\")",
            "ifname"
          ],
          "line": 3371
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Cannot set coalesce info on interface '%s'\""
          ],
          "line": 3372
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint virNetDevSetCoalesce(const char *ifname,\n                         virNetDevCoalescePtr coalesce,\n                         bool update)\n{\n    if (!coalesce && !update)\n        return 0;\n\n    virReportSystemError(ENOSYS,\n                         _(\"Cannot set coalesce info on interface '%s'\"),\n                         ifname);\n    return -1;\n}"
  },
  {
    "function_name": "virNetDevSetCoalesce",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
    "lines": "3279-3362",
    "snippet": "int virNetDevSetCoalesce(const char *ifname,\n                         virNetDevCoalescePtr coalesce,\n                         bool update)\n{\n    struct ifreq ifr;\n    struct ethtool_coalesce coal = {0};\n    VIR_AUTOCLOSE fd = -1;\n\n    if (!coalesce && !update)\n        return 0;\n\n    if (coalesce) {\n        coal = (struct ethtool_coalesce) {\n            .rx_max_coalesced_frames = coalesce->rx_max_coalesced_frames,\n            .rx_coalesce_usecs_irq = coalesce->rx_coalesce_usecs_irq,\n            .rx_max_coalesced_frames_irq = coalesce->rx_max_coalesced_frames_irq,\n            .tx_coalesce_usecs = coalesce->tx_coalesce_usecs,\n            .tx_max_coalesced_frames = coalesce->tx_max_coalesced_frames,\n            .tx_coalesce_usecs_irq = coalesce->tx_coalesce_usecs_irq,\n            .tx_max_coalesced_frames_irq = coalesce->tx_max_coalesced_frames_irq,\n            .stats_block_coalesce_usecs = coalesce->stats_block_coalesce_usecs,\n            .use_adaptive_rx_coalesce = coalesce->use_adaptive_rx_coalesce,\n            .use_adaptive_tx_coalesce = coalesce->use_adaptive_tx_coalesce,\n            .pkt_rate_low = coalesce->pkt_rate_low,\n            .rx_coalesce_usecs_low = coalesce->rx_coalesce_usecs_low,\n            .rx_max_coalesced_frames_low = coalesce->rx_max_coalesced_frames_low,\n            .tx_coalesce_usecs_low = coalesce->tx_coalesce_usecs_low,\n            .tx_max_coalesced_frames_low = coalesce->tx_max_coalesced_frames_low,\n            .pkt_rate_high = coalesce->pkt_rate_high,\n            .rx_coalesce_usecs_high = coalesce->rx_coalesce_usecs_high,\n            .rx_max_coalesced_frames_high = coalesce->rx_max_coalesced_frames_high,\n            .tx_coalesce_usecs_high = coalesce->tx_coalesce_usecs_high,\n            .tx_max_coalesced_frames_high = coalesce->tx_max_coalesced_frames_high,\n            .rate_sample_interval = coalesce->rate_sample_interval,\n        };\n    }\n\n    coal.cmd = ETHTOOL_SCOALESCE;\n\n    if ((fd = virNetDevSetupControl(ifname, &ifr)) < 0)\n        return -1;\n\n    ifr.ifr_data = (void *) &coal;\n\n    if (virNetDevSendEthtoolIoctl(fd, &ifr) < 0) {\n        virReportSystemError(errno,\n                             _(\"Cannot set coalesce info on '%s'\"),\n                             ifname);\n        return -1;\n    }\n\n    if (coalesce) {\n        coal = (struct ethtool_coalesce) {\n            .cmd = ETHTOOL_GCOALESCE,\n        };\n\n        /* Don't fail if the update itself fails */\n        if (virNetDevSendEthtoolIoctl(fd, &ifr) == 0) {\n            coalesce->rx_max_coalesced_frames = coal.rx_max_coalesced_frames;\n            coalesce->rx_coalesce_usecs_irq = coal.rx_coalesce_usecs_irq;\n            coalesce->rx_max_coalesced_frames_irq = coal.rx_max_coalesced_frames_irq;\n            coalesce->tx_coalesce_usecs = coal.tx_coalesce_usecs;\n            coalesce->tx_max_coalesced_frames = coal.tx_max_coalesced_frames;\n            coalesce->tx_coalesce_usecs_irq = coal.tx_coalesce_usecs_irq;\n            coalesce->tx_max_coalesced_frames_irq = coal.tx_max_coalesced_frames_irq;\n            coalesce->stats_block_coalesce_usecs = coal.stats_block_coalesce_usecs;\n            coalesce->use_adaptive_rx_coalesce = coal.use_adaptive_rx_coalesce;\n            coalesce->use_adaptive_tx_coalesce = coal.use_adaptive_tx_coalesce;\n            coalesce->pkt_rate_low = coal.pkt_rate_low;\n            coalesce->rx_coalesce_usecs_low = coal.rx_coalesce_usecs_low;\n            coalesce->rx_max_coalesced_frames_low = coal.rx_max_coalesced_frames_low;\n            coalesce->tx_coalesce_usecs_low = coal.tx_coalesce_usecs_low;\n            coalesce->tx_max_coalesced_frames_low = coal.tx_max_coalesced_frames_low;\n            coalesce->pkt_rate_high = coal.pkt_rate_high;\n            coalesce->rx_coalesce_usecs_high = coal.rx_coalesce_usecs_high;\n            coalesce->rx_max_coalesced_frames_high = coal.rx_max_coalesced_frames_high;\n            coalesce->tx_coalesce_usecs_high = coal.tx_coalesce_usecs_high;\n            coalesce->tx_max_coalesced_frames_high = coal.tx_max_coalesced_frames_high;\n            coalesce->rate_sample_interval = coal.rate_sample_interval;\n        }\n    }\n\n    return 0;\n}",
    "includes": [
      "# include <linux/devlink.h>",
      "# include <net/if_dl.h>",
      "# include <sys/sockio.h>",
      "# include <linux/ethtool.h>",
      "# include <linux/types.h>",
      "# include <linux/if_vlan.h>",
      "# include <linux/sockios.h>",
      "#include <fcntl.h>",
      "# include <sys/ioctl.h>",
      "#include \"virjson.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virpci.h\"",
      "#include \"vircommand.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetlink.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetdev.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct ethtool_value cmd = { 0 };"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNetDevSendEthtoolIoctl",
          "args": [
            "fd",
            "&ifr"
          ],
          "line": 3336
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevSendEthtoolIoctl",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
          "lines": "2944-2965",
          "snippet": "static int\nvirNetDevSendEthtoolIoctl(int fd, struct ifreq *ifr)\n{\n    int ret = -1;\n\n    ret = ioctl(fd, SIOCETHTOOL, ifr);\n    if (ret != 0) {\n        switch (errno) {\n        case EINVAL: /* kernel doesn't support SIOCETHTOOL */\n            VIR_DEBUG(\"ethtool ioctl: invalid request\");\n            break;\n        case EOPNOTSUPP: /* kernel doesn't support specific feature */\n            VIR_DEBUG(\"ethtool ioctl: request not supported\");\n            break;\n        default:\n            virReportSystemError(errno, \"%s\", _(\"ethtool ioctl error\"));\n            break;\n        }\n    }\n\n    return ret;\n}",
          "includes": [
            "# include <linux/devlink.h>",
            "# include <net/if_dl.h>",
            "# include <sys/sockio.h>",
            "# include <linux/ethtool.h>",
            "# include <linux/types.h>",
            "# include <linux/if_vlan.h>",
            "# include <linux/sockios.h>",
            "#include <fcntl.h>",
            "# include <sys/ioctl.h>",
            "#include \"virjson.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virpci.h\"",
            "#include \"vircommand.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetlink.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetdev.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nstatic int\nvirNetDevSendEthtoolIoctl(int fd, struct ifreq *ifr)\n{\n    int ret = -1;\n\n    ret = ioctl(fd, SIOCETHTOOL, ifr);\n    if (ret != 0) {\n        switch (errno) {\n        case EINVAL: /* kernel doesn't support SIOCETHTOOL */\n            VIR_DEBUG(\"ethtool ioctl: invalid request\");\n            break;\n        case EOPNOTSUPP: /* kernel doesn't support specific feature */\n            VIR_DEBUG(\"ethtool ioctl: request not supported\");\n            break;\n        default:\n            virReportSystemError(errno, \"%s\", _(\"ethtool ioctl error\"));\n            break;\n        }\n    }\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"Cannot set coalesce info on '%s'\")",
            "ifname"
          ],
          "line": 3324
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Cannot set coalesce info on '%s'\""
          ],
          "line": 3325
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetDevSetupControl",
          "args": [
            "ifname",
            "&ifr"
          ],
          "line": 3318
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevSetupControl",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
          "lines": "177-185",
          "snippet": "int\nvirNetDevSetupControl(const char *ifname G_GNUC_UNUSED,\n                      void *ifr G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Network device configuration is not supported \"\n                           \"on this platform\"));\n    return -1;\n}",
          "includes": [
            "# include <linux/devlink.h>",
            "# include <net/if_dl.h>",
            "# include <sys/sockio.h>",
            "# include <linux/ethtool.h>",
            "# include <linux/types.h>",
            "# include <linux/if_vlan.h>",
            "# include <linux/sockios.h>",
            "#include <fcntl.h>",
            "# include <sys/ioctl.h>",
            "#include \"virjson.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virpci.h\"",
            "#include \"vircommand.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetlink.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetdev.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint\nvirNetDevSetupControl(const char *ifname G_GNUC_UNUSED,\n                      void *ifr G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Network device configuration is not supported \"\n                           \"on this platform\"));\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nstruct ethtool_value cmd = { 0 };\n\nint virNetDevSetCoalesce(const char *ifname,\n                         virNetDevCoalescePtr coalesce,\n                         bool update)\n{\n    struct ifreq ifr;\n    struct ethtool_coalesce coal = {0};\n    VIR_AUTOCLOSE fd = -1;\n\n    if (!coalesce && !update)\n        return 0;\n\n    if (coalesce) {\n        coal = (struct ethtool_coalesce) {\n            .rx_max_coalesced_frames = coalesce->rx_max_coalesced_frames,\n            .rx_coalesce_usecs_irq = coalesce->rx_coalesce_usecs_irq,\n            .rx_max_coalesced_frames_irq = coalesce->rx_max_coalesced_frames_irq,\n            .tx_coalesce_usecs = coalesce->tx_coalesce_usecs,\n            .tx_max_coalesced_frames = coalesce->tx_max_coalesced_frames,\n            .tx_coalesce_usecs_irq = coalesce->tx_coalesce_usecs_irq,\n            .tx_max_coalesced_frames_irq = coalesce->tx_max_coalesced_frames_irq,\n            .stats_block_coalesce_usecs = coalesce->stats_block_coalesce_usecs,\n            .use_adaptive_rx_coalesce = coalesce->use_adaptive_rx_coalesce,\n            .use_adaptive_tx_coalesce = coalesce->use_adaptive_tx_coalesce,\n            .pkt_rate_low = coalesce->pkt_rate_low,\n            .rx_coalesce_usecs_low = coalesce->rx_coalesce_usecs_low,\n            .rx_max_coalesced_frames_low = coalesce->rx_max_coalesced_frames_low,\n            .tx_coalesce_usecs_low = coalesce->tx_coalesce_usecs_low,\n            .tx_max_coalesced_frames_low = coalesce->tx_max_coalesced_frames_low,\n            .pkt_rate_high = coalesce->pkt_rate_high,\n            .rx_coalesce_usecs_high = coalesce->rx_coalesce_usecs_high,\n            .rx_max_coalesced_frames_high = coalesce->rx_max_coalesced_frames_high,\n            .tx_coalesce_usecs_high = coalesce->tx_coalesce_usecs_high,\n            .tx_max_coalesced_frames_high = coalesce->tx_max_coalesced_frames_high,\n            .rate_sample_interval = coalesce->rate_sample_interval,\n        };\n    }\n\n    coal.cmd = ETHTOOL_SCOALESCE;\n\n    if ((fd = virNetDevSetupControl(ifname, &ifr)) < 0)\n        return -1;\n\n    ifr.ifr_data = (void *) &coal;\n\n    if (virNetDevSendEthtoolIoctl(fd, &ifr) < 0) {\n        virReportSystemError(errno,\n                             _(\"Cannot set coalesce info on '%s'\"),\n                             ifname);\n        return -1;\n    }\n\n    if (coalesce) {\n        coal = (struct ethtool_coalesce) {\n            .cmd = ETHTOOL_GCOALESCE,\n        };\n\n        /* Don't fail if the update itself fails */\n        if (virNetDevSendEthtoolIoctl(fd, &ifr) == 0) {\n            coalesce->rx_max_coalesced_frames = coal.rx_max_coalesced_frames;\n            coalesce->rx_coalesce_usecs_irq = coal.rx_coalesce_usecs_irq;\n            coalesce->rx_max_coalesced_frames_irq = coal.rx_max_coalesced_frames_irq;\n            coalesce->tx_coalesce_usecs = coal.tx_coalesce_usecs;\n            coalesce->tx_max_coalesced_frames = coal.tx_max_coalesced_frames;\n            coalesce->tx_coalesce_usecs_irq = coal.tx_coalesce_usecs_irq;\n            coalesce->tx_max_coalesced_frames_irq = coal.tx_max_coalesced_frames_irq;\n            coalesce->stats_block_coalesce_usecs = coal.stats_block_coalesce_usecs;\n            coalesce->use_adaptive_rx_coalesce = coal.use_adaptive_rx_coalesce;\n            coalesce->use_adaptive_tx_coalesce = coal.use_adaptive_tx_coalesce;\n            coalesce->pkt_rate_low = coal.pkt_rate_low;\n            coalesce->rx_coalesce_usecs_low = coal.rx_coalesce_usecs_low;\n            coalesce->rx_max_coalesced_frames_low = coal.rx_max_coalesced_frames_low;\n            coalesce->tx_coalesce_usecs_low = coal.tx_coalesce_usecs_low;\n            coalesce->tx_max_coalesced_frames_low = coal.tx_max_coalesced_frames_low;\n            coalesce->pkt_rate_high = coal.pkt_rate_high;\n            coalesce->rx_coalesce_usecs_high = coal.rx_coalesce_usecs_high;\n            coalesce->rx_max_coalesced_frames_high = coal.rx_max_coalesced_frames_high;\n            coalesce->tx_coalesce_usecs_high = coal.tx_coalesce_usecs_high;\n            coalesce->tx_max_coalesced_frames_high = coal.tx_max_coalesced_frames_high;\n            coalesce->rate_sample_interval = coal.rate_sample_interval;\n        }\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virNetDevGetEthtoolGFeatures",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
    "lines": "3257-3263",
    "snippet": "static int\nvirNetDevGetEthtoolGFeatures(virBitmapPtr bitmap G_GNUC_UNUSED,\n                             int fd G_GNUC_UNUSED,\n                             struct ifreq *ifr G_GNUC_UNUSED)\n{\n    return 0;\n}",
    "includes": [
      "# include <linux/devlink.h>",
      "# include <net/if_dl.h>",
      "# include <sys/sockio.h>",
      "# include <linux/ethtool.h>",
      "# include <linux/types.h>",
      "# include <linux/if_vlan.h>",
      "# include <linux/sockios.h>",
      "#include <fcntl.h>",
      "# include <sys/ioctl.h>",
      "#include \"virjson.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virpci.h\"",
      "#include \"vircommand.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetlink.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetdev.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nstatic int\nvirNetDevGetEthtoolGFeatures(virBitmapPtr bitmap G_GNUC_UNUSED,\n                             int fd G_GNUC_UNUSED,\n                             struct ifreq *ifr G_GNUC_UNUSED)\n{\n    return 0;\n}"
  },
  {
    "function_name": "virNetDevGetEthtoolGFeatures",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
    "lines": "3238-3255",
    "snippet": "static int\nvirNetDevGetEthtoolGFeatures(virBitmapPtr bitmap,\n                             int fd,\n                             struct ifreq *ifr)\n{\n    struct ethtool_gfeatures *g_cmd;\n\n    if (VIR_ALLOC_VAR(g_cmd,\n                      struct ethtool_get_features_block, GFEATURES_SIZE) < 0)\n        return -1;\n\n    g_cmd->cmd = ETHTOOL_GFEATURES;\n    g_cmd->size = GFEATURES_SIZE;\n    if (virNetDevGFeatureAvailable(fd, ifr, g_cmd))\n        ignore_value(virBitmapSetBit(bitmap, VIR_NET_DEV_FEAT_TXUDPTNL));\n    VIR_FREE(g_cmd);\n    return 0;\n}",
    "includes": [
      "# include <linux/devlink.h>",
      "# include <net/if_dl.h>",
      "# include <sys/sockio.h>",
      "# include <linux/ethtool.h>",
      "# include <linux/types.h>",
      "# include <linux/if_vlan.h>",
      "# include <linux/sockios.h>",
      "#include <fcntl.h>",
      "# include <sys/ioctl.h>",
      "#include \"virjson.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virpci.h\"",
      "#include \"vircommand.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetlink.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetdev.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct ethtool_value cmd = { 0 };"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "g_cmd"
          ],
          "line": 3253
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ignore_value",
          "args": [
            "virBitmapSetBit(bitmap, VIR_NET_DEV_FEAT_TXUDPTNL)"
          ],
          "line": 3252
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBitmapSetBit",
          "args": [
            "bitmap",
            "VIR_NET_DEV_FEAT_TXUDPTNL"
          ],
          "line": 3252
        },
        "resolved": true,
        "details": {
          "function_name": "virBitmapSetBitExpand",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
          "lines": "222-231",
          "snippet": "int\nvirBitmapSetBitExpand(virBitmapPtr bitmap,\n                      size_t b)\n{\n    if (bitmap->nbits <= b && virBitmapExpand(bitmap, b) < 0)\n        return -1;\n\n    bitmap->map[VIR_BITMAP_UNIT_OFFSET(b)] |= VIR_BITMAP_BIT(b);\n    return 0;\n}",
          "includes": [
            "#include \"virerror.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbitmap.h\"",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\nint\nvirBitmapSetBitExpand(virBitmapPtr bitmap,\n                      size_t b)\n{\n    if (bitmap->nbits <= b && virBitmapExpand(bitmap, b) < 0)\n        return -1;\n\n    bitmap->map[VIR_BITMAP_UNIT_OFFSET(b)] |= VIR_BITMAP_BIT(b);\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetDevGFeatureAvailable",
          "args": [
            "fd",
            "ifr",
            "g_cmd"
          ],
          "line": 3251
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevGFeatureAvailable",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
          "lines": "3226-3235",
          "snippet": "static bool\nvirNetDevGFeatureAvailable(int fd,\n                           struct ifreq *ifr,\n                           struct ethtool_gfeatures *cmd)\n{\n    ifr->ifr_data = (void*)cmd;\n    if (virNetDevSendEthtoolIoctl(fd, ifr) == 0)\n        return !!FEATURE_BIT_IS_SET(cmd->features, TX_UDP_TNL, active);\n    return false;\n}",
          "includes": [
            "# include <linux/devlink.h>",
            "# include <net/if_dl.h>",
            "# include <sys/sockio.h>",
            "# include <linux/ethtool.h>",
            "# include <linux/types.h>",
            "# include <linux/if_vlan.h>",
            "# include <linux/sockios.h>",
            "#include <fcntl.h>",
            "# include <sys/ioctl.h>",
            "#include \"virjson.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virpci.h\"",
            "#include \"vircommand.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetlink.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetdev.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct ethtool_value cmd = { 0 };"
          ],
          "called_functions": [],
          "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nstruct ethtool_value cmd = { 0 };\n\nstatic bool\nvirNetDevGFeatureAvailable(int fd,\n                           struct ifreq *ifr,\n                           struct ethtool_gfeatures *cmd)\n{\n    ifr->ifr_data = (void*)cmd;\n    if (virNetDevSendEthtoolIoctl(fd, ifr) == 0)\n        return !!FEATURE_BIT_IS_SET(cmd->features, TX_UDP_TNL, active);\n    return false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC_VAR",
          "args": [
            "g_cmd",
            "structethtool_get_features_block",
            "GFEATURES_SIZE"
          ],
          "line": 3245
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nstruct ethtool_value cmd = { 0 };\n\nstatic int\nvirNetDevGetEthtoolGFeatures(virBitmapPtr bitmap,\n                             int fd,\n                             struct ifreq *ifr)\n{\n    struct ethtool_gfeatures *g_cmd;\n\n    if (VIR_ALLOC_VAR(g_cmd,\n                      struct ethtool_get_features_block, GFEATURES_SIZE) < 0)\n        return -1;\n\n    g_cmd->cmd = ETHTOOL_GFEATURES;\n    g_cmd->size = GFEATURES_SIZE;\n    if (virNetDevGFeatureAvailable(fd, ifr, g_cmd))\n        ignore_value(virBitmapSetBit(bitmap, VIR_NET_DEV_FEAT_TXUDPTNL));\n    VIR_FREE(g_cmd);\n    return 0;\n}"
  },
  {
    "function_name": "virNetDevGFeatureAvailable",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
    "lines": "3226-3235",
    "snippet": "static bool\nvirNetDevGFeatureAvailable(int fd,\n                           struct ifreq *ifr,\n                           struct ethtool_gfeatures *cmd)\n{\n    ifr->ifr_data = (void*)cmd;\n    if (virNetDevSendEthtoolIoctl(fd, ifr) == 0)\n        return !!FEATURE_BIT_IS_SET(cmd->features, TX_UDP_TNL, active);\n    return false;\n}",
    "includes": [
      "# include <linux/devlink.h>",
      "# include <net/if_dl.h>",
      "# include <sys/sockio.h>",
      "# include <linux/ethtool.h>",
      "# include <linux/types.h>",
      "# include <linux/if_vlan.h>",
      "# include <linux/sockios.h>",
      "#include <fcntl.h>",
      "# include <sys/ioctl.h>",
      "#include \"virjson.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virpci.h\"",
      "#include \"vircommand.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetlink.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetdev.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct ethtool_value cmd = { 0 };"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "FEATURE_BIT_IS_SET",
          "args": [
            "cmd->features",
            "TX_UDP_TNL",
            "active"
          ],
          "line": 3233
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNetDevSendEthtoolIoctl",
          "args": [
            "fd",
            "ifr"
          ],
          "line": 3232
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevSendEthtoolIoctl",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
          "lines": "2944-2965",
          "snippet": "static int\nvirNetDevSendEthtoolIoctl(int fd, struct ifreq *ifr)\n{\n    int ret = -1;\n\n    ret = ioctl(fd, SIOCETHTOOL, ifr);\n    if (ret != 0) {\n        switch (errno) {\n        case EINVAL: /* kernel doesn't support SIOCETHTOOL */\n            VIR_DEBUG(\"ethtool ioctl: invalid request\");\n            break;\n        case EOPNOTSUPP: /* kernel doesn't support specific feature */\n            VIR_DEBUG(\"ethtool ioctl: request not supported\");\n            break;\n        default:\n            virReportSystemError(errno, \"%s\", _(\"ethtool ioctl error\"));\n            break;\n        }\n    }\n\n    return ret;\n}",
          "includes": [
            "# include <linux/devlink.h>",
            "# include <net/if_dl.h>",
            "# include <sys/sockio.h>",
            "# include <linux/ethtool.h>",
            "# include <linux/types.h>",
            "# include <linux/if_vlan.h>",
            "# include <linux/sockios.h>",
            "#include <fcntl.h>",
            "# include <sys/ioctl.h>",
            "#include \"virjson.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virpci.h\"",
            "#include \"vircommand.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetlink.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetdev.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nstatic int\nvirNetDevSendEthtoolIoctl(int fd, struct ifreq *ifr)\n{\n    int ret = -1;\n\n    ret = ioctl(fd, SIOCETHTOOL, ifr);\n    if (ret != 0) {\n        switch (errno) {\n        case EINVAL: /* kernel doesn't support SIOCETHTOOL */\n            VIR_DEBUG(\"ethtool ioctl: invalid request\");\n            break;\n        case EOPNOTSUPP: /* kernel doesn't support specific feature */\n            VIR_DEBUG(\"ethtool ioctl: request not supported\");\n            break;\n        default:\n            virReportSystemError(errno, \"%s\", _(\"ethtool ioctl error\"));\n            break;\n        }\n    }\n\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nstruct ethtool_value cmd = { 0 };\n\nstatic bool\nvirNetDevGFeatureAvailable(int fd,\n                           struct ifreq *ifr,\n                           struct ethtool_gfeatures *cmd)\n{\n    ifr->ifr_data = (void*)cmd;\n    if (virNetDevSendEthtoolIoctl(fd, ifr) == 0)\n        return !!FEATURE_BIT_IS_SET(cmd->features, TX_UDP_TNL, active);\n    return false;\n}"
  },
  {
    "function_name": "virNetDevSwitchdevFeature",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
    "lines": "3206-3211",
    "snippet": "static int\nvirNetDevSwitchdevFeature(const char *ifname G_GNUC_UNUSED,\n                          virBitmapPtr *out G_GNUC_UNUSED)\n{\n    return 0;\n}",
    "includes": [
      "# include <linux/devlink.h>",
      "# include <net/if_dl.h>",
      "# include <sys/sockio.h>",
      "# include <linux/ethtool.h>",
      "# include <linux/types.h>",
      "# include <linux/if_vlan.h>",
      "# include <linux/sockios.h>",
      "#include <fcntl.h>",
      "# include <sys/ioctl.h>",
      "#include \"virjson.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virpci.h\"",
      "#include \"vircommand.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetlink.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetdev.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nstatic int\nvirNetDevSwitchdevFeature(const char *ifname G_GNUC_UNUSED,\n                          virBitmapPtr *out G_GNUC_UNUSED)\n{\n    return 0;\n}"
  },
  {
    "function_name": "virNetDevSwitchdevFeature",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
    "lines": "3123-3204",
    "snippet": "static int\nvirNetDevSwitchdevFeature(const char *ifname,\n                          virBitmapPtr *out)\n{\n    struct nl_msg *nl_msg = NULL;\n    struct nlmsghdr *resp = NULL;\n    unsigned int recvbuflen;\n    struct nlattr *tb[DEVLINK_ATTR_MAX + 1] = {NULL, };\n    virPCIDevicePtr pci_device_ptr = NULL;\n    struct genlmsghdr gmsgh = {\n        .cmd = DEVLINK_CMD_ESWITCH_GET,\n        .version = DEVLINK_GENL_VERSION,\n        .reserved = 0,\n    };\n    const char *pci_name;\n    char *pfname = NULL;\n    int is_vf = -1;\n    int ret = -1;\n    uint32_t family_id;\n\n    if ((family_id = virNetDevGetFamilyId(DEVLINK_GENL_NAME)) <= 0)\n        return ret;\n\n    if ((is_vf = virNetDevIsVirtualFunction(ifname)) < 0)\n        return ret;\n\n    if (is_vf == 1) {\n        /* Ignore error if PF does not have netdev assigned.\n         * In that case pfname == NULL. */\n        if (virNetDevGetPhysicalFunction(ifname, &pfname) < 0)\n            virResetLastError();\n    }\n\n    pci_device_ptr = pfname ? virNetDevGetPCIDevice(pfname) :\n                              virNetDevGetPCIDevice(ifname);\n    /* No PCI device, then no feature bit to check/add */\n    if (pci_device_ptr == NULL) {\n        ret = 0;\n        goto cleanup;\n    }\n\n    if (!(nl_msg = nlmsg_alloc_simple(family_id,\n                                      NLM_F_REQUEST | NLM_F_ACK))) {\n        virReportOOMError();\n        goto cleanup;\n    }\n\n    if (nlmsg_append(nl_msg, &gmsgh, sizeof(gmsgh), NLMSG_ALIGNTO) < 0)\n        goto cleanup;\n\n    pci_name = virPCIDeviceGetName(pci_device_ptr);\n\n    if (nla_put(nl_msg, DEVLINK_ATTR_BUS_NAME, strlen(\"pci\")+1, \"pci\") < 0 ||\n        nla_put(nl_msg, DEVLINK_ATTR_DEV_NAME, strlen(pci_name)+1, pci_name) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"allocated netlink buffer is too small\"));\n        goto cleanup;\n    }\n\n    if (virNetlinkCommand(nl_msg, &resp, &recvbuflen, 0, 0, NETLINK_GENERIC, 0) < 0)\n        goto cleanup;\n\n    if (nlmsg_parse(resp, sizeof(struct genlmsghdr), tb, DEVLINK_ATTR_MAX, NULL) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"malformed netlink response message\"));\n        goto cleanup;\n    }\n\n    if (tb[DEVLINK_ATTR_ESWITCH_MODE] &&\n        *(int *)RTA_DATA(tb[DEVLINK_ATTR_ESWITCH_MODE]) == DEVLINK_ESWITCH_MODE_SWITCHDEV) {\n        ignore_value(virBitmapSetBit(*out, VIR_NET_DEV_FEAT_SWITCHDEV));\n    }\n\n    ret = 0;\n\n cleanup:\n    nlmsg_free(nl_msg);\n    virPCIDeviceFree(pci_device_ptr);\n    VIR_FREE(resp);\n    VIR_FREE(pfname);\n    return ret;\n}",
    "includes": [
      "# include <linux/devlink.h>",
      "# include <net/if_dl.h>",
      "# include <sys/sockio.h>",
      "# include <linux/ethtool.h>",
      "# include <linux/types.h>",
      "# include <linux/if_vlan.h>",
      "# include <linux/sockios.h>",
      "#include <fcntl.h>",
      "# include <sys/ioctl.h>",
      "#include \"virjson.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virpci.h\"",
      "#include \"vircommand.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetlink.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetdev.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct ethtool_value cmd = { 0 };"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "pfname"
          ],
          "line": 3202
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "resp"
          ],
          "line": 3201
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virPCIDeviceFree",
          "args": [
            "pci_device_ptr"
          ],
          "line": 3200
        },
        "resolved": true,
        "details": {
          "function_name": "virPCIDeviceFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virpci.c",
          "lines": "1439-1450",
          "snippet": "void\nvirPCIDeviceFree(virPCIDevicePtr dev)\n{\n    if (!dev)\n        return;\n    VIR_DEBUG(\"%s %s: freeing\", dev->id, dev->name);\n    VIR_FREE(dev->name);\n    VIR_FREE(dev->path);\n    VIR_FREE(dev->used_by_drvname);\n    VIR_FREE(dev->used_by_domname);\n    VIR_FREE(dev);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <inttypes.h>",
            "#include <fcntl.h>",
            "#include <dirent.h>",
            "#include \"virnetdev.h\"",
            "#include \"virpci.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <inttypes.h>\n#include <fcntl.h>\n#include <dirent.h>\n#include \"virnetdev.h\"\n#include \"virpci.h\"\n#include <config.h>\n\nvoid\nvirPCIDeviceFree(virPCIDevicePtr dev)\n{\n    if (!dev)\n        return;\n    VIR_DEBUG(\"%s %s: freeing\", dev->id, dev->name);\n    VIR_FREE(dev->name);\n    VIR_FREE(dev->path);\n    VIR_FREE(dev->used_by_drvname);\n    VIR_FREE(dev->used_by_domname);\n    VIR_FREE(dev);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nlmsg_free",
          "args": [
            "nl_msg"
          ],
          "line": 3199
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ignore_value",
          "args": [
            "virBitmapSetBit(*out, VIR_NET_DEV_FEAT_SWITCHDEV)"
          ],
          "line": 3193
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBitmapSetBit",
          "args": [
            "*out",
            "VIR_NET_DEV_FEAT_SWITCHDEV"
          ],
          "line": 3193
        },
        "resolved": true,
        "details": {
          "function_name": "virBitmapSetBitExpand",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
          "lines": "222-231",
          "snippet": "int\nvirBitmapSetBitExpand(virBitmapPtr bitmap,\n                      size_t b)\n{\n    if (bitmap->nbits <= b && virBitmapExpand(bitmap, b) < 0)\n        return -1;\n\n    bitmap->map[VIR_BITMAP_UNIT_OFFSET(b)] |= VIR_BITMAP_BIT(b);\n    return 0;\n}",
          "includes": [
            "#include \"virerror.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbitmap.h\"",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\nint\nvirBitmapSetBitExpand(virBitmapPtr bitmap,\n                      size_t b)\n{\n    if (bitmap->nbits <= b && virBitmapExpand(bitmap, b) < 0)\n        return -1;\n\n    bitmap->map[VIR_BITMAP_UNIT_OFFSET(b)] |= VIR_BITMAP_BIT(b);\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "RTA_DATA",
          "args": [
            "tb[DEVLINK_ATTR_ESWITCH_MODE]"
          ],
          "line": 3192
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"malformed netlink response message\")"
          ],
          "line": 3186
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"malformed netlink response message\""
          ],
          "line": 3187
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nlmsg_parse",
          "args": [
            "resp",
            "sizeof(struct genlmsghdr)",
            "tb",
            "DEVLINK_ATTR_MAX",
            "NULL"
          ],
          "line": 3185
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNetlinkCommand",
          "args": [
            "nl_msg",
            "&resp",
            "&recvbuflen",
            "0",
            "0",
            "NETLINK_GENERIC",
            "0"
          ],
          "line": 3182
        },
        "resolved": true,
        "details": {
          "function_name": "virNetlinkCommand",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetlink.c",
          "lines": "1236-1246",
          "snippet": "int virNetlinkCommand(struct nl_msg *nl_msg G_GNUC_UNUSED,\n                      struct nlmsghdr **resp G_GNUC_UNUSED,\n                      unsigned int *respbuflen G_GNUC_UNUSED,\n                      uint32_t src_pid G_GNUC_UNUSED,\n                      uint32_t dst_pid G_GNUC_UNUSED,\n                      unsigned int protocol G_GNUC_UNUSED,\n                      unsigned int groups G_GNUC_UNUSED)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\", _(unsupported));\n    return -1;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virnetlink.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virmacaddr.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virnetdev.h\"\n#include \"virnetlink.h\"\n#include <unistd.h>\n#include <config.h>\n\nint virNetlinkCommand(struct nl_msg *nl_msg G_GNUC_UNUSED,\n                      struct nlmsghdr **resp G_GNUC_UNUSED,\n                      unsigned int *respbuflen G_GNUC_UNUSED,\n                      uint32_t src_pid G_GNUC_UNUSED,\n                      uint32_t dst_pid G_GNUC_UNUSED,\n                      unsigned int protocol G_GNUC_UNUSED,\n                      unsigned int groups G_GNUC_UNUSED)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\", _(unsupported));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"allocated netlink buffer is too small\")"
          ],
          "line": 3177
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nla_put",
          "args": [
            "nl_msg",
            "DEVLINK_ATTR_DEV_NAME",
            "strlen(pci_name)+1",
            "pci_name"
          ],
          "line": 3176
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "pci_name"
          ],
          "line": 3176
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nla_put",
          "args": [
            "nl_msg",
            "DEVLINK_ATTR_BUS_NAME",
            "strlen(\"pci\")+1",
            "\"pci\""
          ],
          "line": 3175
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "\"pci\""
          ],
          "line": 3175
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virPCIDeviceGetName",
          "args": [
            "pci_device_ptr"
          ],
          "line": 3173
        },
        "resolved": true,
        "details": {
          "function_name": "virPCIDeviceGetName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virpci.c",
          "lines": "1467-1471",
          "snippet": "const char *\nvirPCIDeviceGetName(virPCIDevicePtr dev)\n{\n    return dev->name;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <inttypes.h>",
            "#include <fcntl.h>",
            "#include <dirent.h>",
            "#include \"virnetdev.h\"",
            "#include \"virpci.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <inttypes.h>\n#include <fcntl.h>\n#include <dirent.h>\n#include \"virnetdev.h\"\n#include \"virpci.h\"\n#include <config.h>\n\nconst char *\nvirPCIDeviceGetName(virPCIDevicePtr dev)\n{\n    return dev->name;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nlmsg_append",
          "args": [
            "nl_msg",
            "&gmsgh",
            "sizeof(gmsgh)",
            "NLMSG_ALIGNTO"
          ],
          "line": 3170
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportOOMError",
          "args": [],
          "line": 3166
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nlmsg_alloc_simple",
          "args": [
            "family_id",
            "NLM_F_REQUEST | NLM_F_ACK"
          ],
          "line": 3164
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNetDevGetPCIDevice",
          "args": [
            "ifname"
          ],
          "line": 3157
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevGetPCIDevice",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
          "lines": "1119-1144",
          "snippet": "static virPCIDevicePtr\nvirNetDevGetPCIDevice(const char *devName)\n{\n    char *vfSysfsDevicePath = NULL;\n    virPCIDeviceAddressPtr vfPCIAddr = NULL;\n    virPCIDevicePtr vfPCIDevice = NULL;\n\n    if (virNetDevSysfsFile(&vfSysfsDevicePath, devName, \"device\") < 0)\n        goto cleanup;\n\n    if (!virNetDevIsPCIDevice(vfSysfsDevicePath))\n        goto cleanup;\n\n    vfPCIAddr = virPCIGetDeviceAddressFromSysfsLink(vfSysfsDevicePath);\n    if (!vfPCIAddr)\n        goto cleanup;\n\n    vfPCIDevice = virPCIDeviceNew(vfPCIAddr->domain, vfPCIAddr->bus,\n                                  vfPCIAddr->slot, vfPCIAddr->function);\n\n cleanup:\n    VIR_FREE(vfSysfsDevicePath);\n    VIR_FREE(vfPCIAddr);\n\n    return vfPCIDevice;\n}",
          "includes": [
            "# include <linux/devlink.h>",
            "# include <net/if_dl.h>",
            "# include <sys/sockio.h>",
            "# include <linux/ethtool.h>",
            "# include <linux/types.h>",
            "# include <linux/if_vlan.h>",
            "# include <linux/sockios.h>",
            "#include <fcntl.h>",
            "# include <sys/ioctl.h>",
            "#include \"virjson.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virpci.h\"",
            "#include \"vircommand.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetlink.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetdev.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nstatic virPCIDevicePtr\nvirNetDevGetPCIDevice(const char *devName)\n{\n    char *vfSysfsDevicePath = NULL;\n    virPCIDeviceAddressPtr vfPCIAddr = NULL;\n    virPCIDevicePtr vfPCIDevice = NULL;\n\n    if (virNetDevSysfsFile(&vfSysfsDevicePath, devName, \"device\") < 0)\n        goto cleanup;\n\n    if (!virNetDevIsPCIDevice(vfSysfsDevicePath))\n        goto cleanup;\n\n    vfPCIAddr = virPCIGetDeviceAddressFromSysfsLink(vfSysfsDevicePath);\n    if (!vfPCIAddr)\n        goto cleanup;\n\n    vfPCIDevice = virPCIDeviceNew(vfPCIAddr->domain, vfPCIAddr->bus,\n                                  vfPCIAddr->slot, vfPCIAddr->function);\n\n cleanup:\n    VIR_FREE(vfSysfsDevicePath);\n    VIR_FREE(vfPCIAddr);\n\n    return vfPCIDevice;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virResetLastError",
          "args": [],
          "line": 3153
        },
        "resolved": true,
        "details": {
          "function_name": "virResetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "500-506",
          "snippet": "void\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid\nvirResetLastError(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (err)\n        virResetError(err);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetDevGetPhysicalFunction",
          "args": [
            "ifname",
            "&pfname"
          ],
          "line": 3152
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevGetPhysicalFunction",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
          "lines": "1495-1502",
          "snippet": "int\nvirNetDevGetPhysicalFunction(const char *ifname G_GNUC_UNUSED,\n                             char **pfname G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to get physical function status on this platform\"));\n    return -1;\n}",
          "includes": [
            "# include <linux/devlink.h>",
            "# include <net/if_dl.h>",
            "# include <sys/sockio.h>",
            "# include <linux/ethtool.h>",
            "# include <linux/types.h>",
            "# include <linux/if_vlan.h>",
            "# include <linux/sockios.h>",
            "#include <fcntl.h>",
            "# include <sys/ioctl.h>",
            "#include \"virjson.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virpci.h\"",
            "#include \"vircommand.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetlink.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetdev.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint\nvirNetDevGetPhysicalFunction(const char *ifname G_GNUC_UNUSED,\n                             char **pfname G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to get physical function status on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetDevIsVirtualFunction",
          "args": [
            "ifname"
          ],
          "line": 3146
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevIsVirtualFunction",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
          "lines": "1477-1483",
          "snippet": "int\nvirNetDevIsVirtualFunction(const char *ifname G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to check virtual function status on this platform\"));\n    return -1;\n}",
          "includes": [
            "# include <linux/devlink.h>",
            "# include <net/if_dl.h>",
            "# include <sys/sockio.h>",
            "# include <linux/ethtool.h>",
            "# include <linux/types.h>",
            "# include <linux/if_vlan.h>",
            "# include <linux/sockios.h>",
            "#include <fcntl.h>",
            "# include <sys/ioctl.h>",
            "#include \"virjson.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virpci.h\"",
            "#include \"vircommand.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetlink.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetdev.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint\nvirNetDevIsVirtualFunction(const char *ifname G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to check virtual function status on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetDevGetFamilyId",
          "args": [
            "DEVLINK_GENL_NAME"
          ],
          "line": 3143
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevGetFamilyId",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
          "lines": "3063-3110",
          "snippet": "static uint32_t\nvirNetDevGetFamilyId(const char *family_name)\n{\n    struct nl_msg *nl_msg = NULL;\n    struct nlmsghdr *resp = NULL;\n    struct genlmsghdr gmsgh = {\n        .cmd = CTRL_CMD_GETFAMILY,\n        .version = DEVLINK_GENL_VERSION,\n        .reserved = 0,\n    };\n    struct nlattr *tb[CTRL_ATTR_MAX + 1] = {NULL, };\n    unsigned int recvbuflen;\n    uint32_t family_id = 0;\n\n    if (!(nl_msg = nlmsg_alloc_simple(GENL_ID_CTRL,\n                                      NLM_F_REQUEST | NLM_F_ACK))) {\n        virReportOOMError();\n        goto cleanup;\n    }\n\n    if (nlmsg_append(nl_msg, &gmsgh, sizeof(gmsgh), NLMSG_ALIGNTO) < 0)\n        goto cleanup;\n\n    if (nla_put_string(nl_msg, CTRL_ATTR_FAMILY_NAME, family_name) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"allocated netlink buffer is too small\"));\n        goto cleanup;\n    }\n\n    if (virNetlinkCommand(nl_msg, &resp, &recvbuflen, 0, 0, NETLINK_GENERIC, 0) < 0)\n        goto cleanup;\n\n    if (nlmsg_parse(resp, sizeof(struct nlmsghdr), tb, CTRL_ATTR_MAX, NULL) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"malformed netlink response message\"));\n        goto cleanup;\n    }\n\n    if (tb[CTRL_ATTR_FAMILY_ID] == NULL)\n        goto cleanup;\n\n    family_id = *(uint32_t *)RTA_DATA(tb[CTRL_ATTR_FAMILY_ID]);\n\n cleanup:\n    nlmsg_free(nl_msg);\n    VIR_FREE(resp);\n    return family_id;\n}",
          "includes": [
            "# include <linux/devlink.h>",
            "# include <net/if_dl.h>",
            "# include <sys/sockio.h>",
            "# include <linux/ethtool.h>",
            "# include <linux/types.h>",
            "# include <linux/if_vlan.h>",
            "# include <linux/sockios.h>",
            "#include <fcntl.h>",
            "# include <sys/ioctl.h>",
            "#include \"virjson.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virpci.h\"",
            "#include \"vircommand.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetlink.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetdev.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "struct ethtool_value cmd = { 0 };"
          ],
          "called_functions": [],
          "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nstruct ethtool_value cmd = { 0 };\n\nstatic uint32_t\nvirNetDevGetFamilyId(const char *family_name)\n{\n    struct nl_msg *nl_msg = NULL;\n    struct nlmsghdr *resp = NULL;\n    struct genlmsghdr gmsgh = {\n        .cmd = CTRL_CMD_GETFAMILY,\n        .version = DEVLINK_GENL_VERSION,\n        .reserved = 0,\n    };\n    struct nlattr *tb[CTRL_ATTR_MAX + 1] = {NULL, };\n    unsigned int recvbuflen;\n    uint32_t family_id = 0;\n\n    if (!(nl_msg = nlmsg_alloc_simple(GENL_ID_CTRL,\n                                      NLM_F_REQUEST | NLM_F_ACK))) {\n        virReportOOMError();\n        goto cleanup;\n    }\n\n    if (nlmsg_append(nl_msg, &gmsgh, sizeof(gmsgh), NLMSG_ALIGNTO) < 0)\n        goto cleanup;\n\n    if (nla_put_string(nl_msg, CTRL_ATTR_FAMILY_NAME, family_name) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"allocated netlink buffer is too small\"));\n        goto cleanup;\n    }\n\n    if (virNetlinkCommand(nl_msg, &resp, &recvbuflen, 0, 0, NETLINK_GENERIC, 0) < 0)\n        goto cleanup;\n\n    if (nlmsg_parse(resp, sizeof(struct nlmsghdr), tb, CTRL_ATTR_MAX, NULL) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"malformed netlink response message\"));\n        goto cleanup;\n    }\n\n    if (tb[CTRL_ATTR_FAMILY_ID] == NULL)\n        goto cleanup;\n\n    family_id = *(uint32_t *)RTA_DATA(tb[CTRL_ATTR_FAMILY_ID]);\n\n cleanup:\n    nlmsg_free(nl_msg);\n    VIR_FREE(resp);\n    return family_id;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nstruct ethtool_value cmd = { 0 };\n\nstatic int\nvirNetDevSwitchdevFeature(const char *ifname,\n                          virBitmapPtr *out)\n{\n    struct nl_msg *nl_msg = NULL;\n    struct nlmsghdr *resp = NULL;\n    unsigned int recvbuflen;\n    struct nlattr *tb[DEVLINK_ATTR_MAX + 1] = {NULL, };\n    virPCIDevicePtr pci_device_ptr = NULL;\n    struct genlmsghdr gmsgh = {\n        .cmd = DEVLINK_CMD_ESWITCH_GET,\n        .version = DEVLINK_GENL_VERSION,\n        .reserved = 0,\n    };\n    const char *pci_name;\n    char *pfname = NULL;\n    int is_vf = -1;\n    int ret = -1;\n    uint32_t family_id;\n\n    if ((family_id = virNetDevGetFamilyId(DEVLINK_GENL_NAME)) <= 0)\n        return ret;\n\n    if ((is_vf = virNetDevIsVirtualFunction(ifname)) < 0)\n        return ret;\n\n    if (is_vf == 1) {\n        /* Ignore error if PF does not have netdev assigned.\n         * In that case pfname == NULL. */\n        if (virNetDevGetPhysicalFunction(ifname, &pfname) < 0)\n            virResetLastError();\n    }\n\n    pci_device_ptr = pfname ? virNetDevGetPCIDevice(pfname) :\n                              virNetDevGetPCIDevice(ifname);\n    /* No PCI device, then no feature bit to check/add */\n    if (pci_device_ptr == NULL) {\n        ret = 0;\n        goto cleanup;\n    }\n\n    if (!(nl_msg = nlmsg_alloc_simple(family_id,\n                                      NLM_F_REQUEST | NLM_F_ACK))) {\n        virReportOOMError();\n        goto cleanup;\n    }\n\n    if (nlmsg_append(nl_msg, &gmsgh, sizeof(gmsgh), NLMSG_ALIGNTO) < 0)\n        goto cleanup;\n\n    pci_name = virPCIDeviceGetName(pci_device_ptr);\n\n    if (nla_put(nl_msg, DEVLINK_ATTR_BUS_NAME, strlen(\"pci\")+1, \"pci\") < 0 ||\n        nla_put(nl_msg, DEVLINK_ATTR_DEV_NAME, strlen(pci_name)+1, pci_name) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"allocated netlink buffer is too small\"));\n        goto cleanup;\n    }\n\n    if (virNetlinkCommand(nl_msg, &resp, &recvbuflen, 0, 0, NETLINK_GENERIC, 0) < 0)\n        goto cleanup;\n\n    if (nlmsg_parse(resp, sizeof(struct genlmsghdr), tb, DEVLINK_ATTR_MAX, NULL) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"malformed netlink response message\"));\n        goto cleanup;\n    }\n\n    if (tb[DEVLINK_ATTR_ESWITCH_MODE] &&\n        *(int *)RTA_DATA(tb[DEVLINK_ATTR_ESWITCH_MODE]) == DEVLINK_ESWITCH_MODE_SWITCHDEV) {\n        ignore_value(virBitmapSetBit(*out, VIR_NET_DEV_FEAT_SWITCHDEV));\n    }\n\n    ret = 0;\n\n cleanup:\n    nlmsg_free(nl_msg);\n    virPCIDeviceFree(pci_device_ptr);\n    VIR_FREE(resp);\n    VIR_FREE(pfname);\n    return ret;\n}"
  },
  {
    "function_name": "virNetDevGetFamilyId",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
    "lines": "3063-3110",
    "snippet": "static uint32_t\nvirNetDevGetFamilyId(const char *family_name)\n{\n    struct nl_msg *nl_msg = NULL;\n    struct nlmsghdr *resp = NULL;\n    struct genlmsghdr gmsgh = {\n        .cmd = CTRL_CMD_GETFAMILY,\n        .version = DEVLINK_GENL_VERSION,\n        .reserved = 0,\n    };\n    struct nlattr *tb[CTRL_ATTR_MAX + 1] = {NULL, };\n    unsigned int recvbuflen;\n    uint32_t family_id = 0;\n\n    if (!(nl_msg = nlmsg_alloc_simple(GENL_ID_CTRL,\n                                      NLM_F_REQUEST | NLM_F_ACK))) {\n        virReportOOMError();\n        goto cleanup;\n    }\n\n    if (nlmsg_append(nl_msg, &gmsgh, sizeof(gmsgh), NLMSG_ALIGNTO) < 0)\n        goto cleanup;\n\n    if (nla_put_string(nl_msg, CTRL_ATTR_FAMILY_NAME, family_name) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"allocated netlink buffer is too small\"));\n        goto cleanup;\n    }\n\n    if (virNetlinkCommand(nl_msg, &resp, &recvbuflen, 0, 0, NETLINK_GENERIC, 0) < 0)\n        goto cleanup;\n\n    if (nlmsg_parse(resp, sizeof(struct nlmsghdr), tb, CTRL_ATTR_MAX, NULL) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"malformed netlink response message\"));\n        goto cleanup;\n    }\n\n    if (tb[CTRL_ATTR_FAMILY_ID] == NULL)\n        goto cleanup;\n\n    family_id = *(uint32_t *)RTA_DATA(tb[CTRL_ATTR_FAMILY_ID]);\n\n cleanup:\n    nlmsg_free(nl_msg);\n    VIR_FREE(resp);\n    return family_id;\n}",
    "includes": [
      "# include <linux/devlink.h>",
      "# include <net/if_dl.h>",
      "# include <sys/sockio.h>",
      "# include <linux/ethtool.h>",
      "# include <linux/types.h>",
      "# include <linux/if_vlan.h>",
      "# include <linux/sockios.h>",
      "#include <fcntl.h>",
      "# include <sys/ioctl.h>",
      "#include \"virjson.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virpci.h\"",
      "#include \"vircommand.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetlink.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetdev.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct ethtool_value cmd = { 0 };"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "resp"
          ],
          "line": 3108
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nlmsg_free",
          "args": [
            "nl_msg"
          ],
          "line": 3107
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "RTA_DATA",
          "args": [
            "tb[CTRL_ATTR_FAMILY_ID]"
          ],
          "line": 3104
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"malformed netlink response message\")"
          ],
          "line": 3096
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"malformed netlink response message\""
          ],
          "line": 3097
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nlmsg_parse",
          "args": [
            "resp",
            "sizeof(struct nlmsghdr)",
            "tb",
            "CTRL_ATTR_MAX",
            "NULL"
          ],
          "line": 3095
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNetlinkCommand",
          "args": [
            "nl_msg",
            "&resp",
            "&recvbuflen",
            "0",
            "0",
            "NETLINK_GENERIC",
            "0"
          ],
          "line": 3092
        },
        "resolved": true,
        "details": {
          "function_name": "virNetlinkCommand",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetlink.c",
          "lines": "1236-1246",
          "snippet": "int virNetlinkCommand(struct nl_msg *nl_msg G_GNUC_UNUSED,\n                      struct nlmsghdr **resp G_GNUC_UNUSED,\n                      unsigned int *respbuflen G_GNUC_UNUSED,\n                      uint32_t src_pid G_GNUC_UNUSED,\n                      uint32_t dst_pid G_GNUC_UNUSED,\n                      unsigned int protocol G_GNUC_UNUSED,\n                      unsigned int groups G_GNUC_UNUSED)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\", _(unsupported));\n    return -1;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virnetlink.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virmacaddr.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virnetdev.h\"\n#include \"virnetlink.h\"\n#include <unistd.h>\n#include <config.h>\n\nint virNetlinkCommand(struct nl_msg *nl_msg G_GNUC_UNUSED,\n                      struct nlmsghdr **resp G_GNUC_UNUSED,\n                      unsigned int *respbuflen G_GNUC_UNUSED,\n                      uint32_t src_pid G_GNUC_UNUSED,\n                      uint32_t dst_pid G_GNUC_UNUSED,\n                      unsigned int protocol G_GNUC_UNUSED,\n                      unsigned int groups G_GNUC_UNUSED)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\", _(unsupported));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"allocated netlink buffer is too small\")"
          ],
          "line": 3087
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nla_put_string",
          "args": [
            "nl_msg",
            "CTRL_ATTR_FAMILY_NAME",
            "family_name"
          ],
          "line": 3086
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nlmsg_append",
          "args": [
            "nl_msg",
            "&gmsgh",
            "sizeof(gmsgh)",
            "NLMSG_ALIGNTO"
          ],
          "line": 3083
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportOOMError",
          "args": [],
          "line": 3079
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nlmsg_alloc_simple",
          "args": [
            "GENL_ID_CTRL",
            "NLM_F_REQUEST | NLM_F_ACK"
          ],
          "line": 3077
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nstruct ethtool_value cmd = { 0 };\n\nstatic uint32_t\nvirNetDevGetFamilyId(const char *family_name)\n{\n    struct nl_msg *nl_msg = NULL;\n    struct nlmsghdr *resp = NULL;\n    struct genlmsghdr gmsgh = {\n        .cmd = CTRL_CMD_GETFAMILY,\n        .version = DEVLINK_GENL_VERSION,\n        .reserved = 0,\n    };\n    struct nlattr *tb[CTRL_ATTR_MAX + 1] = {NULL, };\n    unsigned int recvbuflen;\n    uint32_t family_id = 0;\n\n    if (!(nl_msg = nlmsg_alloc_simple(GENL_ID_CTRL,\n                                      NLM_F_REQUEST | NLM_F_ACK))) {\n        virReportOOMError();\n        goto cleanup;\n    }\n\n    if (nlmsg_append(nl_msg, &gmsgh, sizeof(gmsgh), NLMSG_ALIGNTO) < 0)\n        goto cleanup;\n\n    if (nla_put_string(nl_msg, CTRL_ATTR_FAMILY_NAME, family_name) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"allocated netlink buffer is too small\"));\n        goto cleanup;\n    }\n\n    if (virNetlinkCommand(nl_msg, &resp, &recvbuflen, 0, 0, NETLINK_GENERIC, 0) < 0)\n        goto cleanup;\n\n    if (nlmsg_parse(resp, sizeof(struct nlmsghdr), tb, CTRL_ATTR_MAX, NULL) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"malformed netlink response message\"));\n        goto cleanup;\n    }\n\n    if (tb[CTRL_ATTR_FAMILY_ID] == NULL)\n        goto cleanup;\n\n    family_id = *(uint32_t *)RTA_DATA(tb[CTRL_ATTR_FAMILY_ID]);\n\n cleanup:\n    nlmsg_free(nl_msg);\n    VIR_FREE(resp);\n    return family_id;\n}"
  },
  {
    "function_name": "virNetDevFeatureAvailable",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
    "lines": "2983-2991",
    "snippet": "static bool\nvirNetDevFeatureAvailable(int fd, struct ifreq *ifr, struct ethtool_value *cmd)\n{\n    ifr->ifr_data = (void*)cmd;\n    if (virNetDevSendEthtoolIoctl(fd, ifr) == 0 &&\n        cmd->data > 0)\n        return true;\n    return false;\n}",
    "includes": [
      "# include <linux/devlink.h>",
      "# include <net/if_dl.h>",
      "# include <sys/sockio.h>",
      "# include <linux/ethtool.h>",
      "# include <linux/types.h>",
      "# include <linux/if_vlan.h>",
      "# include <linux/sockios.h>",
      "#include <fcntl.h>",
      "# include <sys/ioctl.h>",
      "#include \"virjson.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virpci.h\"",
      "#include \"vircommand.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetlink.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetdev.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct ethtool_value cmd = { 0 };"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNetDevSendEthtoolIoctl",
          "args": [
            "fd",
            "ifr"
          ],
          "line": 2987
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevSendEthtoolIoctl",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
          "lines": "2944-2965",
          "snippet": "static int\nvirNetDevSendEthtoolIoctl(int fd, struct ifreq *ifr)\n{\n    int ret = -1;\n\n    ret = ioctl(fd, SIOCETHTOOL, ifr);\n    if (ret != 0) {\n        switch (errno) {\n        case EINVAL: /* kernel doesn't support SIOCETHTOOL */\n            VIR_DEBUG(\"ethtool ioctl: invalid request\");\n            break;\n        case EOPNOTSUPP: /* kernel doesn't support specific feature */\n            VIR_DEBUG(\"ethtool ioctl: request not supported\");\n            break;\n        default:\n            virReportSystemError(errno, \"%s\", _(\"ethtool ioctl error\"));\n            break;\n        }\n    }\n\n    return ret;\n}",
          "includes": [
            "# include <linux/devlink.h>",
            "# include <net/if_dl.h>",
            "# include <sys/sockio.h>",
            "# include <linux/ethtool.h>",
            "# include <linux/types.h>",
            "# include <linux/if_vlan.h>",
            "# include <linux/sockios.h>",
            "#include <fcntl.h>",
            "# include <sys/ioctl.h>",
            "#include \"virjson.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virpci.h\"",
            "#include \"vircommand.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetlink.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetdev.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nstatic int\nvirNetDevSendEthtoolIoctl(int fd, struct ifreq *ifr)\n{\n    int ret = -1;\n\n    ret = ioctl(fd, SIOCETHTOOL, ifr);\n    if (ret != 0) {\n        switch (errno) {\n        case EINVAL: /* kernel doesn't support SIOCETHTOOL */\n            VIR_DEBUG(\"ethtool ioctl: invalid request\");\n            break;\n        case EOPNOTSUPP: /* kernel doesn't support specific feature */\n            VIR_DEBUG(\"ethtool ioctl: request not supported\");\n            break;\n        default:\n            virReportSystemError(errno, \"%s\", _(\"ethtool ioctl error\"));\n            break;\n        }\n    }\n\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nstruct ethtool_value cmd = { 0 };\n\nstatic bool\nvirNetDevFeatureAvailable(int fd, struct ifreq *ifr, struct ethtool_value *cmd)\n{\n    ifr->ifr_data = (void*)cmd;\n    if (virNetDevSendEthtoolIoctl(fd, ifr) == 0 &&\n        cmd->data > 0)\n        return true;\n    return false;\n}"
  },
  {
    "function_name": "virNetDevSendEthtoolIoctl",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
    "lines": "2944-2965",
    "snippet": "static int\nvirNetDevSendEthtoolIoctl(int fd, struct ifreq *ifr)\n{\n    int ret = -1;\n\n    ret = ioctl(fd, SIOCETHTOOL, ifr);\n    if (ret != 0) {\n        switch (errno) {\n        case EINVAL: /* kernel doesn't support SIOCETHTOOL */\n            VIR_DEBUG(\"ethtool ioctl: invalid request\");\n            break;\n        case EOPNOTSUPP: /* kernel doesn't support specific feature */\n            VIR_DEBUG(\"ethtool ioctl: request not supported\");\n            break;\n        default:\n            virReportSystemError(errno, \"%s\", _(\"ethtool ioctl error\"));\n            break;\n        }\n    }\n\n    return ret;\n}",
    "includes": [
      "# include <linux/devlink.h>",
      "# include <net/if_dl.h>",
      "# include <sys/sockio.h>",
      "# include <linux/ethtool.h>",
      "# include <linux/types.h>",
      "# include <linux/if_vlan.h>",
      "# include <linux/sockios.h>",
      "#include <fcntl.h>",
      "# include <sys/ioctl.h>",
      "#include \"virjson.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virpci.h\"",
      "#include \"vircommand.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetlink.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetdev.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "\"%s\"",
            "_(\"ethtool ioctl error\")"
          ],
          "line": 2959
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"ethtool ioctl error\""
          ],
          "line": 2959
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"ethtool ioctl: request not supported\""
          ],
          "line": 2956
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"ethtool ioctl: invalid request\""
          ],
          "line": 2953
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ioctl",
          "args": [
            "fd",
            "SIOCETHTOOL",
            "ifr"
          ],
          "line": 2949
        },
        "resolved": true,
        "details": {
          "function_name": "vir_ioctlsocket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsocket.c",
          "lines": "292-308",
          "snippet": "int\nvir_ioctlsocket(int fd, int cmd, void *arg)\n{\n    SOCKET sk = FD2SK(fd);\n\n    if (sk == INVALID_SOCKET) {\n        errno = EBADF;\n        return -1;\n    }\n\n    if (ioctlsocket(sk, cmd, arg) < 0) {\n        set_errno();\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include <fcntl.h>",
            "#include \"virfile.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <fcntl.h>\n#include \"virfile.h\"\n#include \"virutil.h\"\n#include \"virsocket.h\"\n#include <config.h>\n\nint\nvir_ioctlsocket(int fd, int cmd, void *arg)\n{\n    SOCKET sk = FD2SK(fd);\n\n    if (sk == INVALID_SOCKET) {\n        errno = EBADF;\n        return -1;\n    }\n\n    if (ioctlsocket(sk, cmd, arg) < 0) {\n        set_errno();\n        return -1;\n    }\n\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nstatic int\nvirNetDevSendEthtoolIoctl(int fd, struct ifreq *ifr)\n{\n    int ret = -1;\n\n    ret = ioctl(fd, SIOCETHTOOL, ifr);\n    if (ret != 0) {\n        switch (errno) {\n        case EINVAL: /* kernel doesn't support SIOCETHTOOL */\n            VIR_DEBUG(\"ethtool ioctl: invalid request\");\n            break;\n        case EOPNOTSUPP: /* kernel doesn't support specific feature */\n            VIR_DEBUG(\"ethtool ioctl: request not supported\");\n            break;\n        default:\n            virReportSystemError(errno, \"%s\", _(\"ethtool ioctl error\"));\n            break;\n        }\n    }\n\n    return ret;\n}"
  },
  {
    "function_name": "virNetDevRDMAFeature",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
    "lines": "2882-2932",
    "snippet": "static int\nvirNetDevRDMAFeature(const char *ifname,\n                     virBitmapPtr *out)\n{\n    char *eth_devpath = NULL;\n    char *ib_devpath = NULL;\n    char *eth_res_buf = NULL;\n    char *ib_res_buf = NULL;\n    DIR *dirp = NULL;\n    struct dirent *dp;\n    int ret = -1;\n\n    if (!virFileExists(SYSFS_INFINIBAND_DIR))\n        return 0;\n\n    if (virDirOpen(&dirp, SYSFS_INFINIBAND_DIR) < 0)\n        return -1;\n\n    eth_devpath = g_strdup_printf(SYSFS_NET_DIR \"%s/device/resource\", ifname);\n\n    /* If /sys/class/net/<ifname>/device/resource doesn't exist it is not a PCI\n     * device and therefore it will not have RDMA. */\n    if (!virFileExists(eth_devpath)) {\n        ret = 0;\n        goto cleanup;\n    }\n\n    if (virFileReadAll(eth_devpath, RESOURCE_FILE_LEN, &eth_res_buf) < 0)\n        goto cleanup;\n\n    while (virDirRead(dirp, &dp, SYSFS_INFINIBAND_DIR) > 0) {\n        ib_devpath = g_strdup_printf(SYSFS_INFINIBAND_DIR \"%s/device/resource\",\n                                     dp->d_name);\n        if (virFileReadAll(ib_devpath, RESOURCE_FILE_LEN, &ib_res_buf) > 0 &&\n            STREQ(eth_res_buf, ib_res_buf)) {\n            ignore_value(virBitmapSetBit(*out, VIR_NET_DEV_FEAT_RDMA));\n            break;\n        }\n        VIR_FREE(ib_devpath);\n        VIR_FREE(ib_res_buf);\n    }\n    ret = 0;\n\n cleanup:\n    VIR_DIR_CLOSE(dirp);\n    VIR_FREE(eth_devpath);\n    VIR_FREE(ib_devpath);\n    VIR_FREE(eth_res_buf);\n    VIR_FREE(ib_res_buf);\n    return ret;\n}",
    "includes": [
      "# include <linux/devlink.h>",
      "# include <net/if_dl.h>",
      "# include <sys/sockio.h>",
      "# include <linux/ethtool.h>",
      "# include <linux/types.h>",
      "# include <linux/if_vlan.h>",
      "# include <linux/sockios.h>",
      "#include <fcntl.h>",
      "# include <sys/ioctl.h>",
      "#include \"virjson.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virpci.h\"",
      "#include \"vircommand.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetlink.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetdev.h\"",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define RESOURCE_FILE_LEN 4096"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "ib_res_buf"
          ],
          "line": 2930
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "eth_res_buf"
          ],
          "line": 2929
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "ib_devpath"
          ],
          "line": 2928
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "eth_devpath"
          ],
          "line": 2927
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DIR_CLOSE",
          "args": [
            "dirp"
          ],
          "line": 2926
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "ib_res_buf"
          ],
          "line": 2921
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "ib_devpath"
          ],
          "line": 2920
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ignore_value",
          "args": [
            "virBitmapSetBit(*out, VIR_NET_DEV_FEAT_RDMA)"
          ],
          "line": 2917
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBitmapSetBit",
          "args": [
            "*out",
            "VIR_NET_DEV_FEAT_RDMA"
          ],
          "line": 2917
        },
        "resolved": true,
        "details": {
          "function_name": "virBitmapSetBitExpand",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
          "lines": "222-231",
          "snippet": "int\nvirBitmapSetBitExpand(virBitmapPtr bitmap,\n                      size_t b)\n{\n    if (bitmap->nbits <= b && virBitmapExpand(bitmap, b) < 0)\n        return -1;\n\n    bitmap->map[VIR_BITMAP_UNIT_OFFSET(b)] |= VIR_BITMAP_BIT(b);\n    return 0;\n}",
          "includes": [
            "#include \"virerror.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbitmap.h\"",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\nint\nvirBitmapSetBitExpand(virBitmapPtr bitmap,\n                      size_t b)\n{\n    if (bitmap->nbits <= b && virBitmapExpand(bitmap, b) < 0)\n        return -1;\n\n    bitmap->map[VIR_BITMAP_UNIT_OFFSET(b)] |= VIR_BITMAP_BIT(b);\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "eth_res_buf",
            "ib_res_buf"
          ],
          "line": 2916
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virFileReadAll",
          "args": [
            "ib_devpath",
            "RESOURCE_FILE_LEN",
            "&ib_res_buf"
          ],
          "line": 2915
        },
        "resolved": true,
        "details": {
          "function_name": "virFileReadAllQuiet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1459-1472",
          "snippet": "int\nvirFileReadAllQuiet(const char *path, int maxlen, char **buf)\n{\n    int fd = open(path, O_RDONLY);\n    if (fd < 0)\n        return -errno;\n\n    int len = virFileReadLimFD(fd, maxlen, buf);\n    VIR_FORCE_CLOSE(fd);\n    if (len < 0)\n        return -errno;\n\n    return len;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileReadAllQuiet(const char *path, int maxlen, char **buf)\n{\n    int fd = open(path, O_RDONLY);\n    if (fd < 0)\n        return -errno;\n\n    int len = virFileReadLimFD(fd, maxlen, buf);\n    VIR_FORCE_CLOSE(fd);\n    if (len < 0)\n        return -errno;\n\n    return len;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "SYSFS_INFINIBAND_DIR \"%s/device/resource\"",
            "dp->d_name"
          ],
          "line": 2913
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDirRead",
          "args": [
            "dirp",
            "&dp",
            "SYSFS_INFINIBAND_DIR"
          ],
          "line": 2912
        },
        "resolved": true,
        "details": {
          "function_name": "virDirRead",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "2940-2954",
          "snippet": "int virDirRead(DIR *dirp, struct dirent **ent, const char *name)\n{\n    do {\n        errno = 0;\n        *ent = readdir(dirp); /* exempt from syntax-check */\n        if (!*ent && errno) {\n            if (name)\n                virReportSystemError(errno, _(\"Unable to read directory '%s'\"),\n                                     name);\n            return -1;\n        }\n    } while (*ent && (STREQ((*ent)->d_name, \".\") ||\n                      STREQ((*ent)->d_name, \"..\")));\n    return !!*ent;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint virDirRead(DIR *dirp, struct dirent **ent, const char *name)\n{\n    do {\n        errno = 0;\n        *ent = readdir(dirp); /* exempt from syntax-check */\n        if (!*ent && errno) {\n            if (name)\n                virReportSystemError(errno, _(\"Unable to read directory '%s'\"),\n                                     name);\n            return -1;\n        }\n    } while (*ent && (STREQ((*ent)->d_name, \".\") ||\n                      STREQ((*ent)->d_name, \"..\")));\n    return !!*ent;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virFileExists",
          "args": [
            "eth_devpath"
          ],
          "line": 2904
        },
        "resolved": true,
        "details": {
          "function_name": "virFileExists",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1873-1877",
          "snippet": "bool\nvirFileExists(const char *path)\n{\n    return access(path, F_OK) == 0;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nbool\nvirFileExists(const char *path)\n{\n    return access(path, F_OK) == 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDirOpen",
          "args": [
            "&dirp",
            "SYSFS_INFINIBAND_DIR"
          ],
          "line": 2897
        },
        "resolved": true,
        "details": {
          "function_name": "virDirOpenQuiet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "2914-2918",
          "snippet": "int\nvirDirOpenQuiet(DIR **dirp, const char *name)\n{\n    return virDirOpenInternal(dirp, name, false, true);\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirDirOpenQuiet(DIR **dirp, const char *name)\n{\n    return virDirOpenInternal(dirp, name, false, true);\n}"
        }
      }
    ],
    "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\n#define RESOURCE_FILE_LEN 4096\n\nstatic int\nvirNetDevRDMAFeature(const char *ifname,\n                     virBitmapPtr *out)\n{\n    char *eth_devpath = NULL;\n    char *ib_devpath = NULL;\n    char *eth_res_buf = NULL;\n    char *ib_res_buf = NULL;\n    DIR *dirp = NULL;\n    struct dirent *dp;\n    int ret = -1;\n\n    if (!virFileExists(SYSFS_INFINIBAND_DIR))\n        return 0;\n\n    if (virDirOpen(&dirp, SYSFS_INFINIBAND_DIR) < 0)\n        return -1;\n\n    eth_devpath = g_strdup_printf(SYSFS_NET_DIR \"%s/device/resource\", ifname);\n\n    /* If /sys/class/net/<ifname>/device/resource doesn't exist it is not a PCI\n     * device and therefore it will not have RDMA. */\n    if (!virFileExists(eth_devpath)) {\n        ret = 0;\n        goto cleanup;\n    }\n\n    if (virFileReadAll(eth_devpath, RESOURCE_FILE_LEN, &eth_res_buf) < 0)\n        goto cleanup;\n\n    while (virDirRead(dirp, &dp, SYSFS_INFINIBAND_DIR) > 0) {\n        ib_devpath = g_strdup_printf(SYSFS_INFINIBAND_DIR \"%s/device/resource\",\n                                     dp->d_name);\n        if (virFileReadAll(ib_devpath, RESOURCE_FILE_LEN, &ib_res_buf) > 0 &&\n            STREQ(eth_res_buf, ib_res_buf)) {\n            ignore_value(virBitmapSetBit(*out, VIR_NET_DEV_FEAT_RDMA));\n            break;\n        }\n        VIR_FREE(ib_devpath);\n        VIR_FREE(ib_res_buf);\n    }\n    ret = 0;\n\n cleanup:\n    VIR_DIR_CLOSE(dirp);\n    VIR_FREE(eth_devpath);\n    VIR_FREE(ib_devpath);\n    VIR_FREE(eth_res_buf);\n    VIR_FREE(ib_res_buf);\n    return ret;\n}"
  },
  {
    "function_name": "virNetDevGetRxFilter",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
    "lines": "2825-2868",
    "snippet": "int virNetDevGetRxFilter(const char *ifname,\n                         virNetDevRxFilterPtr *filter)\n{\n    int ret = -1;\n    bool receive = false;\n    virNetDevRxFilterPtr fil = virNetDevRxFilterNew();\n\n    if (!fil)\n        goto cleanup;\n\n    if (virNetDevGetMAC(ifname, &fil->mac))\n        goto cleanup;\n\n    if (virNetDevGetMulticastTable(ifname, fil))\n        goto cleanup;\n\n    if (virNetDevGetPromiscuous(ifname, &fil->promiscuous))\n        goto cleanup;\n\n    if (virNetDevGetRcvAllMulti(ifname, &receive))\n        goto cleanup;\n\n    if (receive) {\n        fil->multicast.mode = VIR_NETDEV_RX_FILTER_MODE_ALL;\n    } else {\n        if (virNetDevGetRcvMulti(ifname, &receive))\n            goto cleanup;\n\n        if (receive)\n            fil->multicast.mode = VIR_NETDEV_RX_FILTER_MODE_NORMAL;\n        else\n            fil->multicast.mode = VIR_NETDEV_RX_FILTER_MODE_NONE;\n    }\n\n    ret = 0;\n cleanup:\n    if (ret < 0) {\n        virNetDevRxFilterFree(fil);\n        fil = NULL;\n    }\n\n    *filter = fil;\n    return ret;\n}",
    "includes": [
      "# include <linux/devlink.h>",
      "# include <net/if_dl.h>",
      "# include <sys/sockio.h>",
      "# include <linux/ethtool.h>",
      "# include <linux/types.h>",
      "# include <linux/if_vlan.h>",
      "# include <linux/sockios.h>",
      "#include <fcntl.h>",
      "# include <sys/ioctl.h>",
      "#include \"virjson.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virpci.h\"",
      "#include \"vircommand.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetlink.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetdev.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNetDevRxFilterFree",
          "args": [
            "fil"
          ],
          "line": 2862
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevRxFilterFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
          "lines": "2803-2813",
          "snippet": "void\nvirNetDevRxFilterFree(virNetDevRxFilterPtr filter)\n{\n    if (filter) {\n        VIR_FREE(filter->name);\n        VIR_FREE(filter->unicast.table);\n        VIR_FREE(filter->multicast.table);\n        VIR_FREE(filter->vlan.table);\n        VIR_FREE(filter);\n    }\n}",
          "includes": [
            "# include <linux/devlink.h>",
            "# include <net/if_dl.h>",
            "# include <sys/sockio.h>",
            "# include <linux/ethtool.h>",
            "# include <linux/types.h>",
            "# include <linux/if_vlan.h>",
            "# include <linux/sockios.h>",
            "#include <fcntl.h>",
            "# include <sys/ioctl.h>",
            "#include \"virjson.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virpci.h\"",
            "#include \"vircommand.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetlink.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetdev.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nvoid\nvirNetDevRxFilterFree(virNetDevRxFilterPtr filter)\n{\n    if (filter) {\n        VIR_FREE(filter->name);\n        VIR_FREE(filter->unicast.table);\n        VIR_FREE(filter->multicast.table);\n        VIR_FREE(filter->vlan.table);\n        VIR_FREE(filter);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetDevGetRcvMulti",
          "args": [
            "ifname",
            "&receive"
          ],
          "line": 2850
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevGetRcvMulti",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
          "lines": "799-804",
          "snippet": "int\nvirNetDevGetRcvMulti(const char *ifname,\n                     bool *receive)\n{\n    return virNetDevGetIFFlag(ifname, VIR_IFF_MULTICAST, receive);\n}",
          "includes": [
            "# include <linux/devlink.h>",
            "# include <net/if_dl.h>",
            "# include <sys/sockio.h>",
            "# include <linux/ethtool.h>",
            "# include <linux/types.h>",
            "# include <linux/if_vlan.h>",
            "# include <linux/sockios.h>",
            "#include <fcntl.h>",
            "# include <sys/ioctl.h>",
            "#include \"virjson.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virpci.h\"",
            "#include \"vircommand.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetlink.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetdev.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint\nvirNetDevGetRcvMulti(const char *ifname,\n                     bool *receive)\n{\n    return virNetDevGetIFFlag(ifname, VIR_IFF_MULTICAST, receive);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetDevGetRcvAllMulti",
          "args": [
            "ifname",
            "&receive"
          ],
          "line": 2844
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevGetRcvAllMulti",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
          "lines": "816-821",
          "snippet": "int\nvirNetDevGetRcvAllMulti(const char *ifname,\n                        bool *receive)\n{\n    return virNetDevGetIFFlag(ifname, VIR_IFF_ALLMULTI, receive);\n}",
          "includes": [
            "# include <linux/devlink.h>",
            "# include <net/if_dl.h>",
            "# include <sys/sockio.h>",
            "# include <linux/ethtool.h>",
            "# include <linux/types.h>",
            "# include <linux/if_vlan.h>",
            "# include <linux/sockios.h>",
            "#include <fcntl.h>",
            "# include <sys/ioctl.h>",
            "#include \"virjson.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virpci.h\"",
            "#include \"vircommand.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetlink.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetdev.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint\nvirNetDevGetRcvAllMulti(const char *ifname,\n                        bool *receive)\n{\n    return virNetDevGetIFFlag(ifname, VIR_IFF_ALLMULTI, receive);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetDevGetPromiscuous",
          "args": [
            "ifname",
            "&fil->promiscuous"
          ],
          "line": 2841
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevGetPromiscuous",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
          "lines": "782-787",
          "snippet": "int\nvirNetDevGetPromiscuous(const char *ifname,\n                        bool *promiscuous)\n{\n    return virNetDevGetIFFlag(ifname, VIR_IFF_PROMISC, promiscuous);\n}",
          "includes": [
            "# include <linux/devlink.h>",
            "# include <net/if_dl.h>",
            "# include <sys/sockio.h>",
            "# include <linux/ethtool.h>",
            "# include <linux/types.h>",
            "# include <linux/if_vlan.h>",
            "# include <linux/sockios.h>",
            "#include <fcntl.h>",
            "# include <sys/ioctl.h>",
            "#include \"virjson.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virpci.h\"",
            "#include \"vircommand.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetlink.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetdev.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint\nvirNetDevGetPromiscuous(const char *ifname,\n                        bool *promiscuous)\n{\n    return virNetDevGetIFFlag(ifname, VIR_IFF_PROMISC, promiscuous);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetDevGetMulticastTable",
          "args": [
            "ifname",
            "fil"
          ],
          "line": 2838
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevGetMulticastTable",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
          "lines": "2760-2789",
          "snippet": "static int virNetDevGetMulticastTable(const char *ifname,\n                                      virNetDevRxFilterPtr filter)\n{\n    size_t i;\n    int ret = -1;\n    virNetDevMcastList mcast;\n    filter->multicast.nTable = 0;\n    filter->multicast.table = NULL;\n\n    if (virNetDevGetMcastList(ifname, &mcast) < 0)\n        goto cleanup;\n\n    if (mcast.nentries > 0) {\n        if (VIR_ALLOC_N(filter->multicast.table, mcast.nentries) < 0)\n            goto cleanup;\n\n        for (i = 0; i < mcast.nentries; i++) {\n            virMacAddrSet(&filter->multicast.table[i],\n                          &mcast.entries[i]->macaddr);\n        }\n\n        filter->multicast.nTable = mcast.nentries;\n    }\n\n    ret = 0;\n\n cleanup:\n    virNetDevMcastListClear(&mcast);\n    return ret;\n}",
          "includes": [
            "# include <linux/devlink.h>",
            "# include <net/if_dl.h>",
            "# include <sys/sockio.h>",
            "# include <linux/ethtool.h>",
            "# include <linux/types.h>",
            "# include <linux/if_vlan.h>",
            "# include <linux/sockios.h>",
            "#include <fcntl.h>",
            "# include <sys/ioctl.h>",
            "#include \"virjson.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virpci.h\"",
            "#include \"vircommand.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetlink.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetdev.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "size_t i;"
          ],
          "called_functions": [],
          "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nsize_t i;\n\nstatic int virNetDevGetMulticastTable(const char *ifname,\n                                      virNetDevRxFilterPtr filter)\n{\n    size_t i;\n    int ret = -1;\n    virNetDevMcastList mcast;\n    filter->multicast.nTable = 0;\n    filter->multicast.table = NULL;\n\n    if (virNetDevGetMcastList(ifname, &mcast) < 0)\n        goto cleanup;\n\n    if (mcast.nentries > 0) {\n        if (VIR_ALLOC_N(filter->multicast.table, mcast.nentries) < 0)\n            goto cleanup;\n\n        for (i = 0; i < mcast.nentries; i++) {\n            virMacAddrSet(&filter->multicast.table[i],\n                          &mcast.entries[i]->macaddr);\n        }\n\n        filter->multicast.nTable = mcast.nentries;\n    }\n\n    ret = 0;\n\n cleanup:\n    virNetDevMcastListClear(&mcast);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetDevGetMAC",
          "args": [
            "ifname",
            "&fil->mac"
          ],
          "line": 2835
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevGetMAC",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
          "lines": "385-392",
          "snippet": "int virNetDevGetMAC(const char *ifname,\n                    virMacAddrPtr macaddr G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS,\n                         _(\"Cannot get interface MAC on '%s'\"),\n                         ifname);\n    return -1;\n}",
          "includes": [
            "# include <linux/devlink.h>",
            "# include <net/if_dl.h>",
            "# include <sys/sockio.h>",
            "# include <linux/ethtool.h>",
            "# include <linux/types.h>",
            "# include <linux/if_vlan.h>",
            "# include <linux/sockios.h>",
            "#include <fcntl.h>",
            "# include <sys/ioctl.h>",
            "#include \"virjson.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virpci.h\"",
            "#include \"vircommand.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetlink.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetdev.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint virNetDevGetMAC(const char *ifname,\n                    virMacAddrPtr macaddr G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS,\n                         _(\"Cannot get interface MAC on '%s'\"),\n                         ifname);\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetDevRxFilterNew",
          "args": [],
          "line": 2830
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevRxFilterNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
          "lines": "2792-2800",
          "snippet": "virNetDevRxFilterPtr\nvirNetDevRxFilterNew(void)\n{\n    virNetDevRxFilterPtr filter;\n\n    if (VIR_ALLOC(filter) < 0)\n        return NULL;\n    return filter;\n}",
          "includes": [
            "# include <linux/devlink.h>",
            "# include <net/if_dl.h>",
            "# include <sys/sockio.h>",
            "# include <linux/ethtool.h>",
            "# include <linux/types.h>",
            "# include <linux/if_vlan.h>",
            "# include <linux/sockios.h>",
            "#include <fcntl.h>",
            "# include <sys/ioctl.h>",
            "#include \"virjson.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virpci.h\"",
            "#include \"vircommand.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetlink.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetdev.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nvirNetDevRxFilterPtr\nvirNetDevRxFilterNew(void)\n{\n    virNetDevRxFilterPtr filter;\n\n    if (VIR_ALLOC(filter) < 0)\n        return NULL;\n    return filter;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint virNetDevGetRxFilter(const char *ifname,\n                         virNetDevRxFilterPtr *filter)\n{\n    int ret = -1;\n    bool receive = false;\n    virNetDevRxFilterPtr fil = virNetDevRxFilterNew();\n\n    if (!fil)\n        goto cleanup;\n\n    if (virNetDevGetMAC(ifname, &fil->mac))\n        goto cleanup;\n\n    if (virNetDevGetMulticastTable(ifname, fil))\n        goto cleanup;\n\n    if (virNetDevGetPromiscuous(ifname, &fil->promiscuous))\n        goto cleanup;\n\n    if (virNetDevGetRcvAllMulti(ifname, &receive))\n        goto cleanup;\n\n    if (receive) {\n        fil->multicast.mode = VIR_NETDEV_RX_FILTER_MODE_ALL;\n    } else {\n        if (virNetDevGetRcvMulti(ifname, &receive))\n            goto cleanup;\n\n        if (receive)\n            fil->multicast.mode = VIR_NETDEV_RX_FILTER_MODE_NORMAL;\n        else\n            fil->multicast.mode = VIR_NETDEV_RX_FILTER_MODE_NONE;\n    }\n\n    ret = 0;\n cleanup:\n    if (ret < 0) {\n        virNetDevRxFilterFree(fil);\n        fil = NULL;\n    }\n\n    *filter = fil;\n    return ret;\n}"
  },
  {
    "function_name": "virNetDevRxFilterFree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
    "lines": "2803-2813",
    "snippet": "void\nvirNetDevRxFilterFree(virNetDevRxFilterPtr filter)\n{\n    if (filter) {\n        VIR_FREE(filter->name);\n        VIR_FREE(filter->unicast.table);\n        VIR_FREE(filter->multicast.table);\n        VIR_FREE(filter->vlan.table);\n        VIR_FREE(filter);\n    }\n}",
    "includes": [
      "# include <linux/devlink.h>",
      "# include <net/if_dl.h>",
      "# include <sys/sockio.h>",
      "# include <linux/ethtool.h>",
      "# include <linux/types.h>",
      "# include <linux/if_vlan.h>",
      "# include <linux/sockios.h>",
      "#include <fcntl.h>",
      "# include <sys/ioctl.h>",
      "#include \"virjson.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virpci.h\"",
      "#include \"vircommand.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetlink.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetdev.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "filter"
          ],
          "line": 2811
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "filter->vlan.table"
          ],
          "line": 2810
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "filter->multicast.table"
          ],
          "line": 2809
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "filter->unicast.table"
          ],
          "line": 2808
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "filter->name"
          ],
          "line": 2807
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nvoid\nvirNetDevRxFilterFree(virNetDevRxFilterPtr filter)\n{\n    if (filter) {\n        VIR_FREE(filter->name);\n        VIR_FREE(filter->unicast.table);\n        VIR_FREE(filter->multicast.table);\n        VIR_FREE(filter->vlan.table);\n        VIR_FREE(filter);\n    }\n}"
  },
  {
    "function_name": "virNetDevRxFilterNew",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
    "lines": "2792-2800",
    "snippet": "virNetDevRxFilterPtr\nvirNetDevRxFilterNew(void)\n{\n    virNetDevRxFilterPtr filter;\n\n    if (VIR_ALLOC(filter) < 0)\n        return NULL;\n    return filter;\n}",
    "includes": [
      "# include <linux/devlink.h>",
      "# include <net/if_dl.h>",
      "# include <sys/sockio.h>",
      "# include <linux/ethtool.h>",
      "# include <linux/types.h>",
      "# include <linux/if_vlan.h>",
      "# include <linux/sockios.h>",
      "#include <fcntl.h>",
      "# include <sys/ioctl.h>",
      "#include \"virjson.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virpci.h\"",
      "#include \"vircommand.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetlink.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetdev.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_ALLOC",
          "args": [
            "filter"
          ],
          "line": 2797
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nvirNetDevRxFilterPtr\nvirNetDevRxFilterNew(void)\n{\n    virNetDevRxFilterPtr filter;\n\n    if (VIR_ALLOC(filter) < 0)\n        return NULL;\n    return filter;\n}"
  },
  {
    "function_name": "virNetDevGetMulticastTable",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
    "lines": "2760-2789",
    "snippet": "static int virNetDevGetMulticastTable(const char *ifname,\n                                      virNetDevRxFilterPtr filter)\n{\n    size_t i;\n    int ret = -1;\n    virNetDevMcastList mcast;\n    filter->multicast.nTable = 0;\n    filter->multicast.table = NULL;\n\n    if (virNetDevGetMcastList(ifname, &mcast) < 0)\n        goto cleanup;\n\n    if (mcast.nentries > 0) {\n        if (VIR_ALLOC_N(filter->multicast.table, mcast.nentries) < 0)\n            goto cleanup;\n\n        for (i = 0; i < mcast.nentries; i++) {\n            virMacAddrSet(&filter->multicast.table[i],\n                          &mcast.entries[i]->macaddr);\n        }\n\n        filter->multicast.nTable = mcast.nentries;\n    }\n\n    ret = 0;\n\n cleanup:\n    virNetDevMcastListClear(&mcast);\n    return ret;\n}",
    "includes": [
      "# include <linux/devlink.h>",
      "# include <net/if_dl.h>",
      "# include <sys/sockio.h>",
      "# include <linux/ethtool.h>",
      "# include <linux/types.h>",
      "# include <linux/if_vlan.h>",
      "# include <linux/sockios.h>",
      "#include <fcntl.h>",
      "# include <sys/ioctl.h>",
      "#include \"virjson.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virpci.h\"",
      "#include \"vircommand.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetlink.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetdev.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "size_t i;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNetDevMcastListClear",
          "args": [
            "&mcast"
          ],
          "line": 2787
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevMcastListClear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
          "lines": "2695-2703",
          "snippet": "static void virNetDevMcastListClear(virNetDevMcastListPtr mcast)\n{\n    size_t i;\n\n    for (i = 0; i < mcast->nentries; i++)\n       VIR_FREE(mcast->entries[i]);\n    VIR_FREE(mcast->entries);\n    mcast->nentries = 0;\n}",
          "includes": [
            "# include <linux/devlink.h>",
            "# include <net/if_dl.h>",
            "# include <sys/sockio.h>",
            "# include <linux/ethtool.h>",
            "# include <linux/types.h>",
            "# include <linux/if_vlan.h>",
            "# include <linux/sockios.h>",
            "#include <fcntl.h>",
            "# include <sys/ioctl.h>",
            "#include \"virjson.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virpci.h\"",
            "#include \"vircommand.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetlink.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetdev.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "size_t i;"
          ],
          "called_functions": [],
          "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nsize_t i;\n\nstatic void virNetDevMcastListClear(virNetDevMcastListPtr mcast)\n{\n    size_t i;\n\n    for (i = 0; i < mcast->nentries; i++)\n       VIR_FREE(mcast->entries[i]);\n    VIR_FREE(mcast->entries);\n    mcast->nentries = 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virMacAddrSet",
          "args": [
            "&filter->multicast.table[i]",
            "&mcast.entries[i]->macaddr"
          ],
          "line": 2777
        },
        "resolved": true,
        "details": {
          "function_name": "virMacAddrSetRaw",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virmacaddr.c",
          "lines": "113-117",
          "snippet": "void\nvirMacAddrSetRaw(virMacAddrPtr dst, const unsigned char src[VIR_MAC_BUFLEN])\n{\n    memcpy(dst->addr, src, VIR_MAC_BUFLEN);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virrandom.h\"",
            "#include \"virmacaddr.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virrandom.h\"\n#include \"virmacaddr.h\"\n#include <config.h>\n\nvoid\nvirMacAddrSetRaw(virMacAddrPtr dst, const unsigned char src[VIR_MAC_BUFLEN])\n{\n    memcpy(dst->addr, src, VIR_MAC_BUFLEN);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC_N",
          "args": [
            "filter->multicast.table",
            "mcast.nentries"
          ],
          "line": 2773
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNetDevGetMcastList",
          "args": [
            "ifname",
            "&mcast"
          ],
          "line": 2769
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevGetMcastList",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
          "lines": "2706-2749",
          "snippet": "static int virNetDevGetMcastList(const char *ifname,\n                                 virNetDevMcastListPtr mcast)\n{\n    char *cur = NULL;\n    char *buf = NULL;\n    char *next = NULL;\n    int ret = -1, len;\n    g_autoptr(virNetDevMcastEntry) entry = NULL;\n\n    mcast->entries = NULL;\n    mcast->nentries = 0;\n\n    /* Read entire multicast table into memory */\n    if ((len = virFileReadAll(PROC_NET_DEV_MCAST, MAX_MCAST_SIZE, &buf)) <= 0)\n        goto cleanup;\n\n    cur = buf;\n    while (cur) {\n        if (!entry && VIR_ALLOC(entry) < 0)\n                goto cleanup;\n\n        next = strchr(cur, '\\n');\n        if (next)\n            next++;\n        if (virNetDevParseMcast(cur, entry))\n            goto cleanup;\n\n        /* Only return global multicast MAC addresses for\n         * specified interface */\n        if (entry->global && STREQ(ifname, entry->name)) {\n            if (VIR_APPEND_ELEMENT(mcast->entries, mcast->nentries, entry))\n                 goto cleanup;\n        } else {\n            memset(entry, 0, sizeof(virNetDevMcastEntry));\n        }\n        cur = next && ((next - buf) < len) ? next : NULL;\n    }\n\n    ret = 0;\n cleanup:\n    VIR_FREE(buf);\n\n    return ret;\n}",
          "includes": [
            "# include <linux/devlink.h>",
            "# include <net/if_dl.h>",
            "# include <sys/sockio.h>",
            "# include <linux/ethtool.h>",
            "# include <linux/types.h>",
            "# include <linux/if_vlan.h>",
            "# include <linux/sockios.h>",
            "#include <fcntl.h>",
            "# include <sys/ioctl.h>",
            "#include \"virjson.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virpci.h\"",
            "#include \"vircommand.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetlink.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetdev.h\"",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define MAX_MCAST_SIZE 50*14336",
            "#define PROC_NET_DEV_MCAST \"/proc/net/dev_mcast\""
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\n#define MAX_MCAST_SIZE 50*14336\n#define PROC_NET_DEV_MCAST \"/proc/net/dev_mcast\"\n\nstatic int virNetDevGetMcastList(const char *ifname,\n                                 virNetDevMcastListPtr mcast)\n{\n    char *cur = NULL;\n    char *buf = NULL;\n    char *next = NULL;\n    int ret = -1, len;\n    g_autoptr(virNetDevMcastEntry) entry = NULL;\n\n    mcast->entries = NULL;\n    mcast->nentries = 0;\n\n    /* Read entire multicast table into memory */\n    if ((len = virFileReadAll(PROC_NET_DEV_MCAST, MAX_MCAST_SIZE, &buf)) <= 0)\n        goto cleanup;\n\n    cur = buf;\n    while (cur) {\n        if (!entry && VIR_ALLOC(entry) < 0)\n                goto cleanup;\n\n        next = strchr(cur, '\\n');\n        if (next)\n            next++;\n        if (virNetDevParseMcast(cur, entry))\n            goto cleanup;\n\n        /* Only return global multicast MAC addresses for\n         * specified interface */\n        if (entry->global && STREQ(ifname, entry->name)) {\n            if (VIR_APPEND_ELEMENT(mcast->entries, mcast->nentries, entry))\n                 goto cleanup;\n        } else {\n            memset(entry, 0, sizeof(virNetDevMcastEntry));\n        }\n        cur = next && ((next - buf) < len) ? next : NULL;\n    }\n\n    ret = 0;\n cleanup:\n    VIR_FREE(buf);\n\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nsize_t i;\n\nstatic int virNetDevGetMulticastTable(const char *ifname,\n                                      virNetDevRxFilterPtr filter)\n{\n    size_t i;\n    int ret = -1;\n    virNetDevMcastList mcast;\n    filter->multicast.nTable = 0;\n    filter->multicast.table = NULL;\n\n    if (virNetDevGetMcastList(ifname, &mcast) < 0)\n        goto cleanup;\n\n    if (mcast.nentries > 0) {\n        if (VIR_ALLOC_N(filter->multicast.table, mcast.nentries) < 0)\n            goto cleanup;\n\n        for (i = 0; i < mcast.nentries; i++) {\n            virMacAddrSet(&filter->multicast.table[i],\n                          &mcast.entries[i]->macaddr);\n        }\n\n        filter->multicast.nTable = mcast.nentries;\n    }\n\n    ret = 0;\n\n cleanup:\n    virNetDevMcastListClear(&mcast);\n    return ret;\n}"
  },
  {
    "function_name": "virNetDevGetMcastList",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
    "lines": "2706-2749",
    "snippet": "static int virNetDevGetMcastList(const char *ifname,\n                                 virNetDevMcastListPtr mcast)\n{\n    char *cur = NULL;\n    char *buf = NULL;\n    char *next = NULL;\n    int ret = -1, len;\n    g_autoptr(virNetDevMcastEntry) entry = NULL;\n\n    mcast->entries = NULL;\n    mcast->nentries = 0;\n\n    /* Read entire multicast table into memory */\n    if ((len = virFileReadAll(PROC_NET_DEV_MCAST, MAX_MCAST_SIZE, &buf)) <= 0)\n        goto cleanup;\n\n    cur = buf;\n    while (cur) {\n        if (!entry && VIR_ALLOC(entry) < 0)\n                goto cleanup;\n\n        next = strchr(cur, '\\n');\n        if (next)\n            next++;\n        if (virNetDevParseMcast(cur, entry))\n            goto cleanup;\n\n        /* Only return global multicast MAC addresses for\n         * specified interface */\n        if (entry->global && STREQ(ifname, entry->name)) {\n            if (VIR_APPEND_ELEMENT(mcast->entries, mcast->nentries, entry))\n                 goto cleanup;\n        } else {\n            memset(entry, 0, sizeof(virNetDevMcastEntry));\n        }\n        cur = next && ((next - buf) < len) ? next : NULL;\n    }\n\n    ret = 0;\n cleanup:\n    VIR_FREE(buf);\n\n    return ret;\n}",
    "includes": [
      "# include <linux/devlink.h>",
      "# include <net/if_dl.h>",
      "# include <sys/sockio.h>",
      "# include <linux/ethtool.h>",
      "# include <linux/types.h>",
      "# include <linux/if_vlan.h>",
      "# include <linux/sockios.h>",
      "#include <fcntl.h>",
      "# include <sys/ioctl.h>",
      "#include \"virjson.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virpci.h\"",
      "#include \"vircommand.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetlink.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetdev.h\"",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define MAX_MCAST_SIZE 50*14336",
      "#define PROC_NET_DEV_MCAST \"/proc/net/dev_mcast\""
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "buf"
          ],
          "line": 2746
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "entry",
            "0",
            "sizeof(virNetDevMcastEntry)"
          ],
          "line": 2739
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_APPEND_ELEMENT",
          "args": [
            "mcast->entries",
            "mcast->nentries",
            "entry"
          ],
          "line": 2736
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "ifname",
            "entry->name"
          ],
          "line": 2735
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNetDevParseMcast",
          "args": [
            "cur",
            "entry"
          ],
          "line": 2730
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevParseMcast",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
          "lines": "2618-2692",
          "snippet": "static int virNetDevParseMcast(char *buf, virNetDevMcastEntryPtr mcast)\n{\n    int ifindex;\n    int num;\n    char *next;\n    char *token;\n    char *saveptr;\n    char *endptr;\n\n    for (ifindex = VIR_MCAST_TYPE_INDEX_TOKEN, next = buf; ifindex < VIR_MCAST_TYPE_LAST; ifindex++,\n         next = NULL) {\n        token = strtok_r(next, VIR_MCAST_TOKEN_DELIMS, &saveptr);\n\n        if (token == NULL) {\n            virReportSystemError(EINVAL,\n                                 _(\"failed to parse multicast address from '%s'\"),\n                                 buf);\n            return -1;\n        }\n\n        switch ((virMCastType)ifindex) {\n            case VIR_MCAST_TYPE_INDEX_TOKEN:\n                if (virStrToLong_i(token, &endptr, 10, &num) < 0) {\n                    virReportSystemError(EINVAL,\n                                         _(\"Failed to parse interface index from '%s'\"),\n                                         buf);\n                    return -1;\n\n                }\n                mcast->idx = num;\n                break;\n            case VIR_MCAST_TYPE_NAME_TOKEN:\n                if (virStrcpy(mcast->name, token, VIR_MCAST_NAME_LEN) < 0) {\n                    virReportSystemError(EINVAL,\n                                         _(\"Failed to parse network device name from '%s'\"),\n                                         buf);\n                    return -1;\n                }\n                break;\n            case VIR_MCAST_TYPE_USERS_TOKEN:\n                if (virStrToLong_i(token, &endptr, 10, &num) < 0) {\n                    virReportSystemError(EINVAL,\n                                         _(\"Failed to parse users from '%s'\"),\n                                         buf);\n                    return -1;\n\n                }\n                mcast->users = num;\n                break;\n            case VIR_MCAST_TYPE_GLOBAL_TOKEN:\n                if (virStrToLong_i(token, &endptr, 10, &num) < 0) {\n                    virReportSystemError(EINVAL,\n                                         _(\"Failed to parse users from '%s'\"),\n                                         buf);\n                    return -1;\n\n                }\n                mcast->global = num;\n                break;\n            case VIR_MCAST_TYPE_ADDR_TOKEN:\n                if (virMacAddrParseHex((const char*)token,\n                                       &mcast->macaddr) < 0) {\n                    virReportSystemError(EINVAL,\n                                         _(\"Failed to parse MAC address from '%s'\"),\n                                         buf);\n                }\n                break;\n\n            /* coverity[dead_error_begin] */\n            case VIR_MCAST_TYPE_LAST:\n                break;\n        }\n    }\n    return 0;\n}",
          "includes": [
            "# include <linux/devlink.h>",
            "# include <net/if_dl.h>",
            "# include <sys/sockio.h>",
            "# include <linux/ethtool.h>",
            "# include <linux/types.h>",
            "# include <linux/if_vlan.h>",
            "# include <linux/sockios.h>",
            "#include <fcntl.h>",
            "# include <sys/ioctl.h>",
            "#include \"virjson.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virpci.h\"",
            "#include \"vircommand.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetlink.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetdev.h\"",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define VIR_MCAST_TOKEN_DELIMS \" \\n\"",
            "#define VIR_MCAST_NAME_LEN (IFNAMSIZ + 1)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\n#define VIR_MCAST_TOKEN_DELIMS \" \\n\"\n#define VIR_MCAST_NAME_LEN (IFNAMSIZ + 1)\n\nstatic int virNetDevParseMcast(char *buf, virNetDevMcastEntryPtr mcast)\n{\n    int ifindex;\n    int num;\n    char *next;\n    char *token;\n    char *saveptr;\n    char *endptr;\n\n    for (ifindex = VIR_MCAST_TYPE_INDEX_TOKEN, next = buf; ifindex < VIR_MCAST_TYPE_LAST; ifindex++,\n         next = NULL) {\n        token = strtok_r(next, VIR_MCAST_TOKEN_DELIMS, &saveptr);\n\n        if (token == NULL) {\n            virReportSystemError(EINVAL,\n                                 _(\"failed to parse multicast address from '%s'\"),\n                                 buf);\n            return -1;\n        }\n\n        switch ((virMCastType)ifindex) {\n            case VIR_MCAST_TYPE_INDEX_TOKEN:\n                if (virStrToLong_i(token, &endptr, 10, &num) < 0) {\n                    virReportSystemError(EINVAL,\n                                         _(\"Failed to parse interface index from '%s'\"),\n                                         buf);\n                    return -1;\n\n                }\n                mcast->idx = num;\n                break;\n            case VIR_MCAST_TYPE_NAME_TOKEN:\n                if (virStrcpy(mcast->name, token, VIR_MCAST_NAME_LEN) < 0) {\n                    virReportSystemError(EINVAL,\n                                         _(\"Failed to parse network device name from '%s'\"),\n                                         buf);\n                    return -1;\n                }\n                break;\n            case VIR_MCAST_TYPE_USERS_TOKEN:\n                if (virStrToLong_i(token, &endptr, 10, &num) < 0) {\n                    virReportSystemError(EINVAL,\n                                         _(\"Failed to parse users from '%s'\"),\n                                         buf);\n                    return -1;\n\n                }\n                mcast->users = num;\n                break;\n            case VIR_MCAST_TYPE_GLOBAL_TOKEN:\n                if (virStrToLong_i(token, &endptr, 10, &num) < 0) {\n                    virReportSystemError(EINVAL,\n                                         _(\"Failed to parse users from '%s'\"),\n                                         buf);\n                    return -1;\n\n                }\n                mcast->global = num;\n                break;\n            case VIR_MCAST_TYPE_ADDR_TOKEN:\n                if (virMacAddrParseHex((const char*)token,\n                                       &mcast->macaddr) < 0) {\n                    virReportSystemError(EINVAL,\n                                         _(\"Failed to parse MAC address from '%s'\"),\n                                         buf);\n                }\n                break;\n\n            /* coverity[dead_error_begin] */\n            case VIR_MCAST_TYPE_LAST:\n                break;\n        }\n    }\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "cur",
            "'\\n'"
          ],
          "line": 2727
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC",
          "args": [
            "entry"
          ],
          "line": 2724
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virFileReadAll",
          "args": [
            "PROC_NET_DEV_MCAST",
            "MAX_MCAST_SIZE",
            "&buf"
          ],
          "line": 2719
        },
        "resolved": true,
        "details": {
          "function_name": "virFileReadAllQuiet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1459-1472",
          "snippet": "int\nvirFileReadAllQuiet(const char *path, int maxlen, char **buf)\n{\n    int fd = open(path, O_RDONLY);\n    if (fd < 0)\n        return -errno;\n\n    int len = virFileReadLimFD(fd, maxlen, buf);\n    VIR_FORCE_CLOSE(fd);\n    if (len < 0)\n        return -errno;\n\n    return len;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileReadAllQuiet(const char *path, int maxlen, char **buf)\n{\n    int fd = open(path, O_RDONLY);\n    if (fd < 0)\n        return -errno;\n\n    int len = virFileReadLimFD(fd, maxlen, buf);\n    VIR_FORCE_CLOSE(fd);\n    if (len < 0)\n        return -errno;\n\n    return len;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\n#define MAX_MCAST_SIZE 50*14336\n#define PROC_NET_DEV_MCAST \"/proc/net/dev_mcast\"\n\nstatic int virNetDevGetMcastList(const char *ifname,\n                                 virNetDevMcastListPtr mcast)\n{\n    char *cur = NULL;\n    char *buf = NULL;\n    char *next = NULL;\n    int ret = -1, len;\n    g_autoptr(virNetDevMcastEntry) entry = NULL;\n\n    mcast->entries = NULL;\n    mcast->nentries = 0;\n\n    /* Read entire multicast table into memory */\n    if ((len = virFileReadAll(PROC_NET_DEV_MCAST, MAX_MCAST_SIZE, &buf)) <= 0)\n        goto cleanup;\n\n    cur = buf;\n    while (cur) {\n        if (!entry && VIR_ALLOC(entry) < 0)\n                goto cleanup;\n\n        next = strchr(cur, '\\n');\n        if (next)\n            next++;\n        if (virNetDevParseMcast(cur, entry))\n            goto cleanup;\n\n        /* Only return global multicast MAC addresses for\n         * specified interface */\n        if (entry->global && STREQ(ifname, entry->name)) {\n            if (VIR_APPEND_ELEMENT(mcast->entries, mcast->nentries, entry))\n                 goto cleanup;\n        } else {\n            memset(entry, 0, sizeof(virNetDevMcastEntry));\n        }\n        cur = next && ((next - buf) < len) ? next : NULL;\n    }\n\n    ret = 0;\n cleanup:\n    VIR_FREE(buf);\n\n    return ret;\n}"
  },
  {
    "function_name": "virNetDevMcastListClear",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
    "lines": "2695-2703",
    "snippet": "static void virNetDevMcastListClear(virNetDevMcastListPtr mcast)\n{\n    size_t i;\n\n    for (i = 0; i < mcast->nentries; i++)\n       VIR_FREE(mcast->entries[i]);\n    VIR_FREE(mcast->entries);\n    mcast->nentries = 0;\n}",
    "includes": [
      "# include <linux/devlink.h>",
      "# include <net/if_dl.h>",
      "# include <sys/sockio.h>",
      "# include <linux/ethtool.h>",
      "# include <linux/types.h>",
      "# include <linux/if_vlan.h>",
      "# include <linux/sockios.h>",
      "#include <fcntl.h>",
      "# include <sys/ioctl.h>",
      "#include \"virjson.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virpci.h\"",
      "#include \"vircommand.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetlink.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetdev.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "size_t i;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "mcast->entries"
          ],
          "line": 2701
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "mcast->entries[i]"
          ],
          "line": 2700
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nsize_t i;\n\nstatic void virNetDevMcastListClear(virNetDevMcastListPtr mcast)\n{\n    size_t i;\n\n    for (i = 0; i < mcast->nentries; i++)\n       VIR_FREE(mcast->entries[i]);\n    VIR_FREE(mcast->entries);\n    mcast->nentries = 0;\n}"
  },
  {
    "function_name": "virNetDevParseMcast",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
    "lines": "2618-2692",
    "snippet": "static int virNetDevParseMcast(char *buf, virNetDevMcastEntryPtr mcast)\n{\n    int ifindex;\n    int num;\n    char *next;\n    char *token;\n    char *saveptr;\n    char *endptr;\n\n    for (ifindex = VIR_MCAST_TYPE_INDEX_TOKEN, next = buf; ifindex < VIR_MCAST_TYPE_LAST; ifindex++,\n         next = NULL) {\n        token = strtok_r(next, VIR_MCAST_TOKEN_DELIMS, &saveptr);\n\n        if (token == NULL) {\n            virReportSystemError(EINVAL,\n                                 _(\"failed to parse multicast address from '%s'\"),\n                                 buf);\n            return -1;\n        }\n\n        switch ((virMCastType)ifindex) {\n            case VIR_MCAST_TYPE_INDEX_TOKEN:\n                if (virStrToLong_i(token, &endptr, 10, &num) < 0) {\n                    virReportSystemError(EINVAL,\n                                         _(\"Failed to parse interface index from '%s'\"),\n                                         buf);\n                    return -1;\n\n                }\n                mcast->idx = num;\n                break;\n            case VIR_MCAST_TYPE_NAME_TOKEN:\n                if (virStrcpy(mcast->name, token, VIR_MCAST_NAME_LEN) < 0) {\n                    virReportSystemError(EINVAL,\n                                         _(\"Failed to parse network device name from '%s'\"),\n                                         buf);\n                    return -1;\n                }\n                break;\n            case VIR_MCAST_TYPE_USERS_TOKEN:\n                if (virStrToLong_i(token, &endptr, 10, &num) < 0) {\n                    virReportSystemError(EINVAL,\n                                         _(\"Failed to parse users from '%s'\"),\n                                         buf);\n                    return -1;\n\n                }\n                mcast->users = num;\n                break;\n            case VIR_MCAST_TYPE_GLOBAL_TOKEN:\n                if (virStrToLong_i(token, &endptr, 10, &num) < 0) {\n                    virReportSystemError(EINVAL,\n                                         _(\"Failed to parse users from '%s'\"),\n                                         buf);\n                    return -1;\n\n                }\n                mcast->global = num;\n                break;\n            case VIR_MCAST_TYPE_ADDR_TOKEN:\n                if (virMacAddrParseHex((const char*)token,\n                                       &mcast->macaddr) < 0) {\n                    virReportSystemError(EINVAL,\n                                         _(\"Failed to parse MAC address from '%s'\"),\n                                         buf);\n                }\n                break;\n\n            /* coverity[dead_error_begin] */\n            case VIR_MCAST_TYPE_LAST:\n                break;\n        }\n    }\n    return 0;\n}",
    "includes": [
      "# include <linux/devlink.h>",
      "# include <net/if_dl.h>",
      "# include <sys/sockio.h>",
      "# include <linux/ethtool.h>",
      "# include <linux/types.h>",
      "# include <linux/if_vlan.h>",
      "# include <linux/sockios.h>",
      "#include <fcntl.h>",
      "# include <sys/ioctl.h>",
      "#include \"virjson.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virpci.h\"",
      "#include \"vircommand.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetlink.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetdev.h\"",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define VIR_MCAST_TOKEN_DELIMS \" \\n\"",
      "#define VIR_MCAST_NAME_LEN (IFNAMSIZ + 1)"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "EINVAL",
            "_(\"Failed to parse MAC address from '%s'\")",
            "buf"
          ],
          "line": 2680
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Failed to parse MAC address from '%s'\""
          ],
          "line": 2681
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virMacAddrParseHex",
          "args": [
            "(const char*)token",
            "&mcast->macaddr"
          ],
          "line": 2678
        },
        "resolved": true,
        "details": {
          "function_name": "virMacAddrParseHex",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virmacaddr.c",
          "lines": "205-218",
          "snippet": "int\nvirMacAddrParseHex(const char *str, virMacAddrPtr addr)\n{\n    size_t i;\n\n    if (strspn(str, \"0123456789abcdefABCDEF\") != VIR_MAC_HEXLEN ||\n        str[VIR_MAC_HEXLEN])\n        return -1;\n\n    for (i = 0; i < VIR_MAC_BUFLEN; i++)\n        addr->addr[i] = (g_ascii_xdigit_value(str[2 * i]) << 4 |\n                         g_ascii_xdigit_value(str[2 * i + 1]));\n    return 0;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virrandom.h\"",
            "#include \"virmacaddr.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virrandom.h\"\n#include \"virmacaddr.h\"\n#include <config.h>\n\nint\nvirMacAddrParseHex(const char *str, virMacAddrPtr addr)\n{\n    size_t i;\n\n    if (strspn(str, \"0123456789abcdefABCDEF\") != VIR_MAC_HEXLEN ||\n        str[VIR_MAC_HEXLEN])\n        return -1;\n\n    for (i = 0; i < VIR_MAC_BUFLEN; i++)\n        addr->addr[i] = (g_ascii_xdigit_value(str[2 * i]) << 4 |\n                         g_ascii_xdigit_value(str[2 * i + 1]));\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "EINVAL",
            "_(\"Failed to parse users from '%s'\")",
            "buf"
          ],
          "line": 2669
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStrToLong_i",
          "args": [
            "token",
            "&endptr",
            "10",
            "&num"
          ],
          "line": 2668
        },
        "resolved": true,
        "details": {
          "function_name": "virStrToLong_i",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "391-407",
          "snippet": "int\nvirStrToLong_i(char const *s, char **end_ptr, int base, int *result)\n{\n    long int val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtol(s, &p, base); /* exempt from syntax-check */\n    err = (errno || (!end_ptr && *p) || p == s || (int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToLong_i(char const *s, char **end_ptr, int base, int *result)\n{\n    long int val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtol(s, &p, base); /* exempt from syntax-check */\n    err = (errno || (!end_ptr && *p) || p == s || (int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "EINVAL",
            "_(\"Failed to parse users from '%s'\")",
            "buf"
          ],
          "line": 2659
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "EINVAL",
            "_(\"Failed to parse network device name from '%s'\")",
            "buf"
          ],
          "line": 2651
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStrcpy",
          "args": [
            "mcast->name",
            "token",
            "VIR_MCAST_NAME_LEN"
          ],
          "line": 2650
        },
        "resolved": true,
        "details": {
          "function_name": "virStrcpy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "780-784",
          "snippet": "int\nvirStrcpy(char *dest, const char *src, size_t destbytes)\n{\n    return virStrncpy(dest, src, -1, destbytes);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrcpy(char *dest, const char *src, size_t destbytes)\n{\n    return virStrncpy(dest, src, -1, destbytes);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "EINVAL",
            "_(\"Failed to parse interface index from '%s'\")",
            "buf"
          ],
          "line": 2641
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "EINVAL",
            "_(\"failed to parse multicast address from '%s'\")",
            "buf"
          ],
          "line": 2632
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strtok_r",
          "args": [
            "next",
            "VIR_MCAST_TOKEN_DELIMS",
            "&saveptr"
          ],
          "line": 2629
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\n#define VIR_MCAST_TOKEN_DELIMS \" \\n\"\n#define VIR_MCAST_NAME_LEN (IFNAMSIZ + 1)\n\nstatic int virNetDevParseMcast(char *buf, virNetDevMcastEntryPtr mcast)\n{\n    int ifindex;\n    int num;\n    char *next;\n    char *token;\n    char *saveptr;\n    char *endptr;\n\n    for (ifindex = VIR_MCAST_TYPE_INDEX_TOKEN, next = buf; ifindex < VIR_MCAST_TYPE_LAST; ifindex++,\n         next = NULL) {\n        token = strtok_r(next, VIR_MCAST_TOKEN_DELIMS, &saveptr);\n\n        if (token == NULL) {\n            virReportSystemError(EINVAL,\n                                 _(\"failed to parse multicast address from '%s'\"),\n                                 buf);\n            return -1;\n        }\n\n        switch ((virMCastType)ifindex) {\n            case VIR_MCAST_TYPE_INDEX_TOKEN:\n                if (virStrToLong_i(token, &endptr, 10, &num) < 0) {\n                    virReportSystemError(EINVAL,\n                                         _(\"Failed to parse interface index from '%s'\"),\n                                         buf);\n                    return -1;\n\n                }\n                mcast->idx = num;\n                break;\n            case VIR_MCAST_TYPE_NAME_TOKEN:\n                if (virStrcpy(mcast->name, token, VIR_MCAST_NAME_LEN) < 0) {\n                    virReportSystemError(EINVAL,\n                                         _(\"Failed to parse network device name from '%s'\"),\n                                         buf);\n                    return -1;\n                }\n                break;\n            case VIR_MCAST_TYPE_USERS_TOKEN:\n                if (virStrToLong_i(token, &endptr, 10, &num) < 0) {\n                    virReportSystemError(EINVAL,\n                                         _(\"Failed to parse users from '%s'\"),\n                                         buf);\n                    return -1;\n\n                }\n                mcast->users = num;\n                break;\n            case VIR_MCAST_TYPE_GLOBAL_TOKEN:\n                if (virStrToLong_i(token, &endptr, 10, &num) < 0) {\n                    virReportSystemError(EINVAL,\n                                         _(\"Failed to parse users from '%s'\"),\n                                         buf);\n                    return -1;\n\n                }\n                mcast->global = num;\n                break;\n            case VIR_MCAST_TYPE_ADDR_TOKEN:\n                if (virMacAddrParseHex((const char*)token,\n                                       &mcast->macaddr) < 0) {\n                    virReportSystemError(EINVAL,\n                                         _(\"Failed to parse MAC address from '%s'\"),\n                                         buf);\n                }\n                break;\n\n            /* coverity[dead_error_begin] */\n            case VIR_MCAST_TYPE_LAST:\n                break;\n        }\n    }\n    return 0;\n}"
  },
  {
    "function_name": "virNetDevDelMulti",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
    "lines": "2608-2615",
    "snippet": "int virNetDevDelMulti(const char *ifname G_GNUC_UNUSED,\n                      virMacAddrPtr macaddr G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to delete address from interface \"\n                           \"multicast list on this platform\"));\n    return -1;\n}",
    "includes": [
      "# include <linux/devlink.h>",
      "# include <net/if_dl.h>",
      "# include <sys/sockio.h>",
      "# include <linux/ethtool.h>",
      "# include <linux/types.h>",
      "# include <linux/if_vlan.h>",
      "# include <linux/sockios.h>",
      "#include <fcntl.h>",
      "# include <sys/ioctl.h>",
      "#include \"virjson.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virpci.h\"",
      "#include \"vircommand.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetlink.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetdev.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "\"%s\"",
            "_(\"Unable to delete address from interface \"\n                           \"multicast list on this platform\")"
          ],
          "line": 2611
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to delete address from interface \"\n                           \"multicast list on this platform\""
          ],
          "line": 2612
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint virNetDevDelMulti(const char *ifname G_GNUC_UNUSED,\n                      virMacAddrPtr macaddr G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to delete address from interface \"\n                           \"multicast list on this platform\"));\n    return -1;\n}"
  },
  {
    "function_name": "virNetDevDelMulti",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
    "lines": "2585-2606",
    "snippet": "int virNetDevDelMulti(const char *ifname,\n                      virMacAddrPtr macaddr)\n{\n    struct ifreq ifr;\n    VIR_AUTOCLOSE fd = -1;\n\n    if ((fd = virNetDevSetupControl(ifname, &ifr)) < 0)\n        return -1;\n\n    ifr.ifr_hwaddr.sa_family = AF_UNSPEC;\n    virMacAddrGetRaw(macaddr, (unsigned char *)ifr.ifr_hwaddr.sa_data);\n\n    if (ioctl(fd, SIOCDELMULTI, &ifr) < 0) {\n        char macstr[VIR_MAC_STRING_BUFLEN];\n        virReportSystemError(errno,\n                             _(\"Cannot add multicast MAC %s on '%s' interface\"),\n                             virMacAddrFormat(macaddr, macstr), ifname);\n        return -1;\n    }\n\n    return 0;\n}",
    "includes": [
      "# include <linux/devlink.h>",
      "# include <net/if_dl.h>",
      "# include <sys/sockio.h>",
      "# include <linux/ethtool.h>",
      "# include <linux/types.h>",
      "# include <linux/if_vlan.h>",
      "# include <linux/sockios.h>",
      "#include <fcntl.h>",
      "# include <sys/ioctl.h>",
      "#include \"virjson.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virpci.h\"",
      "#include \"vircommand.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetlink.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetdev.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"Cannot add multicast MAC %s on '%s' interface\")",
            "virMacAddrFormat(macaddr, macstr)",
            "ifname"
          ],
          "line": 2599
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virMacAddrFormat",
          "args": [
            "macaddr",
            "macstr"
          ],
          "line": 2601
        },
        "resolved": true,
        "details": {
          "function_name": "virMacAddrFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virmacaddr.c",
          "lines": "184-194",
          "snippet": "const char *\nvirMacAddrFormat(const virMacAddr *addr,\n                 char *str)\n{\n    g_snprintf(str, VIR_MAC_STRING_BUFLEN,\n               \"%02x:%02x:%02x:%02x:%02x:%02x\",\n               addr->addr[0], addr->addr[1], addr->addr[2],\n               addr->addr[3], addr->addr[4], addr->addr[5]);\n    str[VIR_MAC_STRING_BUFLEN-1] = '\\0';\n    return str;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virrandom.h\"",
            "#include \"virmacaddr.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virrandom.h\"\n#include \"virmacaddr.h\"\n#include <config.h>\n\nconst char *\nvirMacAddrFormat(const virMacAddr *addr,\n                 char *str)\n{\n    g_snprintf(str, VIR_MAC_STRING_BUFLEN,\n               \"%02x:%02x:%02x:%02x:%02x:%02x\",\n               addr->addr[0], addr->addr[1], addr->addr[2],\n               addr->addr[3], addr->addr[4], addr->addr[5]);\n    str[VIR_MAC_STRING_BUFLEN-1] = '\\0';\n    return str;\n}"
        }
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Cannot add multicast MAC %s on '%s' interface\""
          ],
          "line": 2600
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ioctl",
          "args": [
            "fd",
            "SIOCDELMULTI",
            "&ifr"
          ],
          "line": 2597
        },
        "resolved": true,
        "details": {
          "function_name": "vir_ioctlsocket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsocket.c",
          "lines": "292-308",
          "snippet": "int\nvir_ioctlsocket(int fd, int cmd, void *arg)\n{\n    SOCKET sk = FD2SK(fd);\n\n    if (sk == INVALID_SOCKET) {\n        errno = EBADF;\n        return -1;\n    }\n\n    if (ioctlsocket(sk, cmd, arg) < 0) {\n        set_errno();\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include <fcntl.h>",
            "#include \"virfile.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <fcntl.h>\n#include \"virfile.h\"\n#include \"virutil.h\"\n#include \"virsocket.h\"\n#include <config.h>\n\nint\nvir_ioctlsocket(int fd, int cmd, void *arg)\n{\n    SOCKET sk = FD2SK(fd);\n\n    if (sk == INVALID_SOCKET) {\n        errno = EBADF;\n        return -1;\n    }\n\n    if (ioctlsocket(sk, cmd, arg) < 0) {\n        set_errno();\n        return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virMacAddrGetRaw",
          "args": [
            "macaddr",
            "(unsigned char *)ifr.ifr_hwaddr.sa_data"
          ],
          "line": 2595
        },
        "resolved": true,
        "details": {
          "function_name": "virMacAddrGetRaw",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virmacaddr.c",
          "lines": "126-130",
          "snippet": "void\nvirMacAddrGetRaw(const virMacAddr *src, unsigned char dst[VIR_MAC_BUFLEN])\n{\n    memcpy(dst, src->addr, VIR_MAC_BUFLEN);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virrandom.h\"",
            "#include \"virmacaddr.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virrandom.h\"\n#include \"virmacaddr.h\"\n#include <config.h>\n\nvoid\nvirMacAddrGetRaw(const virMacAddr *src, unsigned char dst[VIR_MAC_BUFLEN])\n{\n    memcpy(dst, src->addr, VIR_MAC_BUFLEN);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetDevSetupControl",
          "args": [
            "ifname",
            "&ifr"
          ],
          "line": 2591
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevSetupControl",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
          "lines": "177-185",
          "snippet": "int\nvirNetDevSetupControl(const char *ifname G_GNUC_UNUSED,\n                      void *ifr G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Network device configuration is not supported \"\n                           \"on this platform\"));\n    return -1;\n}",
          "includes": [
            "# include <linux/devlink.h>",
            "# include <net/if_dl.h>",
            "# include <sys/sockio.h>",
            "# include <linux/ethtool.h>",
            "# include <linux/types.h>",
            "# include <linux/if_vlan.h>",
            "# include <linux/sockios.h>",
            "#include <fcntl.h>",
            "# include <sys/ioctl.h>",
            "#include \"virjson.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virpci.h\"",
            "#include \"vircommand.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetlink.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetdev.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint\nvirNetDevSetupControl(const char *ifname G_GNUC_UNUSED,\n                      void *ifr G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Network device configuration is not supported \"\n                           \"on this platform\"));\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint virNetDevDelMulti(const char *ifname,\n                      virMacAddrPtr macaddr)\n{\n    struct ifreq ifr;\n    VIR_AUTOCLOSE fd = -1;\n\n    if ((fd = virNetDevSetupControl(ifname, &ifr)) < 0)\n        return -1;\n\n    ifr.ifr_hwaddr.sa_family = AF_UNSPEC;\n    virMacAddrGetRaw(macaddr, (unsigned char *)ifr.ifr_hwaddr.sa_data);\n\n    if (ioctl(fd, SIOCDELMULTI, &ifr) < 0) {\n        char macstr[VIR_MAC_STRING_BUFLEN];\n        virReportSystemError(errno,\n                             _(\"Cannot add multicast MAC %s on '%s' interface\"),\n                             virMacAddrFormat(macaddr, macstr), ifname);\n        return -1;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virNetDevAddMulti",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
    "lines": "2563-2570",
    "snippet": "int virNetDevAddMulti(const char *ifname G_GNUC_UNUSED,\n                      virMacAddrPtr macaddr G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to add address to interface \"\n                           \"multicast list on this platform\"));\n    return -1;\n}",
    "includes": [
      "# include <linux/devlink.h>",
      "# include <net/if_dl.h>",
      "# include <sys/sockio.h>",
      "# include <linux/ethtool.h>",
      "# include <linux/types.h>",
      "# include <linux/if_vlan.h>",
      "# include <linux/sockios.h>",
      "#include <fcntl.h>",
      "# include <sys/ioctl.h>",
      "#include \"virjson.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virpci.h\"",
      "#include \"vircommand.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetlink.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetdev.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "\"%s\"",
            "_(\"Unable to add address to interface \"\n                           \"multicast list on this platform\")"
          ],
          "line": 2566
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to add address to interface \"\n                           \"multicast list on this platform\""
          ],
          "line": 2567
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint virNetDevAddMulti(const char *ifname G_GNUC_UNUSED,\n                      virMacAddrPtr macaddr G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to add address to interface \"\n                           \"multicast list on this platform\"));\n    return -1;\n}"
  },
  {
    "function_name": "virNetDevAddMulti",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
    "lines": "2540-2561",
    "snippet": "int virNetDevAddMulti(const char *ifname,\n                      virMacAddrPtr macaddr)\n{\n    struct ifreq ifr;\n    VIR_AUTOCLOSE fd = -1;\n\n    if ((fd = virNetDevSetupControl(ifname, &ifr)) < 0)\n        return -1;\n\n    ifr.ifr_hwaddr.sa_family = AF_UNSPEC;\n    virMacAddrGetRaw(macaddr, (unsigned char *)ifr.ifr_hwaddr.sa_data);\n\n    if (ioctl(fd, SIOCADDMULTI, &ifr) < 0) {\n        char macstr[VIR_MAC_STRING_BUFLEN];\n        virReportSystemError(errno,\n                             _(\"Cannot add multicast MAC %s on '%s' interface\"),\n                             virMacAddrFormat(macaddr, macstr), ifname);\n        return -1;\n    }\n\n    return 0;\n}",
    "includes": [
      "# include <linux/devlink.h>",
      "# include <net/if_dl.h>",
      "# include <sys/sockio.h>",
      "# include <linux/ethtool.h>",
      "# include <linux/types.h>",
      "# include <linux/if_vlan.h>",
      "# include <linux/sockios.h>",
      "#include <fcntl.h>",
      "# include <sys/ioctl.h>",
      "#include \"virjson.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virpci.h\"",
      "#include \"vircommand.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetlink.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetdev.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"Cannot add multicast MAC %s on '%s' interface\")",
            "virMacAddrFormat(macaddr, macstr)",
            "ifname"
          ],
          "line": 2554
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virMacAddrFormat",
          "args": [
            "macaddr",
            "macstr"
          ],
          "line": 2556
        },
        "resolved": true,
        "details": {
          "function_name": "virMacAddrFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virmacaddr.c",
          "lines": "184-194",
          "snippet": "const char *\nvirMacAddrFormat(const virMacAddr *addr,\n                 char *str)\n{\n    g_snprintf(str, VIR_MAC_STRING_BUFLEN,\n               \"%02x:%02x:%02x:%02x:%02x:%02x\",\n               addr->addr[0], addr->addr[1], addr->addr[2],\n               addr->addr[3], addr->addr[4], addr->addr[5]);\n    str[VIR_MAC_STRING_BUFLEN-1] = '\\0';\n    return str;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virrandom.h\"",
            "#include \"virmacaddr.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virrandom.h\"\n#include \"virmacaddr.h\"\n#include <config.h>\n\nconst char *\nvirMacAddrFormat(const virMacAddr *addr,\n                 char *str)\n{\n    g_snprintf(str, VIR_MAC_STRING_BUFLEN,\n               \"%02x:%02x:%02x:%02x:%02x:%02x\",\n               addr->addr[0], addr->addr[1], addr->addr[2],\n               addr->addr[3], addr->addr[4], addr->addr[5]);\n    str[VIR_MAC_STRING_BUFLEN-1] = '\\0';\n    return str;\n}"
        }
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Cannot add multicast MAC %s on '%s' interface\""
          ],
          "line": 2555
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ioctl",
          "args": [
            "fd",
            "SIOCADDMULTI",
            "&ifr"
          ],
          "line": 2552
        },
        "resolved": true,
        "details": {
          "function_name": "vir_ioctlsocket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsocket.c",
          "lines": "292-308",
          "snippet": "int\nvir_ioctlsocket(int fd, int cmd, void *arg)\n{\n    SOCKET sk = FD2SK(fd);\n\n    if (sk == INVALID_SOCKET) {\n        errno = EBADF;\n        return -1;\n    }\n\n    if (ioctlsocket(sk, cmd, arg) < 0) {\n        set_errno();\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include <fcntl.h>",
            "#include \"virfile.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <fcntl.h>\n#include \"virfile.h\"\n#include \"virutil.h\"\n#include \"virsocket.h\"\n#include <config.h>\n\nint\nvir_ioctlsocket(int fd, int cmd, void *arg)\n{\n    SOCKET sk = FD2SK(fd);\n\n    if (sk == INVALID_SOCKET) {\n        errno = EBADF;\n        return -1;\n    }\n\n    if (ioctlsocket(sk, cmd, arg) < 0) {\n        set_errno();\n        return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virMacAddrGetRaw",
          "args": [
            "macaddr",
            "(unsigned char *)ifr.ifr_hwaddr.sa_data"
          ],
          "line": 2550
        },
        "resolved": true,
        "details": {
          "function_name": "virMacAddrGetRaw",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virmacaddr.c",
          "lines": "126-130",
          "snippet": "void\nvirMacAddrGetRaw(const virMacAddr *src, unsigned char dst[VIR_MAC_BUFLEN])\n{\n    memcpy(dst, src->addr, VIR_MAC_BUFLEN);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virrandom.h\"",
            "#include \"virmacaddr.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virrandom.h\"\n#include \"virmacaddr.h\"\n#include <config.h>\n\nvoid\nvirMacAddrGetRaw(const virMacAddr *src, unsigned char dst[VIR_MAC_BUFLEN])\n{\n    memcpy(dst, src->addr, VIR_MAC_BUFLEN);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetDevSetupControl",
          "args": [
            "ifname",
            "&ifr"
          ],
          "line": 2546
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevSetupControl",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
          "lines": "177-185",
          "snippet": "int\nvirNetDevSetupControl(const char *ifname G_GNUC_UNUSED,\n                      void *ifr G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Network device configuration is not supported \"\n                           \"on this platform\"));\n    return -1;\n}",
          "includes": [
            "# include <linux/devlink.h>",
            "# include <net/if_dl.h>",
            "# include <sys/sockio.h>",
            "# include <linux/ethtool.h>",
            "# include <linux/types.h>",
            "# include <linux/if_vlan.h>",
            "# include <linux/sockios.h>",
            "#include <fcntl.h>",
            "# include <sys/ioctl.h>",
            "#include \"virjson.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virpci.h\"",
            "#include \"vircommand.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetlink.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetdev.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint\nvirNetDevSetupControl(const char *ifname G_GNUC_UNUSED,\n                      void *ifr G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Network device configuration is not supported \"\n                           \"on this platform\"));\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint virNetDevAddMulti(const char *ifname,\n                      virMacAddrPtr macaddr)\n{\n    struct ifreq ifr;\n    VIR_AUTOCLOSE fd = -1;\n\n    if ((fd = virNetDevSetupControl(ifname, &ifr)) < 0)\n        return -1;\n\n    ifr.ifr_hwaddr.sa_family = AF_UNSPEC;\n    virMacAddrGetRaw(macaddr, (unsigned char *)ifr.ifr_hwaddr.sa_data);\n\n    if (ioctl(fd, SIOCADDMULTI, &ifr) < 0) {\n        char macstr[VIR_MAC_STRING_BUFLEN];\n        virReportSystemError(errno,\n                             _(\"Cannot add multicast MAC %s on '%s' interface\"),\n                             virMacAddrFormat(macaddr, macstr), ifname);\n        return -1;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virNetDevGetLinkInfo",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
    "lines": "2515-2524",
    "snippet": "int\nvirNetDevGetLinkInfo(const char *ifname,\n                     virNetDevIfLinkPtr lnk)\n{\n    /* Port me */\n    VIR_DEBUG(\"Getting link info on %s is not implemented on this platform\",\n              ifname);\n    lnk->speed = lnk->state = 0;\n    return 0;\n}",
    "includes": [
      "# include <linux/devlink.h>",
      "# include <net/if_dl.h>",
      "# include <sys/sockio.h>",
      "# include <linux/ethtool.h>",
      "# include <linux/types.h>",
      "# include <linux/if_vlan.h>",
      "# include <linux/sockios.h>",
      "#include <fcntl.h>",
      "# include <sys/ioctl.h>",
      "#include \"virjson.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virpci.h\"",
      "#include \"vircommand.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetlink.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetdev.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Getting link info on %s is not implemented on this platform\"",
            "ifname"
          ],
          "line": 2520
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint\nvirNetDevGetLinkInfo(const char *ifname,\n                     virNetDevIfLinkPtr lnk)\n{\n    /* Port me */\n    VIR_DEBUG(\"Getting link info on %s is not implemented on this platform\",\n              ifname);\n    lnk->speed = lnk->state = 0;\n    return 0;\n}"
  },
  {
    "function_name": "virNetDevGetLinkInfo",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
    "lines": "2427-2511",
    "snippet": "int\nvirNetDevGetLinkInfo(const char *ifname,\n                     virNetDevIfLinkPtr lnk)\n{\n    int ret = -1;\n    char *path = NULL;\n    char *buf = NULL;\n    char *tmp;\n    int tmp_state;\n    unsigned int tmp_speed;\n\n    if (virNetDevSysfsFile(&path, ifname, \"operstate\") < 0)\n        goto cleanup;\n\n    if (virFileReadAll(path, 1024, &buf) < 0) {\n        virReportSystemError(errno,\n                             _(\"unable to read: %s\"),\n                             path);\n        goto cleanup;\n    }\n\n    if (!(tmp = strchr(buf, '\\n'))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Unable to parse: %s\"),\n                       buf);\n        goto cleanup;\n    }\n\n    *tmp = '\\0';\n\n    /* We shouldn't allow 0 here, because\n     * virInterfaceState enum starts from 1. */\n    if ((tmp_state = virNetDevIfStateTypeFromString(buf)) <= 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Unable to parse: %s\"),\n                       buf);\n        goto cleanup;\n    }\n\n    lnk->state = tmp_state;\n\n    /* Shortcut to avoid some kernel issues. If link is not up several drivers\n     * report several misleading values. While igb reports 65535, realtek goes\n     * with 10. To avoid muddying XML with insane values, don't report link\n     * speed if that's the case. */\n    if (lnk->state != VIR_NETDEV_IF_STATE_UP) {\n        lnk->speed = 0;\n        ret = 0;\n        goto cleanup;\n    }\n\n    VIR_FREE(path);\n    VIR_FREE(buf);\n\n    if (virNetDevSysfsFile(&path, ifname, \"speed\") < 0)\n        goto cleanup;\n\n    if (virFileReadAllQuiet(path, 1024, &buf) < 0) {\n        /* Some devices doesn't report speed, in which case we get EINVAL */\n        if (errno == EINVAL) {\n            ret = 0;\n            goto cleanup;\n        }\n        virReportSystemError(errno,\n                             _(\"unable to read: %s\"),\n                             path);\n        goto cleanup;\n    }\n\n    if (virStrToLong_ui(buf, &tmp, 10, &tmp_speed) < 0 ||\n        *tmp != '\\n') {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Unable to parse: %s\"),\n                       buf);\n        goto cleanup;\n    }\n\n    lnk->speed = tmp_speed;\n\n    ret = 0;\n cleanup:\n    VIR_FREE(buf);\n    VIR_FREE(path);\n    return ret;\n}",
    "includes": [
      "# include <linux/devlink.h>",
      "# include <net/if_dl.h>",
      "# include <sys/sockio.h>",
      "# include <linux/ethtool.h>",
      "# include <linux/types.h>",
      "# include <linux/if_vlan.h>",
      "# include <linux/sockios.h>",
      "#include <fcntl.h>",
      "# include <sys/ioctl.h>",
      "#include \"virjson.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virpci.h\"",
      "#include \"vircommand.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetlink.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetdev.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "path"
          ],
          "line": 2509
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "buf"
          ],
          "line": 2508
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Unable to parse: %s\")",
            "buf"
          ],
          "line": 2498
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to parse: %s\""
          ],
          "line": 2499
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStrToLong_ui",
          "args": [
            "buf",
            "&tmp",
            "10",
            "&tmp_speed"
          ],
          "line": 2496
        },
        "resolved": true,
        "details": {
          "function_name": "virStrToLong_uip",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "444-461",
          "snippet": "int\nvirStrToLong_uip(char const *s, char **end_ptr, int base, unsigned int *result)\n{\n    unsigned long int val;\n    char *p;\n    bool err = false;\n\n    errno = 0;\n    val = strtoul(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s || (unsigned int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToLong_uip(char const *s, char **end_ptr, int base, unsigned int *result)\n{\n    unsigned long int val;\n    char *p;\n    bool err = false;\n\n    errno = 0;\n    val = strtoul(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s || (unsigned int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"unable to read: %s\")",
            "path"
          ],
          "line": 2490
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virFileReadAllQuiet",
          "args": [
            "path",
            "1024",
            "&buf"
          ],
          "line": 2484
        },
        "resolved": true,
        "details": {
          "function_name": "virFileReadAllQuiet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1459-1472",
          "snippet": "int\nvirFileReadAllQuiet(const char *path, int maxlen, char **buf)\n{\n    int fd = open(path, O_RDONLY);\n    if (fd < 0)\n        return -errno;\n\n    int len = virFileReadLimFD(fd, maxlen, buf);\n    VIR_FORCE_CLOSE(fd);\n    if (len < 0)\n        return -errno;\n\n    return len;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileReadAllQuiet(const char *path, int maxlen, char **buf)\n{\n    int fd = open(path, O_RDONLY);\n    if (fd < 0)\n        return -errno;\n\n    int len = virFileReadLimFD(fd, maxlen, buf);\n    VIR_FORCE_CLOSE(fd);\n    if (len < 0)\n        return -errno;\n\n    return len;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetDevSysfsFile",
          "args": [
            "&path",
            "ifname",
            "\"speed\""
          ],
          "line": 2481
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevSysfsFile",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
          "lines": "1524-1532",
          "snippet": "int\nvirNetDevSysfsFile(char **pf_sysfs_device_link G_GNUC_UNUSED,\n                   const char *ifname G_GNUC_UNUSED,\n                   const char *file G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to get sysfs info on this platform\"));\n    return -1;\n}",
          "includes": [
            "# include <linux/devlink.h>",
            "# include <net/if_dl.h>",
            "# include <sys/sockio.h>",
            "# include <linux/ethtool.h>",
            "# include <linux/types.h>",
            "# include <linux/if_vlan.h>",
            "# include <linux/sockios.h>",
            "#include <fcntl.h>",
            "# include <sys/ioctl.h>",
            "#include \"virjson.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virpci.h\"",
            "#include \"vircommand.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetlink.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetdev.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint\nvirNetDevSysfsFile(char **pf_sysfs_device_link G_GNUC_UNUSED,\n                   const char *ifname G_GNUC_UNUSED,\n                   const char *file G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to get sysfs info on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "buf"
          ],
          "line": 2479
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "path"
          ],
          "line": 2478
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Unable to parse: %s\")",
            "buf"
          ],
          "line": 2460
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNetDevIfStateTypeFromString",
          "args": [
            "buf"
          ],
          "line": 2459
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Unable to parse: %s\")",
            "buf"
          ],
          "line": 2449
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "buf",
            "'\\n'"
          ],
          "line": 2448
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"unable to read: %s\")",
            "path"
          ],
          "line": 2442
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint\nvirNetDevGetLinkInfo(const char *ifname,\n                     virNetDevIfLinkPtr lnk)\n{\n    int ret = -1;\n    char *path = NULL;\n    char *buf = NULL;\n    char *tmp;\n    int tmp_state;\n    unsigned int tmp_speed;\n\n    if (virNetDevSysfsFile(&path, ifname, \"operstate\") < 0)\n        goto cleanup;\n\n    if (virFileReadAll(path, 1024, &buf) < 0) {\n        virReportSystemError(errno,\n                             _(\"unable to read: %s\"),\n                             path);\n        goto cleanup;\n    }\n\n    if (!(tmp = strchr(buf, '\\n'))) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Unable to parse: %s\"),\n                       buf);\n        goto cleanup;\n    }\n\n    *tmp = '\\0';\n\n    /* We shouldn't allow 0 here, because\n     * virInterfaceState enum starts from 1. */\n    if ((tmp_state = virNetDevIfStateTypeFromString(buf)) <= 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Unable to parse: %s\"),\n                       buf);\n        goto cleanup;\n    }\n\n    lnk->state = tmp_state;\n\n    /* Shortcut to avoid some kernel issues. If link is not up several drivers\n     * report several misleading values. While igb reports 65535, realtek goes\n     * with 10. To avoid muddying XML with insane values, don't report link\n     * speed if that's the case. */\n    if (lnk->state != VIR_NETDEV_IF_STATE_UP) {\n        lnk->speed = 0;\n        ret = 0;\n        goto cleanup;\n    }\n\n    VIR_FREE(path);\n    VIR_FREE(buf);\n\n    if (virNetDevSysfsFile(&path, ifname, \"speed\") < 0)\n        goto cleanup;\n\n    if (virFileReadAllQuiet(path, 1024, &buf) < 0) {\n        /* Some devices doesn't report speed, in which case we get EINVAL */\n        if (errno == EINVAL) {\n            ret = 0;\n            goto cleanup;\n        }\n        virReportSystemError(errno,\n                             _(\"unable to read: %s\"),\n                             path);\n        goto cleanup;\n    }\n\n    if (virStrToLong_ui(buf, &tmp, 10, &tmp_speed) < 0 ||\n        *tmp != '\\n') {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Unable to parse: %s\"),\n                       buf);\n        goto cleanup;\n    }\n\n    lnk->speed = tmp_speed;\n\n    ret = 0;\n cleanup:\n    VIR_FREE(buf);\n    VIR_FREE(path);\n    return ret;\n}"
  },
  {
    "function_name": "virNetDevSetNetConfig",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
    "lines": "2384-2395",
    "snippet": "int\nvirNetDevSetNetConfig(const char *linkdev G_GNUC_UNUSED,\n                      int vf G_GNUC_UNUSED,\n                      const virMacAddr *adminMAC G_GNUC_UNUSED,\n                      const virNetDevVlan *vlan G_GNUC_UNUSED,\n                      const virMacAddr *MAC G_GNUC_UNUSED,\n                      bool setVlan G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to set net device config on this platform\"));\n    return -1;\n}",
    "includes": [
      "# include <linux/devlink.h>",
      "# include <net/if_dl.h>",
      "# include <sys/sockio.h>",
      "# include <linux/ethtool.h>",
      "# include <linux/types.h>",
      "# include <linux/if_vlan.h>",
      "# include <linux/sockios.h>",
      "#include <fcntl.h>",
      "# include <sys/ioctl.h>",
      "#include \"virjson.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virpci.h\"",
      "#include \"vircommand.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetlink.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetdev.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "\"%s\"",
            "_(\"Unable to set net device config on this platform\")"
          ],
          "line": 2392
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to set net device config on this platform\""
          ],
          "line": 2393
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint\nvirNetDevSetNetConfig(const char *linkdev G_GNUC_UNUSED,\n                      int vf G_GNUC_UNUSED,\n                      const virMacAddr *adminMAC G_GNUC_UNUSED,\n                      const virNetDevVlan *vlan G_GNUC_UNUSED,\n                      const virMacAddr *MAC G_GNUC_UNUSED,\n                      bool setVlan G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to set net device config on this platform\"));\n    return -1;\n}"
  },
  {
    "function_name": "virNetDevReadNetConfig",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
    "lines": "2370-2381",
    "snippet": "int\nvirNetDevReadNetConfig(const char *linkdev G_GNUC_UNUSED,\n                       int vf G_GNUC_UNUSED,\n                       const char *stateDir G_GNUC_UNUSED,\n                       virMacAddrPtr *adminMAC G_GNUC_UNUSED,\n                       virNetDevVlanPtr *vlan G_GNUC_UNUSED,\n                       virMacAddrPtr *MAC G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to read net device config on this platform\"));\n    return -1;\n}",
    "includes": [
      "# include <linux/devlink.h>",
      "# include <net/if_dl.h>",
      "# include <sys/sockio.h>",
      "# include <linux/ethtool.h>",
      "# include <linux/types.h>",
      "# include <linux/if_vlan.h>",
      "# include <linux/sockios.h>",
      "#include <fcntl.h>",
      "# include <sys/ioctl.h>",
      "#include \"virjson.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virpci.h\"",
      "#include \"vircommand.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetlink.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetdev.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "\"%s\"",
            "_(\"Unable to read net device config on this platform\")"
          ],
          "line": 2378
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to read net device config on this platform\""
          ],
          "line": 2379
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint\nvirNetDevReadNetConfig(const char *linkdev G_GNUC_UNUSED,\n                       int vf G_GNUC_UNUSED,\n                       const char *stateDir G_GNUC_UNUSED,\n                       virMacAddrPtr *adminMAC G_GNUC_UNUSED,\n                       virNetDevVlanPtr *vlan G_GNUC_UNUSED,\n                       virMacAddrPtr *MAC G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to read net device config on this platform\"));\n    return -1;\n}"
  },
  {
    "function_name": "virNetDevSaveNetConfig",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
    "lines": "2358-2367",
    "snippet": "int\nvirNetDevSaveNetConfig(const char *linkdev G_GNUC_UNUSED,\n                       int vf G_GNUC_UNUSED,\n                       const char *stateDir G_GNUC_UNUSED,\n                       bool saveVlan G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to save net device config on this platform\"));\n    return -1;\n}",
    "includes": [
      "# include <linux/devlink.h>",
      "# include <net/if_dl.h>",
      "# include <sys/sockio.h>",
      "# include <linux/ethtool.h>",
      "# include <linux/types.h>",
      "# include <linux/if_vlan.h>",
      "# include <linux/sockios.h>",
      "#include <fcntl.h>",
      "# include <sys/ioctl.h>",
      "#include \"virjson.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virpci.h\"",
      "#include \"vircommand.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetlink.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetdev.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "\"%s\"",
            "_(\"Unable to save net device config on this platform\")"
          ],
          "line": 2364
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to save net device config on this platform\""
          ],
          "line": 2365
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint\nvirNetDevSaveNetConfig(const char *linkdev G_GNUC_UNUSED,\n                       int vf G_GNUC_UNUSED,\n                       const char *stateDir G_GNUC_UNUSED,\n                       bool saveVlan G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to save net device config on this platform\"));\n    return -1;\n}"
  },
  {
    "function_name": "virNetDevSetNetConfig",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
    "lines": "2162-2352",
    "snippet": "int\nvirNetDevSetNetConfig(const char *linkdev, int vf,\n                      const virMacAddr *adminMAC,\n                      const virNetDevVlan *vlan,\n                      const virMacAddr *MAC,\n                      bool setVlan)\n{\n    int ret = -1;\n    char MACStr[VIR_MAC_STRING_BUFLEN];\n    const char *pfDevName = NULL;\n    char *pfDevOrig = NULL;\n    char *vfDevOrig = NULL;\n    int vlanTag = -1;\n    virPCIDevicePtr vfPCIDevice = NULL;\n\n    if (vf >= 0) {\n        /* linkdev is the PF */\n        pfDevName = linkdev;\n\n        /* linkdev should get the VF's netdev name (or NULL if none) */\n        if (virNetDevPFGetVF(pfDevName, vf, &vfDevOrig) < 0)\n            goto cleanup;\n\n        linkdev = vfDevOrig;\n\n    } else if (virNetDevIsVirtualFunction(linkdev) == 1) {\n        /* when vf is -1, linkdev might be a standard netdevice (not\n         * SRIOV), or it might be an SRIOV VF. If it's a VF, normalize\n         * it to PF + VFname\n         */\n\n        if (virNetDevGetVirtualFunctionInfo(linkdev, &pfDevOrig, &vf))\n            goto cleanup;\n        pfDevName = pfDevOrig;\n    }\n\n\n    if (!pfDevName) {\n        /* if it's not SRIOV, then we can't set the admin MAC address\n         * or vlan tag\n         */\n        if (adminMAC) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                           _(\"admin MAC can only be set for SR-IOV VFs, but \"\n                             \"%s is not a VF\"), linkdev);\n            goto cleanup;\n        }\n\n        if (vlan) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                           _(\"vlan can only be set for SR-IOV VFs, but \"\n                             \"%s is not a VF\"), linkdev);\n            goto cleanup;\n        }\n\n    } else {\n        if (vlan) {\n            if (vlan->nTags != 1 || vlan->trunk) {\n                virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                               _(\"vlan trunking is not supported \"\n                                 \"by SR-IOV network devices\"));\n                goto cleanup;\n            }\n\n            if (!setVlan) {\n                virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                               _(\"vlan tag set for interface %s but \"\n                                 \"caller requested it not be set\"));\n                goto cleanup;\n            }\n\n            vlanTag = vlan->tag[0];\n\n        } else if (setVlan) {\n            vlanTag = 0; /* assure any existing vlan tag is reset */\n        }\n    }\n\n    if (MAC) {\n        int setMACrc;\n\n        if (!linkdev) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"VF %d of PF '%s' is not bound to a net driver, \"\n                             \"so its MAC address cannot be set to %s\"),\n                           vf, pfDevName, virMacAddrFormat(MAC, MACStr));\n            goto cleanup;\n        }\n\n        setMACrc = virNetDevSetMACInternal(linkdev, MAC, !!pfDevOrig);\n        if (setMACrc < 0) {\n            bool allowRetry = false;\n            int retries = 100;\n\n            /* if pfDevOrig == NULL, this isn't a VF, so we've failed */\n            if (!pfDevOrig ||\n                (errno != EADDRNOTAVAIL && errno != EPERM))\n                goto cleanup;\n\n            /* Otherwise this is a VF, and virNetDevSetMAC failed with\n             * EADDRNOTAVAIL/EPERM, which could be due to the\n             * \"administratively set\" flag being set in the PF for\n             * this VF.  When this happens, we can attempt to use an\n             * alternate method to set the VF MAC: first set it into\n             * the admin MAC for this VF in the PF, then unbind/rebind\n             * the VF from its net driver. This causes the VF's MAC to\n             * be initialized to whatever was stored in the admin MAC.\n             */\n\n            if (virNetDevSetVfConfig(pfDevName, vf,\n                                     MAC, vlanTag, &allowRetry) < 0) {\n                goto cleanup;\n            }\n\n            /* admin MAC is set, now we need to construct a virPCIDevice\n             * object so we can call virPCIDeviceRebind()\n             */\n            if (!(vfPCIDevice = virNetDevGetPCIDevice(linkdev)))\n                goto cleanup;\n\n            /* Rebind the device. This should set the proper MAC address */\n            if (virPCIDeviceRebind(vfPCIDevice) < 0)\n                goto cleanup;\n\n            /* Wait until virNetDevGetIndex for the VF netdev returns success.\n             * This indicates that the device is ready to be used. If we don't\n             * wait, then upcoming operations on the VF may fail.\n             */\n            while (retries-- > 0 && !virNetDevExists(linkdev))\n               g_usleep(1000);\n        }\n\n        if (pfDevOrig && setMACrc == 0) {\n            /* if pfDevOrig is set, it that the caller was *really*\n             * only interested in setting the MAC of the VF itself,\n             * *not* the admin MAC via the PF. In those cases, the\n             * adminMAC was only provided in case we need to set the\n             * VF's MAC by temporarily unbinding/rebinding the VF's\n             * net driver with the admin MAC set to the desired MAC,\n             * and then want to restore the admin MAC to its original\n             * setting when we're finished. We would only need to do\n             * that if the virNetDevSetMAC() above had failed; since\n             * setMACrc == 0, we know it didn't fail and we don't need\n             * to set the adminMAC, so we are NULLing it out here to\n             * avoid that below.\n\n             * (NB: since setting the admin MAC sets the\n             * \"administratively set\" flag for the VF in the PF's\n             * driver, which prevents any future changes to the VF's\n             * MAC address, we want to avoid setting the admin MAC as\n             * much as possible.)\n             */\n            adminMAC = NULL;\n        }\n    }\n\n    if (adminMAC || vlanTag >= 0) {\n        /* Set vlanTag and admin MAC using an RTM_SETLINK request sent to\n         * PFdevname+VF#, if mac != NULL this will set the \"admin MAC\" via\n         * the PF, *not* the actual VF MAC - the admin MAC only takes\n         * effect the next time the VF's driver is initialized (either in\n         * guest or host). if there is a vlanTag to set, it will take\n         * effect immediately though.\n         */\n        bool allowRetry = true;\n\n        if (virNetDevSetVfConfig(pfDevName, vf,\n                                 adminMAC, vlanTag, &allowRetry) < 0) {\n            /* allowRetry will still be true if the failure was due to\n             * trying to set the MAC address to all 0. In that case,\n             * we can retry with \"altZeroMAC\", which is just an all-0 MAC\n             * with the \"locally administered\" bit set.\n             */\n            if (!allowRetry)\n                goto cleanup;\n\n            allowRetry = false;\n            if (virNetDevSetVfConfig(pfDevName, vf,\n                                     &altZeroMAC, vlanTag, &allowRetry) < 0) {\n                goto cleanup;\n            }\n        }\n    }\n\n    ret = 0;\n cleanup:\n    VIR_FREE(pfDevOrig);\n    VIR_FREE(vfDevOrig);\n    virPCIDeviceFree(vfPCIDevice);\n    return ret;\n}",
    "includes": [
      "# include <linux/devlink.h>",
      "# include <net/if_dl.h>",
      "# include <sys/sockio.h>",
      "# include <linux/ethtool.h>",
      "# include <linux/types.h>",
      "# include <linux/if_vlan.h>",
      "# include <linux/sockios.h>",
      "#include <fcntl.h>",
      "# include <sys/ioctl.h>",
      "#include \"virjson.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virpci.h\"",
      "#include \"vircommand.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetlink.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetdev.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virPCIDeviceFree",
          "args": [
            "vfPCIDevice"
          ],
          "line": 2350
        },
        "resolved": true,
        "details": {
          "function_name": "virPCIDeviceFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virpci.c",
          "lines": "1439-1450",
          "snippet": "void\nvirPCIDeviceFree(virPCIDevicePtr dev)\n{\n    if (!dev)\n        return;\n    VIR_DEBUG(\"%s %s: freeing\", dev->id, dev->name);\n    VIR_FREE(dev->name);\n    VIR_FREE(dev->path);\n    VIR_FREE(dev->used_by_drvname);\n    VIR_FREE(dev->used_by_domname);\n    VIR_FREE(dev);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <inttypes.h>",
            "#include <fcntl.h>",
            "#include <dirent.h>",
            "#include \"virnetdev.h\"",
            "#include \"virpci.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <inttypes.h>\n#include <fcntl.h>\n#include <dirent.h>\n#include \"virnetdev.h\"\n#include \"virpci.h\"\n#include <config.h>\n\nvoid\nvirPCIDeviceFree(virPCIDevicePtr dev)\n{\n    if (!dev)\n        return;\n    VIR_DEBUG(\"%s %s: freeing\", dev->id, dev->name);\n    VIR_FREE(dev->name);\n    VIR_FREE(dev->path);\n    VIR_FREE(dev->used_by_drvname);\n    VIR_FREE(dev->used_by_domname);\n    VIR_FREE(dev);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "vfDevOrig"
          ],
          "line": 2349
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "pfDevOrig"
          ],
          "line": 2348
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNetDevSetVfConfig",
          "args": [
            "pfDevName",
            "vf",
            "&altZeroMAC",
            "vlanTag",
            "&allowRetry"
          ],
          "line": 2339
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevSetVfConfig",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
          "lines": "1555-1686",
          "snippet": "static int\nvirNetDevSetVfConfig(const char *ifname, int vf,\n                     const virMacAddr *macaddr, int vlanid,\n                     bool *allowRetry)\n{\n    int rc = -1;\n    char macstr[VIR_MAC_STRING_BUFLEN];\n    struct nlmsghdr *resp = NULL;\n    struct nlmsgerr *err;\n    unsigned int recvbuflen = 0;\n    struct nl_msg *nl_msg;\n    struct nlattr *vfinfolist, *vfinfo;\n    struct ifinfomsg ifinfo = {\n        .ifi_family = AF_UNSPEC,\n        .ifi_index  = -1,\n    };\n\n    if (!macaddr && vlanid < 0)\n        return -1;\n\n    nl_msg = nlmsg_alloc_simple(RTM_SETLINK, NLM_F_REQUEST);\n    if (!nl_msg) {\n        virReportOOMError();\n        return rc;\n    }\n\n    if (nlmsg_append(nl_msg,  &ifinfo, sizeof(ifinfo), NLMSG_ALIGNTO) < 0)\n        goto buffer_too_small;\n\n    if (ifname &&\n        nla_put(nl_msg, IFLA_IFNAME, strlen(ifname)+1, ifname) < 0)\n        goto buffer_too_small;\n\n\n    if (!(vfinfolist = nla_nest_start(nl_msg, IFLA_VFINFO_LIST)))\n        goto buffer_too_small;\n\n    if (!(vfinfo = nla_nest_start(nl_msg, IFLA_VF_INFO)))\n        goto buffer_too_small;\n\n    if (macaddr) {\n        struct ifla_vf_mac ifla_vf_mac = {\n             .vf = vf,\n             .mac = { 0, },\n        };\n\n        virMacAddrGetRaw(macaddr, ifla_vf_mac.mac);\n\n        if (nla_put(nl_msg, IFLA_VF_MAC, sizeof(ifla_vf_mac),\n                    &ifla_vf_mac) < 0)\n            goto buffer_too_small;\n    }\n\n    if (vlanid >= 0) {\n        struct ifla_vf_vlan ifla_vf_vlan = {\n             .vf = vf,\n             .vlan = vlanid,\n             .qos = 0,\n        };\n\n        if (nla_put(nl_msg, IFLA_VF_VLAN, sizeof(ifla_vf_vlan),\n                    &ifla_vf_vlan) < 0)\n            goto buffer_too_small;\n    }\n\n    nla_nest_end(nl_msg, vfinfo);\n    nla_nest_end(nl_msg, vfinfolist);\n\n    if (virNetlinkCommand(nl_msg, &resp, &recvbuflen, 0, 0,\n                          NETLINK_ROUTE, 0) < 0)\n        goto cleanup;\n\n    if (recvbuflen < NLMSG_LENGTH(0) || resp == NULL)\n        goto malformed_resp;\n\n    switch (resp->nlmsg_type) {\n    case NLMSG_ERROR:\n        err = (struct nlmsgerr *)NLMSG_DATA(resp);\n        if (resp->nlmsg_len < NLMSG_LENGTH(sizeof(*err)))\n            goto malformed_resp;\n\n        /* if allowRetry is true and the error was EINVAL, then\n         * silently return a failure so the caller can retry with a\n         * different MAC address\n         */\n        if (err->error == -EINVAL && *allowRetry &&\n            macaddr && !virMacAddrCmp(macaddr, &zeroMAC)) {\n            goto cleanup;\n        } else if (err->error) {\n            /* other errors are permanent */\n            virReportSystemError(-err->error,\n                                 _(\"Cannot set interface MAC/vlanid to %s/%d \"\n                                   \"for ifname %s vf %d\"),\n                                 (macaddr\n                                  ? virMacAddrFormat(macaddr, macstr)\n                                  : \"(unchanged)\"),\n                                 vlanid,\n                                 ifname ? ifname : \"(unspecified)\",\n                                 vf);\n            *allowRetry = false; /* no use retrying */\n            goto cleanup;\n        }\n        break;\n\n    case NLMSG_DONE:\n        break;\n\n    default:\n        goto malformed_resp;\n    }\n\n    rc = 0;\n cleanup:\n    VIR_DEBUG(\"RTM_SETLINK %s vf %d MAC=%s vlanid=%d - %s\",\n              ifname, vf,\n              macaddr ? virMacAddrFormat(macaddr, macstr) : \"(unchanged)\",\n              vlanid, rc < 0 ? \"Fail\" : \"Success\");\n\n    nlmsg_free(nl_msg);\n    VIR_FREE(resp);\n    return rc;\n\n malformed_resp:\n    virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                   _(\"malformed netlink response message\"));\n    goto cleanup;\n\n buffer_too_small:\n    virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                   _(\"allocated netlink buffer is too small\"));\n    goto cleanup;\n}",
          "includes": [
            "# include <linux/devlink.h>",
            "# include <net/if_dl.h>",
            "# include <sys/sockio.h>",
            "# include <linux/ethtool.h>",
            "# include <linux/types.h>",
            "# include <linux/if_vlan.h>",
            "# include <linux/sockios.h>",
            "#include <fcntl.h>",
            "# include <sys/ioctl.h>",
            "#include \"virjson.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virpci.h\"",
            "#include \"vircommand.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetlink.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetdev.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nstatic int\nvirNetDevSetVfConfig(const char *ifname, int vf,\n                     const virMacAddr *macaddr, int vlanid,\n                     bool *allowRetry)\n{\n    int rc = -1;\n    char macstr[VIR_MAC_STRING_BUFLEN];\n    struct nlmsghdr *resp = NULL;\n    struct nlmsgerr *err;\n    unsigned int recvbuflen = 0;\n    struct nl_msg *nl_msg;\n    struct nlattr *vfinfolist, *vfinfo;\n    struct ifinfomsg ifinfo = {\n        .ifi_family = AF_UNSPEC,\n        .ifi_index  = -1,\n    };\n\n    if (!macaddr && vlanid < 0)\n        return -1;\n\n    nl_msg = nlmsg_alloc_simple(RTM_SETLINK, NLM_F_REQUEST);\n    if (!nl_msg) {\n        virReportOOMError();\n        return rc;\n    }\n\n    if (nlmsg_append(nl_msg,  &ifinfo, sizeof(ifinfo), NLMSG_ALIGNTO) < 0)\n        goto buffer_too_small;\n\n    if (ifname &&\n        nla_put(nl_msg, IFLA_IFNAME, strlen(ifname)+1, ifname) < 0)\n        goto buffer_too_small;\n\n\n    if (!(vfinfolist = nla_nest_start(nl_msg, IFLA_VFINFO_LIST)))\n        goto buffer_too_small;\n\n    if (!(vfinfo = nla_nest_start(nl_msg, IFLA_VF_INFO)))\n        goto buffer_too_small;\n\n    if (macaddr) {\n        struct ifla_vf_mac ifla_vf_mac = {\n             .vf = vf,\n             .mac = { 0, },\n        };\n\n        virMacAddrGetRaw(macaddr, ifla_vf_mac.mac);\n\n        if (nla_put(nl_msg, IFLA_VF_MAC, sizeof(ifla_vf_mac),\n                    &ifla_vf_mac) < 0)\n            goto buffer_too_small;\n    }\n\n    if (vlanid >= 0) {\n        struct ifla_vf_vlan ifla_vf_vlan = {\n             .vf = vf,\n             .vlan = vlanid,\n             .qos = 0,\n        };\n\n        if (nla_put(nl_msg, IFLA_VF_VLAN, sizeof(ifla_vf_vlan),\n                    &ifla_vf_vlan) < 0)\n            goto buffer_too_small;\n    }\n\n    nla_nest_end(nl_msg, vfinfo);\n    nla_nest_end(nl_msg, vfinfolist);\n\n    if (virNetlinkCommand(nl_msg, &resp, &recvbuflen, 0, 0,\n                          NETLINK_ROUTE, 0) < 0)\n        goto cleanup;\n\n    if (recvbuflen < NLMSG_LENGTH(0) || resp == NULL)\n        goto malformed_resp;\n\n    switch (resp->nlmsg_type) {\n    case NLMSG_ERROR:\n        err = (struct nlmsgerr *)NLMSG_DATA(resp);\n        if (resp->nlmsg_len < NLMSG_LENGTH(sizeof(*err)))\n            goto malformed_resp;\n\n        /* if allowRetry is true and the error was EINVAL, then\n         * silently return a failure so the caller can retry with a\n         * different MAC address\n         */\n        if (err->error == -EINVAL && *allowRetry &&\n            macaddr && !virMacAddrCmp(macaddr, &zeroMAC)) {\n            goto cleanup;\n        } else if (err->error) {\n            /* other errors are permanent */\n            virReportSystemError(-err->error,\n                                 _(\"Cannot set interface MAC/vlanid to %s/%d \"\n                                   \"for ifname %s vf %d\"),\n                                 (macaddr\n                                  ? virMacAddrFormat(macaddr, macstr)\n                                  : \"(unchanged)\"),\n                                 vlanid,\n                                 ifname ? ifname : \"(unspecified)\",\n                                 vf);\n            *allowRetry = false; /* no use retrying */\n            goto cleanup;\n        }\n        break;\n\n    case NLMSG_DONE:\n        break;\n\n    default:\n        goto malformed_resp;\n    }\n\n    rc = 0;\n cleanup:\n    VIR_DEBUG(\"RTM_SETLINK %s vf %d MAC=%s vlanid=%d - %s\",\n              ifname, vf,\n              macaddr ? virMacAddrFormat(macaddr, macstr) : \"(unchanged)\",\n              vlanid, rc < 0 ? \"Fail\" : \"Success\");\n\n    nlmsg_free(nl_msg);\n    VIR_FREE(resp);\n    return rc;\n\n malformed_resp:\n    virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                   _(\"malformed netlink response message\"));\n    goto cleanup;\n\n buffer_too_small:\n    virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                   _(\"allocated netlink buffer is too small\"));\n    goto cleanup;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_usleep",
          "args": [
            "1000"
          ],
          "line": 2291
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNetDevExists",
          "args": [
            "linkdev"
          ],
          "line": 2290
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevExists",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
          "lines": "218-223",
          "snippet": "int virNetDevExists(const char *ifname)\n{\n    virReportSystemError(ENOSYS,\n                         _(\"Unable to check interface %s\"), ifname);\n    return -1;\n}",
          "includes": [
            "# include <linux/devlink.h>",
            "# include <net/if_dl.h>",
            "# include <sys/sockio.h>",
            "# include <linux/ethtool.h>",
            "# include <linux/types.h>",
            "# include <linux/if_vlan.h>",
            "# include <linux/sockios.h>",
            "#include <fcntl.h>",
            "# include <sys/ioctl.h>",
            "#include \"virjson.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virpci.h\"",
            "#include \"vircommand.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetlink.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetdev.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint virNetDevExists(const char *ifname)\n{\n    virReportSystemError(ENOSYS,\n                         _(\"Unable to check interface %s\"), ifname);\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virPCIDeviceRebind",
          "args": [
            "vfPCIDevice"
          ],
          "line": 2283
        },
        "resolved": true,
        "details": {
          "function_name": "virPCIDeviceRebind",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virpci.c",
          "lines": "1080-1093",
          "snippet": "int virPCIDeviceRebind(virPCIDevicePtr dev)\n{\n    if (virPCIDeviceUnbind(dev) < 0)\n        return -1;\n\n    if (virFileWriteStr(PCI_SYSFS \"drivers_probe\", dev->name, 0) < 0) {\n        virReportSystemError(errno,\n                             _(\"Failed to trigger a probe for PCI device '%s'\"),\n                             dev->name);\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <inttypes.h>",
            "#include <fcntl.h>",
            "#include <dirent.h>",
            "#include \"virnetdev.h\"",
            "#include \"virpci.h\"",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define PCI_SYSFS \"/sys/bus/pci/\""
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <inttypes.h>\n#include <fcntl.h>\n#include <dirent.h>\n#include \"virnetdev.h\"\n#include \"virpci.h\"\n#include <config.h>\n\n#define PCI_SYSFS \"/sys/bus/pci/\"\n\nint virPCIDeviceRebind(virPCIDevicePtr dev)\n{\n    if (virPCIDeviceUnbind(dev) < 0)\n        return -1;\n\n    if (virFileWriteStr(PCI_SYSFS \"drivers_probe\", dev->name, 0) < 0) {\n        virReportSystemError(errno,\n                             _(\"Failed to trigger a probe for PCI device '%s'\"),\n                             dev->name);\n        return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetDevGetPCIDevice",
          "args": [
            "linkdev"
          ],
          "line": 2279
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevGetPCIDevice",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
          "lines": "1119-1144",
          "snippet": "static virPCIDevicePtr\nvirNetDevGetPCIDevice(const char *devName)\n{\n    char *vfSysfsDevicePath = NULL;\n    virPCIDeviceAddressPtr vfPCIAddr = NULL;\n    virPCIDevicePtr vfPCIDevice = NULL;\n\n    if (virNetDevSysfsFile(&vfSysfsDevicePath, devName, \"device\") < 0)\n        goto cleanup;\n\n    if (!virNetDevIsPCIDevice(vfSysfsDevicePath))\n        goto cleanup;\n\n    vfPCIAddr = virPCIGetDeviceAddressFromSysfsLink(vfSysfsDevicePath);\n    if (!vfPCIAddr)\n        goto cleanup;\n\n    vfPCIDevice = virPCIDeviceNew(vfPCIAddr->domain, vfPCIAddr->bus,\n                                  vfPCIAddr->slot, vfPCIAddr->function);\n\n cleanup:\n    VIR_FREE(vfSysfsDevicePath);\n    VIR_FREE(vfPCIAddr);\n\n    return vfPCIDevice;\n}",
          "includes": [
            "# include <linux/devlink.h>",
            "# include <net/if_dl.h>",
            "# include <sys/sockio.h>",
            "# include <linux/ethtool.h>",
            "# include <linux/types.h>",
            "# include <linux/if_vlan.h>",
            "# include <linux/sockios.h>",
            "#include <fcntl.h>",
            "# include <sys/ioctl.h>",
            "#include \"virjson.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virpci.h\"",
            "#include \"vircommand.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetlink.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetdev.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nstatic virPCIDevicePtr\nvirNetDevGetPCIDevice(const char *devName)\n{\n    char *vfSysfsDevicePath = NULL;\n    virPCIDeviceAddressPtr vfPCIAddr = NULL;\n    virPCIDevicePtr vfPCIDevice = NULL;\n\n    if (virNetDevSysfsFile(&vfSysfsDevicePath, devName, \"device\") < 0)\n        goto cleanup;\n\n    if (!virNetDevIsPCIDevice(vfSysfsDevicePath))\n        goto cleanup;\n\n    vfPCIAddr = virPCIGetDeviceAddressFromSysfsLink(vfSysfsDevicePath);\n    if (!vfPCIAddr)\n        goto cleanup;\n\n    vfPCIDevice = virPCIDeviceNew(vfPCIAddr->domain, vfPCIAddr->bus,\n                                  vfPCIAddr->slot, vfPCIAddr->function);\n\n cleanup:\n    VIR_FREE(vfSysfsDevicePath);\n    VIR_FREE(vfPCIAddr);\n\n    return vfPCIDevice;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetDevSetMACInternal",
          "args": [
            "linkdev",
            "MAC",
            "!!pfDevOrig"
          ],
          "line": 2251
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevSetMACInternal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
          "lines": "331-340",
          "snippet": "static int\nvirNetDevSetMACInternal(const char *ifname,\n                        const virMacAddr *macaddr G_GNUC_UNUSED,\n                        bool quiet G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS,\n                         _(\"Cannot set interface MAC on '%s'\"),\n                         ifname);\n    return -1;\n}",
          "includes": [
            "# include <linux/devlink.h>",
            "# include <net/if_dl.h>",
            "# include <sys/sockio.h>",
            "# include <linux/ethtool.h>",
            "# include <linux/types.h>",
            "# include <linux/if_vlan.h>",
            "# include <linux/sockios.h>",
            "#include <fcntl.h>",
            "# include <sys/ioctl.h>",
            "#include \"virjson.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virpci.h\"",
            "#include \"vircommand.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetlink.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetdev.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nstatic int\nvirNetDevSetMACInternal(const char *ifname,\n                        const virMacAddr *macaddr G_GNUC_UNUSED,\n                        bool quiet G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS,\n                         _(\"Cannot set interface MAC on '%s'\"),\n                         ifname);\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"VF %d of PF '%s' is not bound to a net driver, \"\n                             \"so its MAC address cannot be set to %s\")",
            "vf",
            "pfDevName",
            "virMacAddrFormat(MAC, MACStr)"
          ],
          "line": 2244
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virMacAddrFormat",
          "args": [
            "MAC",
            "MACStr"
          ],
          "line": 2247
        },
        "resolved": true,
        "details": {
          "function_name": "virMacAddrFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virmacaddr.c",
          "lines": "184-194",
          "snippet": "const char *\nvirMacAddrFormat(const virMacAddr *addr,\n                 char *str)\n{\n    g_snprintf(str, VIR_MAC_STRING_BUFLEN,\n               \"%02x:%02x:%02x:%02x:%02x:%02x\",\n               addr->addr[0], addr->addr[1], addr->addr[2],\n               addr->addr[3], addr->addr[4], addr->addr[5]);\n    str[VIR_MAC_STRING_BUFLEN-1] = '\\0';\n    return str;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virrandom.h\"",
            "#include \"virmacaddr.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virrandom.h\"\n#include \"virmacaddr.h\"\n#include <config.h>\n\nconst char *\nvirMacAddrFormat(const virMacAddr *addr,\n                 char *str)\n{\n    g_snprintf(str, VIR_MAC_STRING_BUFLEN,\n               \"%02x:%02x:%02x:%02x:%02x:%02x\",\n               addr->addr[0], addr->addr[1], addr->addr[2],\n               addr->addr[3], addr->addr[4], addr->addr[5]);\n    str[VIR_MAC_STRING_BUFLEN-1] = '\\0';\n    return str;\n}"
        }
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"VF %d of PF '%s' is not bound to a net driver, \"\n                             \"so its MAC address cannot be set to %s\""
          ],
          "line": 2245
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"vlan tag set for interface %s but \"\n                                 \"caller requested it not be set\")"
          ],
          "line": 2227
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "\"%s\"",
            "_(\"vlan trunking is not supported \"\n                                 \"by SR-IOV network devices\")"
          ],
          "line": 2220
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "_(\"vlan can only be set for SR-IOV VFs, but \"\n                             \"%s is not a VF\")",
            "linkdev"
          ],
          "line": 2211
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "_(\"admin MAC can only be set for SR-IOV VFs, but \"\n                             \"%s is not a VF\")",
            "linkdev"
          ],
          "line": 2204
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNetDevGetVirtualFunctionInfo",
          "args": [
            "linkdev",
            "&pfDevOrig",
            "&vf"
          ],
          "line": 2193
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevGetVirtualFunctionInfo",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
          "lines": "1514-1522",
          "snippet": "int\nvirNetDevGetVirtualFunctionInfo(const char *vfname G_GNUC_UNUSED,\n                                char **pfname G_GNUC_UNUSED,\n                                int *vf G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to get virtual function info on this platform\"));\n    return -1;\n}",
          "includes": [
            "# include <linux/devlink.h>",
            "# include <net/if_dl.h>",
            "# include <sys/sockio.h>",
            "# include <linux/ethtool.h>",
            "# include <linux/types.h>",
            "# include <linux/if_vlan.h>",
            "# include <linux/sockios.h>",
            "#include <fcntl.h>",
            "# include <sys/ioctl.h>",
            "#include \"virjson.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virpci.h\"",
            "#include \"vircommand.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetlink.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetdev.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint\nvirNetDevGetVirtualFunctionInfo(const char *vfname G_GNUC_UNUSED,\n                                char **pfname G_GNUC_UNUSED,\n                                int *vf G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to get virtual function info on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetDevIsVirtualFunction",
          "args": [
            "linkdev"
          ],
          "line": 2187
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevIsVirtualFunction",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
          "lines": "1477-1483",
          "snippet": "int\nvirNetDevIsVirtualFunction(const char *ifname G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to check virtual function status on this platform\"));\n    return -1;\n}",
          "includes": [
            "# include <linux/devlink.h>",
            "# include <net/if_dl.h>",
            "# include <sys/sockio.h>",
            "# include <linux/ethtool.h>",
            "# include <linux/types.h>",
            "# include <linux/if_vlan.h>",
            "# include <linux/sockios.h>",
            "#include <fcntl.h>",
            "# include <sys/ioctl.h>",
            "#include \"virjson.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virpci.h\"",
            "#include \"vircommand.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetlink.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetdev.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint\nvirNetDevIsVirtualFunction(const char *ifname G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to check virtual function status on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetDevPFGetVF",
          "args": [
            "pfDevName",
            "vf",
            "&vfDevOrig"
          ],
          "line": 2182
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevPFGetVF",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
          "lines": "1504-1512",
          "snippet": "int\nvirNetDevPFGetVF(const char *pfname G_GNUC_UNUSED,\n                 int vf G_GNUC_UNUSED,\n                 char **vfname G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to get virtual function name on this platform\"));\n    return -1;\n}",
          "includes": [
            "# include <linux/devlink.h>",
            "# include <net/if_dl.h>",
            "# include <sys/sockio.h>",
            "# include <linux/ethtool.h>",
            "# include <linux/types.h>",
            "# include <linux/if_vlan.h>",
            "# include <linux/sockios.h>",
            "#include <fcntl.h>",
            "# include <sys/ioctl.h>",
            "#include \"virjson.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virpci.h\"",
            "#include \"vircommand.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetlink.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetdev.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint\nvirNetDevPFGetVF(const char *pfname G_GNUC_UNUSED,\n                 int vf G_GNUC_UNUSED,\n                 char **vfname G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to get virtual function name on this platform\"));\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint\nvirNetDevSetNetConfig(const char *linkdev, int vf,\n                      const virMacAddr *adminMAC,\n                      const virNetDevVlan *vlan,\n                      const virMacAddr *MAC,\n                      bool setVlan)\n{\n    int ret = -1;\n    char MACStr[VIR_MAC_STRING_BUFLEN];\n    const char *pfDevName = NULL;\n    char *pfDevOrig = NULL;\n    char *vfDevOrig = NULL;\n    int vlanTag = -1;\n    virPCIDevicePtr vfPCIDevice = NULL;\n\n    if (vf >= 0) {\n        /* linkdev is the PF */\n        pfDevName = linkdev;\n\n        /* linkdev should get the VF's netdev name (or NULL if none) */\n        if (virNetDevPFGetVF(pfDevName, vf, &vfDevOrig) < 0)\n            goto cleanup;\n\n        linkdev = vfDevOrig;\n\n    } else if (virNetDevIsVirtualFunction(linkdev) == 1) {\n        /* when vf is -1, linkdev might be a standard netdevice (not\n         * SRIOV), or it might be an SRIOV VF. If it's a VF, normalize\n         * it to PF + VFname\n         */\n\n        if (virNetDevGetVirtualFunctionInfo(linkdev, &pfDevOrig, &vf))\n            goto cleanup;\n        pfDevName = pfDevOrig;\n    }\n\n\n    if (!pfDevName) {\n        /* if it's not SRIOV, then we can't set the admin MAC address\n         * or vlan tag\n         */\n        if (adminMAC) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                           _(\"admin MAC can only be set for SR-IOV VFs, but \"\n                             \"%s is not a VF\"), linkdev);\n            goto cleanup;\n        }\n\n        if (vlan) {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                           _(\"vlan can only be set for SR-IOV VFs, but \"\n                             \"%s is not a VF\"), linkdev);\n            goto cleanup;\n        }\n\n    } else {\n        if (vlan) {\n            if (vlan->nTags != 1 || vlan->trunk) {\n                virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                               _(\"vlan trunking is not supported \"\n                                 \"by SR-IOV network devices\"));\n                goto cleanup;\n            }\n\n            if (!setVlan) {\n                virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                               _(\"vlan tag set for interface %s but \"\n                                 \"caller requested it not be set\"));\n                goto cleanup;\n            }\n\n            vlanTag = vlan->tag[0];\n\n        } else if (setVlan) {\n            vlanTag = 0; /* assure any existing vlan tag is reset */\n        }\n    }\n\n    if (MAC) {\n        int setMACrc;\n\n        if (!linkdev) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"VF %d of PF '%s' is not bound to a net driver, \"\n                             \"so its MAC address cannot be set to %s\"),\n                           vf, pfDevName, virMacAddrFormat(MAC, MACStr));\n            goto cleanup;\n        }\n\n        setMACrc = virNetDevSetMACInternal(linkdev, MAC, !!pfDevOrig);\n        if (setMACrc < 0) {\n            bool allowRetry = false;\n            int retries = 100;\n\n            /* if pfDevOrig == NULL, this isn't a VF, so we've failed */\n            if (!pfDevOrig ||\n                (errno != EADDRNOTAVAIL && errno != EPERM))\n                goto cleanup;\n\n            /* Otherwise this is a VF, and virNetDevSetMAC failed with\n             * EADDRNOTAVAIL/EPERM, which could be due to the\n             * \"administratively set\" flag being set in the PF for\n             * this VF.  When this happens, we can attempt to use an\n             * alternate method to set the VF MAC: first set it into\n             * the admin MAC for this VF in the PF, then unbind/rebind\n             * the VF from its net driver. This causes the VF's MAC to\n             * be initialized to whatever was stored in the admin MAC.\n             */\n\n            if (virNetDevSetVfConfig(pfDevName, vf,\n                                     MAC, vlanTag, &allowRetry) < 0) {\n                goto cleanup;\n            }\n\n            /* admin MAC is set, now we need to construct a virPCIDevice\n             * object so we can call virPCIDeviceRebind()\n             */\n            if (!(vfPCIDevice = virNetDevGetPCIDevice(linkdev)))\n                goto cleanup;\n\n            /* Rebind the device. This should set the proper MAC address */\n            if (virPCIDeviceRebind(vfPCIDevice) < 0)\n                goto cleanup;\n\n            /* Wait until virNetDevGetIndex for the VF netdev returns success.\n             * This indicates that the device is ready to be used. If we don't\n             * wait, then upcoming operations on the VF may fail.\n             */\n            while (retries-- > 0 && !virNetDevExists(linkdev))\n               g_usleep(1000);\n        }\n\n        if (pfDevOrig && setMACrc == 0) {\n            /* if pfDevOrig is set, it that the caller was *really*\n             * only interested in setting the MAC of the VF itself,\n             * *not* the admin MAC via the PF. In those cases, the\n             * adminMAC was only provided in case we need to set the\n             * VF's MAC by temporarily unbinding/rebinding the VF's\n             * net driver with the admin MAC set to the desired MAC,\n             * and then want to restore the admin MAC to its original\n             * setting when we're finished. We would only need to do\n             * that if the virNetDevSetMAC() above had failed; since\n             * setMACrc == 0, we know it didn't fail and we don't need\n             * to set the adminMAC, so we are NULLing it out here to\n             * avoid that below.\n\n             * (NB: since setting the admin MAC sets the\n             * \"administratively set\" flag for the VF in the PF's\n             * driver, which prevents any future changes to the VF's\n             * MAC address, we want to avoid setting the admin MAC as\n             * much as possible.)\n             */\n            adminMAC = NULL;\n        }\n    }\n\n    if (adminMAC || vlanTag >= 0) {\n        /* Set vlanTag and admin MAC using an RTM_SETLINK request sent to\n         * PFdevname+VF#, if mac != NULL this will set the \"admin MAC\" via\n         * the PF, *not* the actual VF MAC - the admin MAC only takes\n         * effect the next time the VF's driver is initialized (either in\n         * guest or host). if there is a vlanTag to set, it will take\n         * effect immediately though.\n         */\n        bool allowRetry = true;\n\n        if (virNetDevSetVfConfig(pfDevName, vf,\n                                 adminMAC, vlanTag, &allowRetry) < 0) {\n            /* allowRetry will still be true if the failure was due to\n             * trying to set the MAC address to all 0. In that case,\n             * we can retry with \"altZeroMAC\", which is just an all-0 MAC\n             * with the \"locally administered\" bit set.\n             */\n            if (!allowRetry)\n                goto cleanup;\n\n            allowRetry = false;\n            if (virNetDevSetVfConfig(pfDevName, vf,\n                                     &altZeroMAC, vlanTag, &allowRetry) < 0) {\n                goto cleanup;\n            }\n        }\n    }\n\n    ret = 0;\n cleanup:\n    VIR_FREE(pfDevOrig);\n    VIR_FREE(vfDevOrig);\n    virPCIDeviceFree(vfPCIDevice);\n    return ret;\n}"
  },
  {
    "function_name": "virNetDevReadNetConfig",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
    "lines": "1957-2141",
    "snippet": "int\nvirNetDevReadNetConfig(const char *linkdev, int vf,\n                       const char *stateDir,\n                       virMacAddrPtr *adminMAC,\n                       virNetDevVlanPtr *vlan,\n                       virMacAddrPtr *MAC)\n{\n    int ret = -1;\n    const char *pfDevName = NULL;\n    char *pfDevOrig = NULL;\n    char *vfDevOrig = NULL;\n    char *filePath = NULL;\n    char *fileStr = NULL;\n    virJSONValuePtr configJSON = NULL;\n    const char *MACStr = NULL;\n    const char *adminMACStr = NULL;\n    int vlanTag = -1;\n\n    *adminMAC = NULL;\n    *vlan = NULL;\n    *MAC = NULL;\n\n    if (vf >= 0) {\n        /* linkdev is the PF */\n        pfDevName = linkdev;\n\n        /* linkdev should get the VF's netdev name (or NULL if none) */\n        if (virNetDevPFGetVF(pfDevName, vf, &vfDevOrig) < 0)\n            goto cleanup;\n\n        linkdev = vfDevOrig;\n\n    } else if (virNetDevIsVirtualFunction(linkdev) == 1) {\n        /* when vf is -1, linkdev might be a standard netdevice (not\n         * SRIOV), or it might be an SRIOV VF. If it's a VF, normalize\n         * it to PF + VFname\n         */\n\n        if (virNetDevGetVirtualFunctionInfo(linkdev, &pfDevOrig, &vf) < 0)\n            goto cleanup;\n        pfDevName = pfDevOrig;\n    }\n\n    /* if there is a PF, it's now in pfDevName, and linkdev is either\n     * the VF's name, or NULL (if the VF isn't bound to a net driver\n     * on the host)\n     */\n\n    if (pfDevName) {\n        filePath = g_strdup_printf(\"%s/%s_vf%d\", stateDir, pfDevName, vf);\n\n        if (linkdev && !virFileExists(filePath)) {\n            /* the device may have been stored in a file named for the\n             * VF due to saveVlan == false (or an older version of\n             * libvirt), so reset filePath and pfDevName so we'll try\n             * the other filename.\n             */\n            VIR_FREE(filePath);\n            pfDevName = NULL;\n        }\n    }\n\n    if (!pfDevName)\n        filePath = g_strdup_printf(\"%s/%s\", stateDir, linkdev);\n\n    if (!virFileExists(filePath)) {\n        /* having no file to read is not necessarily an error, so we\n         * just return success, but with MAC, adminMAC, and vlan set to NULL\n         */\n        ret = 0;\n        goto cleanup;\n    }\n\n    if (virFileReadAll(filePath, 128, &fileStr) < 0)\n        goto cleanup;\n\n    if (strchr(\"0123456789abcdefABCDEF\", fileStr[0])) {\n        const char *vlanStr = NULL;\n\n        /* old version of file - just two lines of text. Line 1 is the\n         * MAC address (or if line 2 is present, line 1 is adminMAC),\n         * and line 2 (if present) is the vlan tag\n         */\n\n        if ((vlanStr = strchr(fileStr, '\\n'))) {\n            char *endptr;\n\n            /* if there are 2 lines, the first is adminMAC */\n            adminMACStr = fileStr;\n            vlanStr++;\n\n            if ((virStrToLong_i(vlanStr, &endptr, 10, &vlanTag) < 0) ||\n                (endptr && *endptr != '\\n' && *endptr != 0)) {\n                virReportError(VIR_ERR_INTERNAL_ERROR,\n                               _(\"cannot parse vlan tag '%s' from file '%s'\"),\n                               vlanStr, filePath);\n                goto cleanup;\n            }\n        } else {\n            /* if there is only one line, it is MAC */\n            MACStr = fileStr;\n        }\n    } else {\n        /* if it doesn't start with a hex digit, it is a modern\n         * version of the config file - JSON format as described in\n         * preamble to virNetDevSaveNetConfig()\n         */\n        if (!(configJSON = virJSONValueFromString(fileStr))) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"invalid json in net device saved \"\n                             \"config file '%s': '%.60s'\"),\n                           filePath, fileStr);\n            goto cleanup;\n        }\n\n        MACStr = virJSONValueObjectGetString(configJSON,\n                                             VIR_NETDEV_KEYNAME_MAC);\n        adminMACStr = virJSONValueObjectGetString(configJSON,\n                                                  VIR_NETDEV_KEYNAME_ADMIN_MAC);\n        ignore_value(virJSONValueObjectGetNumberInt(configJSON,\n                                                    VIR_NETDEV_KEYNAME_VLAN_TAG,\n                                                    &vlanTag));\n\n        if (!(MACStr || adminMACStr)) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"network device saved config file '%s' \"\n                             \"has unexpected contents, missing both \"\n                             \"'MAC' and 'adminMAC': '%.60s'\"),\n                           filePath, fileStr);\n            goto cleanup;\n        }\n    }\n\n    if (MACStr) {\n        if (VIR_ALLOC(*MAC) < 0)\n            goto cleanup;\n\n        if (virMacAddrParse(MACStr, *MAC) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"cannot parse MAC address '%s' from file '%s'\"),\n                           MACStr, filePath);\n            goto cleanup;\n        }\n    }\n\n    if (adminMACStr) {\n        if (VIR_ALLOC(*adminMAC) < 0)\n            goto cleanup;\n\n        if (virMacAddrParse(adminMACStr, *adminMAC) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"cannot parse MAC address '%s' from file '%s'\"),\n                           adminMACStr, filePath);\n            goto cleanup;\n        }\n    }\n\n    if (vlanTag != -1) {\n        /* construct a simple virNetDevVlan object with a single tag */\n        if (VIR_ALLOC(*vlan) < 0)\n            goto cleanup;\n        if (VIR_ALLOC((*vlan)->tag) < 0)\n            goto cleanup;\n        (*vlan)->nTags = 1;\n        (*vlan)->tag[0] = vlanTag;\n    }\n\n    /* we won't need the file again */\n    unlink(filePath);\n\n    ret = 0;\n cleanup:\n    if (ret < 0) {\n        VIR_FREE(*adminMAC);\n        VIR_FREE(*MAC);\n        VIR_FREE(*vlan);\n    }\n\n    VIR_FREE(pfDevOrig);\n    VIR_FREE(vfDevOrig);\n    VIR_FREE(filePath);\n    VIR_FREE(fileStr);\n    virJSONValueFree(configJSON);\n    return ret;\n}",
    "includes": [
      "# include <linux/devlink.h>",
      "# include <net/if_dl.h>",
      "# include <sys/sockio.h>",
      "# include <linux/ethtool.h>",
      "# include <linux/types.h>",
      "# include <linux/if_vlan.h>",
      "# include <linux/sockios.h>",
      "#include <fcntl.h>",
      "# include <sys/ioctl.h>",
      "#include \"virjson.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virpci.h\"",
      "#include \"vircommand.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetlink.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetdev.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virJSONValueFree",
          "args": [
            "configJSON"
          ],
          "line": 2139
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "391-423",
          "snippet": "void\nvirJSONValueFree(virJSONValuePtr value)\n{\n    size_t i;\n    if (!value)\n        return;\n\n    switch ((virJSONType) value->type) {\n    case VIR_JSON_TYPE_OBJECT:\n        for (i = 0; i < value->data.object.npairs; i++) {\n            VIR_FREE(value->data.object.pairs[i].key);\n            virJSONValueFree(value->data.object.pairs[i].value);\n        }\n        VIR_FREE(value->data.object.pairs);\n        break;\n    case VIR_JSON_TYPE_ARRAY:\n        for (i = 0; i < value->data.array.nvalues; i++)\n            virJSONValueFree(value->data.array.values[i]);\n        VIR_FREE(value->data.array.values);\n        break;\n    case VIR_JSON_TYPE_STRING:\n        VIR_FREE(value->data.string);\n        break;\n    case VIR_JSON_TYPE_NUMBER:\n        VIR_FREE(value->data.number);\n        break;\n    case VIR_JSON_TYPE_BOOLEAN:\n    case VIR_JSON_TYPE_NULL:\n        break;\n    }\n\n    VIR_FREE(value);\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvoid\nvirJSONValueFree(virJSONValuePtr value)\n{\n    size_t i;\n    if (!value)\n        return;\n\n    switch ((virJSONType) value->type) {\n    case VIR_JSON_TYPE_OBJECT:\n        for (i = 0; i < value->data.object.npairs; i++) {\n            VIR_FREE(value->data.object.pairs[i].key);\n            virJSONValueFree(value->data.object.pairs[i].value);\n        }\n        VIR_FREE(value->data.object.pairs);\n        break;\n    case VIR_JSON_TYPE_ARRAY:\n        for (i = 0; i < value->data.array.nvalues; i++)\n            virJSONValueFree(value->data.array.values[i]);\n        VIR_FREE(value->data.array.values);\n        break;\n    case VIR_JSON_TYPE_STRING:\n        VIR_FREE(value->data.string);\n        break;\n    case VIR_JSON_TYPE_NUMBER:\n        VIR_FREE(value->data.number);\n        break;\n    case VIR_JSON_TYPE_BOOLEAN:\n    case VIR_JSON_TYPE_NULL:\n        break;\n    }\n\n    VIR_FREE(value);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "fileStr"
          ],
          "line": 2138
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "filePath"
          ],
          "line": 2137
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "vfDevOrig"
          ],
          "line": 2136
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "pfDevOrig"
          ],
          "line": 2135
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "*vlan"
          ],
          "line": 2132
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "*MAC"
          ],
          "line": 2131
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "*adminMAC"
          ],
          "line": 2130
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unlink",
          "args": [
            "filePath"
          ],
          "line": 2125
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC",
          "args": [
            "(*vlan)->tag"
          ],
          "line": 2118
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC",
          "args": [
            "*vlan"
          ],
          "line": 2116
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"cannot parse MAC address '%s' from file '%s'\")",
            "adminMACStr",
            "filePath"
          ],
          "line": 2107
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"cannot parse MAC address '%s' from file '%s'\""
          ],
          "line": 2108
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virMacAddrParse",
          "args": [
            "adminMACStr",
            "*adminMAC"
          ],
          "line": 2106
        },
        "resolved": true,
        "details": {
          "function_name": "virMacAddrParseHex",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virmacaddr.c",
          "lines": "205-218",
          "snippet": "int\nvirMacAddrParseHex(const char *str, virMacAddrPtr addr)\n{\n    size_t i;\n\n    if (strspn(str, \"0123456789abcdefABCDEF\") != VIR_MAC_HEXLEN ||\n        str[VIR_MAC_HEXLEN])\n        return -1;\n\n    for (i = 0; i < VIR_MAC_BUFLEN; i++)\n        addr->addr[i] = (g_ascii_xdigit_value(str[2 * i]) << 4 |\n                         g_ascii_xdigit_value(str[2 * i + 1]));\n    return 0;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virrandom.h\"",
            "#include \"virmacaddr.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virrandom.h\"\n#include \"virmacaddr.h\"\n#include <config.h>\n\nint\nvirMacAddrParseHex(const char *str, virMacAddrPtr addr)\n{\n    size_t i;\n\n    if (strspn(str, \"0123456789abcdefABCDEF\") != VIR_MAC_HEXLEN ||\n        str[VIR_MAC_HEXLEN])\n        return -1;\n\n    for (i = 0; i < VIR_MAC_BUFLEN; i++)\n        addr->addr[i] = (g_ascii_xdigit_value(str[2 * i]) << 4 |\n                         g_ascii_xdigit_value(str[2 * i + 1]));\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC",
          "args": [
            "*adminMAC"
          ],
          "line": 2103
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"cannot parse MAC address '%s' from file '%s'\")",
            "MACStr",
            "filePath"
          ],
          "line": 2095
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC",
          "args": [
            "*MAC"
          ],
          "line": 2091
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"network device saved config file '%s' \"\n                             \"has unexpected contents, missing both \"\n                             \"'MAC' and 'adminMAC': '%.60s'\")",
            "filePath",
            "fileStr"
          ],
          "line": 2081
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ignore_value",
          "args": [
            "virJSONValueObjectGetNumberInt(configJSON,\n                                                    VIR_NETDEV_KEYNAME_VLAN_TAG,\n                                                    &vlanTag)"
          ],
          "line": 2076
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virJSONValueObjectGetNumberInt",
          "args": [
            "configJSON",
            "VIR_NETDEV_KEYNAME_VLAN_TAG",
            "&vlanTag"
          ],
          "line": 2076
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectGetNumberInt",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "1331-1342",
          "snippet": "int\nvirJSONValueObjectGetNumberInt(virJSONValuePtr object,\n                               const char *key,\n                               int *value)\n{\n    virJSONValuePtr val = virJSONValueObjectGet(object, key);\n\n    if (!val)\n        return -1;\n\n    return virJSONValueGetNumberInt(val, value);\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueObjectGetNumberInt(virJSONValuePtr object,\n                               const char *key,\n                               int *value)\n{\n    virJSONValuePtr val = virJSONValueObjectGet(object, key);\n\n    if (!val)\n        return -1;\n\n    return virJSONValueGetNumberInt(val, value);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueObjectGetString",
          "args": [
            "configJSON",
            "VIR_NETDEV_KEYNAME_ADMIN_MAC"
          ],
          "line": 2074
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectGetStringOrNumber",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "1313-1328",
          "snippet": "const char *\nvirJSONValueObjectGetStringOrNumber(virJSONValuePtr object,\n                                    const char *key)\n{\n    virJSONValuePtr val = virJSONValueObjectGet(object, key);\n\n    if (!val)\n        return NULL;\n\n    if (val->type == VIR_JSON_TYPE_STRING)\n        return val->data.string;\n    else if (val->type == VIR_JSON_TYPE_NUMBER)\n        return val->data.number;\n\n    return NULL;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nconst char *\nvirJSONValueObjectGetStringOrNumber(virJSONValuePtr object,\n                                    const char *key)\n{\n    virJSONValuePtr val = virJSONValueObjectGet(object, key);\n\n    if (!val)\n        return NULL;\n\n    if (val->type == VIR_JSON_TYPE_STRING)\n        return val->data.string;\n    else if (val->type == VIR_JSON_TYPE_NUMBER)\n        return val->data.number;\n\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"invalid json in net device saved \"\n                             \"config file '%s': '%.60s'\")",
            "filePath",
            "fileStr"
          ],
          "line": 2065
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virJSONValueFromString",
          "args": [
            "fileStr"
          ],
          "line": 2064
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueFromString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "1993-1999",
          "snippet": "virJSONValuePtr\nvirJSONValueFromString(const char *jsonstring G_GNUC_UNUSED)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                   _(\"No JSON parser implementation is available\"));\n    return NULL;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvirJSONValuePtr\nvirJSONValueFromString(const char *jsonstring G_GNUC_UNUSED)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                   _(\"No JSON parser implementation is available\"));\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"cannot parse vlan tag '%s' from file '%s'\")",
            "vlanStr",
            "filePath"
          ],
          "line": 2050
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStrToLong_i",
          "args": [
            "vlanStr",
            "&endptr",
            "10",
            "&vlanTag"
          ],
          "line": 2048
        },
        "resolved": true,
        "details": {
          "function_name": "virStrToLong_i",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "391-407",
          "snippet": "int\nvirStrToLong_i(char const *s, char **end_ptr, int base, int *result)\n{\n    long int val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtol(s, &p, base); /* exempt from syntax-check */\n    err = (errno || (!end_ptr && *p) || p == s || (int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToLong_i(char const *s, char **end_ptr, int base, int *result)\n{\n    long int val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtol(s, &p, base); /* exempt from syntax-check */\n    err = (errno || (!end_ptr && *p) || p == s || (int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "fileStr",
            "'\\n'"
          ],
          "line": 2041
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "\"0123456789abcdefABCDEF\"",
            "fileStr[0]"
          ],
          "line": 2033
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virFileReadAll",
          "args": [
            "filePath",
            "128",
            "&fileStr"
          ],
          "line": 2030
        },
        "resolved": true,
        "details": {
          "function_name": "virFileReadAllQuiet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1459-1472",
          "snippet": "int\nvirFileReadAllQuiet(const char *path, int maxlen, char **buf)\n{\n    int fd = open(path, O_RDONLY);\n    if (fd < 0)\n        return -errno;\n\n    int len = virFileReadLimFD(fd, maxlen, buf);\n    VIR_FORCE_CLOSE(fd);\n    if (len < 0)\n        return -errno;\n\n    return len;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileReadAllQuiet(const char *path, int maxlen, char **buf)\n{\n    int fd = open(path, O_RDONLY);\n    if (fd < 0)\n        return -errno;\n\n    int len = virFileReadLimFD(fd, maxlen, buf);\n    VIR_FORCE_CLOSE(fd);\n    if (len < 0)\n        return -errno;\n\n    return len;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virFileExists",
          "args": [
            "filePath"
          ],
          "line": 2022
        },
        "resolved": true,
        "details": {
          "function_name": "virFileExists",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1873-1877",
          "snippet": "bool\nvirFileExists(const char *path)\n{\n    return access(path, F_OK) == 0;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nbool\nvirFileExists(const char *path)\n{\n    return access(path, F_OK) == 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "filePath"
          ],
          "line": 2014
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNetDevGetVirtualFunctionInfo",
          "args": [
            "linkdev",
            "&pfDevOrig",
            "&vf"
          ],
          "line": 1995
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevGetVirtualFunctionInfo",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
          "lines": "1514-1522",
          "snippet": "int\nvirNetDevGetVirtualFunctionInfo(const char *vfname G_GNUC_UNUSED,\n                                char **pfname G_GNUC_UNUSED,\n                                int *vf G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to get virtual function info on this platform\"));\n    return -1;\n}",
          "includes": [
            "# include <linux/devlink.h>",
            "# include <net/if_dl.h>",
            "# include <sys/sockio.h>",
            "# include <linux/ethtool.h>",
            "# include <linux/types.h>",
            "# include <linux/if_vlan.h>",
            "# include <linux/sockios.h>",
            "#include <fcntl.h>",
            "# include <sys/ioctl.h>",
            "#include \"virjson.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virpci.h\"",
            "#include \"vircommand.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetlink.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetdev.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint\nvirNetDevGetVirtualFunctionInfo(const char *vfname G_GNUC_UNUSED,\n                                char **pfname G_GNUC_UNUSED,\n                                int *vf G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to get virtual function info on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetDevIsVirtualFunction",
          "args": [
            "linkdev"
          ],
          "line": 1989
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevIsVirtualFunction",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
          "lines": "1477-1483",
          "snippet": "int\nvirNetDevIsVirtualFunction(const char *ifname G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to check virtual function status on this platform\"));\n    return -1;\n}",
          "includes": [
            "# include <linux/devlink.h>",
            "# include <net/if_dl.h>",
            "# include <sys/sockio.h>",
            "# include <linux/ethtool.h>",
            "# include <linux/types.h>",
            "# include <linux/if_vlan.h>",
            "# include <linux/sockios.h>",
            "#include <fcntl.h>",
            "# include <sys/ioctl.h>",
            "#include \"virjson.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virpci.h\"",
            "#include \"vircommand.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetlink.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetdev.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint\nvirNetDevIsVirtualFunction(const char *ifname G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to check virtual function status on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetDevPFGetVF",
          "args": [
            "pfDevName",
            "vf",
            "&vfDevOrig"
          ],
          "line": 1984
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevPFGetVF",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
          "lines": "1504-1512",
          "snippet": "int\nvirNetDevPFGetVF(const char *pfname G_GNUC_UNUSED,\n                 int vf G_GNUC_UNUSED,\n                 char **vfname G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to get virtual function name on this platform\"));\n    return -1;\n}",
          "includes": [
            "# include <linux/devlink.h>",
            "# include <net/if_dl.h>",
            "# include <sys/sockio.h>",
            "# include <linux/ethtool.h>",
            "# include <linux/types.h>",
            "# include <linux/if_vlan.h>",
            "# include <linux/sockios.h>",
            "#include <fcntl.h>",
            "# include <sys/ioctl.h>",
            "#include \"virjson.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virpci.h\"",
            "#include \"vircommand.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetlink.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetdev.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint\nvirNetDevPFGetVF(const char *pfname G_GNUC_UNUSED,\n                 int vf G_GNUC_UNUSED,\n                 char **vfname G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to get virtual function name on this platform\"));\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint\nvirNetDevReadNetConfig(const char *linkdev, int vf,\n                       const char *stateDir,\n                       virMacAddrPtr *adminMAC,\n                       virNetDevVlanPtr *vlan,\n                       virMacAddrPtr *MAC)\n{\n    int ret = -1;\n    const char *pfDevName = NULL;\n    char *pfDevOrig = NULL;\n    char *vfDevOrig = NULL;\n    char *filePath = NULL;\n    char *fileStr = NULL;\n    virJSONValuePtr configJSON = NULL;\n    const char *MACStr = NULL;\n    const char *adminMACStr = NULL;\n    int vlanTag = -1;\n\n    *adminMAC = NULL;\n    *vlan = NULL;\n    *MAC = NULL;\n\n    if (vf >= 0) {\n        /* linkdev is the PF */\n        pfDevName = linkdev;\n\n        /* linkdev should get the VF's netdev name (or NULL if none) */\n        if (virNetDevPFGetVF(pfDevName, vf, &vfDevOrig) < 0)\n            goto cleanup;\n\n        linkdev = vfDevOrig;\n\n    } else if (virNetDevIsVirtualFunction(linkdev) == 1) {\n        /* when vf is -1, linkdev might be a standard netdevice (not\n         * SRIOV), or it might be an SRIOV VF. If it's a VF, normalize\n         * it to PF + VFname\n         */\n\n        if (virNetDevGetVirtualFunctionInfo(linkdev, &pfDevOrig, &vf) < 0)\n            goto cleanup;\n        pfDevName = pfDevOrig;\n    }\n\n    /* if there is a PF, it's now in pfDevName, and linkdev is either\n     * the VF's name, or NULL (if the VF isn't bound to a net driver\n     * on the host)\n     */\n\n    if (pfDevName) {\n        filePath = g_strdup_printf(\"%s/%s_vf%d\", stateDir, pfDevName, vf);\n\n        if (linkdev && !virFileExists(filePath)) {\n            /* the device may have been stored in a file named for the\n             * VF due to saveVlan == false (or an older version of\n             * libvirt), so reset filePath and pfDevName so we'll try\n             * the other filename.\n             */\n            VIR_FREE(filePath);\n            pfDevName = NULL;\n        }\n    }\n\n    if (!pfDevName)\n        filePath = g_strdup_printf(\"%s/%s\", stateDir, linkdev);\n\n    if (!virFileExists(filePath)) {\n        /* having no file to read is not necessarily an error, so we\n         * just return success, but with MAC, adminMAC, and vlan set to NULL\n         */\n        ret = 0;\n        goto cleanup;\n    }\n\n    if (virFileReadAll(filePath, 128, &fileStr) < 0)\n        goto cleanup;\n\n    if (strchr(\"0123456789abcdefABCDEF\", fileStr[0])) {\n        const char *vlanStr = NULL;\n\n        /* old version of file - just two lines of text. Line 1 is the\n         * MAC address (or if line 2 is present, line 1 is adminMAC),\n         * and line 2 (if present) is the vlan tag\n         */\n\n        if ((vlanStr = strchr(fileStr, '\\n'))) {\n            char *endptr;\n\n            /* if there are 2 lines, the first is adminMAC */\n            adminMACStr = fileStr;\n            vlanStr++;\n\n            if ((virStrToLong_i(vlanStr, &endptr, 10, &vlanTag) < 0) ||\n                (endptr && *endptr != '\\n' && *endptr != 0)) {\n                virReportError(VIR_ERR_INTERNAL_ERROR,\n                               _(\"cannot parse vlan tag '%s' from file '%s'\"),\n                               vlanStr, filePath);\n                goto cleanup;\n            }\n        } else {\n            /* if there is only one line, it is MAC */\n            MACStr = fileStr;\n        }\n    } else {\n        /* if it doesn't start with a hex digit, it is a modern\n         * version of the config file - JSON format as described in\n         * preamble to virNetDevSaveNetConfig()\n         */\n        if (!(configJSON = virJSONValueFromString(fileStr))) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"invalid json in net device saved \"\n                             \"config file '%s': '%.60s'\"),\n                           filePath, fileStr);\n            goto cleanup;\n        }\n\n        MACStr = virJSONValueObjectGetString(configJSON,\n                                             VIR_NETDEV_KEYNAME_MAC);\n        adminMACStr = virJSONValueObjectGetString(configJSON,\n                                                  VIR_NETDEV_KEYNAME_ADMIN_MAC);\n        ignore_value(virJSONValueObjectGetNumberInt(configJSON,\n                                                    VIR_NETDEV_KEYNAME_VLAN_TAG,\n                                                    &vlanTag));\n\n        if (!(MACStr || adminMACStr)) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"network device saved config file '%s' \"\n                             \"has unexpected contents, missing both \"\n                             \"'MAC' and 'adminMAC': '%.60s'\"),\n                           filePath, fileStr);\n            goto cleanup;\n        }\n    }\n\n    if (MACStr) {\n        if (VIR_ALLOC(*MAC) < 0)\n            goto cleanup;\n\n        if (virMacAddrParse(MACStr, *MAC) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"cannot parse MAC address '%s' from file '%s'\"),\n                           MACStr, filePath);\n            goto cleanup;\n        }\n    }\n\n    if (adminMACStr) {\n        if (VIR_ALLOC(*adminMAC) < 0)\n            goto cleanup;\n\n        if (virMacAddrParse(adminMACStr, *adminMAC) < 0) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"cannot parse MAC address '%s' from file '%s'\"),\n                           adminMACStr, filePath);\n            goto cleanup;\n        }\n    }\n\n    if (vlanTag != -1) {\n        /* construct a simple virNetDevVlan object with a single tag */\n        if (VIR_ALLOC(*vlan) < 0)\n            goto cleanup;\n        if (VIR_ALLOC((*vlan)->tag) < 0)\n            goto cleanup;\n        (*vlan)->nTags = 1;\n        (*vlan)->tag[0] = vlanTag;\n    }\n\n    /* we won't need the file again */\n    unlink(filePath);\n\n    ret = 0;\n cleanup:\n    if (ret < 0) {\n        VIR_FREE(*adminMAC);\n        VIR_FREE(*MAC);\n        VIR_FREE(*vlan);\n    }\n\n    VIR_FREE(pfDevOrig);\n    VIR_FREE(vfDevOrig);\n    VIR_FREE(filePath);\n    VIR_FREE(fileStr);\n    virJSONValueFree(configJSON);\n    return ret;\n}"
  },
  {
    "function_name": "virNetDevSaveNetConfig",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
    "lines": "1811-1933",
    "snippet": "int\nvirNetDevSaveNetConfig(const char *linkdev, int vf,\n                       const char *stateDir,\n                       bool saveVlan)\n{\n    int ret = -1;\n    const char *pfDevName = NULL;\n    char *pfDevOrig = NULL;\n    char *vfDevOrig = NULL;\n    virMacAddr oldMAC;\n    char MACStr[VIR_MAC_STRING_BUFLEN];\n    int oldVlanTag = -1;\n    char *filePath = NULL;\n    char *fileStr = NULL;\n    virJSONValuePtr configJSON = NULL;\n\n    if (vf >= 0) {\n        /* linkdev is the PF */\n        pfDevName = linkdev;\n\n        /* linkdev should get the VF's netdev name (or NULL if none) */\n        if (virNetDevPFGetVF(pfDevName, vf, &vfDevOrig) < 0)\n            goto cleanup;\n\n        linkdev = vfDevOrig;\n        saveVlan = true;\n\n    } else if (virNetDevIsVirtualFunction(linkdev) == 1) {\n        /* when vf is -1, linkdev might be a standard netdevice (not\n         * SRIOV), or it might be an SRIOV VF. If it's a VF, normalize\n         * it to PF + VFname\n         */\n\n        if (virNetDevGetVirtualFunctionInfo(linkdev, &pfDevOrig, &vf) < 0)\n            goto cleanup;\n        pfDevName = pfDevOrig;\n    }\n\n    if (pfDevName) {\n        bool pfIsOnline;\n\n        /* Assure that PF is online before trying to use it to set\n         * anything up for this VF. It *should* be online already,\n         * but if it isn't online the changes made to the VF via the\n         * PF won't take effect, yet there will be no error\n         * reported. In the case that the PF isn't online, we need to\n         * fail and report the error, rather than automatically\n         * setting it online, since setting an unconfigured interface\n         * online automatically turns on IPv6 autoconfig, which may\n         * not be what the admin expects, so we require them to\n         * explicitly enable the PF in the host system network config.\n         */\n        if (virNetDevGetOnline(pfDevName, &pfIsOnline) < 0)\n            goto cleanup;\n\n        if (!pfIsOnline) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Unable to configure VF %d of PF '%s' \"\n                             \"because the PF is not online. Please \"\n                             \"change host network config to put the \"\n                             \"PF online.\"),\n                           vf, pfDevName);\n            goto cleanup;\n        }\n    }\n\n    configJSON = virJSONValueNewObject();\n\n    /* if there is a PF, it's now in pfDevName, and linkdev is either\n     * the VF's name, or NULL (if the VF isn't bound to a net driver\n     * on the host)\n     */\n\n    if (pfDevName && saveVlan) {\n        filePath = g_strdup_printf(\"%s/%s_vf%d\", stateDir, pfDevName, vf);\n\n        /* get admin MAC and vlan tag */\n        if (virNetDevGetVfConfig(pfDevName, vf, &oldMAC, &oldVlanTag) < 0)\n            goto cleanup;\n\n        if (virJSONValueObjectAppendString(configJSON,\n                                           VIR_NETDEV_KEYNAME_ADMIN_MAC,\n                                           virMacAddrFormat(&oldMAC, MACStr)) < 0 ||\n            virJSONValueObjectAppendNumberInt(configJSON,\n                                              VIR_NETDEV_KEYNAME_VLAN_TAG,\n                                              oldVlanTag) < 0) {\n            goto cleanup;\n        }\n\n    } else {\n        filePath = g_strdup_printf(\"%s/%s\", stateDir, linkdev);\n    }\n\n    if (linkdev) {\n        if (virNetDevGetMAC(linkdev, &oldMAC) < 0)\n            goto cleanup;\n\n        /* for interfaces with no pfDevName (i.e. not a VF, this will\n         * be the only value in the file.\n         */\n        if (virJSONValueObjectAppendString(configJSON, VIR_NETDEV_KEYNAME_MAC,\n                                           virMacAddrFormat(&oldMAC, MACStr)) < 0)\n           goto cleanup;\n    }\n\n    if (!(fileStr = virJSONValueToString(configJSON, true)))\n        goto cleanup;\n\n    if (virFileWriteStr(filePath, fileStr, O_CREAT|O_TRUNC|O_WRONLY) < 0) {\n        virReportSystemError(errno, _(\"Unable to preserve mac/vlan tag \"\n                                      \"for device = %s, vf = %d\"), linkdev, vf);\n        goto cleanup;\n    }\n\n    ret = 0;\n cleanup:\n    VIR_FREE(pfDevOrig);\n    VIR_FREE(vfDevOrig);\n    VIR_FREE(filePath);\n    VIR_FREE(fileStr);\n    virJSONValueFree(configJSON);\n    return ret;\n}",
    "includes": [
      "# include <linux/devlink.h>",
      "# include <net/if_dl.h>",
      "# include <sys/sockio.h>",
      "# include <linux/ethtool.h>",
      "# include <linux/types.h>",
      "# include <linux/if_vlan.h>",
      "# include <linux/sockios.h>",
      "#include <fcntl.h>",
      "# include <sys/ioctl.h>",
      "#include \"virjson.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virpci.h\"",
      "#include \"vircommand.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetlink.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetdev.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "size_t i;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virJSONValueFree",
          "args": [
            "configJSON"
          ],
          "line": 1931
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "391-423",
          "snippet": "void\nvirJSONValueFree(virJSONValuePtr value)\n{\n    size_t i;\n    if (!value)\n        return;\n\n    switch ((virJSONType) value->type) {\n    case VIR_JSON_TYPE_OBJECT:\n        for (i = 0; i < value->data.object.npairs; i++) {\n            VIR_FREE(value->data.object.pairs[i].key);\n            virJSONValueFree(value->data.object.pairs[i].value);\n        }\n        VIR_FREE(value->data.object.pairs);\n        break;\n    case VIR_JSON_TYPE_ARRAY:\n        for (i = 0; i < value->data.array.nvalues; i++)\n            virJSONValueFree(value->data.array.values[i]);\n        VIR_FREE(value->data.array.values);\n        break;\n    case VIR_JSON_TYPE_STRING:\n        VIR_FREE(value->data.string);\n        break;\n    case VIR_JSON_TYPE_NUMBER:\n        VIR_FREE(value->data.number);\n        break;\n    case VIR_JSON_TYPE_BOOLEAN:\n    case VIR_JSON_TYPE_NULL:\n        break;\n    }\n\n    VIR_FREE(value);\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvoid\nvirJSONValueFree(virJSONValuePtr value)\n{\n    size_t i;\n    if (!value)\n        return;\n\n    switch ((virJSONType) value->type) {\n    case VIR_JSON_TYPE_OBJECT:\n        for (i = 0; i < value->data.object.npairs; i++) {\n            VIR_FREE(value->data.object.pairs[i].key);\n            virJSONValueFree(value->data.object.pairs[i].value);\n        }\n        VIR_FREE(value->data.object.pairs);\n        break;\n    case VIR_JSON_TYPE_ARRAY:\n        for (i = 0; i < value->data.array.nvalues; i++)\n            virJSONValueFree(value->data.array.values[i]);\n        VIR_FREE(value->data.array.values);\n        break;\n    case VIR_JSON_TYPE_STRING:\n        VIR_FREE(value->data.string);\n        break;\n    case VIR_JSON_TYPE_NUMBER:\n        VIR_FREE(value->data.number);\n        break;\n    case VIR_JSON_TYPE_BOOLEAN:\n    case VIR_JSON_TYPE_NULL:\n        break;\n    }\n\n    VIR_FREE(value);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "fileStr"
          ],
          "line": 1930
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "filePath"
          ],
          "line": 1929
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "vfDevOrig"
          ],
          "line": 1928
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "pfDevOrig"
          ],
          "line": 1927
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"Unable to preserve mac/vlan tag \"\n                                      \"for device = %s, vf = %d\")",
            "linkdev",
            "vf"
          ],
          "line": 1920
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to preserve mac/vlan tag \"\n                                      \"for device = %s, vf = %d\""
          ],
          "line": 1920
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virFileWriteStr",
          "args": [
            "filePath",
            "fileStr",
            "O_CREAT|O_TRUNC|O_WRONLY"
          ],
          "line": 1919
        },
        "resolved": true,
        "details": {
          "function_name": "virFileWriteStr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1502-1524",
          "snippet": "int\nvirFileWriteStr(const char *path, const char *str, mode_t mode)\n{\n    int fd;\n\n    if (mode)\n        fd = open(path, O_WRONLY|O_TRUNC|O_CREAT, mode);\n    else\n        fd = open(path, O_WRONLY|O_TRUNC);\n    if (fd == -1)\n        return -1;\n\n    if (safewrite(fd, str, strlen(str)) < 0) {\n        VIR_FORCE_CLOSE(fd);\n        return -1;\n    }\n\n    /* Use errno from failed close only if there was no write error.  */\n    if (VIR_CLOSE(fd) != 0)\n        return -1;\n\n    return 0;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileWriteStr(const char *path, const char *str, mode_t mode)\n{\n    int fd;\n\n    if (mode)\n        fd = open(path, O_WRONLY|O_TRUNC|O_CREAT, mode);\n    else\n        fd = open(path, O_WRONLY|O_TRUNC);\n    if (fd == -1)\n        return -1;\n\n    if (safewrite(fd, str, strlen(str)) < 0) {\n        VIR_FORCE_CLOSE(fd);\n        return -1;\n    }\n\n    /* Use errno from failed close only if there was no write error.  */\n    if (VIR_CLOSE(fd) != 0)\n        return -1;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueToString",
          "args": [
            "configJSON",
            "true"
          ],
          "line": 1916
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueToString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "2014-2024",
          "snippet": "char *\nvirJSONValueToString(virJSONValuePtr object,\n                     bool pretty)\n{\n    g_auto(virBuffer) buf = VIR_BUFFER_INITIALIZER;\n\n    if (virJSONValueToBuffer(object, &buf, pretty) < 0)\n        return NULL;\n\n    return virBufferContentAndReset(&buf);\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nchar *\nvirJSONValueToString(virJSONValuePtr object,\n                     bool pretty)\n{\n    g_auto(virBuffer) buf = VIR_BUFFER_INITIALIZER;\n\n    if (virJSONValueToBuffer(object, &buf, pretty) < 0)\n        return NULL;\n\n    return virBufferContentAndReset(&buf);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueObjectAppendString",
          "args": [
            "configJSON",
            "VIR_NETDEV_KEYNAME_MAC",
            "virMacAddrFormat(&oldMAC, MACStr)"
          ],
          "line": 1911
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectAppendString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "643-649",
          "snippet": "int\nvirJSONValueObjectAppendString(virJSONValuePtr object,\n                               const char *key,\n                               const char *value)\n{\n    return virJSONValueObjectInsertString(object, key, value, false);\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueObjectAppendString(virJSONValuePtr object,\n                               const char *key,\n                               const char *value)\n{\n    return virJSONValueObjectInsertString(object, key, value, false);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virMacAddrFormat",
          "args": [
            "&oldMAC",
            "MACStr"
          ],
          "line": 1912
        },
        "resolved": true,
        "details": {
          "function_name": "virMacAddrFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virmacaddr.c",
          "lines": "184-194",
          "snippet": "const char *\nvirMacAddrFormat(const virMacAddr *addr,\n                 char *str)\n{\n    g_snprintf(str, VIR_MAC_STRING_BUFLEN,\n               \"%02x:%02x:%02x:%02x:%02x:%02x\",\n               addr->addr[0], addr->addr[1], addr->addr[2],\n               addr->addr[3], addr->addr[4], addr->addr[5]);\n    str[VIR_MAC_STRING_BUFLEN-1] = '\\0';\n    return str;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virrandom.h\"",
            "#include \"virmacaddr.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virrandom.h\"\n#include \"virmacaddr.h\"\n#include <config.h>\n\nconst char *\nvirMacAddrFormat(const virMacAddr *addr,\n                 char *str)\n{\n    g_snprintf(str, VIR_MAC_STRING_BUFLEN,\n               \"%02x:%02x:%02x:%02x:%02x:%02x\",\n               addr->addr[0], addr->addr[1], addr->addr[2],\n               addr->addr[3], addr->addr[4], addr->addr[5]);\n    str[VIR_MAC_STRING_BUFLEN-1] = '\\0';\n    return str;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetDevGetMAC",
          "args": [
            "linkdev",
            "&oldMAC"
          ],
          "line": 1905
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevGetMAC",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
          "lines": "385-392",
          "snippet": "int virNetDevGetMAC(const char *ifname,\n                    virMacAddrPtr macaddr G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS,\n                         _(\"Cannot get interface MAC on '%s'\"),\n                         ifname);\n    return -1;\n}",
          "includes": [
            "# include <linux/devlink.h>",
            "# include <net/if_dl.h>",
            "# include <sys/sockio.h>",
            "# include <linux/ethtool.h>",
            "# include <linux/types.h>",
            "# include <linux/if_vlan.h>",
            "# include <linux/sockios.h>",
            "#include <fcntl.h>",
            "# include <sys/ioctl.h>",
            "#include \"virjson.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virpci.h\"",
            "#include \"vircommand.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetlink.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetdev.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint virNetDevGetMAC(const char *ifname,\n                    virMacAddrPtr macaddr G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS,\n                         _(\"Cannot get interface MAC on '%s'\"),\n                         ifname);\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueObjectAppendNumberInt",
          "args": [
            "configJSON",
            "VIR_NETDEV_KEYNAME_VLAN_TAG",
            "oldVlanTag"
          ],
          "line": 1894
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueObjectAppendNumberInt",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "661-674",
          "snippet": "int\nvirJSONValueObjectAppendNumberInt(virJSONValuePtr object,\n                                  const char *key,\n                                  int number)\n{\n    virJSONValuePtr jvalue = virJSONValueNewNumberInt(number);\n    if (!jvalue)\n        return -1;\n    if (virJSONValueObjectAppend(object, key, jvalue) < 0) {\n        virJSONValueFree(jvalue);\n        return -1;\n    }\n    return 0;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nint\nvirJSONValueObjectAppendNumberInt(virJSONValuePtr object,\n                                  const char *key,\n                                  int number)\n{\n    virJSONValuePtr jvalue = virJSONValueNewNumberInt(number);\n    if (!jvalue)\n        return -1;\n    if (virJSONValueObjectAppend(object, key, jvalue) < 0) {\n        virJSONValueFree(jvalue);\n        return -1;\n    }\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetDevGetVfConfig",
          "args": [
            "pfDevName",
            "vf",
            "&oldMAC",
            "&oldVlanTag"
          ],
          "line": 1888
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevGetVfConfig",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
          "lines": "1742-1760",
          "snippet": "static int\nvirNetDevGetVfConfig(const char *ifname, int vf, virMacAddrPtr mac,\n                     int *vlanid)\n{\n    int rc = -1;\n    void *nlData = NULL;\n    struct nlattr *tb[IFLA_MAX + 1] = {NULL, };\n    int ifindex = -1;\n\n    rc = virNetlinkDumpLink(ifname, ifindex, &nlData, tb, 0, 0);\n    if (rc < 0)\n        goto cleanup;\n\n    rc = virNetDevParseVfConfig(tb, vf, mac, vlanid);\n\n cleanup:\n    VIR_FREE(nlData);\n    return rc;\n}",
          "includes": [
            "# include <linux/devlink.h>",
            "# include <net/if_dl.h>",
            "# include <sys/sockio.h>",
            "# include <linux/ethtool.h>",
            "# include <linux/types.h>",
            "# include <linux/if_vlan.h>",
            "# include <linux/sockios.h>",
            "#include <fcntl.h>",
            "# include <sys/ioctl.h>",
            "#include \"virjson.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virpci.h\"",
            "#include \"vircommand.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetlink.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetdev.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nstatic int\nvirNetDevGetVfConfig(const char *ifname, int vf, virMacAddrPtr mac,\n                     int *vlanid)\n{\n    int rc = -1;\n    void *nlData = NULL;\n    struct nlattr *tb[IFLA_MAX + 1] = {NULL, };\n    int ifindex = -1;\n\n    rc = virNetlinkDumpLink(ifname, ifindex, &nlData, tb, 0, 0);\n    if (rc < 0)\n        goto cleanup;\n\n    rc = virNetDevParseVfConfig(tb, vf, mac, vlanid);\n\n cleanup:\n    VIR_FREE(nlData);\n    return rc;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virJSONValueNewObject",
          "args": [],
          "line": 1877
        },
        "resolved": true,
        "details": {
          "function_name": "virJSONValueNewObject",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virjson.c",
          "lines": "571-579",
          "snippet": "virJSONValuePtr\nvirJSONValueNewObject(void)\n{\n    virJSONValuePtr val = g_new0(virJSONValue, 1);\n\n    val->type = VIR_JSON_TYPE_OBJECT;\n\n    return val;\n}",
          "includes": [
            "# include <yajl/yajl_parse.h>",
            "# include <yajl/yajl_gen.h>",
            "#include \"virenum.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virjson.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <yajl/yajl_parse.h>\n# include <yajl/yajl_gen.h>\n#include \"virenum.h\"\n#include \"virbuffer.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virjson.h\"\n#include <config.h>\n\nvirJSONValuePtr\nvirJSONValueNewObject(void)\n{\n    virJSONValuePtr val = g_new0(virJSONValue, 1);\n\n    val->type = VIR_JSON_TYPE_OBJECT;\n\n    return val;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Unable to configure VF %d of PF '%s' \"\n                             \"because the PF is not online. Please \"\n                             \"change host network config to put the \"\n                             \"PF online.\")",
            "vf",
            "pfDevName"
          ],
          "line": 1867
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNetDevGetOnline",
          "args": [
            "pfDevName",
            "&pfIsOnline"
          ],
          "line": 1863
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevGetOnline",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
          "lines": "765-770",
          "snippet": "int\nvirNetDevGetOnline(const char *ifname,\n                   bool *online)\n{\n    return virNetDevGetIFFlag(ifname, VIR_IFF_UP, online);\n}",
          "includes": [
            "# include <linux/devlink.h>",
            "# include <net/if_dl.h>",
            "# include <sys/sockio.h>",
            "# include <linux/ethtool.h>",
            "# include <linux/types.h>",
            "# include <linux/if_vlan.h>",
            "# include <linux/sockios.h>",
            "#include <fcntl.h>",
            "# include <sys/ioctl.h>",
            "#include \"virjson.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virpci.h\"",
            "#include \"vircommand.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetlink.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetdev.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint\nvirNetDevGetOnline(const char *ifname,\n                   bool *online)\n{\n    return virNetDevGetIFFlag(ifname, VIR_IFF_UP, online);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetDevGetVirtualFunctionInfo",
          "args": [
            "linkdev",
            "&pfDevOrig",
            "&vf"
          ],
          "line": 1844
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevGetVirtualFunctionInfo",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
          "lines": "1514-1522",
          "snippet": "int\nvirNetDevGetVirtualFunctionInfo(const char *vfname G_GNUC_UNUSED,\n                                char **pfname G_GNUC_UNUSED,\n                                int *vf G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to get virtual function info on this platform\"));\n    return -1;\n}",
          "includes": [
            "# include <linux/devlink.h>",
            "# include <net/if_dl.h>",
            "# include <sys/sockio.h>",
            "# include <linux/ethtool.h>",
            "# include <linux/types.h>",
            "# include <linux/if_vlan.h>",
            "# include <linux/sockios.h>",
            "#include <fcntl.h>",
            "# include <sys/ioctl.h>",
            "#include \"virjson.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virpci.h\"",
            "#include \"vircommand.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetlink.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetdev.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint\nvirNetDevGetVirtualFunctionInfo(const char *vfname G_GNUC_UNUSED,\n                                char **pfname G_GNUC_UNUSED,\n                                int *vf G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to get virtual function info on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetDevIsVirtualFunction",
          "args": [
            "linkdev"
          ],
          "line": 1838
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevIsVirtualFunction",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
          "lines": "1477-1483",
          "snippet": "int\nvirNetDevIsVirtualFunction(const char *ifname G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to check virtual function status on this platform\"));\n    return -1;\n}",
          "includes": [
            "# include <linux/devlink.h>",
            "# include <net/if_dl.h>",
            "# include <sys/sockio.h>",
            "# include <linux/ethtool.h>",
            "# include <linux/types.h>",
            "# include <linux/if_vlan.h>",
            "# include <linux/sockios.h>",
            "#include <fcntl.h>",
            "# include <sys/ioctl.h>",
            "#include \"virjson.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virpci.h\"",
            "#include \"vircommand.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetlink.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetdev.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint\nvirNetDevIsVirtualFunction(const char *ifname G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to check virtual function status on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetDevPFGetVF",
          "args": [
            "pfDevName",
            "vf",
            "&vfDevOrig"
          ],
          "line": 1832
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevPFGetVF",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
          "lines": "1504-1512",
          "snippet": "int\nvirNetDevPFGetVF(const char *pfname G_GNUC_UNUSED,\n                 int vf G_GNUC_UNUSED,\n                 char **vfname G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to get virtual function name on this platform\"));\n    return -1;\n}",
          "includes": [
            "# include <linux/devlink.h>",
            "# include <net/if_dl.h>",
            "# include <sys/sockio.h>",
            "# include <linux/ethtool.h>",
            "# include <linux/types.h>",
            "# include <linux/if_vlan.h>",
            "# include <linux/sockios.h>",
            "#include <fcntl.h>",
            "# include <sys/ioctl.h>",
            "#include \"virjson.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virpci.h\"",
            "#include \"vircommand.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetlink.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetdev.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint\nvirNetDevPFGetVF(const char *pfname G_GNUC_UNUSED,\n                 int vf G_GNUC_UNUSED,\n                 char **vfname G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to get virtual function name on this platform\"));\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nsize_t i;\n\nint\nvirNetDevSaveNetConfig(const char *linkdev, int vf,\n                       const char *stateDir,\n                       bool saveVlan)\n{\n    int ret = -1;\n    const char *pfDevName = NULL;\n    char *pfDevOrig = NULL;\n    char *vfDevOrig = NULL;\n    virMacAddr oldMAC;\n    char MACStr[VIR_MAC_STRING_BUFLEN];\n    int oldVlanTag = -1;\n    char *filePath = NULL;\n    char *fileStr = NULL;\n    virJSONValuePtr configJSON = NULL;\n\n    if (vf >= 0) {\n        /* linkdev is the PF */\n        pfDevName = linkdev;\n\n        /* linkdev should get the VF's netdev name (or NULL if none) */\n        if (virNetDevPFGetVF(pfDevName, vf, &vfDevOrig) < 0)\n            goto cleanup;\n\n        linkdev = vfDevOrig;\n        saveVlan = true;\n\n    } else if (virNetDevIsVirtualFunction(linkdev) == 1) {\n        /* when vf is -1, linkdev might be a standard netdevice (not\n         * SRIOV), or it might be an SRIOV VF. If it's a VF, normalize\n         * it to PF + VFname\n         */\n\n        if (virNetDevGetVirtualFunctionInfo(linkdev, &pfDevOrig, &vf) < 0)\n            goto cleanup;\n        pfDevName = pfDevOrig;\n    }\n\n    if (pfDevName) {\n        bool pfIsOnline;\n\n        /* Assure that PF is online before trying to use it to set\n         * anything up for this VF. It *should* be online already,\n         * but if it isn't online the changes made to the VF via the\n         * PF won't take effect, yet there will be no error\n         * reported. In the case that the PF isn't online, we need to\n         * fail and report the error, rather than automatically\n         * setting it online, since setting an unconfigured interface\n         * online automatically turns on IPv6 autoconfig, which may\n         * not be what the admin expects, so we require them to\n         * explicitly enable the PF in the host system network config.\n         */\n        if (virNetDevGetOnline(pfDevName, &pfIsOnline) < 0)\n            goto cleanup;\n\n        if (!pfIsOnline) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Unable to configure VF %d of PF '%s' \"\n                             \"because the PF is not online. Please \"\n                             \"change host network config to put the \"\n                             \"PF online.\"),\n                           vf, pfDevName);\n            goto cleanup;\n        }\n    }\n\n    configJSON = virJSONValueNewObject();\n\n    /* if there is a PF, it's now in pfDevName, and linkdev is either\n     * the VF's name, or NULL (if the VF isn't bound to a net driver\n     * on the host)\n     */\n\n    if (pfDevName && saveVlan) {\n        filePath = g_strdup_printf(\"%s/%s_vf%d\", stateDir, pfDevName, vf);\n\n        /* get admin MAC and vlan tag */\n        if (virNetDevGetVfConfig(pfDevName, vf, &oldMAC, &oldVlanTag) < 0)\n            goto cleanup;\n\n        if (virJSONValueObjectAppendString(configJSON,\n                                           VIR_NETDEV_KEYNAME_ADMIN_MAC,\n                                           virMacAddrFormat(&oldMAC, MACStr)) < 0 ||\n            virJSONValueObjectAppendNumberInt(configJSON,\n                                              VIR_NETDEV_KEYNAME_VLAN_TAG,\n                                              oldVlanTag) < 0) {\n            goto cleanup;\n        }\n\n    } else {\n        filePath = g_strdup_printf(\"%s/%s\", stateDir, linkdev);\n    }\n\n    if (linkdev) {\n        if (virNetDevGetMAC(linkdev, &oldMAC) < 0)\n            goto cleanup;\n\n        /* for interfaces with no pfDevName (i.e. not a VF, this will\n         * be the only value in the file.\n         */\n        if (virJSONValueObjectAppendString(configJSON, VIR_NETDEV_KEYNAME_MAC,\n                                           virMacAddrFormat(&oldMAC, MACStr)) < 0)\n           goto cleanup;\n    }\n\n    if (!(fileStr = virJSONValueToString(configJSON, true)))\n        goto cleanup;\n\n    if (virFileWriteStr(filePath, fileStr, O_CREAT|O_TRUNC|O_WRONLY) < 0) {\n        virReportSystemError(errno, _(\"Unable to preserve mac/vlan tag \"\n                                      \"for device = %s, vf = %d\"), linkdev, vf);\n        goto cleanup;\n    }\n\n    ret = 0;\n cleanup:\n    VIR_FREE(pfDevOrig);\n    VIR_FREE(vfDevOrig);\n    VIR_FREE(filePath);\n    VIR_FREE(fileStr);\n    virJSONValueFree(configJSON);\n    return ret;\n}"
  },
  {
    "function_name": "virNetDevGetVfConfig",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
    "lines": "1742-1760",
    "snippet": "static int\nvirNetDevGetVfConfig(const char *ifname, int vf, virMacAddrPtr mac,\n                     int *vlanid)\n{\n    int rc = -1;\n    void *nlData = NULL;\n    struct nlattr *tb[IFLA_MAX + 1] = {NULL, };\n    int ifindex = -1;\n\n    rc = virNetlinkDumpLink(ifname, ifindex, &nlData, tb, 0, 0);\n    if (rc < 0)\n        goto cleanup;\n\n    rc = virNetDevParseVfConfig(tb, vf, mac, vlanid);\n\n cleanup:\n    VIR_FREE(nlData);\n    return rc;\n}",
    "includes": [
      "# include <linux/devlink.h>",
      "# include <net/if_dl.h>",
      "# include <sys/sockio.h>",
      "# include <linux/ethtool.h>",
      "# include <linux/types.h>",
      "# include <linux/if_vlan.h>",
      "# include <linux/sockios.h>",
      "#include <fcntl.h>",
      "# include <sys/ioctl.h>",
      "#include \"virjson.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virpci.h\"",
      "#include \"vircommand.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetlink.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetdev.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "nlData"
          ],
          "line": 1758
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNetDevParseVfConfig",
          "args": [
            "tb",
            "vf",
            "mac",
            "vlanid"
          ],
          "line": 1755
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevParseVfConfig",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
          "lines": "1688-1740",
          "snippet": "static int\nvirNetDevParseVfConfig(struct nlattr **tb, int32_t vf, virMacAddrPtr mac,\n                       int *vlanid)\n{\n    int rc = -1;\n    struct ifla_vf_mac *vf_mac;\n    struct ifla_vf_vlan *vf_vlan;\n    struct nlattr *tb_vf_info = {NULL, };\n    struct nlattr *tb_vf[IFLA_VF_MAX+1];\n    int rem;\n\n    if (!tb[IFLA_VFINFO_LIST]) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"missing IFLA_VF_INFO in netlink response\"));\n        return rc;\n    }\n\n    nla_for_each_nested(tb_vf_info, tb[IFLA_VFINFO_LIST], rem) {\n        if (nla_type(tb_vf_info) != IFLA_VF_INFO)\n            continue;\n\n        if (nla_parse_nested(tb_vf, IFLA_VF_MAX, tb_vf_info,\n                             ifla_vf_policy)) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"error parsing IFLA_VF_INFO\"));\n            return rc;\n        }\n\n        if (mac && tb[IFLA_VF_MAC]) {\n            vf_mac = RTA_DATA(tb_vf[IFLA_VF_MAC]);\n            if (vf_mac && vf_mac->vf == vf)  {\n                virMacAddrSetRaw(mac, vf_mac->mac);\n                rc = 0;\n            }\n        }\n\n        if (vlanid && tb[IFLA_VF_VLAN]) {\n            vf_vlan = RTA_DATA(tb_vf[IFLA_VF_VLAN]);\n            if (vf_vlan && vf_vlan->vf == vf)  {\n                *vlanid = vf_vlan->vlan;\n                rc = 0;\n            }\n        }\n\n        if (rc == 0)\n            break;\n    }\n    if (rc < 0)\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"couldn't find IFLA_VF_INFO for VF %d \"\n                         \"in netlink response\"), vf);\n    return rc;\n}",
          "includes": [
            "# include <linux/devlink.h>",
            "# include <net/if_dl.h>",
            "# include <sys/sockio.h>",
            "# include <linux/ethtool.h>",
            "# include <linux/types.h>",
            "# include <linux/if_vlan.h>",
            "# include <linux/sockios.h>",
            "#include <fcntl.h>",
            "# include <sys/ioctl.h>",
            "#include \"virjson.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virpci.h\"",
            "#include \"vircommand.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetlink.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetdev.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nstatic int\nvirNetDevParseVfConfig(struct nlattr **tb, int32_t vf, virMacAddrPtr mac,\n                       int *vlanid)\n{\n    int rc = -1;\n    struct ifla_vf_mac *vf_mac;\n    struct ifla_vf_vlan *vf_vlan;\n    struct nlattr *tb_vf_info = {NULL, };\n    struct nlattr *tb_vf[IFLA_VF_MAX+1];\n    int rem;\n\n    if (!tb[IFLA_VFINFO_LIST]) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"missing IFLA_VF_INFO in netlink response\"));\n        return rc;\n    }\n\n    nla_for_each_nested(tb_vf_info, tb[IFLA_VFINFO_LIST], rem) {\n        if (nla_type(tb_vf_info) != IFLA_VF_INFO)\n            continue;\n\n        if (nla_parse_nested(tb_vf, IFLA_VF_MAX, tb_vf_info,\n                             ifla_vf_policy)) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"error parsing IFLA_VF_INFO\"));\n            return rc;\n        }\n\n        if (mac && tb[IFLA_VF_MAC]) {\n            vf_mac = RTA_DATA(tb_vf[IFLA_VF_MAC]);\n            if (vf_mac && vf_mac->vf == vf)  {\n                virMacAddrSetRaw(mac, vf_mac->mac);\n                rc = 0;\n            }\n        }\n\n        if (vlanid && tb[IFLA_VF_VLAN]) {\n            vf_vlan = RTA_DATA(tb_vf[IFLA_VF_VLAN]);\n            if (vf_vlan && vf_vlan->vf == vf)  {\n                *vlanid = vf_vlan->vlan;\n                rc = 0;\n            }\n        }\n\n        if (rc == 0)\n            break;\n    }\n    if (rc < 0)\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"couldn't find IFLA_VF_INFO for VF %d \"\n                         \"in netlink response\"), vf);\n    return rc;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetlinkDumpLink",
          "args": [
            "ifname",
            "ifindex",
            "&nlData",
            "tb",
            "0",
            "0"
          ],
          "line": 1751
        },
        "resolved": true,
        "details": {
          "function_name": "virNetlinkDumpLink",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetlink.c",
          "lines": "1261-1272",
          "snippet": "int\nvirNetlinkDumpLink(const char *ifname G_GNUC_UNUSED,\n                   int ifindex G_GNUC_UNUSED,\n                   void **nlData G_GNUC_UNUSED,\n                   struct nlattr **tb G_GNUC_UNUSED,\n                   uint32_t src_pid G_GNUC_UNUSED,\n                   uint32_t dst_pid G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to dump link info on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virnetlink.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virmacaddr.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virnetdev.h\"\n#include \"virnetlink.h\"\n#include <unistd.h>\n#include <config.h>\n\nint\nvirNetlinkDumpLink(const char *ifname G_GNUC_UNUSED,\n                   int ifindex G_GNUC_UNUSED,\n                   void **nlData G_GNUC_UNUSED,\n                   struct nlattr **tb G_GNUC_UNUSED,\n                   uint32_t src_pid G_GNUC_UNUSED,\n                   uint32_t dst_pid G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to dump link info on this platform\"));\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nstatic int\nvirNetDevGetVfConfig(const char *ifname, int vf, virMacAddrPtr mac,\n                     int *vlanid)\n{\n    int rc = -1;\n    void *nlData = NULL;\n    struct nlattr *tb[IFLA_MAX + 1] = {NULL, };\n    int ifindex = -1;\n\n    rc = virNetlinkDumpLink(ifname, ifindex, &nlData, tb, 0, 0);\n    if (rc < 0)\n        goto cleanup;\n\n    rc = virNetDevParseVfConfig(tb, vf, mac, vlanid);\n\n cleanup:\n    VIR_FREE(nlData);\n    return rc;\n}"
  },
  {
    "function_name": "virNetDevParseVfConfig",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
    "lines": "1688-1740",
    "snippet": "static int\nvirNetDevParseVfConfig(struct nlattr **tb, int32_t vf, virMacAddrPtr mac,\n                       int *vlanid)\n{\n    int rc = -1;\n    struct ifla_vf_mac *vf_mac;\n    struct ifla_vf_vlan *vf_vlan;\n    struct nlattr *tb_vf_info = {NULL, };\n    struct nlattr *tb_vf[IFLA_VF_MAX+1];\n    int rem;\n\n    if (!tb[IFLA_VFINFO_LIST]) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"missing IFLA_VF_INFO in netlink response\"));\n        return rc;\n    }\n\n    nla_for_each_nested(tb_vf_info, tb[IFLA_VFINFO_LIST], rem) {\n        if (nla_type(tb_vf_info) != IFLA_VF_INFO)\n            continue;\n\n        if (nla_parse_nested(tb_vf, IFLA_VF_MAX, tb_vf_info,\n                             ifla_vf_policy)) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"error parsing IFLA_VF_INFO\"));\n            return rc;\n        }\n\n        if (mac && tb[IFLA_VF_MAC]) {\n            vf_mac = RTA_DATA(tb_vf[IFLA_VF_MAC]);\n            if (vf_mac && vf_mac->vf == vf)  {\n                virMacAddrSetRaw(mac, vf_mac->mac);\n                rc = 0;\n            }\n        }\n\n        if (vlanid && tb[IFLA_VF_VLAN]) {\n            vf_vlan = RTA_DATA(tb_vf[IFLA_VF_VLAN]);\n            if (vf_vlan && vf_vlan->vf == vf)  {\n                *vlanid = vf_vlan->vlan;\n                rc = 0;\n            }\n        }\n\n        if (rc == 0)\n            break;\n    }\n    if (rc < 0)\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"couldn't find IFLA_VF_INFO for VF %d \"\n                         \"in netlink response\"), vf);\n    return rc;\n}",
    "includes": [
      "# include <linux/devlink.h>",
      "# include <net/if_dl.h>",
      "# include <sys/sockio.h>",
      "# include <linux/ethtool.h>",
      "# include <linux/types.h>",
      "# include <linux/if_vlan.h>",
      "# include <linux/sockios.h>",
      "#include <fcntl.h>",
      "# include <sys/ioctl.h>",
      "#include \"virjson.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virpci.h\"",
      "#include \"vircommand.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetlink.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetdev.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"couldn't find IFLA_VF_INFO for VF %d \"\n                         \"in netlink response\")",
            "vf"
          ],
          "line": 1736
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"couldn't find IFLA_VF_INFO for VF %d \"\n                         \"in netlink response\""
          ],
          "line": 1737
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "RTA_DATA",
          "args": [
            "tb_vf[IFLA_VF_VLAN]"
          ],
          "line": 1725
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virMacAddrSetRaw",
          "args": [
            "mac",
            "vf_mac->mac"
          ],
          "line": 1719
        },
        "resolved": true,
        "details": {
          "function_name": "virMacAddrSetRaw",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virmacaddr.c",
          "lines": "113-117",
          "snippet": "void\nvirMacAddrSetRaw(virMacAddrPtr dst, const unsigned char src[VIR_MAC_BUFLEN])\n{\n    memcpy(dst->addr, src, VIR_MAC_BUFLEN);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virrandom.h\"",
            "#include \"virmacaddr.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virrandom.h\"\n#include \"virmacaddr.h\"\n#include <config.h>\n\nvoid\nvirMacAddrSetRaw(virMacAddrPtr dst, const unsigned char src[VIR_MAC_BUFLEN])\n{\n    memcpy(dst->addr, src, VIR_MAC_BUFLEN);\n}"
        }
      },
      {
        "call_info": {
          "callee": "RTA_DATA",
          "args": [
            "tb_vf[IFLA_VF_MAC]"
          ],
          "line": 1717
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"error parsing IFLA_VF_INFO\")"
          ],
          "line": 1711
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nla_parse_nested",
          "args": [
            "tb_vf",
            "IFLA_VF_MAX",
            "tb_vf_info",
            "ifla_vf_policy"
          ],
          "line": 1709
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nla_type",
          "args": [
            "tb_vf_info"
          ],
          "line": 1706
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nla_for_each_nested",
          "args": [
            "tb_vf_info",
            "tb[IFLA_VFINFO_LIST]",
            "rem"
          ],
          "line": 1705
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"missing IFLA_VF_INFO in netlink response\")"
          ],
          "line": 1700
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nstatic int\nvirNetDevParseVfConfig(struct nlattr **tb, int32_t vf, virMacAddrPtr mac,\n                       int *vlanid)\n{\n    int rc = -1;\n    struct ifla_vf_mac *vf_mac;\n    struct ifla_vf_vlan *vf_vlan;\n    struct nlattr *tb_vf_info = {NULL, };\n    struct nlattr *tb_vf[IFLA_VF_MAX+1];\n    int rem;\n\n    if (!tb[IFLA_VFINFO_LIST]) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"missing IFLA_VF_INFO in netlink response\"));\n        return rc;\n    }\n\n    nla_for_each_nested(tb_vf_info, tb[IFLA_VFINFO_LIST], rem) {\n        if (nla_type(tb_vf_info) != IFLA_VF_INFO)\n            continue;\n\n        if (nla_parse_nested(tb_vf, IFLA_VF_MAX, tb_vf_info,\n                             ifla_vf_policy)) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"error parsing IFLA_VF_INFO\"));\n            return rc;\n        }\n\n        if (mac && tb[IFLA_VF_MAC]) {\n            vf_mac = RTA_DATA(tb_vf[IFLA_VF_MAC]);\n            if (vf_mac && vf_mac->vf == vf)  {\n                virMacAddrSetRaw(mac, vf_mac->mac);\n                rc = 0;\n            }\n        }\n\n        if (vlanid && tb[IFLA_VF_VLAN]) {\n            vf_vlan = RTA_DATA(tb_vf[IFLA_VF_VLAN]);\n            if (vf_vlan && vf_vlan->vf == vf)  {\n                *vlanid = vf_vlan->vlan;\n                rc = 0;\n            }\n        }\n\n        if (rc == 0)\n            break;\n    }\n    if (rc < 0)\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"couldn't find IFLA_VF_INFO for VF %d \"\n                         \"in netlink response\"), vf);\n    return rc;\n}"
  },
  {
    "function_name": "virNetDevSetVfConfig",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
    "lines": "1555-1686",
    "snippet": "static int\nvirNetDevSetVfConfig(const char *ifname, int vf,\n                     const virMacAddr *macaddr, int vlanid,\n                     bool *allowRetry)\n{\n    int rc = -1;\n    char macstr[VIR_MAC_STRING_BUFLEN];\n    struct nlmsghdr *resp = NULL;\n    struct nlmsgerr *err;\n    unsigned int recvbuflen = 0;\n    struct nl_msg *nl_msg;\n    struct nlattr *vfinfolist, *vfinfo;\n    struct ifinfomsg ifinfo = {\n        .ifi_family = AF_UNSPEC,\n        .ifi_index  = -1,\n    };\n\n    if (!macaddr && vlanid < 0)\n        return -1;\n\n    nl_msg = nlmsg_alloc_simple(RTM_SETLINK, NLM_F_REQUEST);\n    if (!nl_msg) {\n        virReportOOMError();\n        return rc;\n    }\n\n    if (nlmsg_append(nl_msg,  &ifinfo, sizeof(ifinfo), NLMSG_ALIGNTO) < 0)\n        goto buffer_too_small;\n\n    if (ifname &&\n        nla_put(nl_msg, IFLA_IFNAME, strlen(ifname)+1, ifname) < 0)\n        goto buffer_too_small;\n\n\n    if (!(vfinfolist = nla_nest_start(nl_msg, IFLA_VFINFO_LIST)))\n        goto buffer_too_small;\n\n    if (!(vfinfo = nla_nest_start(nl_msg, IFLA_VF_INFO)))\n        goto buffer_too_small;\n\n    if (macaddr) {\n        struct ifla_vf_mac ifla_vf_mac = {\n             .vf = vf,\n             .mac = { 0, },\n        };\n\n        virMacAddrGetRaw(macaddr, ifla_vf_mac.mac);\n\n        if (nla_put(nl_msg, IFLA_VF_MAC, sizeof(ifla_vf_mac),\n                    &ifla_vf_mac) < 0)\n            goto buffer_too_small;\n    }\n\n    if (vlanid >= 0) {\n        struct ifla_vf_vlan ifla_vf_vlan = {\n             .vf = vf,\n             .vlan = vlanid,\n             .qos = 0,\n        };\n\n        if (nla_put(nl_msg, IFLA_VF_VLAN, sizeof(ifla_vf_vlan),\n                    &ifla_vf_vlan) < 0)\n            goto buffer_too_small;\n    }\n\n    nla_nest_end(nl_msg, vfinfo);\n    nla_nest_end(nl_msg, vfinfolist);\n\n    if (virNetlinkCommand(nl_msg, &resp, &recvbuflen, 0, 0,\n                          NETLINK_ROUTE, 0) < 0)\n        goto cleanup;\n\n    if (recvbuflen < NLMSG_LENGTH(0) || resp == NULL)\n        goto malformed_resp;\n\n    switch (resp->nlmsg_type) {\n    case NLMSG_ERROR:\n        err = (struct nlmsgerr *)NLMSG_DATA(resp);\n        if (resp->nlmsg_len < NLMSG_LENGTH(sizeof(*err)))\n            goto malformed_resp;\n\n        /* if allowRetry is true and the error was EINVAL, then\n         * silently return a failure so the caller can retry with a\n         * different MAC address\n         */\n        if (err->error == -EINVAL && *allowRetry &&\n            macaddr && !virMacAddrCmp(macaddr, &zeroMAC)) {\n            goto cleanup;\n        } else if (err->error) {\n            /* other errors are permanent */\n            virReportSystemError(-err->error,\n                                 _(\"Cannot set interface MAC/vlanid to %s/%d \"\n                                   \"for ifname %s vf %d\"),\n                                 (macaddr\n                                  ? virMacAddrFormat(macaddr, macstr)\n                                  : \"(unchanged)\"),\n                                 vlanid,\n                                 ifname ? ifname : \"(unspecified)\",\n                                 vf);\n            *allowRetry = false; /* no use retrying */\n            goto cleanup;\n        }\n        break;\n\n    case NLMSG_DONE:\n        break;\n\n    default:\n        goto malformed_resp;\n    }\n\n    rc = 0;\n cleanup:\n    VIR_DEBUG(\"RTM_SETLINK %s vf %d MAC=%s vlanid=%d - %s\",\n              ifname, vf,\n              macaddr ? virMacAddrFormat(macaddr, macstr) : \"(unchanged)\",\n              vlanid, rc < 0 ? \"Fail\" : \"Success\");\n\n    nlmsg_free(nl_msg);\n    VIR_FREE(resp);\n    return rc;\n\n malformed_resp:\n    virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                   _(\"malformed netlink response message\"));\n    goto cleanup;\n\n buffer_too_small:\n    virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                   _(\"allocated netlink buffer is too small\"));\n    goto cleanup;\n}",
    "includes": [
      "# include <linux/devlink.h>",
      "# include <net/if_dl.h>",
      "# include <sys/sockio.h>",
      "# include <linux/ethtool.h>",
      "# include <linux/types.h>",
      "# include <linux/if_vlan.h>",
      "# include <linux/sockios.h>",
      "#include <fcntl.h>",
      "# include <sys/ioctl.h>",
      "#include \"virjson.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virpci.h\"",
      "#include \"vircommand.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetlink.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetdev.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"allocated netlink buffer is too small\")"
          ],
          "line": 1683
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"allocated netlink buffer is too small\""
          ],
          "line": 1684
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"malformed netlink response message\")"
          ],
          "line": 1678
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "resp"
          ],
          "line": 1674
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nlmsg_free",
          "args": [
            "nl_msg"
          ],
          "line": 1673
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"RTM_SETLINK %s vf %d MAC=%s vlanid=%d - %s\"",
            "ifname",
            "vf",
            "macaddr ? virMacAddrFormat(macaddr, macstr) : \"(unchanged)\"",
            "vlanid",
            "rc < 0 ? \"Fail\" : \"Success\""
          ],
          "line": 1668
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virMacAddrFormat",
          "args": [
            "macaddr",
            "macstr"
          ],
          "line": 1670
        },
        "resolved": true,
        "details": {
          "function_name": "virMacAddrFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virmacaddr.c",
          "lines": "184-194",
          "snippet": "const char *\nvirMacAddrFormat(const virMacAddr *addr,\n                 char *str)\n{\n    g_snprintf(str, VIR_MAC_STRING_BUFLEN,\n               \"%02x:%02x:%02x:%02x:%02x:%02x\",\n               addr->addr[0], addr->addr[1], addr->addr[2],\n               addr->addr[3], addr->addr[4], addr->addr[5]);\n    str[VIR_MAC_STRING_BUFLEN-1] = '\\0';\n    return str;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virrandom.h\"",
            "#include \"virmacaddr.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virrandom.h\"\n#include \"virmacaddr.h\"\n#include <config.h>\n\nconst char *\nvirMacAddrFormat(const virMacAddr *addr,\n                 char *str)\n{\n    g_snprintf(str, VIR_MAC_STRING_BUFLEN,\n               \"%02x:%02x:%02x:%02x:%02x:%02x\",\n               addr->addr[0], addr->addr[1], addr->addr[2],\n               addr->addr[3], addr->addr[4], addr->addr[5]);\n    str[VIR_MAC_STRING_BUFLEN-1] = '\\0';\n    return str;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "-err->error",
            "_(\"Cannot set interface MAC/vlanid to %s/%d \"\n                                   \"for ifname %s vf %d\")",
            "(macaddr\n                                  ? virMacAddrFormat(macaddr, macstr)\n                                  : \"(unchanged)\")",
            "vlanid",
            "ifname ? ifname : \"(unspecified)\"",
            "vf"
          ],
          "line": 1645
        },
        "resolved": true,
        "details": {
          "function_name": "virReportSystemErrorFull",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "1322-1360",
          "snippet": "void virReportSystemErrorFull(int domcode,\n                              int theerrno,\n                              const char *filename,\n                              const char *funcname,\n                              size_t linenr,\n                              const char *fmt, ...)\n{\n    int save_errno = errno;\n    char msgDetailBuf[VIR_ERROR_MAX_LENGTH];\n\n    const char *errnoDetail = g_strerror(theerrno);\n    const char *msg = virErrorMsg(VIR_ERR_SYSTEM_ERROR, fmt);\n    const char *msgDetail = NULL;\n\n    if (fmt) {\n        va_list args;\n        int n;\n\n        va_start(args, fmt);\n        n = g_vsnprintf(msgDetailBuf, sizeof(msgDetailBuf), fmt, args);\n        va_end(args);\n\n        size_t len = strlen(errnoDetail);\n        if (0 <= n && n + 2 + len < sizeof(msgDetailBuf)) {\n          strcpy(msgDetailBuf + n, \": \");\n          n += 2;\n          strcpy(msgDetailBuf + n, errnoDetail);\n          msgDetail = msgDetailBuf;\n        }\n    }\n\n    if (!msgDetail)\n        msgDetail = errnoDetail;\n\n    virRaiseErrorFull(filename, funcname, linenr,\n                      domcode, VIR_ERR_SYSTEM_ERROR, VIR_ERR_ERROR,\n                      msg, msgDetail, NULL, theerrno, -1, msg, msgDetail);\n    errno = save_errno;\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nvoid virReportSystemErrorFull(int domcode,\n                              int theerrno,\n                              const char *filename,\n                              const char *funcname,\n                              size_t linenr,\n                              const char *fmt, ...)\n{\n    int save_errno = errno;\n    char msgDetailBuf[VIR_ERROR_MAX_LENGTH];\n\n    const char *errnoDetail = g_strerror(theerrno);\n    const char *msg = virErrorMsg(VIR_ERR_SYSTEM_ERROR, fmt);\n    const char *msgDetail = NULL;\n\n    if (fmt) {\n        va_list args;\n        int n;\n\n        va_start(args, fmt);\n        n = g_vsnprintf(msgDetailBuf, sizeof(msgDetailBuf), fmt, args);\n        va_end(args);\n\n        size_t len = strlen(errnoDetail);\n        if (0 <= n && n + 2 + len < sizeof(msgDetailBuf)) {\n          strcpy(msgDetailBuf + n, \": \");\n          n += 2;\n          strcpy(msgDetailBuf + n, errnoDetail);\n          msgDetail = msgDetailBuf;\n        }\n    }\n\n    if (!msgDetail)\n        msgDetail = errnoDetail;\n\n    virRaiseErrorFull(filename, funcname, linenr,\n                      domcode, VIR_ERR_SYSTEM_ERROR, VIR_ERR_ERROR,\n                      msg, msgDetail, NULL, theerrno, -1, msg, msgDetail);\n    errno = save_errno;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virMacAddrCmp",
          "args": [
            "macaddr",
            "&zeroMAC"
          ],
          "line": 1641
        },
        "resolved": true,
        "details": {
          "function_name": "virMacAddrCmpRaw",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virmacaddr.c",
          "lines": "86-91",
          "snippet": "int\nvirMacAddrCmpRaw(const virMacAddr *mac1,\n                 const unsigned char mac2[VIR_MAC_BUFLEN])\n{\n    return memcmp(mac1->addr, mac2, VIR_MAC_BUFLEN);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virrandom.h\"",
            "#include \"virmacaddr.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virrandom.h\"\n#include \"virmacaddr.h\"\n#include <config.h>\n\nint\nvirMacAddrCmpRaw(const virMacAddr *mac1,\n                 const unsigned char mac2[VIR_MAC_BUFLEN])\n{\n    return memcmp(mac1->addr, mac2, VIR_MAC_BUFLEN);\n}"
        }
      },
      {
        "call_info": {
          "callee": "NLMSG_LENGTH",
          "args": [
            "sizeof(*err)"
          ],
          "line": 1633
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NLMSG_DATA",
          "args": [
            "resp"
          ],
          "line": 1632
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NLMSG_LENGTH",
          "args": [
            "0"
          ],
          "line": 1627
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNetlinkCommand",
          "args": [
            "nl_msg",
            "&resp",
            "&recvbuflen",
            "0",
            "0",
            "NETLINK_ROUTE",
            "0"
          ],
          "line": 1623
        },
        "resolved": true,
        "details": {
          "function_name": "virNetlinkCommand",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetlink.c",
          "lines": "1236-1246",
          "snippet": "int virNetlinkCommand(struct nl_msg *nl_msg G_GNUC_UNUSED,\n                      struct nlmsghdr **resp G_GNUC_UNUSED,\n                      unsigned int *respbuflen G_GNUC_UNUSED,\n                      uint32_t src_pid G_GNUC_UNUSED,\n                      uint32_t dst_pid G_GNUC_UNUSED,\n                      unsigned int protocol G_GNUC_UNUSED,\n                      unsigned int groups G_GNUC_UNUSED)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\", _(unsupported));\n    return -1;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virnetlink.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virmacaddr.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virnetdev.h\"\n#include \"virnetlink.h\"\n#include <unistd.h>\n#include <config.h>\n\nint virNetlinkCommand(struct nl_msg *nl_msg G_GNUC_UNUSED,\n                      struct nlmsghdr **resp G_GNUC_UNUSED,\n                      unsigned int *respbuflen G_GNUC_UNUSED,\n                      uint32_t src_pid G_GNUC_UNUSED,\n                      uint32_t dst_pid G_GNUC_UNUSED,\n                      unsigned int protocol G_GNUC_UNUSED,\n                      unsigned int groups G_GNUC_UNUSED)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\", _(unsupported));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nla_nest_end",
          "args": [
            "nl_msg",
            "vfinfolist"
          ],
          "line": 1621
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nla_nest_end",
          "args": [
            "nl_msg",
            "vfinfo"
          ],
          "line": 1620
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nla_put",
          "args": [
            "nl_msg",
            "IFLA_VF_VLAN",
            "sizeof(ifla_vf_vlan)",
            "&ifla_vf_vlan"
          ],
          "line": 1615
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nla_put",
          "args": [
            "nl_msg",
            "IFLA_VF_MAC",
            "sizeof(ifla_vf_mac)",
            "&ifla_vf_mac"
          ],
          "line": 1603
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virMacAddrGetRaw",
          "args": [
            "macaddr",
            "ifla_vf_mac.mac"
          ],
          "line": 1601
        },
        "resolved": true,
        "details": {
          "function_name": "virMacAddrGetRaw",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virmacaddr.c",
          "lines": "126-130",
          "snippet": "void\nvirMacAddrGetRaw(const virMacAddr *src, unsigned char dst[VIR_MAC_BUFLEN])\n{\n    memcpy(dst, src->addr, VIR_MAC_BUFLEN);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virrandom.h\"",
            "#include \"virmacaddr.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virrandom.h\"\n#include \"virmacaddr.h\"\n#include <config.h>\n\nvoid\nvirMacAddrGetRaw(const virMacAddr *src, unsigned char dst[VIR_MAC_BUFLEN])\n{\n    memcpy(dst, src->addr, VIR_MAC_BUFLEN);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nla_nest_start",
          "args": [
            "nl_msg",
            "IFLA_VF_INFO"
          ],
          "line": 1592
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nla_nest_start",
          "args": [
            "nl_msg",
            "IFLA_VFINFO_LIST"
          ],
          "line": 1589
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nla_put",
          "args": [
            "nl_msg",
            "IFLA_IFNAME",
            "strlen(ifname)+1",
            "ifname"
          ],
          "line": 1585
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "ifname"
          ],
          "line": 1585
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nlmsg_append",
          "args": [
            "nl_msg",
            "&ifinfo",
            "sizeof(ifinfo)",
            "NLMSG_ALIGNTO"
          ],
          "line": 1581
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportOOMError",
          "args": [],
          "line": 1577
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nlmsg_alloc_simple",
          "args": [
            "RTM_SETLINK",
            "NLM_F_REQUEST"
          ],
          "line": 1575
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nstatic int\nvirNetDevSetVfConfig(const char *ifname, int vf,\n                     const virMacAddr *macaddr, int vlanid,\n                     bool *allowRetry)\n{\n    int rc = -1;\n    char macstr[VIR_MAC_STRING_BUFLEN];\n    struct nlmsghdr *resp = NULL;\n    struct nlmsgerr *err;\n    unsigned int recvbuflen = 0;\n    struct nl_msg *nl_msg;\n    struct nlattr *vfinfolist, *vfinfo;\n    struct ifinfomsg ifinfo = {\n        .ifi_family = AF_UNSPEC,\n        .ifi_index  = -1,\n    };\n\n    if (!macaddr && vlanid < 0)\n        return -1;\n\n    nl_msg = nlmsg_alloc_simple(RTM_SETLINK, NLM_F_REQUEST);\n    if (!nl_msg) {\n        virReportOOMError();\n        return rc;\n    }\n\n    if (nlmsg_append(nl_msg,  &ifinfo, sizeof(ifinfo), NLMSG_ALIGNTO) < 0)\n        goto buffer_too_small;\n\n    if (ifname &&\n        nla_put(nl_msg, IFLA_IFNAME, strlen(ifname)+1, ifname) < 0)\n        goto buffer_too_small;\n\n\n    if (!(vfinfolist = nla_nest_start(nl_msg, IFLA_VFINFO_LIST)))\n        goto buffer_too_small;\n\n    if (!(vfinfo = nla_nest_start(nl_msg, IFLA_VF_INFO)))\n        goto buffer_too_small;\n\n    if (macaddr) {\n        struct ifla_vf_mac ifla_vf_mac = {\n             .vf = vf,\n             .mac = { 0, },\n        };\n\n        virMacAddrGetRaw(macaddr, ifla_vf_mac.mac);\n\n        if (nla_put(nl_msg, IFLA_VF_MAC, sizeof(ifla_vf_mac),\n                    &ifla_vf_mac) < 0)\n            goto buffer_too_small;\n    }\n\n    if (vlanid >= 0) {\n        struct ifla_vf_vlan ifla_vf_vlan = {\n             .vf = vf,\n             .vlan = vlanid,\n             .qos = 0,\n        };\n\n        if (nla_put(nl_msg, IFLA_VF_VLAN, sizeof(ifla_vf_vlan),\n                    &ifla_vf_vlan) < 0)\n            goto buffer_too_small;\n    }\n\n    nla_nest_end(nl_msg, vfinfo);\n    nla_nest_end(nl_msg, vfinfolist);\n\n    if (virNetlinkCommand(nl_msg, &resp, &recvbuflen, 0, 0,\n                          NETLINK_ROUTE, 0) < 0)\n        goto cleanup;\n\n    if (recvbuflen < NLMSG_LENGTH(0) || resp == NULL)\n        goto malformed_resp;\n\n    switch (resp->nlmsg_type) {\n    case NLMSG_ERROR:\n        err = (struct nlmsgerr *)NLMSG_DATA(resp);\n        if (resp->nlmsg_len < NLMSG_LENGTH(sizeof(*err)))\n            goto malformed_resp;\n\n        /* if allowRetry is true and the error was EINVAL, then\n         * silently return a failure so the caller can retry with a\n         * different MAC address\n         */\n        if (err->error == -EINVAL && *allowRetry &&\n            macaddr && !virMacAddrCmp(macaddr, &zeroMAC)) {\n            goto cleanup;\n        } else if (err->error) {\n            /* other errors are permanent */\n            virReportSystemError(-err->error,\n                                 _(\"Cannot set interface MAC/vlanid to %s/%d \"\n                                   \"for ifname %s vf %d\"),\n                                 (macaddr\n                                  ? virMacAddrFormat(macaddr, macstr)\n                                  : \"(unchanged)\"),\n                                 vlanid,\n                                 ifname ? ifname : \"(unspecified)\",\n                                 vf);\n            *allowRetry = false; /* no use retrying */\n            goto cleanup;\n        }\n        break;\n\n    case NLMSG_DONE:\n        break;\n\n    default:\n        goto malformed_resp;\n    }\n\n    rc = 0;\n cleanup:\n    VIR_DEBUG(\"RTM_SETLINK %s vf %d MAC=%s vlanid=%d - %s\",\n              ifname, vf,\n              macaddr ? virMacAddrFormat(macaddr, macstr) : \"(unchanged)\",\n              vlanid, rc < 0 ? \"Fail\" : \"Success\");\n\n    nlmsg_free(nl_msg);\n    VIR_FREE(resp);\n    return rc;\n\n malformed_resp:\n    virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                   _(\"malformed netlink response message\"));\n    goto cleanup;\n\n buffer_too_small:\n    virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                   _(\"allocated netlink buffer is too small\"));\n    goto cleanup;\n}"
  },
  {
    "function_name": "virNetDevSysfsFile",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
    "lines": "1524-1532",
    "snippet": "int\nvirNetDevSysfsFile(char **pf_sysfs_device_link G_GNUC_UNUSED,\n                   const char *ifname G_GNUC_UNUSED,\n                   const char *file G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to get sysfs info on this platform\"));\n    return -1;\n}",
    "includes": [
      "# include <linux/devlink.h>",
      "# include <net/if_dl.h>",
      "# include <sys/sockio.h>",
      "# include <linux/ethtool.h>",
      "# include <linux/types.h>",
      "# include <linux/if_vlan.h>",
      "# include <linux/sockios.h>",
      "#include <fcntl.h>",
      "# include <sys/ioctl.h>",
      "#include \"virjson.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virpci.h\"",
      "#include \"vircommand.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetlink.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetdev.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "\"%s\"",
            "_(\"Unable to get sysfs info on this platform\")"
          ],
          "line": 1529
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to get sysfs info on this platform\""
          ],
          "line": 1530
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint\nvirNetDevSysfsFile(char **pf_sysfs_device_link G_GNUC_UNUSED,\n                   const char *ifname G_GNUC_UNUSED,\n                   const char *file G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to get sysfs info on this platform\"));\n    return -1;\n}"
  },
  {
    "function_name": "virNetDevGetVirtualFunctionInfo",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
    "lines": "1514-1522",
    "snippet": "int\nvirNetDevGetVirtualFunctionInfo(const char *vfname G_GNUC_UNUSED,\n                                char **pfname G_GNUC_UNUSED,\n                                int *vf G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to get virtual function info on this platform\"));\n    return -1;\n}",
    "includes": [
      "# include <linux/devlink.h>",
      "# include <net/if_dl.h>",
      "# include <sys/sockio.h>",
      "# include <linux/ethtool.h>",
      "# include <linux/types.h>",
      "# include <linux/if_vlan.h>",
      "# include <linux/sockios.h>",
      "#include <fcntl.h>",
      "# include <sys/ioctl.h>",
      "#include \"virjson.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virpci.h\"",
      "#include \"vircommand.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetlink.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetdev.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "\"%s\"",
            "_(\"Unable to get virtual function info on this platform\")"
          ],
          "line": 1519
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to get virtual function info on this platform\""
          ],
          "line": 1520
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint\nvirNetDevGetVirtualFunctionInfo(const char *vfname G_GNUC_UNUSED,\n                                char **pfname G_GNUC_UNUSED,\n                                int *vf G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to get virtual function info on this platform\"));\n    return -1;\n}"
  },
  {
    "function_name": "virNetDevPFGetVF",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
    "lines": "1504-1512",
    "snippet": "int\nvirNetDevPFGetVF(const char *pfname G_GNUC_UNUSED,\n                 int vf G_GNUC_UNUSED,\n                 char **vfname G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to get virtual function name on this platform\"));\n    return -1;\n}",
    "includes": [
      "# include <linux/devlink.h>",
      "# include <net/if_dl.h>",
      "# include <sys/sockio.h>",
      "# include <linux/ethtool.h>",
      "# include <linux/types.h>",
      "# include <linux/if_vlan.h>",
      "# include <linux/sockios.h>",
      "#include <fcntl.h>",
      "# include <sys/ioctl.h>",
      "#include \"virjson.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virpci.h\"",
      "#include \"vircommand.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetlink.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetdev.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "\"%s\"",
            "_(\"Unable to get virtual function name on this platform\")"
          ],
          "line": 1509
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to get virtual function name on this platform\""
          ],
          "line": 1510
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint\nvirNetDevPFGetVF(const char *pfname G_GNUC_UNUSED,\n                 int vf G_GNUC_UNUSED,\n                 char **vfname G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to get virtual function name on this platform\"));\n    return -1;\n}"
  },
  {
    "function_name": "virNetDevGetPhysicalFunction",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
    "lines": "1495-1502",
    "snippet": "int\nvirNetDevGetPhysicalFunction(const char *ifname G_GNUC_UNUSED,\n                             char **pfname G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to get physical function status on this platform\"));\n    return -1;\n}",
    "includes": [
      "# include <linux/devlink.h>",
      "# include <net/if_dl.h>",
      "# include <sys/sockio.h>",
      "# include <linux/ethtool.h>",
      "# include <linux/types.h>",
      "# include <linux/if_vlan.h>",
      "# include <linux/sockios.h>",
      "#include <fcntl.h>",
      "# include <sys/ioctl.h>",
      "#include \"virjson.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virpci.h\"",
      "#include \"vircommand.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetlink.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetdev.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "\"%s\"",
            "_(\"Unable to get physical function status on this platform\")"
          ],
          "line": 1499
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to get physical function status on this platform\""
          ],
          "line": 1500
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint\nvirNetDevGetPhysicalFunction(const char *ifname G_GNUC_UNUSED,\n                             char **pfname G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to get physical function status on this platform\"));\n    return -1;\n}"
  },
  {
    "function_name": "virNetDevGetVirtualFunctionIndex",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
    "lines": "1485-1493",
    "snippet": "int\nvirNetDevGetVirtualFunctionIndex(const char *pfname G_GNUC_UNUSED,\n                                 const char *vfname G_GNUC_UNUSED,\n                                 int *vf_index G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to get virtual function index on this platform\"));\n    return -1;\n}",
    "includes": [
      "# include <linux/devlink.h>",
      "# include <net/if_dl.h>",
      "# include <sys/sockio.h>",
      "# include <linux/ethtool.h>",
      "# include <linux/types.h>",
      "# include <linux/if_vlan.h>",
      "# include <linux/sockios.h>",
      "#include <fcntl.h>",
      "# include <sys/ioctl.h>",
      "#include \"virjson.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virpci.h\"",
      "#include \"vircommand.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetlink.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetdev.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "\"%s\"",
            "_(\"Unable to get virtual function index on this platform\")"
          ],
          "line": 1490
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to get virtual function index on this platform\""
          ],
          "line": 1491
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint\nvirNetDevGetVirtualFunctionIndex(const char *pfname G_GNUC_UNUSED,\n                                 const char *vfname G_GNUC_UNUSED,\n                                 int *vf_index G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to get virtual function index on this platform\"));\n    return -1;\n}"
  },
  {
    "function_name": "virNetDevIsVirtualFunction",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
    "lines": "1477-1483",
    "snippet": "int\nvirNetDevIsVirtualFunction(const char *ifname G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to check virtual function status on this platform\"));\n    return -1;\n}",
    "includes": [
      "# include <linux/devlink.h>",
      "# include <net/if_dl.h>",
      "# include <sys/sockio.h>",
      "# include <linux/ethtool.h>",
      "# include <linux/types.h>",
      "# include <linux/if_vlan.h>",
      "# include <linux/sockios.h>",
      "#include <fcntl.h>",
      "# include <sys/ioctl.h>",
      "#include \"virjson.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virpci.h\"",
      "#include \"vircommand.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetlink.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetdev.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "\"%s\"",
            "_(\"Unable to check virtual function status on this platform\")"
          ],
          "line": 1480
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to check virtual function status on this platform\""
          ],
          "line": 1481
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint\nvirNetDevIsVirtualFunction(const char *ifname G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to check virtual function status on this platform\"));\n    return -1;\n}"
  },
  {
    "function_name": "virNetDevGetVirtualFunctions",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
    "lines": "1465-1475",
    "snippet": "int\nvirNetDevGetVirtualFunctions(const char *pfname G_GNUC_UNUSED,\n                             char ***vfname G_GNUC_UNUSED,\n                             virPCIDeviceAddressPtr **virt_fns G_GNUC_UNUSED,\n                             size_t *n_vfname G_GNUC_UNUSED,\n                             unsigned int *max_vfs G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to get virtual functions on this platform\"));\n    return -1;\n}",
    "includes": [
      "# include <linux/devlink.h>",
      "# include <net/if_dl.h>",
      "# include <sys/sockio.h>",
      "# include <linux/ethtool.h>",
      "# include <linux/types.h>",
      "# include <linux/if_vlan.h>",
      "# include <linux/sockios.h>",
      "#include <fcntl.h>",
      "# include <sys/ioctl.h>",
      "#include \"virjson.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virpci.h\"",
      "#include \"vircommand.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetlink.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetdev.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "\"%s\"",
            "_(\"Unable to get virtual functions on this platform\")"
          ],
          "line": 1472
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to get virtual functions on this platform\""
          ],
          "line": 1473
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint\nvirNetDevGetVirtualFunctions(const char *pfname G_GNUC_UNUSED,\n                             char ***vfname G_GNUC_UNUSED,\n                             virPCIDeviceAddressPtr **virt_fns G_GNUC_UNUSED,\n                             size_t *n_vfname G_GNUC_UNUSED,\n                             unsigned int *max_vfs G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to get virtual functions on this platform\"));\n    return -1;\n}"
  },
  {
    "function_name": "virNetDevGetPhysPortID",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
    "lines": "1454-1463",
    "snippet": "int\nvirNetDevGetPhysPortID(const char *ifname G_GNUC_UNUSED,\n                       char **physPortID)\n{\n    /* this actually should never be called, and is just here to\n     * satisfy the linker.\n     */\n    *physPortID = NULL;\n    return 0;\n}",
    "includes": [
      "# include <linux/devlink.h>",
      "# include <net/if_dl.h>",
      "# include <sys/sockio.h>",
      "# include <linux/ethtool.h>",
      "# include <linux/types.h>",
      "# include <linux/if_vlan.h>",
      "# include <linux/sockios.h>",
      "#include <fcntl.h>",
      "# include <sys/ioctl.h>",
      "#include \"virjson.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virpci.h\"",
      "#include \"vircommand.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetlink.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetdev.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint\nvirNetDevGetPhysPortID(const char *ifname G_GNUC_UNUSED,\n                       char **physPortID)\n{\n    /* this actually should never be called, and is just here to\n     * satisfy the linker.\n     */\n    *physPortID = NULL;\n    return 0;\n}"
  },
  {
    "function_name": "virNetDevGetVirtualFunctionInfo",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
    "lines": "1434-1451",
    "snippet": "int\nvirNetDevGetVirtualFunctionInfo(const char *vfname, char **pfname,\n                                int *vf)\n{\n    int ret = -1;\n\n    if (virNetDevGetPhysicalFunction(vfname, pfname) < 0)\n        return -1;\n\n    if (virNetDevGetVirtualFunctionIndex(*pfname, vfname, vf) < 0)\n        goto cleanup;\n\n    ret = 0;\n cleanup:\n    if (ret < 0)\n        VIR_FREE(*pfname);\n    return ret;\n}",
    "includes": [
      "# include <linux/devlink.h>",
      "# include <net/if_dl.h>",
      "# include <sys/sockio.h>",
      "# include <linux/ethtool.h>",
      "# include <linux/types.h>",
      "# include <linux/if_vlan.h>",
      "# include <linux/sockios.h>",
      "#include <fcntl.h>",
      "# include <sys/ioctl.h>",
      "#include \"virjson.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virpci.h\"",
      "#include \"vircommand.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetlink.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetdev.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "*pfname"
          ],
          "line": 1449
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNetDevGetVirtualFunctionIndex",
          "args": [
            "*pfname",
            "vfname",
            "vf"
          ],
          "line": 1443
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevGetVirtualFunctionIndex",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
          "lines": "1485-1493",
          "snippet": "int\nvirNetDevGetVirtualFunctionIndex(const char *pfname G_GNUC_UNUSED,\n                                 const char *vfname G_GNUC_UNUSED,\n                                 int *vf_index G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to get virtual function index on this platform\"));\n    return -1;\n}",
          "includes": [
            "# include <linux/devlink.h>",
            "# include <net/if_dl.h>",
            "# include <sys/sockio.h>",
            "# include <linux/ethtool.h>",
            "# include <linux/types.h>",
            "# include <linux/if_vlan.h>",
            "# include <linux/sockios.h>",
            "#include <fcntl.h>",
            "# include <sys/ioctl.h>",
            "#include \"virjson.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virpci.h\"",
            "#include \"vircommand.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetlink.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetdev.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint\nvirNetDevGetVirtualFunctionIndex(const char *pfname G_GNUC_UNUSED,\n                                 const char *vfname G_GNUC_UNUSED,\n                                 int *vf_index G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to get virtual function index on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetDevGetPhysicalFunction",
          "args": [
            "vfname",
            "pfname"
          ],
          "line": 1440
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevGetPhysicalFunction",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
          "lines": "1495-1502",
          "snippet": "int\nvirNetDevGetPhysicalFunction(const char *ifname G_GNUC_UNUSED,\n                             char **pfname G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to get physical function status on this platform\"));\n    return -1;\n}",
          "includes": [
            "# include <linux/devlink.h>",
            "# include <net/if_dl.h>",
            "# include <sys/sockio.h>",
            "# include <linux/ethtool.h>",
            "# include <linux/types.h>",
            "# include <linux/if_vlan.h>",
            "# include <linux/sockios.h>",
            "#include <fcntl.h>",
            "# include <sys/ioctl.h>",
            "#include \"virjson.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virpci.h\"",
            "#include \"vircommand.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetlink.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetdev.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint\nvirNetDevGetPhysicalFunction(const char *ifname G_GNUC_UNUSED,\n                             char **pfname G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to get physical function status on this platform\"));\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint\nvirNetDevGetVirtualFunctionInfo(const char *vfname, char **pfname,\n                                int *vf)\n{\n    int ret = -1;\n\n    if (virNetDevGetPhysicalFunction(vfname, pfname) < 0)\n        return -1;\n\n    if (virNetDevGetVirtualFunctionIndex(*pfname, vfname, vf) < 0)\n        goto cleanup;\n\n    ret = 0;\n cleanup:\n    if (ret < 0)\n        VIR_FREE(*pfname);\n    return ret;\n}"
  },
  {
    "function_name": "virNetDevPFGetVF",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
    "lines": "1384-1422",
    "snippet": "int\nvirNetDevPFGetVF(const char *pfname, int vf, char **vfname)\n{\n    char *virtfnName = NULL;\n    char *virtfnSysfsPath = NULL;\n    char *pfPhysPortID = NULL;\n    int ret = -1;\n\n    /* a VF may have multiple \"ports\", each one having its own netdev,\n     * and each netdev having a different phys_port_id. Be sure we get\n     * the VF netdev with a phys_port_id matchine that of pfname\n     */\n    if (virNetDevGetPhysPortID(pfname, &pfPhysPortID) < 0)\n        goto cleanup;\n\n    virtfnName = g_strdup_printf(\"virtfn%d\", vf);\n\n    /* this provides the path to the VF's directory in sysfs,\n     * e.g. \"/sys/class/net/enp2s0f0/virtfn3\"\n     */\n    if (virNetDevSysfsDeviceFile(&virtfnSysfsPath, pfname, virtfnName) < 0)\n        goto cleanup;\n\n    /* and this gets the netdev name associated with it, which is a\n     * directory entry in [virtfnSysfsPath]/net,\n     * e.g. \"/sys/class/net/enp2s0f0/virtfn3/net/enp2s11f4\" - in this\n     * example the VF for enp2s0f0 vf#3 is \"enp2s11f4\". (If the VF\n     * isn't bound to a netdev driver, it won't have a netdev name,\n     * and vfname will be NULL).\n     */\n    ret = virPCIGetNetName(virtfnSysfsPath, 0, pfPhysPortID, vfname);\n\n cleanup:\n    VIR_FREE(virtfnName);\n    VIR_FREE(virtfnSysfsPath);\n    VIR_FREE(pfPhysPortID);\n\n    return ret;\n}",
    "includes": [
      "# include <linux/devlink.h>",
      "# include <net/if_dl.h>",
      "# include <sys/sockio.h>",
      "# include <linux/ethtool.h>",
      "# include <linux/types.h>",
      "# include <linux/if_vlan.h>",
      "# include <linux/sockios.h>",
      "#include <fcntl.h>",
      "# include <sys/ioctl.h>",
      "#include \"virjson.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virpci.h\"",
      "#include \"vircommand.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetlink.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetdev.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "pfPhysPortID"
          ],
          "line": 1419
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "virtfnSysfsPath"
          ],
          "line": 1418
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "virtfnName"
          ],
          "line": 1417
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virPCIGetNetName",
          "args": [
            "virtfnSysfsPath",
            "0",
            "pfPhysPortID",
            "vfname"
          ],
          "line": 1414
        },
        "resolved": true,
        "details": {
          "function_name": "virPCIGetNetName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virpci.c",
          "lines": "2697-2705",
          "snippet": "int\nvirPCIGetNetName(const char *device_link_sysfs_path G_GNUC_UNUSED,\n                 size_t idx G_GNUC_UNUSED,\n                 char *physPortID G_GNUC_UNUSED,\n                 char **netname G_GNUC_UNUSED)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\", _(unsupported));\n    return -1;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <inttypes.h>",
            "#include <fcntl.h>",
            "#include <dirent.h>",
            "#include \"virnetdev.h\"",
            "#include \"virpci.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <inttypes.h>\n#include <fcntl.h>\n#include <dirent.h>\n#include \"virnetdev.h\"\n#include \"virpci.h\"\n#include <config.h>\n\nint\nvirPCIGetNetName(const char *device_link_sysfs_path G_GNUC_UNUSED,\n                 size_t idx G_GNUC_UNUSED,\n                 char *physPortID G_GNUC_UNUSED,\n                 char **netname G_GNUC_UNUSED)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\", _(unsupported));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetDevSysfsDeviceFile",
          "args": [
            "&virtfnSysfsPath",
            "pfname",
            "virtfnName"
          ],
          "line": 1404
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevSysfsDeviceFile",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
          "lines": "1071-1078",
          "snippet": "static int\nvirNetDevSysfsDeviceFile(char **pf_sysfs_device_link, const char *ifname,\n                         const char *file)\n{\n    *pf_sysfs_device_link = g_strdup_printf(SYSFS_NET_DIR \"%s/device/%s\", ifname,\n                                            file);\n    return 0;\n}",
          "includes": [
            "# include <linux/devlink.h>",
            "# include <net/if_dl.h>",
            "# include <sys/sockio.h>",
            "# include <linux/ethtool.h>",
            "# include <linux/types.h>",
            "# include <linux/if_vlan.h>",
            "# include <linux/sockios.h>",
            "#include <fcntl.h>",
            "# include <sys/ioctl.h>",
            "#include \"virjson.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virpci.h\"",
            "#include \"vircommand.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetlink.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetdev.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nstatic int\nvirNetDevSysfsDeviceFile(char **pf_sysfs_device_link, const char *ifname,\n                         const char *file)\n{\n    *pf_sysfs_device_link = g_strdup_printf(SYSFS_NET_DIR \"%s/device/%s\", ifname,\n                                            file);\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"virtfn%d\"",
            "vf"
          ],
          "line": 1399
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetDevGetPhysPortID",
          "args": [
            "pfname",
            "&pfPhysPortID"
          ],
          "line": 1396
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevGetPhysPortID",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
          "lines": "1454-1463",
          "snippet": "int\nvirNetDevGetPhysPortID(const char *ifname G_GNUC_UNUSED,\n                       char **physPortID)\n{\n    /* this actually should never be called, and is just here to\n     * satisfy the linker.\n     */\n    *physPortID = NULL;\n    return 0;\n}",
          "includes": [
            "# include <linux/devlink.h>",
            "# include <net/if_dl.h>",
            "# include <sys/sockio.h>",
            "# include <linux/ethtool.h>",
            "# include <linux/types.h>",
            "# include <linux/if_vlan.h>",
            "# include <linux/sockios.h>",
            "#include <fcntl.h>",
            "# include <sys/ioctl.h>",
            "#include \"virjson.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virpci.h\"",
            "#include \"vircommand.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetlink.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetdev.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint\nvirNetDevGetPhysPortID(const char *ifname G_GNUC_UNUSED,\n                       char **physPortID)\n{\n    /* this actually should never be called, and is just here to\n     * satisfy the linker.\n     */\n    *physPortID = NULL;\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint\nvirNetDevPFGetVF(const char *pfname, int vf, char **vfname)\n{\n    char *virtfnName = NULL;\n    char *virtfnSysfsPath = NULL;\n    char *pfPhysPortID = NULL;\n    int ret = -1;\n\n    /* a VF may have multiple \"ports\", each one having its own netdev,\n     * and each netdev having a different phys_port_id. Be sure we get\n     * the VF netdev with a phys_port_id matchine that of pfname\n     */\n    if (virNetDevGetPhysPortID(pfname, &pfPhysPortID) < 0)\n        goto cleanup;\n\n    virtfnName = g_strdup_printf(\"virtfn%d\", vf);\n\n    /* this provides the path to the VF's directory in sysfs,\n     * e.g. \"/sys/class/net/enp2s0f0/virtfn3\"\n     */\n    if (virNetDevSysfsDeviceFile(&virtfnSysfsPath, pfname, virtfnName) < 0)\n        goto cleanup;\n\n    /* and this gets the netdev name associated with it, which is a\n     * directory entry in [virtfnSysfsPath]/net,\n     * e.g. \"/sys/class/net/enp2s0f0/virtfn3/net/enp2s11f4\" - in this\n     * example the VF for enp2s0f0 vf#3 is \"enp2s11f4\". (If the VF\n     * isn't bound to a netdev driver, it won't have a netdev name,\n     * and vfname will be NULL).\n     */\n    ret = virPCIGetNetName(virtfnSysfsPath, 0, pfPhysPortID, vfname);\n\n cleanup:\n    VIR_FREE(virtfnName);\n    VIR_FREE(virtfnSysfsPath);\n    VIR_FREE(pfPhysPortID);\n\n    return ret;\n}"
  },
  {
    "function_name": "virNetDevGetPhysicalFunction",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
    "lines": "1332-1364",
    "snippet": "int\nvirNetDevGetPhysicalFunction(const char *ifname, char **pfname)\n{\n    char *physfn_sysfs_path = NULL;\n    char *vfPhysPortID = NULL;\n    int ret = -1;\n\n    if (virNetDevGetPhysPortID(ifname, &vfPhysPortID) < 0)\n        goto cleanup;\n\n    if (virNetDevSysfsDeviceFile(&physfn_sysfs_path, ifname, \"physfn\") < 0)\n        goto cleanup;\n\n    if (virPCIGetNetName(physfn_sysfs_path, 0,\n                         vfPhysPortID, pfname) < 0) {\n        goto cleanup;\n    }\n\n    if (!*pfname) {\n        /* The SRIOV standard does not require VF netdevs to have\n         * the netdev assigned to a PF. */\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"The PF device for VF %s has no network device name\"),\n                       ifname);\n        goto cleanup;\n    }\n\n    ret = 0;\n cleanup:\n    VIR_FREE(vfPhysPortID);\n    VIR_FREE(physfn_sysfs_path);\n    return ret;\n}",
    "includes": [
      "# include <linux/devlink.h>",
      "# include <net/if_dl.h>",
      "# include <sys/sockio.h>",
      "# include <linux/ethtool.h>",
      "# include <linux/types.h>",
      "# include <linux/if_vlan.h>",
      "# include <linux/sockios.h>",
      "#include <fcntl.h>",
      "# include <sys/ioctl.h>",
      "#include \"virjson.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virpci.h\"",
      "#include \"vircommand.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetlink.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetdev.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "physfn_sysfs_path"
          ],
          "line": 1362
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "vfPhysPortID"
          ],
          "line": 1361
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"The PF device for VF %s has no network device name\")",
            "ifname"
          ],
          "line": 1353
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"The PF device for VF %s has no network device name\""
          ],
          "line": 1354
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virPCIGetNetName",
          "args": [
            "physfn_sysfs_path",
            "0",
            "vfPhysPortID",
            "pfname"
          ],
          "line": 1345
        },
        "resolved": true,
        "details": {
          "function_name": "virPCIGetNetName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virpci.c",
          "lines": "2697-2705",
          "snippet": "int\nvirPCIGetNetName(const char *device_link_sysfs_path G_GNUC_UNUSED,\n                 size_t idx G_GNUC_UNUSED,\n                 char *physPortID G_GNUC_UNUSED,\n                 char **netname G_GNUC_UNUSED)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\", _(unsupported));\n    return -1;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <inttypes.h>",
            "#include <fcntl.h>",
            "#include <dirent.h>",
            "#include \"virnetdev.h\"",
            "#include \"virpci.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <inttypes.h>\n#include <fcntl.h>\n#include <dirent.h>\n#include \"virnetdev.h\"\n#include \"virpci.h\"\n#include <config.h>\n\nint\nvirPCIGetNetName(const char *device_link_sysfs_path G_GNUC_UNUSED,\n                 size_t idx G_GNUC_UNUSED,\n                 char *physPortID G_GNUC_UNUSED,\n                 char **netname G_GNUC_UNUSED)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\", _(unsupported));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetDevSysfsDeviceFile",
          "args": [
            "&physfn_sysfs_path",
            "ifname",
            "\"physfn\""
          ],
          "line": 1342
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevSysfsDeviceFile",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
          "lines": "1071-1078",
          "snippet": "static int\nvirNetDevSysfsDeviceFile(char **pf_sysfs_device_link, const char *ifname,\n                         const char *file)\n{\n    *pf_sysfs_device_link = g_strdup_printf(SYSFS_NET_DIR \"%s/device/%s\", ifname,\n                                            file);\n    return 0;\n}",
          "includes": [
            "# include <linux/devlink.h>",
            "# include <net/if_dl.h>",
            "# include <sys/sockio.h>",
            "# include <linux/ethtool.h>",
            "# include <linux/types.h>",
            "# include <linux/if_vlan.h>",
            "# include <linux/sockios.h>",
            "#include <fcntl.h>",
            "# include <sys/ioctl.h>",
            "#include \"virjson.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virpci.h\"",
            "#include \"vircommand.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetlink.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetdev.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nstatic int\nvirNetDevSysfsDeviceFile(char **pf_sysfs_device_link, const char *ifname,\n                         const char *file)\n{\n    *pf_sysfs_device_link = g_strdup_printf(SYSFS_NET_DIR \"%s/device/%s\", ifname,\n                                            file);\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetDevGetPhysPortID",
          "args": [
            "ifname",
            "&vfPhysPortID"
          ],
          "line": 1339
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevGetPhysPortID",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
          "lines": "1454-1463",
          "snippet": "int\nvirNetDevGetPhysPortID(const char *ifname G_GNUC_UNUSED,\n                       char **physPortID)\n{\n    /* this actually should never be called, and is just here to\n     * satisfy the linker.\n     */\n    *physPortID = NULL;\n    return 0;\n}",
          "includes": [
            "# include <linux/devlink.h>",
            "# include <net/if_dl.h>",
            "# include <sys/sockio.h>",
            "# include <linux/ethtool.h>",
            "# include <linux/types.h>",
            "# include <linux/if_vlan.h>",
            "# include <linux/sockios.h>",
            "#include <fcntl.h>",
            "# include <sys/ioctl.h>",
            "#include \"virjson.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virpci.h\"",
            "#include \"vircommand.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetlink.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetdev.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint\nvirNetDevGetPhysPortID(const char *ifname G_GNUC_UNUSED,\n                       char **physPortID)\n{\n    /* this actually should never be called, and is just here to\n     * satisfy the linker.\n     */\n    *physPortID = NULL;\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint\nvirNetDevGetPhysicalFunction(const char *ifname, char **pfname)\n{\n    char *physfn_sysfs_path = NULL;\n    char *vfPhysPortID = NULL;\n    int ret = -1;\n\n    if (virNetDevGetPhysPortID(ifname, &vfPhysPortID) < 0)\n        goto cleanup;\n\n    if (virNetDevSysfsDeviceFile(&physfn_sysfs_path, ifname, \"physfn\") < 0)\n        goto cleanup;\n\n    if (virPCIGetNetName(physfn_sysfs_path, 0,\n                         vfPhysPortID, pfname) < 0) {\n        goto cleanup;\n    }\n\n    if (!*pfname) {\n        /* The SRIOV standard does not require VF netdevs to have\n         * the netdev assigned to a PF. */\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"The PF device for VF %s has no network device name\"),\n                       ifname);\n        goto cleanup;\n    }\n\n    ret = 0;\n cleanup:\n    VIR_FREE(vfPhysPortID);\n    VIR_FREE(physfn_sysfs_path);\n    return ret;\n}"
  },
  {
    "function_name": "virNetDevGetVirtualFunctionIndex",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
    "lines": "1297-1320",
    "snippet": "int\nvirNetDevGetVirtualFunctionIndex(const char *pfname, const char *vfname,\n                                 int *vf_index)\n{\n    char *pf_sysfs_device_link = NULL, *vf_sysfs_device_link = NULL;\n    int ret = -1;\n\n    if (virNetDevSysfsFile(&pf_sysfs_device_link, pfname, \"device\") < 0)\n        return ret;\n\n    if (virNetDevSysfsFile(&vf_sysfs_device_link, vfname, \"device\") < 0) {\n        VIR_FREE(pf_sysfs_device_link);\n        return ret;\n    }\n\n    ret = virPCIGetVirtualFunctionIndex(pf_sysfs_device_link,\n                                        vf_sysfs_device_link,\n                                        vf_index);\n\n    VIR_FREE(pf_sysfs_device_link);\n    VIR_FREE(vf_sysfs_device_link);\n\n    return ret;\n}",
    "includes": [
      "# include <linux/devlink.h>",
      "# include <net/if_dl.h>",
      "# include <sys/sockio.h>",
      "# include <linux/ethtool.h>",
      "# include <linux/types.h>",
      "# include <linux/if_vlan.h>",
      "# include <linux/sockios.h>",
      "#include <fcntl.h>",
      "# include <sys/ioctl.h>",
      "#include \"virjson.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virpci.h\"",
      "#include \"vircommand.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetlink.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetdev.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "vf_sysfs_device_link"
          ],
          "line": 1317
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "pf_sysfs_device_link"
          ],
          "line": 1316
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virPCIGetVirtualFunctionIndex",
          "args": [
            "pf_sysfs_device_link",
            "vf_sysfs_device_link",
            "vf_index"
          ],
          "line": 1312
        },
        "resolved": true,
        "details": {
          "function_name": "virPCIGetVirtualFunctionIndex",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virpci.c",
          "lines": "2671-2679",
          "snippet": "int\nvirPCIGetVirtualFunctionIndex(const char *pf_sysfs_device_link G_GNUC_UNUSED,\n                              const char *vf_sysfs_device_link G_GNUC_UNUSED,\n                              int *vf_index G_GNUC_UNUSED)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\", _(unsupported));\n    return -1;\n\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <inttypes.h>",
            "#include <fcntl.h>",
            "#include <dirent.h>",
            "#include \"virnetdev.h\"",
            "#include \"virpci.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <inttypes.h>\n#include <fcntl.h>\n#include <dirent.h>\n#include \"virnetdev.h\"\n#include \"virpci.h\"\n#include <config.h>\n\nint\nvirPCIGetVirtualFunctionIndex(const char *pf_sysfs_device_link G_GNUC_UNUSED,\n                              const char *vf_sysfs_device_link G_GNUC_UNUSED,\n                              int *vf_index G_GNUC_UNUSED)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\", _(unsupported));\n    return -1;\n\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "pf_sysfs_device_link"
          ],
          "line": 1308
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNetDevSysfsFile",
          "args": [
            "&vf_sysfs_device_link",
            "vfname",
            "\"device\""
          ],
          "line": 1307
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevSysfsFile",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
          "lines": "1524-1532",
          "snippet": "int\nvirNetDevSysfsFile(char **pf_sysfs_device_link G_GNUC_UNUSED,\n                   const char *ifname G_GNUC_UNUSED,\n                   const char *file G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to get sysfs info on this platform\"));\n    return -1;\n}",
          "includes": [
            "# include <linux/devlink.h>",
            "# include <net/if_dl.h>",
            "# include <sys/sockio.h>",
            "# include <linux/ethtool.h>",
            "# include <linux/types.h>",
            "# include <linux/if_vlan.h>",
            "# include <linux/sockios.h>",
            "#include <fcntl.h>",
            "# include <sys/ioctl.h>",
            "#include \"virjson.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virpci.h\"",
            "#include \"vircommand.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetlink.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetdev.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint\nvirNetDevSysfsFile(char **pf_sysfs_device_link G_GNUC_UNUSED,\n                   const char *ifname G_GNUC_UNUSED,\n                   const char *file G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to get sysfs info on this platform\"));\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint\nvirNetDevGetVirtualFunctionIndex(const char *pfname, const char *vfname,\n                                 int *vf_index)\n{\n    char *pf_sysfs_device_link = NULL, *vf_sysfs_device_link = NULL;\n    int ret = -1;\n\n    if (virNetDevSysfsFile(&pf_sysfs_device_link, pfname, \"device\") < 0)\n        return ret;\n\n    if (virNetDevSysfsFile(&vf_sysfs_device_link, vfname, \"device\") < 0) {\n        VIR_FREE(pf_sysfs_device_link);\n        return ret;\n    }\n\n    ret = virPCIGetVirtualFunctionIndex(pf_sysfs_device_link,\n                                        vf_sysfs_device_link,\n                                        vf_index);\n\n    VIR_FREE(pf_sysfs_device_link);\n    VIR_FREE(vf_sysfs_device_link);\n\n    return ret;\n}"
  },
  {
    "function_name": "virNetDevIsVirtualFunction",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
    "lines": "1270-1284",
    "snippet": "int\nvirNetDevIsVirtualFunction(const char *ifname)\n{\n    char *if_sysfs_device_link = NULL;\n    int ret = -1;\n\n    if (virNetDevSysfsFile(&if_sysfs_device_link, ifname, \"device\") < 0)\n        return ret;\n\n    ret = virPCIIsVirtualFunction(if_sysfs_device_link);\n\n    VIR_FREE(if_sysfs_device_link);\n\n    return ret;\n}",
    "includes": [
      "# include <linux/devlink.h>",
      "# include <net/if_dl.h>",
      "# include <sys/sockio.h>",
      "# include <linux/ethtool.h>",
      "# include <linux/types.h>",
      "# include <linux/if_vlan.h>",
      "# include <linux/sockios.h>",
      "#include <fcntl.h>",
      "# include <sys/ioctl.h>",
      "#include \"virjson.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virpci.h\"",
      "#include \"vircommand.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetlink.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetdev.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "if_sysfs_device_link"
          ],
          "line": 1281
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virPCIIsVirtualFunction",
          "args": [
            "if_sysfs_device_link"
          ],
          "line": 1279
        },
        "resolved": true,
        "details": {
          "function_name": "virPCIIsVirtualFunction",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virpci.c",
          "lines": "2664-2669",
          "snippet": "int\nvirPCIIsVirtualFunction(const char *vf_sysfs_device_link G_GNUC_UNUSED)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\", _(unsupported));\n    return -1;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <inttypes.h>",
            "#include <fcntl.h>",
            "#include <dirent.h>",
            "#include \"virnetdev.h\"",
            "#include \"virpci.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <inttypes.h>\n#include <fcntl.h>\n#include <dirent.h>\n#include \"virnetdev.h\"\n#include \"virpci.h\"\n#include <config.h>\n\nint\nvirPCIIsVirtualFunction(const char *vf_sysfs_device_link G_GNUC_UNUSED)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\", _(unsupported));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetDevSysfsFile",
          "args": [
            "&if_sysfs_device_link",
            "ifname",
            "\"device\""
          ],
          "line": 1276
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevSysfsFile",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
          "lines": "1524-1532",
          "snippet": "int\nvirNetDevSysfsFile(char **pf_sysfs_device_link G_GNUC_UNUSED,\n                   const char *ifname G_GNUC_UNUSED,\n                   const char *file G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to get sysfs info on this platform\"));\n    return -1;\n}",
          "includes": [
            "# include <linux/devlink.h>",
            "# include <net/if_dl.h>",
            "# include <sys/sockio.h>",
            "# include <linux/ethtool.h>",
            "# include <linux/types.h>",
            "# include <linux/if_vlan.h>",
            "# include <linux/sockios.h>",
            "#include <fcntl.h>",
            "# include <sys/ioctl.h>",
            "#include \"virjson.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virpci.h\"",
            "#include \"vircommand.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetlink.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetdev.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint\nvirNetDevSysfsFile(char **pf_sysfs_device_link G_GNUC_UNUSED,\n                   const char *ifname G_GNUC_UNUSED,\n                   const char *file G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to get sysfs info on this platform\"));\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint\nvirNetDevIsVirtualFunction(const char *ifname)\n{\n    char *if_sysfs_device_link = NULL;\n    int ret = -1;\n\n    if (virNetDevSysfsFile(&if_sysfs_device_link, ifname, \"device\") < 0)\n        return ret;\n\n    ret = virPCIIsVirtualFunction(if_sysfs_device_link);\n\n    VIR_FREE(if_sysfs_device_link);\n\n    return ret;\n}"
  },
  {
    "function_name": "virNetDevGetVirtualFunctions",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
    "lines": "1197-1259",
    "snippet": "int\nvirNetDevGetVirtualFunctions(const char *pfname,\n                             char ***vfname,\n                             virPCIDeviceAddressPtr **virt_fns,\n                             size_t *n_vfname,\n                             unsigned int *max_vfs)\n{\n    int ret = -1;\n    size_t i;\n    char *pf_sysfs_device_link = NULL;\n    char *pci_sysfs_device_link = NULL;\n    char *pciConfigAddr = NULL;\n    char *pfPhysPortID = NULL;\n\n    *virt_fns = NULL;\n    *n_vfname = 0;\n    *max_vfs = 0;\n\n    if (virNetDevGetPhysPortID(pfname, &pfPhysPortID) < 0)\n        goto cleanup;\n\n    if (virNetDevSysfsFile(&pf_sysfs_device_link, pfname, \"device\") < 0)\n        goto cleanup;\n\n    if (virPCIGetVirtualFunctions(pf_sysfs_device_link, virt_fns,\n                                  n_vfname, max_vfs) < 0)\n        goto cleanup;\n\n    if (VIR_ALLOC_N(*vfname, *n_vfname) < 0)\n        goto cleanup;\n\n    for (i = 0; i < *n_vfname; i++) {\n        if (!(pciConfigAddr = virPCIDeviceAddressAsString((*virt_fns)[i])))\n            goto cleanup;\n\n        if (virPCIGetSysfsFile(pciConfigAddr, &pci_sysfs_device_link) < 0) {\n            virReportSystemError(ENOSYS, \"%s\",\n                                 _(\"Failed to get PCI SYSFS file\"));\n            goto cleanup;\n        }\n\n        if (virPCIGetNetName(pci_sysfs_device_link, 0,\n                             pfPhysPortID, &((*vfname)[i])) < 0) {\n            goto cleanup;\n        }\n\n        if (!(*vfname)[i])\n            VIR_INFO(\"VF does not have an interface name\");\n    }\n\n    ret = 0;\n\n cleanup:\n    if (ret < 0) {\n        VIR_FREE(*vfname);\n        VIR_FREE(*virt_fns);\n    }\n    VIR_FREE(pfPhysPortID);\n    VIR_FREE(pf_sysfs_device_link);\n    VIR_FREE(pci_sysfs_device_link);\n    VIR_FREE(pciConfigAddr);\n    return ret;\n}",
    "includes": [
      "# include <linux/devlink.h>",
      "# include <net/if_dl.h>",
      "# include <sys/sockio.h>",
      "# include <linux/ethtool.h>",
      "# include <linux/types.h>",
      "# include <linux/if_vlan.h>",
      "# include <linux/sockios.h>",
      "#include <fcntl.h>",
      "# include <sys/ioctl.h>",
      "#include \"virjson.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virpci.h\"",
      "#include \"vircommand.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetlink.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetdev.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "size_t i;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "pciConfigAddr"
          ],
          "line": 1257
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "pci_sysfs_device_link"
          ],
          "line": 1256
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "pf_sysfs_device_link"
          ],
          "line": 1255
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "pfPhysPortID"
          ],
          "line": 1254
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "*virt_fns"
          ],
          "line": 1252
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "*vfname"
          ],
          "line": 1251
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_INFO",
          "args": [
            "\"VF does not have an interface name\""
          ],
          "line": 1244
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virPCIGetNetName",
          "args": [
            "pci_sysfs_device_link",
            "0",
            "pfPhysPortID",
            "&((*vfname)[i])"
          ],
          "line": 1238
        },
        "resolved": true,
        "details": {
          "function_name": "virPCIGetNetName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virpci.c",
          "lines": "2697-2705",
          "snippet": "int\nvirPCIGetNetName(const char *device_link_sysfs_path G_GNUC_UNUSED,\n                 size_t idx G_GNUC_UNUSED,\n                 char *physPortID G_GNUC_UNUSED,\n                 char **netname G_GNUC_UNUSED)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\", _(unsupported));\n    return -1;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <inttypes.h>",
            "#include <fcntl.h>",
            "#include <dirent.h>",
            "#include \"virnetdev.h\"",
            "#include \"virpci.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <inttypes.h>\n#include <fcntl.h>\n#include <dirent.h>\n#include \"virnetdev.h\"\n#include \"virpci.h\"\n#include <config.h>\n\nint\nvirPCIGetNetName(const char *device_link_sysfs_path G_GNUC_UNUSED,\n                 size_t idx G_GNUC_UNUSED,\n                 char *physPortID G_GNUC_UNUSED,\n                 char **netname G_GNUC_UNUSED)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\", _(unsupported));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "\"%s\"",
            "_(\"Failed to get PCI SYSFS file\")"
          ],
          "line": 1233
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Failed to get PCI SYSFS file\""
          ],
          "line": 1234
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virPCIGetSysfsFile",
          "args": [
            "pciConfigAddr",
            "&pci_sysfs_device_link"
          ],
          "line": 1232
        },
        "resolved": true,
        "details": {
          "function_name": "virPCIGetSysfsFile",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virpci.c",
          "lines": "2681-2687",
          "snippet": "int\nvirPCIGetSysfsFile(char *virPCIDeviceName G_GNUC_UNUSED,\n                   char **pci_sysfs_device_link G_GNUC_UNUSED)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\", _(unsupported));\n    return -1;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <inttypes.h>",
            "#include <fcntl.h>",
            "#include <dirent.h>",
            "#include \"virnetdev.h\"",
            "#include \"virpci.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <inttypes.h>\n#include <fcntl.h>\n#include <dirent.h>\n#include \"virnetdev.h\"\n#include \"virpci.h\"\n#include <config.h>\n\nint\nvirPCIGetSysfsFile(char *virPCIDeviceName G_GNUC_UNUSED,\n                   char **pci_sysfs_device_link G_GNUC_UNUSED)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\", _(unsupported));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virPCIDeviceAddressAsString",
          "args": [
            "(*virt_fns)[i]"
          ],
          "line": 1229
        },
        "resolved": true,
        "details": {
          "function_name": "virPCIDeviceAddressAsString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virpci.c",
          "lines": "1351-1362",
          "snippet": "char *\nvirPCIDeviceAddressAsString(const virPCIDeviceAddress *addr)\n{\n    char *str;\n\n    str = g_strdup_printf(VIR_PCI_DEVICE_ADDRESS_FMT,\n                          addr->domain,\n                          addr->bus,\n                          addr->slot,\n                          addr->function);\n    return str;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <inttypes.h>",
            "#include <fcntl.h>",
            "#include <dirent.h>",
            "#include \"virnetdev.h\"",
            "#include \"virpci.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <inttypes.h>\n#include <fcntl.h>\n#include <dirent.h>\n#include \"virnetdev.h\"\n#include \"virpci.h\"\n#include <config.h>\n\nchar *\nvirPCIDeviceAddressAsString(const virPCIDeviceAddress *addr)\n{\n    char *str;\n\n    str = g_strdup_printf(VIR_PCI_DEVICE_ADDRESS_FMT,\n                          addr->domain,\n                          addr->bus,\n                          addr->slot,\n                          addr->function);\n    return str;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC_N",
          "args": [
            "*vfname",
            "*n_vfname"
          ],
          "line": 1225
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virPCIGetVirtualFunctions",
          "args": [
            "pf_sysfs_device_link",
            "virt_fns",
            "n_vfname",
            "max_vfs"
          ],
          "line": 1221
        },
        "resolved": true,
        "details": {
          "function_name": "virPCIGetVirtualFunctions",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virpci.c",
          "lines": "2654-2662",
          "snippet": "int\nvirPCIGetVirtualFunctions(const char *sysfs_path G_GNUC_UNUSED,\n                          virPCIDeviceAddressPtr **virtual_functions G_GNUC_UNUSED,\n                          size_t *num_virtual_functions G_GNUC_UNUSED,\n                          unsigned int *max_virtual_functions G_GNUC_UNUSED)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\", _(unsupported));\n    return -1;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <inttypes.h>",
            "#include <fcntl.h>",
            "#include <dirent.h>",
            "#include \"virnetdev.h\"",
            "#include \"virpci.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <inttypes.h>\n#include <fcntl.h>\n#include <dirent.h>\n#include \"virnetdev.h\"\n#include \"virpci.h\"\n#include <config.h>\n\nint\nvirPCIGetVirtualFunctions(const char *sysfs_path G_GNUC_UNUSED,\n                          virPCIDeviceAddressPtr **virtual_functions G_GNUC_UNUSED,\n                          size_t *num_virtual_functions G_GNUC_UNUSED,\n                          unsigned int *max_virtual_functions G_GNUC_UNUSED)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\", _(unsupported));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetDevSysfsFile",
          "args": [
            "&pf_sysfs_device_link",
            "pfname",
            "\"device\""
          ],
          "line": 1218
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevSysfsFile",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
          "lines": "1524-1532",
          "snippet": "int\nvirNetDevSysfsFile(char **pf_sysfs_device_link G_GNUC_UNUSED,\n                   const char *ifname G_GNUC_UNUSED,\n                   const char *file G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to get sysfs info on this platform\"));\n    return -1;\n}",
          "includes": [
            "# include <linux/devlink.h>",
            "# include <net/if_dl.h>",
            "# include <sys/sockio.h>",
            "# include <linux/ethtool.h>",
            "# include <linux/types.h>",
            "# include <linux/if_vlan.h>",
            "# include <linux/sockios.h>",
            "#include <fcntl.h>",
            "# include <sys/ioctl.h>",
            "#include \"virjson.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virpci.h\"",
            "#include \"vircommand.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetlink.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetdev.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint\nvirNetDevSysfsFile(char **pf_sysfs_device_link G_GNUC_UNUSED,\n                   const char *ifname G_GNUC_UNUSED,\n                   const char *file G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to get sysfs info on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetDevGetPhysPortID",
          "args": [
            "pfname",
            "&pfPhysPortID"
          ],
          "line": 1215
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevGetPhysPortID",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
          "lines": "1454-1463",
          "snippet": "int\nvirNetDevGetPhysPortID(const char *ifname G_GNUC_UNUSED,\n                       char **physPortID)\n{\n    /* this actually should never be called, and is just here to\n     * satisfy the linker.\n     */\n    *physPortID = NULL;\n    return 0;\n}",
          "includes": [
            "# include <linux/devlink.h>",
            "# include <net/if_dl.h>",
            "# include <sys/sockio.h>",
            "# include <linux/ethtool.h>",
            "# include <linux/types.h>",
            "# include <linux/if_vlan.h>",
            "# include <linux/sockios.h>",
            "#include <fcntl.h>",
            "# include <sys/ioctl.h>",
            "#include \"virjson.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virpci.h\"",
            "#include \"vircommand.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetlink.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetdev.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint\nvirNetDevGetPhysPortID(const char *ifname G_GNUC_UNUSED,\n                       char **physPortID)\n{\n    /* this actually should never be called, and is just here to\n     * satisfy the linker.\n     */\n    *physPortID = NULL;\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nsize_t i;\n\nint\nvirNetDevGetVirtualFunctions(const char *pfname,\n                             char ***vfname,\n                             virPCIDeviceAddressPtr **virt_fns,\n                             size_t *n_vfname,\n                             unsigned int *max_vfs)\n{\n    int ret = -1;\n    size_t i;\n    char *pf_sysfs_device_link = NULL;\n    char *pci_sysfs_device_link = NULL;\n    char *pciConfigAddr = NULL;\n    char *pfPhysPortID = NULL;\n\n    *virt_fns = NULL;\n    *n_vfname = 0;\n    *max_vfs = 0;\n\n    if (virNetDevGetPhysPortID(pfname, &pfPhysPortID) < 0)\n        goto cleanup;\n\n    if (virNetDevSysfsFile(&pf_sysfs_device_link, pfname, \"device\") < 0)\n        goto cleanup;\n\n    if (virPCIGetVirtualFunctions(pf_sysfs_device_link, virt_fns,\n                                  n_vfname, max_vfs) < 0)\n        goto cleanup;\n\n    if (VIR_ALLOC_N(*vfname, *n_vfname) < 0)\n        goto cleanup;\n\n    for (i = 0; i < *n_vfname; i++) {\n        if (!(pciConfigAddr = virPCIDeviceAddressAsString((*virt_fns)[i])))\n            goto cleanup;\n\n        if (virPCIGetSysfsFile(pciConfigAddr, &pci_sysfs_device_link) < 0) {\n            virReportSystemError(ENOSYS, \"%s\",\n                                 _(\"Failed to get PCI SYSFS file\"));\n            goto cleanup;\n        }\n\n        if (virPCIGetNetName(pci_sysfs_device_link, 0,\n                             pfPhysPortID, &((*vfname)[i])) < 0) {\n            goto cleanup;\n        }\n\n        if (!(*vfname)[i])\n            VIR_INFO(\"VF does not have an interface name\");\n    }\n\n    ret = 0;\n\n cleanup:\n    if (ret < 0) {\n        VIR_FREE(*vfname);\n        VIR_FREE(*virt_fns);\n    }\n    VIR_FREE(pfPhysPortID);\n    VIR_FREE(pf_sysfs_device_link);\n    VIR_FREE(pci_sysfs_device_link);\n    VIR_FREE(pciConfigAddr);\n    return ret;\n}"
  },
  {
    "function_name": "virNetDevGetPhysPortID",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
    "lines": "1161-1184",
    "snippet": "int\nvirNetDevGetPhysPortID(const char *ifname,\n                       char **physPortID)\n{\n    int ret = -1;\n    char *physPortIDFile = NULL;\n\n    *physPortID = NULL;\n\n    if (virNetDevSysfsFile(&physPortIDFile, ifname, \"phys_port_id\") < 0)\n        goto cleanup;\n\n    /* a failure to read just means the driver doesn't support\n     * phys_port_id, so set success now and ignore the return from\n     * virFileReadAllQuiet().\n     */\n    ret = 0;\n\n    ignore_value(virFileReadAllQuiet(physPortIDFile, 1024, physPortID));\n\n cleanup:\n    VIR_FREE(physPortIDFile);\n    return ret;\n}",
    "includes": [
      "# include <linux/devlink.h>",
      "# include <net/if_dl.h>",
      "# include <sys/sockio.h>",
      "# include <linux/ethtool.h>",
      "# include <linux/types.h>",
      "# include <linux/if_vlan.h>",
      "# include <linux/sockios.h>",
      "#include <fcntl.h>",
      "# include <sys/ioctl.h>",
      "#include \"virjson.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virpci.h\"",
      "#include \"vircommand.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetlink.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetdev.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "physPortIDFile"
          ],
          "line": 1182
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ignore_value",
          "args": [
            "virFileReadAllQuiet(physPortIDFile, 1024, physPortID)"
          ],
          "line": 1179
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virFileReadAllQuiet",
          "args": [
            "physPortIDFile",
            "1024",
            "physPortID"
          ],
          "line": 1179
        },
        "resolved": true,
        "details": {
          "function_name": "virFileReadAllQuiet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1459-1472",
          "snippet": "int\nvirFileReadAllQuiet(const char *path, int maxlen, char **buf)\n{\n    int fd = open(path, O_RDONLY);\n    if (fd < 0)\n        return -errno;\n\n    int len = virFileReadLimFD(fd, maxlen, buf);\n    VIR_FORCE_CLOSE(fd);\n    if (len < 0)\n        return -errno;\n\n    return len;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileReadAllQuiet(const char *path, int maxlen, char **buf)\n{\n    int fd = open(path, O_RDONLY);\n    if (fd < 0)\n        return -errno;\n\n    int len = virFileReadLimFD(fd, maxlen, buf);\n    VIR_FORCE_CLOSE(fd);\n    if (len < 0)\n        return -errno;\n\n    return len;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetDevSysfsFile",
          "args": [
            "&physPortIDFile",
            "ifname",
            "\"phys_port_id\""
          ],
          "line": 1170
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevSysfsFile",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
          "lines": "1524-1532",
          "snippet": "int\nvirNetDevSysfsFile(char **pf_sysfs_device_link G_GNUC_UNUSED,\n                   const char *ifname G_GNUC_UNUSED,\n                   const char *file G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to get sysfs info on this platform\"));\n    return -1;\n}",
          "includes": [
            "# include <linux/devlink.h>",
            "# include <net/if_dl.h>",
            "# include <sys/sockio.h>",
            "# include <linux/ethtool.h>",
            "# include <linux/types.h>",
            "# include <linux/if_vlan.h>",
            "# include <linux/sockios.h>",
            "#include <fcntl.h>",
            "# include <sys/ioctl.h>",
            "#include \"virjson.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virpci.h\"",
            "#include \"vircommand.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetlink.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetdev.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint\nvirNetDevSysfsFile(char **pf_sysfs_device_link G_GNUC_UNUSED,\n                   const char *ifname G_GNUC_UNUSED,\n                   const char *file G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to get sysfs info on this platform\"));\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint\nvirNetDevGetPhysPortID(const char *ifname,\n                       char **physPortID)\n{\n    int ret = -1;\n    char *physPortIDFile = NULL;\n\n    *physPortID = NULL;\n\n    if (virNetDevSysfsFile(&physPortIDFile, ifname, \"phys_port_id\") < 0)\n        goto cleanup;\n\n    /* a failure to read just means the driver doesn't support\n     * phys_port_id, so set success now and ignore the return from\n     * virFileReadAllQuiet().\n     */\n    ret = 0;\n\n    ignore_value(virFileReadAllQuiet(physPortIDFile, 1024, physPortID));\n\n cleanup:\n    VIR_FREE(physPortIDFile);\n    return ret;\n}"
  },
  {
    "function_name": "virNetDevGetPCIDevice",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
    "lines": "1119-1144",
    "snippet": "static virPCIDevicePtr\nvirNetDevGetPCIDevice(const char *devName)\n{\n    char *vfSysfsDevicePath = NULL;\n    virPCIDeviceAddressPtr vfPCIAddr = NULL;\n    virPCIDevicePtr vfPCIDevice = NULL;\n\n    if (virNetDevSysfsFile(&vfSysfsDevicePath, devName, \"device\") < 0)\n        goto cleanup;\n\n    if (!virNetDevIsPCIDevice(vfSysfsDevicePath))\n        goto cleanup;\n\n    vfPCIAddr = virPCIGetDeviceAddressFromSysfsLink(vfSysfsDevicePath);\n    if (!vfPCIAddr)\n        goto cleanup;\n\n    vfPCIDevice = virPCIDeviceNew(vfPCIAddr->domain, vfPCIAddr->bus,\n                                  vfPCIAddr->slot, vfPCIAddr->function);\n\n cleanup:\n    VIR_FREE(vfSysfsDevicePath);\n    VIR_FREE(vfPCIAddr);\n\n    return vfPCIDevice;\n}",
    "includes": [
      "# include <linux/devlink.h>",
      "# include <net/if_dl.h>",
      "# include <sys/sockio.h>",
      "# include <linux/ethtool.h>",
      "# include <linux/types.h>",
      "# include <linux/if_vlan.h>",
      "# include <linux/sockios.h>",
      "#include <fcntl.h>",
      "# include <sys/ioctl.h>",
      "#include \"virjson.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virpci.h\"",
      "#include \"vircommand.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetlink.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetdev.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "vfPCIAddr"
          ],
          "line": 1141
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "vfSysfsDevicePath"
          ],
          "line": 1140
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virPCIDeviceNew",
          "args": [
            "vfPCIAddr->domain",
            "vfPCIAddr->bus",
            "vfPCIAddr->slot",
            "vfPCIAddr->function"
          ],
          "line": 1136
        },
        "resolved": true,
        "details": {
          "function_name": "virPCIDeviceNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virpci.c",
          "lines": "1364-1416",
          "snippet": "virPCIDevicePtr\nvirPCIDeviceNew(unsigned int domain,\n                unsigned int bus,\n                unsigned int slot,\n                unsigned int function)\n{\n    g_autoptr(virPCIDevice) dev = NULL;\n    g_autofree char *vendor = NULL;\n    g_autofree char *product = NULL;\n\n    if (VIR_ALLOC(dev) < 0)\n        return NULL;\n\n    dev->address.domain = domain;\n    dev->address.bus = bus;\n    dev->address.slot = slot;\n    dev->address.function = function;\n\n    dev->name = g_strdup_printf(VIR_PCI_DEVICE_ADDRESS_FMT, domain, bus, slot,\n                                function);\n\n    dev->path = g_strdup_printf(PCI_SYSFS \"devices/%s/config\", dev->name);\n\n    if (!virFileExists(dev->path)) {\n        virReportSystemError(errno,\n                             _(\"Device %s not found: could not access %s\"),\n                             dev->name, dev->path);\n        return NULL;\n    }\n\n    vendor  = virPCIDeviceReadID(dev, \"vendor\");\n    product = virPCIDeviceReadID(dev, \"device\");\n\n    if (!vendor || !product) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Failed to read product/vendor ID for %s\"),\n                       dev->name);\n        return NULL;\n    }\n\n    /* strings contain '0x' prefix */\n    if (g_snprintf(dev->id, sizeof(dev->id), \"%s %s\", &vendor[2],\n                   &product[2]) >= sizeof(dev->id)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"dev->id buffer overflow: %s %s\"),\n                       &vendor[2], &product[2]);\n        return NULL;\n    }\n\n    VIR_DEBUG(\"%s %s: initialized\", dev->id, dev->name);\n\n    return g_steal_pointer(&dev);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <inttypes.h>",
            "#include <fcntl.h>",
            "#include <dirent.h>",
            "#include \"virnetdev.h\"",
            "#include \"virpci.h\"",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define PCI_SYSFS \"/sys/bus/pci/\""
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <inttypes.h>\n#include <fcntl.h>\n#include <dirent.h>\n#include \"virnetdev.h\"\n#include \"virpci.h\"\n#include <config.h>\n\n#define PCI_SYSFS \"/sys/bus/pci/\"\n\nvirPCIDevicePtr\nvirPCIDeviceNew(unsigned int domain,\n                unsigned int bus,\n                unsigned int slot,\n                unsigned int function)\n{\n    g_autoptr(virPCIDevice) dev = NULL;\n    g_autofree char *vendor = NULL;\n    g_autofree char *product = NULL;\n\n    if (VIR_ALLOC(dev) < 0)\n        return NULL;\n\n    dev->address.domain = domain;\n    dev->address.bus = bus;\n    dev->address.slot = slot;\n    dev->address.function = function;\n\n    dev->name = g_strdup_printf(VIR_PCI_DEVICE_ADDRESS_FMT, domain, bus, slot,\n                                function);\n\n    dev->path = g_strdup_printf(PCI_SYSFS \"devices/%s/config\", dev->name);\n\n    if (!virFileExists(dev->path)) {\n        virReportSystemError(errno,\n                             _(\"Device %s not found: could not access %s\"),\n                             dev->name, dev->path);\n        return NULL;\n    }\n\n    vendor  = virPCIDeviceReadID(dev, \"vendor\");\n    product = virPCIDeviceReadID(dev, \"device\");\n\n    if (!vendor || !product) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Failed to read product/vendor ID for %s\"),\n                       dev->name);\n        return NULL;\n    }\n\n    /* strings contain '0x' prefix */\n    if (g_snprintf(dev->id, sizeof(dev->id), \"%s %s\", &vendor[2],\n                   &product[2]) >= sizeof(dev->id)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"dev->id buffer overflow: %s %s\"),\n                       &vendor[2], &product[2]);\n        return NULL;\n    }\n\n    VIR_DEBUG(\"%s %s: initialized\", dev->id, dev->name);\n\n    return g_steal_pointer(&dev);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virPCIGetDeviceAddressFromSysfsLink",
          "args": [
            "vfSysfsDevicePath"
          ],
          "line": 1132
        },
        "resolved": true,
        "details": {
          "function_name": "virPCIGetDeviceAddressFromSysfsLink",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virpci.c",
          "lines": "2638-2643",
          "snippet": "virPCIDeviceAddressPtr\nvirPCIGetDeviceAddressFromSysfsLink(const char *device_link G_GNUC_UNUSED)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\", _(unsupported));\n    return NULL;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"virlog.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <inttypes.h>",
            "#include <fcntl.h>",
            "#include <dirent.h>",
            "#include \"virnetdev.h\"",
            "#include \"virpci.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"virlog.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <inttypes.h>\n#include <fcntl.h>\n#include <dirent.h>\n#include \"virnetdev.h\"\n#include \"virpci.h\"\n#include <config.h>\n\nvirPCIDeviceAddressPtr\nvirPCIGetDeviceAddressFromSysfsLink(const char *device_link G_GNUC_UNUSED)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\", _(unsupported));\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetDevIsPCIDevice",
          "args": [
            "vfSysfsDevicePath"
          ],
          "line": 1129
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevIsPCIDevice",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
          "lines": "1090-1117",
          "snippet": "static bool\nvirNetDevIsPCIDevice(const char *devpath)\n{\n    char *subsys_link = NULL;\n    char *abs_path = NULL;\n    g_autofree char *subsys = NULL;\n    bool ret = false;\n\n    subsys_link = g_strdup_printf(\"%s/subsystem\", devpath);\n\n    if (!virFileExists(subsys_link))\n        goto cleanup;\n\n    if (virFileResolveLink(subsys_link, &abs_path) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Unable to resolve device subsystem symlink %s\"),\n                       subsys_link);\n        goto cleanup;\n    }\n\n    subsys = g_path_get_basename(abs_path);\n    ret = STRPREFIX(subsys, \"pci\");\n\n cleanup:\n    VIR_FREE(subsys_link);\n    VIR_FREE(abs_path);\n    return ret;\n}",
          "includes": [
            "# include <linux/devlink.h>",
            "# include <net/if_dl.h>",
            "# include <sys/sockio.h>",
            "# include <linux/ethtool.h>",
            "# include <linux/types.h>",
            "# include <linux/if_vlan.h>",
            "# include <linux/sockios.h>",
            "#include <fcntl.h>",
            "# include <sys/ioctl.h>",
            "#include \"virjson.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virpci.h\"",
            "#include \"vircommand.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetlink.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetdev.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nstatic bool\nvirNetDevIsPCIDevice(const char *devpath)\n{\n    char *subsys_link = NULL;\n    char *abs_path = NULL;\n    g_autofree char *subsys = NULL;\n    bool ret = false;\n\n    subsys_link = g_strdup_printf(\"%s/subsystem\", devpath);\n\n    if (!virFileExists(subsys_link))\n        goto cleanup;\n\n    if (virFileResolveLink(subsys_link, &abs_path) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Unable to resolve device subsystem symlink %s\"),\n                       subsys_link);\n        goto cleanup;\n    }\n\n    subsys = g_path_get_basename(abs_path);\n    ret = STRPREFIX(subsys, \"pci\");\n\n cleanup:\n    VIR_FREE(subsys_link);\n    VIR_FREE(abs_path);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetDevSysfsFile",
          "args": [
            "&vfSysfsDevicePath",
            "devName",
            "\"device\""
          ],
          "line": 1126
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevSysfsFile",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
          "lines": "1524-1532",
          "snippet": "int\nvirNetDevSysfsFile(char **pf_sysfs_device_link G_GNUC_UNUSED,\n                   const char *ifname G_GNUC_UNUSED,\n                   const char *file G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to get sysfs info on this platform\"));\n    return -1;\n}",
          "includes": [
            "# include <linux/devlink.h>",
            "# include <net/if_dl.h>",
            "# include <sys/sockio.h>",
            "# include <linux/ethtool.h>",
            "# include <linux/types.h>",
            "# include <linux/if_vlan.h>",
            "# include <linux/sockios.h>",
            "#include <fcntl.h>",
            "# include <sys/ioctl.h>",
            "#include \"virjson.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virpci.h\"",
            "#include \"vircommand.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetlink.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetdev.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint\nvirNetDevSysfsFile(char **pf_sysfs_device_link G_GNUC_UNUSED,\n                   const char *ifname G_GNUC_UNUSED,\n                   const char *file G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to get sysfs info on this platform\"));\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nstatic virPCIDevicePtr\nvirNetDevGetPCIDevice(const char *devName)\n{\n    char *vfSysfsDevicePath = NULL;\n    virPCIDeviceAddressPtr vfPCIAddr = NULL;\n    virPCIDevicePtr vfPCIDevice = NULL;\n\n    if (virNetDevSysfsFile(&vfSysfsDevicePath, devName, \"device\") < 0)\n        goto cleanup;\n\n    if (!virNetDevIsPCIDevice(vfSysfsDevicePath))\n        goto cleanup;\n\n    vfPCIAddr = virPCIGetDeviceAddressFromSysfsLink(vfSysfsDevicePath);\n    if (!vfPCIAddr)\n        goto cleanup;\n\n    vfPCIDevice = virPCIDeviceNew(vfPCIAddr->domain, vfPCIAddr->bus,\n                                  vfPCIAddr->slot, vfPCIAddr->function);\n\n cleanup:\n    VIR_FREE(vfSysfsDevicePath);\n    VIR_FREE(vfPCIAddr);\n\n    return vfPCIDevice;\n}"
  },
  {
    "function_name": "virNetDevIsPCIDevice",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
    "lines": "1090-1117",
    "snippet": "static bool\nvirNetDevIsPCIDevice(const char *devpath)\n{\n    char *subsys_link = NULL;\n    char *abs_path = NULL;\n    g_autofree char *subsys = NULL;\n    bool ret = false;\n\n    subsys_link = g_strdup_printf(\"%s/subsystem\", devpath);\n\n    if (!virFileExists(subsys_link))\n        goto cleanup;\n\n    if (virFileResolveLink(subsys_link, &abs_path) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Unable to resolve device subsystem symlink %s\"),\n                       subsys_link);\n        goto cleanup;\n    }\n\n    subsys = g_path_get_basename(abs_path);\n    ret = STRPREFIX(subsys, \"pci\");\n\n cleanup:\n    VIR_FREE(subsys_link);\n    VIR_FREE(abs_path);\n    return ret;\n}",
    "includes": [
      "# include <linux/devlink.h>",
      "# include <net/if_dl.h>",
      "# include <sys/sockio.h>",
      "# include <linux/ethtool.h>",
      "# include <linux/types.h>",
      "# include <linux/if_vlan.h>",
      "# include <linux/sockios.h>",
      "#include <fcntl.h>",
      "# include <sys/ioctl.h>",
      "#include \"virjson.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virpci.h\"",
      "#include \"vircommand.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetlink.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetdev.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "abs_path"
          ],
          "line": 1115
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "subsys_link"
          ],
          "line": 1114
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STRPREFIX",
          "args": [
            "subsys",
            "\"pci\""
          ],
          "line": 1111
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_path_get_basename",
          "args": [
            "abs_path"
          ],
          "line": 1110
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Unable to resolve device subsystem symlink %s\")",
            "subsys_link"
          ],
          "line": 1104
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to resolve device subsystem symlink %s\""
          ],
          "line": 1105
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virFileResolveLink",
          "args": [
            "subsys_link",
            "&abs_path"
          ],
          "line": 1103
        },
        "resolved": true,
        "details": {
          "function_name": "virFileResolveLink",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1608-1612",
          "snippet": "int\nvirFileResolveLink(const char *linkpath, char **resultpath)\n{\n    return virFileResolveLinkHelper(linkpath, false, resultpath);\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileResolveLink(const char *linkpath, char **resultpath)\n{\n    return virFileResolveLinkHelper(linkpath, false, resultpath);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virFileExists",
          "args": [
            "subsys_link"
          ],
          "line": 1100
        },
        "resolved": true,
        "details": {
          "function_name": "virFileExists",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1873-1877",
          "snippet": "bool\nvirFileExists(const char *path)\n{\n    return access(path, F_OK) == 0;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nbool\nvirFileExists(const char *path)\n{\n    return access(path, F_OK) == 0;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nstatic bool\nvirNetDevIsPCIDevice(const char *devpath)\n{\n    char *subsys_link = NULL;\n    char *abs_path = NULL;\n    g_autofree char *subsys = NULL;\n    bool ret = false;\n\n    subsys_link = g_strdup_printf(\"%s/subsystem\", devpath);\n\n    if (!virFileExists(subsys_link))\n        goto cleanup;\n\n    if (virFileResolveLink(subsys_link, &abs_path) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Unable to resolve device subsystem symlink %s\"),\n                       subsys_link);\n        goto cleanup;\n    }\n\n    subsys = g_path_get_basename(abs_path);\n    ret = STRPREFIX(subsys, \"pci\");\n\n cleanup:\n    VIR_FREE(subsys_link);\n    VIR_FREE(abs_path);\n    return ret;\n}"
  },
  {
    "function_name": "virNetDevSysfsDeviceFile",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
    "lines": "1071-1078",
    "snippet": "static int\nvirNetDevSysfsDeviceFile(char **pf_sysfs_device_link, const char *ifname,\n                         const char *file)\n{\n    *pf_sysfs_device_link = g_strdup_printf(SYSFS_NET_DIR \"%s/device/%s\", ifname,\n                                            file);\n    return 0;\n}",
    "includes": [
      "# include <linux/devlink.h>",
      "# include <net/if_dl.h>",
      "# include <sys/sockio.h>",
      "# include <linux/ethtool.h>",
      "# include <linux/types.h>",
      "# include <linux/if_vlan.h>",
      "# include <linux/sockios.h>",
      "#include <fcntl.h>",
      "# include <sys/ioctl.h>",
      "#include \"virjson.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virpci.h\"",
      "#include \"vircommand.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetlink.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetdev.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "SYSFS_NET_DIR \"%s/device/%s\"",
            "ifname",
            "file"
          ],
          "line": 1075
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nstatic int\nvirNetDevSysfsDeviceFile(char **pf_sysfs_device_link, const char *ifname,\n                         const char *file)\n{\n    *pf_sysfs_device_link = g_strdup_printf(SYSFS_NET_DIR \"%s/device/%s\", ifname,\n                                            file);\n    return 0;\n}"
  },
  {
    "function_name": "virNetDevSysfsFile",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
    "lines": "1063-1069",
    "snippet": "int\nvirNetDevSysfsFile(char **pf_sysfs_device_link, const char *ifname,\n                   const char *file)\n{\n    *pf_sysfs_device_link = g_strdup_printf(SYSFS_NET_DIR \"%s/%s\", ifname, file);\n    return 0;\n}",
    "includes": [
      "# include <linux/devlink.h>",
      "# include <net/if_dl.h>",
      "# include <sys/sockio.h>",
      "# include <linux/ethtool.h>",
      "# include <linux/types.h>",
      "# include <linux/if_vlan.h>",
      "# include <linux/sockios.h>",
      "#include <fcntl.h>",
      "# include <sys/ioctl.h>",
      "#include \"virjson.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virpci.h\"",
      "#include \"vircommand.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetlink.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetdev.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "SYSFS_NET_DIR \"%s/%s\"",
            "ifname",
            "file"
          ],
          "line": 1067
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint\nvirNetDevSysfsFile(char **pf_sysfs_device_link, const char *ifname,\n                   const char *file)\n{\n    *pf_sysfs_device_link = g_strdup_printf(SYSFS_NET_DIR \"%s/%s\", ifname, file);\n    return 0;\n}"
  },
  {
    "function_name": "virNetDevValidateConfig",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
    "lines": "1050-1057",
    "snippet": "int virNetDevValidateConfig(const char *ifname G_GNUC_UNUSED,\n                            const virMacAddr *macaddr G_GNUC_UNUSED,\n                            int ifindex G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to check interface config on this platform\"));\n    return -1;\n}",
    "includes": [
      "# include <linux/devlink.h>",
      "# include <net/if_dl.h>",
      "# include <sys/sockio.h>",
      "# include <linux/ethtool.h>",
      "# include <linux/types.h>",
      "# include <linux/if_vlan.h>",
      "# include <linux/sockios.h>",
      "#include <fcntl.h>",
      "# include <sys/ioctl.h>",
      "#include \"virjson.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virpci.h\"",
      "#include \"vircommand.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetlink.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetdev.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "\"%s\"",
            "_(\"Unable to check interface config on this platform\")"
          ],
          "line": 1054
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to check interface config on this platform\""
          ],
          "line": 1055
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint virNetDevValidateConfig(const char *ifname G_GNUC_UNUSED,\n                            const virMacAddr *macaddr G_GNUC_UNUSED,\n                            int ifindex G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to check interface config on this platform\"));\n    return -1;\n}"
  },
  {
    "function_name": "virNetDevValidateConfig",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
    "lines": "1008-1048",
    "snippet": "int virNetDevValidateConfig(const char *ifname,\n                            const virMacAddr *macaddr, int ifindex)\n{\n    struct ifreq ifr;\n    int idx;\n    int rc;\n    VIR_AUTOCLOSE fd = -1;\n\n    if ((rc = virNetDevExists(ifname)) < 0)\n        return -1;\n    if (rc == 0)\n        return 0;\n\n    if (macaddr != NULL) {\n        if ((fd = virNetDevSetupControl(ifname, &ifr)) < 0)\n            return -1;\n\n        if (ioctl(fd, SIOCGIFHWADDR, &ifr) < 0) {\n            if (errno == ENODEV)\n                return 0;\n\n            virReportSystemError(errno,\n                                 _(\"could not get MAC address of interface %s\"),\n                                 ifname);\n            return -1;\n        }\n\n        if (virMacAddrCmpRaw(macaddr,\n                             (unsigned char *)ifr.ifr_hwaddr.sa_data) != 0)\n            return 0;\n    }\n\n    if (ifindex != -1) {\n        if (virNetDevGetIndex(ifname, &idx) < 0)\n            return -1;\n        if (idx != ifindex)\n            return 0;\n    }\n\n    return 1;\n}",
    "includes": [
      "# include <linux/devlink.h>",
      "# include <net/if_dl.h>",
      "# include <sys/sockio.h>",
      "# include <linux/ethtool.h>",
      "# include <linux/types.h>",
      "# include <linux/if_vlan.h>",
      "# include <linux/sockios.h>",
      "#include <fcntl.h>",
      "# include <sys/ioctl.h>",
      "#include \"virjson.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virpci.h\"",
      "#include \"vircommand.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetlink.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetdev.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNetDevGetIndex",
          "args": [
            "ifname",
            "&idx"
          ],
          "line": 1041
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevGetIndex",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
          "lines": "893-899",
          "snippet": "int virNetDevGetIndex(const char *ifname G_GNUC_UNUSED,\n                      int *ifindex G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to get interface index on this platform\"));\n    return -1;\n}",
          "includes": [
            "# include <linux/devlink.h>",
            "# include <net/if_dl.h>",
            "# include <sys/sockio.h>",
            "# include <linux/ethtool.h>",
            "# include <linux/types.h>",
            "# include <linux/if_vlan.h>",
            "# include <linux/sockios.h>",
            "#include <fcntl.h>",
            "# include <sys/ioctl.h>",
            "#include \"virjson.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virpci.h\"",
            "#include \"vircommand.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetlink.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetdev.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint virNetDevGetIndex(const char *ifname G_GNUC_UNUSED,\n                      int *ifindex G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to get interface index on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virMacAddrCmpRaw",
          "args": [
            "macaddr",
            "(unsigned char *)ifr.ifr_hwaddr.sa_data"
          ],
          "line": 1035
        },
        "resolved": true,
        "details": {
          "function_name": "virMacAddrCmpRaw",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virmacaddr.c",
          "lines": "86-91",
          "snippet": "int\nvirMacAddrCmpRaw(const virMacAddr *mac1,\n                 const unsigned char mac2[VIR_MAC_BUFLEN])\n{\n    return memcmp(mac1->addr, mac2, VIR_MAC_BUFLEN);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virrandom.h\"",
            "#include \"virmacaddr.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virrandom.h\"\n#include \"virmacaddr.h\"\n#include <config.h>\n\nint\nvirMacAddrCmpRaw(const virMacAddr *mac1,\n                 const unsigned char mac2[VIR_MAC_BUFLEN])\n{\n    return memcmp(mac1->addr, mac2, VIR_MAC_BUFLEN);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"could not get MAC address of interface %s\")",
            "ifname"
          ],
          "line": 1029
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"could not get MAC address of interface %s\""
          ],
          "line": 1030
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ioctl",
          "args": [
            "fd",
            "SIOCGIFHWADDR",
            "&ifr"
          ],
          "line": 1025
        },
        "resolved": true,
        "details": {
          "function_name": "vir_ioctlsocket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsocket.c",
          "lines": "292-308",
          "snippet": "int\nvir_ioctlsocket(int fd, int cmd, void *arg)\n{\n    SOCKET sk = FD2SK(fd);\n\n    if (sk == INVALID_SOCKET) {\n        errno = EBADF;\n        return -1;\n    }\n\n    if (ioctlsocket(sk, cmd, arg) < 0) {\n        set_errno();\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include <fcntl.h>",
            "#include \"virfile.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <fcntl.h>\n#include \"virfile.h\"\n#include \"virutil.h\"\n#include \"virsocket.h\"\n#include <config.h>\n\nint\nvir_ioctlsocket(int fd, int cmd, void *arg)\n{\n    SOCKET sk = FD2SK(fd);\n\n    if (sk == INVALID_SOCKET) {\n        errno = EBADF;\n        return -1;\n    }\n\n    if (ioctlsocket(sk, cmd, arg) < 0) {\n        set_errno();\n        return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetDevSetupControl",
          "args": [
            "ifname",
            "&ifr"
          ],
          "line": 1022
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevSetupControl",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
          "lines": "177-185",
          "snippet": "int\nvirNetDevSetupControl(const char *ifname G_GNUC_UNUSED,\n                      void *ifr G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Network device configuration is not supported \"\n                           \"on this platform\"));\n    return -1;\n}",
          "includes": [
            "# include <linux/devlink.h>",
            "# include <net/if_dl.h>",
            "# include <sys/sockio.h>",
            "# include <linux/ethtool.h>",
            "# include <linux/types.h>",
            "# include <linux/if_vlan.h>",
            "# include <linux/sockios.h>",
            "#include <fcntl.h>",
            "# include <sys/ioctl.h>",
            "#include \"virjson.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virpci.h\"",
            "#include \"vircommand.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetlink.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetdev.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint\nvirNetDevSetupControl(const char *ifname G_GNUC_UNUSED,\n                      void *ifr G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Network device configuration is not supported \"\n                           \"on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetDevExists",
          "args": [
            "ifname"
          ],
          "line": 1016
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevExists",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
          "lines": "218-223",
          "snippet": "int virNetDevExists(const char *ifname)\n{\n    virReportSystemError(ENOSYS,\n                         _(\"Unable to check interface %s\"), ifname);\n    return -1;\n}",
          "includes": [
            "# include <linux/devlink.h>",
            "# include <net/if_dl.h>",
            "# include <sys/sockio.h>",
            "# include <linux/ethtool.h>",
            "# include <linux/types.h>",
            "# include <linux/if_vlan.h>",
            "# include <linux/sockios.h>",
            "#include <fcntl.h>",
            "# include <sys/ioctl.h>",
            "#include \"virjson.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virpci.h\"",
            "#include \"vircommand.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetlink.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetdev.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint virNetDevExists(const char *ifname)\n{\n    virReportSystemError(ENOSYS,\n                         _(\"Unable to check interface %s\"), ifname);\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint virNetDevValidateConfig(const char *ifname,\n                            const virMacAddr *macaddr, int ifindex)\n{\n    struct ifreq ifr;\n    int idx;\n    int rc;\n    VIR_AUTOCLOSE fd = -1;\n\n    if ((rc = virNetDevExists(ifname)) < 0)\n        return -1;\n    if (rc == 0)\n        return 0;\n\n    if (macaddr != NULL) {\n        if ((fd = virNetDevSetupControl(ifname, &ifr)) < 0)\n            return -1;\n\n        if (ioctl(fd, SIOCGIFHWADDR, &ifr) < 0) {\n            if (errno == ENODEV)\n                return 0;\n\n            virReportSystemError(errno,\n                                 _(\"could not get MAC address of interface %s\"),\n                                 ifname);\n            return -1;\n        }\n\n        if (virMacAddrCmpRaw(macaddr,\n                             (unsigned char *)ifr.ifr_hwaddr.sa_data) != 0)\n            return 0;\n    }\n\n    if (ifindex != -1) {\n        if (virNetDevGetIndex(ifname, &idx) < 0)\n            return -1;\n        if (idx != ifindex)\n            return 0;\n    }\n\n    return 1;\n}"
  },
  {
    "function_name": "virNetDevGetVLanID",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
    "lines": "985-991",
    "snippet": "int virNetDevGetVLanID(const char *ifname G_GNUC_UNUSED,\n                       int *vlanid G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to get VLAN on this platform\"));\n    return -1;\n}",
    "includes": [
      "# include <linux/devlink.h>",
      "# include <net/if_dl.h>",
      "# include <sys/sockio.h>",
      "# include <linux/ethtool.h>",
      "# include <linux/types.h>",
      "# include <linux/if_vlan.h>",
      "# include <linux/sockios.h>",
      "#include <fcntl.h>",
      "# include <sys/ioctl.h>",
      "#include \"virjson.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virpci.h\"",
      "#include \"vircommand.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetlink.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetdev.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "\"%s\"",
            "_(\"Unable to get VLAN on this platform\")"
          ],
          "line": 988
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to get VLAN on this platform\""
          ],
          "line": 989
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint virNetDevGetVLanID(const char *ifname G_GNUC_UNUSED,\n                       int *vlanid G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to get VLAN on this platform\"));\n    return -1;\n}"
  },
  {
    "function_name": "virNetDevGetVLanID",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
    "lines": "955-983",
    "snippet": "int virNetDevGetVLanID(const char *ifname, int *vlanid)\n{\n    struct vlan_ioctl_args vlanargs = {\n      .cmd = GET_VLAN_VID_CMD,\n    };\n    VIR_AUTOCLOSE fd = socket(PF_PACKET, SOCK_DGRAM, 0);\n\n    if (fd < 0) {\n        virReportSystemError(errno, \"%s\",\n                             _(\"Unable to open control socket\"));\n        return -1;\n    }\n\n    if (virStrcpyStatic(vlanargs.device1, ifname) < 0) {\n        virReportSystemError(ERANGE,\n                             _(\"invalid interface name %s\"),\n                             ifname);\n        return -1;\n    }\n\n    if (ioctl(fd, SIOCGIFVLAN, &vlanargs) != 0) {\n        virReportSystemError(errno,\n                             _(\"Unable to get VLAN for interface %s\"), ifname);\n        return -1;\n    }\n\n    *vlanid = vlanargs.u.VID;\n    return 0;\n}",
    "includes": [
      "# include <linux/devlink.h>",
      "# include <net/if_dl.h>",
      "# include <sys/sockio.h>",
      "# include <linux/ethtool.h>",
      "# include <linux/types.h>",
      "# include <linux/if_vlan.h>",
      "# include <linux/sockios.h>",
      "#include <fcntl.h>",
      "# include <sys/ioctl.h>",
      "#include \"virjson.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virpci.h\"",
      "#include \"vircommand.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetlink.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetdev.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "struct ethtool_value cmd = { 0 };"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"Unable to get VLAN for interface %s\")",
            "ifname"
          ],
          "line": 976
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to get VLAN for interface %s\""
          ],
          "line": 977
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ioctl",
          "args": [
            "fd",
            "SIOCGIFVLAN",
            "&vlanargs"
          ],
          "line": 975
        },
        "resolved": true,
        "details": {
          "function_name": "vir_ioctlsocket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsocket.c",
          "lines": "292-308",
          "snippet": "int\nvir_ioctlsocket(int fd, int cmd, void *arg)\n{\n    SOCKET sk = FD2SK(fd);\n\n    if (sk == INVALID_SOCKET) {\n        errno = EBADF;\n        return -1;\n    }\n\n    if (ioctlsocket(sk, cmd, arg) < 0) {\n        set_errno();\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include <fcntl.h>",
            "#include \"virfile.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <fcntl.h>\n#include \"virfile.h\"\n#include \"virutil.h\"\n#include \"virsocket.h\"\n#include <config.h>\n\nint\nvir_ioctlsocket(int fd, int cmd, void *arg)\n{\n    SOCKET sk = FD2SK(fd);\n\n    if (sk == INVALID_SOCKET) {\n        errno = EBADF;\n        return -1;\n    }\n\n    if (ioctlsocket(sk, cmd, arg) < 0) {\n        set_errno();\n        return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ERANGE",
            "_(\"invalid interface name %s\")",
            "ifname"
          ],
          "line": 969
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStrcpyStatic",
          "args": [
            "vlanargs.device1",
            "ifname"
          ],
          "line": 968
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "\"%s\"",
            "_(\"Unable to open control socket\")"
          ],
          "line": 963
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "socket",
          "args": [
            "PF_PACKET",
            "SOCK_DGRAM",
            "0"
          ],
          "line": 960
        },
        "resolved": true,
        "details": {
          "function_name": "vir_socket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsocket.c",
          "lines": "351-367",
          "snippet": "int\nvir_socket(int domain, int type, int protocol)\n{\n    SOCKET sk;\n\n    /* We have to use WSASocket() instead of socket(), to create\n     * non-overlapped IO sockets. Overlapped IO sockets cannot\n     * be used with read/write.\n     */\n    sk = WSASocket(domain, type, protocol, NULL, 0, 0);\n    if (sk == INVALID_SOCKET) {\n        set_errno();\n        return -1;\n    }\n\n    return SK2FD(sk);\n}",
          "includes": [
            "#include <fcntl.h>",
            "#include \"virfile.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <fcntl.h>\n#include \"virfile.h\"\n#include \"virutil.h\"\n#include \"virsocket.h\"\n#include <config.h>\n\nint\nvir_socket(int domain, int type, int protocol)\n{\n    SOCKET sk;\n\n    /* We have to use WSASocket() instead of socket(), to create\n     * non-overlapped IO sockets. Overlapped IO sockets cannot\n     * be used with read/write.\n     */\n    sk = WSASocket(domain, type, protocol, NULL, 0, 0);\n    if (sk == INVALID_SOCKET) {\n        set_errno();\n        return -1;\n    }\n\n    return SK2FD(sk);\n}"
        }
      }
    ],
    "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nstruct ethtool_value cmd = { 0 };\n\nint virNetDevGetVLanID(const char *ifname, int *vlanid)\n{\n    struct vlan_ioctl_args vlanargs = {\n      .cmd = GET_VLAN_VID_CMD,\n    };\n    VIR_AUTOCLOSE fd = socket(PF_PACKET, SOCK_DGRAM, 0);\n\n    if (fd < 0) {\n        virReportSystemError(errno, \"%s\",\n                             _(\"Unable to open control socket\"));\n        return -1;\n    }\n\n    if (virStrcpyStatic(vlanargs.device1, ifname) < 0) {\n        virReportSystemError(ERANGE,\n                             _(\"invalid interface name %s\"),\n                             ifname);\n        return -1;\n    }\n\n    if (ioctl(fd, SIOCGIFVLAN, &vlanargs) != 0) {\n        virReportSystemError(errno,\n                             _(\"Unable to get VLAN for interface %s\"), ifname);\n        return -1;\n    }\n\n    *vlanid = vlanargs.u.VID;\n    return 0;\n}"
  },
  {
    "function_name": "virNetDevGetMaster",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
    "lines": "941-948",
    "snippet": "int\nvirNetDevGetMaster(const char *ifname G_GNUC_UNUSED,\n                   char **master G_GNUC_UNUSED)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                   _(\"Unable to get device master from netlink on this platform\"));\n    return -1;\n}",
    "includes": [
      "# include <linux/devlink.h>",
      "# include <net/if_dl.h>",
      "# include <sys/sockio.h>",
      "# include <linux/ethtool.h>",
      "# include <linux/types.h>",
      "# include <linux/if_vlan.h>",
      "# include <linux/sockios.h>",
      "#include <fcntl.h>",
      "# include <sys/ioctl.h>",
      "#include \"virjson.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virpci.h\"",
      "#include \"vircommand.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetlink.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetdev.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"Unable to get device master from netlink on this platform\")"
          ],
          "line": 945
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to get device master from netlink on this platform\""
          ],
          "line": 946
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint\nvirNetDevGetMaster(const char *ifname G_GNUC_UNUSED,\n                   char **master G_GNUC_UNUSED)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                   _(\"Unable to get device master from netlink on this platform\"));\n    return -1;\n}"
  },
  {
    "function_name": "virNetDevGetMaster",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
    "lines": "913-935",
    "snippet": "int\nvirNetDevGetMaster(const char *ifname, char **master)\n{\n    int ret = -1;\n    void *nlData = NULL;\n    struct nlattr *tb[IFLA_MAX + 1] = {NULL, };\n\n    *master = NULL;\n\n    if (virNetlinkDumpLink(ifname, -1, &nlData, tb, 0, 0) < 0)\n        goto cleanup;\n\n    if (tb[IFLA_MASTER]) {\n        if (!(*master = virNetDevGetName(*(int *)RTA_DATA(tb[IFLA_MASTER]))))\n            goto cleanup;\n    }\n\n    VIR_DEBUG(\"IFLA_MASTER for %s is %s\", ifname, *master ? *master : \"(none)\");\n    ret = 0;\n cleanup:\n    VIR_FREE(nlData);\n    return ret;\n}",
    "includes": [
      "# include <linux/devlink.h>",
      "# include <net/if_dl.h>",
      "# include <sys/sockio.h>",
      "# include <linux/ethtool.h>",
      "# include <linux/types.h>",
      "# include <linux/if_vlan.h>",
      "# include <linux/sockios.h>",
      "#include <fcntl.h>",
      "# include <sys/ioctl.h>",
      "#include \"virjson.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virpci.h\"",
      "#include \"vircommand.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetlink.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetdev.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "nlData"
          ],
          "line": 933
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"IFLA_MASTER for %s is %s\"",
            "ifname",
            "*master ? *master : \"(none)\""
          ],
          "line": 930
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNetDevGetName",
          "args": [
            "*(int *)RTA_DATA(tb[IFLA_MASTER])"
          ],
          "line": 926
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevGetName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
          "lines": "840-846",
          "snippet": "char *virNetDevGetName(int ifindex)\n{\n    virReportSystemError(ENOSYS,\n                         _(\"Cannot get interface name for index '%i'\"),\n                         ifindex);\n    return NULL;\n}",
          "includes": [
            "# include <linux/devlink.h>",
            "# include <net/if_dl.h>",
            "# include <sys/sockio.h>",
            "# include <linux/ethtool.h>",
            "# include <linux/types.h>",
            "# include <linux/if_vlan.h>",
            "# include <linux/sockios.h>",
            "#include <fcntl.h>",
            "# include <sys/ioctl.h>",
            "#include \"virjson.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virpci.h\"",
            "#include \"vircommand.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetlink.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetdev.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "size_t i;"
          ],
          "called_functions": [],
          "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nsize_t i;\n\nchar *virNetDevGetName(int ifindex)\n{\n    virReportSystemError(ENOSYS,\n                         _(\"Cannot get interface name for index '%i'\"),\n                         ifindex);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "RTA_DATA",
          "args": [
            "tb[IFLA_MASTER]"
          ],
          "line": 926
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNetlinkDumpLink",
          "args": [
            "ifname",
            "-1",
            "&nlData",
            "tb",
            "0",
            "0"
          ],
          "line": 922
        },
        "resolved": true,
        "details": {
          "function_name": "virNetlinkDumpLink",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetlink.c",
          "lines": "1261-1272",
          "snippet": "int\nvirNetlinkDumpLink(const char *ifname G_GNUC_UNUSED,\n                   int ifindex G_GNUC_UNUSED,\n                   void **nlData G_GNUC_UNUSED,\n                   struct nlattr **tb G_GNUC_UNUSED,\n                   uint32_t src_pid G_GNUC_UNUSED,\n                   uint32_t dst_pid G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to dump link info on this platform\"));\n    return -1;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virnetlink.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virmacaddr.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virnetdev.h\"\n#include \"virnetlink.h\"\n#include <unistd.h>\n#include <config.h>\n\nint\nvirNetlinkDumpLink(const char *ifname G_GNUC_UNUSED,\n                   int ifindex G_GNUC_UNUSED,\n                   void **nlData G_GNUC_UNUSED,\n                   struct nlattr **tb G_GNUC_UNUSED,\n                   uint32_t src_pid G_GNUC_UNUSED,\n                   uint32_t dst_pid G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to dump link info on this platform\"));\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint\nvirNetDevGetMaster(const char *ifname, char **master)\n{\n    int ret = -1;\n    void *nlData = NULL;\n    struct nlattr *tb[IFLA_MAX + 1] = {NULL, };\n\n    *master = NULL;\n\n    if (virNetlinkDumpLink(ifname, -1, &nlData, tb, 0, 0) < 0)\n        goto cleanup;\n\n    if (tb[IFLA_MASTER]) {\n        if (!(*master = virNetDevGetName(*(int *)RTA_DATA(tb[IFLA_MASTER]))))\n            goto cleanup;\n    }\n\n    VIR_DEBUG(\"IFLA_MASTER for %s is %s\", ifname, *master ? *master : \"(none)\");\n    ret = 0;\n cleanup:\n    VIR_FREE(nlData);\n    return ret;\n}"
  },
  {
    "function_name": "virNetDevGetIndex",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
    "lines": "893-899",
    "snippet": "int virNetDevGetIndex(const char *ifname G_GNUC_UNUSED,\n                      int *ifindex G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to get interface index on this platform\"));\n    return -1;\n}",
    "includes": [
      "# include <linux/devlink.h>",
      "# include <net/if_dl.h>",
      "# include <sys/sockio.h>",
      "# include <linux/ethtool.h>",
      "# include <linux/types.h>",
      "# include <linux/if_vlan.h>",
      "# include <linux/sockios.h>",
      "#include <fcntl.h>",
      "# include <sys/ioctl.h>",
      "#include \"virjson.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virpci.h\"",
      "#include \"vircommand.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetlink.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetdev.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "\"%s\"",
            "_(\"Unable to get interface index on this platform\")"
          ],
          "line": 896
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to get interface index on this platform\""
          ],
          "line": 897
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint virNetDevGetIndex(const char *ifname G_GNUC_UNUSED,\n                      int *ifindex G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to get interface index on this platform\"));\n    return -1;\n}"
  },
  {
    "function_name": "virNetDevGetIndex",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
    "lines": "859-891",
    "snippet": "int virNetDevGetIndex(const char *ifname, int *ifindex)\n{\n    struct ifreq ifreq;\n    VIR_AUTOCLOSE fd = socket(VIR_NETDEV_FAMILY, SOCK_DGRAM, 0);\n\n    if (fd < 0) {\n        virReportSystemError(errno, \"%s\",\n                             _(\"Unable to open control socket\"));\n        return -1;\n    }\n\n    memset(&ifreq, 0, sizeof(ifreq));\n\n    if (virStrcpyStatic(ifreq.ifr_name, ifname) < 0) {\n        virReportSystemError(ERANGE,\n                             _(\"invalid interface name %s\"),\n                             ifname);\n        return -1;\n    }\n\n    if (ioctl(fd, SIOCGIFINDEX, &ifreq) < 0) {\n        virReportSystemError(errno,\n                             _(\"Unable to get index for interface %s\"), ifname);\n        return -1;\n    }\n\n# ifdef HAVE_STRUCT_IFREQ_IFR_INDEX\n    *ifindex = ifreq.ifr_index;\n# else\n    *ifindex = ifreq.ifr_ifindex;\n# endif\n    return 0;\n}",
    "includes": [
      "# include <linux/devlink.h>",
      "# include <net/if_dl.h>",
      "# include <sys/sockio.h>",
      "# include <linux/ethtool.h>",
      "# include <linux/types.h>",
      "# include <linux/if_vlan.h>",
      "# include <linux/sockios.h>",
      "#include <fcntl.h>",
      "# include <sys/ioctl.h>",
      "#include \"virjson.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virpci.h\"",
      "#include \"vircommand.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetlink.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetdev.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"Unable to get index for interface %s\")",
            "ifname"
          ],
          "line": 880
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to get index for interface %s\""
          ],
          "line": 881
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ioctl",
          "args": [
            "fd",
            "SIOCGIFINDEX",
            "&ifreq"
          ],
          "line": 879
        },
        "resolved": true,
        "details": {
          "function_name": "vir_ioctlsocket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsocket.c",
          "lines": "292-308",
          "snippet": "int\nvir_ioctlsocket(int fd, int cmd, void *arg)\n{\n    SOCKET sk = FD2SK(fd);\n\n    if (sk == INVALID_SOCKET) {\n        errno = EBADF;\n        return -1;\n    }\n\n    if (ioctlsocket(sk, cmd, arg) < 0) {\n        set_errno();\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include <fcntl.h>",
            "#include \"virfile.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <fcntl.h>\n#include \"virfile.h\"\n#include \"virutil.h\"\n#include \"virsocket.h\"\n#include <config.h>\n\nint\nvir_ioctlsocket(int fd, int cmd, void *arg)\n{\n    SOCKET sk = FD2SK(fd);\n\n    if (sk == INVALID_SOCKET) {\n        errno = EBADF;\n        return -1;\n    }\n\n    if (ioctlsocket(sk, cmd, arg) < 0) {\n        set_errno();\n        return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ERANGE",
            "_(\"invalid interface name %s\")",
            "ifname"
          ],
          "line": 873
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStrcpyStatic",
          "args": [
            "ifreq.ifr_name",
            "ifname"
          ],
          "line": 872
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&ifreq",
            "0",
            "sizeof(ifreq)"
          ],
          "line": 870
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "\"%s\"",
            "_(\"Unable to open control socket\")"
          ],
          "line": 865
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "socket",
          "args": [
            "VIR_NETDEV_FAMILY",
            "SOCK_DGRAM",
            "0"
          ],
          "line": 862
        },
        "resolved": true,
        "details": {
          "function_name": "vir_socket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsocket.c",
          "lines": "351-367",
          "snippet": "int\nvir_socket(int domain, int type, int protocol)\n{\n    SOCKET sk;\n\n    /* We have to use WSASocket() instead of socket(), to create\n     * non-overlapped IO sockets. Overlapped IO sockets cannot\n     * be used with read/write.\n     */\n    sk = WSASocket(domain, type, protocol, NULL, 0, 0);\n    if (sk == INVALID_SOCKET) {\n        set_errno();\n        return -1;\n    }\n\n    return SK2FD(sk);\n}",
          "includes": [
            "#include <fcntl.h>",
            "#include \"virfile.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <fcntl.h>\n#include \"virfile.h\"\n#include \"virutil.h\"\n#include \"virsocket.h\"\n#include <config.h>\n\nint\nvir_socket(int domain, int type, int protocol)\n{\n    SOCKET sk;\n\n    /* We have to use WSASocket() instead of socket(), to create\n     * non-overlapped IO sockets. Overlapped IO sockets cannot\n     * be used with read/write.\n     */\n    sk = WSASocket(domain, type, protocol, NULL, 0, 0);\n    if (sk == INVALID_SOCKET) {\n        set_errno();\n        return -1;\n    }\n\n    return SK2FD(sk);\n}"
        }
      }
    ],
    "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint virNetDevGetIndex(const char *ifname, int *ifindex)\n{\n    struct ifreq ifreq;\n    VIR_AUTOCLOSE fd = socket(VIR_NETDEV_FAMILY, SOCK_DGRAM, 0);\n\n    if (fd < 0) {\n        virReportSystemError(errno, \"%s\",\n                             _(\"Unable to open control socket\"));\n        return -1;\n    }\n\n    memset(&ifreq, 0, sizeof(ifreq));\n\n    if (virStrcpyStatic(ifreq.ifr_name, ifname) < 0) {\n        virReportSystemError(ERANGE,\n                             _(\"invalid interface name %s\"),\n                             ifname);\n        return -1;\n    }\n\n    if (ioctl(fd, SIOCGIFINDEX, &ifreq) < 0) {\n        virReportSystemError(errno,\n                             _(\"Unable to get index for interface %s\"), ifname);\n        return -1;\n    }\n\n# ifdef HAVE_STRUCT_IFREQ_IFR_INDEX\n    *ifindex = ifreq.ifr_index;\n# else\n    *ifindex = ifreq.ifr_ifindex;\n# endif\n    return 0;\n}"
  },
  {
    "function_name": "virNetDevGetName",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
    "lines": "840-846",
    "snippet": "char *virNetDevGetName(int ifindex)\n{\n    virReportSystemError(ENOSYS,\n                         _(\"Cannot get interface name for index '%i'\"),\n                         ifindex);\n    return NULL;\n}",
    "includes": [
      "# include <linux/devlink.h>",
      "# include <net/if_dl.h>",
      "# include <sys/sockio.h>",
      "# include <linux/ethtool.h>",
      "# include <linux/types.h>",
      "# include <linux/if_vlan.h>",
      "# include <linux/sockios.h>",
      "#include <fcntl.h>",
      "# include <sys/ioctl.h>",
      "#include \"virjson.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virpci.h\"",
      "#include \"vircommand.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetlink.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetdev.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "size_t i;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "_(\"Cannot get interface name for index '%i'\")",
            "ifindex"
          ],
          "line": 842
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Cannot get interface name for index '%i'\""
          ],
          "line": 843
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nsize_t i;\n\nchar *virNetDevGetName(int ifindex)\n{\n    virReportSystemError(ENOSYS,\n                         _(\"Cannot get interface name for index '%i'\"),\n                         ifindex);\n    return NULL;\n}"
  },
  {
    "function_name": "virNetDevGetName",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
    "lines": "824-838",
    "snippet": "char *virNetDevGetName(int ifindex)\n{\n    char name[IFNAMSIZ];\n\n    memset(&name, 0, sizeof(name));\n\n    if (!if_indextoname(ifindex, name)) {\n        virReportSystemError(errno,\n                             _(\"Failed to convert interface index %d to a name\"),\n                             ifindex);\n        return NULL;\n    }\n\n    return g_strdup(name);\n}",
    "includes": [
      "# include <linux/devlink.h>",
      "# include <net/if_dl.h>",
      "# include <sys/sockio.h>",
      "# include <linux/ethtool.h>",
      "# include <linux/types.h>",
      "# include <linux/if_vlan.h>",
      "# include <linux/sockios.h>",
      "#include <fcntl.h>",
      "# include <sys/ioctl.h>",
      "#include \"virjson.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virpci.h\"",
      "#include \"vircommand.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetlink.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetdev.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "name"
          ],
          "line": 837
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"Failed to convert interface index %d to a name\")",
            "ifindex"
          ],
          "line": 831
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "if_indextoname",
          "args": [
            "ifindex",
            "name"
          ],
          "line": 830
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&name",
            "0",
            "sizeof(name)"
          ],
          "line": 828
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nchar *virNetDevGetName(int ifindex)\n{\n    char name[IFNAMSIZ];\n\n    memset(&name, 0, sizeof(name));\n\n    if (!if_indextoname(ifindex, name)) {\n        virReportSystemError(errno,\n                             _(\"Failed to convert interface index %d to a name\"),\n                             ifindex);\n        return NULL;\n    }\n\n    return g_strdup(name);\n}"
  },
  {
    "function_name": "virNetDevGetRcvAllMulti",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
    "lines": "816-821",
    "snippet": "int\nvirNetDevGetRcvAllMulti(const char *ifname,\n                        bool *receive)\n{\n    return virNetDevGetIFFlag(ifname, VIR_IFF_ALLMULTI, receive);\n}",
    "includes": [
      "# include <linux/devlink.h>",
      "# include <net/if_dl.h>",
      "# include <sys/sockio.h>",
      "# include <linux/ethtool.h>",
      "# include <linux/types.h>",
      "# include <linux/if_vlan.h>",
      "# include <linux/sockios.h>",
      "#include <fcntl.h>",
      "# include <sys/ioctl.h>",
      "#include \"virjson.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virpci.h\"",
      "#include \"vircommand.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetlink.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetdev.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNetDevGetIFFlag",
          "args": [
            "ifname",
            "VIR_IFF_ALLMULTI",
            "receive"
          ],
          "line": 820
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevGetIFFlag",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
          "lines": "743-752",
          "snippet": "static int\nvirNetDevGetIFFlag(const char *ifname,\n                   int flag G_GNUC_UNUSED,\n                   bool *val G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS,\n                         _(\"Cannot get interface flags on '%s'\"),\n                         ifname);\n    return -1;\n}",
          "includes": [
            "# include <linux/devlink.h>",
            "# include <net/if_dl.h>",
            "# include <sys/sockio.h>",
            "# include <linux/ethtool.h>",
            "# include <linux/types.h>",
            "# include <linux/if_vlan.h>",
            "# include <linux/sockios.h>",
            "#include <fcntl.h>",
            "# include <sys/ioctl.h>",
            "#include \"virjson.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virpci.h\"",
            "#include \"vircommand.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetlink.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetdev.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nstatic int\nvirNetDevGetIFFlag(const char *ifname,\n                   int flag G_GNUC_UNUSED,\n                   bool *val G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS,\n                         _(\"Cannot get interface flags on '%s'\"),\n                         ifname);\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint\nvirNetDevGetRcvAllMulti(const char *ifname,\n                        bool *receive)\n{\n    return virNetDevGetIFFlag(ifname, VIR_IFF_ALLMULTI, receive);\n}"
  },
  {
    "function_name": "virNetDevGetRcvMulti",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
    "lines": "799-804",
    "snippet": "int\nvirNetDevGetRcvMulti(const char *ifname,\n                     bool *receive)\n{\n    return virNetDevGetIFFlag(ifname, VIR_IFF_MULTICAST, receive);\n}",
    "includes": [
      "# include <linux/devlink.h>",
      "# include <net/if_dl.h>",
      "# include <sys/sockio.h>",
      "# include <linux/ethtool.h>",
      "# include <linux/types.h>",
      "# include <linux/if_vlan.h>",
      "# include <linux/sockios.h>",
      "#include <fcntl.h>",
      "# include <sys/ioctl.h>",
      "#include \"virjson.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virpci.h\"",
      "#include \"vircommand.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetlink.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetdev.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNetDevGetIFFlag",
          "args": [
            "ifname",
            "VIR_IFF_MULTICAST",
            "receive"
          ],
          "line": 803
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevGetIFFlag",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
          "lines": "743-752",
          "snippet": "static int\nvirNetDevGetIFFlag(const char *ifname,\n                   int flag G_GNUC_UNUSED,\n                   bool *val G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS,\n                         _(\"Cannot get interface flags on '%s'\"),\n                         ifname);\n    return -1;\n}",
          "includes": [
            "# include <linux/devlink.h>",
            "# include <net/if_dl.h>",
            "# include <sys/sockio.h>",
            "# include <linux/ethtool.h>",
            "# include <linux/types.h>",
            "# include <linux/if_vlan.h>",
            "# include <linux/sockios.h>",
            "#include <fcntl.h>",
            "# include <sys/ioctl.h>",
            "#include \"virjson.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virpci.h\"",
            "#include \"vircommand.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetlink.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetdev.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nstatic int\nvirNetDevGetIFFlag(const char *ifname,\n                   int flag G_GNUC_UNUSED,\n                   bool *val G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS,\n                         _(\"Cannot get interface flags on '%s'\"),\n                         ifname);\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint\nvirNetDevGetRcvMulti(const char *ifname,\n                     bool *receive)\n{\n    return virNetDevGetIFFlag(ifname, VIR_IFF_MULTICAST, receive);\n}"
  },
  {
    "function_name": "virNetDevGetPromiscuous",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
    "lines": "782-787",
    "snippet": "int\nvirNetDevGetPromiscuous(const char *ifname,\n                        bool *promiscuous)\n{\n    return virNetDevGetIFFlag(ifname, VIR_IFF_PROMISC, promiscuous);\n}",
    "includes": [
      "# include <linux/devlink.h>",
      "# include <net/if_dl.h>",
      "# include <sys/sockio.h>",
      "# include <linux/ethtool.h>",
      "# include <linux/types.h>",
      "# include <linux/if_vlan.h>",
      "# include <linux/sockios.h>",
      "#include <fcntl.h>",
      "# include <sys/ioctl.h>",
      "#include \"virjson.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virpci.h\"",
      "#include \"vircommand.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetlink.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetdev.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNetDevGetIFFlag",
          "args": [
            "ifname",
            "VIR_IFF_PROMISC",
            "promiscuous"
          ],
          "line": 786
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevGetIFFlag",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
          "lines": "743-752",
          "snippet": "static int\nvirNetDevGetIFFlag(const char *ifname,\n                   int flag G_GNUC_UNUSED,\n                   bool *val G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS,\n                         _(\"Cannot get interface flags on '%s'\"),\n                         ifname);\n    return -1;\n}",
          "includes": [
            "# include <linux/devlink.h>",
            "# include <net/if_dl.h>",
            "# include <sys/sockio.h>",
            "# include <linux/ethtool.h>",
            "# include <linux/types.h>",
            "# include <linux/if_vlan.h>",
            "# include <linux/sockios.h>",
            "#include <fcntl.h>",
            "# include <sys/ioctl.h>",
            "#include \"virjson.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virpci.h\"",
            "#include \"vircommand.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetlink.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetdev.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nstatic int\nvirNetDevGetIFFlag(const char *ifname,\n                   int flag G_GNUC_UNUSED,\n                   bool *val G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS,\n                         _(\"Cannot get interface flags on '%s'\"),\n                         ifname);\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint\nvirNetDevGetPromiscuous(const char *ifname,\n                        bool *promiscuous)\n{\n    return virNetDevGetIFFlag(ifname, VIR_IFF_PROMISC, promiscuous);\n}"
  },
  {
    "function_name": "virNetDevGetOnline",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
    "lines": "765-770",
    "snippet": "int\nvirNetDevGetOnline(const char *ifname,\n                   bool *online)\n{\n    return virNetDevGetIFFlag(ifname, VIR_IFF_UP, online);\n}",
    "includes": [
      "# include <linux/devlink.h>",
      "# include <net/if_dl.h>",
      "# include <sys/sockio.h>",
      "# include <linux/ethtool.h>",
      "# include <linux/types.h>",
      "# include <linux/if_vlan.h>",
      "# include <linux/sockios.h>",
      "#include <fcntl.h>",
      "# include <sys/ioctl.h>",
      "#include \"virjson.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virpci.h\"",
      "#include \"vircommand.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetlink.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetdev.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNetDevGetIFFlag",
          "args": [
            "ifname",
            "VIR_IFF_UP",
            "online"
          ],
          "line": 769
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevGetIFFlag",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
          "lines": "743-752",
          "snippet": "static int\nvirNetDevGetIFFlag(const char *ifname,\n                   int flag G_GNUC_UNUSED,\n                   bool *val G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS,\n                         _(\"Cannot get interface flags on '%s'\"),\n                         ifname);\n    return -1;\n}",
          "includes": [
            "# include <linux/devlink.h>",
            "# include <net/if_dl.h>",
            "# include <sys/sockio.h>",
            "# include <linux/ethtool.h>",
            "# include <linux/types.h>",
            "# include <linux/if_vlan.h>",
            "# include <linux/sockios.h>",
            "#include <fcntl.h>",
            "# include <sys/ioctl.h>",
            "#include \"virjson.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virpci.h\"",
            "#include \"vircommand.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetlink.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetdev.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nstatic int\nvirNetDevGetIFFlag(const char *ifname,\n                   int flag G_GNUC_UNUSED,\n                   bool *val G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS,\n                         _(\"Cannot get interface flags on '%s'\"),\n                         ifname);\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint\nvirNetDevGetOnline(const char *ifname,\n                   bool *online)\n{\n    return virNetDevGetIFFlag(ifname, VIR_IFF_UP, online);\n}"
  },
  {
    "function_name": "virNetDevGetIFFlag",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
    "lines": "743-752",
    "snippet": "static int\nvirNetDevGetIFFlag(const char *ifname,\n                   int flag G_GNUC_UNUSED,\n                   bool *val G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS,\n                         _(\"Cannot get interface flags on '%s'\"),\n                         ifname);\n    return -1;\n}",
    "includes": [
      "# include <linux/devlink.h>",
      "# include <net/if_dl.h>",
      "# include <sys/sockio.h>",
      "# include <linux/ethtool.h>",
      "# include <linux/types.h>",
      "# include <linux/if_vlan.h>",
      "# include <linux/sockios.h>",
      "#include <fcntl.h>",
      "# include <sys/ioctl.h>",
      "#include \"virjson.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virpci.h\"",
      "#include \"vircommand.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetlink.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetdev.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "_(\"Cannot get interface flags on '%s'\")",
            "ifname"
          ],
          "line": 748
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Cannot get interface flags on '%s'\""
          ],
          "line": 749
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nstatic int\nvirNetDevGetIFFlag(const char *ifname,\n                   int flag G_GNUC_UNUSED,\n                   bool *val G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS,\n                         _(\"Cannot get interface flags on '%s'\"),\n                         ifname);\n    return -1;\n}"
  },
  {
    "function_name": "virNetDevGetIFFlag",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
    "lines": "723-741",
    "snippet": "static int\nvirNetDevGetIFFlag(const char *ifname, int flag, bool *val)\n{\n    struct ifreq ifr;\n    VIR_AUTOCLOSE fd = -1;\n\n    if ((fd = virNetDevSetupControl(ifname, &ifr)) < 0)\n        return -1;\n\n    if (ioctl(fd, SIOCGIFFLAGS, &ifr) < 0) {\n        virReportSystemError(errno,\n                             _(\"Cannot get interface flags on '%s'\"),\n                             ifname);\n        return -1;\n    }\n\n    *val = (ifr.ifr_flags & flag) ? true : false;\n    return 0;\n}",
    "includes": [
      "# include <linux/devlink.h>",
      "# include <net/if_dl.h>",
      "# include <sys/sockio.h>",
      "# include <linux/ethtool.h>",
      "# include <linux/types.h>",
      "# include <linux/if_vlan.h>",
      "# include <linux/sockios.h>",
      "#include <fcntl.h>",
      "# include <sys/ioctl.h>",
      "#include \"virjson.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virpci.h\"",
      "#include \"vircommand.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetlink.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetdev.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"Cannot get interface flags on '%s'\")",
            "ifname"
          ],
          "line": 733
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Cannot get interface flags on '%s'\""
          ],
          "line": 734
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ioctl",
          "args": [
            "fd",
            "SIOCGIFFLAGS",
            "&ifr"
          ],
          "line": 732
        },
        "resolved": true,
        "details": {
          "function_name": "vir_ioctlsocket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsocket.c",
          "lines": "292-308",
          "snippet": "int\nvir_ioctlsocket(int fd, int cmd, void *arg)\n{\n    SOCKET sk = FD2SK(fd);\n\n    if (sk == INVALID_SOCKET) {\n        errno = EBADF;\n        return -1;\n    }\n\n    if (ioctlsocket(sk, cmd, arg) < 0) {\n        set_errno();\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include <fcntl.h>",
            "#include \"virfile.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <fcntl.h>\n#include \"virfile.h\"\n#include \"virutil.h\"\n#include \"virsocket.h\"\n#include <config.h>\n\nint\nvir_ioctlsocket(int fd, int cmd, void *arg)\n{\n    SOCKET sk = FD2SK(fd);\n\n    if (sk == INVALID_SOCKET) {\n        errno = EBADF;\n        return -1;\n    }\n\n    if (ioctlsocket(sk, cmd, arg) < 0) {\n        set_errno();\n        return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetDevSetupControl",
          "args": [
            "ifname",
            "&ifr"
          ],
          "line": 729
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevSetupControl",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
          "lines": "177-185",
          "snippet": "int\nvirNetDevSetupControl(const char *ifname G_GNUC_UNUSED,\n                      void *ifr G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Network device configuration is not supported \"\n                           \"on this platform\"));\n    return -1;\n}",
          "includes": [
            "# include <linux/devlink.h>",
            "# include <net/if_dl.h>",
            "# include <sys/sockio.h>",
            "# include <linux/ethtool.h>",
            "# include <linux/types.h>",
            "# include <linux/if_vlan.h>",
            "# include <linux/sockios.h>",
            "#include <fcntl.h>",
            "# include <sys/ioctl.h>",
            "#include \"virjson.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virpci.h\"",
            "#include \"vircommand.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetlink.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetdev.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint\nvirNetDevSetupControl(const char *ifname G_GNUC_UNUSED,\n                      void *ifr G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Network device configuration is not supported \"\n                           \"on this platform\"));\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nstatic int\nvirNetDevGetIFFlag(const char *ifname, int flag, bool *val)\n{\n    struct ifreq ifr;\n    VIR_AUTOCLOSE fd = -1;\n\n    if ((fd = virNetDevSetupControl(ifname, &ifr)) < 0)\n        return -1;\n\n    if (ioctl(fd, SIOCGIFFLAGS, &ifr) < 0) {\n        virReportSystemError(errno,\n                             _(\"Cannot get interface flags on '%s'\"),\n                             ifname);\n        return -1;\n    }\n\n    *val = (ifr.ifr_flags & flag) ? true : false;\n    return 0;\n}"
  },
  {
    "function_name": "virNetDevSetRcvAllMulti",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
    "lines": "714-719",
    "snippet": "int\nvirNetDevSetRcvAllMulti(const char *ifname,\n                        bool receive)\n{\n    return virNetDevSetIFFlag(ifname, VIR_IFF_ALLMULTI, receive);\n}",
    "includes": [
      "# include <linux/devlink.h>",
      "# include <net/if_dl.h>",
      "# include <sys/sockio.h>",
      "# include <linux/ethtool.h>",
      "# include <linux/types.h>",
      "# include <linux/if_vlan.h>",
      "# include <linux/sockios.h>",
      "#include <fcntl.h>",
      "# include <sys/ioctl.h>",
      "#include \"virjson.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virpci.h\"",
      "#include \"vircommand.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetlink.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetdev.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNetDevSetIFFlag",
          "args": [
            "ifname",
            "VIR_IFF_ALLMULTI",
            "receive"
          ],
          "line": 718
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevSetIFFlag",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
          "lines": "637-646",
          "snippet": "static int\nvirNetDevSetIFFlag(const char *ifname,\n                   int flag G_GNUC_UNUSED,\n                   bool val G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS,\n                         _(\"Cannot set interface flags on '%s'\"),\n                         ifname);\n    return -1;\n}",
          "includes": [
            "# include <linux/devlink.h>",
            "# include <net/if_dl.h>",
            "# include <sys/sockio.h>",
            "# include <linux/ethtool.h>",
            "# include <linux/types.h>",
            "# include <linux/if_vlan.h>",
            "# include <linux/sockios.h>",
            "#include <fcntl.h>",
            "# include <sys/ioctl.h>",
            "#include \"virjson.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virpci.h\"",
            "#include \"vircommand.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetlink.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetdev.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nstatic int\nvirNetDevSetIFFlag(const char *ifname,\n                   int flag G_GNUC_UNUSED,\n                   bool val G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS,\n                         _(\"Cannot set interface flags on '%s'\"),\n                         ifname);\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint\nvirNetDevSetRcvAllMulti(const char *ifname,\n                        bool receive)\n{\n    return virNetDevSetIFFlag(ifname, VIR_IFF_ALLMULTI, receive);\n}"
  },
  {
    "function_name": "virNetDevSetRcvMulti",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
    "lines": "697-702",
    "snippet": "int\nvirNetDevSetRcvMulti(const char *ifname,\n                     bool receive)\n{\n    return virNetDevSetIFFlag(ifname, VIR_IFF_MULTICAST, receive);\n}",
    "includes": [
      "# include <linux/devlink.h>",
      "# include <net/if_dl.h>",
      "# include <sys/sockio.h>",
      "# include <linux/ethtool.h>",
      "# include <linux/types.h>",
      "# include <linux/if_vlan.h>",
      "# include <linux/sockios.h>",
      "#include <fcntl.h>",
      "# include <sys/ioctl.h>",
      "#include \"virjson.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virpci.h\"",
      "#include \"vircommand.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetlink.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetdev.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNetDevSetIFFlag",
          "args": [
            "ifname",
            "VIR_IFF_MULTICAST",
            "receive"
          ],
          "line": 701
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevSetIFFlag",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
          "lines": "637-646",
          "snippet": "static int\nvirNetDevSetIFFlag(const char *ifname,\n                   int flag G_GNUC_UNUSED,\n                   bool val G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS,\n                         _(\"Cannot set interface flags on '%s'\"),\n                         ifname);\n    return -1;\n}",
          "includes": [
            "# include <linux/devlink.h>",
            "# include <net/if_dl.h>",
            "# include <sys/sockio.h>",
            "# include <linux/ethtool.h>",
            "# include <linux/types.h>",
            "# include <linux/if_vlan.h>",
            "# include <linux/sockios.h>",
            "#include <fcntl.h>",
            "# include <sys/ioctl.h>",
            "#include \"virjson.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virpci.h\"",
            "#include \"vircommand.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetlink.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetdev.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nstatic int\nvirNetDevSetIFFlag(const char *ifname,\n                   int flag G_GNUC_UNUSED,\n                   bool val G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS,\n                         _(\"Cannot set interface flags on '%s'\"),\n                         ifname);\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint\nvirNetDevSetRcvMulti(const char *ifname,\n                     bool receive)\n{\n    return virNetDevSetIFFlag(ifname, VIR_IFF_MULTICAST, receive);\n}"
  },
  {
    "function_name": "virNetDevSetPromiscuous",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
    "lines": "678-683",
    "snippet": "int\nvirNetDevSetPromiscuous(const char *ifname,\n                        bool promiscuous)\n{\n    return virNetDevSetIFFlag(ifname, VIR_IFF_PROMISC, promiscuous);\n}",
    "includes": [
      "# include <linux/devlink.h>",
      "# include <net/if_dl.h>",
      "# include <sys/sockio.h>",
      "# include <linux/ethtool.h>",
      "# include <linux/types.h>",
      "# include <linux/if_vlan.h>",
      "# include <linux/sockios.h>",
      "#include <fcntl.h>",
      "# include <sys/ioctl.h>",
      "#include \"virjson.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virpci.h\"",
      "#include \"vircommand.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetlink.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetdev.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNetDevSetIFFlag",
          "args": [
            "ifname",
            "VIR_IFF_PROMISC",
            "promiscuous"
          ],
          "line": 682
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevSetIFFlag",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
          "lines": "637-646",
          "snippet": "static int\nvirNetDevSetIFFlag(const char *ifname,\n                   int flag G_GNUC_UNUSED,\n                   bool val G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS,\n                         _(\"Cannot set interface flags on '%s'\"),\n                         ifname);\n    return -1;\n}",
          "includes": [
            "# include <linux/devlink.h>",
            "# include <net/if_dl.h>",
            "# include <sys/sockio.h>",
            "# include <linux/ethtool.h>",
            "# include <linux/types.h>",
            "# include <linux/if_vlan.h>",
            "# include <linux/sockios.h>",
            "#include <fcntl.h>",
            "# include <sys/ioctl.h>",
            "#include \"virjson.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virpci.h\"",
            "#include \"vircommand.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetlink.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetdev.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nstatic int\nvirNetDevSetIFFlag(const char *ifname,\n                   int flag G_GNUC_UNUSED,\n                   bool val G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS,\n                         _(\"Cannot set interface flags on '%s'\"),\n                         ifname);\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint\nvirNetDevSetPromiscuous(const char *ifname,\n                        bool promiscuous)\n{\n    return virNetDevSetIFFlag(ifname, VIR_IFF_PROMISC, promiscuous);\n}"
  },
  {
    "function_name": "virNetDevSetOnline",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
    "lines": "660-665",
    "snippet": "int\nvirNetDevSetOnline(const char *ifname,\n                   bool online)\n{\n    return virNetDevSetIFFlag(ifname, VIR_IFF_UP, online);\n}",
    "includes": [
      "# include <linux/devlink.h>",
      "# include <net/if_dl.h>",
      "# include <sys/sockio.h>",
      "# include <linux/ethtool.h>",
      "# include <linux/types.h>",
      "# include <linux/if_vlan.h>",
      "# include <linux/sockios.h>",
      "#include <fcntl.h>",
      "# include <sys/ioctl.h>",
      "#include \"virjson.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virpci.h\"",
      "#include \"vircommand.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetlink.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetdev.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNetDevSetIFFlag",
          "args": [
            "ifname",
            "VIR_IFF_UP",
            "online"
          ],
          "line": 664
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevSetIFFlag",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
          "lines": "637-646",
          "snippet": "static int\nvirNetDevSetIFFlag(const char *ifname,\n                   int flag G_GNUC_UNUSED,\n                   bool val G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS,\n                         _(\"Cannot set interface flags on '%s'\"),\n                         ifname);\n    return -1;\n}",
          "includes": [
            "# include <linux/devlink.h>",
            "# include <net/if_dl.h>",
            "# include <sys/sockio.h>",
            "# include <linux/ethtool.h>",
            "# include <linux/types.h>",
            "# include <linux/if_vlan.h>",
            "# include <linux/sockios.h>",
            "#include <fcntl.h>",
            "# include <sys/ioctl.h>",
            "#include \"virjson.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virpci.h\"",
            "#include \"vircommand.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetlink.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetdev.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nstatic int\nvirNetDevSetIFFlag(const char *ifname,\n                   int flag G_GNUC_UNUSED,\n                   bool val G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS,\n                         _(\"Cannot set interface flags on '%s'\"),\n                         ifname);\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint\nvirNetDevSetOnline(const char *ifname,\n                   bool online)\n{\n    return virNetDevSetIFFlag(ifname, VIR_IFF_UP, online);\n}"
  },
  {
    "function_name": "virNetDevSetIFFlag",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
    "lines": "637-646",
    "snippet": "static int\nvirNetDevSetIFFlag(const char *ifname,\n                   int flag G_GNUC_UNUSED,\n                   bool val G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS,\n                         _(\"Cannot set interface flags on '%s'\"),\n                         ifname);\n    return -1;\n}",
    "includes": [
      "# include <linux/devlink.h>",
      "# include <net/if_dl.h>",
      "# include <sys/sockio.h>",
      "# include <linux/ethtool.h>",
      "# include <linux/types.h>",
      "# include <linux/if_vlan.h>",
      "# include <linux/sockios.h>",
      "#include <fcntl.h>",
      "# include <sys/ioctl.h>",
      "#include \"virjson.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virpci.h\"",
      "#include \"vircommand.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetlink.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetdev.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "_(\"Cannot set interface flags on '%s'\")",
            "ifname"
          ],
          "line": 642
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Cannot set interface flags on '%s'\""
          ],
          "line": 643
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nstatic int\nvirNetDevSetIFFlag(const char *ifname,\n                   int flag G_GNUC_UNUSED,\n                   bool val G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS,\n                         _(\"Cannot set interface flags on '%s'\"),\n                         ifname);\n    return -1;\n}"
  },
  {
    "function_name": "virNetDevSetIFFlag",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
    "lines": "602-635",
    "snippet": "static int\nvirNetDevSetIFFlag(const char *ifname, int flag, bool val)\n{\n    struct ifreq ifr;\n    int ifflags;\n    VIR_AUTOCLOSE fd = -1;\n\n    if ((fd = virNetDevSetupControl(ifname, &ifr)) < 0)\n        return -1;\n\n    if (ioctl(fd, SIOCGIFFLAGS, &ifr) < 0) {\n        virReportSystemError(errno,\n                             _(\"Cannot get interface flags on '%s'\"),\n                             ifname);\n        return -1;\n    }\n\n    if (val)\n        ifflags = ifr.ifr_flags | flag;\n    else\n        ifflags = ifr.ifr_flags & ~flag;\n\n    if (ifr.ifr_flags != ifflags) {\n        ifr.ifr_flags = ifflags;\n        if (ioctl(fd, SIOCSIFFLAGS, &ifr) < 0) {\n            virReportSystemError(errno,\n                                 _(\"Cannot set interface flags on '%s'\"),\n                                 ifname);\n            return -1;\n        }\n    }\n\n    return 0;\n}",
    "includes": [
      "# include <linux/devlink.h>",
      "# include <net/if_dl.h>",
      "# include <sys/sockio.h>",
      "# include <linux/ethtool.h>",
      "# include <linux/types.h>",
      "# include <linux/if_vlan.h>",
      "# include <linux/sockios.h>",
      "#include <fcntl.h>",
      "# include <sys/ioctl.h>",
      "#include \"virjson.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virpci.h\"",
      "#include \"vircommand.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetlink.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetdev.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"Cannot set interface flags on '%s'\")",
            "ifname"
          ],
          "line": 627
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Cannot set interface flags on '%s'\""
          ],
          "line": 628
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ioctl",
          "args": [
            "fd",
            "SIOCSIFFLAGS",
            "&ifr"
          ],
          "line": 626
        },
        "resolved": true,
        "details": {
          "function_name": "vir_ioctlsocket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsocket.c",
          "lines": "292-308",
          "snippet": "int\nvir_ioctlsocket(int fd, int cmd, void *arg)\n{\n    SOCKET sk = FD2SK(fd);\n\n    if (sk == INVALID_SOCKET) {\n        errno = EBADF;\n        return -1;\n    }\n\n    if (ioctlsocket(sk, cmd, arg) < 0) {\n        set_errno();\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include <fcntl.h>",
            "#include \"virfile.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <fcntl.h>\n#include \"virfile.h\"\n#include \"virutil.h\"\n#include \"virsocket.h\"\n#include <config.h>\n\nint\nvir_ioctlsocket(int fd, int cmd, void *arg)\n{\n    SOCKET sk = FD2SK(fd);\n\n    if (sk == INVALID_SOCKET) {\n        errno = EBADF;\n        return -1;\n    }\n\n    if (ioctlsocket(sk, cmd, arg) < 0) {\n        set_errno();\n        return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"Cannot get interface flags on '%s'\")",
            "ifname"
          ],
          "line": 613
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNetDevSetupControl",
          "args": [
            "ifname",
            "&ifr"
          ],
          "line": 609
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevSetupControl",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
          "lines": "177-185",
          "snippet": "int\nvirNetDevSetupControl(const char *ifname G_GNUC_UNUSED,\n                      void *ifr G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Network device configuration is not supported \"\n                           \"on this platform\"));\n    return -1;\n}",
          "includes": [
            "# include <linux/devlink.h>",
            "# include <net/if_dl.h>",
            "# include <sys/sockio.h>",
            "# include <linux/ethtool.h>",
            "# include <linux/types.h>",
            "# include <linux/if_vlan.h>",
            "# include <linux/sockios.h>",
            "#include <fcntl.h>",
            "# include <sys/ioctl.h>",
            "#include \"virjson.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virpci.h\"",
            "#include \"vircommand.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetlink.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetdev.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint\nvirNetDevSetupControl(const char *ifname G_GNUC_UNUSED,\n                      void *ifr G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Network device configuration is not supported \"\n                           \"on this platform\"));\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nstatic int\nvirNetDevSetIFFlag(const char *ifname, int flag, bool val)\n{\n    struct ifreq ifr;\n    int ifflags;\n    VIR_AUTOCLOSE fd = -1;\n\n    if ((fd = virNetDevSetupControl(ifname, &ifr)) < 0)\n        return -1;\n\n    if (ioctl(fd, SIOCGIFFLAGS, &ifr) < 0) {\n        virReportSystemError(errno,\n                             _(\"Cannot get interface flags on '%s'\"),\n                             ifname);\n        return -1;\n    }\n\n    if (val)\n        ifflags = ifr.ifr_flags | flag;\n    else\n        ifflags = ifr.ifr_flags & ~flag;\n\n    if (ifr.ifr_flags != ifflags) {\n        ifr.ifr_flags = ifflags;\n        if (ioctl(fd, SIOCSIFFLAGS, &ifr) < 0) {\n            virReportSystemError(errno,\n                                 _(\"Cannot set interface flags on '%s'\"),\n                                 ifname);\n            return -1;\n        }\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virNetDevSetName",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
    "lines": "591-597",
    "snippet": "int virNetDevSetName(const char* ifname, const char *newifname)\n{\n    virReportSystemError(ENOSYS,\n                         _(\"Cannot rename interface '%s' to '%s' on this platform\"),\n                         ifname, newifname);\n    return -1;\n}",
    "includes": [
      "# include <linux/devlink.h>",
      "# include <net/if_dl.h>",
      "# include <sys/sockio.h>",
      "# include <linux/ethtool.h>",
      "# include <linux/types.h>",
      "# include <linux/if_vlan.h>",
      "# include <linux/sockios.h>",
      "#include <fcntl.h>",
      "# include <sys/ioctl.h>",
      "#include \"virjson.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virpci.h\"",
      "#include \"vircommand.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetlink.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetdev.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "_(\"Cannot rename interface '%s' to '%s' on this platform\")",
            "ifname",
            "newifname"
          ],
          "line": 593
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Cannot rename interface '%s' to '%s' on this platform\""
          ],
          "line": 594
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint virNetDevSetName(const char* ifname, const char *newifname)\n{\n    virReportSystemError(ENOSYS,\n                         _(\"Cannot rename interface '%s' to '%s' on this platform\"),\n                         ifname, newifname);\n    return -1;\n}"
  },
  {
    "function_name": "virNetDevSetName",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
    "lines": "562-589",
    "snippet": "int virNetDevSetName(const char* ifname, const char *newifname)\n{\n    struct ifreq ifr;\n    VIR_AUTOCLOSE fd = -1;\n\n    if ((fd = virNetDevSetupControl(ifname, &ifr)) < 0)\n        return -1;\n\n# ifdef HAVE_STRUCT_IFREQ_IFR_NEWNAME\n    if (virStrcpyStatic(ifr.ifr_newname, newifname) < 0) {\n        virReportSystemError(ERANGE,\n                             _(\"Network interface name '%s' is too long\"),\n                             newifname);\n        return -1;\n    }\n# else\n    ifr.ifr_data = (caddr_t)newifname;\n# endif\n\n    if (ioctl(fd, SIOCSIFNAME, &ifr)) {\n        virReportSystemError(errno,\n                             _(\"Unable to rename '%s' to '%s'\"),\n                             ifname, newifname);\n        return -1;\n    }\n\n    return 0;\n}",
    "includes": [
      "# include <linux/devlink.h>",
      "# include <net/if_dl.h>",
      "# include <sys/sockio.h>",
      "# include <linux/ethtool.h>",
      "# include <linux/types.h>",
      "# include <linux/if_vlan.h>",
      "# include <linux/sockios.h>",
      "#include <fcntl.h>",
      "# include <sys/ioctl.h>",
      "#include \"virjson.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virpci.h\"",
      "#include \"vircommand.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetlink.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetdev.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"Unable to rename '%s' to '%s'\")",
            "ifname",
            "newifname"
          ],
          "line": 582
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to rename '%s' to '%s'\""
          ],
          "line": 583
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ioctl",
          "args": [
            "fd",
            "SIOCSIFNAME",
            "&ifr"
          ],
          "line": 581
        },
        "resolved": true,
        "details": {
          "function_name": "vir_ioctlsocket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsocket.c",
          "lines": "292-308",
          "snippet": "int\nvir_ioctlsocket(int fd, int cmd, void *arg)\n{\n    SOCKET sk = FD2SK(fd);\n\n    if (sk == INVALID_SOCKET) {\n        errno = EBADF;\n        return -1;\n    }\n\n    if (ioctlsocket(sk, cmd, arg) < 0) {\n        set_errno();\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include <fcntl.h>",
            "#include \"virfile.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <fcntl.h>\n#include \"virfile.h\"\n#include \"virutil.h\"\n#include \"virsocket.h\"\n#include <config.h>\n\nint\nvir_ioctlsocket(int fd, int cmd, void *arg)\n{\n    SOCKET sk = FD2SK(fd);\n\n    if (sk == INVALID_SOCKET) {\n        errno = EBADF;\n        return -1;\n    }\n\n    if (ioctlsocket(sk, cmd, arg) < 0) {\n        set_errno();\n        return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ERANGE",
            "_(\"Network interface name '%s' is too long\")",
            "newifname"
          ],
          "line": 572
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStrcpyStatic",
          "args": [
            "ifr.ifr_newname",
            "newifname"
          ],
          "line": 571
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNetDevSetupControl",
          "args": [
            "ifname",
            "&ifr"
          ],
          "line": 567
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevSetupControl",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
          "lines": "177-185",
          "snippet": "int\nvirNetDevSetupControl(const char *ifname G_GNUC_UNUSED,\n                      void *ifr G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Network device configuration is not supported \"\n                           \"on this platform\"));\n    return -1;\n}",
          "includes": [
            "# include <linux/devlink.h>",
            "# include <net/if_dl.h>",
            "# include <sys/sockio.h>",
            "# include <linux/ethtool.h>",
            "# include <linux/types.h>",
            "# include <linux/if_vlan.h>",
            "# include <linux/sockios.h>",
            "#include <fcntl.h>",
            "# include <sys/ioctl.h>",
            "#include \"virjson.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virpci.h\"",
            "#include \"vircommand.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetlink.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetdev.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint\nvirNetDevSetupControl(const char *ifname G_GNUC_UNUSED,\n                      void *ifr G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Network device configuration is not supported \"\n                           \"on this platform\"));\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint virNetDevSetName(const char* ifname, const char *newifname)\n{\n    struct ifreq ifr;\n    VIR_AUTOCLOSE fd = -1;\n\n    if ((fd = virNetDevSetupControl(ifname, &ifr)) < 0)\n        return -1;\n\n# ifdef HAVE_STRUCT_IFREQ_IFR_NEWNAME\n    if (virStrcpyStatic(ifr.ifr_newname, newifname) < 0) {\n        virReportSystemError(ERANGE,\n                             _(\"Network interface name '%s' is too long\"),\n                             newifname);\n        return -1;\n    }\n# else\n    ifr.ifr_data = (caddr_t)newifname;\n# endif\n\n    if (ioctl(fd, SIOCSIFNAME, &ifr)) {\n        virReportSystemError(errno,\n                             _(\"Unable to rename '%s' to '%s'\"),\n                             ifname, newifname);\n        return -1;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virNetDevSetNamespace",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
    "lines": "506-550",
    "snippet": "int virNetDevSetNamespace(const char *ifname, pid_t pidInNs)\n{\n    int ret = -1;\n    char *pid = NULL;\n    char *phy = NULL;\n    char *phy_path = NULL;\n    int len;\n\n    pid = g_strdup_printf(\"%lld\", (long long) pidInNs);\n\n    /* The 802.11 wireless devices only move together with their PHY. */\n    if (virNetDevSysfsFile(&phy_path, ifname, \"phy80211/name\") < 0)\n        goto cleanup;\n\n    if ((len = virFileReadAllQuiet(phy_path, 1024, &phy)) <= 0) {\n        /* Not a wireless device. */\n        const char *argv[] = {\n            \"ip\", \"link\", \"set\", ifname, \"netns\", NULL, NULL\n        };\n\n        argv[5] = pid;\n        if (virRun(argv, NULL) < 0)\n            goto cleanup;\n\n    } else {\n        const char *argv[] = {\n            \"iw\", \"phy\", NULL, \"set\", \"netns\", NULL, NULL\n        };\n\n        /* Remove a line break. */\n        phy[len - 1] = '\\0';\n\n        argv[2] = phy;\n        argv[5] = pid;\n        if (virRun(argv, NULL) < 0)\n            goto cleanup;\n    }\n\n    ret = 0;\n cleanup:\n    VIR_FREE(phy_path);\n    VIR_FREE(phy);\n    VIR_FREE(pid);\n    return ret;\n}",
    "includes": [
      "# include <linux/devlink.h>",
      "# include <net/if_dl.h>",
      "# include <sys/sockio.h>",
      "# include <linux/ethtool.h>",
      "# include <linux/types.h>",
      "# include <linux/if_vlan.h>",
      "# include <linux/sockios.h>",
      "#include <fcntl.h>",
      "# include <sys/ioctl.h>",
      "#include \"virjson.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virpci.h\"",
      "#include \"vircommand.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetlink.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetdev.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "pid"
          ],
          "line": 548
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "phy"
          ],
          "line": 547
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "phy_path"
          ],
          "line": 546
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virRun",
          "args": [
            "argv",
            "NULL"
          ],
          "line": 540
        },
        "resolved": true,
        "details": {
          "function_name": "virRun",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/vircommand.c",
          "lines": "890-900",
          "snippet": "int\nvirRun(const char *const *argv G_GNUC_UNUSED,\n       int *status)\n{\n    if (status)\n        *status = ENOTSUP;\n    else\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"virRun is not implemented for WIN32\"));\n    return -1;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommandpriv.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/apparmor.h>",
            "# include <selinux/selinux.h>",
            "# include <cap-ng.h>",
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "# include <sys/wait.h>",
            "#include <sys/stat.h>",
            "#include <stdarg.h>",
            "#include <signal.h>",
            "# include <poll.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virbuffer.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virerror.h\"\n#include \"vircommandpriv.h\"\n#include \"viralloc.h\"\n# include <sys/apparmor.h>\n# include <selinux/selinux.h>\n# include <cap-ng.h>\n#include <unistd.h>\n#include <fcntl.h>\n# include <sys/wait.h>\n#include <sys/stat.h>\n#include <stdarg.h>\n#include <signal.h>\n# include <poll.h>\n#include <config.h>\n\nint\nvirRun(const char *const *argv G_GNUC_UNUSED,\n       int *status)\n{\n    if (status)\n        *status = ENOTSUP;\n    else\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"virRun is not implemented for WIN32\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virFileReadAllQuiet",
          "args": [
            "phy_path",
            "1024",
            "&phy"
          ],
          "line": 520
        },
        "resolved": true,
        "details": {
          "function_name": "virFileReadAllQuiet",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1459-1472",
          "snippet": "int\nvirFileReadAllQuiet(const char *path, int maxlen, char **buf)\n{\n    int fd = open(path, O_RDONLY);\n    if (fd < 0)\n        return -errno;\n\n    int len = virFileReadLimFD(fd, maxlen, buf);\n    VIR_FORCE_CLOSE(fd);\n    if (len < 0)\n        return -errno;\n\n    return len;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileReadAllQuiet(const char *path, int maxlen, char **buf)\n{\n    int fd = open(path, O_RDONLY);\n    if (fd < 0)\n        return -errno;\n\n    int len = virFileReadLimFD(fd, maxlen, buf);\n    VIR_FORCE_CLOSE(fd);\n    if (len < 0)\n        return -errno;\n\n    return len;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetDevSysfsFile",
          "args": [
            "&phy_path",
            "ifname",
            "\"phy80211/name\""
          ],
          "line": 517
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevSysfsFile",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
          "lines": "1524-1532",
          "snippet": "int\nvirNetDevSysfsFile(char **pf_sysfs_device_link G_GNUC_UNUSED,\n                   const char *ifname G_GNUC_UNUSED,\n                   const char *file G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to get sysfs info on this platform\"));\n    return -1;\n}",
          "includes": [
            "# include <linux/devlink.h>",
            "# include <net/if_dl.h>",
            "# include <sys/sockio.h>",
            "# include <linux/ethtool.h>",
            "# include <linux/types.h>",
            "# include <linux/if_vlan.h>",
            "# include <linux/sockios.h>",
            "#include <fcntl.h>",
            "# include <sys/ioctl.h>",
            "#include \"virjson.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virpci.h\"",
            "#include \"vircommand.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetlink.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetdev.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint\nvirNetDevSysfsFile(char **pf_sysfs_device_link G_GNUC_UNUSED,\n                   const char *ifname G_GNUC_UNUSED,\n                   const char *file G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Unable to get sysfs info on this platform\"));\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"%lld\"",
            "(long long) pidInNs"
          ],
          "line": 514
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint virNetDevSetNamespace(const char *ifname, pid_t pidInNs)\n{\n    int ret = -1;\n    char *pid = NULL;\n    char *phy = NULL;\n    char *phy_path = NULL;\n    int len;\n\n    pid = g_strdup_printf(\"%lld\", (long long) pidInNs);\n\n    /* The 802.11 wireless devices only move together with their PHY. */\n    if (virNetDevSysfsFile(&phy_path, ifname, \"phy80211/name\") < 0)\n        goto cleanup;\n\n    if ((len = virFileReadAllQuiet(phy_path, 1024, &phy)) <= 0) {\n        /* Not a wireless device. */\n        const char *argv[] = {\n            \"ip\", \"link\", \"set\", ifname, \"netns\", NULL, NULL\n        };\n\n        argv[5] = pid;\n        if (virRun(argv, NULL) < 0)\n            goto cleanup;\n\n    } else {\n        const char *argv[] = {\n            \"iw\", \"phy\", NULL, \"set\", \"netns\", NULL, NULL\n        };\n\n        /* Remove a line break. */\n        phy[len - 1] = '\\0';\n\n        argv[2] = phy;\n        argv[5] = pid;\n        if (virRun(argv, NULL) < 0)\n            goto cleanup;\n    }\n\n    ret = 0;\n cleanup:\n    VIR_FREE(phy_path);\n    VIR_FREE(phy);\n    VIR_FREE(pid);\n    return ret;\n}"
  },
  {
    "function_name": "virNetDevSetMTUFromDevice",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
    "lines": "483-492",
    "snippet": "int virNetDevSetMTUFromDevice(const char *ifname,\n                              const char *otherifname)\n{\n    int mtu = virNetDevGetMTU(otherifname);\n\n    if (mtu < 0)\n        return -1;\n\n    return virNetDevSetMTU(ifname, mtu);\n}",
    "includes": [
      "# include <linux/devlink.h>",
      "# include <net/if_dl.h>",
      "# include <sys/sockio.h>",
      "# include <linux/ethtool.h>",
      "# include <linux/types.h>",
      "# include <linux/if_vlan.h>",
      "# include <linux/sockios.h>",
      "#include <fcntl.h>",
      "# include <sys/ioctl.h>",
      "#include \"virjson.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virpci.h\"",
      "#include \"vircommand.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetlink.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetdev.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNetDevSetMTU",
          "args": [
            "ifname",
            "mtu"
          ],
          "line": 491
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevSetMTUFromDevice",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
          "lines": "483-492",
          "snippet": "int virNetDevSetMTUFromDevice(const char *ifname,\n                              const char *otherifname)\n{\n    int mtu = virNetDevGetMTU(otherifname);\n\n    if (mtu < 0)\n        return -1;\n\n    return virNetDevSetMTU(ifname, mtu);\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "virNetDevGetMTU",
          "args": [
            "otherifname"
          ],
          "line": 486
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevGetMTU",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
          "lines": "423-429",
          "snippet": "int virNetDevGetMTU(const char *ifname)\n{\n    virReportSystemError(ENOSYS,\n                         _(\"Cannot get interface MTU on '%s'\"),\n                         ifname);\n    return -1;\n}",
          "includes": [
            "# include <linux/devlink.h>",
            "# include <net/if_dl.h>",
            "# include <sys/sockio.h>",
            "# include <linux/ethtool.h>",
            "# include <linux/types.h>",
            "# include <linux/if_vlan.h>",
            "# include <linux/sockios.h>",
            "#include <fcntl.h>",
            "# include <sys/ioctl.h>",
            "#include \"virjson.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virpci.h\"",
            "#include \"vircommand.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetlink.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetdev.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint virNetDevGetMTU(const char *ifname)\n{\n    virReportSystemError(ENOSYS,\n                         _(\"Cannot get interface MTU on '%s'\"),\n                         ifname);\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint virNetDevSetMTUFromDevice(const char *ifname,\n                              const char *otherifname)\n{\n    int mtu = virNetDevGetMTU(otherifname);\n\n    if (mtu < 0)\n        return -1;\n\n    return virNetDevSetMTU(ifname, mtu);\n}"
  },
  {
    "function_name": "virNetDevSetMTU",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
    "lines": "464-470",
    "snippet": "int virNetDevSetMTU(const char *ifname, int mtu G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS,\n                         _(\"Cannot set interface MTU on '%s'\"),\n                         ifname);\n    return -1;\n}",
    "includes": [
      "# include <linux/devlink.h>",
      "# include <net/if_dl.h>",
      "# include <sys/sockio.h>",
      "# include <linux/ethtool.h>",
      "# include <linux/types.h>",
      "# include <linux/if_vlan.h>",
      "# include <linux/sockios.h>",
      "#include <fcntl.h>",
      "# include <sys/ioctl.h>",
      "#include \"virjson.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virpci.h\"",
      "#include \"vircommand.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetlink.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetdev.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "_(\"Cannot set interface MTU on '%s'\")",
            "ifname"
          ],
          "line": 466
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Cannot set interface MTU on '%s'\""
          ],
          "line": 467
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint virNetDevSetMTU(const char *ifname, int mtu G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS,\n                         _(\"Cannot set interface MTU on '%s'\"),\n                         ifname);\n    return -1;\n}"
  },
  {
    "function_name": "virNetDevSetMTU",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
    "lines": "444-462",
    "snippet": "int virNetDevSetMTU(const char *ifname, int mtu)\n{\n    struct ifreq ifr;\n    VIR_AUTOCLOSE fd = -1;\n\n    if ((fd = virNetDevSetupControl(ifname, &ifr)) < 0)\n        return -1;\n\n    ifr.ifr_mtu = mtu;\n\n    if (ioctl(fd, SIOCSIFMTU, &ifr) < 0) {\n        virReportSystemError(errno,\n                             _(\"Cannot set interface MTU on '%s'\"),\n                             ifname);\n        return -1;\n    }\n\n    return 0;\n}",
    "includes": [
      "# include <linux/devlink.h>",
      "# include <net/if_dl.h>",
      "# include <sys/sockio.h>",
      "# include <linux/ethtool.h>",
      "# include <linux/types.h>",
      "# include <linux/if_vlan.h>",
      "# include <linux/sockios.h>",
      "#include <fcntl.h>",
      "# include <sys/ioctl.h>",
      "#include \"virjson.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virpci.h\"",
      "#include \"vircommand.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetlink.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetdev.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"Cannot set interface MTU on '%s'\")",
            "ifname"
          ],
          "line": 455
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Cannot set interface MTU on '%s'\""
          ],
          "line": 456
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ioctl",
          "args": [
            "fd",
            "SIOCSIFMTU",
            "&ifr"
          ],
          "line": 454
        },
        "resolved": true,
        "details": {
          "function_name": "vir_ioctlsocket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsocket.c",
          "lines": "292-308",
          "snippet": "int\nvir_ioctlsocket(int fd, int cmd, void *arg)\n{\n    SOCKET sk = FD2SK(fd);\n\n    if (sk == INVALID_SOCKET) {\n        errno = EBADF;\n        return -1;\n    }\n\n    if (ioctlsocket(sk, cmd, arg) < 0) {\n        set_errno();\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include <fcntl.h>",
            "#include \"virfile.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <fcntl.h>\n#include \"virfile.h\"\n#include \"virutil.h\"\n#include \"virsocket.h\"\n#include <config.h>\n\nint\nvir_ioctlsocket(int fd, int cmd, void *arg)\n{\n    SOCKET sk = FD2SK(fd);\n\n    if (sk == INVALID_SOCKET) {\n        errno = EBADF;\n        return -1;\n    }\n\n    if (ioctlsocket(sk, cmd, arg) < 0) {\n        set_errno();\n        return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetDevSetupControl",
          "args": [
            "ifname",
            "&ifr"
          ],
          "line": 449
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevSetupControl",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
          "lines": "177-185",
          "snippet": "int\nvirNetDevSetupControl(const char *ifname G_GNUC_UNUSED,\n                      void *ifr G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Network device configuration is not supported \"\n                           \"on this platform\"));\n    return -1;\n}",
          "includes": [
            "# include <linux/devlink.h>",
            "# include <net/if_dl.h>",
            "# include <sys/sockio.h>",
            "# include <linux/ethtool.h>",
            "# include <linux/types.h>",
            "# include <linux/if_vlan.h>",
            "# include <linux/sockios.h>",
            "#include <fcntl.h>",
            "# include <sys/ioctl.h>",
            "#include \"virjson.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virpci.h\"",
            "#include \"vircommand.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetlink.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetdev.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint\nvirNetDevSetupControl(const char *ifname G_GNUC_UNUSED,\n                      void *ifr G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Network device configuration is not supported \"\n                           \"on this platform\"));\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint virNetDevSetMTU(const char *ifname, int mtu)\n{\n    struct ifreq ifr;\n    VIR_AUTOCLOSE fd = -1;\n\n    if ((fd = virNetDevSetupControl(ifname, &ifr)) < 0)\n        return -1;\n\n    ifr.ifr_mtu = mtu;\n\n    if (ioctl(fd, SIOCSIFMTU, &ifr) < 0) {\n        virReportSystemError(errno,\n                             _(\"Cannot set interface MTU on '%s'\"),\n                             ifname);\n        return -1;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virNetDevGetMTU",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
    "lines": "423-429",
    "snippet": "int virNetDevGetMTU(const char *ifname)\n{\n    virReportSystemError(ENOSYS,\n                         _(\"Cannot get interface MTU on '%s'\"),\n                         ifname);\n    return -1;\n}",
    "includes": [
      "# include <linux/devlink.h>",
      "# include <net/if_dl.h>",
      "# include <sys/sockio.h>",
      "# include <linux/ethtool.h>",
      "# include <linux/types.h>",
      "# include <linux/if_vlan.h>",
      "# include <linux/sockios.h>",
      "#include <fcntl.h>",
      "# include <sys/ioctl.h>",
      "#include \"virjson.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virpci.h\"",
      "#include \"vircommand.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetlink.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetdev.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "_(\"Cannot get interface MTU on '%s'\")",
            "ifname"
          ],
          "line": 425
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Cannot get interface MTU on '%s'\""
          ],
          "line": 426
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint virNetDevGetMTU(const char *ifname)\n{\n    virReportSystemError(ENOSYS,\n                         _(\"Cannot get interface MTU on '%s'\"),\n                         ifname);\n    return -1;\n}"
  },
  {
    "function_name": "virNetDevGetMTU",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
    "lines": "405-421",
    "snippet": "int virNetDevGetMTU(const char *ifname)\n{\n    struct ifreq ifr;\n    VIR_AUTOCLOSE fd = -1;\n\n    if ((fd = virNetDevSetupControl(ifname, &ifr)) < 0)\n        return -1;\n\n    if (ioctl(fd, SIOCGIFMTU, &ifr) < 0) {\n        virReportSystemError(errno,\n                             _(\"Cannot get interface MTU on '%s'\"),\n                             ifname);\n        return -1;\n    }\n\n    return ifr.ifr_mtu;\n}",
    "includes": [
      "# include <linux/devlink.h>",
      "# include <net/if_dl.h>",
      "# include <sys/sockio.h>",
      "# include <linux/ethtool.h>",
      "# include <linux/types.h>",
      "# include <linux/if_vlan.h>",
      "# include <linux/sockios.h>",
      "#include <fcntl.h>",
      "# include <sys/ioctl.h>",
      "#include \"virjson.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virpci.h\"",
      "#include \"vircommand.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetlink.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetdev.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"Cannot get interface MTU on '%s'\")",
            "ifname"
          ],
          "line": 414
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Cannot get interface MTU on '%s'\""
          ],
          "line": 415
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ioctl",
          "args": [
            "fd",
            "SIOCGIFMTU",
            "&ifr"
          ],
          "line": 413
        },
        "resolved": true,
        "details": {
          "function_name": "vir_ioctlsocket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsocket.c",
          "lines": "292-308",
          "snippet": "int\nvir_ioctlsocket(int fd, int cmd, void *arg)\n{\n    SOCKET sk = FD2SK(fd);\n\n    if (sk == INVALID_SOCKET) {\n        errno = EBADF;\n        return -1;\n    }\n\n    if (ioctlsocket(sk, cmd, arg) < 0) {\n        set_errno();\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include <fcntl.h>",
            "#include \"virfile.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <fcntl.h>\n#include \"virfile.h\"\n#include \"virutil.h\"\n#include \"virsocket.h\"\n#include <config.h>\n\nint\nvir_ioctlsocket(int fd, int cmd, void *arg)\n{\n    SOCKET sk = FD2SK(fd);\n\n    if (sk == INVALID_SOCKET) {\n        errno = EBADF;\n        return -1;\n    }\n\n    if (ioctlsocket(sk, cmd, arg) < 0) {\n        set_errno();\n        return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetDevSetupControl",
          "args": [
            "ifname",
            "&ifr"
          ],
          "line": 410
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevSetupControl",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
          "lines": "177-185",
          "snippet": "int\nvirNetDevSetupControl(const char *ifname G_GNUC_UNUSED,\n                      void *ifr G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Network device configuration is not supported \"\n                           \"on this platform\"));\n    return -1;\n}",
          "includes": [
            "# include <linux/devlink.h>",
            "# include <net/if_dl.h>",
            "# include <sys/sockio.h>",
            "# include <linux/ethtool.h>",
            "# include <linux/types.h>",
            "# include <linux/if_vlan.h>",
            "# include <linux/sockios.h>",
            "#include <fcntl.h>",
            "# include <sys/ioctl.h>",
            "#include \"virjson.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virpci.h\"",
            "#include \"vircommand.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetlink.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetdev.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint\nvirNetDevSetupControl(const char *ifname G_GNUC_UNUSED,\n                      void *ifr G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Network device configuration is not supported \"\n                           \"on this platform\"));\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint virNetDevGetMTU(const char *ifname)\n{\n    struct ifreq ifr;\n    VIR_AUTOCLOSE fd = -1;\n\n    if ((fd = virNetDevSetupControl(ifname, &ifr)) < 0)\n        return -1;\n\n    if (ioctl(fd, SIOCGIFMTU, &ifr) < 0) {\n        virReportSystemError(errno,\n                             _(\"Cannot get interface MTU on '%s'\"),\n                             ifname);\n        return -1;\n    }\n\n    return ifr.ifr_mtu;\n}"
  },
  {
    "function_name": "virNetDevGetMAC",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
    "lines": "385-392",
    "snippet": "int virNetDevGetMAC(const char *ifname,\n                    virMacAddrPtr macaddr G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS,\n                         _(\"Cannot get interface MAC on '%s'\"),\n                         ifname);\n    return -1;\n}",
    "includes": [
      "# include <linux/devlink.h>",
      "# include <net/if_dl.h>",
      "# include <sys/sockio.h>",
      "# include <linux/ethtool.h>",
      "# include <linux/types.h>",
      "# include <linux/if_vlan.h>",
      "# include <linux/sockios.h>",
      "#include <fcntl.h>",
      "# include <sys/ioctl.h>",
      "#include \"virjson.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virpci.h\"",
      "#include \"vircommand.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetlink.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetdev.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "_(\"Cannot get interface MAC on '%s'\")",
            "ifname"
          ],
          "line": 388
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Cannot get interface MAC on '%s'\""
          ],
          "line": 389
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint virNetDevGetMAC(const char *ifname,\n                    virMacAddrPtr macaddr G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS,\n                         _(\"Cannot get interface MAC on '%s'\"),\n                         ifname);\n    return -1;\n}"
  },
  {
    "function_name": "virNetDevGetMAC",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
    "lines": "364-383",
    "snippet": "int virNetDevGetMAC(const char *ifname,\n                    virMacAddrPtr macaddr)\n{\n    struct ifreq ifr;\n    VIR_AUTOCLOSE fd = -1;\n\n    if ((fd = virNetDevSetupControl(ifname, &ifr)) < 0)\n        return -1;\n\n    if (ioctl(fd, SIOCGIFHWADDR, &ifr) < 0) {\n        virReportSystemError(errno,\n                             _(\"Cannot get interface MAC on '%s'\"),\n                             ifname);\n        return -1;\n    }\n\n    virMacAddrSetRaw(macaddr, (unsigned char *)ifr.ifr_hwaddr.sa_data);\n\n    return 0;\n}",
    "includes": [
      "# include <linux/devlink.h>",
      "# include <net/if_dl.h>",
      "# include <sys/sockio.h>",
      "# include <linux/ethtool.h>",
      "# include <linux/types.h>",
      "# include <linux/if_vlan.h>",
      "# include <linux/sockios.h>",
      "#include <fcntl.h>",
      "# include <sys/ioctl.h>",
      "#include \"virjson.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virpci.h\"",
      "#include \"vircommand.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetlink.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetdev.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virMacAddrSetRaw",
          "args": [
            "macaddr",
            "(unsigned char *)ifr.ifr_hwaddr.sa_data"
          ],
          "line": 380
        },
        "resolved": true,
        "details": {
          "function_name": "virMacAddrSetRaw",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virmacaddr.c",
          "lines": "113-117",
          "snippet": "void\nvirMacAddrSetRaw(virMacAddrPtr dst, const unsigned char src[VIR_MAC_BUFLEN])\n{\n    memcpy(dst->addr, src, VIR_MAC_BUFLEN);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virrandom.h\"",
            "#include \"virmacaddr.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virrandom.h\"\n#include \"virmacaddr.h\"\n#include <config.h>\n\nvoid\nvirMacAddrSetRaw(virMacAddrPtr dst, const unsigned char src[VIR_MAC_BUFLEN])\n{\n    memcpy(dst->addr, src, VIR_MAC_BUFLEN);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"Cannot get interface MAC on '%s'\")",
            "ifname"
          ],
          "line": 374
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Cannot get interface MAC on '%s'\""
          ],
          "line": 375
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ioctl",
          "args": [
            "fd",
            "SIOCGIFHWADDR",
            "&ifr"
          ],
          "line": 373
        },
        "resolved": true,
        "details": {
          "function_name": "vir_ioctlsocket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsocket.c",
          "lines": "292-308",
          "snippet": "int\nvir_ioctlsocket(int fd, int cmd, void *arg)\n{\n    SOCKET sk = FD2SK(fd);\n\n    if (sk == INVALID_SOCKET) {\n        errno = EBADF;\n        return -1;\n    }\n\n    if (ioctlsocket(sk, cmd, arg) < 0) {\n        set_errno();\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include <fcntl.h>",
            "#include \"virfile.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <fcntl.h>\n#include \"virfile.h\"\n#include \"virutil.h\"\n#include \"virsocket.h\"\n#include <config.h>\n\nint\nvir_ioctlsocket(int fd, int cmd, void *arg)\n{\n    SOCKET sk = FD2SK(fd);\n\n    if (sk == INVALID_SOCKET) {\n        errno = EBADF;\n        return -1;\n    }\n\n    if (ioctlsocket(sk, cmd, arg) < 0) {\n        set_errno();\n        return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetDevSetupControl",
          "args": [
            "ifname",
            "&ifr"
          ],
          "line": 370
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevSetupControl",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
          "lines": "177-185",
          "snippet": "int\nvirNetDevSetupControl(const char *ifname G_GNUC_UNUSED,\n                      void *ifr G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Network device configuration is not supported \"\n                           \"on this platform\"));\n    return -1;\n}",
          "includes": [
            "# include <linux/devlink.h>",
            "# include <net/if_dl.h>",
            "# include <sys/sockio.h>",
            "# include <linux/ethtool.h>",
            "# include <linux/types.h>",
            "# include <linux/if_vlan.h>",
            "# include <linux/sockios.h>",
            "#include <fcntl.h>",
            "# include <sys/ioctl.h>",
            "#include \"virjson.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virpci.h\"",
            "#include \"vircommand.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetlink.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetdev.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint\nvirNetDevSetupControl(const char *ifname G_GNUC_UNUSED,\n                      void *ifr G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Network device configuration is not supported \"\n                           \"on this platform\"));\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint virNetDevGetMAC(const char *ifname,\n                    virMacAddrPtr macaddr)\n{\n    struct ifreq ifr;\n    VIR_AUTOCLOSE fd = -1;\n\n    if ((fd = virNetDevSetupControl(ifname, &ifr)) < 0)\n        return -1;\n\n    if (ioctl(fd, SIOCGIFHWADDR, &ifr) < 0) {\n        virReportSystemError(errno,\n                             _(\"Cannot get interface MAC on '%s'\"),\n                             ifname);\n        return -1;\n    }\n\n    virMacAddrSetRaw(macaddr, (unsigned char *)ifr.ifr_hwaddr.sa_data);\n\n    return 0;\n}"
  },
  {
    "function_name": "virNetDevSetMAC",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
    "lines": "346-351",
    "snippet": "int\nvirNetDevSetMAC(const char *ifname,\n                const virMacAddr *macaddr)\n{\n    return virNetDevSetMACInternal(ifname, macaddr, false);\n}",
    "includes": [
      "# include <linux/devlink.h>",
      "# include <net/if_dl.h>",
      "# include <sys/sockio.h>",
      "# include <linux/ethtool.h>",
      "# include <linux/types.h>",
      "# include <linux/if_vlan.h>",
      "# include <linux/sockios.h>",
      "#include <fcntl.h>",
      "# include <sys/ioctl.h>",
      "#include \"virjson.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virpci.h\"",
      "#include \"vircommand.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetlink.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetdev.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNetDevSetMACInternal",
          "args": [
            "ifname",
            "macaddr",
            "false"
          ],
          "line": 350
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevSetMACInternal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
          "lines": "331-340",
          "snippet": "static int\nvirNetDevSetMACInternal(const char *ifname,\n                        const virMacAddr *macaddr G_GNUC_UNUSED,\n                        bool quiet G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS,\n                         _(\"Cannot set interface MAC on '%s'\"),\n                         ifname);\n    return -1;\n}",
          "includes": [
            "# include <linux/devlink.h>",
            "# include <net/if_dl.h>",
            "# include <sys/sockio.h>",
            "# include <linux/ethtool.h>",
            "# include <linux/types.h>",
            "# include <linux/if_vlan.h>",
            "# include <linux/sockios.h>",
            "#include <fcntl.h>",
            "# include <sys/ioctl.h>",
            "#include \"virjson.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virpci.h\"",
            "#include \"vircommand.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetlink.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetdev.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nstatic int\nvirNetDevSetMACInternal(const char *ifname,\n                        const virMacAddr *macaddr G_GNUC_UNUSED,\n                        bool quiet G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS,\n                         _(\"Cannot set interface MAC on '%s'\"),\n                         ifname);\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint\nvirNetDevSetMAC(const char *ifname,\n                const virMacAddr *macaddr)\n{\n    return virNetDevSetMACInternal(ifname, macaddr, false);\n}"
  },
  {
    "function_name": "virNetDevSetMACInternal",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
    "lines": "331-340",
    "snippet": "static int\nvirNetDevSetMACInternal(const char *ifname,\n                        const virMacAddr *macaddr G_GNUC_UNUSED,\n                        bool quiet G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS,\n                         _(\"Cannot set interface MAC on '%s'\"),\n                         ifname);\n    return -1;\n}",
    "includes": [
      "# include <linux/devlink.h>",
      "# include <net/if_dl.h>",
      "# include <sys/sockio.h>",
      "# include <linux/ethtool.h>",
      "# include <linux/types.h>",
      "# include <linux/if_vlan.h>",
      "# include <linux/sockios.h>",
      "#include <fcntl.h>",
      "# include <sys/ioctl.h>",
      "#include \"virjson.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virpci.h\"",
      "#include \"vircommand.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetlink.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetdev.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "_(\"Cannot set interface MAC on '%s'\")",
            "ifname"
          ],
          "line": 336
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Cannot set interface MAC on '%s'\""
          ],
          "line": 337
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nstatic int\nvirNetDevSetMACInternal(const char *ifname,\n                        const virMacAddr *macaddr G_GNUC_UNUSED,\n                        bool quiet G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS,\n                         _(\"Cannot set interface MAC on '%s'\"),\n                         ifname);\n    return -1;\n}"
  },
  {
    "function_name": "virNetDevSetMACInternal",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
    "lines": "290-325",
    "snippet": "static int\nvirNetDevSetMACInternal(const char *ifname,\n                        const virMacAddr *macaddr,\n                        bool quiet)\n{\n    struct ifreq ifr;\n    struct sockaddr_dl sdl;\n    char mac[VIR_MAC_STRING_BUFLEN + 1] = \":\";\n    VIR_AUTOCLOSE s = -1;\n\n    if ((s = virNetDevSetupControl(ifname, &ifr)) < 0)\n        return -1;\n\n    virMacAddrFormat(macaddr, mac + 1);\n    sdl.sdl_len = sizeof(sdl);\n    link_addr(mac, &sdl);\n\n    memcpy(ifr.ifr_addr.sa_data, sdl.sdl_data, VIR_MAC_BUFLEN);\n    ifr.ifr_addr.sa_len = VIR_MAC_BUFLEN;\n\n    if (ioctl(s, SIOCSIFLLADDR, &ifr) < 0) {\n        if (quiet &&\n            (errno == EADDRNOTAVAIL || errno == EPERM)) {\n            VIR_DEBUG(\"SIOCSIFLLADDR %s MAC=%s - Fail\", ifname, mac + 1);\n            return -1;\n        }\n\n        virReportSystemError(errno,\n                             _(\"Cannot set interface MAC to %s on '%s'\"),\n                             mac + 1, ifname);\n        return -1;\n    }\n\n    VIR_DEBUG(\"SIOCSIFLLADDR %s MAC=%s - Success\", ifname, mac + 1);\n    return 0;\n}",
    "includes": [
      "# include <linux/devlink.h>",
      "# include <net/if_dl.h>",
      "# include <sys/sockio.h>",
      "# include <linux/ethtool.h>",
      "# include <linux/types.h>",
      "# include <linux/if_vlan.h>",
      "# include <linux/sockios.h>",
      "#include <fcntl.h>",
      "# include <sys/ioctl.h>",
      "#include \"virjson.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virpci.h\"",
      "#include \"vircommand.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetlink.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetdev.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"SIOCSIFLLADDR %s MAC=%s - Success\"",
            "ifname",
            "mac + 1"
          ],
          "line": 323
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"Cannot set interface MAC to %s on '%s'\")",
            "mac + 1",
            "ifname"
          ],
          "line": 317
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Cannot set interface MAC to %s on '%s'\""
          ],
          "line": 318
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"SIOCSIFLLADDR %s MAC=%s - Fail\"",
            "ifname",
            "mac + 1"
          ],
          "line": 313
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ioctl",
          "args": [
            "s",
            "SIOCSIFLLADDR",
            "&ifr"
          ],
          "line": 310
        },
        "resolved": true,
        "details": {
          "function_name": "vir_ioctlsocket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsocket.c",
          "lines": "292-308",
          "snippet": "int\nvir_ioctlsocket(int fd, int cmd, void *arg)\n{\n    SOCKET sk = FD2SK(fd);\n\n    if (sk == INVALID_SOCKET) {\n        errno = EBADF;\n        return -1;\n    }\n\n    if (ioctlsocket(sk, cmd, arg) < 0) {\n        set_errno();\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include <fcntl.h>",
            "#include \"virfile.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <fcntl.h>\n#include \"virfile.h\"\n#include \"virutil.h\"\n#include \"virsocket.h\"\n#include <config.h>\n\nint\nvir_ioctlsocket(int fd, int cmd, void *arg)\n{\n    SOCKET sk = FD2SK(fd);\n\n    if (sk == INVALID_SOCKET) {\n        errno = EBADF;\n        return -1;\n    }\n\n    if (ioctlsocket(sk, cmd, arg) < 0) {\n        set_errno();\n        return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "ifr.ifr_addr.sa_data",
            "sdl.sdl_data",
            "VIR_MAC_BUFLEN"
          ],
          "line": 307
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "link_addr",
          "args": [
            "mac",
            "&sdl"
          ],
          "line": 305
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virMacAddrFormat",
          "args": [
            "macaddr",
            "mac + 1"
          ],
          "line": 303
        },
        "resolved": true,
        "details": {
          "function_name": "virMacAddrFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virmacaddr.c",
          "lines": "184-194",
          "snippet": "const char *\nvirMacAddrFormat(const virMacAddr *addr,\n                 char *str)\n{\n    g_snprintf(str, VIR_MAC_STRING_BUFLEN,\n               \"%02x:%02x:%02x:%02x:%02x:%02x\",\n               addr->addr[0], addr->addr[1], addr->addr[2],\n               addr->addr[3], addr->addr[4], addr->addr[5]);\n    str[VIR_MAC_STRING_BUFLEN-1] = '\\0';\n    return str;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virrandom.h\"",
            "#include \"virmacaddr.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virrandom.h\"\n#include \"virmacaddr.h\"\n#include <config.h>\n\nconst char *\nvirMacAddrFormat(const virMacAddr *addr,\n                 char *str)\n{\n    g_snprintf(str, VIR_MAC_STRING_BUFLEN,\n               \"%02x:%02x:%02x:%02x:%02x:%02x\",\n               addr->addr[0], addr->addr[1], addr->addr[2],\n               addr->addr[3], addr->addr[4], addr->addr[5]);\n    str[VIR_MAC_STRING_BUFLEN-1] = '\\0';\n    return str;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetDevSetupControl",
          "args": [
            "ifname",
            "&ifr"
          ],
          "line": 300
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevSetupControl",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
          "lines": "177-185",
          "snippet": "int\nvirNetDevSetupControl(const char *ifname G_GNUC_UNUSED,\n                      void *ifr G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Network device configuration is not supported \"\n                           \"on this platform\"));\n    return -1;\n}",
          "includes": [
            "# include <linux/devlink.h>",
            "# include <net/if_dl.h>",
            "# include <sys/sockio.h>",
            "# include <linux/ethtool.h>",
            "# include <linux/types.h>",
            "# include <linux/if_vlan.h>",
            "# include <linux/sockios.h>",
            "#include <fcntl.h>",
            "# include <sys/ioctl.h>",
            "#include \"virjson.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virpci.h\"",
            "#include \"vircommand.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetlink.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetdev.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint\nvirNetDevSetupControl(const char *ifname G_GNUC_UNUSED,\n                      void *ifr G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Network device configuration is not supported \"\n                           \"on this platform\"));\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nstatic int\nvirNetDevSetMACInternal(const char *ifname,\n                        const virMacAddr *macaddr,\n                        bool quiet)\n{\n    struct ifreq ifr;\n    struct sockaddr_dl sdl;\n    char mac[VIR_MAC_STRING_BUFLEN + 1] = \":\";\n    VIR_AUTOCLOSE s = -1;\n\n    if ((s = virNetDevSetupControl(ifname, &ifr)) < 0)\n        return -1;\n\n    virMacAddrFormat(macaddr, mac + 1);\n    sdl.sdl_len = sizeof(sdl);\n    link_addr(mac, &sdl);\n\n    memcpy(ifr.ifr_addr.sa_data, sdl.sdl_data, VIR_MAC_BUFLEN);\n    ifr.ifr_addr.sa_len = VIR_MAC_BUFLEN;\n\n    if (ioctl(s, SIOCSIFLLADDR, &ifr) < 0) {\n        if (quiet &&\n            (errno == EADDRNOTAVAIL || errno == EPERM)) {\n            VIR_DEBUG(\"SIOCSIFLLADDR %s MAC=%s - Fail\", ifname, mac + 1);\n            return -1;\n        }\n\n        virReportSystemError(errno,\n                             _(\"Cannot set interface MAC to %s on '%s'\"),\n                             mac + 1, ifname);\n        return -1;\n    }\n\n    VIR_DEBUG(\"SIOCSIFLLADDR %s MAC=%s - Success\", ifname, mac + 1);\n    return 0;\n}"
  },
  {
    "function_name": "virNetDevSetMACInternal",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
    "lines": "241-283",
    "snippet": "static int\nvirNetDevSetMACInternal(const char *ifname,\n                        const virMacAddr *macaddr,\n                        bool quiet)\n{\n    struct ifreq ifr;\n    char macstr[VIR_MAC_STRING_BUFLEN];\n    VIR_AUTOCLOSE fd = -1;\n\n    if ((fd = virNetDevSetupControl(ifname, &ifr)) < 0)\n        return -1;\n\n    /* To fill ifr.ifr_hdaddr.sa_family field */\n    if (ioctl(fd, SIOCGIFHWADDR, &ifr) < 0) {\n        virReportSystemError(errno, _(\"Cannot get interface MAC on '%s'\"),\n                             ifname);\n\n        VIR_DEBUG(\"SIOCSIFHWADDR %s get MAC - Fail\", ifname);\n        return -1;\n    }\n\n    virMacAddrGetRaw(macaddr, (unsigned char *)ifr.ifr_hwaddr.sa_data);\n\n    if (ioctl(fd, SIOCSIFHWADDR, &ifr) < 0) {\n\n        if (quiet &&\n            (errno == EADDRNOTAVAIL || errno == EPERM)) {\n            VIR_DEBUG(\"SIOCSIFHWADDR %s MAC=%s - Fail\",\n                      ifname, virMacAddrFormat(macaddr, macstr));\n            return -1;\n        }\n\n        virReportSystemError(errno,\n                             _(\"Cannot set interface MAC to %s on '%s'\"),\n                             virMacAddrFormat(macaddr, macstr), ifname);\n        return -1;\n    }\n\n    VIR_DEBUG(\"SIOCSIFHWADDR %s MAC=%s - Success\",\n              ifname, virMacAddrFormat(macaddr, macstr));\n\n    return 0;\n}",
    "includes": [
      "# include <linux/devlink.h>",
      "# include <net/if_dl.h>",
      "# include <sys/sockio.h>",
      "# include <linux/ethtool.h>",
      "# include <linux/types.h>",
      "# include <linux/if_vlan.h>",
      "# include <linux/sockios.h>",
      "#include <fcntl.h>",
      "# include <sys/ioctl.h>",
      "#include \"virjson.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virpci.h\"",
      "#include \"vircommand.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetlink.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetdev.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"SIOCSIFHWADDR %s MAC=%s - Success\"",
            "ifname",
            "virMacAddrFormat(macaddr, macstr)"
          ],
          "line": 279
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virMacAddrFormat",
          "args": [
            "macaddr",
            "macstr"
          ],
          "line": 280
        },
        "resolved": true,
        "details": {
          "function_name": "virMacAddrFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virmacaddr.c",
          "lines": "184-194",
          "snippet": "const char *\nvirMacAddrFormat(const virMacAddr *addr,\n                 char *str)\n{\n    g_snprintf(str, VIR_MAC_STRING_BUFLEN,\n               \"%02x:%02x:%02x:%02x:%02x:%02x\",\n               addr->addr[0], addr->addr[1], addr->addr[2],\n               addr->addr[3], addr->addr[4], addr->addr[5]);\n    str[VIR_MAC_STRING_BUFLEN-1] = '\\0';\n    return str;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virrandom.h\"",
            "#include \"virmacaddr.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virrandom.h\"\n#include \"virmacaddr.h\"\n#include <config.h>\n\nconst char *\nvirMacAddrFormat(const virMacAddr *addr,\n                 char *str)\n{\n    g_snprintf(str, VIR_MAC_STRING_BUFLEN,\n               \"%02x:%02x:%02x:%02x:%02x:%02x\",\n               addr->addr[0], addr->addr[1], addr->addr[2],\n               addr->addr[3], addr->addr[4], addr->addr[5]);\n    str[VIR_MAC_STRING_BUFLEN-1] = '\\0';\n    return str;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"Cannot set interface MAC to %s on '%s'\")",
            "virMacAddrFormat(macaddr, macstr)",
            "ifname"
          ],
          "line": 273
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Cannot set interface MAC to %s on '%s'\""
          ],
          "line": 274
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"SIOCSIFHWADDR %s MAC=%s - Fail\"",
            "ifname",
            "virMacAddrFormat(macaddr, macstr)"
          ],
          "line": 268
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ioctl",
          "args": [
            "fd",
            "SIOCSIFHWADDR",
            "&ifr"
          ],
          "line": 264
        },
        "resolved": true,
        "details": {
          "function_name": "vir_ioctlsocket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsocket.c",
          "lines": "292-308",
          "snippet": "int\nvir_ioctlsocket(int fd, int cmd, void *arg)\n{\n    SOCKET sk = FD2SK(fd);\n\n    if (sk == INVALID_SOCKET) {\n        errno = EBADF;\n        return -1;\n    }\n\n    if (ioctlsocket(sk, cmd, arg) < 0) {\n        set_errno();\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include <fcntl.h>",
            "#include \"virfile.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <fcntl.h>\n#include \"virfile.h\"\n#include \"virutil.h\"\n#include \"virsocket.h\"\n#include <config.h>\n\nint\nvir_ioctlsocket(int fd, int cmd, void *arg)\n{\n    SOCKET sk = FD2SK(fd);\n\n    if (sk == INVALID_SOCKET) {\n        errno = EBADF;\n        return -1;\n    }\n\n    if (ioctlsocket(sk, cmd, arg) < 0) {\n        set_errno();\n        return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virMacAddrGetRaw",
          "args": [
            "macaddr",
            "(unsigned char *)ifr.ifr_hwaddr.sa_data"
          ],
          "line": 262
        },
        "resolved": true,
        "details": {
          "function_name": "virMacAddrGetRaw",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virmacaddr.c",
          "lines": "126-130",
          "snippet": "void\nvirMacAddrGetRaw(const virMacAddr *src, unsigned char dst[VIR_MAC_BUFLEN])\n{\n    memcpy(dst, src->addr, VIR_MAC_BUFLEN);\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virrandom.h\"",
            "#include \"virmacaddr.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virrandom.h\"\n#include \"virmacaddr.h\"\n#include <config.h>\n\nvoid\nvirMacAddrGetRaw(const virMacAddr *src, unsigned char dst[VIR_MAC_BUFLEN])\n{\n    memcpy(dst, src->addr, VIR_MAC_BUFLEN);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"SIOCSIFHWADDR %s get MAC - Fail\"",
            "ifname"
          ],
          "line": 258
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"Cannot get interface MAC on '%s'\")",
            "ifname"
          ],
          "line": 255
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNetDevSetupControl",
          "args": [
            "ifname",
            "&ifr"
          ],
          "line": 250
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevSetupControl",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
          "lines": "177-185",
          "snippet": "int\nvirNetDevSetupControl(const char *ifname G_GNUC_UNUSED,\n                      void *ifr G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Network device configuration is not supported \"\n                           \"on this platform\"));\n    return -1;\n}",
          "includes": [
            "# include <linux/devlink.h>",
            "# include <net/if_dl.h>",
            "# include <sys/sockio.h>",
            "# include <linux/ethtool.h>",
            "# include <linux/types.h>",
            "# include <linux/if_vlan.h>",
            "# include <linux/sockios.h>",
            "#include <fcntl.h>",
            "# include <sys/ioctl.h>",
            "#include \"virjson.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virpci.h\"",
            "#include \"vircommand.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetlink.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetdev.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint\nvirNetDevSetupControl(const char *ifname G_GNUC_UNUSED,\n                      void *ifr G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Network device configuration is not supported \"\n                           \"on this platform\"));\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nstatic int\nvirNetDevSetMACInternal(const char *ifname,\n                        const virMacAddr *macaddr,\n                        bool quiet)\n{\n    struct ifreq ifr;\n    char macstr[VIR_MAC_STRING_BUFLEN];\n    VIR_AUTOCLOSE fd = -1;\n\n    if ((fd = virNetDevSetupControl(ifname, &ifr)) < 0)\n        return -1;\n\n    /* To fill ifr.ifr_hdaddr.sa_family field */\n    if (ioctl(fd, SIOCGIFHWADDR, &ifr) < 0) {\n        virReportSystemError(errno, _(\"Cannot get interface MAC on '%s'\"),\n                             ifname);\n\n        VIR_DEBUG(\"SIOCSIFHWADDR %s get MAC - Fail\", ifname);\n        return -1;\n    }\n\n    virMacAddrGetRaw(macaddr, (unsigned char *)ifr.ifr_hwaddr.sa_data);\n\n    if (ioctl(fd, SIOCSIFHWADDR, &ifr) < 0) {\n\n        if (quiet &&\n            (errno == EADDRNOTAVAIL || errno == EPERM)) {\n            VIR_DEBUG(\"SIOCSIFHWADDR %s MAC=%s - Fail\",\n                      ifname, virMacAddrFormat(macaddr, macstr));\n            return -1;\n        }\n\n        virReportSystemError(errno,\n                             _(\"Cannot set interface MAC to %s on '%s'\"),\n                             virMacAddrFormat(macaddr, macstr), ifname);\n        return -1;\n    }\n\n    VIR_DEBUG(\"SIOCSIFHWADDR %s MAC=%s - Success\",\n              ifname, virMacAddrFormat(macaddr, macstr));\n\n    return 0;\n}"
  },
  {
    "function_name": "virNetDevExists",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
    "lines": "218-223",
    "snippet": "int virNetDevExists(const char *ifname)\n{\n    virReportSystemError(ENOSYS,\n                         _(\"Unable to check interface %s\"), ifname);\n    return -1;\n}",
    "includes": [
      "# include <linux/devlink.h>",
      "# include <net/if_dl.h>",
      "# include <sys/sockio.h>",
      "# include <linux/ethtool.h>",
      "# include <linux/types.h>",
      "# include <linux/if_vlan.h>",
      "# include <linux/sockios.h>",
      "#include <fcntl.h>",
      "# include <sys/ioctl.h>",
      "#include \"virjson.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virpci.h\"",
      "#include \"vircommand.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetlink.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetdev.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "_(\"Unable to check interface %s\")",
            "ifname"
          ],
          "line": 220
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to check interface %s\""
          ],
          "line": 221
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint virNetDevExists(const char *ifname)\n{\n    virReportSystemError(ENOSYS,\n                         _(\"Unable to check interface %s\"), ifname);\n    return -1;\n}"
  },
  {
    "function_name": "virNetDevExists",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
    "lines": "198-216",
    "snippet": "int virNetDevExists(const char *ifname)\n{\n    struct ifreq ifr;\n    VIR_AUTOCLOSE fd = -1;\n\n    if ((fd = virNetDevSetupControl(ifname, &ifr)) < 0)\n        return -1;\n\n    if (ioctl(fd, SIOCGIFFLAGS, &ifr)) {\n        if (errno == ENODEV || errno == ENXIO)\n            return 0;\n\n        virReportSystemError(errno, _(\"Unable to check interface flags for %s\"),\n                             ifname);\n        return -1;\n    }\n\n    return 1;\n}",
    "includes": [
      "# include <linux/devlink.h>",
      "# include <net/if_dl.h>",
      "# include <sys/sockio.h>",
      "# include <linux/ethtool.h>",
      "# include <linux/types.h>",
      "# include <linux/if_vlan.h>",
      "# include <linux/sockios.h>",
      "#include <fcntl.h>",
      "# include <sys/ioctl.h>",
      "#include \"virjson.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virpci.h\"",
      "#include \"vircommand.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetlink.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetdev.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"Unable to check interface flags for %s\")",
            "ifname"
          ],
          "line": 210
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to check interface flags for %s\""
          ],
          "line": 210
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ioctl",
          "args": [
            "fd",
            "SIOCGIFFLAGS",
            "&ifr"
          ],
          "line": 206
        },
        "resolved": true,
        "details": {
          "function_name": "vir_ioctlsocket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsocket.c",
          "lines": "292-308",
          "snippet": "int\nvir_ioctlsocket(int fd, int cmd, void *arg)\n{\n    SOCKET sk = FD2SK(fd);\n\n    if (sk == INVALID_SOCKET) {\n        errno = EBADF;\n        return -1;\n    }\n\n    if (ioctlsocket(sk, cmd, arg) < 0) {\n        set_errno();\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include <fcntl.h>",
            "#include \"virfile.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <fcntl.h>\n#include \"virfile.h\"\n#include \"virutil.h\"\n#include \"virsocket.h\"\n#include <config.h>\n\nint\nvir_ioctlsocket(int fd, int cmd, void *arg)\n{\n    SOCKET sk = FD2SK(fd);\n\n    if (sk == INVALID_SOCKET) {\n        errno = EBADF;\n        return -1;\n    }\n\n    if (ioctlsocket(sk, cmd, arg) < 0) {\n        set_errno();\n        return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNetDevSetupControl",
          "args": [
            "ifname",
            "&ifr"
          ],
          "line": 203
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevSetupControl",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
          "lines": "177-185",
          "snippet": "int\nvirNetDevSetupControl(const char *ifname G_GNUC_UNUSED,\n                      void *ifr G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Network device configuration is not supported \"\n                           \"on this platform\"));\n    return -1;\n}",
          "includes": [
            "# include <linux/devlink.h>",
            "# include <net/if_dl.h>",
            "# include <sys/sockio.h>",
            "# include <linux/ethtool.h>",
            "# include <linux/types.h>",
            "# include <linux/if_vlan.h>",
            "# include <linux/sockios.h>",
            "#include <fcntl.h>",
            "# include <sys/ioctl.h>",
            "#include \"virjson.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virpci.h\"",
            "#include \"vircommand.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetlink.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetdev.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint\nvirNetDevSetupControl(const char *ifname G_GNUC_UNUSED,\n                      void *ifr G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Network device configuration is not supported \"\n                           \"on this platform\"));\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint virNetDevExists(const char *ifname)\n{\n    struct ifreq ifr;\n    VIR_AUTOCLOSE fd = -1;\n\n    if ((fd = virNetDevSetupControl(ifname, &ifr)) < 0)\n        return -1;\n\n    if (ioctl(fd, SIOCGIFFLAGS, &ifr)) {\n        if (errno == ENODEV || errno == ENXIO)\n            return 0;\n\n        virReportSystemError(errno, _(\"Unable to check interface flags for %s\"),\n                             ifname);\n        return -1;\n    }\n\n    return 1;\n}"
  },
  {
    "function_name": "virNetDevSetupControl",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
    "lines": "177-185",
    "snippet": "int\nvirNetDevSetupControl(const char *ifname G_GNUC_UNUSED,\n                      void *ifr G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Network device configuration is not supported \"\n                           \"on this platform\"));\n    return -1;\n}",
    "includes": [
      "# include <linux/devlink.h>",
      "# include <net/if_dl.h>",
      "# include <sys/sockio.h>",
      "# include <linux/ethtool.h>",
      "# include <linux/types.h>",
      "# include <linux/if_vlan.h>",
      "# include <linux/sockios.h>",
      "#include <fcntl.h>",
      "# include <sys/ioctl.h>",
      "#include \"virjson.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virpci.h\"",
      "#include \"vircommand.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetlink.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetdev.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ENOSYS",
            "\"%s\"",
            "_(\"Network device configuration is not supported \"\n                           \"on this platform\")"
          ],
          "line": 181
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Network device configuration is not supported \"\n                           \"on this platform\""
          ],
          "line": 182
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint\nvirNetDevSetupControl(const char *ifname G_GNUC_UNUSED,\n                      void *ifr G_GNUC_UNUSED)\n{\n    virReportSystemError(ENOSYS, \"%s\",\n                         _(\"Network device configuration is not supported \"\n                           \"on this platform\"));\n    return -1;\n}"
  },
  {
    "function_name": "virNetDevSetupControl",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
    "lines": "170-175",
    "snippet": "int\nvirNetDevSetupControl(const char *ifname,\n                      struct ifreq *ifr)\n{\n    return virNetDevSetupControlFull(ifname, ifr, VIR_NETDEV_FAMILY, SOCK_DGRAM);\n}",
    "includes": [
      "# include <linux/devlink.h>",
      "# include <net/if_dl.h>",
      "# include <sys/sockio.h>",
      "# include <linux/ethtool.h>",
      "# include <linux/types.h>",
      "# include <linux/if_vlan.h>",
      "# include <linux/sockios.h>",
      "#include <fcntl.h>",
      "# include <sys/ioctl.h>",
      "#include \"virjson.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virpci.h\"",
      "#include \"vircommand.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetlink.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetdev.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNetDevSetupControlFull",
          "args": [
            "ifname",
            "ifr",
            "VIR_NETDEV_FAMILY",
            "SOCK_DGRAM"
          ],
          "line": 174
        },
        "resolved": true,
        "details": {
          "function_name": "virNetDevSetupControlFull",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
          "lines": "135-167",
          "snippet": "static int virNetDevSetupControlFull(const char *ifname,\n                                     struct ifreq *ifr,\n                                     int domain,\n                                     int type)\n{\n    int fd;\n\n    if (ifr && ifname) {\n        memset(ifr, 0, sizeof(*ifr));\n\n        if (virStrcpyStatic(ifr->ifr_name, ifname) < 0) {\n            virReportSystemError(ERANGE,\n                                 _(\"Network interface name '%s' is too long\"),\n                                 ifname);\n            return -1;\n        }\n    }\n\n    if ((fd = socket(domain, type, 0)) < 0) {\n        virReportSystemError(errno, \"%s\",\n                             _(\"Cannot open network interface control socket\"));\n        return -1;\n    }\n\n    if (virSetInherit(fd, false) < 0) {\n        virReportSystemError(errno, \"%s\",\n                             _(\"Cannot set close-on-exec flag for socket\"));\n        VIR_FORCE_CLOSE(fd);\n        return -1;\n    }\n\n    return fd;\n}",
          "includes": [
            "# include <linux/devlink.h>",
            "# include <net/if_dl.h>",
            "# include <sys/sockio.h>",
            "# include <linux/ethtool.h>",
            "# include <linux/types.h>",
            "# include <linux/if_vlan.h>",
            "# include <linux/sockios.h>",
            "#include <fcntl.h>",
            "# include <sys/ioctl.h>",
            "#include \"virjson.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virpci.h\"",
            "#include \"vircommand.h\"",
            "#include \"virerror.h\"",
            "#include \"virfile.h\"",
            "#include \"virmacaddr.h\"",
            "#include \"virnetlink.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnetdev.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nstatic int virNetDevSetupControlFull(const char *ifname,\n                                     struct ifreq *ifr,\n                                     int domain,\n                                     int type)\n{\n    int fd;\n\n    if (ifr && ifname) {\n        memset(ifr, 0, sizeof(*ifr));\n\n        if (virStrcpyStatic(ifr->ifr_name, ifname) < 0) {\n            virReportSystemError(ERANGE,\n                                 _(\"Network interface name '%s' is too long\"),\n                                 ifname);\n            return -1;\n        }\n    }\n\n    if ((fd = socket(domain, type, 0)) < 0) {\n        virReportSystemError(errno, \"%s\",\n                             _(\"Cannot open network interface control socket\"));\n        return -1;\n    }\n\n    if (virSetInherit(fd, false) < 0) {\n        virReportSystemError(errno, \"%s\",\n                             _(\"Cannot set close-on-exec flag for socket\"));\n        VIR_FORCE_CLOSE(fd);\n        return -1;\n    }\n\n    return fd;\n}"
        }
      }
    ],
    "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nint\nvirNetDevSetupControl(const char *ifname,\n                      struct ifreq *ifr)\n{\n    return virNetDevSetupControlFull(ifname, ifr, VIR_NETDEV_FAMILY, SOCK_DGRAM);\n}"
  },
  {
    "function_name": "virNetDevSetupControlFull",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
    "lines": "135-167",
    "snippet": "static int virNetDevSetupControlFull(const char *ifname,\n                                     struct ifreq *ifr,\n                                     int domain,\n                                     int type)\n{\n    int fd;\n\n    if (ifr && ifname) {\n        memset(ifr, 0, sizeof(*ifr));\n\n        if (virStrcpyStatic(ifr->ifr_name, ifname) < 0) {\n            virReportSystemError(ERANGE,\n                                 _(\"Network interface name '%s' is too long\"),\n                                 ifname);\n            return -1;\n        }\n    }\n\n    if ((fd = socket(domain, type, 0)) < 0) {\n        virReportSystemError(errno, \"%s\",\n                             _(\"Cannot open network interface control socket\"));\n        return -1;\n    }\n\n    if (virSetInherit(fd, false) < 0) {\n        virReportSystemError(errno, \"%s\",\n                             _(\"Cannot set close-on-exec flag for socket\"));\n        VIR_FORCE_CLOSE(fd);\n        return -1;\n    }\n\n    return fd;\n}",
    "includes": [
      "# include <linux/devlink.h>",
      "# include <net/if_dl.h>",
      "# include <sys/sockio.h>",
      "# include <linux/ethtool.h>",
      "# include <linux/types.h>",
      "# include <linux/if_vlan.h>",
      "# include <linux/sockios.h>",
      "#include <fcntl.h>",
      "# include <sys/ioctl.h>",
      "#include \"virjson.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virpci.h\"",
      "#include \"vircommand.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetlink.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetdev.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FORCE_CLOSE",
          "args": [
            "fd"
          ],
          "line": 162
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "\"%s\"",
            "_(\"Cannot set close-on-exec flag for socket\")"
          ],
          "line": 160
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Cannot set close-on-exec flag for socket\""
          ],
          "line": 161
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSetInherit",
          "args": [
            "fd",
            "false"
          ],
          "line": 159
        },
        "resolved": true,
        "details": {
          "function_name": "virSetInherit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
          "lines": "104-111",
          "snippet": "int virSetInherit(int fd G_GNUC_UNUSED, bool inherit G_GNUC_UNUSED)\n{\n    /* FIXME: Currently creating child processes is not supported on\n     * Win32, so there is no point in failing calls that are only relevant\n     * when creating child processes. So just pretend that we changed the\n     * inheritance property of the given fd as requested. */\n    return 0;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <sys/prctl.h>",
            "# include <cap-ng.h>",
            "# include <grp.h>",
            "# include <pwd.h>",
            "# include <libdevmapper.h>",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <conio.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nint virSetInherit(int fd G_GNUC_UNUSED, bool inherit G_GNUC_UNUSED)\n{\n    /* FIXME: Currently creating child processes is not supported on\n     * Win32, so there is no point in failing calls that are only relevant\n     * when creating child processes. So just pretend that we changed the\n     * inheritance property of the given fd as requested. */\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "\"%s\"",
            "_(\"Cannot open network interface control socket\")"
          ],
          "line": 154
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "socket",
          "args": [
            "domain",
            "type",
            "0"
          ],
          "line": 153
        },
        "resolved": true,
        "details": {
          "function_name": "vir_socket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsocket.c",
          "lines": "351-367",
          "snippet": "int\nvir_socket(int domain, int type, int protocol)\n{\n    SOCKET sk;\n\n    /* We have to use WSASocket() instead of socket(), to create\n     * non-overlapped IO sockets. Overlapped IO sockets cannot\n     * be used with read/write.\n     */\n    sk = WSASocket(domain, type, protocol, NULL, 0, 0);\n    if (sk == INVALID_SOCKET) {\n        set_errno();\n        return -1;\n    }\n\n    return SK2FD(sk);\n}",
          "includes": [
            "#include <fcntl.h>",
            "#include \"virfile.h\"",
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <fcntl.h>\n#include \"virfile.h\"\n#include \"virutil.h\"\n#include \"virsocket.h\"\n#include <config.h>\n\nint\nvir_socket(int domain, int type, int protocol)\n{\n    SOCKET sk;\n\n    /* We have to use WSASocket() instead of socket(), to create\n     * non-overlapped IO sockets. Overlapped IO sockets cannot\n     * be used with read/write.\n     */\n    sk = WSASocket(domain, type, protocol, NULL, 0, 0);\n    if (sk == INVALID_SOCKET) {\n        set_errno();\n        return -1;\n    }\n\n    return SK2FD(sk);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "ERANGE",
            "_(\"Network interface name '%s' is too long\")",
            "ifname"
          ],
          "line": 146
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStrcpyStatic",
          "args": [
            "ifr->ifr_name",
            "ifname"
          ],
          "line": 145
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "ifr",
            "0",
            "sizeof(*ifr)"
          ],
          "line": 143
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nstatic int virNetDevSetupControlFull(const char *ifname,\n                                     struct ifreq *ifr,\n                                     int domain,\n                                     int type)\n{\n    int fd;\n\n    if (ifr && ifname) {\n        memset(ifr, 0, sizeof(*ifr));\n\n        if (virStrcpyStatic(ifr->ifr_name, ifname) < 0) {\n            virReportSystemError(ERANGE,\n                                 _(\"Network interface name '%s' is too long\"),\n                                 ifname);\n            return -1;\n        }\n    }\n\n    if ((fd = socket(domain, type, 0)) < 0) {\n        virReportSystemError(errno, \"%s\",\n                             _(\"Cannot open network interface control socket\"));\n        return -1;\n    }\n\n    if (virSetInherit(fd, false) < 0) {\n        virReportSystemError(errno, \"%s\",\n                             _(\"Cannot set close-on-exec flag for socket\"));\n        VIR_FORCE_CLOSE(fd);\n        return -1;\n    }\n\n    return fd;\n}"
  },
  {
    "function_name": "virNetDevMcastEntryFree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virnetdev.c",
    "lines": "119-123",
    "snippet": "static void\nvirNetDevMcastEntryFree(virNetDevMcastEntryPtr entry)\n{\n    VIR_FREE(entry);\n}",
    "includes": [
      "# include <linux/devlink.h>",
      "# include <net/if_dl.h>",
      "# include <sys/sockio.h>",
      "# include <linux/ethtool.h>",
      "# include <linux/types.h>",
      "# include <linux/if_vlan.h>",
      "# include <linux/sockios.h>",
      "#include <fcntl.h>",
      "# include <sys/ioctl.h>",
      "#include \"virjson.h\"",
      "#include \"virutil.h\"",
      "#include \"virstring.h\"",
      "#include \"virlog.h\"",
      "#include \"virpci.h\"",
      "#include \"vircommand.h\"",
      "#include \"virerror.h\"",
      "#include \"virfile.h\"",
      "#include \"virmacaddr.h\"",
      "#include \"virnetlink.h\"",
      "#include \"viralloc.h\"",
      "#include \"virnetdev.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "entry"
          ],
          "line": 122
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "# include <linux/devlink.h>\n# include <net/if_dl.h>\n# include <sys/sockio.h>\n# include <linux/ethtool.h>\n# include <linux/types.h>\n# include <linux/if_vlan.h>\n# include <linux/sockios.h>\n#include <fcntl.h>\n# include <sys/ioctl.h>\n#include \"virjson.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virpci.h\"\n#include \"vircommand.h\"\n#include \"virerror.h\"\n#include \"virfile.h\"\n#include \"virmacaddr.h\"\n#include \"virnetlink.h\"\n#include \"viralloc.h\"\n#include \"virnetdev.h\"\n#include <config.h>\n\nstatic void\nvirNetDevMcastEntryFree(virNetDevMcastEntryPtr entry)\n{\n    VIR_FREE(entry);\n}"
  }
]