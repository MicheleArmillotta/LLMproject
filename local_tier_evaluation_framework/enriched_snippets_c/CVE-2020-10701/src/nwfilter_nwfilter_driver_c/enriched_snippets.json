[
  {
    "function_name": "nwfilterRegister",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_driver.c",
    "lines": "883-892",
    "snippet": "int nwfilterRegister(void)\n{\n    if (virRegisterConnectDriver(&nwfilterConnectDriver, false) < 0)\n        return -1;\n    if (virSetSharedNWFilterDriver(&nwfilterDriver) < 0)\n        return -1;\n    if (virRegisterStateDriver(&stateDriver) < 0)\n        return -1;\n    return 0;\n}",
    "includes": [
      "#include \"nwfilter_learnipaddr.h\"",
      "#include \"nwfilter_dhcpsnoop.h\"",
      "#include \"nwfilter_ipaddrmap.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"nwfilter_gentech_driver.h\"",
      "#include \"nwfilter_driver.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_conf.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include \"internal.h\"",
      "#include \"virlog.h\"",
      "#include \"virdbus.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virNWFilterDriver nwfilterDriver = {\n    .name = \"nwfilter\",\n    .connectNumOfNWFilters = nwfilterConnectNumOfNWFilters, /* 0.8.0 */\n    .connectListNWFilters = nwfilterConnectListNWFilters, /* 0.8.0 */\n    .connectListAllNWFilters = nwfilterConnectListAllNWFilters, /* 0.10.2 */\n    .nwfilterLookupByName = nwfilterLookupByName, /* 0.8.0 */\n    .nwfilterLookupByUUID = nwfilterLookupByUUID, /* 0.8.0 */\n    .nwfilterDefineXML = nwfilterDefineXML, /* 0.8.0 */\n    .nwfilterUndefine = nwfilterUndefine, /* 0.8.0 */\n    .nwfilterGetXMLDesc = nwfilterGetXMLDesc, /* 0.8.0 */\n    .nwfilterBindingLookupByPortDev = nwfilterBindingLookupByPortDev, /* 4.5.0 */\n    .connectListAllNWFilterBindings = nwfilterConnectListAllNWFilterBindings, /* 4.5.0 */\n    .nwfilterBindingGetXMLDesc = nwfilterBindingGetXMLDesc, /* 4.5.0 */\n    .nwfilterBindingCreateXML = nwfilterBindingCreateXML, /* 4.5.0 */\n    .nwfilterBindingDelete = nwfilterBindingDelete, /* 4.5.0 */\n};",
      "static virConnectDriver nwfilterConnectDriver = {\n    .localOnly = true,\n    .uriSchemes = (const char *[]){ \"nwfilter\", NULL },\n    .hypervisorDriver = &nwfilterHypervisorDriver,\n    .nwfilterDriver = &nwfilterDriver,\n};",
      "static virStateDriver stateDriver = {\n    .name = \"NWFilter\",\n    .stateInitialize = nwfilterStateInitialize,\n    .stateCleanup = nwfilterStateCleanup,\n    .stateReload = nwfilterStateReload,\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virRegisterStateDriver",
          "args": [
            "&stateDriver"
          ],
          "line": 889
        },
        "resolved": true,
        "details": {
          "function_name": "virRegisterStateDriver",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt.c",
          "lines": "588-602",
          "snippet": "int\nvirRegisterStateDriver(virStateDriverPtr driver)\n{\n    virCheckNonNullArgReturn(driver, -1);\n\n    if (virStateDriverTabCount >= MAX_DRIVERS) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Too many drivers, cannot register %s\"),\n                       driver->name);\n        return -1;\n    }\n\n    virStateDriverTab[virStateDriverTabCount] = driver;\n    return virStateDriverTabCount++;\n}",
          "includes": [
            "#include \"access/viraccessmanager.h\"",
            "# include \"bhyve/bhyve_driver.h\"",
            "# include \"hyperv/hyperv_driver.h\"",
            "# include \"esx/esx_driver.h\"",
            "# include \"vmware/vmware_driver.h\"",
            "# include \"openvz/openvz_driver.h\"",
            "# include \"remote/remote_driver.h\"",
            "# include \"test/test_driver.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"viruri.h\"",
            "#include \"virrandom.h\"",
            "#include \"virfile.h\"",
            "#include \"virevent.h\"",
            "#include \"vircommand.h\"",
            "#include \"rpc/virnettlscontext.h\"",
            "#include \"virconf.h\"",
            "#include \"configmake.h\"",
            "#include \"viralloc.h\"",
            "#include \"viruuid.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <curl/curl.h>",
            "#include <libxml/xpath.h>",
            "#include <libxml/parser.h>",
            "#include <gio/gnetworking.h>",
            "#include <time.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define MAX_DRIVERS 21"
          ],
          "globals_used": [
            "static virStateDriverPtr virStateDriverTab[MAX_DRIVERS];",
            "static int virStateDriverTabCount;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"access/viraccessmanager.h\"\n# include \"bhyve/bhyve_driver.h\"\n# include \"hyperv/hyperv_driver.h\"\n# include \"esx/esx_driver.h\"\n# include \"vmware/vmware_driver.h\"\n# include \"openvz/openvz_driver.h\"\n# include \"remote/remote_driver.h\"\n# include \"test/test_driver.h\"\n#include \"virtypedparam.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"viruri.h\"\n#include \"virrandom.h\"\n#include \"virfile.h\"\n#include \"virevent.h\"\n#include \"vircommand.h\"\n#include \"rpc/virnettlscontext.h\"\n#include \"virconf.h\"\n#include \"configmake.h\"\n#include \"viralloc.h\"\n#include \"viruuid.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <curl/curl.h>\n#include <libxml/xpath.h>\n#include <libxml/parser.h>\n#include <gio/gnetworking.h>\n#include <time.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\n#define MAX_DRIVERS 21\n\nstatic virStateDriverPtr virStateDriverTab[MAX_DRIVERS];\nstatic int virStateDriverTabCount;\n\nint\nvirRegisterStateDriver(virStateDriverPtr driver)\n{\n    virCheckNonNullArgReturn(driver, -1);\n\n    if (virStateDriverTabCount >= MAX_DRIVERS) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Too many drivers, cannot register %s\"),\n                       driver->name);\n        return -1;\n    }\n\n    virStateDriverTab[virStateDriverTabCount] = driver;\n    return virStateDriverTabCount++;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSetSharedNWFilterDriver",
          "args": [
            "&nwfilterDriver"
          ],
          "line": 887
        },
        "resolved": true,
        "details": {
          "function_name": "virSetSharedNWFilterDriver",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt.c",
          "lines": "487-502",
          "snippet": "int\nvirSetSharedNWFilterDriver(virNWFilterDriverPtr driver)\n{\n    virCheckNonNullArgReturn(driver, -1);\n\n    if (virSharedNWFilterDriver) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"A network filter driver is already registered\"));\n        return -1;\n    }\n\n    VIR_DEBUG(\"registering %s as network filter driver\", driver->name);\n\n    virSharedNWFilterDriver = driver;\n    return 0;\n}",
          "includes": [
            "#include \"access/viraccessmanager.h\"",
            "# include \"bhyve/bhyve_driver.h\"",
            "# include \"hyperv/hyperv_driver.h\"",
            "# include \"esx/esx_driver.h\"",
            "# include \"vmware/vmware_driver.h\"",
            "# include \"openvz/openvz_driver.h\"",
            "# include \"remote/remote_driver.h\"",
            "# include \"test/test_driver.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"viruri.h\"",
            "#include \"virrandom.h\"",
            "#include \"virfile.h\"",
            "#include \"virevent.h\"",
            "#include \"vircommand.h\"",
            "#include \"rpc/virnettlscontext.h\"",
            "#include \"virconf.h\"",
            "#include \"configmake.h\"",
            "#include \"viralloc.h\"",
            "#include \"viruuid.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <curl/curl.h>",
            "#include <libxml/xpath.h>",
            "#include <libxml/parser.h>",
            "#include <gio/gnetworking.h>",
            "#include <time.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virNWFilterDriverPtr virSharedNWFilterDriver;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"access/viraccessmanager.h\"\n# include \"bhyve/bhyve_driver.h\"\n# include \"hyperv/hyperv_driver.h\"\n# include \"esx/esx_driver.h\"\n# include \"vmware/vmware_driver.h\"\n# include \"openvz/openvz_driver.h\"\n# include \"remote/remote_driver.h\"\n# include \"test/test_driver.h\"\n#include \"virtypedparam.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"viruri.h\"\n#include \"virrandom.h\"\n#include \"virfile.h\"\n#include \"virevent.h\"\n#include \"vircommand.h\"\n#include \"rpc/virnettlscontext.h\"\n#include \"virconf.h\"\n#include \"configmake.h\"\n#include \"viralloc.h\"\n#include \"viruuid.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <curl/curl.h>\n#include <libxml/xpath.h>\n#include <libxml/parser.h>\n#include <gio/gnetworking.h>\n#include <time.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic virNWFilterDriverPtr virSharedNWFilterDriver;\n\nint\nvirSetSharedNWFilterDriver(virNWFilterDriverPtr driver)\n{\n    virCheckNonNullArgReturn(driver, -1);\n\n    if (virSharedNWFilterDriver) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"A network filter driver is already registered\"));\n        return -1;\n    }\n\n    VIR_DEBUG(\"registering %s as network filter driver\", driver->name);\n\n    virSharedNWFilterDriver = driver;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virRegisterConnectDriver",
          "args": [
            "&nwfilterConnectDriver",
            "false"
          ],
          "line": 885
        },
        "resolved": true,
        "details": {
          "function_name": "virRegisterConnectDriver",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/libvirt.c",
          "lines": "515-550",
          "snippet": "int\nvirRegisterConnectDriver(virConnectDriverPtr driver,\n                         bool setSharedDrivers)\n{\n    VIR_DEBUG(\"driver=%p name=%s\", driver,\n              driver ? NULLSTR(driver->hypervisorDriver->name) : \"(null)\");\n\n    virCheckNonNullArgReturn(driver, -1);\n    if (virConnectDriverTabCount >= MAX_DRIVERS) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Too many drivers, cannot register %s\"),\n                       driver->hypervisorDriver->name);\n        return -1;\n    }\n\n    VIR_DEBUG(\"registering %s as driver %d\",\n           driver->hypervisorDriver->name, virConnectDriverTabCount);\n\n    if (setSharedDrivers) {\n        if (driver->interfaceDriver == NULL)\n            driver->interfaceDriver = virSharedInterfaceDriver;\n        if (driver->networkDriver == NULL)\n            driver->networkDriver = virSharedNetworkDriver;\n        if (driver->nodeDeviceDriver == NULL)\n            driver->nodeDeviceDriver = virSharedNodeDeviceDriver;\n        if (driver->nwfilterDriver == NULL)\n            driver->nwfilterDriver = virSharedNWFilterDriver;\n        if (driver->secretDriver == NULL)\n            driver->secretDriver = virSharedSecretDriver;\n        if (driver->storageDriver == NULL)\n            driver->storageDriver = virSharedStorageDriver;\n    }\n\n    virConnectDriverTab[virConnectDriverTabCount] = driver;\n    return virConnectDriverTabCount++;\n}",
          "includes": [
            "#include \"access/viraccessmanager.h\"",
            "# include \"bhyve/bhyve_driver.h\"",
            "# include \"hyperv/hyperv_driver.h\"",
            "# include \"esx/esx_driver.h\"",
            "# include \"vmware/vmware_driver.h\"",
            "# include \"openvz/openvz_driver.h\"",
            "# include \"remote/remote_driver.h\"",
            "# include \"test/test_driver.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"viruri.h\"",
            "#include \"virrandom.h\"",
            "#include \"virfile.h\"",
            "#include \"virevent.h\"",
            "#include \"vircommand.h\"",
            "#include \"rpc/virnettlscontext.h\"",
            "#include \"virconf.h\"",
            "#include \"configmake.h\"",
            "#include \"viralloc.h\"",
            "#include \"viruuid.h\"",
            "#include \"driver.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <curl/curl.h>",
            "#include <libxml/xpath.h>",
            "#include <libxml/parser.h>",
            "#include <gio/gnetworking.h>",
            "#include <time.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define MAX_DRIVERS 21"
          ],
          "globals_used": [
            "static virConnectDriverPtr virConnectDriverTab[MAX_DRIVERS];",
            "static int virConnectDriverTabCount;",
            "static virNetworkDriverPtr virSharedNetworkDriver;",
            "static virInterfaceDriverPtr virSharedInterfaceDriver;",
            "static virStorageDriverPtr virSharedStorageDriver;",
            "static virNodeDeviceDriverPtr virSharedNodeDeviceDriver;",
            "static virSecretDriverPtr virSharedSecretDriver;",
            "static virNWFilterDriverPtr virSharedNWFilterDriver;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"access/viraccessmanager.h\"\n# include \"bhyve/bhyve_driver.h\"\n# include \"hyperv/hyperv_driver.h\"\n# include \"esx/esx_driver.h\"\n# include \"vmware/vmware_driver.h\"\n# include \"openvz/openvz_driver.h\"\n# include \"remote/remote_driver.h\"\n# include \"test/test_driver.h\"\n#include \"virtypedparam.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"viruri.h\"\n#include \"virrandom.h\"\n#include \"virfile.h\"\n#include \"virevent.h\"\n#include \"vircommand.h\"\n#include \"rpc/virnettlscontext.h\"\n#include \"virconf.h\"\n#include \"configmake.h\"\n#include \"viralloc.h\"\n#include \"viruuid.h\"\n#include \"driver.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <curl/curl.h>\n#include <libxml/xpath.h>\n#include <libxml/parser.h>\n#include <gio/gnetworking.h>\n#include <time.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\n#define MAX_DRIVERS 21\n\nstatic virConnectDriverPtr virConnectDriverTab[MAX_DRIVERS];\nstatic int virConnectDriverTabCount;\nstatic virNetworkDriverPtr virSharedNetworkDriver;\nstatic virInterfaceDriverPtr virSharedInterfaceDriver;\nstatic virStorageDriverPtr virSharedStorageDriver;\nstatic virNodeDeviceDriverPtr virSharedNodeDeviceDriver;\nstatic virSecretDriverPtr virSharedSecretDriver;\nstatic virNWFilterDriverPtr virSharedNWFilterDriver;\n\nint\nvirRegisterConnectDriver(virConnectDriverPtr driver,\n                         bool setSharedDrivers)\n{\n    VIR_DEBUG(\"driver=%p name=%s\", driver,\n              driver ? NULLSTR(driver->hypervisorDriver->name) : \"(null)\");\n\n    virCheckNonNullArgReturn(driver, -1);\n    if (virConnectDriverTabCount >= MAX_DRIVERS) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Too many drivers, cannot register %s\"),\n                       driver->hypervisorDriver->name);\n        return -1;\n    }\n\n    VIR_DEBUG(\"registering %s as driver %d\",\n           driver->hypervisorDriver->name, virConnectDriverTabCount);\n\n    if (setSharedDrivers) {\n        if (driver->interfaceDriver == NULL)\n            driver->interfaceDriver = virSharedInterfaceDriver;\n        if (driver->networkDriver == NULL)\n            driver->networkDriver = virSharedNetworkDriver;\n        if (driver->nodeDeviceDriver == NULL)\n            driver->nodeDeviceDriver = virSharedNodeDeviceDriver;\n        if (driver->nwfilterDriver == NULL)\n            driver->nwfilterDriver = virSharedNWFilterDriver;\n        if (driver->secretDriver == NULL)\n            driver->secretDriver = virSharedSecretDriver;\n        if (driver->storageDriver == NULL)\n            driver->storageDriver = virSharedStorageDriver;\n    }\n\n    virConnectDriverTab[virConnectDriverTabCount] = driver;\n    return virConnectDriverTabCount++;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"nwfilter_driver.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_conf.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"virlog.h\"\n#include \"virdbus.h\"\n#include <config.h>\n\nstatic virNWFilterDriver nwfilterDriver = {\n    .name = \"nwfilter\",\n    .connectNumOfNWFilters = nwfilterConnectNumOfNWFilters, /* 0.8.0 */\n    .connectListNWFilters = nwfilterConnectListNWFilters, /* 0.8.0 */\n    .connectListAllNWFilters = nwfilterConnectListAllNWFilters, /* 0.10.2 */\n    .nwfilterLookupByName = nwfilterLookupByName, /* 0.8.0 */\n    .nwfilterLookupByUUID = nwfilterLookupByUUID, /* 0.8.0 */\n    .nwfilterDefineXML = nwfilterDefineXML, /* 0.8.0 */\n    .nwfilterUndefine = nwfilterUndefine, /* 0.8.0 */\n    .nwfilterGetXMLDesc = nwfilterGetXMLDesc, /* 0.8.0 */\n    .nwfilterBindingLookupByPortDev = nwfilterBindingLookupByPortDev, /* 4.5.0 */\n    .connectListAllNWFilterBindings = nwfilterConnectListAllNWFilterBindings, /* 4.5.0 */\n    .nwfilterBindingGetXMLDesc = nwfilterBindingGetXMLDesc, /* 4.5.0 */\n    .nwfilterBindingCreateXML = nwfilterBindingCreateXML, /* 4.5.0 */\n    .nwfilterBindingDelete = nwfilterBindingDelete, /* 4.5.0 */\n};\nstatic virConnectDriver nwfilterConnectDriver = {\n    .localOnly = true,\n    .uriSchemes = (const char *[]){ \"nwfilter\", NULL },\n    .hypervisorDriver = &nwfilterHypervisorDriver,\n    .nwfilterDriver = &nwfilterDriver,\n};\nstatic virStateDriver stateDriver = {\n    .name = \"NWFilter\",\n    .stateInitialize = nwfilterStateInitialize,\n    .stateCleanup = nwfilterStateCleanup,\n    .stateReload = nwfilterStateReload,\n};\n\nint nwfilterRegister(void)\n{\n    if (virRegisterConnectDriver(&nwfilterConnectDriver, false) < 0)\n        return -1;\n    if (virSetSharedNWFilterDriver(&nwfilterDriver) < 0)\n        return -1;\n    if (virRegisterStateDriver(&stateDriver) < 0)\n        return -1;\n    return 0;\n}"
  },
  {
    "function_name": "nwfilterBindingDelete",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_driver.c",
    "lines": "810-837",
    "snippet": "static int\nnwfilterBindingDelete(virNWFilterBindingPtr binding)\n{\n    virNWFilterBindingObjPtr obj;\n    virNWFilterBindingDefPtr def;\n    int ret = -1;\n\n    obj = virNWFilterBindingObjListFindByPortDev(driver->bindings, binding->portdev);\n    if (!obj) {\n        virReportError(VIR_ERR_NO_NWFILTER_BINDING,\n                       _(\"no nwfilter binding for port dev '%s'\"), binding->portdev);\n        return -1;\n    }\n\n    def = virNWFilterBindingObjGetDef(obj);\n    if (virNWFilterBindingDeleteEnsureACL(binding->conn, def) < 0)\n        goto cleanup;\n\n    virNWFilterTeardownFilter(def);\n    virNWFilterBindingObjDelete(obj, driver->bindingDir);\n    virNWFilterBindingObjListRemove(driver->bindings, obj);\n\n    ret = 0;\n\n cleanup:\n    virNWFilterBindingObjEndAPI(&obj);\n    return ret;\n}",
    "includes": [
      "#include \"nwfilter_learnipaddr.h\"",
      "#include \"nwfilter_dhcpsnoop.h\"",
      "#include \"nwfilter_ipaddrmap.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"nwfilter_gentech_driver.h\"",
      "#include \"nwfilter_driver.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_conf.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include \"internal.h\"",
      "#include \"virlog.h\"",
      "#include \"virdbus.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virNWFilterDriverStatePtr driver;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNWFilterBindingObjEndAPI",
          "args": [
            "&obj"
          ],
          "line": 835
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterBindingObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterbindingobj.c",
          "lines": "125-134",
          "snippet": "void\nvirNWFilterBindingObjEndAPI(virNWFilterBindingObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virnwfilterbindingobj.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virNWFilterBindingObjDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnwfilterbindingobj.h\"\n#include \"nwfilter_params.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <unistd.h>\n#include <config.h>\n\nstatic void virNWFilterBindingObjDispose(void *obj);\n\nvoid\nvirNWFilterBindingObjEndAPI(virNWFilterBindingObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterBindingObjListRemove",
          "args": [
            "driver->bindings",
            "obj"
          ],
          "line": 830
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterBindingObjListRemove",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterbindingobjlist.c",
          "lines": "248-260",
          "snippet": "void\nvirNWFilterBindingObjListRemove(virNWFilterBindingObjListPtr bindings,\n                                virNWFilterBindingObjPtr binding)\n{\n    virNWFilterBindingObjSetRemoving(binding, true);\n    virObjectRef(binding);\n    virObjectUnlock(binding);\n    virObjectRWLockWrite(bindings);\n    virObjectLock(binding);\n    virNWFilterBindingObjListRemoveLocked(bindings, binding);\n    virObjectUnref(binding);\n    virObjectRWUnlock(bindings);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnwfilterbindingobjlist.h\"",
            "#include \"datatypes.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virnwfilterbindingobjlist.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvoid\nvirNWFilterBindingObjListRemove(virNWFilterBindingObjListPtr bindings,\n                                virNWFilterBindingObjPtr binding)\n{\n    virNWFilterBindingObjSetRemoving(binding, true);\n    virObjectRef(binding);\n    virObjectUnlock(binding);\n    virObjectRWLockWrite(bindings);\n    virObjectLock(binding);\n    virNWFilterBindingObjListRemoveLocked(bindings, binding);\n    virObjectUnref(binding);\n    virObjectRWUnlock(bindings);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterBindingObjDelete",
          "args": [
            "obj",
            "driver->bindingDir"
          ],
          "line": 829
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterBindingObjDelete",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterbindingobj.c",
          "lines": "181-205",
          "snippet": "int\nvirNWFilterBindingObjDelete(const virNWFilterBindingObj *obj,\n                            const char *statusDir)\n{\n    char *filename;\n    int ret = -1;\n\n    if (!(filename = virNWFilterBindingObjConfigFile(statusDir,\n                                                     obj->def->portdevname)))\n        return -1;\n\n    if (unlink(filename) < 0 &&\n        errno != ENOENT) {\n        virReportSystemError(errno,\n                             _(\"Unable to remove status '%s' for nwfilter binding %s'\"),\n                             filename, obj->def->portdevname);\n        goto cleanup;\n    }\n\n    ret = 0;\n\n cleanup:\n    VIR_FREE(filename);\n    return ret;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virnwfilterbindingobj.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virNWFilterBindingObjDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnwfilterbindingobj.h\"\n#include \"nwfilter_params.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <unistd.h>\n#include <config.h>\n\nstatic void virNWFilterBindingObjDispose(void *obj);\n\nint\nvirNWFilterBindingObjDelete(const virNWFilterBindingObj *obj,\n                            const char *statusDir)\n{\n    char *filename;\n    int ret = -1;\n\n    if (!(filename = virNWFilterBindingObjConfigFile(statusDir,\n                                                     obj->def->portdevname)))\n        return -1;\n\n    if (unlink(filename) < 0 &&\n        errno != ENOENT) {\n        virReportSystemError(errno,\n                             _(\"Unable to remove status '%s' for nwfilter binding %s'\"),\n                             filename, obj->def->portdevname);\n        goto cleanup;\n    }\n\n    ret = 0;\n\n cleanup:\n    VIR_FREE(filename);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterTeardownFilter",
          "args": [
            "def"
          ],
          "line": 828
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterTeardownFilter",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_gentech_driver.c",
          "lines": "930-938",
          "snippet": "int\nvirNWFilterTeardownFilter(virNWFilterBindingDefPtr binding)\n{\n    int ret;\n    virMutexLock(&updateMutex);\n    ret = _virNWFilterTeardownFilter(binding->portdevname);\n    virMutexUnlock(&updateMutex);\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"datatypes.h\"",
            "#include \"virnetdev.h\"",
            "#include \"nwfilter_learnipaddr.h\"",
            "#include \"nwfilter_ipaddrmap.h\"",
            "#include \"nwfilter_dhcpsnoop.h\"",
            "#include \"nwfilter_ebiptables_driver.h\"",
            "#include \"nwfilter_gentech_driver.h\"",
            "#include \"virerror.h\"",
            "#include \"domain_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virMutex updateMutex;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virsocketaddr.h\"\n#include \"datatypes.h\"\n#include \"virnetdev.h\"\n#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ebiptables_driver.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"virerror.h\"\n#include \"domain_conf.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic virMutex updateMutex;\n\nint\nvirNWFilterTeardownFilter(virNWFilterBindingDefPtr binding)\n{\n    int ret;\n    virMutexLock(&updateMutex);\n    ret = _virNWFilterTeardownFilter(binding->portdevname);\n    virMutexUnlock(&updateMutex);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterBindingDeleteEnsureACL",
          "args": [
            "binding->conn",
            "def"
          ],
          "line": 825
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNWFilterBindingObjGetDef",
          "args": [
            "obj"
          ],
          "line": 824
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterBindingObjGetDef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterbindingobj.c",
          "lines": "76-80",
          "snippet": "virNWFilterBindingDefPtr\nvirNWFilterBindingObjGetDef(virNWFilterBindingObjPtr obj)\n{\n    return obj->def;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virnwfilterbindingobj.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virNWFilterBindingObjDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnwfilterbindingobj.h\"\n#include \"nwfilter_params.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <unistd.h>\n#include <config.h>\n\nstatic void virNWFilterBindingObjDispose(void *obj);\n\nvirNWFilterBindingDefPtr\nvirNWFilterBindingObjGetDef(virNWFilterBindingObjPtr obj)\n{\n    return obj->def;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_NO_NWFILTER_BINDING",
            "_(\"no nwfilter binding for port dev '%s'\")",
            "binding->portdev"
          ],
          "line": 819
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"no nwfilter binding for port dev '%s'\""
          ],
          "line": 820
        },
        "resolved": true,
        "details": {
          "function_name": "_virNWFilterTeardownFilter",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_gentech_driver.c",
          "lines": "898-927",
          "snippet": "static int\n_virNWFilterTeardownFilter(const char *ifname)\n{\n    const char *drvname = EBIPTABLES_DRIVER_ID;\n    virNWFilterTechDriverPtr techdriver;\n    techdriver = virNWFilterTechDriverForName(drvname);\n\n    if (!techdriver) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Could not get access to ACL tech \"\n                         \"driver '%s'\"),\n                       drvname);\n        return -1;\n    }\n\n    virNWFilterDHCPSnoopEnd(ifname);\n\n    virNWFilterTerminateLearnReq(ifname);\n\n    if (virNWFilterLockIface(ifname) < 0)\n        return -1;\n\n    techdriver->allTeardown(ifname);\n\n    virNWFilterIPAddrMapDelIPAddr(ifname, NULL);\n\n    virNWFilterUnlockIface(ifname);\n\n    return 0;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"datatypes.h\"",
            "#include \"virnetdev.h\"",
            "#include \"nwfilter_learnipaddr.h\"",
            "#include \"nwfilter_ipaddrmap.h\"",
            "#include \"nwfilter_dhcpsnoop.h\"",
            "#include \"nwfilter_ebiptables_driver.h\"",
            "#include \"nwfilter_gentech_driver.h\"",
            "#include \"virerror.h\"",
            "#include \"domain_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int _virNWFilterTeardownFilter(const char *ifname);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virsocketaddr.h\"\n#include \"datatypes.h\"\n#include \"virnetdev.h\"\n#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ebiptables_driver.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"virerror.h\"\n#include \"domain_conf.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int _virNWFilterTeardownFilter(const char *ifname);\n\nstatic int\n_virNWFilterTeardownFilter(const char *ifname)\n{\n    const char *drvname = EBIPTABLES_DRIVER_ID;\n    virNWFilterTechDriverPtr techdriver;\n    techdriver = virNWFilterTechDriverForName(drvname);\n\n    if (!techdriver) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Could not get access to ACL tech \"\n                         \"driver '%s'\"),\n                       drvname);\n        return -1;\n    }\n\n    virNWFilterDHCPSnoopEnd(ifname);\n\n    virNWFilterTerminateLearnReq(ifname);\n\n    if (virNWFilterLockIface(ifname) < 0)\n        return -1;\n\n    techdriver->allTeardown(ifname);\n\n    virNWFilterIPAddrMapDelIPAddr(ifname, NULL);\n\n    virNWFilterUnlockIface(ifname);\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterBindingObjListFindByPortDev",
          "args": [
            "driver->bindings",
            "binding->portdev"
          ],
          "line": 817
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterBindingObjListFindByPortDev",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterbindingobjlist.c",
          "lines": "110-127",
          "snippet": "virNWFilterBindingObjPtr\nvirNWFilterBindingObjListFindByPortDev(virNWFilterBindingObjListPtr bindings,\n                                       const char *name)\n{\n    virNWFilterBindingObjPtr obj;\n\n    virObjectRWLockRead(bindings);\n    obj = virNWFilterBindingObjListFindByPortDevLocked(bindings, name);\n    virObjectRWUnlock(bindings);\n\n    if (obj && virNWFilterBindingObjGetRemoving(obj)) {\n        virObjectUnlock(obj);\n        virObjectUnref(obj);\n        obj = NULL;\n    }\n\n    return obj;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnwfilterbindingobjlist.h\"",
            "#include \"datatypes.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virNWFilterBindingObjListDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virnwfilterbindingobjlist.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virNWFilterBindingObjListDispose(void *obj);\n\nvirNWFilterBindingObjPtr\nvirNWFilterBindingObjListFindByPortDev(virNWFilterBindingObjListPtr bindings,\n                                       const char *name)\n{\n    virNWFilterBindingObjPtr obj;\n\n    virObjectRWLockRead(bindings);\n    obj = virNWFilterBindingObjListFindByPortDevLocked(bindings, name);\n    virObjectRWUnlock(bindings);\n\n    if (obj && virNWFilterBindingObjGetRemoving(obj)) {\n        virObjectUnlock(obj);\n        virObjectUnref(obj);\n        obj = NULL;\n    }\n\n    return obj;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"nwfilter_driver.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_conf.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"virlog.h\"\n#include \"virdbus.h\"\n#include <config.h>\n\nstatic virNWFilterDriverStatePtr driver;\n\nstatic int\nnwfilterBindingDelete(virNWFilterBindingPtr binding)\n{\n    virNWFilterBindingObjPtr obj;\n    virNWFilterBindingDefPtr def;\n    int ret = -1;\n\n    obj = virNWFilterBindingObjListFindByPortDev(driver->bindings, binding->portdev);\n    if (!obj) {\n        virReportError(VIR_ERR_NO_NWFILTER_BINDING,\n                       _(\"no nwfilter binding for port dev '%s'\"), binding->portdev);\n        return -1;\n    }\n\n    def = virNWFilterBindingObjGetDef(obj);\n    if (virNWFilterBindingDeleteEnsureACL(binding->conn, def) < 0)\n        goto cleanup;\n\n    virNWFilterTeardownFilter(def);\n    virNWFilterBindingObjDelete(obj, driver->bindingDir);\n    virNWFilterBindingObjListRemove(driver->bindings, obj);\n\n    ret = 0;\n\n cleanup:\n    virNWFilterBindingObjEndAPI(&obj);\n    return ret;\n}"
  },
  {
    "function_name": "nwfilterBindingCreateXML",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_driver.c",
    "lines": "754-800",
    "snippet": "static virNWFilterBindingPtr\nnwfilterBindingCreateXML(virConnectPtr conn,\n                         const char *xml,\n                         unsigned int flags)\n{\n    virNWFilterBindingDefPtr def;\n    virNWFilterBindingObjPtr obj = NULL;\n    virNWFilterBindingPtr ret = NULL;\n\n    virCheckFlags(0, NULL);\n\n    if (!driver->privileged) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"Can't define NWFilter bindings in session mode\"));\n        return NULL;\n    }\n\n    def = virNWFilterBindingDefParseString(xml);\n    if (!def)\n        return NULL;\n\n    if (virNWFilterBindingCreateXMLEnsureACL(conn, def) < 0)\n        goto cleanup;\n\n    obj = virNWFilterBindingObjListAdd(driver->bindings,\n                                       def);\n    if (!obj)\n        goto cleanup;\n\n    if (!(ret = virGetNWFilterBinding(conn, def->portdevname, def->filter)))\n        goto cleanup;\n\n    if (virNWFilterInstantiateFilter(driver, def) < 0) {\n        virNWFilterBindingObjListRemove(driver->bindings, obj);\n        virObjectUnref(ret);\n        ret = NULL;\n        goto cleanup;\n    }\n    virNWFilterBindingObjSave(obj, driver->bindingDir);\n\n cleanup:\n    if (!obj)\n        virNWFilterBindingDefFree(def);\n    virNWFilterBindingObjEndAPI(&obj);\n\n    return ret;\n}",
    "includes": [
      "#include \"nwfilter_learnipaddr.h\"",
      "#include \"nwfilter_dhcpsnoop.h\"",
      "#include \"nwfilter_ipaddrmap.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"nwfilter_gentech_driver.h\"",
      "#include \"nwfilter_driver.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_conf.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include \"internal.h\"",
      "#include \"virlog.h\"",
      "#include \"virdbus.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virNWFilterDriverStatePtr driver;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNWFilterBindingObjEndAPI",
          "args": [
            "&obj"
          ],
          "line": 797
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterBindingObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterbindingobj.c",
          "lines": "125-134",
          "snippet": "void\nvirNWFilterBindingObjEndAPI(virNWFilterBindingObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virnwfilterbindingobj.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virNWFilterBindingObjDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnwfilterbindingobj.h\"\n#include \"nwfilter_params.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <unistd.h>\n#include <config.h>\n\nstatic void virNWFilterBindingObjDispose(void *obj);\n\nvoid\nvirNWFilterBindingObjEndAPI(virNWFilterBindingObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterBindingDefFree",
          "args": [
            "def"
          ],
          "line": 796
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterBindingDefFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterbindingdef.c",
          "lines": "33-46",
          "snippet": "void\nvirNWFilterBindingDefFree(virNWFilterBindingDefPtr def)\n{\n    if (!def)\n        return;\n\n    VIR_FREE(def->ownername);\n    VIR_FREE(def->portdevname);\n    VIR_FREE(def->linkdevname);\n    VIR_FREE(def->filter);\n    virHashFree(def->filterparams);\n\n    VIR_FREE(def);\n}",
          "includes": [
            "#include \"viruuid.h\"",
            "#include \"virnwfilterbindingdef.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viruuid.h\"\n#include \"virnwfilterbindingdef.h\"\n#include \"nwfilter_params.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <config.h>\n\nvoid\nvirNWFilterBindingDefFree(virNWFilterBindingDefPtr def)\n{\n    if (!def)\n        return;\n\n    VIR_FREE(def->ownername);\n    VIR_FREE(def->portdevname);\n    VIR_FREE(def->linkdevname);\n    VIR_FREE(def->filter);\n    virHashFree(def->filterparams);\n\n    VIR_FREE(def);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterBindingObjSave",
          "args": [
            "obj",
            "driver->bindingDir"
          ],
          "line": 792
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterBindingObjSave",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterbindingobj.c",
          "lines": "148-178",
          "snippet": "int\nvirNWFilterBindingObjSave(const virNWFilterBindingObj *obj,\n                          const char *statusDir)\n{\n    char *filename;\n    char *xml = NULL;\n    int ret = -1;\n\n    if (!(filename = virNWFilterBindingObjConfigFile(statusDir,\n                                                     obj->def->portdevname)))\n        return -1;\n\n    if (!(xml = virNWFilterBindingObjFormat(obj)))\n        goto cleanup;\n\n    if (virFileMakePath(statusDir) < 0) {\n        virReportSystemError(errno,\n                             _(\"cannot create config directory '%s'\"),\n                             statusDir);\n        goto cleanup;\n    }\n\n    ret = virXMLSaveFile(filename,\n                         obj->def->portdevname, \"nwfilter-binding-create\",\n                         xml);\n\n cleanup:\n    VIR_FREE(xml);\n    VIR_FREE(filename);\n    return ret;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virnwfilterbindingobj.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virNWFilterBindingObjDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnwfilterbindingobj.h\"\n#include \"nwfilter_params.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <unistd.h>\n#include <config.h>\n\nstatic void virNWFilterBindingObjDispose(void *obj);\n\nint\nvirNWFilterBindingObjSave(const virNWFilterBindingObj *obj,\n                          const char *statusDir)\n{\n    char *filename;\n    char *xml = NULL;\n    int ret = -1;\n\n    if (!(filename = virNWFilterBindingObjConfigFile(statusDir,\n                                                     obj->def->portdevname)))\n        return -1;\n\n    if (!(xml = virNWFilterBindingObjFormat(obj)))\n        goto cleanup;\n\n    if (virFileMakePath(statusDir) < 0) {\n        virReportSystemError(errno,\n                             _(\"cannot create config directory '%s'\"),\n                             statusDir);\n        goto cleanup;\n    }\n\n    ret = virXMLSaveFile(filename,\n                         obj->def->portdevname, \"nwfilter-binding-create\",\n                         xml);\n\n cleanup:\n    VIR_FREE(xml);\n    VIR_FREE(filename);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "ret"
          ],
          "line": 788
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterBindingObjListRemove",
          "args": [
            "driver->bindings",
            "obj"
          ],
          "line": 787
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterBindingObjListRemove",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterbindingobjlist.c",
          "lines": "248-260",
          "snippet": "void\nvirNWFilterBindingObjListRemove(virNWFilterBindingObjListPtr bindings,\n                                virNWFilterBindingObjPtr binding)\n{\n    virNWFilterBindingObjSetRemoving(binding, true);\n    virObjectRef(binding);\n    virObjectUnlock(binding);\n    virObjectRWLockWrite(bindings);\n    virObjectLock(binding);\n    virNWFilterBindingObjListRemoveLocked(bindings, binding);\n    virObjectUnref(binding);\n    virObjectRWUnlock(bindings);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnwfilterbindingobjlist.h\"",
            "#include \"datatypes.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virnwfilterbindingobjlist.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvoid\nvirNWFilterBindingObjListRemove(virNWFilterBindingObjListPtr bindings,\n                                virNWFilterBindingObjPtr binding)\n{\n    virNWFilterBindingObjSetRemoving(binding, true);\n    virObjectRef(binding);\n    virObjectUnlock(binding);\n    virObjectRWLockWrite(bindings);\n    virObjectLock(binding);\n    virNWFilterBindingObjListRemoveLocked(bindings, binding);\n    virObjectUnref(binding);\n    virObjectRWUnlock(bindings);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterInstantiateFilter",
          "args": [
            "driver",
            "def"
          ],
          "line": 786
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterInstantiateFilter",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_gentech_driver.c",
          "lines": "817-827",
          "snippet": "int\nvirNWFilterInstantiateFilter(virNWFilterDriverStatePtr driver,\n                             virNWFilterBindingDefPtr binding)\n{\n    bool foundNewFilter = false;\n\n    return virNWFilterInstantiateFilterInternal(driver, binding,\n                                                1,\n                                                INSTANTIATE_ALWAYS,\n                                                &foundNewFilter);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"datatypes.h\"",
            "#include \"virnetdev.h\"",
            "#include \"nwfilter_learnipaddr.h\"",
            "#include \"nwfilter_ipaddrmap.h\"",
            "#include \"nwfilter_dhcpsnoop.h\"",
            "#include \"nwfilter_ebiptables_driver.h\"",
            "#include \"nwfilter_gentech_driver.h\"",
            "#include \"virerror.h\"",
            "#include \"domain_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virsocketaddr.h\"\n#include \"datatypes.h\"\n#include \"virnetdev.h\"\n#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ebiptables_driver.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"virerror.h\"\n#include \"domain_conf.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirNWFilterInstantiateFilter(virNWFilterDriverStatePtr driver,\n                             virNWFilterBindingDefPtr binding)\n{\n    bool foundNewFilter = false;\n\n    return virNWFilterInstantiateFilterInternal(driver, binding,\n                                                1,\n                                                INSTANTIATE_ALWAYS,\n                                                &foundNewFilter);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virGetNWFilterBinding",
          "args": [
            "conn",
            "def->portdevname",
            "def->filter"
          ],
          "line": 783
        },
        "resolved": true,
        "details": {
          "function_name": "virGetNWFilterBinding",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/datatypes.c",
          "lines": "904-930",
          "snippet": "virNWFilterBindingPtr\nvirGetNWFilterBinding(virConnectPtr conn, const char *portdev,\n                      const char *filtername)\n{\n    virNWFilterBindingPtr ret = NULL;\n\n    if (virDataTypesInitialize() < 0)\n        return NULL;\n\n    virCheckConnectGoto(conn, error);\n    virCheckNonNullArgGoto(portdev, error);\n\n    if (!(ret = virObjectNew(virNWFilterBindingClass)))\n        goto error;\n\n    ret->portdev = g_strdup(portdev);\n\n    ret->filtername = g_strdup(filtername);\n\n    ret->conn = virObjectRef(conn);\n\n    return ret;\n\n error:\n    virObjectUnref(ret);\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viruuid.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virClassPtr virNWFilterBindingClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viruuid.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <unistd.h>\n#include <config.h>\n\nvirClassPtr virNWFilterBindingClass;\n\nvirNWFilterBindingPtr\nvirGetNWFilterBinding(virConnectPtr conn, const char *portdev,\n                      const char *filtername)\n{\n    virNWFilterBindingPtr ret = NULL;\n\n    if (virDataTypesInitialize() < 0)\n        return NULL;\n\n    virCheckConnectGoto(conn, error);\n    virCheckNonNullArgGoto(portdev, error);\n\n    if (!(ret = virObjectNew(virNWFilterBindingClass)))\n        goto error;\n\n    ret->portdev = g_strdup(portdev);\n\n    ret->filtername = g_strdup(filtername);\n\n    ret->conn = virObjectRef(conn);\n\n    return ret;\n\n error:\n    virObjectUnref(ret);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterBindingObjListAdd",
          "args": [
            "driver->bindings",
            "def"
          ],
          "line": 778
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterBindingObjListAdd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterbindingobjlist.c",
          "lines": "207-217",
          "snippet": "virNWFilterBindingObjPtr\nvirNWFilterBindingObjListAdd(virNWFilterBindingObjListPtr bindings,\n                             virNWFilterBindingDefPtr def)\n{\n    virNWFilterBindingObjPtr ret;\n\n    virObjectRWLockWrite(bindings);\n    ret = virNWFilterBindingObjListAddLocked(bindings, def);\n    virObjectRWUnlock(bindings);\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnwfilterbindingobjlist.h\"",
            "#include \"datatypes.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virnwfilterbindingobjlist.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nvirNWFilterBindingObjPtr\nvirNWFilterBindingObjListAdd(virNWFilterBindingObjListPtr bindings,\n                             virNWFilterBindingDefPtr def)\n{\n    virNWFilterBindingObjPtr ret;\n\n    virObjectRWLockWrite(bindings);\n    ret = virNWFilterBindingObjListAddLocked(bindings, def);\n    virObjectRWUnlock(bindings);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterBindingCreateXMLEnsureACL",
          "args": [
            "conn",
            "def"
          ],
          "line": 775
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNWFilterBindingDefParseString",
          "args": [
            "xml"
          ],
          "line": 771
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterBindingDefParseString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterbindingdef.c",
          "lines": "209-213",
          "snippet": "virNWFilterBindingDefPtr\nvirNWFilterBindingDefParseString(const char *xmlStr)\n{\n    return virNWFilterBindingDefParse(xmlStr, NULL);\n}",
          "includes": [
            "#include \"viruuid.h\"",
            "#include \"virnwfilterbindingdef.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viruuid.h\"\n#include \"virnwfilterbindingdef.h\"\n#include \"nwfilter_params.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <config.h>\n\nvirNWFilterBindingDefPtr\nvirNWFilterBindingDefParseString(const char *xmlStr)\n{\n    return virNWFilterBindingDefParse(xmlStr, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_INVALID",
            "\"%s\"",
            "_(\"Can't define NWFilter bindings in session mode\")"
          ],
          "line": 766
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Can't define NWFilter bindings in session mode\""
          ],
          "line": 767
        },
        "resolved": true,
        "details": {
          "function_name": "_virNWFilterTeardownFilter",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_gentech_driver.c",
          "lines": "898-927",
          "snippet": "static int\n_virNWFilterTeardownFilter(const char *ifname)\n{\n    const char *drvname = EBIPTABLES_DRIVER_ID;\n    virNWFilterTechDriverPtr techdriver;\n    techdriver = virNWFilterTechDriverForName(drvname);\n\n    if (!techdriver) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Could not get access to ACL tech \"\n                         \"driver '%s'\"),\n                       drvname);\n        return -1;\n    }\n\n    virNWFilterDHCPSnoopEnd(ifname);\n\n    virNWFilterTerminateLearnReq(ifname);\n\n    if (virNWFilterLockIface(ifname) < 0)\n        return -1;\n\n    techdriver->allTeardown(ifname);\n\n    virNWFilterIPAddrMapDelIPAddr(ifname, NULL);\n\n    virNWFilterUnlockIface(ifname);\n\n    return 0;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"datatypes.h\"",
            "#include \"virnetdev.h\"",
            "#include \"nwfilter_learnipaddr.h\"",
            "#include \"nwfilter_ipaddrmap.h\"",
            "#include \"nwfilter_dhcpsnoop.h\"",
            "#include \"nwfilter_ebiptables_driver.h\"",
            "#include \"nwfilter_gentech_driver.h\"",
            "#include \"virerror.h\"",
            "#include \"domain_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int _virNWFilterTeardownFilter(const char *ifname);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virsocketaddr.h\"\n#include \"datatypes.h\"\n#include \"virnetdev.h\"\n#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ebiptables_driver.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"virerror.h\"\n#include \"domain_conf.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int _virNWFilterTeardownFilter(const char *ifname);\n\nstatic int\n_virNWFilterTeardownFilter(const char *ifname)\n{\n    const char *drvname = EBIPTABLES_DRIVER_ID;\n    virNWFilterTechDriverPtr techdriver;\n    techdriver = virNWFilterTechDriverForName(drvname);\n\n    if (!techdriver) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Could not get access to ACL tech \"\n                         \"driver '%s'\"),\n                       drvname);\n        return -1;\n    }\n\n    virNWFilterDHCPSnoopEnd(ifname);\n\n    virNWFilterTerminateLearnReq(ifname);\n\n    if (virNWFilterLockIface(ifname) < 0)\n        return -1;\n\n    techdriver->allTeardown(ifname);\n\n    virNWFilterIPAddrMapDelIPAddr(ifname, NULL);\n\n    virNWFilterUnlockIface(ifname);\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "0",
            "NULL"
          ],
          "line": 763
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"nwfilter_driver.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_conf.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"virlog.h\"\n#include \"virdbus.h\"\n#include <config.h>\n\nstatic virNWFilterDriverStatePtr driver;\n\nstatic virNWFilterBindingPtr\nnwfilterBindingCreateXML(virConnectPtr conn,\n                         const char *xml,\n                         unsigned int flags)\n{\n    virNWFilterBindingDefPtr def;\n    virNWFilterBindingObjPtr obj = NULL;\n    virNWFilterBindingPtr ret = NULL;\n\n    virCheckFlags(0, NULL);\n\n    if (!driver->privileged) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"Can't define NWFilter bindings in session mode\"));\n        return NULL;\n    }\n\n    def = virNWFilterBindingDefParseString(xml);\n    if (!def)\n        return NULL;\n\n    if (virNWFilterBindingCreateXMLEnsureACL(conn, def) < 0)\n        goto cleanup;\n\n    obj = virNWFilterBindingObjListAdd(driver->bindings,\n                                       def);\n    if (!obj)\n        goto cleanup;\n\n    if (!(ret = virGetNWFilterBinding(conn, def->portdevname, def->filter)))\n        goto cleanup;\n\n    if (virNWFilterInstantiateFilter(driver, def) < 0) {\n        virNWFilterBindingObjListRemove(driver->bindings, obj);\n        virObjectUnref(ret);\n        ret = NULL;\n        goto cleanup;\n    }\n    virNWFilterBindingObjSave(obj, driver->bindingDir);\n\n cleanup:\n    if (!obj)\n        virNWFilterBindingDefFree(def);\n    virNWFilterBindingObjEndAPI(&obj);\n\n    return ret;\n}"
  },
  {
    "function_name": "nwfilterBindingGetXMLDesc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_driver.c",
    "lines": "724-751",
    "snippet": "static char *\nnwfilterBindingGetXMLDesc(virNWFilterBindingPtr binding,\n                          unsigned int flags)\n{\n    virNWFilterBindingObjPtr obj;\n    virNWFilterBindingDefPtr def;\n    char *ret = NULL;\n\n    virCheckFlags(0, NULL);\n\n    obj = virNWFilterBindingObjListFindByPortDev(driver->bindings,\n                                                 binding->portdev);\n    if (!obj) {\n        virReportError(VIR_ERR_NO_NWFILTER_BINDING,\n                       _(\"no nwfilter binding for port dev '%s'\"), binding->portdev);\n        goto cleanup;\n    }\n\n    def = virNWFilterBindingObjGetDef(obj);\n    if (virNWFilterBindingGetXMLDescEnsureACL(binding->conn, def) < 0)\n        goto cleanup;\n\n    ret = virNWFilterBindingDefFormat(def);\n\n cleanup:\n    virNWFilterBindingObjEndAPI(&obj);\n    return ret;\n}",
    "includes": [
      "#include \"nwfilter_learnipaddr.h\"",
      "#include \"nwfilter_dhcpsnoop.h\"",
      "#include \"nwfilter_ipaddrmap.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"nwfilter_gentech_driver.h\"",
      "#include \"nwfilter_driver.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_conf.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include \"internal.h\"",
      "#include \"virlog.h\"",
      "#include \"virdbus.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virNWFilterDriverStatePtr driver;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNWFilterBindingObjEndAPI",
          "args": [
            "&obj"
          ],
          "line": 749
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterBindingObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterbindingobj.c",
          "lines": "125-134",
          "snippet": "void\nvirNWFilterBindingObjEndAPI(virNWFilterBindingObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virnwfilterbindingobj.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virNWFilterBindingObjDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnwfilterbindingobj.h\"\n#include \"nwfilter_params.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <unistd.h>\n#include <config.h>\n\nstatic void virNWFilterBindingObjDispose(void *obj);\n\nvoid\nvirNWFilterBindingObjEndAPI(virNWFilterBindingObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterBindingDefFormat",
          "args": [
            "def"
          ],
          "line": 746
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterBindingDefFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterbindingdef.c",
          "lines": "223-234",
          "snippet": "char *\nvirNWFilterBindingDefFormat(const virNWFilterBindingDef *def)\n{\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n\n    if (virNWFilterBindingDefFormatBuf(&buf, def) < 0) {\n        virBufferFreeAndReset(&buf);\n        return NULL;\n    }\n\n    return virBufferContentAndReset(&buf);\n}",
          "includes": [
            "#include \"viruuid.h\"",
            "#include \"virnwfilterbindingdef.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viruuid.h\"\n#include \"virnwfilterbindingdef.h\"\n#include \"nwfilter_params.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <config.h>\n\nchar *\nvirNWFilterBindingDefFormat(const virNWFilterBindingDef *def)\n{\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n\n    if (virNWFilterBindingDefFormatBuf(&buf, def) < 0) {\n        virBufferFreeAndReset(&buf);\n        return NULL;\n    }\n\n    return virBufferContentAndReset(&buf);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterBindingGetXMLDescEnsureACL",
          "args": [
            "binding->conn",
            "def"
          ],
          "line": 743
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNWFilterBindingObjGetDef",
          "args": [
            "obj"
          ],
          "line": 742
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterBindingObjGetDef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterbindingobj.c",
          "lines": "76-80",
          "snippet": "virNWFilterBindingDefPtr\nvirNWFilterBindingObjGetDef(virNWFilterBindingObjPtr obj)\n{\n    return obj->def;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virnwfilterbindingobj.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virNWFilterBindingObjDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnwfilterbindingobj.h\"\n#include \"nwfilter_params.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <unistd.h>\n#include <config.h>\n\nstatic void virNWFilterBindingObjDispose(void *obj);\n\nvirNWFilterBindingDefPtr\nvirNWFilterBindingObjGetDef(virNWFilterBindingObjPtr obj)\n{\n    return obj->def;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_NO_NWFILTER_BINDING",
            "_(\"no nwfilter binding for port dev '%s'\")",
            "binding->portdev"
          ],
          "line": 737
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"no nwfilter binding for port dev '%s'\""
          ],
          "line": 738
        },
        "resolved": true,
        "details": {
          "function_name": "_virNWFilterTeardownFilter",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_gentech_driver.c",
          "lines": "898-927",
          "snippet": "static int\n_virNWFilterTeardownFilter(const char *ifname)\n{\n    const char *drvname = EBIPTABLES_DRIVER_ID;\n    virNWFilterTechDriverPtr techdriver;\n    techdriver = virNWFilterTechDriverForName(drvname);\n\n    if (!techdriver) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Could not get access to ACL tech \"\n                         \"driver '%s'\"),\n                       drvname);\n        return -1;\n    }\n\n    virNWFilterDHCPSnoopEnd(ifname);\n\n    virNWFilterTerminateLearnReq(ifname);\n\n    if (virNWFilterLockIface(ifname) < 0)\n        return -1;\n\n    techdriver->allTeardown(ifname);\n\n    virNWFilterIPAddrMapDelIPAddr(ifname, NULL);\n\n    virNWFilterUnlockIface(ifname);\n\n    return 0;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"datatypes.h\"",
            "#include \"virnetdev.h\"",
            "#include \"nwfilter_learnipaddr.h\"",
            "#include \"nwfilter_ipaddrmap.h\"",
            "#include \"nwfilter_dhcpsnoop.h\"",
            "#include \"nwfilter_ebiptables_driver.h\"",
            "#include \"nwfilter_gentech_driver.h\"",
            "#include \"virerror.h\"",
            "#include \"domain_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int _virNWFilterTeardownFilter(const char *ifname);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virsocketaddr.h\"\n#include \"datatypes.h\"\n#include \"virnetdev.h\"\n#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ebiptables_driver.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"virerror.h\"\n#include \"domain_conf.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int _virNWFilterTeardownFilter(const char *ifname);\n\nstatic int\n_virNWFilterTeardownFilter(const char *ifname)\n{\n    const char *drvname = EBIPTABLES_DRIVER_ID;\n    virNWFilterTechDriverPtr techdriver;\n    techdriver = virNWFilterTechDriverForName(drvname);\n\n    if (!techdriver) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Could not get access to ACL tech \"\n                         \"driver '%s'\"),\n                       drvname);\n        return -1;\n    }\n\n    virNWFilterDHCPSnoopEnd(ifname);\n\n    virNWFilterTerminateLearnReq(ifname);\n\n    if (virNWFilterLockIface(ifname) < 0)\n        return -1;\n\n    techdriver->allTeardown(ifname);\n\n    virNWFilterIPAddrMapDelIPAddr(ifname, NULL);\n\n    virNWFilterUnlockIface(ifname);\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterBindingObjListFindByPortDev",
          "args": [
            "driver->bindings",
            "binding->portdev"
          ],
          "line": 734
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterBindingObjListFindByPortDev",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterbindingobjlist.c",
          "lines": "110-127",
          "snippet": "virNWFilterBindingObjPtr\nvirNWFilterBindingObjListFindByPortDev(virNWFilterBindingObjListPtr bindings,\n                                       const char *name)\n{\n    virNWFilterBindingObjPtr obj;\n\n    virObjectRWLockRead(bindings);\n    obj = virNWFilterBindingObjListFindByPortDevLocked(bindings, name);\n    virObjectRWUnlock(bindings);\n\n    if (obj && virNWFilterBindingObjGetRemoving(obj)) {\n        virObjectUnlock(obj);\n        virObjectUnref(obj);\n        obj = NULL;\n    }\n\n    return obj;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnwfilterbindingobjlist.h\"",
            "#include \"datatypes.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virNWFilterBindingObjListDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virnwfilterbindingobjlist.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virNWFilterBindingObjListDispose(void *obj);\n\nvirNWFilterBindingObjPtr\nvirNWFilterBindingObjListFindByPortDev(virNWFilterBindingObjListPtr bindings,\n                                       const char *name)\n{\n    virNWFilterBindingObjPtr obj;\n\n    virObjectRWLockRead(bindings);\n    obj = virNWFilterBindingObjListFindByPortDevLocked(bindings, name);\n    virObjectRWUnlock(bindings);\n\n    if (obj && virNWFilterBindingObjGetRemoving(obj)) {\n        virObjectUnlock(obj);\n        virObjectUnref(obj);\n        obj = NULL;\n    }\n\n    return obj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "0",
            "NULL"
          ],
          "line": 732
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"nwfilter_driver.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_conf.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"virlog.h\"\n#include \"virdbus.h\"\n#include <config.h>\n\nstatic virNWFilterDriverStatePtr driver;\n\nstatic char *\nnwfilterBindingGetXMLDesc(virNWFilterBindingPtr binding,\n                          unsigned int flags)\n{\n    virNWFilterBindingObjPtr obj;\n    virNWFilterBindingDefPtr def;\n    char *ret = NULL;\n\n    virCheckFlags(0, NULL);\n\n    obj = virNWFilterBindingObjListFindByPortDev(driver->bindings,\n                                                 binding->portdev);\n    if (!obj) {\n        virReportError(VIR_ERR_NO_NWFILTER_BINDING,\n                       _(\"no nwfilter binding for port dev '%s'\"), binding->portdev);\n        goto cleanup;\n    }\n\n    def = virNWFilterBindingObjGetDef(obj);\n    if (virNWFilterBindingGetXMLDescEnsureACL(binding->conn, def) < 0)\n        goto cleanup;\n\n    ret = virNWFilterBindingDefFormat(def);\n\n cleanup:\n    virNWFilterBindingObjEndAPI(&obj);\n    return ret;\n}"
  },
  {
    "function_name": "nwfilterConnectListAllNWFilterBindings",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_driver.c",
    "lines": "709-721",
    "snippet": "static int\nnwfilterConnectListAllNWFilterBindings(virConnectPtr conn,\n                                       virNWFilterBindingPtr **bindings,\n                                       unsigned int flags)\n{\n    virCheckFlags(0, -1);\n\n    if (virConnectListAllNWFilterBindingsEnsureACL(conn) < 0)\n        return -1;\n\n    return virNWFilterBindingObjListExport(driver->bindings, conn, bindings,\n                                           virConnectListAllNWFilterBindingsCheckACL);\n}",
    "includes": [
      "#include \"nwfilter_learnipaddr.h\"",
      "#include \"nwfilter_dhcpsnoop.h\"",
      "#include \"nwfilter_ipaddrmap.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"nwfilter_gentech_driver.h\"",
      "#include \"nwfilter_driver.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_conf.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include \"internal.h\"",
      "#include \"virlog.h\"",
      "#include \"virdbus.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virNWFilterDriverStatePtr driver;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNWFilterBindingObjListExport",
          "args": [
            "driver->bindings",
            "conn",
            "bindings",
            "virConnectListAllNWFilterBindingsCheckACL"
          ],
          "line": 719
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterBindingObjListExport",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterbindingobjlist.c",
          "lines": "454-496",
          "snippet": "int\nvirNWFilterBindingObjListExport(virNWFilterBindingObjListPtr bindings,\n                                virConnectPtr conn,\n                                virNWFilterBindingPtr **bindinglist,\n                                virNWFilterBindingObjListACLFilter filter)\n{\n    virNWFilterBindingObjPtr *bindingobjs = NULL;\n    size_t nbindings = 0;\n    size_t i;\n    int ret = -1;\n\n    if (virNWFilterBindingObjListCollect(bindings, conn, &bindingobjs,\n                                         &nbindings, filter) < 0)\n        return -1;\n\n    if (bindinglist) {\n        if (VIR_ALLOC_N(*bindinglist, nbindings + 1) < 0)\n            goto cleanup;\n\n        for (i = 0; i < nbindings; i++) {\n            virNWFilterBindingObjPtr binding = bindingobjs[i];\n            virNWFilterBindingDefPtr def = virNWFilterBindingObjGetDef(binding);\n\n            virObjectLock(binding);\n            (*bindinglist)[i] = virGetNWFilterBinding(conn, def->portdevname,\n                                                      def->filter);\n            virObjectUnlock(binding);\n\n            if (!(*bindinglist)[i])\n                goto cleanup;\n        }\n    }\n\n    ret = nbindings;\n\n cleanup:\n    virObjectListFreeCount(bindingobjs, nbindings);\n    if (ret < 0) {\n        virObjectListFreeCount(*bindinglist, nbindings);\n        *bindinglist = NULL;\n    }\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnwfilterbindingobjlist.h\"",
            "#include \"datatypes.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virnwfilterbindingobjlist.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirNWFilterBindingObjListExport(virNWFilterBindingObjListPtr bindings,\n                                virConnectPtr conn,\n                                virNWFilterBindingPtr **bindinglist,\n                                virNWFilterBindingObjListACLFilter filter)\n{\n    virNWFilterBindingObjPtr *bindingobjs = NULL;\n    size_t nbindings = 0;\n    size_t i;\n    int ret = -1;\n\n    if (virNWFilterBindingObjListCollect(bindings, conn, &bindingobjs,\n                                         &nbindings, filter) < 0)\n        return -1;\n\n    if (bindinglist) {\n        if (VIR_ALLOC_N(*bindinglist, nbindings + 1) < 0)\n            goto cleanup;\n\n        for (i = 0; i < nbindings; i++) {\n            virNWFilterBindingObjPtr binding = bindingobjs[i];\n            virNWFilterBindingDefPtr def = virNWFilterBindingObjGetDef(binding);\n\n            virObjectLock(binding);\n            (*bindinglist)[i] = virGetNWFilterBinding(conn, def->portdevname,\n                                                      def->filter);\n            virObjectUnlock(binding);\n\n            if (!(*bindinglist)[i])\n                goto cleanup;\n        }\n    }\n\n    ret = nbindings;\n\n cleanup:\n    virObjectListFreeCount(bindingobjs, nbindings);\n    if (ret < 0) {\n        virObjectListFreeCount(*bindinglist, nbindings);\n        *bindinglist = NULL;\n    }\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virConnectListAllNWFilterBindingsEnsureACL",
          "args": [
            "conn"
          ],
          "line": 716
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "0",
            "-1"
          ],
          "line": 714
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"nwfilter_driver.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_conf.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"virlog.h\"\n#include \"virdbus.h\"\n#include <config.h>\n\nstatic virNWFilterDriverStatePtr driver;\n\nstatic int\nnwfilterConnectListAllNWFilterBindings(virConnectPtr conn,\n                                       virNWFilterBindingPtr **bindings,\n                                       unsigned int flags)\n{\n    virCheckFlags(0, -1);\n\n    if (virConnectListAllNWFilterBindingsEnsureACL(conn) < 0)\n        return -1;\n\n    return virNWFilterBindingObjListExport(driver->bindings, conn, bindings,\n                                           virConnectListAllNWFilterBindingsCheckACL);\n}"
  },
  {
    "function_name": "nwfilterBindingLookupByPortDev",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_driver.c",
    "lines": "681-706",
    "snippet": "static virNWFilterBindingPtr\nnwfilterBindingLookupByPortDev(virConnectPtr conn,\n                               const char *portdev)\n{\n    virNWFilterBindingPtr ret = NULL;\n    virNWFilterBindingObjPtr obj;\n    virNWFilterBindingDefPtr def;\n\n    obj = virNWFilterBindingObjListFindByPortDev(driver->bindings,\n                                                 portdev);\n    if (!obj) {\n        virReportError(VIR_ERR_NO_NWFILTER_BINDING,\n                       _(\"no nwfilter binding for port dev '%s'\"), portdev);\n        goto cleanup;\n    }\n\n    def = virNWFilterBindingObjGetDef(obj);\n    if (virNWFilterBindingLookupByPortDevEnsureACL(conn, def) < 0)\n        goto cleanup;\n\n    ret = virGetNWFilterBinding(conn, def->portdevname, def->filter);\n\n cleanup:\n    virNWFilterBindingObjEndAPI(&obj);\n    return ret;\n}",
    "includes": [
      "#include \"nwfilter_learnipaddr.h\"",
      "#include \"nwfilter_dhcpsnoop.h\"",
      "#include \"nwfilter_ipaddrmap.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"nwfilter_gentech_driver.h\"",
      "#include \"nwfilter_driver.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_conf.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include \"internal.h\"",
      "#include \"virlog.h\"",
      "#include \"virdbus.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virNWFilterDriverStatePtr driver;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNWFilterBindingObjEndAPI",
          "args": [
            "&obj"
          ],
          "line": 704
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterBindingObjEndAPI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterbindingobj.c",
          "lines": "125-134",
          "snippet": "void\nvirNWFilterBindingObjEndAPI(virNWFilterBindingObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virnwfilterbindingobj.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virNWFilterBindingObjDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnwfilterbindingobj.h\"\n#include \"nwfilter_params.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <unistd.h>\n#include <config.h>\n\nstatic void virNWFilterBindingObjDispose(void *obj);\n\nvoid\nvirNWFilterBindingObjEndAPI(virNWFilterBindingObjPtr *obj)\n{\n    if (!*obj)\n        return;\n\n    virObjectUnlock(*obj);\n    virObjectUnref(*obj);\n    *obj = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virGetNWFilterBinding",
          "args": [
            "conn",
            "def->portdevname",
            "def->filter"
          ],
          "line": 701
        },
        "resolved": true,
        "details": {
          "function_name": "virGetNWFilterBinding",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/datatypes.c",
          "lines": "904-930",
          "snippet": "virNWFilterBindingPtr\nvirGetNWFilterBinding(virConnectPtr conn, const char *portdev,\n                      const char *filtername)\n{\n    virNWFilterBindingPtr ret = NULL;\n\n    if (virDataTypesInitialize() < 0)\n        return NULL;\n\n    virCheckConnectGoto(conn, error);\n    virCheckNonNullArgGoto(portdev, error);\n\n    if (!(ret = virObjectNew(virNWFilterBindingClass)))\n        goto error;\n\n    ret->portdev = g_strdup(portdev);\n\n    ret->filtername = g_strdup(filtername);\n\n    ret->conn = virObjectRef(conn);\n\n    return ret;\n\n error:\n    virObjectUnref(ret);\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viruuid.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virClassPtr virNWFilterBindingClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viruuid.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <unistd.h>\n#include <config.h>\n\nvirClassPtr virNWFilterBindingClass;\n\nvirNWFilterBindingPtr\nvirGetNWFilterBinding(virConnectPtr conn, const char *portdev,\n                      const char *filtername)\n{\n    virNWFilterBindingPtr ret = NULL;\n\n    if (virDataTypesInitialize() < 0)\n        return NULL;\n\n    virCheckConnectGoto(conn, error);\n    virCheckNonNullArgGoto(portdev, error);\n\n    if (!(ret = virObjectNew(virNWFilterBindingClass)))\n        goto error;\n\n    ret->portdev = g_strdup(portdev);\n\n    ret->filtername = g_strdup(filtername);\n\n    ret->conn = virObjectRef(conn);\n\n    return ret;\n\n error:\n    virObjectUnref(ret);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterBindingLookupByPortDevEnsureACL",
          "args": [
            "conn",
            "def"
          ],
          "line": 698
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNWFilterBindingObjGetDef",
          "args": [
            "obj"
          ],
          "line": 697
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterBindingObjGetDef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterbindingobj.c",
          "lines": "76-80",
          "snippet": "virNWFilterBindingDefPtr\nvirNWFilterBindingObjGetDef(virNWFilterBindingObjPtr obj)\n{\n    return obj->def;\n}",
          "includes": [
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"virnwfilterbindingobj.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virNWFilterBindingObjDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"virnwfilterbindingobj.h\"\n#include \"nwfilter_params.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <unistd.h>\n#include <config.h>\n\nstatic void virNWFilterBindingObjDispose(void *obj);\n\nvirNWFilterBindingDefPtr\nvirNWFilterBindingObjGetDef(virNWFilterBindingObjPtr obj)\n{\n    return obj->def;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_NO_NWFILTER_BINDING",
            "_(\"no nwfilter binding for port dev '%s'\")",
            "portdev"
          ],
          "line": 692
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"no nwfilter binding for port dev '%s'\""
          ],
          "line": 693
        },
        "resolved": true,
        "details": {
          "function_name": "_virNWFilterTeardownFilter",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_gentech_driver.c",
          "lines": "898-927",
          "snippet": "static int\n_virNWFilterTeardownFilter(const char *ifname)\n{\n    const char *drvname = EBIPTABLES_DRIVER_ID;\n    virNWFilterTechDriverPtr techdriver;\n    techdriver = virNWFilterTechDriverForName(drvname);\n\n    if (!techdriver) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Could not get access to ACL tech \"\n                         \"driver '%s'\"),\n                       drvname);\n        return -1;\n    }\n\n    virNWFilterDHCPSnoopEnd(ifname);\n\n    virNWFilterTerminateLearnReq(ifname);\n\n    if (virNWFilterLockIface(ifname) < 0)\n        return -1;\n\n    techdriver->allTeardown(ifname);\n\n    virNWFilterIPAddrMapDelIPAddr(ifname, NULL);\n\n    virNWFilterUnlockIface(ifname);\n\n    return 0;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"datatypes.h\"",
            "#include \"virnetdev.h\"",
            "#include \"nwfilter_learnipaddr.h\"",
            "#include \"nwfilter_ipaddrmap.h\"",
            "#include \"nwfilter_dhcpsnoop.h\"",
            "#include \"nwfilter_ebiptables_driver.h\"",
            "#include \"nwfilter_gentech_driver.h\"",
            "#include \"virerror.h\"",
            "#include \"domain_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int _virNWFilterTeardownFilter(const char *ifname);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virsocketaddr.h\"\n#include \"datatypes.h\"\n#include \"virnetdev.h\"\n#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ebiptables_driver.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"virerror.h\"\n#include \"domain_conf.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int _virNWFilterTeardownFilter(const char *ifname);\n\nstatic int\n_virNWFilterTeardownFilter(const char *ifname)\n{\n    const char *drvname = EBIPTABLES_DRIVER_ID;\n    virNWFilterTechDriverPtr techdriver;\n    techdriver = virNWFilterTechDriverForName(drvname);\n\n    if (!techdriver) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Could not get access to ACL tech \"\n                         \"driver '%s'\"),\n                       drvname);\n        return -1;\n    }\n\n    virNWFilterDHCPSnoopEnd(ifname);\n\n    virNWFilterTerminateLearnReq(ifname);\n\n    if (virNWFilterLockIface(ifname) < 0)\n        return -1;\n\n    techdriver->allTeardown(ifname);\n\n    virNWFilterIPAddrMapDelIPAddr(ifname, NULL);\n\n    virNWFilterUnlockIface(ifname);\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterBindingObjListFindByPortDev",
          "args": [
            "driver->bindings",
            "portdev"
          ],
          "line": 689
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterBindingObjListFindByPortDev",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterbindingobjlist.c",
          "lines": "110-127",
          "snippet": "virNWFilterBindingObjPtr\nvirNWFilterBindingObjListFindByPortDev(virNWFilterBindingObjListPtr bindings,\n                                       const char *name)\n{\n    virNWFilterBindingObjPtr obj;\n\n    virObjectRWLockRead(bindings);\n    obj = virNWFilterBindingObjListFindByPortDevLocked(bindings, name);\n    virObjectRWUnlock(bindings);\n\n    if (obj && virNWFilterBindingObjGetRemoving(obj)) {\n        virObjectUnlock(obj);\n        virObjectUnref(obj);\n        obj = NULL;\n    }\n\n    return obj;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnwfilterbindingobjlist.h\"",
            "#include \"datatypes.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virNWFilterBindingObjListDispose(void *obj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virnwfilterbindingobjlist.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic void virNWFilterBindingObjListDispose(void *obj);\n\nvirNWFilterBindingObjPtr\nvirNWFilterBindingObjListFindByPortDev(virNWFilterBindingObjListPtr bindings,\n                                       const char *name)\n{\n    virNWFilterBindingObjPtr obj;\n\n    virObjectRWLockRead(bindings);\n    obj = virNWFilterBindingObjListFindByPortDevLocked(bindings, name);\n    virObjectRWUnlock(bindings);\n\n    if (obj && virNWFilterBindingObjGetRemoving(obj)) {\n        virObjectUnlock(obj);\n        virObjectUnref(obj);\n        obj = NULL;\n    }\n\n    return obj;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"nwfilter_driver.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_conf.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"virlog.h\"\n#include \"virdbus.h\"\n#include <config.h>\n\nstatic virNWFilterDriverStatePtr driver;\n\nstatic virNWFilterBindingPtr\nnwfilterBindingLookupByPortDev(virConnectPtr conn,\n                               const char *portdev)\n{\n    virNWFilterBindingPtr ret = NULL;\n    virNWFilterBindingObjPtr obj;\n    virNWFilterBindingDefPtr def;\n\n    obj = virNWFilterBindingObjListFindByPortDev(driver->bindings,\n                                                 portdev);\n    if (!obj) {\n        virReportError(VIR_ERR_NO_NWFILTER_BINDING,\n                       _(\"no nwfilter binding for port dev '%s'\"), portdev);\n        goto cleanup;\n    }\n\n    def = virNWFilterBindingObjGetDef(obj);\n    if (virNWFilterBindingLookupByPortDevEnsureACL(conn, def) < 0)\n        goto cleanup;\n\n    ret = virGetNWFilterBinding(conn, def->portdevname, def->filter);\n\n cleanup:\n    virNWFilterBindingObjEndAPI(&obj);\n    return ret;\n}"
  },
  {
    "function_name": "nwfilterGetXMLDesc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_driver.c",
    "lines": "652-678",
    "snippet": "static char *\nnwfilterGetXMLDesc(virNWFilterPtr nwfilter,\n                   unsigned int flags)\n{\n    virNWFilterObjPtr obj;\n    virNWFilterDefPtr def;\n    char *ret = NULL;\n\n    virCheckFlags(0, NULL);\n\n    nwfilterDriverLock();\n    obj = nwfilterObjFromNWFilter(nwfilter->uuid);\n    nwfilterDriverUnlock();\n\n    if (!obj)\n        return NULL;\n    def = virNWFilterObjGetDef(obj);\n\n    if (virNWFilterGetXMLDescEnsureACL(nwfilter->conn, def) < 0)\n        goto cleanup;\n\n    ret = virNWFilterDefFormat(def);\n\n cleanup:\n    virNWFilterObjUnlock(obj);\n    return ret;\n}",
    "includes": [
      "#include \"nwfilter_learnipaddr.h\"",
      "#include \"nwfilter_dhcpsnoop.h\"",
      "#include \"nwfilter_ipaddrmap.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"nwfilter_gentech_driver.h\"",
      "#include \"nwfilter_driver.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_conf.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include \"internal.h\"",
      "#include \"virlog.h\"",
      "#include \"virdbus.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNWFilterObjUnlock",
          "args": [
            "obj"
          ],
          "line": 676
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterObjUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterobj.c",
          "lines": "561-565",
          "snippet": "void\nvirNWFilterObjUnlock(virNWFilterObjPtr obj)\n{\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virnwfilterobj.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virnwfilterobj.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvoid\nvirNWFilterObjUnlock(virNWFilterObjPtr obj)\n{\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterDefFormat",
          "args": [
            "def"
          ],
          "line": 673
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterDefFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_conf.c",
          "lines": "3044-3076",
          "snippet": "char *\nvirNWFilterDefFormat(const virNWFilterDef *def)\n{\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n    char uuid[VIR_UUID_STRING_BUFLEN];\n    size_t i;\n\n    virBufferAsprintf(&buf, \"<filter name='%s' chain='%s'\",\n                      def->name,\n                      def->chainsuffix);\n    if (def->chainPriority != 0)\n        virBufferAsprintf(&buf, \" priority='%d'\",\n                          def->chainPriority);\n    virBufferAddLit(&buf, \">\\n\");\n    virBufferAdjustIndent(&buf, 2);\n\n    virUUIDFormat(def->uuid, uuid);\n    virBufferAsprintf(&buf, \"<uuid>%s</uuid>\\n\", uuid);\n\n    for (i = 0; i < def->nentries; i++) {\n        if (virNWFilterEntryFormat(&buf, def->filterEntries[i]) < 0)\n            goto err_exit;\n    }\n\n    virBufferAdjustIndent(&buf, -2);\n    virBufferAddLit(&buf, \"</filter>\\n\");\n\n    return virBufferContentAndReset(&buf);\n\n err_exit:\n    virBufferFreeAndReset(&buf);\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"domain_conf.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"viruuid.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "# include <net/ethernet.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"viruuid.h\"\n#include \"internal.h\"\n#include <unistd.h>\n# include <net/ethernet.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nchar *\nvirNWFilterDefFormat(const virNWFilterDef *def)\n{\n    virBuffer buf = VIR_BUFFER_INITIALIZER;\n    char uuid[VIR_UUID_STRING_BUFLEN];\n    size_t i;\n\n    virBufferAsprintf(&buf, \"<filter name='%s' chain='%s'\",\n                      def->name,\n                      def->chainsuffix);\n    if (def->chainPriority != 0)\n        virBufferAsprintf(&buf, \" priority='%d'\",\n                          def->chainPriority);\n    virBufferAddLit(&buf, \">\\n\");\n    virBufferAdjustIndent(&buf, 2);\n\n    virUUIDFormat(def->uuid, uuid);\n    virBufferAsprintf(&buf, \"<uuid>%s</uuid>\\n\", uuid);\n\n    for (i = 0; i < def->nentries; i++) {\n        if (virNWFilterEntryFormat(&buf, def->filterEntries[i]) < 0)\n            goto err_exit;\n    }\n\n    virBufferAdjustIndent(&buf, -2);\n    virBufferAddLit(&buf, \"</filter>\\n\");\n\n    return virBufferContentAndReset(&buf);\n\n err_exit:\n    virBufferFreeAndReset(&buf);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterGetXMLDescEnsureACL",
          "args": [
            "nwfilter->conn",
            "def"
          ],
          "line": 670
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNWFilterObjGetDef",
          "args": [
            "obj"
          ],
          "line": 668
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterObjGetDef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterobj.c",
          "lines": "71-75",
          "snippet": "virNWFilterDefPtr\nvirNWFilterObjGetDef(virNWFilterObjPtr obj)\n{\n    return obj->def;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virnwfilterobj.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virnwfilterobj.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvirNWFilterDefPtr\nvirNWFilterObjGetDef(virNWFilterObjPtr obj)\n{\n    return obj->def;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nwfilterDriverUnlock",
          "args": [],
          "line": 664
        },
        "resolved": true,
        "details": {
          "function_name": "nwfilterDriverUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_driver.c",
          "lines": "75-78",
          "snippet": "static void nwfilterDriverUnlock(void)\n{\n    virMutexUnlock(&driver->lock);\n}",
          "includes": [
            "#include \"nwfilter_learnipaddr.h\"",
            "#include \"nwfilter_dhcpsnoop.h\"",
            "#include \"nwfilter_ipaddrmap.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"configmake.h\"",
            "#include \"nwfilter_gentech_driver.h\"",
            "#include \"nwfilter_driver.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_conf.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"virlog.h\"",
            "#include \"virdbus.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virNWFilterDriverStatePtr driver;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"nwfilter_driver.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_conf.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"virlog.h\"\n#include \"virdbus.h\"\n#include <config.h>\n\nstatic virNWFilterDriverStatePtr driver;\n\nstatic void nwfilterDriverUnlock(void)\n{\n    virMutexUnlock(&driver->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nwfilterObjFromNWFilter",
          "args": [
            "nwfilter->uuid"
          ],
          "line": 663
        },
        "resolved": true,
        "details": {
          "function_name": "nwfilterObjFromNWFilter",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_driver.c",
          "lines": "442-454",
          "snippet": "static virNWFilterObjPtr\nnwfilterObjFromNWFilter(const unsigned char *uuid)\n{\n    virNWFilterObjPtr obj;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (!(obj = virNWFilterObjListFindByUUID(driver->nwfilters, uuid))) {\n        virUUIDFormat(uuid, uuidstr);\n        virReportError(VIR_ERR_NO_NWFILTER,\n                       _(\"no nwfilter with matching uuid '%s'\"), uuidstr);\n    }\n    return obj;\n}",
          "includes": [
            "#include \"nwfilter_learnipaddr.h\"",
            "#include \"nwfilter_dhcpsnoop.h\"",
            "#include \"nwfilter_ipaddrmap.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"configmake.h\"",
            "#include \"nwfilter_gentech_driver.h\"",
            "#include \"nwfilter_driver.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_conf.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"virlog.h\"",
            "#include \"virdbus.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virNWFilterDriverStatePtr driver;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"nwfilter_driver.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_conf.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"virlog.h\"\n#include \"virdbus.h\"\n#include <config.h>\n\nstatic virNWFilterDriverStatePtr driver;\n\nstatic virNWFilterObjPtr\nnwfilterObjFromNWFilter(const unsigned char *uuid)\n{\n    virNWFilterObjPtr obj;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (!(obj = virNWFilterObjListFindByUUID(driver->nwfilters, uuid))) {\n        virUUIDFormat(uuid, uuidstr);\n        virReportError(VIR_ERR_NO_NWFILTER,\n                       _(\"no nwfilter with matching uuid '%s'\"), uuidstr);\n    }\n    return obj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nwfilterDriverLock",
          "args": [],
          "line": 662
        },
        "resolved": true,
        "details": {
          "function_name": "nwfilterDriverLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_driver.c",
          "lines": "71-74",
          "snippet": "static void nwfilterDriverLock(void)\n{\n    virMutexLock(&driver->lock);\n}",
          "includes": [
            "#include \"nwfilter_learnipaddr.h\"",
            "#include \"nwfilter_dhcpsnoop.h\"",
            "#include \"nwfilter_ipaddrmap.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"configmake.h\"",
            "#include \"nwfilter_gentech_driver.h\"",
            "#include \"nwfilter_driver.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_conf.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"virlog.h\"",
            "#include \"virdbus.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virNWFilterDriverStatePtr driver;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"nwfilter_driver.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_conf.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"virlog.h\"\n#include \"virdbus.h\"\n#include <config.h>\n\nstatic virNWFilterDriverStatePtr driver;\n\nstatic void nwfilterDriverLock(void)\n{\n    virMutexLock(&driver->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "0",
            "NULL"
          ],
          "line": 660
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"nwfilter_driver.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_conf.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"virlog.h\"\n#include \"virdbus.h\"\n#include <config.h>\n\nstatic char *\nnwfilterGetXMLDesc(virNWFilterPtr nwfilter,\n                   unsigned int flags)\n{\n    virNWFilterObjPtr obj;\n    virNWFilterDefPtr def;\n    char *ret = NULL;\n\n    virCheckFlags(0, NULL);\n\n    nwfilterDriverLock();\n    obj = nwfilterObjFromNWFilter(nwfilter->uuid);\n    nwfilterDriverUnlock();\n\n    if (!obj)\n        return NULL;\n    def = virNWFilterObjGetDef(obj);\n\n    if (virNWFilterGetXMLDescEnsureACL(nwfilter->conn, def) < 0)\n        goto cleanup;\n\n    ret = virNWFilterDefFormat(def);\n\n cleanup:\n    virNWFilterObjUnlock(obj);\n    return ret;\n}"
  },
  {
    "function_name": "nwfilterUndefine",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_driver.c",
    "lines": "611-649",
    "snippet": "static int\nnwfilterUndefine(virNWFilterPtr nwfilter)\n{\n    virNWFilterObjPtr obj;\n    virNWFilterDefPtr def;\n    int ret = -1;\n\n    nwfilterDriverLock();\n    virNWFilterWriteLockFilterUpdates();\n\n    if (!(obj = nwfilterObjFromNWFilter(nwfilter->uuid)))\n        goto cleanup;\n    def = virNWFilterObjGetDef(obj);\n\n    if (virNWFilterUndefineEnsureACL(nwfilter->conn, def) < 0)\n        goto cleanup;\n\n    if (virNWFilterObjTestUnassignDef(obj) < 0) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       \"%s\",\n                       _(\"nwfilter is in use\"));\n        goto cleanup;\n    }\n\n    if (virNWFilterDeleteDef(driver->configDir, def) < 0)\n        goto cleanup;\n\n    virNWFilterObjListRemove(driver->nwfilters, obj);\n    obj = NULL;\n    ret = 0;\n\n cleanup:\n    if (obj)\n        virNWFilterObjUnlock(obj);\n\n    virNWFilterUnlockFilterUpdates();\n    nwfilterDriverUnlock();\n    return ret;\n}",
    "includes": [
      "#include \"nwfilter_learnipaddr.h\"",
      "#include \"nwfilter_dhcpsnoop.h\"",
      "#include \"nwfilter_ipaddrmap.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"nwfilter_gentech_driver.h\"",
      "#include \"nwfilter_driver.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_conf.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include \"internal.h\"",
      "#include \"virlog.h\"",
      "#include \"virdbus.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virNWFilterDriverStatePtr driver;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "nwfilterDriverUnlock",
          "args": [],
          "line": 647
        },
        "resolved": true,
        "details": {
          "function_name": "nwfilterDriverUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_driver.c",
          "lines": "75-78",
          "snippet": "static void nwfilterDriverUnlock(void)\n{\n    virMutexUnlock(&driver->lock);\n}",
          "includes": [
            "#include \"nwfilter_learnipaddr.h\"",
            "#include \"nwfilter_dhcpsnoop.h\"",
            "#include \"nwfilter_ipaddrmap.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"configmake.h\"",
            "#include \"nwfilter_gentech_driver.h\"",
            "#include \"nwfilter_driver.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_conf.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"virlog.h\"",
            "#include \"virdbus.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virNWFilterDriverStatePtr driver;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"nwfilter_driver.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_conf.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"virlog.h\"\n#include \"virdbus.h\"\n#include <config.h>\n\nstatic virNWFilterDriverStatePtr driver;\n\nstatic void nwfilterDriverUnlock(void)\n{\n    virMutexUnlock(&driver->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterUnlockFilterUpdates",
          "args": [],
          "line": 646
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterUnlockFilterUpdates",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_conf.c",
          "lines": "174-178",
          "snippet": "void\nvirNWFilterUnlockFilterUpdates(void)\n{\n    virRWLockUnlock(&updateLock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"domain_conf.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"viruuid.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "# include <net/ethernet.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virRWLock updateLock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"viruuid.h\"\n#include \"internal.h\"\n#include <unistd.h>\n# include <net/ethernet.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic virRWLock updateLock;\n\nvoid\nvirNWFilterUnlockFilterUpdates(void)\n{\n    virRWLockUnlock(&updateLock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterObjUnlock",
          "args": [
            "obj"
          ],
          "line": 644
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterObjUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterobj.c",
          "lines": "561-565",
          "snippet": "void\nvirNWFilterObjUnlock(virNWFilterObjPtr obj)\n{\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virnwfilterobj.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virnwfilterobj.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvoid\nvirNWFilterObjUnlock(virNWFilterObjPtr obj)\n{\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterObjListRemove",
          "args": [
            "driver->nwfilters",
            "obj"
          ],
          "line": 638
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterObjListRemove",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterobj.c",
          "lines": "129-148",
          "snippet": "void\nvirNWFilterObjListRemove(virNWFilterObjListPtr nwfilters,\n                         virNWFilterObjPtr obj)\n{\n    size_t i;\n\n    virNWFilterObjUnlock(obj);\n\n    for (i = 0; i < nwfilters->count; i++) {\n        virNWFilterObjLock(nwfilters->objs[i]);\n        if (nwfilters->objs[i] == obj) {\n            virNWFilterObjUnlock(nwfilters->objs[i]);\n            virNWFilterObjFree(nwfilters->objs[i]);\n\n            VIR_DELETE_ELEMENT(nwfilters->objs, i, nwfilters->count);\n            break;\n        }\n        virNWFilterObjUnlock(nwfilters->objs[i]);\n    }\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virnwfilterobj.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virnwfilterobj.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvoid\nvirNWFilterObjListRemove(virNWFilterObjListPtr nwfilters,\n                         virNWFilterObjPtr obj)\n{\n    size_t i;\n\n    virNWFilterObjUnlock(obj);\n\n    for (i = 0; i < nwfilters->count; i++) {\n        virNWFilterObjLock(nwfilters->objs[i]);\n        if (nwfilters->objs[i] == obj) {\n            virNWFilterObjUnlock(nwfilters->objs[i]);\n            virNWFilterObjFree(nwfilters->objs[i]);\n\n            VIR_DELETE_ELEMENT(nwfilters->objs, i, nwfilters->count);\n            break;\n        }\n        virNWFilterObjUnlock(nwfilters->objs[i]);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterDeleteDef",
          "args": [
            "driver->configDir",
            "def"
          ],
          "line": 635
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterDeleteDef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_conf.c",
          "lines": "2812-2833",
          "snippet": "int\nvirNWFilterDeleteDef(const char *configDir,\n                     virNWFilterDefPtr def)\n{\n    int ret = -1;\n    char *configFile = NULL;\n\n    if (!(configFile = virFileBuildPath(configDir, def->name, \".xml\")))\n        goto error;\n\n    if (unlink(configFile) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"cannot remove config for %s\"),\n                       def->name);\n        goto error;\n    }\n\n    ret = 0;\n error:\n    VIR_FREE(configFile);\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"domain_conf.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"viruuid.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "# include <net/ethernet.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"viruuid.h\"\n#include \"internal.h\"\n#include <unistd.h>\n# include <net/ethernet.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nint\nvirNWFilterDeleteDef(const char *configDir,\n                     virNWFilterDefPtr def)\n{\n    int ret = -1;\n    char *configFile = NULL;\n\n    if (!(configFile = virFileBuildPath(configDir, def->name, \".xml\")))\n        goto error;\n\n    if (unlink(configFile) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"cannot remove config for %s\"),\n                       def->name);\n        goto error;\n    }\n\n    ret = 0;\n error:\n    VIR_FREE(configFile);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_INVALID",
            "\"%s\"",
            "_(\"nwfilter is in use\")"
          ],
          "line": 629
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"nwfilter is in use\""
          ],
          "line": 631
        },
        "resolved": true,
        "details": {
          "function_name": "_virNWFilterTeardownFilter",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_gentech_driver.c",
          "lines": "898-927",
          "snippet": "static int\n_virNWFilterTeardownFilter(const char *ifname)\n{\n    const char *drvname = EBIPTABLES_DRIVER_ID;\n    virNWFilterTechDriverPtr techdriver;\n    techdriver = virNWFilterTechDriverForName(drvname);\n\n    if (!techdriver) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Could not get access to ACL tech \"\n                         \"driver '%s'\"),\n                       drvname);\n        return -1;\n    }\n\n    virNWFilterDHCPSnoopEnd(ifname);\n\n    virNWFilterTerminateLearnReq(ifname);\n\n    if (virNWFilterLockIface(ifname) < 0)\n        return -1;\n\n    techdriver->allTeardown(ifname);\n\n    virNWFilterIPAddrMapDelIPAddr(ifname, NULL);\n\n    virNWFilterUnlockIface(ifname);\n\n    return 0;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"datatypes.h\"",
            "#include \"virnetdev.h\"",
            "#include \"nwfilter_learnipaddr.h\"",
            "#include \"nwfilter_ipaddrmap.h\"",
            "#include \"nwfilter_dhcpsnoop.h\"",
            "#include \"nwfilter_ebiptables_driver.h\"",
            "#include \"nwfilter_gentech_driver.h\"",
            "#include \"virerror.h\"",
            "#include \"domain_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int _virNWFilterTeardownFilter(const char *ifname);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virsocketaddr.h\"\n#include \"datatypes.h\"\n#include \"virnetdev.h\"\n#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ebiptables_driver.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"virerror.h\"\n#include \"domain_conf.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int _virNWFilterTeardownFilter(const char *ifname);\n\nstatic int\n_virNWFilterTeardownFilter(const char *ifname)\n{\n    const char *drvname = EBIPTABLES_DRIVER_ID;\n    virNWFilterTechDriverPtr techdriver;\n    techdriver = virNWFilterTechDriverForName(drvname);\n\n    if (!techdriver) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Could not get access to ACL tech \"\n                         \"driver '%s'\"),\n                       drvname);\n        return -1;\n    }\n\n    virNWFilterDHCPSnoopEnd(ifname);\n\n    virNWFilterTerminateLearnReq(ifname);\n\n    if (virNWFilterLockIface(ifname) < 0)\n        return -1;\n\n    techdriver->allTeardown(ifname);\n\n    virNWFilterIPAddrMapDelIPAddr(ifname, NULL);\n\n    virNWFilterUnlockIface(ifname);\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterObjTestUnassignDef",
          "args": [
            "obj"
          ],
          "line": 628
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterObjTestUnassignDef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterobj.c",
          "lines": "272-285",
          "snippet": "int\nvirNWFilterObjTestUnassignDef(virNWFilterObjPtr obj)\n{\n    int rc = 0;\n\n    obj->wantRemoved = true;\n    /* trigger the update on VMs referencing the filter */\n    if (virNWFilterTriggerRebuild() < 0)\n        rc = -1;\n\n    obj->wantRemoved = false;\n\n    return rc;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virnwfilterobj.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virnwfilterobj.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nint\nvirNWFilterObjTestUnassignDef(virNWFilterObjPtr obj)\n{\n    int rc = 0;\n\n    obj->wantRemoved = true;\n    /* trigger the update on VMs referencing the filter */\n    if (virNWFilterTriggerRebuild() < 0)\n        rc = -1;\n\n    obj->wantRemoved = false;\n\n    return rc;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterUndefineEnsureACL",
          "args": [
            "nwfilter->conn",
            "def"
          ],
          "line": 625
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNWFilterObjGetDef",
          "args": [
            "obj"
          ],
          "line": 623
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterObjGetDef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterobj.c",
          "lines": "71-75",
          "snippet": "virNWFilterDefPtr\nvirNWFilterObjGetDef(virNWFilterObjPtr obj)\n{\n    return obj->def;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virnwfilterobj.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virnwfilterobj.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvirNWFilterDefPtr\nvirNWFilterObjGetDef(virNWFilterObjPtr obj)\n{\n    return obj->def;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nwfilterObjFromNWFilter",
          "args": [
            "nwfilter->uuid"
          ],
          "line": 621
        },
        "resolved": true,
        "details": {
          "function_name": "nwfilterObjFromNWFilter",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_driver.c",
          "lines": "442-454",
          "snippet": "static virNWFilterObjPtr\nnwfilterObjFromNWFilter(const unsigned char *uuid)\n{\n    virNWFilterObjPtr obj;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (!(obj = virNWFilterObjListFindByUUID(driver->nwfilters, uuid))) {\n        virUUIDFormat(uuid, uuidstr);\n        virReportError(VIR_ERR_NO_NWFILTER,\n                       _(\"no nwfilter with matching uuid '%s'\"), uuidstr);\n    }\n    return obj;\n}",
          "includes": [
            "#include \"nwfilter_learnipaddr.h\"",
            "#include \"nwfilter_dhcpsnoop.h\"",
            "#include \"nwfilter_ipaddrmap.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"configmake.h\"",
            "#include \"nwfilter_gentech_driver.h\"",
            "#include \"nwfilter_driver.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_conf.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"virlog.h\"",
            "#include \"virdbus.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virNWFilterDriverStatePtr driver;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"nwfilter_driver.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_conf.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"virlog.h\"\n#include \"virdbus.h\"\n#include <config.h>\n\nstatic virNWFilterDriverStatePtr driver;\n\nstatic virNWFilterObjPtr\nnwfilterObjFromNWFilter(const unsigned char *uuid)\n{\n    virNWFilterObjPtr obj;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (!(obj = virNWFilterObjListFindByUUID(driver->nwfilters, uuid))) {\n        virUUIDFormat(uuid, uuidstr);\n        virReportError(VIR_ERR_NO_NWFILTER,\n                       _(\"no nwfilter with matching uuid '%s'\"), uuidstr);\n    }\n    return obj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterWriteLockFilterUpdates",
          "args": [],
          "line": 619
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterWriteLockFilterUpdates",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_conf.c",
          "lines": "167-171",
          "snippet": "void\nvirNWFilterWriteLockFilterUpdates(void)\n{\n    virRWLockWrite(&updateLock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"domain_conf.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"viruuid.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "# include <net/ethernet.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virRWLock updateLock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"viruuid.h\"\n#include \"internal.h\"\n#include <unistd.h>\n# include <net/ethernet.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic virRWLock updateLock;\n\nvoid\nvirNWFilterWriteLockFilterUpdates(void)\n{\n    virRWLockWrite(&updateLock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nwfilterDriverLock",
          "args": [],
          "line": 618
        },
        "resolved": true,
        "details": {
          "function_name": "nwfilterDriverLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_driver.c",
          "lines": "71-74",
          "snippet": "static void nwfilterDriverLock(void)\n{\n    virMutexLock(&driver->lock);\n}",
          "includes": [
            "#include \"nwfilter_learnipaddr.h\"",
            "#include \"nwfilter_dhcpsnoop.h\"",
            "#include \"nwfilter_ipaddrmap.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"configmake.h\"",
            "#include \"nwfilter_gentech_driver.h\"",
            "#include \"nwfilter_driver.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_conf.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"virlog.h\"",
            "#include \"virdbus.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virNWFilterDriverStatePtr driver;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"nwfilter_driver.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_conf.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"virlog.h\"\n#include \"virdbus.h\"\n#include <config.h>\n\nstatic virNWFilterDriverStatePtr driver;\n\nstatic void nwfilterDriverLock(void)\n{\n    virMutexLock(&driver->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"nwfilter_driver.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_conf.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"virlog.h\"\n#include \"virdbus.h\"\n#include <config.h>\n\nstatic virNWFilterDriverStatePtr driver;\n\nstatic int\nnwfilterUndefine(virNWFilterPtr nwfilter)\n{\n    virNWFilterObjPtr obj;\n    virNWFilterDefPtr def;\n    int ret = -1;\n\n    nwfilterDriverLock();\n    virNWFilterWriteLockFilterUpdates();\n\n    if (!(obj = nwfilterObjFromNWFilter(nwfilter->uuid)))\n        goto cleanup;\n    def = virNWFilterObjGetDef(obj);\n\n    if (virNWFilterUndefineEnsureACL(nwfilter->conn, def) < 0)\n        goto cleanup;\n\n    if (virNWFilterObjTestUnassignDef(obj) < 0) {\n        virReportError(VIR_ERR_OPERATION_INVALID,\n                       \"%s\",\n                       _(\"nwfilter is in use\"));\n        goto cleanup;\n    }\n\n    if (virNWFilterDeleteDef(driver->configDir, def) < 0)\n        goto cleanup;\n\n    virNWFilterObjListRemove(driver->nwfilters, obj);\n    obj = NULL;\n    ret = 0;\n\n cleanup:\n    if (obj)\n        virNWFilterObjUnlock(obj);\n\n    virNWFilterUnlockFilterUpdates();\n    nwfilterDriverUnlock();\n    return ret;\n}"
  },
  {
    "function_name": "nwfilterDefineXML",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_driver.c",
    "lines": "564-608",
    "snippet": "static virNWFilterPtr\nnwfilterDefineXML(virConnectPtr conn,\n                  const char *xml)\n{\n    virNWFilterDefPtr def;\n    virNWFilterObjPtr obj = NULL;\n    virNWFilterDefPtr objdef;\n    virNWFilterPtr nwfilter = NULL;\n\n    if (!driver->privileged) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"Can't define NWFilters in session mode\"));\n        return NULL;\n    }\n\n    nwfilterDriverLock();\n    virNWFilterWriteLockFilterUpdates();\n\n    if (!(def = virNWFilterDefParseString(xml)))\n        goto cleanup;\n\n    if (virNWFilterDefineXMLEnsureACL(conn, def) < 0)\n        goto cleanup;\n\n    if (!(obj = virNWFilterObjListAssignDef(driver->nwfilters, def)))\n        goto cleanup;\n    def = NULL;\n    objdef = virNWFilterObjGetDef(obj);\n\n    if (virNWFilterSaveConfig(driver->configDir, objdef) < 0) {\n        virNWFilterObjListRemove(driver->nwfilters, obj);\n        goto cleanup;\n    }\n\n    nwfilter = virGetNWFilter(conn, objdef->name, objdef->uuid);\n\n cleanup:\n    virNWFilterDefFree(def);\n    if (obj)\n        virNWFilterObjUnlock(obj);\n\n    virNWFilterUnlockFilterUpdates();\n    nwfilterDriverUnlock();\n    return nwfilter;\n}",
    "includes": [
      "#include \"nwfilter_learnipaddr.h\"",
      "#include \"nwfilter_dhcpsnoop.h\"",
      "#include \"nwfilter_ipaddrmap.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"nwfilter_gentech_driver.h\"",
      "#include \"nwfilter_driver.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_conf.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include \"internal.h\"",
      "#include \"virlog.h\"",
      "#include \"virdbus.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virNWFilterDriverStatePtr driver;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "nwfilterDriverUnlock",
          "args": [],
          "line": 606
        },
        "resolved": true,
        "details": {
          "function_name": "nwfilterDriverUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_driver.c",
          "lines": "75-78",
          "snippet": "static void nwfilterDriverUnlock(void)\n{\n    virMutexUnlock(&driver->lock);\n}",
          "includes": [
            "#include \"nwfilter_learnipaddr.h\"",
            "#include \"nwfilter_dhcpsnoop.h\"",
            "#include \"nwfilter_ipaddrmap.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"configmake.h\"",
            "#include \"nwfilter_gentech_driver.h\"",
            "#include \"nwfilter_driver.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_conf.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"virlog.h\"",
            "#include \"virdbus.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virNWFilterDriverStatePtr driver;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"nwfilter_driver.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_conf.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"virlog.h\"\n#include \"virdbus.h\"\n#include <config.h>\n\nstatic virNWFilterDriverStatePtr driver;\n\nstatic void nwfilterDriverUnlock(void)\n{\n    virMutexUnlock(&driver->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterUnlockFilterUpdates",
          "args": [],
          "line": 605
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterUnlockFilterUpdates",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_conf.c",
          "lines": "174-178",
          "snippet": "void\nvirNWFilterUnlockFilterUpdates(void)\n{\n    virRWLockUnlock(&updateLock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"domain_conf.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"viruuid.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "# include <net/ethernet.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virRWLock updateLock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"viruuid.h\"\n#include \"internal.h\"\n#include <unistd.h>\n# include <net/ethernet.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic virRWLock updateLock;\n\nvoid\nvirNWFilterUnlockFilterUpdates(void)\n{\n    virRWLockUnlock(&updateLock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterObjUnlock",
          "args": [
            "obj"
          ],
          "line": 603
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterObjUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterobj.c",
          "lines": "561-565",
          "snippet": "void\nvirNWFilterObjUnlock(virNWFilterObjPtr obj)\n{\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virnwfilterobj.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virnwfilterobj.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvoid\nvirNWFilterObjUnlock(virNWFilterObjPtr obj)\n{\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterDefFree",
          "args": [
            "def"
          ],
          "line": 601
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterDefFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_conf.c",
          "lines": "344-360",
          "snippet": "void\nvirNWFilterDefFree(virNWFilterDefPtr def)\n{\n    size_t i;\n    if (!def)\n        return;\n\n    VIR_FREE(def->name);\n\n    for (i = 0; i < def->nentries; i++)\n        virNWFilterEntryFree(def->filterEntries[i]);\n\n    VIR_FREE(def->filterEntries);\n    VIR_FREE(def->chainsuffix);\n\n    VIR_FREE(def);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"domain_conf.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"viruuid.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "# include <net/ethernet.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"viruuid.h\"\n#include \"internal.h\"\n#include <unistd.h>\n# include <net/ethernet.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvoid\nvirNWFilterDefFree(virNWFilterDefPtr def)\n{\n    size_t i;\n    if (!def)\n        return;\n\n    VIR_FREE(def->name);\n\n    for (i = 0; i < def->nentries; i++)\n        virNWFilterEntryFree(def->filterEntries[i]);\n\n    VIR_FREE(def->filterEntries);\n    VIR_FREE(def->chainsuffix);\n\n    VIR_FREE(def);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virGetNWFilter",
          "args": [
            "conn",
            "objdef->name",
            "objdef->uuid"
          ],
          "line": 598
        },
        "resolved": true,
        "details": {
          "function_name": "virGetNWFilterBinding",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/datatypes.c",
          "lines": "904-930",
          "snippet": "virNWFilterBindingPtr\nvirGetNWFilterBinding(virConnectPtr conn, const char *portdev,\n                      const char *filtername)\n{\n    virNWFilterBindingPtr ret = NULL;\n\n    if (virDataTypesInitialize() < 0)\n        return NULL;\n\n    virCheckConnectGoto(conn, error);\n    virCheckNonNullArgGoto(portdev, error);\n\n    if (!(ret = virObjectNew(virNWFilterBindingClass)))\n        goto error;\n\n    ret->portdev = g_strdup(portdev);\n\n    ret->filtername = g_strdup(filtername);\n\n    ret->conn = virObjectRef(conn);\n\n    return ret;\n\n error:\n    virObjectUnref(ret);\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viruuid.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virClassPtr virNWFilterBindingClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viruuid.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <unistd.h>\n#include <config.h>\n\nvirClassPtr virNWFilterBindingClass;\n\nvirNWFilterBindingPtr\nvirGetNWFilterBinding(virConnectPtr conn, const char *portdev,\n                      const char *filtername)\n{\n    virNWFilterBindingPtr ret = NULL;\n\n    if (virDataTypesInitialize() < 0)\n        return NULL;\n\n    virCheckConnectGoto(conn, error);\n    virCheckNonNullArgGoto(portdev, error);\n\n    if (!(ret = virObjectNew(virNWFilterBindingClass)))\n        goto error;\n\n    ret->portdev = g_strdup(portdev);\n\n    ret->filtername = g_strdup(filtername);\n\n    ret->conn = virObjectRef(conn);\n\n    return ret;\n\n error:\n    virObjectUnref(ret);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterObjListRemove",
          "args": [
            "driver->nwfilters",
            "obj"
          ],
          "line": 594
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterObjListRemove",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterobj.c",
          "lines": "129-148",
          "snippet": "void\nvirNWFilterObjListRemove(virNWFilterObjListPtr nwfilters,\n                         virNWFilterObjPtr obj)\n{\n    size_t i;\n\n    virNWFilterObjUnlock(obj);\n\n    for (i = 0; i < nwfilters->count; i++) {\n        virNWFilterObjLock(nwfilters->objs[i]);\n        if (nwfilters->objs[i] == obj) {\n            virNWFilterObjUnlock(nwfilters->objs[i]);\n            virNWFilterObjFree(nwfilters->objs[i]);\n\n            VIR_DELETE_ELEMENT(nwfilters->objs, i, nwfilters->count);\n            break;\n        }\n        virNWFilterObjUnlock(nwfilters->objs[i]);\n    }\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virnwfilterobj.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virnwfilterobj.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvoid\nvirNWFilterObjListRemove(virNWFilterObjListPtr nwfilters,\n                         virNWFilterObjPtr obj)\n{\n    size_t i;\n\n    virNWFilterObjUnlock(obj);\n\n    for (i = 0; i < nwfilters->count; i++) {\n        virNWFilterObjLock(nwfilters->objs[i]);\n        if (nwfilters->objs[i] == obj) {\n            virNWFilterObjUnlock(nwfilters->objs[i]);\n            virNWFilterObjFree(nwfilters->objs[i]);\n\n            VIR_DELETE_ELEMENT(nwfilters->objs, i, nwfilters->count);\n            break;\n        }\n        virNWFilterObjUnlock(nwfilters->objs[i]);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterSaveConfig",
          "args": [
            "driver->configDir",
            "objdef"
          ],
          "line": 593
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterSaveConfig",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_conf.c",
          "lines": "2785-2809",
          "snippet": "int\nvirNWFilterSaveConfig(const char *configDir,\n                      virNWFilterDefPtr def)\n{\n    int ret = -1;\n    char *xml;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    char *configFile = NULL;\n\n    if (!(xml = virNWFilterDefFormat(def)))\n        goto cleanup;\n\n    if (!(configFile = virFileBuildPath(configDir, def->name, \".xml\")))\n        goto cleanup;\n\n    virUUIDFormat(def->uuid, uuidstr);\n    ret = virXMLSaveFile(configFile,\n                         virXMLPickShellSafeComment(def->name, uuidstr),\n                         \"nwfilter-edit\", xml);\n\n cleanup:\n    VIR_FREE(configFile);\n    VIR_FREE(xml);\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"domain_conf.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"viruuid.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "# include <net/ethernet.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"viruuid.h\"\n#include \"internal.h\"\n#include <unistd.h>\n# include <net/ethernet.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nint\nvirNWFilterSaveConfig(const char *configDir,\n                      virNWFilterDefPtr def)\n{\n    int ret = -1;\n    char *xml;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n    char *configFile = NULL;\n\n    if (!(xml = virNWFilterDefFormat(def)))\n        goto cleanup;\n\n    if (!(configFile = virFileBuildPath(configDir, def->name, \".xml\")))\n        goto cleanup;\n\n    virUUIDFormat(def->uuid, uuidstr);\n    ret = virXMLSaveFile(configFile,\n                         virXMLPickShellSafeComment(def->name, uuidstr),\n                         \"nwfilter-edit\", xml);\n\n cleanup:\n    VIR_FREE(configFile);\n    VIR_FREE(xml);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterObjGetDef",
          "args": [
            "obj"
          ],
          "line": 591
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterObjGetDef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterobj.c",
          "lines": "71-75",
          "snippet": "virNWFilterDefPtr\nvirNWFilterObjGetDef(virNWFilterObjPtr obj)\n{\n    return obj->def;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virnwfilterobj.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virnwfilterobj.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvirNWFilterDefPtr\nvirNWFilterObjGetDef(virNWFilterObjPtr obj)\n{\n    return obj->def;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterObjListAssignDef",
          "args": [
            "driver->nwfilters",
            "def"
          ],
          "line": 588
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterObjListAssignDef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterobj.c",
          "lines": "310-385",
          "snippet": "virNWFilterObjPtr\nvirNWFilterObjListAssignDef(virNWFilterObjListPtr nwfilters,\n                            virNWFilterDefPtr def)\n{\n    virNWFilterObjPtr obj;\n    virNWFilterDefPtr objdef;\n\n    if ((obj = virNWFilterObjListFindByUUID(nwfilters, def->uuid))) {\n        objdef = obj->def;\n\n        if (STRNEQ(def->name, objdef->name)) {\n            virReportError(VIR_ERR_OPERATION_FAILED,\n                           _(\"filter with same UUID but different name \"\n                             \"('%s') already exists\"),\n                           objdef->name);\n            virNWFilterObjUnlock(obj);\n            return NULL;\n        }\n        virNWFilterObjUnlock(obj);\n    } else {\n        if ((obj = virNWFilterObjListFindByName(nwfilters, def->name))) {\n            char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n            objdef = obj->def;\n            virUUIDFormat(objdef->uuid, uuidstr);\n            virReportError(VIR_ERR_OPERATION_FAILED,\n                           _(\"filter '%s' already exists with uuid %s\"),\n                           def->name, uuidstr);\n            virNWFilterObjUnlock(obj);\n            return NULL;\n        }\n    }\n\n    if (virNWFilterObjListDefLoopDetect(nwfilters, def) < 0) {\n        virReportError(VIR_ERR_OPERATION_FAILED,\n                       \"%s\", _(\"filter would introduce a loop\"));\n        return NULL;\n    }\n\n\n    if ((obj = virNWFilterObjListFindByName(nwfilters, def->name))) {\n\n        objdef = obj->def;\n        if (virNWFilterDefEqual(def, objdef)) {\n            virNWFilterDefFree(objdef);\n            obj->def = def;\n            return obj;\n        }\n\n        obj->newDef = def;\n        /* trigger the update on VMs referencing the filter */\n        if (virNWFilterTriggerRebuild() < 0) {\n            obj->newDef = NULL;\n            virNWFilterObjUnlock(obj);\n            return NULL;\n        }\n\n        virNWFilterDefFree(objdef);\n        obj->def = def;\n        obj->newDef = NULL;\n        return obj;\n    }\n\n    if (!(obj = virNWFilterObjNew()))\n        return NULL;\n\n    if (VIR_APPEND_ELEMENT_COPY(nwfilters->objs,\n                                nwfilters->count, obj) < 0) {\n        virNWFilterObjUnlock(obj);\n        virNWFilterObjFree(obj);\n        return NULL;\n    }\n    obj->def = def;\n\n    return obj;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virnwfilterobj.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virnwfilterobj.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvirNWFilterObjPtr\nvirNWFilterObjListAssignDef(virNWFilterObjListPtr nwfilters,\n                            virNWFilterDefPtr def)\n{\n    virNWFilterObjPtr obj;\n    virNWFilterDefPtr objdef;\n\n    if ((obj = virNWFilterObjListFindByUUID(nwfilters, def->uuid))) {\n        objdef = obj->def;\n\n        if (STRNEQ(def->name, objdef->name)) {\n            virReportError(VIR_ERR_OPERATION_FAILED,\n                           _(\"filter with same UUID but different name \"\n                             \"('%s') already exists\"),\n                           objdef->name);\n            virNWFilterObjUnlock(obj);\n            return NULL;\n        }\n        virNWFilterObjUnlock(obj);\n    } else {\n        if ((obj = virNWFilterObjListFindByName(nwfilters, def->name))) {\n            char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n            objdef = obj->def;\n            virUUIDFormat(objdef->uuid, uuidstr);\n            virReportError(VIR_ERR_OPERATION_FAILED,\n                           _(\"filter '%s' already exists with uuid %s\"),\n                           def->name, uuidstr);\n            virNWFilterObjUnlock(obj);\n            return NULL;\n        }\n    }\n\n    if (virNWFilterObjListDefLoopDetect(nwfilters, def) < 0) {\n        virReportError(VIR_ERR_OPERATION_FAILED,\n                       \"%s\", _(\"filter would introduce a loop\"));\n        return NULL;\n    }\n\n\n    if ((obj = virNWFilterObjListFindByName(nwfilters, def->name))) {\n\n        objdef = obj->def;\n        if (virNWFilterDefEqual(def, objdef)) {\n            virNWFilterDefFree(objdef);\n            obj->def = def;\n            return obj;\n        }\n\n        obj->newDef = def;\n        /* trigger the update on VMs referencing the filter */\n        if (virNWFilterTriggerRebuild() < 0) {\n            obj->newDef = NULL;\n            virNWFilterObjUnlock(obj);\n            return NULL;\n        }\n\n        virNWFilterDefFree(objdef);\n        obj->def = def;\n        obj->newDef = NULL;\n        return obj;\n    }\n\n    if (!(obj = virNWFilterObjNew()))\n        return NULL;\n\n    if (VIR_APPEND_ELEMENT_COPY(nwfilters->objs,\n                                nwfilters->count, obj) < 0) {\n        virNWFilterObjUnlock(obj);\n        virNWFilterObjFree(obj);\n        return NULL;\n    }\n    obj->def = def;\n\n    return obj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterDefineXMLEnsureACL",
          "args": [
            "conn",
            "def"
          ],
          "line": 585
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNWFilterDefParseString",
          "args": [
            "xml"
          ],
          "line": 582
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterDefParseString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_conf.c",
          "lines": "2771-2775",
          "snippet": "virNWFilterDefPtr\nvirNWFilterDefParseString(const char *xmlStr)\n{\n    return virNWFilterDefParse(xmlStr, NULL);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"domain_conf.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"viruuid.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "# include <net/ethernet.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"viruuid.h\"\n#include \"internal.h\"\n#include <unistd.h>\n# include <net/ethernet.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvirNWFilterDefPtr\nvirNWFilterDefParseString(const char *xmlStr)\n{\n    return virNWFilterDefParse(xmlStr, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterWriteLockFilterUpdates",
          "args": [],
          "line": 580
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterWriteLockFilterUpdates",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_conf.c",
          "lines": "167-171",
          "snippet": "void\nvirNWFilterWriteLockFilterUpdates(void)\n{\n    virRWLockWrite(&updateLock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"domain_conf.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"viruuid.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "# include <net/ethernet.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virRWLock updateLock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"viruuid.h\"\n#include \"internal.h\"\n#include <unistd.h>\n# include <net/ethernet.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic virRWLock updateLock;\n\nvoid\nvirNWFilterWriteLockFilterUpdates(void)\n{\n    virRWLockWrite(&updateLock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nwfilterDriverLock",
          "args": [],
          "line": 579
        },
        "resolved": true,
        "details": {
          "function_name": "nwfilterDriverLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_driver.c",
          "lines": "71-74",
          "snippet": "static void nwfilterDriverLock(void)\n{\n    virMutexLock(&driver->lock);\n}",
          "includes": [
            "#include \"nwfilter_learnipaddr.h\"",
            "#include \"nwfilter_dhcpsnoop.h\"",
            "#include \"nwfilter_ipaddrmap.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"configmake.h\"",
            "#include \"nwfilter_gentech_driver.h\"",
            "#include \"nwfilter_driver.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_conf.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"virlog.h\"",
            "#include \"virdbus.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virNWFilterDriverStatePtr driver;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"nwfilter_driver.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_conf.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"virlog.h\"\n#include \"virdbus.h\"\n#include <config.h>\n\nstatic virNWFilterDriverStatePtr driver;\n\nstatic void nwfilterDriverLock(void)\n{\n    virMutexLock(&driver->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_INVALID",
            "\"%s\"",
            "_(\"Can't define NWFilters in session mode\")"
          ],
          "line": 574
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Can't define NWFilters in session mode\""
          ],
          "line": 575
        },
        "resolved": true,
        "details": {
          "function_name": "_virNWFilterTeardownFilter",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_gentech_driver.c",
          "lines": "898-927",
          "snippet": "static int\n_virNWFilterTeardownFilter(const char *ifname)\n{\n    const char *drvname = EBIPTABLES_DRIVER_ID;\n    virNWFilterTechDriverPtr techdriver;\n    techdriver = virNWFilterTechDriverForName(drvname);\n\n    if (!techdriver) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Could not get access to ACL tech \"\n                         \"driver '%s'\"),\n                       drvname);\n        return -1;\n    }\n\n    virNWFilterDHCPSnoopEnd(ifname);\n\n    virNWFilterTerminateLearnReq(ifname);\n\n    if (virNWFilterLockIface(ifname) < 0)\n        return -1;\n\n    techdriver->allTeardown(ifname);\n\n    virNWFilterIPAddrMapDelIPAddr(ifname, NULL);\n\n    virNWFilterUnlockIface(ifname);\n\n    return 0;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"datatypes.h\"",
            "#include \"virnetdev.h\"",
            "#include \"nwfilter_learnipaddr.h\"",
            "#include \"nwfilter_ipaddrmap.h\"",
            "#include \"nwfilter_dhcpsnoop.h\"",
            "#include \"nwfilter_ebiptables_driver.h\"",
            "#include \"nwfilter_gentech_driver.h\"",
            "#include \"virerror.h\"",
            "#include \"domain_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int _virNWFilterTeardownFilter(const char *ifname);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virsocketaddr.h\"\n#include \"datatypes.h\"\n#include \"virnetdev.h\"\n#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ebiptables_driver.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"virerror.h\"\n#include \"domain_conf.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int _virNWFilterTeardownFilter(const char *ifname);\n\nstatic int\n_virNWFilterTeardownFilter(const char *ifname)\n{\n    const char *drvname = EBIPTABLES_DRIVER_ID;\n    virNWFilterTechDriverPtr techdriver;\n    techdriver = virNWFilterTechDriverForName(drvname);\n\n    if (!techdriver) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Could not get access to ACL tech \"\n                         \"driver '%s'\"),\n                       drvname);\n        return -1;\n    }\n\n    virNWFilterDHCPSnoopEnd(ifname);\n\n    virNWFilterTerminateLearnReq(ifname);\n\n    if (virNWFilterLockIface(ifname) < 0)\n        return -1;\n\n    techdriver->allTeardown(ifname);\n\n    virNWFilterIPAddrMapDelIPAddr(ifname, NULL);\n\n    virNWFilterUnlockIface(ifname);\n\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"nwfilter_driver.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_conf.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"virlog.h\"\n#include \"virdbus.h\"\n#include <config.h>\n\nstatic virNWFilterDriverStatePtr driver;\n\nstatic virNWFilterPtr\nnwfilterDefineXML(virConnectPtr conn,\n                  const char *xml)\n{\n    virNWFilterDefPtr def;\n    virNWFilterObjPtr obj = NULL;\n    virNWFilterDefPtr objdef;\n    virNWFilterPtr nwfilter = NULL;\n\n    if (!driver->privileged) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"Can't define NWFilters in session mode\"));\n        return NULL;\n    }\n\n    nwfilterDriverLock();\n    virNWFilterWriteLockFilterUpdates();\n\n    if (!(def = virNWFilterDefParseString(xml)))\n        goto cleanup;\n\n    if (virNWFilterDefineXMLEnsureACL(conn, def) < 0)\n        goto cleanup;\n\n    if (!(obj = virNWFilterObjListAssignDef(driver->nwfilters, def)))\n        goto cleanup;\n    def = NULL;\n    objdef = virNWFilterObjGetDef(obj);\n\n    if (virNWFilterSaveConfig(driver->configDir, objdef) < 0) {\n        virNWFilterObjListRemove(driver->nwfilters, obj);\n        goto cleanup;\n    }\n\n    nwfilter = virGetNWFilter(conn, objdef->name, objdef->uuid);\n\n cleanup:\n    virNWFilterDefFree(def);\n    if (obj)\n        virNWFilterObjUnlock(obj);\n\n    virNWFilterUnlockFilterUpdates();\n    nwfilterDriverUnlock();\n    return nwfilter;\n}"
  },
  {
    "function_name": "nwfilterConnectListAllNWFilters",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_driver.c",
    "lines": "544-562",
    "snippet": "static int\nnwfilterConnectListAllNWFilters(virConnectPtr conn,\n                                virNWFilterPtr **nwfilters,\n                                unsigned int flags)\n{\n    int ret;\n\n    virCheckFlags(0, -1);\n\n    if (virConnectListAllNWFiltersEnsureACL(conn) < 0)\n        return -1;\n\n    nwfilterDriverLock();\n    ret = virNWFilterObjListExport(conn, driver->nwfilters, nwfilters,\n                                   virConnectListAllNWFiltersCheckACL);\n    nwfilterDriverUnlock();\n\n    return ret;\n}",
    "includes": [
      "#include \"nwfilter_learnipaddr.h\"",
      "#include \"nwfilter_dhcpsnoop.h\"",
      "#include \"nwfilter_ipaddrmap.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"nwfilter_gentech_driver.h\"",
      "#include \"nwfilter_driver.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_conf.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include \"internal.h\"",
      "#include \"virlog.h\"",
      "#include \"virdbus.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virNWFilterDriverStatePtr driver;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "nwfilterDriverUnlock",
          "args": [],
          "line": 559
        },
        "resolved": true,
        "details": {
          "function_name": "nwfilterDriverUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_driver.c",
          "lines": "75-78",
          "snippet": "static void nwfilterDriverUnlock(void)\n{\n    virMutexUnlock(&driver->lock);\n}",
          "includes": [
            "#include \"nwfilter_learnipaddr.h\"",
            "#include \"nwfilter_dhcpsnoop.h\"",
            "#include \"nwfilter_ipaddrmap.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"configmake.h\"",
            "#include \"nwfilter_gentech_driver.h\"",
            "#include \"nwfilter_driver.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_conf.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"virlog.h\"",
            "#include \"virdbus.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virNWFilterDriverStatePtr driver;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"nwfilter_driver.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_conf.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"virlog.h\"\n#include \"virdbus.h\"\n#include <config.h>\n\nstatic virNWFilterDriverStatePtr driver;\n\nstatic void nwfilterDriverUnlock(void)\n{\n    virMutexUnlock(&driver->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterObjListExport",
          "args": [
            "conn",
            "driver->nwfilters",
            "nwfilters",
            "virConnectListAllNWFiltersCheckACL"
          ],
          "line": 557
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterObjListExport",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterobj.c",
          "lines": "434-482",
          "snippet": "int\nvirNWFilterObjListExport(virConnectPtr conn,\n                         virNWFilterObjListPtr nwfilters,\n                         virNWFilterPtr **filters,\n                         virNWFilterObjListFilter filter)\n{\n    virNWFilterPtr *tmp_filters = NULL;\n    int nfilters = 0;\n    virNWFilterPtr nwfilter = NULL;\n    virNWFilterObjPtr obj = NULL;\n    virNWFilterDefPtr def;\n    size_t i;\n    int ret = -1;\n\n    if (!filters) {\n        ret = nwfilters->count;\n        goto cleanup;\n    }\n\n    if (VIR_ALLOC_N(tmp_filters, nwfilters->count + 1) < 0)\n        goto cleanup;\n\n    for (i = 0; i < nwfilters->count; i++) {\n        obj = nwfilters->objs[i];\n        virNWFilterObjLock(obj);\n        def = obj->def;\n        if (!filter || filter(conn, def)) {\n            if (!(nwfilter = virGetNWFilter(conn, def->name, def->uuid))) {\n                virNWFilterObjUnlock(obj);\n                goto cleanup;\n            }\n            tmp_filters[nfilters++] = nwfilter;\n        }\n        virNWFilterObjUnlock(obj);\n    }\n\n    *filters = tmp_filters;\n    tmp_filters = NULL;\n    ret = nfilters;\n\n cleanup:\n    if (tmp_filters) {\n        for (i = 0; i < nfilters; i ++)\n            virObjectUnref(tmp_filters[i]);\n    }\n    VIR_FREE(tmp_filters);\n\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virnwfilterobj.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virnwfilterobj.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nint\nvirNWFilterObjListExport(virConnectPtr conn,\n                         virNWFilterObjListPtr nwfilters,\n                         virNWFilterPtr **filters,\n                         virNWFilterObjListFilter filter)\n{\n    virNWFilterPtr *tmp_filters = NULL;\n    int nfilters = 0;\n    virNWFilterPtr nwfilter = NULL;\n    virNWFilterObjPtr obj = NULL;\n    virNWFilterDefPtr def;\n    size_t i;\n    int ret = -1;\n\n    if (!filters) {\n        ret = nwfilters->count;\n        goto cleanup;\n    }\n\n    if (VIR_ALLOC_N(tmp_filters, nwfilters->count + 1) < 0)\n        goto cleanup;\n\n    for (i = 0; i < nwfilters->count; i++) {\n        obj = nwfilters->objs[i];\n        virNWFilterObjLock(obj);\n        def = obj->def;\n        if (!filter || filter(conn, def)) {\n            if (!(nwfilter = virGetNWFilter(conn, def->name, def->uuid))) {\n                virNWFilterObjUnlock(obj);\n                goto cleanup;\n            }\n            tmp_filters[nfilters++] = nwfilter;\n        }\n        virNWFilterObjUnlock(obj);\n    }\n\n    *filters = tmp_filters;\n    tmp_filters = NULL;\n    ret = nfilters;\n\n cleanup:\n    if (tmp_filters) {\n        for (i = 0; i < nfilters; i ++)\n            virObjectUnref(tmp_filters[i]);\n    }\n    VIR_FREE(tmp_filters);\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nwfilterDriverLock",
          "args": [],
          "line": 556
        },
        "resolved": true,
        "details": {
          "function_name": "nwfilterDriverLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_driver.c",
          "lines": "71-74",
          "snippet": "static void nwfilterDriverLock(void)\n{\n    virMutexLock(&driver->lock);\n}",
          "includes": [
            "#include \"nwfilter_learnipaddr.h\"",
            "#include \"nwfilter_dhcpsnoop.h\"",
            "#include \"nwfilter_ipaddrmap.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"configmake.h\"",
            "#include \"nwfilter_gentech_driver.h\"",
            "#include \"nwfilter_driver.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_conf.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"virlog.h\"",
            "#include \"virdbus.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virNWFilterDriverStatePtr driver;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"nwfilter_driver.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_conf.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"virlog.h\"\n#include \"virdbus.h\"\n#include <config.h>\n\nstatic virNWFilterDriverStatePtr driver;\n\nstatic void nwfilterDriverLock(void)\n{\n    virMutexLock(&driver->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virConnectListAllNWFiltersEnsureACL",
          "args": [
            "conn"
          ],
          "line": 553
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "0",
            "-1"
          ],
          "line": 551
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"nwfilter_driver.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_conf.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"virlog.h\"\n#include \"virdbus.h\"\n#include <config.h>\n\nstatic virNWFilterDriverStatePtr driver;\n\nstatic int\nnwfilterConnectListAllNWFilters(virConnectPtr conn,\n                                virNWFilterPtr **nwfilters,\n                                unsigned int flags)\n{\n    int ret;\n\n    virCheckFlags(0, -1);\n\n    if (virConnectListAllNWFiltersEnsureACL(conn) < 0)\n        return -1;\n\n    nwfilterDriverLock();\n    ret = virNWFilterObjListExport(conn, driver->nwfilters, nwfilters,\n                                   virConnectListAllNWFiltersCheckACL);\n    nwfilterDriverUnlock();\n\n    return ret;\n}"
  },
  {
    "function_name": "nwfilterConnectListNWFilters",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_driver.c",
    "lines": "525-541",
    "snippet": "static int\nnwfilterConnectListNWFilters(virConnectPtr conn,\n                             char **const names,\n                             int maxnames)\n{\n    int nnames;\n\n    if (virConnectListNWFiltersEnsureACL(conn) < 0)\n        return -1;\n\n    nwfilterDriverLock();\n    nnames = virNWFilterObjListGetNames(driver->nwfilters, conn,\n                                    virConnectListNWFiltersCheckACL,\n                                    names, maxnames);\n    nwfilterDriverUnlock();\n    return nnames;\n}",
    "includes": [
      "#include \"nwfilter_learnipaddr.h\"",
      "#include \"nwfilter_dhcpsnoop.h\"",
      "#include \"nwfilter_ipaddrmap.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"nwfilter_gentech_driver.h\"",
      "#include \"nwfilter_driver.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_conf.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include \"internal.h\"",
      "#include \"virlog.h\"",
      "#include \"virdbus.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virNWFilterDriverStatePtr driver;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "nwfilterDriverUnlock",
          "args": [],
          "line": 539
        },
        "resolved": true,
        "details": {
          "function_name": "nwfilterDriverUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_driver.c",
          "lines": "75-78",
          "snippet": "static void nwfilterDriverUnlock(void)\n{\n    virMutexUnlock(&driver->lock);\n}",
          "includes": [
            "#include \"nwfilter_learnipaddr.h\"",
            "#include \"nwfilter_dhcpsnoop.h\"",
            "#include \"nwfilter_ipaddrmap.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"configmake.h\"",
            "#include \"nwfilter_gentech_driver.h\"",
            "#include \"nwfilter_driver.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_conf.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"virlog.h\"",
            "#include \"virdbus.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virNWFilterDriverStatePtr driver;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"nwfilter_driver.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_conf.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"virlog.h\"\n#include \"virdbus.h\"\n#include <config.h>\n\nstatic virNWFilterDriverStatePtr driver;\n\nstatic void nwfilterDriverUnlock(void)\n{\n    virMutexUnlock(&driver->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterObjListGetNames",
          "args": [
            "driver->nwfilters",
            "conn",
            "virConnectListNWFiltersCheckACL",
            "names",
            "maxnames"
          ],
          "line": 536
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterObjListGetNames",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterobj.c",
          "lines": "408-431",
          "snippet": "int\nvirNWFilterObjListGetNames(virNWFilterObjListPtr nwfilters,\n                           virConnectPtr conn,\n                           virNWFilterObjListFilter filter,\n                           char **const names,\n                           int maxnames)\n{\n    int nnames = 0;\n    size_t i;\n    virNWFilterDefPtr def;\n\n    for (i = 0; i < nwfilters->count && nnames < maxnames; i++) {\n        virNWFilterObjPtr obj = nwfilters->objs[i];\n        virNWFilterObjLock(obj);\n        def = obj->def;\n        if (!filter || filter(conn, def)) {\n            names[nnames] = g_strdup(def->name);\n            nnames++;\n        }\n        virNWFilterObjUnlock(obj);\n    }\n\n    return nnames;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virnwfilterobj.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virnwfilterobj.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nint\nvirNWFilterObjListGetNames(virNWFilterObjListPtr nwfilters,\n                           virConnectPtr conn,\n                           virNWFilterObjListFilter filter,\n                           char **const names,\n                           int maxnames)\n{\n    int nnames = 0;\n    size_t i;\n    virNWFilterDefPtr def;\n\n    for (i = 0; i < nwfilters->count && nnames < maxnames; i++) {\n        virNWFilterObjPtr obj = nwfilters->objs[i];\n        virNWFilterObjLock(obj);\n        def = obj->def;\n        if (!filter || filter(conn, def)) {\n            names[nnames] = g_strdup(def->name);\n            nnames++;\n        }\n        virNWFilterObjUnlock(obj);\n    }\n\n    return nnames;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nwfilterDriverLock",
          "args": [],
          "line": 535
        },
        "resolved": true,
        "details": {
          "function_name": "nwfilterDriverLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_driver.c",
          "lines": "71-74",
          "snippet": "static void nwfilterDriverLock(void)\n{\n    virMutexLock(&driver->lock);\n}",
          "includes": [
            "#include \"nwfilter_learnipaddr.h\"",
            "#include \"nwfilter_dhcpsnoop.h\"",
            "#include \"nwfilter_ipaddrmap.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"configmake.h\"",
            "#include \"nwfilter_gentech_driver.h\"",
            "#include \"nwfilter_driver.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_conf.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"virlog.h\"",
            "#include \"virdbus.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virNWFilterDriverStatePtr driver;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"nwfilter_driver.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_conf.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"virlog.h\"\n#include \"virdbus.h\"\n#include <config.h>\n\nstatic virNWFilterDriverStatePtr driver;\n\nstatic void nwfilterDriverLock(void)\n{\n    virMutexLock(&driver->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virConnectListNWFiltersEnsureACL",
          "args": [
            "conn"
          ],
          "line": 532
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"nwfilter_driver.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_conf.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"virlog.h\"\n#include \"virdbus.h\"\n#include <config.h>\n\nstatic virNWFilterDriverStatePtr driver;\n\nstatic int\nnwfilterConnectListNWFilters(virConnectPtr conn,\n                             char **const names,\n                             int maxnames)\n{\n    int nnames;\n\n    if (virConnectListNWFiltersEnsureACL(conn) < 0)\n        return -1;\n\n    nwfilterDriverLock();\n    nnames = virNWFilterObjListGetNames(driver->nwfilters, conn,\n                                    virConnectListNWFiltersCheckACL,\n                                    names, maxnames);\n    nwfilterDriverUnlock();\n    return nnames;\n}"
  },
  {
    "function_name": "nwfilterConnectNumOfNWFilters",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_driver.c",
    "lines": "514-522",
    "snippet": "static int\nnwfilterConnectNumOfNWFilters(virConnectPtr conn)\n{\n    if (virConnectNumOfNWFiltersEnsureACL(conn) < 0)\n        return -1;\n\n    return virNWFilterObjListNumOfNWFilters(driver->nwfilters, conn,\n                                        virConnectNumOfNWFiltersCheckACL);\n}",
    "includes": [
      "#include \"nwfilter_learnipaddr.h\"",
      "#include \"nwfilter_dhcpsnoop.h\"",
      "#include \"nwfilter_ipaddrmap.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"nwfilter_gentech_driver.h\"",
      "#include \"nwfilter_driver.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_conf.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include \"internal.h\"",
      "#include \"virlog.h\"",
      "#include \"virdbus.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virNWFilterDriverStatePtr driver;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNWFilterObjListNumOfNWFilters",
          "args": [
            "driver->nwfilters",
            "conn",
            "virConnectNumOfNWFiltersCheckACL"
          ],
          "line": 520
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterObjListNumOfNWFilters",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterobj.c",
          "lines": "388-405",
          "snippet": "int\nvirNWFilterObjListNumOfNWFilters(virNWFilterObjListPtr nwfilters,\n                                 virConnectPtr conn,\n                                 virNWFilterObjListFilter filter)\n{\n    size_t i;\n    int nfilters = 0;\n\n    for (i = 0; i < nwfilters->count; i++) {\n        virNWFilterObjPtr obj = nwfilters->objs[i];\n        virNWFilterObjLock(obj);\n        if (!filter || filter(conn, obj->def))\n            nfilters++;\n        virNWFilterObjUnlock(obj);\n    }\n\n    return nfilters;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virnwfilterobj.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virnwfilterobj.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nint\nvirNWFilterObjListNumOfNWFilters(virNWFilterObjListPtr nwfilters,\n                                 virConnectPtr conn,\n                                 virNWFilterObjListFilter filter)\n{\n    size_t i;\n    int nfilters = 0;\n\n    for (i = 0; i < nwfilters->count; i++) {\n        virNWFilterObjPtr obj = nwfilters->objs[i];\n        virNWFilterObjLock(obj);\n        if (!filter || filter(conn, obj->def))\n            nfilters++;\n        virNWFilterObjUnlock(obj);\n    }\n\n    return nfilters;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virConnectNumOfNWFiltersEnsureACL",
          "args": [
            "conn"
          ],
          "line": 517
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"nwfilter_driver.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_conf.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"virlog.h\"\n#include \"virdbus.h\"\n#include <config.h>\n\nstatic virNWFilterDriverStatePtr driver;\n\nstatic int\nnwfilterConnectNumOfNWFilters(virConnectPtr conn)\n{\n    if (virConnectNumOfNWFiltersEnsureACL(conn) < 0)\n        return -1;\n\n    return virNWFilterObjListNumOfNWFilters(driver->nwfilters, conn,\n                                        virConnectNumOfNWFiltersCheckACL);\n}"
  },
  {
    "function_name": "nwfilterLookupByName",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_driver.c",
    "lines": "484-511",
    "snippet": "static virNWFilterPtr\nnwfilterLookupByName(virConnectPtr conn,\n                     const char *name)\n{\n    virNWFilterObjPtr obj;\n    virNWFilterDefPtr def;\n    virNWFilterPtr nwfilter = NULL;\n\n    nwfilterDriverLock();\n    obj = virNWFilterObjListFindByName(driver->nwfilters, name);\n    nwfilterDriverUnlock();\n\n    if (!obj) {\n        virReportError(VIR_ERR_NO_NWFILTER,\n                       _(\"no nwfilter with matching name '%s'\"), name);\n        return NULL;\n    }\n    def = virNWFilterObjGetDef(obj);\n\n    if (virNWFilterLookupByNameEnsureACL(conn, def) < 0)\n        goto cleanup;\n\n    nwfilter = virGetNWFilter(conn, def->name, def->uuid);\n\n cleanup:\n    virNWFilterObjUnlock(obj);\n    return nwfilter;\n}",
    "includes": [
      "#include \"nwfilter_learnipaddr.h\"",
      "#include \"nwfilter_dhcpsnoop.h\"",
      "#include \"nwfilter_ipaddrmap.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"nwfilter_gentech_driver.h\"",
      "#include \"nwfilter_driver.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_conf.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include \"internal.h\"",
      "#include \"virlog.h\"",
      "#include \"virdbus.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virNWFilterDriverStatePtr driver;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNWFilterObjUnlock",
          "args": [
            "obj"
          ],
          "line": 509
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterObjUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterobj.c",
          "lines": "561-565",
          "snippet": "void\nvirNWFilterObjUnlock(virNWFilterObjPtr obj)\n{\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virnwfilterobj.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virnwfilterobj.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvoid\nvirNWFilterObjUnlock(virNWFilterObjPtr obj)\n{\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virGetNWFilter",
          "args": [
            "conn",
            "def->name",
            "def->uuid"
          ],
          "line": 506
        },
        "resolved": true,
        "details": {
          "function_name": "virGetNWFilterBinding",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/datatypes.c",
          "lines": "904-930",
          "snippet": "virNWFilterBindingPtr\nvirGetNWFilterBinding(virConnectPtr conn, const char *portdev,\n                      const char *filtername)\n{\n    virNWFilterBindingPtr ret = NULL;\n\n    if (virDataTypesInitialize() < 0)\n        return NULL;\n\n    virCheckConnectGoto(conn, error);\n    virCheckNonNullArgGoto(portdev, error);\n\n    if (!(ret = virObjectNew(virNWFilterBindingClass)))\n        goto error;\n\n    ret->portdev = g_strdup(portdev);\n\n    ret->filtername = g_strdup(filtername);\n\n    ret->conn = virObjectRef(conn);\n\n    return ret;\n\n error:\n    virObjectUnref(ret);\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viruuid.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virClassPtr virNWFilterBindingClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viruuid.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <unistd.h>\n#include <config.h>\n\nvirClassPtr virNWFilterBindingClass;\n\nvirNWFilterBindingPtr\nvirGetNWFilterBinding(virConnectPtr conn, const char *portdev,\n                      const char *filtername)\n{\n    virNWFilterBindingPtr ret = NULL;\n\n    if (virDataTypesInitialize() < 0)\n        return NULL;\n\n    virCheckConnectGoto(conn, error);\n    virCheckNonNullArgGoto(portdev, error);\n\n    if (!(ret = virObjectNew(virNWFilterBindingClass)))\n        goto error;\n\n    ret->portdev = g_strdup(portdev);\n\n    ret->filtername = g_strdup(filtername);\n\n    ret->conn = virObjectRef(conn);\n\n    return ret;\n\n error:\n    virObjectUnref(ret);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterLookupByNameEnsureACL",
          "args": [
            "conn",
            "def"
          ],
          "line": 503
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNWFilterObjGetDef",
          "args": [
            "obj"
          ],
          "line": 501
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterObjGetDef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterobj.c",
          "lines": "71-75",
          "snippet": "virNWFilterDefPtr\nvirNWFilterObjGetDef(virNWFilterObjPtr obj)\n{\n    return obj->def;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virnwfilterobj.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virnwfilterobj.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvirNWFilterDefPtr\nvirNWFilterObjGetDef(virNWFilterObjPtr obj)\n{\n    return obj->def;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_NO_NWFILTER",
            "_(\"no nwfilter with matching name '%s'\")",
            "name"
          ],
          "line": 497
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"no nwfilter with matching name '%s'\""
          ],
          "line": 498
        },
        "resolved": true,
        "details": {
          "function_name": "_virNWFilterTeardownFilter",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_gentech_driver.c",
          "lines": "898-927",
          "snippet": "static int\n_virNWFilterTeardownFilter(const char *ifname)\n{\n    const char *drvname = EBIPTABLES_DRIVER_ID;\n    virNWFilterTechDriverPtr techdriver;\n    techdriver = virNWFilterTechDriverForName(drvname);\n\n    if (!techdriver) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Could not get access to ACL tech \"\n                         \"driver '%s'\"),\n                       drvname);\n        return -1;\n    }\n\n    virNWFilterDHCPSnoopEnd(ifname);\n\n    virNWFilterTerminateLearnReq(ifname);\n\n    if (virNWFilterLockIface(ifname) < 0)\n        return -1;\n\n    techdriver->allTeardown(ifname);\n\n    virNWFilterIPAddrMapDelIPAddr(ifname, NULL);\n\n    virNWFilterUnlockIface(ifname);\n\n    return 0;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"datatypes.h\"",
            "#include \"virnetdev.h\"",
            "#include \"nwfilter_learnipaddr.h\"",
            "#include \"nwfilter_ipaddrmap.h\"",
            "#include \"nwfilter_dhcpsnoop.h\"",
            "#include \"nwfilter_ebiptables_driver.h\"",
            "#include \"nwfilter_gentech_driver.h\"",
            "#include \"virerror.h\"",
            "#include \"domain_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int _virNWFilterTeardownFilter(const char *ifname);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virsocketaddr.h\"\n#include \"datatypes.h\"\n#include \"virnetdev.h\"\n#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ebiptables_driver.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"virerror.h\"\n#include \"domain_conf.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int _virNWFilterTeardownFilter(const char *ifname);\n\nstatic int\n_virNWFilterTeardownFilter(const char *ifname)\n{\n    const char *drvname = EBIPTABLES_DRIVER_ID;\n    virNWFilterTechDriverPtr techdriver;\n    techdriver = virNWFilterTechDriverForName(drvname);\n\n    if (!techdriver) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Could not get access to ACL tech \"\n                         \"driver '%s'\"),\n                       drvname);\n        return -1;\n    }\n\n    virNWFilterDHCPSnoopEnd(ifname);\n\n    virNWFilterTerminateLearnReq(ifname);\n\n    if (virNWFilterLockIface(ifname) < 0)\n        return -1;\n\n    techdriver->allTeardown(ifname);\n\n    virNWFilterIPAddrMapDelIPAddr(ifname, NULL);\n\n    virNWFilterUnlockIface(ifname);\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nwfilterDriverUnlock",
          "args": [],
          "line": 494
        },
        "resolved": true,
        "details": {
          "function_name": "nwfilterDriverUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_driver.c",
          "lines": "75-78",
          "snippet": "static void nwfilterDriverUnlock(void)\n{\n    virMutexUnlock(&driver->lock);\n}",
          "includes": [
            "#include \"nwfilter_learnipaddr.h\"",
            "#include \"nwfilter_dhcpsnoop.h\"",
            "#include \"nwfilter_ipaddrmap.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"configmake.h\"",
            "#include \"nwfilter_gentech_driver.h\"",
            "#include \"nwfilter_driver.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_conf.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"virlog.h\"",
            "#include \"virdbus.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virNWFilterDriverStatePtr driver;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"nwfilter_driver.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_conf.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"virlog.h\"\n#include \"virdbus.h\"\n#include <config.h>\n\nstatic virNWFilterDriverStatePtr driver;\n\nstatic void nwfilterDriverUnlock(void)\n{\n    virMutexUnlock(&driver->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterObjListFindByName",
          "args": [
            "driver->nwfilters",
            "name"
          ],
          "line": 493
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterObjListFindByName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterobj.c",
          "lines": "172-190",
          "snippet": "virNWFilterObjPtr\nvirNWFilterObjListFindByName(virNWFilterObjListPtr nwfilters,\n                             const char *name)\n{\n    size_t i;\n    virNWFilterObjPtr obj;\n    virNWFilterDefPtr def;\n\n    for (i = 0; i < nwfilters->count; i++) {\n        obj = nwfilters->objs[i];\n        virNWFilterObjLock(obj);\n        def = obj->def;\n        if (STREQ_NULLABLE(def->name, name))\n            return obj;\n        virNWFilterObjUnlock(obj);\n    }\n\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virnwfilterobj.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virnwfilterobj.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvirNWFilterObjPtr\nvirNWFilterObjListFindByName(virNWFilterObjListPtr nwfilters,\n                             const char *name)\n{\n    size_t i;\n    virNWFilterObjPtr obj;\n    virNWFilterDefPtr def;\n\n    for (i = 0; i < nwfilters->count; i++) {\n        obj = nwfilters->objs[i];\n        virNWFilterObjLock(obj);\n        def = obj->def;\n        if (STREQ_NULLABLE(def->name, name))\n            return obj;\n        virNWFilterObjUnlock(obj);\n    }\n\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nwfilterDriverLock",
          "args": [],
          "line": 492
        },
        "resolved": true,
        "details": {
          "function_name": "nwfilterDriverLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_driver.c",
          "lines": "71-74",
          "snippet": "static void nwfilterDriverLock(void)\n{\n    virMutexLock(&driver->lock);\n}",
          "includes": [
            "#include \"nwfilter_learnipaddr.h\"",
            "#include \"nwfilter_dhcpsnoop.h\"",
            "#include \"nwfilter_ipaddrmap.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"configmake.h\"",
            "#include \"nwfilter_gentech_driver.h\"",
            "#include \"nwfilter_driver.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_conf.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"virlog.h\"",
            "#include \"virdbus.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virNWFilterDriverStatePtr driver;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"nwfilter_driver.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_conf.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"virlog.h\"\n#include \"virdbus.h\"\n#include <config.h>\n\nstatic virNWFilterDriverStatePtr driver;\n\nstatic void nwfilterDriverLock(void)\n{\n    virMutexLock(&driver->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"nwfilter_driver.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_conf.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"virlog.h\"\n#include \"virdbus.h\"\n#include <config.h>\n\nstatic virNWFilterDriverStatePtr driver;\n\nstatic virNWFilterPtr\nnwfilterLookupByName(virConnectPtr conn,\n                     const char *name)\n{\n    virNWFilterObjPtr obj;\n    virNWFilterDefPtr def;\n    virNWFilterPtr nwfilter = NULL;\n\n    nwfilterDriverLock();\n    obj = virNWFilterObjListFindByName(driver->nwfilters, name);\n    nwfilterDriverUnlock();\n\n    if (!obj) {\n        virReportError(VIR_ERR_NO_NWFILTER,\n                       _(\"no nwfilter with matching name '%s'\"), name);\n        return NULL;\n    }\n    def = virNWFilterObjGetDef(obj);\n\n    if (virNWFilterLookupByNameEnsureACL(conn, def) < 0)\n        goto cleanup;\n\n    nwfilter = virGetNWFilter(conn, def->name, def->uuid);\n\n cleanup:\n    virNWFilterObjUnlock(obj);\n    return nwfilter;\n}"
  },
  {
    "function_name": "nwfilterLookupByUUID",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_driver.c",
    "lines": "457-481",
    "snippet": "static virNWFilterPtr\nnwfilterLookupByUUID(virConnectPtr conn,\n                     const unsigned char *uuid)\n{\n    virNWFilterObjPtr obj;\n    virNWFilterDefPtr def;\n    virNWFilterPtr nwfilter = NULL;\n\n    nwfilterDriverLock();\n    obj = nwfilterObjFromNWFilter(uuid);\n    nwfilterDriverUnlock();\n\n    if (!obj)\n        return NULL;\n    def = virNWFilterObjGetDef(obj);\n\n    if (virNWFilterLookupByUUIDEnsureACL(conn, def) < 0)\n        goto cleanup;\n\n    nwfilter = virGetNWFilter(conn, def->name, def->uuid);\n\n cleanup:\n    virNWFilterObjUnlock(obj);\n    return nwfilter;\n}",
    "includes": [
      "#include \"nwfilter_learnipaddr.h\"",
      "#include \"nwfilter_dhcpsnoop.h\"",
      "#include \"nwfilter_ipaddrmap.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"nwfilter_gentech_driver.h\"",
      "#include \"nwfilter_driver.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_conf.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include \"internal.h\"",
      "#include \"virlog.h\"",
      "#include \"virdbus.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNWFilterObjUnlock",
          "args": [
            "obj"
          ],
          "line": 479
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterObjUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterobj.c",
          "lines": "561-565",
          "snippet": "void\nvirNWFilterObjUnlock(virNWFilterObjPtr obj)\n{\n    virMutexUnlock(&obj->lock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virnwfilterobj.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virnwfilterobj.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvoid\nvirNWFilterObjUnlock(virNWFilterObjPtr obj)\n{\n    virMutexUnlock(&obj->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virGetNWFilter",
          "args": [
            "conn",
            "def->name",
            "def->uuid"
          ],
          "line": 476
        },
        "resolved": true,
        "details": {
          "function_name": "virGetNWFilterBinding",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/datatypes.c",
          "lines": "904-930",
          "snippet": "virNWFilterBindingPtr\nvirGetNWFilterBinding(virConnectPtr conn, const char *portdev,\n                      const char *filtername)\n{\n    virNWFilterBindingPtr ret = NULL;\n\n    if (virDataTypesInitialize() < 0)\n        return NULL;\n\n    virCheckConnectGoto(conn, error);\n    virCheckNonNullArgGoto(portdev, error);\n\n    if (!(ret = virObjectNew(virNWFilterBindingClass)))\n        goto error;\n\n    ret->portdev = g_strdup(portdev);\n\n    ret->filtername = g_strdup(filtername);\n\n    ret->conn = virObjectRef(conn);\n\n    return ret;\n\n error:\n    virObjectUnref(ret);\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viruuid.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "virClassPtr virNWFilterBindingClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viruuid.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include <unistd.h>\n#include <config.h>\n\nvirClassPtr virNWFilterBindingClass;\n\nvirNWFilterBindingPtr\nvirGetNWFilterBinding(virConnectPtr conn, const char *portdev,\n                      const char *filtername)\n{\n    virNWFilterBindingPtr ret = NULL;\n\n    if (virDataTypesInitialize() < 0)\n        return NULL;\n\n    virCheckConnectGoto(conn, error);\n    virCheckNonNullArgGoto(portdev, error);\n\n    if (!(ret = virObjectNew(virNWFilterBindingClass)))\n        goto error;\n\n    ret->portdev = g_strdup(portdev);\n\n    ret->filtername = g_strdup(filtername);\n\n    ret->conn = virObjectRef(conn);\n\n    return ret;\n\n error:\n    virObjectUnref(ret);\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterLookupByUUIDEnsureACL",
          "args": [
            "conn",
            "def"
          ],
          "line": 473
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNWFilterObjGetDef",
          "args": [
            "obj"
          ],
          "line": 471
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterObjGetDef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterobj.c",
          "lines": "71-75",
          "snippet": "virNWFilterDefPtr\nvirNWFilterObjGetDef(virNWFilterObjPtr obj)\n{\n    return obj->def;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virnwfilterobj.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virnwfilterobj.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvirNWFilterDefPtr\nvirNWFilterObjGetDef(virNWFilterObjPtr obj)\n{\n    return obj->def;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nwfilterDriverUnlock",
          "args": [],
          "line": 467
        },
        "resolved": true,
        "details": {
          "function_name": "nwfilterDriverUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_driver.c",
          "lines": "75-78",
          "snippet": "static void nwfilterDriverUnlock(void)\n{\n    virMutexUnlock(&driver->lock);\n}",
          "includes": [
            "#include \"nwfilter_learnipaddr.h\"",
            "#include \"nwfilter_dhcpsnoop.h\"",
            "#include \"nwfilter_ipaddrmap.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"configmake.h\"",
            "#include \"nwfilter_gentech_driver.h\"",
            "#include \"nwfilter_driver.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_conf.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"virlog.h\"",
            "#include \"virdbus.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virNWFilterDriverStatePtr driver;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"nwfilter_driver.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_conf.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"virlog.h\"\n#include \"virdbus.h\"\n#include <config.h>\n\nstatic virNWFilterDriverStatePtr driver;\n\nstatic void nwfilterDriverUnlock(void)\n{\n    virMutexUnlock(&driver->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nwfilterObjFromNWFilter",
          "args": [
            "uuid"
          ],
          "line": 466
        },
        "resolved": true,
        "details": {
          "function_name": "nwfilterObjFromNWFilter",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_driver.c",
          "lines": "442-454",
          "snippet": "static virNWFilterObjPtr\nnwfilterObjFromNWFilter(const unsigned char *uuid)\n{\n    virNWFilterObjPtr obj;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (!(obj = virNWFilterObjListFindByUUID(driver->nwfilters, uuid))) {\n        virUUIDFormat(uuid, uuidstr);\n        virReportError(VIR_ERR_NO_NWFILTER,\n                       _(\"no nwfilter with matching uuid '%s'\"), uuidstr);\n    }\n    return obj;\n}",
          "includes": [
            "#include \"nwfilter_learnipaddr.h\"",
            "#include \"nwfilter_dhcpsnoop.h\"",
            "#include \"nwfilter_ipaddrmap.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"configmake.h\"",
            "#include \"nwfilter_gentech_driver.h\"",
            "#include \"nwfilter_driver.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_conf.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"virlog.h\"",
            "#include \"virdbus.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virNWFilterDriverStatePtr driver;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"nwfilter_driver.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_conf.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"virlog.h\"\n#include \"virdbus.h\"\n#include <config.h>\n\nstatic virNWFilterDriverStatePtr driver;\n\nstatic virNWFilterObjPtr\nnwfilterObjFromNWFilter(const unsigned char *uuid)\n{\n    virNWFilterObjPtr obj;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (!(obj = virNWFilterObjListFindByUUID(driver->nwfilters, uuid))) {\n        virUUIDFormat(uuid, uuidstr);\n        virReportError(VIR_ERR_NO_NWFILTER,\n                       _(\"no nwfilter with matching uuid '%s'\"), uuidstr);\n    }\n    return obj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nwfilterDriverLock",
          "args": [],
          "line": 465
        },
        "resolved": true,
        "details": {
          "function_name": "nwfilterDriverLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_driver.c",
          "lines": "71-74",
          "snippet": "static void nwfilterDriverLock(void)\n{\n    virMutexLock(&driver->lock);\n}",
          "includes": [
            "#include \"nwfilter_learnipaddr.h\"",
            "#include \"nwfilter_dhcpsnoop.h\"",
            "#include \"nwfilter_ipaddrmap.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"configmake.h\"",
            "#include \"nwfilter_gentech_driver.h\"",
            "#include \"nwfilter_driver.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_conf.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"virlog.h\"",
            "#include \"virdbus.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virNWFilterDriverStatePtr driver;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"nwfilter_driver.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_conf.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"virlog.h\"\n#include \"virdbus.h\"\n#include <config.h>\n\nstatic virNWFilterDriverStatePtr driver;\n\nstatic void nwfilterDriverLock(void)\n{\n    virMutexLock(&driver->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"nwfilter_driver.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_conf.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"virlog.h\"\n#include \"virdbus.h\"\n#include <config.h>\n\nstatic virNWFilterPtr\nnwfilterLookupByUUID(virConnectPtr conn,\n                     const unsigned char *uuid)\n{\n    virNWFilterObjPtr obj;\n    virNWFilterDefPtr def;\n    virNWFilterPtr nwfilter = NULL;\n\n    nwfilterDriverLock();\n    obj = nwfilterObjFromNWFilter(uuid);\n    nwfilterDriverUnlock();\n\n    if (!obj)\n        return NULL;\n    def = virNWFilterObjGetDef(obj);\n\n    if (virNWFilterLookupByUUIDEnsureACL(conn, def) < 0)\n        goto cleanup;\n\n    nwfilter = virGetNWFilter(conn, def->name, def->uuid);\n\n cleanup:\n    virNWFilterObjUnlock(obj);\n    return nwfilter;\n}"
  },
  {
    "function_name": "nwfilterObjFromNWFilter",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_driver.c",
    "lines": "442-454",
    "snippet": "static virNWFilterObjPtr\nnwfilterObjFromNWFilter(const unsigned char *uuid)\n{\n    virNWFilterObjPtr obj;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (!(obj = virNWFilterObjListFindByUUID(driver->nwfilters, uuid))) {\n        virUUIDFormat(uuid, uuidstr);\n        virReportError(VIR_ERR_NO_NWFILTER,\n                       _(\"no nwfilter with matching uuid '%s'\"), uuidstr);\n    }\n    return obj;\n}",
    "includes": [
      "#include \"nwfilter_learnipaddr.h\"",
      "#include \"nwfilter_dhcpsnoop.h\"",
      "#include \"nwfilter_ipaddrmap.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"nwfilter_gentech_driver.h\"",
      "#include \"nwfilter_driver.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_conf.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include \"internal.h\"",
      "#include \"virlog.h\"",
      "#include \"virdbus.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virNWFilterDriverStatePtr driver;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_NO_NWFILTER",
            "_(\"no nwfilter with matching uuid '%s'\")",
            "uuidstr"
          ],
          "line": 450
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"no nwfilter with matching uuid '%s'\""
          ],
          "line": 451
        },
        "resolved": true,
        "details": {
          "function_name": "_virNWFilterTeardownFilter",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_gentech_driver.c",
          "lines": "898-927",
          "snippet": "static int\n_virNWFilterTeardownFilter(const char *ifname)\n{\n    const char *drvname = EBIPTABLES_DRIVER_ID;\n    virNWFilterTechDriverPtr techdriver;\n    techdriver = virNWFilterTechDriverForName(drvname);\n\n    if (!techdriver) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Could not get access to ACL tech \"\n                         \"driver '%s'\"),\n                       drvname);\n        return -1;\n    }\n\n    virNWFilterDHCPSnoopEnd(ifname);\n\n    virNWFilterTerminateLearnReq(ifname);\n\n    if (virNWFilterLockIface(ifname) < 0)\n        return -1;\n\n    techdriver->allTeardown(ifname);\n\n    virNWFilterIPAddrMapDelIPAddr(ifname, NULL);\n\n    virNWFilterUnlockIface(ifname);\n\n    return 0;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"datatypes.h\"",
            "#include \"virnetdev.h\"",
            "#include \"nwfilter_learnipaddr.h\"",
            "#include \"nwfilter_ipaddrmap.h\"",
            "#include \"nwfilter_dhcpsnoop.h\"",
            "#include \"nwfilter_ebiptables_driver.h\"",
            "#include \"nwfilter_gentech_driver.h\"",
            "#include \"virerror.h\"",
            "#include \"domain_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int _virNWFilterTeardownFilter(const char *ifname);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virsocketaddr.h\"\n#include \"datatypes.h\"\n#include \"virnetdev.h\"\n#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ebiptables_driver.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"virerror.h\"\n#include \"domain_conf.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int _virNWFilterTeardownFilter(const char *ifname);\n\nstatic int\n_virNWFilterTeardownFilter(const char *ifname)\n{\n    const char *drvname = EBIPTABLES_DRIVER_ID;\n    virNWFilterTechDriverPtr techdriver;\n    techdriver = virNWFilterTechDriverForName(drvname);\n\n    if (!techdriver) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Could not get access to ACL tech \"\n                         \"driver '%s'\"),\n                       drvname);\n        return -1;\n    }\n\n    virNWFilterDHCPSnoopEnd(ifname);\n\n    virNWFilterTerminateLearnReq(ifname);\n\n    if (virNWFilterLockIface(ifname) < 0)\n        return -1;\n\n    techdriver->allTeardown(ifname);\n\n    virNWFilterIPAddrMapDelIPAddr(ifname, NULL);\n\n    virNWFilterUnlockIface(ifname);\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virUUIDFormat",
          "args": [
            "uuid",
            "uuidstr"
          ],
          "line": 449
        },
        "resolved": true,
        "details": {
          "function_name": "virUUIDFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viruuid.c",
          "lines": "148-159",
          "snippet": "const char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}",
          "includes": [
            "#include \"virrandom.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include \"viruuid.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virrandom.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <unistd.h>\n#include <time.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include \"viruuid.h\"\n#include <config.h>\n\nconst char *\nvirUUIDFormat(const unsigned char *uuid, char *uuidstr)\n{\n    g_snprintf(uuidstr, VIR_UUID_STRING_BUFLEN,\n               \"%02x%02x%02x%02x-%02x%02x-%02x%02x-%02x%02x-%02x%02x%02x%02x%02x%02x\",\n               uuid[0], uuid[1], uuid[2], uuid[3],\n               uuid[4], uuid[5], uuid[6], uuid[7],\n               uuid[8], uuid[9], uuid[10], uuid[11],\n               uuid[12], uuid[13], uuid[14], uuid[15]);\n    uuidstr[VIR_UUID_STRING_BUFLEN-1] = '\\0';\n    return uuidstr;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterObjListFindByUUID",
          "args": [
            "driver->nwfilters",
            "uuid"
          ],
          "line": 448
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterObjListFindByUUID",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterobj.c",
          "lines": "151-169",
          "snippet": "virNWFilterObjPtr\nvirNWFilterObjListFindByUUID(virNWFilterObjListPtr nwfilters,\n                             const unsigned char *uuid)\n{\n    size_t i;\n    virNWFilterObjPtr obj;\n    virNWFilterDefPtr def;\n\n    for (i = 0; i < nwfilters->count; i++) {\n        obj = nwfilters->objs[i];\n        virNWFilterObjLock(obj);\n        def = obj->def;\n        if (!memcmp(def->uuid, uuid, VIR_UUID_BUFLEN))\n            return obj;\n        virNWFilterObjUnlock(obj);\n    }\n\n    return NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virnwfilterobj.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virnwfilterobj.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvirNWFilterObjPtr\nvirNWFilterObjListFindByUUID(virNWFilterObjListPtr nwfilters,\n                             const unsigned char *uuid)\n{\n    size_t i;\n    virNWFilterObjPtr obj;\n    virNWFilterDefPtr def;\n\n    for (i = 0; i < nwfilters->count; i++) {\n        obj = nwfilters->objs[i];\n        virNWFilterObjLock(obj);\n        def = obj->def;\n        if (!memcmp(def->uuid, uuid, VIR_UUID_BUFLEN))\n            return obj;\n        virNWFilterObjUnlock(obj);\n    }\n\n    return NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"nwfilter_driver.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_conf.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"virlog.h\"\n#include \"virdbus.h\"\n#include <config.h>\n\nstatic virNWFilterDriverStatePtr driver;\n\nstatic virNWFilterObjPtr\nnwfilterObjFromNWFilter(const unsigned char *uuid)\n{\n    virNWFilterObjPtr obj;\n    char uuidstr[VIR_UUID_STRING_BUFLEN];\n\n    if (!(obj = virNWFilterObjListFindByUUID(driver->nwfilters, uuid))) {\n        virUUIDFormat(uuid, uuidstr);\n        virReportError(VIR_ERR_NO_NWFILTER,\n                       _(\"no nwfilter with matching uuid '%s'\"), uuidstr);\n    }\n    return obj;\n}"
  },
  {
    "function_name": "nwfilterConnectIsAlive",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_driver.c",
    "lines": "436-439",
    "snippet": "static int nwfilterConnectIsAlive(virConnectPtr conn G_GNUC_UNUSED)\n{\n    return 1;\n}",
    "includes": [
      "#include \"nwfilter_learnipaddr.h\"",
      "#include \"nwfilter_dhcpsnoop.h\"",
      "#include \"nwfilter_ipaddrmap.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"nwfilter_gentech_driver.h\"",
      "#include \"nwfilter_driver.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_conf.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include \"internal.h\"",
      "#include \"virlog.h\"",
      "#include \"virdbus.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"nwfilter_driver.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_conf.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"virlog.h\"\n#include \"virdbus.h\"\n#include <config.h>\n\nstatic int nwfilterConnectIsAlive(virConnectPtr conn G_GNUC_UNUSED)\n{\n    return 1;\n}"
  },
  {
    "function_name": "nwfilterConnectIsEncrypted",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_driver.c",
    "lines": "429-433",
    "snippet": "static int nwfilterConnectIsEncrypted(virConnectPtr conn G_GNUC_UNUSED)\n{\n    /* Not encrypted, but remote driver takes care of that */\n    return 0;\n}",
    "includes": [
      "#include \"nwfilter_learnipaddr.h\"",
      "#include \"nwfilter_dhcpsnoop.h\"",
      "#include \"nwfilter_ipaddrmap.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"nwfilter_gentech_driver.h\"",
      "#include \"nwfilter_driver.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_conf.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include \"internal.h\"",
      "#include \"virlog.h\"",
      "#include \"virdbus.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virNWFilterDriverStatePtr driver;"
    ],
    "called_functions": [],
    "contextual_snippet": "#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"nwfilter_driver.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_conf.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"virlog.h\"\n#include \"virdbus.h\"\n#include <config.h>\n\nstatic virNWFilterDriverStatePtr driver;\n\nstatic int nwfilterConnectIsEncrypted(virConnectPtr conn G_GNUC_UNUSED)\n{\n    /* Not encrypted, but remote driver takes care of that */\n    return 0;\n}"
  },
  {
    "function_name": "nwfilterConnectIsSecure",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_driver.c",
    "lines": "422-426",
    "snippet": "static int nwfilterConnectIsSecure(virConnectPtr conn G_GNUC_UNUSED)\n{\n    /* Trivially secure, since always inside the daemon */\n    return 1;\n}",
    "includes": [
      "#include \"nwfilter_learnipaddr.h\"",
      "#include \"nwfilter_dhcpsnoop.h\"",
      "#include \"nwfilter_ipaddrmap.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"nwfilter_gentech_driver.h\"",
      "#include \"nwfilter_driver.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_conf.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include \"internal.h\"",
      "#include \"virlog.h\"",
      "#include \"virdbus.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"nwfilter_driver.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_conf.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"virlog.h\"\n#include \"virdbus.h\"\n#include <config.h>\n\nstatic int nwfilterConnectIsSecure(virConnectPtr conn G_GNUC_UNUSED)\n{\n    /* Trivially secure, since always inside the daemon */\n    return 1;\n}"
  },
  {
    "function_name": "nwfilterConnectClose",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_driver.c",
    "lines": "416-419",
    "snippet": "static int nwfilterConnectClose(virConnectPtr conn G_GNUC_UNUSED)\n{\n    return 0;\n}",
    "includes": [
      "#include \"nwfilter_learnipaddr.h\"",
      "#include \"nwfilter_dhcpsnoop.h\"",
      "#include \"nwfilter_ipaddrmap.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"nwfilter_gentech_driver.h\"",
      "#include \"nwfilter_driver.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_conf.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include \"internal.h\"",
      "#include \"virlog.h\"",
      "#include \"virdbus.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"nwfilter_driver.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_conf.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"virlog.h\"\n#include \"virdbus.h\"\n#include <config.h>\n\nstatic int nwfilterConnectClose(virConnectPtr conn G_GNUC_UNUSED)\n{\n    return 0;\n}"
  },
  {
    "function_name": "nwfilterConnectOpen",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_driver.c",
    "lines": "389-414",
    "snippet": "static virDrvOpenStatus\nnwfilterConnectOpen(virConnectPtr conn,\n                    virConnectAuthPtr auth G_GNUC_UNUSED,\n                    virConfPtr conf G_GNUC_UNUSED,\n                    unsigned int flags)\n{\n    virCheckFlags(VIR_CONNECT_RO, VIR_DRV_OPEN_ERROR);\n\n    if (driver == NULL) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"nwfilter state driver is not active\"));\n        return VIR_DRV_OPEN_ERROR;\n    }\n\n    if (STRNEQ(conn->uri->path, \"/system\")) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"unexpected nwfilter URI path '%s', try nwfilter:///system\"),\n                       conn->uri->path);\n        return VIR_DRV_OPEN_ERROR;\n    }\n\n    if (virConnectOpenEnsureACL(conn) < 0)\n        return VIR_DRV_OPEN_ERROR;\n\n    return VIR_DRV_OPEN_SUCCESS;\n}",
    "includes": [
      "#include \"nwfilter_learnipaddr.h\"",
      "#include \"nwfilter_dhcpsnoop.h\"",
      "#include \"nwfilter_ipaddrmap.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"nwfilter_gentech_driver.h\"",
      "#include \"nwfilter_driver.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_conf.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include \"internal.h\"",
      "#include \"virlog.h\"",
      "#include \"virdbus.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virNWFilterDriverStatePtr driver;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virConnectOpenEnsureACL",
          "args": [
            "conn"
          ],
          "line": 410
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"unexpected nwfilter URI path '%s', try nwfilter:///system\")",
            "conn->uri->path"
          ],
          "line": 404
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"unexpected nwfilter URI path '%s', try nwfilter:///system\""
          ],
          "line": 405
        },
        "resolved": true,
        "details": {
          "function_name": "_virNWFilterTeardownFilter",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_gentech_driver.c",
          "lines": "898-927",
          "snippet": "static int\n_virNWFilterTeardownFilter(const char *ifname)\n{\n    const char *drvname = EBIPTABLES_DRIVER_ID;\n    virNWFilterTechDriverPtr techdriver;\n    techdriver = virNWFilterTechDriverForName(drvname);\n\n    if (!techdriver) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Could not get access to ACL tech \"\n                         \"driver '%s'\"),\n                       drvname);\n        return -1;\n    }\n\n    virNWFilterDHCPSnoopEnd(ifname);\n\n    virNWFilterTerminateLearnReq(ifname);\n\n    if (virNWFilterLockIface(ifname) < 0)\n        return -1;\n\n    techdriver->allTeardown(ifname);\n\n    virNWFilterIPAddrMapDelIPAddr(ifname, NULL);\n\n    virNWFilterUnlockIface(ifname);\n\n    return 0;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"datatypes.h\"",
            "#include \"virnetdev.h\"",
            "#include \"nwfilter_learnipaddr.h\"",
            "#include \"nwfilter_ipaddrmap.h\"",
            "#include \"nwfilter_dhcpsnoop.h\"",
            "#include \"nwfilter_ebiptables_driver.h\"",
            "#include \"nwfilter_gentech_driver.h\"",
            "#include \"virerror.h\"",
            "#include \"domain_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int _virNWFilterTeardownFilter(const char *ifname);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virsocketaddr.h\"\n#include \"datatypes.h\"\n#include \"virnetdev.h\"\n#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ebiptables_driver.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"virerror.h\"\n#include \"domain_conf.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int _virNWFilterTeardownFilter(const char *ifname);\n\nstatic int\n_virNWFilterTeardownFilter(const char *ifname)\n{\n    const char *drvname = EBIPTABLES_DRIVER_ID;\n    virNWFilterTechDriverPtr techdriver;\n    techdriver = virNWFilterTechDriverForName(drvname);\n\n    if (!techdriver) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Could not get access to ACL tech \"\n                         \"driver '%s'\"),\n                       drvname);\n        return -1;\n    }\n\n    virNWFilterDHCPSnoopEnd(ifname);\n\n    virNWFilterTerminateLearnReq(ifname);\n\n    if (virNWFilterLockIface(ifname) < 0)\n        return -1;\n\n    techdriver->allTeardown(ifname);\n\n    virNWFilterIPAddrMapDelIPAddr(ifname, NULL);\n\n    virNWFilterUnlockIface(ifname);\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "STRNEQ",
          "args": [
            "conn->uri->path",
            "\"/system\""
          ],
          "line": 403
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"nwfilter state driver is not active\")"
          ],
          "line": 398
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCheckFlags",
          "args": [
            "VIR_CONNECT_RO",
            "VIR_DRV_OPEN_ERROR"
          ],
          "line": 395
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"nwfilter_driver.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_conf.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"virlog.h\"\n#include \"virdbus.h\"\n#include <config.h>\n\nstatic virNWFilterDriverStatePtr driver;\n\nstatic virDrvOpenStatus\nnwfilterConnectOpen(virConnectPtr conn,\n                    virConnectAuthPtr auth G_GNUC_UNUSED,\n                    virConfPtr conf G_GNUC_UNUSED,\n                    unsigned int flags)\n{\n    virCheckFlags(VIR_CONNECT_RO, VIR_DRV_OPEN_ERROR);\n\n    if (driver == NULL) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"nwfilter state driver is not active\"));\n        return VIR_DRV_OPEN_ERROR;\n    }\n\n    if (STRNEQ(conn->uri->path, \"/system\")) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"unexpected nwfilter URI path '%s', try nwfilter:///system\"),\n                       conn->uri->path);\n        return VIR_DRV_OPEN_ERROR;\n    }\n\n    if (virConnectOpenEnsureACL(conn) < 0)\n        return VIR_DRV_OPEN_ERROR;\n\n    return VIR_DRV_OPEN_SUCCESS;\n}"
  },
  {
    "function_name": "nwfilterStateCleanup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_driver.c",
    "lines": "351-386",
    "snippet": "static int\nnwfilterStateCleanup(void)\n{\n    if (!driver)\n        return -1;\n\n    if (driver->privileged) {\n        virNWFilterConfLayerShutdown();\n        virNWFilterDHCPSnoopShutdown();\n        virNWFilterLearnShutdown();\n        virNWFilterIPAddrMapShutdown();\n        virNWFilterTechDriversShutdown();\n\n        nwfilterDriverLock();\n\n        nwfilterDriverRemoveDBusMatches();\n\n        if (driver->lockFD != -1)\n            virPidFileRelease(driver->stateDir, \"driver\", driver->lockFD);\n\n        VIR_FREE(driver->stateDir);\n        VIR_FREE(driver->configDir);\n        VIR_FREE(driver->bindingDir);\n        nwfilterDriverUnlock();\n    }\n\n    virObjectUnref(driver->bindings);\n\n    /* free inactive nwfilters */\n    virNWFilterObjListFree(driver->nwfilters);\n\n    virMutexDestroy(&driver->lock);\n    VIR_FREE(driver);\n\n    return 0;\n}",
    "includes": [
      "#include \"nwfilter_learnipaddr.h\"",
      "#include \"nwfilter_dhcpsnoop.h\"",
      "#include \"nwfilter_ipaddrmap.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"nwfilter_gentech_driver.h\"",
      "#include \"nwfilter_driver.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_conf.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include \"internal.h\"",
      "#include \"virlog.h\"",
      "#include \"virdbus.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virNWFilterDriverStatePtr driver;",
      "static int nwfilterStateCleanup(void);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "driver"
          ],
          "line": 383
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virMutexDestroy",
          "args": [
            "&driver->lock"
          ],
          "line": 382
        },
        "resolved": true,
        "details": {
          "function_name": "virMutexDestroy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virthread.c",
          "lines": "76-79",
          "snippet": "void virMutexDestroy(virMutexPtr m)\n{\n    pthread_mutex_destroy(&m->lock);\n}",
          "includes": [
            "#include \"virthreadjob.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/syscall.h>",
            "#include <inttypes.h>",
            "#include <unistd.h>",
            "# include <pthread_np.h>",
            "#include \"virthread.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthreadjob.h\"\n#include \"viralloc.h\"\n# include <sys/syscall.h>\n#include <inttypes.h>\n#include <unistd.h>\n# include <pthread_np.h>\n#include \"virthread.h\"\n#include <config.h>\n\nvoid virMutexDestroy(virMutexPtr m)\n{\n    pthread_mutex_destroy(&m->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterObjListFree",
          "args": [
            "driver->nwfilters"
          ],
          "line": 380
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterObjListFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterobj.c",
          "lines": "107-115",
          "snippet": "void\nvirNWFilterObjListFree(virNWFilterObjListPtr nwfilters)\n{\n    size_t i;\n    for (i = 0; i < nwfilters->count; i++)\n        virNWFilterObjFree(nwfilters->objs[i]);\n    VIR_FREE(nwfilters->objs);\n    VIR_FREE(nwfilters);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virnwfilterobj.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virnwfilterobj.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvoid\nvirNWFilterObjListFree(virNWFilterObjListPtr nwfilters)\n{\n    size_t i;\n    for (i = 0; i < nwfilters->count; i++)\n        virNWFilterObjFree(nwfilters->objs[i]);\n    VIR_FREE(nwfilters->objs);\n    VIR_FREE(nwfilters);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "driver->bindings"
          ],
          "line": 377
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nwfilterDriverUnlock",
          "args": [],
          "line": 374
        },
        "resolved": true,
        "details": {
          "function_name": "nwfilterDriverUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_driver.c",
          "lines": "75-78",
          "snippet": "static void nwfilterDriverUnlock(void)\n{\n    virMutexUnlock(&driver->lock);\n}",
          "includes": [
            "#include \"nwfilter_learnipaddr.h\"",
            "#include \"nwfilter_dhcpsnoop.h\"",
            "#include \"nwfilter_ipaddrmap.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"configmake.h\"",
            "#include \"nwfilter_gentech_driver.h\"",
            "#include \"nwfilter_driver.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_conf.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"virlog.h\"",
            "#include \"virdbus.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virNWFilterDriverStatePtr driver;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"nwfilter_driver.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_conf.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"virlog.h\"\n#include \"virdbus.h\"\n#include <config.h>\n\nstatic virNWFilterDriverStatePtr driver;\n\nstatic void nwfilterDriverUnlock(void)\n{\n    virMutexUnlock(&driver->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "driver->bindingDir"
          ],
          "line": 373
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "driver->configDir"
          ],
          "line": 372
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "driver->stateDir"
          ],
          "line": 371
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virPidFileRelease",
          "args": [
            "driver->stateDir",
            "\"driver\"",
            "driver->lockFD"
          ],
          "line": 369
        },
        "resolved": true,
        "details": {
          "function_name": "virPidFileRelease",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virpidfile.c",
          "lines": "453-466",
          "snippet": "int virPidFileRelease(const char *dir,\n                      const char *name,\n                      int fd)\n{\n    g_autofree char *pidfile = NULL;\n\n    if (name == NULL || dir == NULL)\n        return -EINVAL;\n\n    if (!(pidfile = virPidFileBuildPath(dir, name)))\n        return -ENOMEM;\n\n    return virPidFileReleasePath(pidfile, fd);\n}",
          "includes": [
            "#include \"virprocess.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"viralloc.h\"",
            "#include \"virfile.h\"",
            "#include \"virpidfile.h\"",
            "#include <sys/stat.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virprocess.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virfile.h\"\n#include \"virpidfile.h\"\n#include <sys/stat.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <config.h>\n\nint virPidFileRelease(const char *dir,\n                      const char *name,\n                      int fd)\n{\n    g_autofree char *pidfile = NULL;\n\n    if (name == NULL || dir == NULL)\n        return -EINVAL;\n\n    if (!(pidfile = virPidFileBuildPath(dir, name)))\n        return -ENOMEM;\n\n    return virPidFileReleasePath(pidfile, fd);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nwfilterDriverRemoveDBusMatches",
          "args": [],
          "line": 366
        },
        "resolved": true,
        "details": {
          "function_name": "nwfilterDriverRemoveDBusMatches",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_driver.c",
          "lines": "151-154",
          "snippet": "static void\nnwfilterDriverRemoveDBusMatches(void)\n{\n}",
          "includes": [
            "#include \"nwfilter_learnipaddr.h\"",
            "#include \"nwfilter_dhcpsnoop.h\"",
            "#include \"nwfilter_ipaddrmap.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"configmake.h\"",
            "#include \"nwfilter_gentech_driver.h\"",
            "#include \"nwfilter_driver.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_conf.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"virlog.h\"",
            "#include \"virdbus.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"nwfilter_driver.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_conf.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"virlog.h\"\n#include \"virdbus.h\"\n#include <config.h>\n\nstatic void\nnwfilterDriverRemoveDBusMatches(void)\n{\n}"
        }
      },
      {
        "call_info": {
          "callee": "nwfilterDriverLock",
          "args": [],
          "line": 364
        },
        "resolved": true,
        "details": {
          "function_name": "nwfilterDriverLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_driver.c",
          "lines": "71-74",
          "snippet": "static void nwfilterDriverLock(void)\n{\n    virMutexLock(&driver->lock);\n}",
          "includes": [
            "#include \"nwfilter_learnipaddr.h\"",
            "#include \"nwfilter_dhcpsnoop.h\"",
            "#include \"nwfilter_ipaddrmap.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"configmake.h\"",
            "#include \"nwfilter_gentech_driver.h\"",
            "#include \"nwfilter_driver.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_conf.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"virlog.h\"",
            "#include \"virdbus.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virNWFilterDriverStatePtr driver;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"nwfilter_driver.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_conf.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"virlog.h\"\n#include \"virdbus.h\"\n#include <config.h>\n\nstatic virNWFilterDriverStatePtr driver;\n\nstatic void nwfilterDriverLock(void)\n{\n    virMutexLock(&driver->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterTechDriversShutdown",
          "args": [],
          "line": 362
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterTechDriversShutdown",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_gentech_driver.c",
          "lines": "90-99",
          "snippet": "void virNWFilterTechDriversShutdown(void)\n{\n    size_t i = 0;\n    while (filter_tech_drivers[i]) {\n        if ((filter_tech_drivers[i]->flags & TECHDRV_FLAG_INITIALIZED))\n            filter_tech_drivers[i]->shutdown();\n        i++;\n    }\n    virMutexDestroy(&updateMutex);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"datatypes.h\"",
            "#include \"virnetdev.h\"",
            "#include \"nwfilter_learnipaddr.h\"",
            "#include \"nwfilter_ipaddrmap.h\"",
            "#include \"nwfilter_dhcpsnoop.h\"",
            "#include \"nwfilter_ebiptables_driver.h\"",
            "#include \"nwfilter_gentech_driver.h\"",
            "#include \"virerror.h\"",
            "#include \"domain_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virNWFilterTechDriverPtr filter_tech_drivers[] = {\n    &ebiptables_driver,\n    NULL\n};",
            "static virMutex updateMutex;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virsocketaddr.h\"\n#include \"datatypes.h\"\n#include \"virnetdev.h\"\n#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ebiptables_driver.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"virerror.h\"\n#include \"domain_conf.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic virNWFilterTechDriverPtr filter_tech_drivers[] = {\n    &ebiptables_driver,\n    NULL\n};\nstatic virMutex updateMutex;\n\nvoid virNWFilterTechDriversShutdown(void)\n{\n    size_t i = 0;\n    while (filter_tech_drivers[i]) {\n        if ((filter_tech_drivers[i]->flags & TECHDRV_FLAG_INITIALIZED))\n            filter_tech_drivers[i]->shutdown();\n        i++;\n    }\n    virMutexDestroy(&updateMutex);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterIPAddrMapShutdown",
          "args": [],
          "line": 361
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterIPAddrMapShutdown",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_ipaddrmap.c",
          "lines": "159-164",
          "snippet": "void\nvirNWFilterIPAddrMapShutdown(void)\n{\n    virHashFree(ipAddressMap);\n    ipAddressMap = NULL;\n}",
          "includes": [
            "#include \"nwfilter_ipaddrmap.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"datatypes.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virHashTablePtr ipAddressMap;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nwfilter_ipaddrmap.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic virHashTablePtr ipAddressMap;\n\nvoid\nvirNWFilterIPAddrMapShutdown(void)\n{\n    virHashFree(ipAddressMap);\n    ipAddressMap = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterLearnShutdown",
          "args": [],
          "line": 360
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterLearnShutdown",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_learnipaddr.c",
          "lines": "815-828",
          "snippet": "void\nvirNWFilterLearnShutdown(void)\n{\n    if (!pendingLearnReq)\n        return;\n\n    virNWFilterLearnThreadsTerminate(false);\n\n    virHashFree(pendingLearnReq);\n    pendingLearnReq = NULL;\n\n    virHashFree(ifaceLockMap);\n    ifaceLockMap = NULL;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virstring.h\"",
            "#include \"nwfilter_learnipaddr.h\"",
            "#include \"nwfilter_ipaddrmap.h\"",
            "#include \"nwfilter_ebiptables_driver.h\"",
            "#include \"nwfilter_gentech_driver.h\"",
            "#include \"conf/domain_conf.h\"",
            "#include \"conf/nwfilter_params.h\"",
            "#include \"virthread.h\"",
            "#include \"virerror.h\"",
            "#include \"virnetdev.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"internal.h\"",
            "#include <net/if_arp.h>",
            "#include <net/ethernet.h>",
            "#include <poll.h>",
            "#include <sys/ioctl.h>",
            "#include <fcntl.h>",
            "# include <pcap.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virHashTablePtr pendingLearnReq;",
            "static virHashTablePtr ifaceLockMap;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virstring.h\"\n#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"nwfilter_ebiptables_driver.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"conf/domain_conf.h\"\n#include \"conf/nwfilter_params.h\"\n#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"virnetdev.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"internal.h\"\n#include <net/if_arp.h>\n#include <net/ethernet.h>\n#include <poll.h>\n#include <sys/ioctl.h>\n#include <fcntl.h>\n# include <pcap.h>\n#include <config.h>\n\nstatic virHashTablePtr pendingLearnReq;\nstatic virHashTablePtr ifaceLockMap;\n\nvoid\nvirNWFilterLearnShutdown(void)\n{\n    if (!pendingLearnReq)\n        return;\n\n    virNWFilterLearnThreadsTerminate(false);\n\n    virHashFree(pendingLearnReq);\n    pendingLearnReq = NULL;\n\n    virHashFree(ifaceLockMap);\n    ifaceLockMap = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterDHCPSnoopShutdown",
          "args": [],
          "line": 359
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterDHCPSnoopShutdown",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_dhcpsnoop.c",
          "lines": "2174-2178",
          "snippet": "void\nvirNWFilterDHCPSnoopShutdown(void)\n{\n    return;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virtime.h\"",
            "#include \"configmake.h\"",
            "#include \"virthreadpool.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"virfile.h\"",
            "#include \"virnetdev.h\"",
            "#include \"nwfilter_ipaddrmap.h\"",
            "#include \"nwfilter_dhcpsnoop.h\"",
            "#include \"nwfilter_gentech_driver.h\"",
            "#include \"conf/domain_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include <net/if.h>",
            "#include <poll.h>",
            "#include <fcntl.h>",
            "# include <pcap.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"configmake.h\"\n#include \"virthreadpool.h\"\n#include \"virsocketaddr.h\"\n#include \"virfile.h\"\n#include \"virnetdev.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"conf/domain_conf.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include <net/if.h>\n#include <poll.h>\n#include <fcntl.h>\n# include <pcap.h>\n#include <config.h>\n\nvoid\nvirNWFilterDHCPSnoopShutdown(void)\n{\n    return;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterConfLayerShutdown",
          "args": [],
          "line": 358
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterConfLayerShutdown",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_conf.c",
          "lines": "3100-3111",
          "snippet": "void\nvirNWFilterConfLayerShutdown(void)\n{\n    if (!initialized)\n        return;\n\n    virRWLockDestroy(&updateLock);\n\n    initialized = false;\n    rebuildCallback = NULL;\n    rebuildOpaque = NULL;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"domain_conf.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"viruuid.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "# include <net/ethernet.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virRWLock updateLock;",
            "static bool initialized;",
            "static virNWFilterTriggerRebuildCallback rebuildCallback;",
            "static void *rebuildOpaque;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"viruuid.h\"\n#include \"internal.h\"\n#include <unistd.h>\n# include <net/ethernet.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic virRWLock updateLock;\nstatic bool initialized;\nstatic virNWFilterTriggerRebuildCallback rebuildCallback;\nstatic void *rebuildOpaque;\n\nvoid\nvirNWFilterConfLayerShutdown(void)\n{\n    if (!initialized)\n        return;\n\n    virRWLockDestroy(&updateLock);\n\n    initialized = false;\n    rebuildCallback = NULL;\n    rebuildOpaque = NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"nwfilter_driver.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_conf.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"virlog.h\"\n#include \"virdbus.h\"\n#include <config.h>\n\nstatic virNWFilterDriverStatePtr driver;\nstatic int nwfilterStateCleanup(void);\n\nstatic int\nnwfilterStateCleanup(void)\n{\n    if (!driver)\n        return -1;\n\n    if (driver->privileged) {\n        virNWFilterConfLayerShutdown();\n        virNWFilterDHCPSnoopShutdown();\n        virNWFilterLearnShutdown();\n        virNWFilterIPAddrMapShutdown();\n        virNWFilterTechDriversShutdown();\n\n        nwfilterDriverLock();\n\n        nwfilterDriverRemoveDBusMatches();\n\n        if (driver->lockFD != -1)\n            virPidFileRelease(driver->stateDir, \"driver\", driver->lockFD);\n\n        VIR_FREE(driver->stateDir);\n        VIR_FREE(driver->configDir);\n        VIR_FREE(driver->bindingDir);\n        nwfilterDriverUnlock();\n    }\n\n    virObjectUnref(driver->bindings);\n\n    /* free inactive nwfilters */\n    virNWFilterObjListFree(driver->nwfilters);\n\n    virMutexDestroy(&driver->lock);\n    VIR_FREE(driver);\n\n    return 0;\n}"
  },
  {
    "function_name": "nwfilterStateReload",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_driver.c",
    "lines": "318-343",
    "snippet": "static int\nnwfilterStateReload(void)\n{\n    if (!driver)\n        return -1;\n\n    if (!driver->privileged)\n        return 0;\n\n    virNWFilterDHCPSnoopEnd(NULL);\n    /* shut down all threads -- they will be restarted if necessary */\n    virNWFilterLearnThreadsTerminate(true);\n\n    nwfilterDriverLock();\n    virNWFilterWriteLockFilterUpdates();\n\n    virNWFilterObjListLoadAllConfigs(driver->nwfilters, driver->configDir);\n\n    virNWFilterUnlockFilterUpdates();\n\n    virNWFilterBuildAll(driver, false);\n\n    nwfilterDriverUnlock();\n\n    return 0;\n}",
    "includes": [
      "#include \"nwfilter_learnipaddr.h\"",
      "#include \"nwfilter_dhcpsnoop.h\"",
      "#include \"nwfilter_ipaddrmap.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"nwfilter_gentech_driver.h\"",
      "#include \"nwfilter_driver.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_conf.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include \"internal.h\"",
      "#include \"virlog.h\"",
      "#include \"virdbus.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virNWFilterDriverStatePtr driver;",
      "static int nwfilterStateReload(void);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "nwfilterDriverUnlock",
          "args": [],
          "line": 340
        },
        "resolved": true,
        "details": {
          "function_name": "nwfilterDriverUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_driver.c",
          "lines": "75-78",
          "snippet": "static void nwfilterDriverUnlock(void)\n{\n    virMutexUnlock(&driver->lock);\n}",
          "includes": [
            "#include \"nwfilter_learnipaddr.h\"",
            "#include \"nwfilter_dhcpsnoop.h\"",
            "#include \"nwfilter_ipaddrmap.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"configmake.h\"",
            "#include \"nwfilter_gentech_driver.h\"",
            "#include \"nwfilter_driver.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_conf.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"virlog.h\"",
            "#include \"virdbus.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virNWFilterDriverStatePtr driver;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"nwfilter_driver.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_conf.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"virlog.h\"\n#include \"virdbus.h\"\n#include <config.h>\n\nstatic virNWFilterDriverStatePtr driver;\n\nstatic void nwfilterDriverUnlock(void)\n{\n    virMutexUnlock(&driver->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterBuildAll",
          "args": [
            "driver",
            "false"
          ],
          "line": 338
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterBuildAll",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_gentech_driver.c",
          "lines": "1006-1048",
          "snippet": "int\nvirNWFilterBuildAll(virNWFilterDriverStatePtr driver,\n                    bool newFilters)\n{\n    struct virNWFilterBuildData data = {\n        .driver = driver,\n    };\n    int ret = 0;\n\n    VIR_DEBUG(\"Build all filters newFilters=%d\", newFilters);\n\n    if (newFilters) {\n        if (!(data.skipInterfaces = virHashCreate(0, NULL)))\n            return -1;\n\n        data.step = STEP_APPLY_NEW;\n        if (virNWFilterBindingObjListForEach(driver->bindings,\n                                             virNWFilterBuildIter,\n                                             &data) < 0)\n            ret = -1;\n\n        if (ret == -1) {\n            data.step = STEP_ROLLBACK;\n            virNWFilterBindingObjListForEach(driver->bindings,\n                                             virNWFilterBuildIter,\n                                             &data);\n        } else  {\n            data.step = STEP_SWITCH;\n            virNWFilterBindingObjListForEach(driver->bindings,\n                                             virNWFilterBuildIter,\n                                             &data);\n        }\n\n        virHashFree(data.skipInterfaces);\n    } else {\n        data.step = STEP_APPLY_CURRENT;\n        if (virNWFilterBindingObjListForEach(driver->bindings,\n                                             virNWFilterBuildIter,\n                                             &data) < 0)\n            ret = -1;\n    }\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"datatypes.h\"",
            "#include \"virnetdev.h\"",
            "#include \"nwfilter_learnipaddr.h\"",
            "#include \"nwfilter_ipaddrmap.h\"",
            "#include \"nwfilter_dhcpsnoop.h\"",
            "#include \"nwfilter_ebiptables_driver.h\"",
            "#include \"nwfilter_gentech_driver.h\"",
            "#include \"virerror.h\"",
            "#include \"domain_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virsocketaddr.h\"\n#include \"datatypes.h\"\n#include \"virnetdev.h\"\n#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ebiptables_driver.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"virerror.h\"\n#include \"domain_conf.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirNWFilterBuildAll(virNWFilterDriverStatePtr driver,\n                    bool newFilters)\n{\n    struct virNWFilterBuildData data = {\n        .driver = driver,\n    };\n    int ret = 0;\n\n    VIR_DEBUG(\"Build all filters newFilters=%d\", newFilters);\n\n    if (newFilters) {\n        if (!(data.skipInterfaces = virHashCreate(0, NULL)))\n            return -1;\n\n        data.step = STEP_APPLY_NEW;\n        if (virNWFilterBindingObjListForEach(driver->bindings,\n                                             virNWFilterBuildIter,\n                                             &data) < 0)\n            ret = -1;\n\n        if (ret == -1) {\n            data.step = STEP_ROLLBACK;\n            virNWFilterBindingObjListForEach(driver->bindings,\n                                             virNWFilterBuildIter,\n                                             &data);\n        } else  {\n            data.step = STEP_SWITCH;\n            virNWFilterBindingObjListForEach(driver->bindings,\n                                             virNWFilterBuildIter,\n                                             &data);\n        }\n\n        virHashFree(data.skipInterfaces);\n    } else {\n        data.step = STEP_APPLY_CURRENT;\n        if (virNWFilterBindingObjListForEach(driver->bindings,\n                                             virNWFilterBuildIter,\n                                             &data) < 0)\n            ret = -1;\n    }\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterUnlockFilterUpdates",
          "args": [],
          "line": 336
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterUnlockFilterUpdates",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_conf.c",
          "lines": "174-178",
          "snippet": "void\nvirNWFilterUnlockFilterUpdates(void)\n{\n    virRWLockUnlock(&updateLock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"domain_conf.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"viruuid.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "# include <net/ethernet.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virRWLock updateLock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"viruuid.h\"\n#include \"internal.h\"\n#include <unistd.h>\n# include <net/ethernet.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic virRWLock updateLock;\n\nvoid\nvirNWFilterUnlockFilterUpdates(void)\n{\n    virRWLockUnlock(&updateLock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterObjListLoadAllConfigs",
          "args": [
            "driver->nwfilters",
            "driver->configDir"
          ],
          "line": 334
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterObjListLoadAllConfigs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterobj.c",
          "lines": "526-551",
          "snippet": "int\nvirNWFilterObjListLoadAllConfigs(virNWFilterObjListPtr nwfilters,\n                                 const char *configDir)\n{\n    DIR *dir;\n    struct dirent *entry;\n    int ret = -1;\n    int rc;\n\n    if ((rc = virDirOpenIfExists(&dir, configDir)) <= 0)\n        return rc;\n\n    while ((ret = virDirRead(dir, &entry, configDir)) > 0) {\n        virNWFilterObjPtr obj;\n\n        if (!virStringStripSuffix(entry->d_name, \".xml\"))\n            continue;\n\n        obj = virNWFilterObjListLoadConfig(nwfilters, configDir, entry->d_name);\n        if (obj)\n            virNWFilterObjUnlock(obj);\n    }\n\n    VIR_DIR_CLOSE(dir);\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virnwfilterobj.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virnwfilterobj.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nint\nvirNWFilterObjListLoadAllConfigs(virNWFilterObjListPtr nwfilters,\n                                 const char *configDir)\n{\n    DIR *dir;\n    struct dirent *entry;\n    int ret = -1;\n    int rc;\n\n    if ((rc = virDirOpenIfExists(&dir, configDir)) <= 0)\n        return rc;\n\n    while ((ret = virDirRead(dir, &entry, configDir)) > 0) {\n        virNWFilterObjPtr obj;\n\n        if (!virStringStripSuffix(entry->d_name, \".xml\"))\n            continue;\n\n        obj = virNWFilterObjListLoadConfig(nwfilters, configDir, entry->d_name);\n        if (obj)\n            virNWFilterObjUnlock(obj);\n    }\n\n    VIR_DIR_CLOSE(dir);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterWriteLockFilterUpdates",
          "args": [],
          "line": 332
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterWriteLockFilterUpdates",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_conf.c",
          "lines": "167-171",
          "snippet": "void\nvirNWFilterWriteLockFilterUpdates(void)\n{\n    virRWLockWrite(&updateLock);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"domain_conf.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"viruuid.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "# include <net/ethernet.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virRWLock updateLock;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"viruuid.h\"\n#include \"internal.h\"\n#include <unistd.h>\n# include <net/ethernet.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic virRWLock updateLock;\n\nvoid\nvirNWFilterWriteLockFilterUpdates(void)\n{\n    virRWLockWrite(&updateLock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nwfilterDriverLock",
          "args": [],
          "line": 331
        },
        "resolved": true,
        "details": {
          "function_name": "nwfilterDriverLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_driver.c",
          "lines": "71-74",
          "snippet": "static void nwfilterDriverLock(void)\n{\n    virMutexLock(&driver->lock);\n}",
          "includes": [
            "#include \"nwfilter_learnipaddr.h\"",
            "#include \"nwfilter_dhcpsnoop.h\"",
            "#include \"nwfilter_ipaddrmap.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"configmake.h\"",
            "#include \"nwfilter_gentech_driver.h\"",
            "#include \"nwfilter_driver.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_conf.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"virlog.h\"",
            "#include \"virdbus.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virNWFilterDriverStatePtr driver;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"nwfilter_driver.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_conf.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"virlog.h\"\n#include \"virdbus.h\"\n#include <config.h>\n\nstatic virNWFilterDriverStatePtr driver;\n\nstatic void nwfilterDriverLock(void)\n{\n    virMutexLock(&driver->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterLearnThreadsTerminate",
          "args": [
            "true"
          ],
          "line": 329
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterLearnThreadsTerminate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_learnipaddr.c",
          "lines": "799-809",
          "snippet": "void\nvirNWFilterLearnThreadsTerminate(bool allowNewThreads)\n{\n    threadsTerminate = true;\n\n    while (virHashSize(pendingLearnReq) != 0)\n        g_usleep((PKT_TIMEOUT_MS * 1000) / 3);\n\n    if (allowNewThreads)\n        threadsTerminate = false;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virstring.h\"",
            "#include \"nwfilter_learnipaddr.h\"",
            "#include \"nwfilter_ipaddrmap.h\"",
            "#include \"nwfilter_ebiptables_driver.h\"",
            "#include \"nwfilter_gentech_driver.h\"",
            "#include \"conf/domain_conf.h\"",
            "#include \"conf/nwfilter_params.h\"",
            "#include \"virthread.h\"",
            "#include \"virerror.h\"",
            "#include \"virnetdev.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"internal.h\"",
            "#include <net/if_arp.h>",
            "#include <net/ethernet.h>",
            "#include <poll.h>",
            "#include <sys/ioctl.h>",
            "#include <fcntl.h>",
            "# include <pcap.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define PKT_TIMEOUT_MS 500 /* ms */"
          ],
          "globals_used": [
            "static virHashTablePtr pendingLearnReq;",
            "static bool threadsTerminate;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virstring.h\"\n#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"nwfilter_ebiptables_driver.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"conf/domain_conf.h\"\n#include \"conf/nwfilter_params.h\"\n#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"virnetdev.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"internal.h\"\n#include <net/if_arp.h>\n#include <net/ethernet.h>\n#include <poll.h>\n#include <sys/ioctl.h>\n#include <fcntl.h>\n# include <pcap.h>\n#include <config.h>\n\n#define PKT_TIMEOUT_MS 500 /* ms */\n\nstatic virHashTablePtr pendingLearnReq;\nstatic bool threadsTerminate;\n\nvoid\nvirNWFilterLearnThreadsTerminate(bool allowNewThreads)\n{\n    threadsTerminate = true;\n\n    while (virHashSize(pendingLearnReq) != 0)\n        g_usleep((PKT_TIMEOUT_MS * 1000) / 3);\n\n    if (allowNewThreads)\n        threadsTerminate = false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterDHCPSnoopEnd",
          "args": [
            "NULL"
          ],
          "line": 327
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterDHCPSnoopEnd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_dhcpsnoop.c",
          "lines": "2168-2172",
          "snippet": "void\nvirNWFilterDHCPSnoopEnd(const char *ifname G_GNUC_UNUSED)\n{\n    return;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virtime.h\"",
            "#include \"configmake.h\"",
            "#include \"virthreadpool.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"virfile.h\"",
            "#include \"virnetdev.h\"",
            "#include \"nwfilter_ipaddrmap.h\"",
            "#include \"nwfilter_dhcpsnoop.h\"",
            "#include \"nwfilter_gentech_driver.h\"",
            "#include \"conf/domain_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include <net/if.h>",
            "#include <poll.h>",
            "#include <fcntl.h>",
            "# include <pcap.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"configmake.h\"\n#include \"virthreadpool.h\"\n#include \"virsocketaddr.h\"\n#include \"virfile.h\"\n#include \"virnetdev.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"conf/domain_conf.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include <net/if.h>\n#include <poll.h>\n#include <fcntl.h>\n# include <pcap.h>\n#include <config.h>\n\nvoid\nvirNWFilterDHCPSnoopEnd(const char *ifname G_GNUC_UNUSED)\n{\n    return;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"nwfilter_driver.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_conf.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"virlog.h\"\n#include \"virdbus.h\"\n#include <config.h>\n\nstatic virNWFilterDriverStatePtr driver;\nstatic int nwfilterStateReload(void);\n\nstatic int\nnwfilterStateReload(void)\n{\n    if (!driver)\n        return -1;\n\n    if (!driver->privileged)\n        return 0;\n\n    virNWFilterDHCPSnoopEnd(NULL);\n    /* shut down all threads -- they will be restarted if necessary */\n    virNWFilterLearnThreadsTerminate(true);\n\n    nwfilterDriverLock();\n    virNWFilterWriteLockFilterUpdates();\n\n    virNWFilterObjListLoadAllConfigs(driver->nwfilters, driver->configDir);\n\n    virNWFilterUnlockFilterUpdates();\n\n    virNWFilterBuildAll(driver, false);\n\n    nwfilterDriverUnlock();\n\n    return 0;\n}"
  },
  {
    "function_name": "nwfilterStateInitialize",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_driver.c",
    "lines": "178-310",
    "snippet": "static int\nnwfilterStateInitialize(bool privileged,\n                        const char *root,\n                        virStateInhibitCallback callback G_GNUC_UNUSED,\n                        void *opaque G_GNUC_UNUSED)\n{\n    DBusConnection *sysbus = NULL;\n\n    if (root != NULL) {\n        virReportError(VIR_ERR_INVALID_ARG, \"%s\",\n                       _(\"Driver does not support embedded mode\"));\n        return -1;\n    }\n\n    if (virDBusHasSystemBus() &&\n        !(sysbus = virDBusGetSystemBus()))\n        return VIR_DRV_STATE_INIT_ERROR;\n\n    if (VIR_ALLOC(driver) < 0)\n        return VIR_DRV_STATE_INIT_ERROR;\n\n    driver->lockFD = -1;\n    if (virMutexInit(&driver->lock) < 0)\n        goto err_free_driverstate;\n\n    driver->privileged = privileged;\n    if (!(driver->nwfilters = virNWFilterObjListNew()))\n        goto error;\n\n    if (!(driver->bindings = virNWFilterBindingObjListNew()))\n        goto error;\n\n    if (!privileged)\n        return VIR_DRV_STATE_INIT_SKIPPED;\n\n    nwfilterDriverLock();\n\n    driver->stateDir = g_strdup(RUNSTATEDIR \"/libvirt/nwfilter\");\n\n    if (virFileMakePathWithMode(driver->stateDir, S_IRWXU) < 0) {\n        virReportSystemError(errno, _(\"cannot create state directory '%s'\"),\n                             driver->stateDir);\n        goto error;\n    }\n\n    if ((driver->lockFD =\n         virPidFileAcquire(driver->stateDir, \"driver\", false, getpid())) < 0)\n        goto error;\n\n    if (virNWFilterIPAddrMapInit() < 0)\n        goto err_free_driverstate;\n    if (virNWFilterLearnInit() < 0)\n        goto err_exit_ipaddrmapshutdown;\n    if (virNWFilterDHCPSnoopInit() < 0)\n        goto err_exit_learnshutdown;\n\n    if (virNWFilterTechDriversInit(privileged) < 0)\n        goto err_dhcpsnoop_shutdown;\n\n    if (virNWFilterConfLayerInit(virNWFilterTriggerRebuildImpl,\n                                 driver) < 0)\n        goto err_techdrivers_shutdown;\n\n    /*\n     * startup the DBus late so we don't get a reload signal while\n     * initializing\n     */\n    if (sysbus &&\n        nwfilterDriverInstallDBusMatches(sysbus) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"DBus matches could not be installed. \"\n                       \"Disabling nwfilter driver\"));\n        /*\n         * unfortunately this is fatal since virNWFilterTechDriversInit\n         * may have caused the ebiptables driver to use the firewall tool\n         * but now that the watches don't work, we just disable the nwfilter\n         * driver\n         *\n         * This may only happen if the system bus is available.\n         */\n        goto error;\n    }\n\n    driver->configDir = g_strdup(SYSCONFDIR \"/libvirt/nwfilter\");\n\n    if (virFileMakePathWithMode(driver->configDir, S_IRWXU) < 0) {\n        virReportSystemError(errno, _(\"cannot create config directory '%s'\"),\n                             driver->configDir);\n        goto error;\n    }\n\n    driver->bindingDir = g_strdup(RUNSTATEDIR \"/libvirt/nwfilter-binding\");\n\n    if (virFileMakePathWithMode(driver->bindingDir, S_IRWXU) < 0) {\n        virReportSystemError(errno, _(\"cannot create config directory '%s'\"),\n                             driver->bindingDir);\n        goto error;\n    }\n\n    if (virNWFilterObjListLoadAllConfigs(driver->nwfilters, driver->configDir) < 0)\n        goto error;\n\n    if (virNWFilterBindingObjListLoadAllConfigs(driver->bindings, driver->bindingDir) < 0)\n        goto error;\n\n    if (virNWFilterBuildAll(driver, false) < 0)\n        goto error;\n\n    nwfilterDriverUnlock();\n\n    return VIR_DRV_STATE_INIT_COMPLETE;\n\n error:\n    nwfilterDriverUnlock();\n    nwfilterStateCleanup();\n\n    return VIR_DRV_STATE_INIT_ERROR;\n\n err_techdrivers_shutdown:\n    virNWFilterTechDriversShutdown();\n err_dhcpsnoop_shutdown:\n    virNWFilterDHCPSnoopShutdown();\n err_exit_learnshutdown:\n    virNWFilterLearnShutdown();\n err_exit_ipaddrmapshutdown:\n    virNWFilterIPAddrMapShutdown();\n\n err_free_driverstate:\n    virNWFilterObjListFree(driver->nwfilters);\n    VIR_FREE(driver);\n\n    return VIR_DRV_STATE_INIT_ERROR;\n}",
    "includes": [
      "#include \"nwfilter_learnipaddr.h\"",
      "#include \"nwfilter_dhcpsnoop.h\"",
      "#include \"nwfilter_ipaddrmap.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"nwfilter_gentech_driver.h\"",
      "#include \"nwfilter_driver.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_conf.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include \"internal.h\"",
      "#include \"virlog.h\"",
      "#include \"virdbus.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virNWFilterDriverStatePtr driver;",
      "static int nwfilterStateCleanup(void);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "driver"
          ],
          "line": 307
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virNWFilterObjListFree",
          "args": [
            "driver->nwfilters"
          ],
          "line": 306
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterObjListFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterobj.c",
          "lines": "107-115",
          "snippet": "void\nvirNWFilterObjListFree(virNWFilterObjListPtr nwfilters)\n{\n    size_t i;\n    for (i = 0; i < nwfilters->count; i++)\n        virNWFilterObjFree(nwfilters->objs[i]);\n    VIR_FREE(nwfilters->objs);\n    VIR_FREE(nwfilters);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virnwfilterobj.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virnwfilterobj.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvoid\nvirNWFilterObjListFree(virNWFilterObjListPtr nwfilters)\n{\n    size_t i;\n    for (i = 0; i < nwfilters->count; i++)\n        virNWFilterObjFree(nwfilters->objs[i]);\n    VIR_FREE(nwfilters->objs);\n    VIR_FREE(nwfilters);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterIPAddrMapShutdown",
          "args": [],
          "line": 303
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterIPAddrMapShutdown",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_ipaddrmap.c",
          "lines": "159-164",
          "snippet": "void\nvirNWFilterIPAddrMapShutdown(void)\n{\n    virHashFree(ipAddressMap);\n    ipAddressMap = NULL;\n}",
          "includes": [
            "#include \"nwfilter_ipaddrmap.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"datatypes.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virHashTablePtr ipAddressMap;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nwfilter_ipaddrmap.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic virHashTablePtr ipAddressMap;\n\nvoid\nvirNWFilterIPAddrMapShutdown(void)\n{\n    virHashFree(ipAddressMap);\n    ipAddressMap = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterLearnShutdown",
          "args": [],
          "line": 301
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterLearnShutdown",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_learnipaddr.c",
          "lines": "815-828",
          "snippet": "void\nvirNWFilterLearnShutdown(void)\n{\n    if (!pendingLearnReq)\n        return;\n\n    virNWFilterLearnThreadsTerminate(false);\n\n    virHashFree(pendingLearnReq);\n    pendingLearnReq = NULL;\n\n    virHashFree(ifaceLockMap);\n    ifaceLockMap = NULL;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virstring.h\"",
            "#include \"nwfilter_learnipaddr.h\"",
            "#include \"nwfilter_ipaddrmap.h\"",
            "#include \"nwfilter_ebiptables_driver.h\"",
            "#include \"nwfilter_gentech_driver.h\"",
            "#include \"conf/domain_conf.h\"",
            "#include \"conf/nwfilter_params.h\"",
            "#include \"virthread.h\"",
            "#include \"virerror.h\"",
            "#include \"virnetdev.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"internal.h\"",
            "#include <net/if_arp.h>",
            "#include <net/ethernet.h>",
            "#include <poll.h>",
            "#include <sys/ioctl.h>",
            "#include <fcntl.h>",
            "# include <pcap.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virHashTablePtr pendingLearnReq;",
            "static virHashTablePtr ifaceLockMap;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virstring.h\"\n#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"nwfilter_ebiptables_driver.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"conf/domain_conf.h\"\n#include \"conf/nwfilter_params.h\"\n#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"virnetdev.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"internal.h\"\n#include <net/if_arp.h>\n#include <net/ethernet.h>\n#include <poll.h>\n#include <sys/ioctl.h>\n#include <fcntl.h>\n# include <pcap.h>\n#include <config.h>\n\nstatic virHashTablePtr pendingLearnReq;\nstatic virHashTablePtr ifaceLockMap;\n\nvoid\nvirNWFilterLearnShutdown(void)\n{\n    if (!pendingLearnReq)\n        return;\n\n    virNWFilterLearnThreadsTerminate(false);\n\n    virHashFree(pendingLearnReq);\n    pendingLearnReq = NULL;\n\n    virHashFree(ifaceLockMap);\n    ifaceLockMap = NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterDHCPSnoopShutdown",
          "args": [],
          "line": 299
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterDHCPSnoopShutdown",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_dhcpsnoop.c",
          "lines": "2174-2178",
          "snippet": "void\nvirNWFilterDHCPSnoopShutdown(void)\n{\n    return;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virtime.h\"",
            "#include \"configmake.h\"",
            "#include \"virthreadpool.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"virfile.h\"",
            "#include \"virnetdev.h\"",
            "#include \"nwfilter_ipaddrmap.h\"",
            "#include \"nwfilter_dhcpsnoop.h\"",
            "#include \"nwfilter_gentech_driver.h\"",
            "#include \"conf/domain_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include <net/if.h>",
            "#include <poll.h>",
            "#include <fcntl.h>",
            "# include <pcap.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"configmake.h\"\n#include \"virthreadpool.h\"\n#include \"virsocketaddr.h\"\n#include \"virfile.h\"\n#include \"virnetdev.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"conf/domain_conf.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include <net/if.h>\n#include <poll.h>\n#include <fcntl.h>\n# include <pcap.h>\n#include <config.h>\n\nvoid\nvirNWFilterDHCPSnoopShutdown(void)\n{\n    return;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterTechDriversShutdown",
          "args": [],
          "line": 297
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterTechDriversShutdown",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_gentech_driver.c",
          "lines": "90-99",
          "snippet": "void virNWFilterTechDriversShutdown(void)\n{\n    size_t i = 0;\n    while (filter_tech_drivers[i]) {\n        if ((filter_tech_drivers[i]->flags & TECHDRV_FLAG_INITIALIZED))\n            filter_tech_drivers[i]->shutdown();\n        i++;\n    }\n    virMutexDestroy(&updateMutex);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"datatypes.h\"",
            "#include \"virnetdev.h\"",
            "#include \"nwfilter_learnipaddr.h\"",
            "#include \"nwfilter_ipaddrmap.h\"",
            "#include \"nwfilter_dhcpsnoop.h\"",
            "#include \"nwfilter_ebiptables_driver.h\"",
            "#include \"nwfilter_gentech_driver.h\"",
            "#include \"virerror.h\"",
            "#include \"domain_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virNWFilterTechDriverPtr filter_tech_drivers[] = {\n    &ebiptables_driver,\n    NULL\n};",
            "static virMutex updateMutex;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virsocketaddr.h\"\n#include \"datatypes.h\"\n#include \"virnetdev.h\"\n#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ebiptables_driver.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"virerror.h\"\n#include \"domain_conf.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic virNWFilterTechDriverPtr filter_tech_drivers[] = {\n    &ebiptables_driver,\n    NULL\n};\nstatic virMutex updateMutex;\n\nvoid virNWFilterTechDriversShutdown(void)\n{\n    size_t i = 0;\n    while (filter_tech_drivers[i]) {\n        if ((filter_tech_drivers[i]->flags & TECHDRV_FLAG_INITIALIZED))\n            filter_tech_drivers[i]->shutdown();\n        i++;\n    }\n    virMutexDestroy(&updateMutex);\n}"
        }
      },
      {
        "call_info": {
          "callee": "nwfilterStateCleanup",
          "args": [],
          "line": 292
        },
        "resolved": true,
        "details": {
          "function_name": "nwfilterStateCleanup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_driver.c",
          "lines": "351-386",
          "snippet": "static int\nnwfilterStateCleanup(void)\n{\n    if (!driver)\n        return -1;\n\n    if (driver->privileged) {\n        virNWFilterConfLayerShutdown();\n        virNWFilterDHCPSnoopShutdown();\n        virNWFilterLearnShutdown();\n        virNWFilterIPAddrMapShutdown();\n        virNWFilterTechDriversShutdown();\n\n        nwfilterDriverLock();\n\n        nwfilterDriverRemoveDBusMatches();\n\n        if (driver->lockFD != -1)\n            virPidFileRelease(driver->stateDir, \"driver\", driver->lockFD);\n\n        VIR_FREE(driver->stateDir);\n        VIR_FREE(driver->configDir);\n        VIR_FREE(driver->bindingDir);\n        nwfilterDriverUnlock();\n    }\n\n    virObjectUnref(driver->bindings);\n\n    /* free inactive nwfilters */\n    virNWFilterObjListFree(driver->nwfilters);\n\n    virMutexDestroy(&driver->lock);\n    VIR_FREE(driver);\n\n    return 0;\n}",
          "includes": [
            "#include \"nwfilter_learnipaddr.h\"",
            "#include \"nwfilter_dhcpsnoop.h\"",
            "#include \"nwfilter_ipaddrmap.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"configmake.h\"",
            "#include \"nwfilter_gentech_driver.h\"",
            "#include \"nwfilter_driver.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_conf.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"virlog.h\"",
            "#include \"virdbus.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virNWFilterDriverStatePtr driver;",
            "static int nwfilterStateCleanup(void);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"nwfilter_driver.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_conf.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"virlog.h\"\n#include \"virdbus.h\"\n#include <config.h>\n\nstatic virNWFilterDriverStatePtr driver;\nstatic int nwfilterStateCleanup(void);\n\nstatic int\nnwfilterStateCleanup(void)\n{\n    if (!driver)\n        return -1;\n\n    if (driver->privileged) {\n        virNWFilterConfLayerShutdown();\n        virNWFilterDHCPSnoopShutdown();\n        virNWFilterLearnShutdown();\n        virNWFilterIPAddrMapShutdown();\n        virNWFilterTechDriversShutdown();\n\n        nwfilterDriverLock();\n\n        nwfilterDriverRemoveDBusMatches();\n\n        if (driver->lockFD != -1)\n            virPidFileRelease(driver->stateDir, \"driver\", driver->lockFD);\n\n        VIR_FREE(driver->stateDir);\n        VIR_FREE(driver->configDir);\n        VIR_FREE(driver->bindingDir);\n        nwfilterDriverUnlock();\n    }\n\n    virObjectUnref(driver->bindings);\n\n    /* free inactive nwfilters */\n    virNWFilterObjListFree(driver->nwfilters);\n\n    virMutexDestroy(&driver->lock);\n    VIR_FREE(driver);\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "nwfilterDriverUnlock",
          "args": [],
          "line": 291
        },
        "resolved": true,
        "details": {
          "function_name": "nwfilterDriverUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_driver.c",
          "lines": "75-78",
          "snippet": "static void nwfilterDriverUnlock(void)\n{\n    virMutexUnlock(&driver->lock);\n}",
          "includes": [
            "#include \"nwfilter_learnipaddr.h\"",
            "#include \"nwfilter_dhcpsnoop.h\"",
            "#include \"nwfilter_ipaddrmap.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"configmake.h\"",
            "#include \"nwfilter_gentech_driver.h\"",
            "#include \"nwfilter_driver.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_conf.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"virlog.h\"",
            "#include \"virdbus.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virNWFilterDriverStatePtr driver;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"nwfilter_driver.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_conf.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"virlog.h\"\n#include \"virdbus.h\"\n#include <config.h>\n\nstatic virNWFilterDriverStatePtr driver;\n\nstatic void nwfilterDriverUnlock(void)\n{\n    virMutexUnlock(&driver->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterBuildAll",
          "args": [
            "driver",
            "false"
          ],
          "line": 283
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterBuildAll",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_gentech_driver.c",
          "lines": "1006-1048",
          "snippet": "int\nvirNWFilterBuildAll(virNWFilterDriverStatePtr driver,\n                    bool newFilters)\n{\n    struct virNWFilterBuildData data = {\n        .driver = driver,\n    };\n    int ret = 0;\n\n    VIR_DEBUG(\"Build all filters newFilters=%d\", newFilters);\n\n    if (newFilters) {\n        if (!(data.skipInterfaces = virHashCreate(0, NULL)))\n            return -1;\n\n        data.step = STEP_APPLY_NEW;\n        if (virNWFilterBindingObjListForEach(driver->bindings,\n                                             virNWFilterBuildIter,\n                                             &data) < 0)\n            ret = -1;\n\n        if (ret == -1) {\n            data.step = STEP_ROLLBACK;\n            virNWFilterBindingObjListForEach(driver->bindings,\n                                             virNWFilterBuildIter,\n                                             &data);\n        } else  {\n            data.step = STEP_SWITCH;\n            virNWFilterBindingObjListForEach(driver->bindings,\n                                             virNWFilterBuildIter,\n                                             &data);\n        }\n\n        virHashFree(data.skipInterfaces);\n    } else {\n        data.step = STEP_APPLY_CURRENT;\n        if (virNWFilterBindingObjListForEach(driver->bindings,\n                                             virNWFilterBuildIter,\n                                             &data) < 0)\n            ret = -1;\n    }\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"datatypes.h\"",
            "#include \"virnetdev.h\"",
            "#include \"nwfilter_learnipaddr.h\"",
            "#include \"nwfilter_ipaddrmap.h\"",
            "#include \"nwfilter_dhcpsnoop.h\"",
            "#include \"nwfilter_ebiptables_driver.h\"",
            "#include \"nwfilter_gentech_driver.h\"",
            "#include \"virerror.h\"",
            "#include \"domain_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virsocketaddr.h\"\n#include \"datatypes.h\"\n#include \"virnetdev.h\"\n#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ebiptables_driver.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"virerror.h\"\n#include \"domain_conf.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirNWFilterBuildAll(virNWFilterDriverStatePtr driver,\n                    bool newFilters)\n{\n    struct virNWFilterBuildData data = {\n        .driver = driver,\n    };\n    int ret = 0;\n\n    VIR_DEBUG(\"Build all filters newFilters=%d\", newFilters);\n\n    if (newFilters) {\n        if (!(data.skipInterfaces = virHashCreate(0, NULL)))\n            return -1;\n\n        data.step = STEP_APPLY_NEW;\n        if (virNWFilterBindingObjListForEach(driver->bindings,\n                                             virNWFilterBuildIter,\n                                             &data) < 0)\n            ret = -1;\n\n        if (ret == -1) {\n            data.step = STEP_ROLLBACK;\n            virNWFilterBindingObjListForEach(driver->bindings,\n                                             virNWFilterBuildIter,\n                                             &data);\n        } else  {\n            data.step = STEP_SWITCH;\n            virNWFilterBindingObjListForEach(driver->bindings,\n                                             virNWFilterBuildIter,\n                                             &data);\n        }\n\n        virHashFree(data.skipInterfaces);\n    } else {\n        data.step = STEP_APPLY_CURRENT;\n        if (virNWFilterBindingObjListForEach(driver->bindings,\n                                             virNWFilterBuildIter,\n                                             &data) < 0)\n            ret = -1;\n    }\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterBindingObjListLoadAllConfigs",
          "args": [
            "driver->bindings",
            "driver->bindingDir"
          ],
          "line": 280
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterBindingObjListLoadAllConfigs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterbindingobjlist.c",
          "lines": "299-336",
          "snippet": "int\nvirNWFilterBindingObjListLoadAllConfigs(virNWFilterBindingObjListPtr bindings,\n                                        const char *configDir)\n{\n    DIR *dir;\n    struct dirent *entry;\n    int ret = -1;\n    int rc;\n\n    VIR_INFO(\"Scanning for configs in %s\", configDir);\n\n    if ((rc = virDirOpenIfExists(&dir, configDir)) <= 0)\n        return rc;\n\n    virObjectRWLockWrite(bindings);\n\n    while ((ret = virDirRead(dir, &entry, configDir)) > 0) {\n        virNWFilterBindingObjPtr binding;\n\n        if (!virStringStripSuffix(entry->d_name, \".xml\"))\n            continue;\n\n        /* NB: ignoring errors, so one malformed config doesn't\n           kill the whole process */\n        VIR_INFO(\"Loading config file '%s.xml'\", entry->d_name);\n        binding = virNWFilterBindingObjListLoadStatus(bindings,\n                                                      configDir,\n                                                      entry->d_name);\n        if (binding)\n            virNWFilterBindingObjEndAPI(&binding);\n        else\n            VIR_ERROR(_(\"Failed to load config for binding '%s'\"), entry->d_name);\n    }\n\n    VIR_DIR_CLOSE(dir);\n    virObjectRWUnlock(bindings);\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnwfilterbindingobjlist.h\"",
            "#include \"datatypes.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virnwfilterbindingobjlist.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirNWFilterBindingObjListLoadAllConfigs(virNWFilterBindingObjListPtr bindings,\n                                        const char *configDir)\n{\n    DIR *dir;\n    struct dirent *entry;\n    int ret = -1;\n    int rc;\n\n    VIR_INFO(\"Scanning for configs in %s\", configDir);\n\n    if ((rc = virDirOpenIfExists(&dir, configDir)) <= 0)\n        return rc;\n\n    virObjectRWLockWrite(bindings);\n\n    while ((ret = virDirRead(dir, &entry, configDir)) > 0) {\n        virNWFilterBindingObjPtr binding;\n\n        if (!virStringStripSuffix(entry->d_name, \".xml\"))\n            continue;\n\n        /* NB: ignoring errors, so one malformed config doesn't\n           kill the whole process */\n        VIR_INFO(\"Loading config file '%s.xml'\", entry->d_name);\n        binding = virNWFilterBindingObjListLoadStatus(bindings,\n                                                      configDir,\n                                                      entry->d_name);\n        if (binding)\n            virNWFilterBindingObjEndAPI(&binding);\n        else\n            VIR_ERROR(_(\"Failed to load config for binding '%s'\"), entry->d_name);\n    }\n\n    VIR_DIR_CLOSE(dir);\n    virObjectRWUnlock(bindings);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterObjListLoadAllConfigs",
          "args": [
            "driver->nwfilters",
            "driver->configDir"
          ],
          "line": 277
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterObjListLoadAllConfigs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterobj.c",
          "lines": "526-551",
          "snippet": "int\nvirNWFilterObjListLoadAllConfigs(virNWFilterObjListPtr nwfilters,\n                                 const char *configDir)\n{\n    DIR *dir;\n    struct dirent *entry;\n    int ret = -1;\n    int rc;\n\n    if ((rc = virDirOpenIfExists(&dir, configDir)) <= 0)\n        return rc;\n\n    while ((ret = virDirRead(dir, &entry, configDir)) > 0) {\n        virNWFilterObjPtr obj;\n\n        if (!virStringStripSuffix(entry->d_name, \".xml\"))\n            continue;\n\n        obj = virNWFilterObjListLoadConfig(nwfilters, configDir, entry->d_name);\n        if (obj)\n            virNWFilterObjUnlock(obj);\n    }\n\n    VIR_DIR_CLOSE(dir);\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virnwfilterobj.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virnwfilterobj.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nint\nvirNWFilterObjListLoadAllConfigs(virNWFilterObjListPtr nwfilters,\n                                 const char *configDir)\n{\n    DIR *dir;\n    struct dirent *entry;\n    int ret = -1;\n    int rc;\n\n    if ((rc = virDirOpenIfExists(&dir, configDir)) <= 0)\n        return rc;\n\n    while ((ret = virDirRead(dir, &entry, configDir)) > 0) {\n        virNWFilterObjPtr obj;\n\n        if (!virStringStripSuffix(entry->d_name, \".xml\"))\n            continue;\n\n        obj = virNWFilterObjListLoadConfig(nwfilters, configDir, entry->d_name);\n        if (obj)\n            virNWFilterObjUnlock(obj);\n    }\n\n    VIR_DIR_CLOSE(dir);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"cannot create config directory '%s'\")",
            "driver->bindingDir"
          ],
          "line": 272
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"cannot create config directory '%s'\""
          ],
          "line": 272
        },
        "resolved": true,
        "details": {
          "function_name": "_virNWFilterTeardownFilter",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_gentech_driver.c",
          "lines": "898-927",
          "snippet": "static int\n_virNWFilterTeardownFilter(const char *ifname)\n{\n    const char *drvname = EBIPTABLES_DRIVER_ID;\n    virNWFilterTechDriverPtr techdriver;\n    techdriver = virNWFilterTechDriverForName(drvname);\n\n    if (!techdriver) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Could not get access to ACL tech \"\n                         \"driver '%s'\"),\n                       drvname);\n        return -1;\n    }\n\n    virNWFilterDHCPSnoopEnd(ifname);\n\n    virNWFilterTerminateLearnReq(ifname);\n\n    if (virNWFilterLockIface(ifname) < 0)\n        return -1;\n\n    techdriver->allTeardown(ifname);\n\n    virNWFilterIPAddrMapDelIPAddr(ifname, NULL);\n\n    virNWFilterUnlockIface(ifname);\n\n    return 0;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"datatypes.h\"",
            "#include \"virnetdev.h\"",
            "#include \"nwfilter_learnipaddr.h\"",
            "#include \"nwfilter_ipaddrmap.h\"",
            "#include \"nwfilter_dhcpsnoop.h\"",
            "#include \"nwfilter_ebiptables_driver.h\"",
            "#include \"nwfilter_gentech_driver.h\"",
            "#include \"virerror.h\"",
            "#include \"domain_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static int _virNWFilterTeardownFilter(const char *ifname);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virsocketaddr.h\"\n#include \"datatypes.h\"\n#include \"virnetdev.h\"\n#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ebiptables_driver.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"virerror.h\"\n#include \"domain_conf.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic int _virNWFilterTeardownFilter(const char *ifname);\n\nstatic int\n_virNWFilterTeardownFilter(const char *ifname)\n{\n    const char *drvname = EBIPTABLES_DRIVER_ID;\n    virNWFilterTechDriverPtr techdriver;\n    techdriver = virNWFilterTechDriverForName(drvname);\n\n    if (!techdriver) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Could not get access to ACL tech \"\n                         \"driver '%s'\"),\n                       drvname);\n        return -1;\n    }\n\n    virNWFilterDHCPSnoopEnd(ifname);\n\n    virNWFilterTerminateLearnReq(ifname);\n\n    if (virNWFilterLockIface(ifname) < 0)\n        return -1;\n\n    techdriver->allTeardown(ifname);\n\n    virNWFilterIPAddrMapDelIPAddr(ifname, NULL);\n\n    virNWFilterUnlockIface(ifname);\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virFileMakePathWithMode",
          "args": [
            "driver->bindingDir",
            "S_IRWXU"
          ],
          "line": 271
        },
        "resolved": true,
        "details": {
          "function_name": "virFileMakePathWithMode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "3082-3091",
          "snippet": "int\nvirFileMakePathWithMode(const char *path,\n                        mode_t mode)\n{\n    g_autofree char *tmp = NULL;\n\n    tmp = g_strdup(path);\n\n    return virFileMakePathHelper(tmp, mode);\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileMakePathWithMode(const char *path,\n                        mode_t mode)\n{\n    g_autofree char *tmp = NULL;\n\n    tmp = g_strdup(path);\n\n    return virFileMakePathHelper(tmp, mode);\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "RUNSTATEDIR \"/libvirt/nwfilter-binding\""
          ],
          "line": 269
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"cannot create config directory '%s'\")",
            "driver->configDir"
          ],
          "line": 264
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"DBus matches could not be installed. \"\n                       \"Disabling nwfilter driver\")"
          ],
          "line": 247
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nwfilterDriverInstallDBusMatches",
          "args": [
            "sysbus"
          ],
          "line": 246
        },
        "resolved": true,
        "details": {
          "function_name": "nwfilterDriverInstallDBusMatches",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_driver.c",
          "lines": "156-160",
          "snippet": "static int\nnwfilterDriverInstallDBusMatches(DBusConnection *sysbus G_GNUC_UNUSED)\n{\n    return 0;\n}",
          "includes": [
            "#include \"nwfilter_learnipaddr.h\"",
            "#include \"nwfilter_dhcpsnoop.h\"",
            "#include \"nwfilter_ipaddrmap.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"configmake.h\"",
            "#include \"nwfilter_gentech_driver.h\"",
            "#include \"nwfilter_driver.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_conf.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"virlog.h\"",
            "#include \"virdbus.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"nwfilter_driver.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_conf.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"virlog.h\"\n#include \"virdbus.h\"\n#include <config.h>\n\nstatic int\nnwfilterDriverInstallDBusMatches(DBusConnection *sysbus G_GNUC_UNUSED)\n{\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterConfLayerInit",
          "args": [
            "virNWFilterTriggerRebuildImpl",
            "driver"
          ],
          "line": 237
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterConfLayerInit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_conf.c",
          "lines": "3081-3097",
          "snippet": "int\nvirNWFilterConfLayerInit(virNWFilterTriggerRebuildCallback cb,\n                         void *opaque)\n{\n    if (initialized)\n        return -1;\n\n    rebuildCallback = cb;\n    rebuildOpaque = opaque;\n\n    initialized = true;\n\n    if (virRWLockInit(&updateLock) < 0)\n        return -1;\n\n    return 0;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"domain_conf.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"viruuid.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "# include <net/ethernet.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virRWLock updateLock;",
            "static bool initialized;",
            "static virNWFilterTriggerRebuildCallback rebuildCallback;",
            "static void *rebuildOpaque;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"domain_conf.h\"\n#include \"nwfilter_conf.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"viruuid.h\"\n#include \"internal.h\"\n#include <unistd.h>\n# include <net/ethernet.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic virRWLock updateLock;\nstatic bool initialized;\nstatic virNWFilterTriggerRebuildCallback rebuildCallback;\nstatic void *rebuildOpaque;\n\nint\nvirNWFilterConfLayerInit(virNWFilterTriggerRebuildCallback cb,\n                         void *opaque)\n{\n    if (initialized)\n        return -1;\n\n    rebuildCallback = cb;\n    rebuildOpaque = opaque;\n\n    initialized = true;\n\n    if (virRWLockInit(&updateLock) < 0)\n        return -1;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterTechDriversInit",
          "args": [
            "privileged"
          ],
          "line": 234
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterTechDriversInit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_gentech_driver.c",
          "lines": "74-87",
          "snippet": "int virNWFilterTechDriversInit(bool privileged)\n{\n    size_t i = 0;\n    VIR_DEBUG(\"Initializing NWFilter technology drivers\");\n    if (virMutexInitRecursive(&updateMutex) < 0)\n        return -1;\n\n    while (filter_tech_drivers[i]) {\n        if (!(filter_tech_drivers[i]->flags & TECHDRV_FLAG_INITIALIZED))\n            filter_tech_drivers[i]->init(privileged);\n        i++;\n    }\n    return 0;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"datatypes.h\"",
            "#include \"virnetdev.h\"",
            "#include \"nwfilter_learnipaddr.h\"",
            "#include \"nwfilter_ipaddrmap.h\"",
            "#include \"nwfilter_dhcpsnoop.h\"",
            "#include \"nwfilter_ebiptables_driver.h\"",
            "#include \"nwfilter_gentech_driver.h\"",
            "#include \"virerror.h\"",
            "#include \"domain_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virNWFilterTechDriverPtr filter_tech_drivers[] = {\n    &ebiptables_driver,\n    NULL\n};",
            "static virMutex updateMutex;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virsocketaddr.h\"\n#include \"datatypes.h\"\n#include \"virnetdev.h\"\n#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ebiptables_driver.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"virerror.h\"\n#include \"domain_conf.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic virNWFilterTechDriverPtr filter_tech_drivers[] = {\n    &ebiptables_driver,\n    NULL\n};\nstatic virMutex updateMutex;\n\nint virNWFilterTechDriversInit(bool privileged)\n{\n    size_t i = 0;\n    VIR_DEBUG(\"Initializing NWFilter technology drivers\");\n    if (virMutexInitRecursive(&updateMutex) < 0)\n        return -1;\n\n    while (filter_tech_drivers[i]) {\n        if (!(filter_tech_drivers[i]->flags & TECHDRV_FLAG_INITIALIZED))\n            filter_tech_drivers[i]->init(privileged);\n        i++;\n    }\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterDHCPSnoopInit",
          "args": [],
          "line": 231
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterDHCPSnoopInit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_dhcpsnoop.c",
          "lines": "2161-2166",
          "snippet": "int\nvirNWFilterDHCPSnoopInit(void)\n{\n    VIR_DEBUG(\"No DHCP snooping support available\");\n    return 0;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virtime.h\"",
            "#include \"configmake.h\"",
            "#include \"virthreadpool.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"virfile.h\"",
            "#include \"virnetdev.h\"",
            "#include \"nwfilter_ipaddrmap.h\"",
            "#include \"nwfilter_dhcpsnoop.h\"",
            "#include \"nwfilter_gentech_driver.h\"",
            "#include \"conf/domain_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include <net/if.h>",
            "#include <poll.h>",
            "#include <fcntl.h>",
            "# include <pcap.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virtime.h\"\n#include \"configmake.h\"\n#include \"virthreadpool.h\"\n#include \"virsocketaddr.h\"\n#include \"virfile.h\"\n#include \"virnetdev.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"conf/domain_conf.h\"\n#include \"virerror.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include <net/if.h>\n#include <poll.h>\n#include <fcntl.h>\n# include <pcap.h>\n#include <config.h>\n\nint\nvirNWFilterDHCPSnoopInit(void)\n{\n    VIR_DEBUG(\"No DHCP snooping support available\");\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterLearnInit",
          "args": [],
          "line": 229
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterLearnInit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_learnipaddr.c",
          "lines": "776-796",
          "snippet": "int\nvirNWFilterLearnInit(void)\n{\n    if (pendingLearnReq)\n        return 0;\n\n    VIR_DEBUG(\"Initializing IP address learning\");\n    threadsTerminate = false;\n\n    pendingLearnReq = virHashCreate(0, freeLearnReqEntry);\n    if (!pendingLearnReq)\n        return -1;\n\n    ifaceLockMap = virHashCreate(0, virHashValueFree);\n    if (!ifaceLockMap) {\n        virNWFilterLearnShutdown();\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virstring.h\"",
            "#include \"nwfilter_learnipaddr.h\"",
            "#include \"nwfilter_ipaddrmap.h\"",
            "#include \"nwfilter_ebiptables_driver.h\"",
            "#include \"nwfilter_gentech_driver.h\"",
            "#include \"conf/domain_conf.h\"",
            "#include \"conf/nwfilter_params.h\"",
            "#include \"virthread.h\"",
            "#include \"virerror.h\"",
            "#include \"virnetdev.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"internal.h\"",
            "#include <net/if_arp.h>",
            "#include <net/ethernet.h>",
            "#include <poll.h>",
            "#include <sys/ioctl.h>",
            "#include <fcntl.h>",
            "# include <pcap.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virHashTablePtr pendingLearnReq;",
            "static virHashTablePtr ifaceLockMap;",
            "static bool threadsTerminate;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virstring.h\"\n#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"nwfilter_ebiptables_driver.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"conf/domain_conf.h\"\n#include \"conf/nwfilter_params.h\"\n#include \"virthread.h\"\n#include \"virerror.h\"\n#include \"virnetdev.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"internal.h\"\n#include <net/if_arp.h>\n#include <net/ethernet.h>\n#include <poll.h>\n#include <sys/ioctl.h>\n#include <fcntl.h>\n# include <pcap.h>\n#include <config.h>\n\nstatic virHashTablePtr pendingLearnReq;\nstatic virHashTablePtr ifaceLockMap;\nstatic bool threadsTerminate;\n\nint\nvirNWFilterLearnInit(void)\n{\n    if (pendingLearnReq)\n        return 0;\n\n    VIR_DEBUG(\"Initializing IP address learning\");\n    threadsTerminate = false;\n\n    pendingLearnReq = virHashCreate(0, freeLearnReqEntry);\n    if (!pendingLearnReq)\n        return -1;\n\n    ifaceLockMap = virHashCreate(0, virHashValueFree);\n    if (!ifaceLockMap) {\n        virNWFilterLearnShutdown();\n        return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterIPAddrMapInit",
          "args": [],
          "line": 227
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterIPAddrMapInit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/nwfilter_ipaddrmap.c",
          "lines": "149-157",
          "snippet": "int\nvirNWFilterIPAddrMapInit(void)\n{\n    ipAddressMap = virNWFilterHashTableCreate(0);\n    if (!ipAddressMap)\n        return -1;\n\n    return 0;\n}",
          "includes": [
            "#include \"nwfilter_ipaddrmap.h\"",
            "#include \"nwfilter_params.h\"",
            "#include \"datatypes.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virHashTablePtr ipAddressMap;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nwfilter_ipaddrmap.h\"\n#include \"nwfilter_params.h\"\n#include \"datatypes.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic virHashTablePtr ipAddressMap;\n\nint\nvirNWFilterIPAddrMapInit(void)\n{\n    ipAddressMap = virNWFilterHashTableCreate(0);\n    if (!ipAddressMap)\n        return -1;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virPidFileAcquire",
          "args": [
            "driver->stateDir",
            "\"driver\"",
            "false",
            "getpid()"
          ],
          "line": 224
        },
        "resolved": true,
        "details": {
          "function_name": "virPidFileAcquire",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virpidfile.c",
          "lines": "413-427",
          "snippet": "int virPidFileAcquire(const char *dir,\n                      const char *name,\n                      bool waitForLock,\n                      pid_t pid)\n{\n    g_autofree char *pidfile = NULL;\n\n    if (name == NULL || dir == NULL)\n        return -EINVAL;\n\n    if (!(pidfile = virPidFileBuildPath(dir, name)))\n        return -ENOMEM;\n\n    return virPidFileAcquirePath(pidfile, waitForLock, pid);\n}",
          "includes": [
            "#include \"virprocess.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"viralloc.h\"",
            "#include \"virfile.h\"",
            "#include \"virpidfile.h\"",
            "#include <sys/stat.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virprocess.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"viralloc.h\"\n#include \"virfile.h\"\n#include \"virpidfile.h\"\n#include <sys/stat.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <config.h>\n\nint virPidFileAcquire(const char *dir,\n                      const char *name,\n                      bool waitForLock,\n                      pid_t pid)\n{\n    g_autofree char *pidfile = NULL;\n\n    if (name == NULL || dir == NULL)\n        return -EINVAL;\n\n    if (!(pidfile = virPidFileBuildPath(dir, name)))\n        return -ENOMEM;\n\n    return virPidFileAcquirePath(pidfile, waitForLock, pid);\n}"
        }
      },
      {
        "call_info": {
          "callee": "getpid",
          "args": [],
          "line": 224
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "errno",
            "_(\"cannot create state directory '%s'\")",
            "driver->stateDir"
          ],
          "line": 218
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nwfilterDriverLock",
          "args": [],
          "line": 213
        },
        "resolved": true,
        "details": {
          "function_name": "nwfilterDriverLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_driver.c",
          "lines": "71-74",
          "snippet": "static void nwfilterDriverLock(void)\n{\n    virMutexLock(&driver->lock);\n}",
          "includes": [
            "#include \"nwfilter_learnipaddr.h\"",
            "#include \"nwfilter_dhcpsnoop.h\"",
            "#include \"nwfilter_ipaddrmap.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"configmake.h\"",
            "#include \"nwfilter_gentech_driver.h\"",
            "#include \"nwfilter_driver.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_conf.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"virlog.h\"",
            "#include \"virdbus.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virNWFilterDriverStatePtr driver;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"nwfilter_driver.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_conf.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"virlog.h\"\n#include \"virdbus.h\"\n#include <config.h>\n\nstatic virNWFilterDriverStatePtr driver;\n\nstatic void nwfilterDriverLock(void)\n{\n    virMutexLock(&driver->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterBindingObjListNew",
          "args": [],
          "line": 207
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterBindingObjListNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterbindingobjlist.c",
          "lines": "58-75",
          "snippet": "virNWFilterBindingObjListPtr\nvirNWFilterBindingObjListNew(void)\n{\n    virNWFilterBindingObjListPtr bindings;\n\n    if (virNWFilterBindingObjListInitialize() < 0)\n        return NULL;\n\n    if (!(bindings = virObjectRWLockableNew(virNWFilterBindingObjListClass)))\n        return NULL;\n\n    if (!(bindings->objs = virHashCreate(50, virObjectFreeHashData))) {\n        virObjectUnref(bindings);\n        return NULL;\n    }\n\n    return bindings;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virnwfilterbindingobjlist.h\"",
            "#include \"datatypes.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virClassPtr virNWFilterBindingObjListClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virnwfilterbindingobjlist.h\"\n#include \"datatypes.h\"\n#include \"internal.h\"\n#include <config.h>\n\nstatic virClassPtr virNWFilterBindingObjListClass;\n\nvirNWFilterBindingObjListPtr\nvirNWFilterBindingObjListNew(void)\n{\n    virNWFilterBindingObjListPtr bindings;\n\n    if (virNWFilterBindingObjListInitialize() < 0)\n        return NULL;\n\n    if (!(bindings = virObjectRWLockableNew(virNWFilterBindingObjListClass)))\n        return NULL;\n\n    if (!(bindings->objs = virHashCreate(50, virObjectFreeHashData))) {\n        virObjectUnref(bindings);\n        return NULL;\n    }\n\n    return bindings;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virNWFilterObjListNew",
          "args": [],
          "line": 204
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterObjListNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/virnwfilterobj.c",
          "lines": "118-126",
          "snippet": "virNWFilterObjListPtr\nvirNWFilterObjListNew(void)\n{\n    virNWFilterObjListPtr nwfilters;\n\n    if (VIR_ALLOC(nwfilters) < 0)\n        return NULL;\n    return nwfilters;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virnwfilterobj.h\"",
            "#include \"virlog.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virnwfilterobj.h\"\n#include \"virlog.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include <dirent.h>\n#include <config.h>\n\nvirNWFilterObjListPtr\nvirNWFilterObjListNew(void)\n{\n    virNWFilterObjListPtr nwfilters;\n\n    if (VIR_ALLOC(nwfilters) < 0)\n        return NULL;\n    return nwfilters;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virMutexInit",
          "args": [
            "&driver->lock"
          ],
          "line": 200
        },
        "resolved": true,
        "details": {
          "function_name": "virMutexInitRecursive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virthread.c",
          "lines": "61-74",
          "snippet": "int virMutexInitRecursive(virMutexPtr m)\n{\n    int ret;\n    pthread_mutexattr_t attr;\n    pthread_mutexattr_init(&attr);\n    pthread_mutexattr_settype(&attr, PTHREAD_MUTEX_RECURSIVE);\n    ret = pthread_mutex_init(&m->lock, &attr);\n    pthread_mutexattr_destroy(&attr);\n    if (ret != 0) {\n        errno = ret;\n        return -1;\n    }\n    return 0;\n}",
          "includes": [
            "#include \"virthreadjob.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/syscall.h>",
            "#include <inttypes.h>",
            "#include <unistd.h>",
            "# include <pthread_np.h>",
            "#include \"virthread.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthreadjob.h\"\n#include \"viralloc.h\"\n# include <sys/syscall.h>\n#include <inttypes.h>\n#include <unistd.h>\n# include <pthread_np.h>\n#include \"virthread.h\"\n#include <config.h>\n\nint virMutexInitRecursive(virMutexPtr m)\n{\n    int ret;\n    pthread_mutexattr_t attr;\n    pthread_mutexattr_init(&attr);\n    pthread_mutexattr_settype(&attr, PTHREAD_MUTEX_RECURSIVE);\n    ret = pthread_mutex_init(&m->lock, &attr);\n    pthread_mutexattr_destroy(&attr);\n    if (ret != 0) {\n        errno = ret;\n        return -1;\n    }\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC",
          "args": [
            "driver"
          ],
          "line": 196
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDBusGetSystemBus",
          "args": [],
          "line": 193
        },
        "resolved": true,
        "details": {
          "function_name": "virDBusGetSystemBus",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virdbus.c",
          "lines": "1744-1749",
          "snippet": "DBusConnection *virDBusGetSystemBus(void)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   \"%s\", _(\"DBus support not compiled into this binary\"));\n    return NULL;\n}",
          "includes": [
            "#include \"virprobe.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virdbuspriv.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virprobe.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virdbuspriv.h\"\n#include <config.h>\n\nDBusConnection *virDBusGetSystemBus(void)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   \"%s\", _(\"DBus support not compiled into this binary\"));\n    return NULL;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDBusHasSystemBus",
          "args": [],
          "line": 192
        },
        "resolved": true,
        "details": {
          "function_name": "virDBusHasSystemBus",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virdbus.c",
          "lines": "1752-1757",
          "snippet": "bool\nvirDBusHasSystemBus(void)\n{\n    VIR_DEBUG(\"DBus support not compiled into this binary\");\n    return false;\n}",
          "includes": [
            "#include \"virprobe.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virdbuspriv.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virprobe.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virdbuspriv.h\"\n#include <config.h>\n\nbool\nvirDBusHasSystemBus(void)\n{\n    VIR_DEBUG(\"DBus support not compiled into this binary\");\n    return false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INVALID_ARG",
            "\"%s\"",
            "_(\"Driver does not support embedded mode\")"
          ],
          "line": 187
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"nwfilter_driver.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_conf.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"virlog.h\"\n#include \"virdbus.h\"\n#include <config.h>\n\nstatic virNWFilterDriverStatePtr driver;\nstatic int nwfilterStateCleanup(void);\n\nstatic int\nnwfilterStateInitialize(bool privileged,\n                        const char *root,\n                        virStateInhibitCallback callback G_GNUC_UNUSED,\n                        void *opaque G_GNUC_UNUSED)\n{\n    DBusConnection *sysbus = NULL;\n\n    if (root != NULL) {\n        virReportError(VIR_ERR_INVALID_ARG, \"%s\",\n                       _(\"Driver does not support embedded mode\"));\n        return -1;\n    }\n\n    if (virDBusHasSystemBus() &&\n        !(sysbus = virDBusGetSystemBus()))\n        return VIR_DRV_STATE_INIT_ERROR;\n\n    if (VIR_ALLOC(driver) < 0)\n        return VIR_DRV_STATE_INIT_ERROR;\n\n    driver->lockFD = -1;\n    if (virMutexInit(&driver->lock) < 0)\n        goto err_free_driverstate;\n\n    driver->privileged = privileged;\n    if (!(driver->nwfilters = virNWFilterObjListNew()))\n        goto error;\n\n    if (!(driver->bindings = virNWFilterBindingObjListNew()))\n        goto error;\n\n    if (!privileged)\n        return VIR_DRV_STATE_INIT_SKIPPED;\n\n    nwfilterDriverLock();\n\n    driver->stateDir = g_strdup(RUNSTATEDIR \"/libvirt/nwfilter\");\n\n    if (virFileMakePathWithMode(driver->stateDir, S_IRWXU) < 0) {\n        virReportSystemError(errno, _(\"cannot create state directory '%s'\"),\n                             driver->stateDir);\n        goto error;\n    }\n\n    if ((driver->lockFD =\n         virPidFileAcquire(driver->stateDir, \"driver\", false, getpid())) < 0)\n        goto error;\n\n    if (virNWFilterIPAddrMapInit() < 0)\n        goto err_free_driverstate;\n    if (virNWFilterLearnInit() < 0)\n        goto err_exit_ipaddrmapshutdown;\n    if (virNWFilterDHCPSnoopInit() < 0)\n        goto err_exit_learnshutdown;\n\n    if (virNWFilterTechDriversInit(privileged) < 0)\n        goto err_dhcpsnoop_shutdown;\n\n    if (virNWFilterConfLayerInit(virNWFilterTriggerRebuildImpl,\n                                 driver) < 0)\n        goto err_techdrivers_shutdown;\n\n    /*\n     * startup the DBus late so we don't get a reload signal while\n     * initializing\n     */\n    if (sysbus &&\n        nwfilterDriverInstallDBusMatches(sysbus) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"DBus matches could not be installed. \"\n                       \"Disabling nwfilter driver\"));\n        /*\n         * unfortunately this is fatal since virNWFilterTechDriversInit\n         * may have caused the ebiptables driver to use the firewall tool\n         * but now that the watches don't work, we just disable the nwfilter\n         * driver\n         *\n         * This may only happen if the system bus is available.\n         */\n        goto error;\n    }\n\n    driver->configDir = g_strdup(SYSCONFDIR \"/libvirt/nwfilter\");\n\n    if (virFileMakePathWithMode(driver->configDir, S_IRWXU) < 0) {\n        virReportSystemError(errno, _(\"cannot create config directory '%s'\"),\n                             driver->configDir);\n        goto error;\n    }\n\n    driver->bindingDir = g_strdup(RUNSTATEDIR \"/libvirt/nwfilter-binding\");\n\n    if (virFileMakePathWithMode(driver->bindingDir, S_IRWXU) < 0) {\n        virReportSystemError(errno, _(\"cannot create config directory '%s'\"),\n                             driver->bindingDir);\n        goto error;\n    }\n\n    if (virNWFilterObjListLoadAllConfigs(driver->nwfilters, driver->configDir) < 0)\n        goto error;\n\n    if (virNWFilterBindingObjListLoadAllConfigs(driver->bindings, driver->bindingDir) < 0)\n        goto error;\n\n    if (virNWFilterBuildAll(driver, false) < 0)\n        goto error;\n\n    nwfilterDriverUnlock();\n\n    return VIR_DRV_STATE_INIT_COMPLETE;\n\n error:\n    nwfilterDriverUnlock();\n    nwfilterStateCleanup();\n\n    return VIR_DRV_STATE_INIT_ERROR;\n\n err_techdrivers_shutdown:\n    virNWFilterTechDriversShutdown();\n err_dhcpsnoop_shutdown:\n    virNWFilterDHCPSnoopShutdown();\n err_exit_learnshutdown:\n    virNWFilterLearnShutdown();\n err_exit_ipaddrmapshutdown:\n    virNWFilterIPAddrMapShutdown();\n\n err_free_driverstate:\n    virNWFilterObjListFree(driver->nwfilters);\n    VIR_FREE(driver);\n\n    return VIR_DRV_STATE_INIT_ERROR;\n}"
  },
  {
    "function_name": "virNWFilterTriggerRebuildImpl",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_driver.c",
    "lines": "164-170",
    "snippet": "static int\nvirNWFilterTriggerRebuildImpl(void *opaque)\n{\n    virNWFilterDriverStatePtr nwdriver = opaque;\n\n    return virNWFilterBuildAll(nwdriver, true);\n}",
    "includes": [
      "#include \"nwfilter_learnipaddr.h\"",
      "#include \"nwfilter_dhcpsnoop.h\"",
      "#include \"nwfilter_ipaddrmap.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"nwfilter_gentech_driver.h\"",
      "#include \"nwfilter_driver.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_conf.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include \"internal.h\"",
      "#include \"virlog.h\"",
      "#include \"virdbus.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virNWFilterBuildAll",
          "args": [
            "nwdriver",
            "true"
          ],
          "line": 169
        },
        "resolved": true,
        "details": {
          "function_name": "virNWFilterBuildAll",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_gentech_driver.c",
          "lines": "1006-1048",
          "snippet": "int\nvirNWFilterBuildAll(virNWFilterDriverStatePtr driver,\n                    bool newFilters)\n{\n    struct virNWFilterBuildData data = {\n        .driver = driver,\n    };\n    int ret = 0;\n\n    VIR_DEBUG(\"Build all filters newFilters=%d\", newFilters);\n\n    if (newFilters) {\n        if (!(data.skipInterfaces = virHashCreate(0, NULL)))\n            return -1;\n\n        data.step = STEP_APPLY_NEW;\n        if (virNWFilterBindingObjListForEach(driver->bindings,\n                                             virNWFilterBuildIter,\n                                             &data) < 0)\n            ret = -1;\n\n        if (ret == -1) {\n            data.step = STEP_ROLLBACK;\n            virNWFilterBindingObjListForEach(driver->bindings,\n                                             virNWFilterBuildIter,\n                                             &data);\n        } else  {\n            data.step = STEP_SWITCH;\n            virNWFilterBindingObjListForEach(driver->bindings,\n                                             virNWFilterBuildIter,\n                                             &data);\n        }\n\n        virHashFree(data.skipInterfaces);\n    } else {\n        data.step = STEP_APPLY_CURRENT;\n        if (virNWFilterBindingObjListForEach(driver->bindings,\n                                             virNWFilterBuildIter,\n                                             &data) < 0)\n            ret = -1;\n    }\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virsocketaddr.h\"",
            "#include \"datatypes.h\"",
            "#include \"virnetdev.h\"",
            "#include \"nwfilter_learnipaddr.h\"",
            "#include \"nwfilter_ipaddrmap.h\"",
            "#include \"nwfilter_dhcpsnoop.h\"",
            "#include \"nwfilter_ebiptables_driver.h\"",
            "#include \"nwfilter_gentech_driver.h\"",
            "#include \"virerror.h\"",
            "#include \"domain_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virsocketaddr.h\"\n#include \"datatypes.h\"\n#include \"virnetdev.h\"\n#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ebiptables_driver.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"virerror.h\"\n#include \"domain_conf.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirNWFilterBuildAll(virNWFilterDriverStatePtr driver,\n                    bool newFilters)\n{\n    struct virNWFilterBuildData data = {\n        .driver = driver,\n    };\n    int ret = 0;\n\n    VIR_DEBUG(\"Build all filters newFilters=%d\", newFilters);\n\n    if (newFilters) {\n        if (!(data.skipInterfaces = virHashCreate(0, NULL)))\n            return -1;\n\n        data.step = STEP_APPLY_NEW;\n        if (virNWFilterBindingObjListForEach(driver->bindings,\n                                             virNWFilterBuildIter,\n                                             &data) < 0)\n            ret = -1;\n\n        if (ret == -1) {\n            data.step = STEP_ROLLBACK;\n            virNWFilterBindingObjListForEach(driver->bindings,\n                                             virNWFilterBuildIter,\n                                             &data);\n        } else  {\n            data.step = STEP_SWITCH;\n            virNWFilterBindingObjListForEach(driver->bindings,\n                                             virNWFilterBuildIter,\n                                             &data);\n        }\n\n        virHashFree(data.skipInterfaces);\n    } else {\n        data.step = STEP_APPLY_CURRENT;\n        if (virNWFilterBindingObjListForEach(driver->bindings,\n                                             virNWFilterBuildIter,\n                                             &data) < 0)\n            ret = -1;\n    }\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"nwfilter_driver.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_conf.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"virlog.h\"\n#include \"virdbus.h\"\n#include <config.h>\n\nstatic int\nvirNWFilterTriggerRebuildImpl(void *opaque)\n{\n    virNWFilterDriverStatePtr nwdriver = opaque;\n\n    return virNWFilterBuildAll(nwdriver, true);\n}"
  },
  {
    "function_name": "nwfilterDriverInstallDBusMatches",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_driver.c",
    "lines": "156-160",
    "snippet": "static int\nnwfilterDriverInstallDBusMatches(DBusConnection *sysbus G_GNUC_UNUSED)\n{\n    return 0;\n}",
    "includes": [
      "#include \"nwfilter_learnipaddr.h\"",
      "#include \"nwfilter_dhcpsnoop.h\"",
      "#include \"nwfilter_ipaddrmap.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"nwfilter_gentech_driver.h\"",
      "#include \"nwfilter_driver.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_conf.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include \"internal.h\"",
      "#include \"virlog.h\"",
      "#include \"virdbus.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"nwfilter_driver.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_conf.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"virlog.h\"\n#include \"virdbus.h\"\n#include <config.h>\n\nstatic int\nnwfilterDriverInstallDBusMatches(DBusConnection *sysbus G_GNUC_UNUSED)\n{\n    return 0;\n}"
  },
  {
    "function_name": "nwfilterDriverRemoveDBusMatches",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_driver.c",
    "lines": "151-154",
    "snippet": "static void\nnwfilterDriverRemoveDBusMatches(void)\n{\n}",
    "includes": [
      "#include \"nwfilter_learnipaddr.h\"",
      "#include \"nwfilter_dhcpsnoop.h\"",
      "#include \"nwfilter_ipaddrmap.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"nwfilter_gentech_driver.h\"",
      "#include \"nwfilter_driver.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_conf.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include \"internal.h\"",
      "#include \"virlog.h\"",
      "#include \"virdbus.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"nwfilter_driver.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_conf.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"virlog.h\"\n#include \"virdbus.h\"\n#include <config.h>\n\nstatic void\nnwfilterDriverRemoveDBusMatches(void)\n{\n}"
  },
  {
    "function_name": "nwfilterDriverInstallDBusMatches",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_driver.c",
    "lines": "120-147",
    "snippet": "static int\nnwfilterDriverInstallDBusMatches(DBusConnection *sysbus)\n{\n    int ret = 0;\n\n    if (!sysbus) {\n        ret = -1;\n    } else {\n        /* add matches for\n         * NameOwnerChanged on org.freedesktop.DBus for firewalld start/stop\n         * Reloaded on org.fedoraproject.FirewallD1 for firewalld reload\n         */\n        dbus_bus_add_match(sysbus,\n                           DBUS_RULE_FWD_NAMEOWNERCHANGED,\n                           NULL);\n        dbus_bus_add_match(sysbus,\n                           DBUS_RULE_FWD_RELOADED,\n                           NULL);\n        if (!dbus_connection_add_filter(sysbus, nwfilterFirewalldDBusFilter,\n                                        NULL, NULL)) {\n            VIR_WARN((\"Adding a filter to the DBus connection failed\"));\n            nwfilterDriverRemoveDBusMatches();\n            ret =  -1;\n        }\n    }\n\n    return ret;\n}",
    "includes": [
      "#include \"nwfilter_learnipaddr.h\"",
      "#include \"nwfilter_dhcpsnoop.h\"",
      "#include \"nwfilter_ipaddrmap.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"nwfilter_gentech_driver.h\"",
      "#include \"nwfilter_driver.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_conf.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include \"internal.h\"",
      "#include \"virlog.h\"",
      "#include \"virdbus.h\"",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define DBUS_RULE_FWD_RELOADED \\\n    \"type='signal'\" \\\n    \",interface='org.fedoraproject.FirewallD1'\" \\\n    \",member='Reloaded'\"",
      "#define DBUS_RULE_FWD_NAMEOWNERCHANGED \\\n    \"type='signal'\" \\\n    \",interface='\"DBUS_INTERFACE_DBUS\"'\" \\\n    \",member='NameOwnerChanged'\" \\\n    \",arg0='org.fedoraproject.FirewallD1'\""
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nwfilterDriverRemoveDBusMatches",
          "args": [],
          "line": 141
        },
        "resolved": true,
        "details": {
          "function_name": "nwfilterDriverRemoveDBusMatches",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_driver.c",
          "lines": "151-154",
          "snippet": "static void\nnwfilterDriverRemoveDBusMatches(void)\n{\n}",
          "includes": [
            "#include \"nwfilter_learnipaddr.h\"",
            "#include \"nwfilter_dhcpsnoop.h\"",
            "#include \"nwfilter_ipaddrmap.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"configmake.h\"",
            "#include \"nwfilter_gentech_driver.h\"",
            "#include \"nwfilter_driver.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_conf.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"virlog.h\"",
            "#include \"virdbus.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"nwfilter_driver.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_conf.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"virlog.h\"\n#include \"virdbus.h\"\n#include <config.h>\n\nstatic void\nnwfilterDriverRemoveDBusMatches(void)\n{\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_WARN",
          "args": [
            "(\"Adding a filter to the DBus connection failed\")"
          ],
          "line": 140
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dbus_connection_add_filter",
          "args": [
            "sysbus",
            "nwfilterFirewalldDBusFilter",
            "NULL",
            "NULL"
          ],
          "line": 138
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dbus_bus_add_match",
          "args": [
            "sysbus",
            "DBUS_RULE_FWD_RELOADED",
            "NULL"
          ],
          "line": 135
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dbus_bus_add_match",
          "args": [
            "sysbus",
            "DBUS_RULE_FWD_NAMEOWNERCHANGED",
            "NULL"
          ],
          "line": 132
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"nwfilter_driver.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_conf.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"virlog.h\"\n#include \"virdbus.h\"\n#include <config.h>\n\n#define DBUS_RULE_FWD_RELOADED \\\n    \"type='signal'\" \\\n    \",interface='org.fedoraproject.FirewallD1'\" \\\n    \",member='Reloaded'\"\n#define DBUS_RULE_FWD_NAMEOWNERCHANGED \\\n    \"type='signal'\" \\\n    \",interface='\"DBUS_INTERFACE_DBUS\"'\" \\\n    \",member='NameOwnerChanged'\" \\\n    \",arg0='org.fedoraproject.FirewallD1'\"\n\nstatic int\nnwfilterDriverInstallDBusMatches(DBusConnection *sysbus)\n{\n    int ret = 0;\n\n    if (!sysbus) {\n        ret = -1;\n    } else {\n        /* add matches for\n         * NameOwnerChanged on org.freedesktop.DBus for firewalld start/stop\n         * Reloaded on org.fedoraproject.FirewallD1 for firewalld reload\n         */\n        dbus_bus_add_match(sysbus,\n                           DBUS_RULE_FWD_NAMEOWNERCHANGED,\n                           NULL);\n        dbus_bus_add_match(sysbus,\n                           DBUS_RULE_FWD_RELOADED,\n                           NULL);\n        if (!dbus_connection_add_filter(sysbus, nwfilterFirewalldDBusFilter,\n                                        NULL, NULL)) {\n            VIR_WARN((\"Adding a filter to the DBus connection failed\"));\n            nwfilterDriverRemoveDBusMatches();\n            ret =  -1;\n        }\n    }\n\n    return ret;\n}"
  },
  {
    "function_name": "nwfilterDriverRemoveDBusMatches",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_driver.c",
    "lines": "98-113",
    "snippet": "static void\nnwfilterDriverRemoveDBusMatches(void)\n{\n    DBusConnection *sysbus;\n\n    sysbus = virDBusGetSystemBus();\n    if (sysbus) {\n        dbus_bus_remove_match(sysbus,\n                              DBUS_RULE_FWD_NAMEOWNERCHANGED,\n                              NULL);\n        dbus_bus_remove_match(sysbus,\n                              DBUS_RULE_FWD_RELOADED,\n                              NULL);\n        dbus_connection_remove_filter(sysbus, nwfilterFirewalldDBusFilter, NULL);\n    }\n}",
    "includes": [
      "#include \"nwfilter_learnipaddr.h\"",
      "#include \"nwfilter_dhcpsnoop.h\"",
      "#include \"nwfilter_ipaddrmap.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"nwfilter_gentech_driver.h\"",
      "#include \"nwfilter_driver.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_conf.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include \"internal.h\"",
      "#include \"virlog.h\"",
      "#include \"virdbus.h\"",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define DBUS_RULE_FWD_RELOADED \\\n    \"type='signal'\" \\\n    \",interface='org.fedoraproject.FirewallD1'\" \\\n    \",member='Reloaded'\"",
      "#define DBUS_RULE_FWD_NAMEOWNERCHANGED \\\n    \"type='signal'\" \\\n    \",interface='\"DBUS_INTERFACE_DBUS\"'\" \\\n    \",member='NameOwnerChanged'\" \\\n    \",arg0='org.fedoraproject.FirewallD1'\""
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dbus_connection_remove_filter",
          "args": [
            "sysbus",
            "nwfilterFirewalldDBusFilter",
            "NULL"
          ],
          "line": 111
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dbus_bus_remove_match",
          "args": [
            "sysbus",
            "DBUS_RULE_FWD_RELOADED",
            "NULL"
          ],
          "line": 108
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dbus_bus_remove_match",
          "args": [
            "sysbus",
            "DBUS_RULE_FWD_NAMEOWNERCHANGED",
            "NULL"
          ],
          "line": 105
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDBusGetSystemBus",
          "args": [],
          "line": 103
        },
        "resolved": true,
        "details": {
          "function_name": "virDBusGetSystemBus",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virdbus.c",
          "lines": "1744-1749",
          "snippet": "DBusConnection *virDBusGetSystemBus(void)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   \"%s\", _(\"DBus support not compiled into this binary\"));\n    return NULL;\n}",
          "includes": [
            "#include \"virprobe.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virdbuspriv.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virprobe.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virdbuspriv.h\"\n#include <config.h>\n\nDBusConnection *virDBusGetSystemBus(void)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   \"%s\", _(\"DBus support not compiled into this binary\"));\n    return NULL;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"nwfilter_driver.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_conf.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"virlog.h\"\n#include \"virdbus.h\"\n#include <config.h>\n\n#define DBUS_RULE_FWD_RELOADED \\\n    \"type='signal'\" \\\n    \",interface='org.fedoraproject.FirewallD1'\" \\\n    \",member='Reloaded'\"\n#define DBUS_RULE_FWD_NAMEOWNERCHANGED \\\n    \"type='signal'\" \\\n    \",interface='\"DBUS_INTERFACE_DBUS\"'\" \\\n    \",member='NameOwnerChanged'\" \\\n    \",arg0='org.fedoraproject.FirewallD1'\"\n\nstatic void\nnwfilterDriverRemoveDBusMatches(void)\n{\n    DBusConnection *sysbus;\n\n    sysbus = virDBusGetSystemBus();\n    if (sysbus) {\n        dbus_bus_remove_match(sysbus,\n                              DBUS_RULE_FWD_NAMEOWNERCHANGED,\n                              NULL);\n        dbus_bus_remove_match(sysbus,\n                              DBUS_RULE_FWD_RELOADED,\n                              NULL);\n        dbus_connection_remove_filter(sysbus, nwfilterFirewalldDBusFilter, NULL);\n    }\n}"
  },
  {
    "function_name": "nwfilterFirewalldDBusFilter",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_driver.c",
    "lines": "82-96",
    "snippet": "static DBusHandlerResult\nnwfilterFirewalldDBusFilter(DBusConnection *connection G_GNUC_UNUSED,\n                            DBusMessage *message,\n                            void *user_data G_GNUC_UNUSED)\n{\n    if (dbus_message_is_signal(message, DBUS_INTERFACE_DBUS,\n                               \"NameOwnerChanged\") ||\n        dbus_message_is_signal(message, \"org.fedoraproject.FirewallD1\",\n                               \"Reloaded\")) {\n        VIR_DEBUG(\"Reload in nwfilter_driver because of firewalld.\");\n        nwfilterStateReload();\n    }\n\n    return DBUS_HANDLER_RESULT_NOT_YET_HANDLED;\n}",
    "includes": [
      "#include \"nwfilter_learnipaddr.h\"",
      "#include \"nwfilter_dhcpsnoop.h\"",
      "#include \"nwfilter_ipaddrmap.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"nwfilter_gentech_driver.h\"",
      "#include \"nwfilter_driver.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_conf.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include \"internal.h\"",
      "#include \"virlog.h\"",
      "#include \"virdbus.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static int nwfilterStateReload(void);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "nwfilterStateReload",
          "args": [],
          "line": 92
        },
        "resolved": true,
        "details": {
          "function_name": "nwfilterStateReload",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_driver.c",
          "lines": "318-343",
          "snippet": "static int\nnwfilterStateReload(void)\n{\n    if (!driver)\n        return -1;\n\n    if (!driver->privileged)\n        return 0;\n\n    virNWFilterDHCPSnoopEnd(NULL);\n    /* shut down all threads -- they will be restarted if necessary */\n    virNWFilterLearnThreadsTerminate(true);\n\n    nwfilterDriverLock();\n    virNWFilterWriteLockFilterUpdates();\n\n    virNWFilterObjListLoadAllConfigs(driver->nwfilters, driver->configDir);\n\n    virNWFilterUnlockFilterUpdates();\n\n    virNWFilterBuildAll(driver, false);\n\n    nwfilterDriverUnlock();\n\n    return 0;\n}",
          "includes": [
            "#include \"nwfilter_learnipaddr.h\"",
            "#include \"nwfilter_dhcpsnoop.h\"",
            "#include \"nwfilter_ipaddrmap.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfile.h\"",
            "#include \"configmake.h\"",
            "#include \"nwfilter_gentech_driver.h\"",
            "#include \"nwfilter_driver.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"domain_conf.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"virlog.h\"",
            "#include \"virdbus.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virNWFilterDriverStatePtr driver;",
            "static int nwfilterStateReload(void);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"nwfilter_driver.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_conf.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"virlog.h\"\n#include \"virdbus.h\"\n#include <config.h>\n\nstatic virNWFilterDriverStatePtr driver;\nstatic int nwfilterStateReload(void);\n\nstatic int\nnwfilterStateReload(void)\n{\n    if (!driver)\n        return -1;\n\n    if (!driver->privileged)\n        return 0;\n\n    virNWFilterDHCPSnoopEnd(NULL);\n    /* shut down all threads -- they will be restarted if necessary */\n    virNWFilterLearnThreadsTerminate(true);\n\n    nwfilterDriverLock();\n    virNWFilterWriteLockFilterUpdates();\n\n    virNWFilterObjListLoadAllConfigs(driver->nwfilters, driver->configDir);\n\n    virNWFilterUnlockFilterUpdates();\n\n    virNWFilterBuildAll(driver, false);\n\n    nwfilterDriverUnlock();\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Reload in nwfilter_driver because of firewalld.\""
          ],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dbus_message_is_signal",
          "args": [
            "message",
            "\"org.fedoraproject.FirewallD1\"",
            "\"Reloaded\""
          ],
          "line": 89
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dbus_message_is_signal",
          "args": [
            "message",
            "DBUS_INTERFACE_DBUS",
            "\"NameOwnerChanged\""
          ],
          "line": 87
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"nwfilter_driver.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_conf.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"virlog.h\"\n#include \"virdbus.h\"\n#include <config.h>\n\nstatic int nwfilterStateReload(void);\n\nstatic DBusHandlerResult\nnwfilterFirewalldDBusFilter(DBusConnection *connection G_GNUC_UNUSED,\n                            DBusMessage *message,\n                            void *user_data G_GNUC_UNUSED)\n{\n    if (dbus_message_is_signal(message, DBUS_INTERFACE_DBUS,\n                               \"NameOwnerChanged\") ||\n        dbus_message_is_signal(message, \"org.fedoraproject.FirewallD1\",\n                               \"Reloaded\")) {\n        VIR_DEBUG(\"Reload in nwfilter_driver because of firewalld.\");\n        nwfilterStateReload();\n    }\n\n    return DBUS_HANDLER_RESULT_NOT_YET_HANDLED;\n}"
  },
  {
    "function_name": "nwfilterDriverUnlock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_driver.c",
    "lines": "75-78",
    "snippet": "static void nwfilterDriverUnlock(void)\n{\n    virMutexUnlock(&driver->lock);\n}",
    "includes": [
      "#include \"nwfilter_learnipaddr.h\"",
      "#include \"nwfilter_dhcpsnoop.h\"",
      "#include \"nwfilter_ipaddrmap.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"nwfilter_gentech_driver.h\"",
      "#include \"nwfilter_driver.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_conf.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include \"internal.h\"",
      "#include \"virlog.h\"",
      "#include \"virdbus.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virNWFilterDriverStatePtr driver;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virMutexUnlock",
          "args": [
            "&driver->lock"
          ],
          "line": 77
        },
        "resolved": true,
        "details": {
          "function_name": "virMutexUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virthread.c",
          "lines": "86-89",
          "snippet": "void virMutexUnlock(virMutexPtr m)\n{\n    pthread_mutex_unlock(&m->lock);\n}",
          "includes": [
            "#include \"virthreadjob.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/syscall.h>",
            "#include <inttypes.h>",
            "#include <unistd.h>",
            "# include <pthread_np.h>",
            "#include \"virthread.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthreadjob.h\"\n#include \"viralloc.h\"\n# include <sys/syscall.h>\n#include <inttypes.h>\n#include <unistd.h>\n# include <pthread_np.h>\n#include \"virthread.h\"\n#include <config.h>\n\nvoid virMutexUnlock(virMutexPtr m)\n{\n    pthread_mutex_unlock(&m->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"nwfilter_driver.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_conf.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"virlog.h\"\n#include \"virdbus.h\"\n#include <config.h>\n\nstatic virNWFilterDriverStatePtr driver;\n\nstatic void nwfilterDriverUnlock(void)\n{\n    virMutexUnlock(&driver->lock);\n}"
  },
  {
    "function_name": "nwfilterDriverLock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/nwfilter/nwfilter_driver.c",
    "lines": "71-74",
    "snippet": "static void nwfilterDriverLock(void)\n{\n    virMutexLock(&driver->lock);\n}",
    "includes": [
      "#include \"nwfilter_learnipaddr.h\"",
      "#include \"nwfilter_dhcpsnoop.h\"",
      "#include \"nwfilter_ipaddrmap.h\"",
      "#include \"viraccessapicheck.h\"",
      "#include \"virstring.h\"",
      "#include \"virpidfile.h\"",
      "#include \"virfile.h\"",
      "#include \"configmake.h\"",
      "#include \"nwfilter_gentech_driver.h\"",
      "#include \"nwfilter_driver.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"domain_conf.h\"",
      "#include \"viralloc.h\"",
      "#include \"datatypes.h\"",
      "#include \"virerror.h\"",
      "#include \"internal.h\"",
      "#include \"virlog.h\"",
      "#include \"virdbus.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static virNWFilterDriverStatePtr driver;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virMutexLock",
          "args": [
            "&driver->lock"
          ],
          "line": 73
        },
        "resolved": true,
        "details": {
          "function_name": "virMutexLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virthread.c",
          "lines": "81-84",
          "snippet": "void virMutexLock(virMutexPtr m)\n{\n    pthread_mutex_lock(&m->lock);\n}",
          "includes": [
            "#include \"virthreadjob.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/syscall.h>",
            "#include <inttypes.h>",
            "#include <unistd.h>",
            "# include <pthread_np.h>",
            "#include \"virthread.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthreadjob.h\"\n#include \"viralloc.h\"\n# include <sys/syscall.h>\n#include <inttypes.h>\n#include <unistd.h>\n# include <pthread_np.h>\n#include \"virthread.h\"\n#include <config.h>\n\nvoid virMutexLock(virMutexPtr m)\n{\n    pthread_mutex_lock(&m->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nwfilter_learnipaddr.h\"\n#include \"nwfilter_dhcpsnoop.h\"\n#include \"nwfilter_ipaddrmap.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virpidfile.h\"\n#include \"virfile.h\"\n#include \"configmake.h\"\n#include \"nwfilter_gentech_driver.h\"\n#include \"nwfilter_driver.h\"\n#include \"domain_nwfilter.h\"\n#include \"domain_conf.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"virlog.h\"\n#include \"virdbus.h\"\n#include <config.h>\n\nstatic virNWFilterDriverStatePtr driver;\n\nstatic void nwfilterDriverLock(void)\n{\n    virMutexLock(&driver->lock);\n}"
  }
]