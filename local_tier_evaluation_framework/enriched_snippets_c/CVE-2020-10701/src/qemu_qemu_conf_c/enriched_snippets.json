[
  {
    "function_name": "qemuGetMemoryBackingPath",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
    "lines": "1985-2005",
    "snippet": "int\nqemuGetMemoryBackingPath(const virDomainDef *def,\n                         virQEMUDriverConfigPtr cfg,\n                         const char *alias,\n                         char **memPath)\n{\n    g_autofree char *domainPath = NULL;\n\n    if (!alias) {\n        /* This should never happen (TM) */\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"memory device alias is not assigned\"));\n        return -1;\n    }\n\n    if (qemuGetMemoryBackingDomainPath(def, cfg, &domainPath) < 0)\n        return -1;\n\n    *memPath = g_strdup_printf(\"%s/%s\", domainPath, alias);\n    return 0;\n}",
    "includes": [
      "#include \"configmake.h\"",
      "#include \"virutil.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virstring.h\"",
      "#include \"virsocket.h\"",
      "#include \"virfile.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virlog.h\"",
      "#include \"virxml.h\"",
      "#include \"datatypes.h\"",
      "#include \"viralloc.h\"",
      "#include \"virconf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_firmware.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_capabilities.h\"",
      "#include \"qemu_conf.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"%s/%s\"",
            "domainPath",
            "alias"
          ],
          "line": 2003
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuGetMemoryBackingDomainPath",
          "args": [
            "def",
            "cfg",
            "&domainPath"
          ],
          "line": 2000
        },
        "resolved": true,
        "details": {
          "function_name": "qemuGetMemoryBackingDomainPath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
          "lines": "1955-1970",
          "snippet": "int\nqemuGetMemoryBackingDomainPath(const virDomainDef *def,\n                               virQEMUDriverConfigPtr cfg,\n                               char **path)\n{\n    g_autofree char *shortName = NULL;\n    g_autofree char *base = NULL;\n\n    if (!(shortName = virDomainDefGetShortName(def)))\n        return -1;\n\n    qemuGetMemoryBackingBasePath(cfg, &base);\n    *path = g_strdup_printf(\"%s/%s\", base, shortName);\n\n    return 0;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virutil.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virsocket.h\"",
            "#include \"virfile.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virlog.h\"",
            "#include \"virxml.h\"",
            "#include \"datatypes.h\"",
            "#include \"viralloc.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_firmware.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nint\nqemuGetMemoryBackingDomainPath(const virDomainDef *def,\n                               virQEMUDriverConfigPtr cfg,\n                               char **path)\n{\n    g_autofree char *shortName = NULL;\n    g_autofree char *base = NULL;\n\n    if (!(shortName = virDomainDefGetShortName(def)))\n        return -1;\n\n    qemuGetMemoryBackingBasePath(cfg, &base);\n    *path = g_strdup_printf(\"%s/%s\", base, shortName);\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"memory device alias is not assigned\")"
          ],
          "line": 1995
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"memory device alias is not assigned\""
          ],
          "line": 1996
        },
        "resolved": true,
        "details": {
          "function_name": "bswap_header",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_driver.c",
          "lines": "2852-2860",
          "snippet": "static inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virenum.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virqemu.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virnuma.h\"",
            "#include \"virperf.h\"",
            "#include \"vircgroup.h\"",
            "#include \"domain_capabilities.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapicheckqemu.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virkeycode.h\"",
            "#include \"locking/domain_lock.h\"",
            "#include \"locking/lock_manager.h\"",
            "#include \"virthreadpool.h\"",
            "#include \"configmake.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virhook.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virxml.h\"",
            "#include \"libvirt_internal.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virusb.h\"",
            "#include \"virpci.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"domain_conf.h\"",
            "#include \"viruuid.h\"",
            "#include \"virarptable.h\"",
            "#include \"viralloc.h\"",
            "#include \"capabilities.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virbuffer.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"qemu_backup.h\"",
            "#include \"qemu_checkpoint.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_blockjob.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_monitor.h\"",
            "#include \"qemu_hotplug.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"qemu_block.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_agent.h\"",
            "#include \"qemu_driver.h\"",
            "#include <sys/ioctl.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <dirent.h>",
            "#include <sys/time.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virenum.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virqemu.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virnuma.h\"\n#include \"virperf.h\"\n#include \"vircgroup.h\"\n#include \"domain_capabilities.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapicheckqemu.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virbitmap.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virnodesuspend.h\"\n#include \"virkeycode.h\"\n#include \"locking/domain_lock.h\"\n#include \"locking/lock_manager.h\"\n#include \"virthreadpool.h\"\n#include \"configmake.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"virhook.h\"\n#include \"domain_nwfilter.h\"\n#include \"virsysinfo.h\"\n#include \"cpu/cpu.h\"\n#include \"virxml.h\"\n#include \"libvirt_internal.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virusb.h\"\n#include \"virpci.h\"\n#include \"node_device_conf.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"domain_conf.h\"\n#include \"viruuid.h\"\n#include \"virarptable.h\"\n#include \"viralloc.h\"\n#include \"capabilities.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevtap.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"qemu_backup.h\"\n#include \"qemu_checkpoint.h\"\n#include \"qemu_security.h\"\n#include \"qemu_blockjob.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_process.h\"\n#include \"qemu_monitor.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_cgroup.h\"\n#include \"qemu_command.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"qemu_block.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_agent.h\"\n#include \"qemu_driver.h\"\n#include <sys/ioctl.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <dirent.h>\n#include <sys/time.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nint\nqemuGetMemoryBackingPath(const virDomainDef *def,\n                         virQEMUDriverConfigPtr cfg,\n                         const char *alias,\n                         char **memPath)\n{\n    g_autofree char *domainPath = NULL;\n\n    if (!alias) {\n        /* This should never happen (TM) */\n        virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                       _(\"memory device alias is not assigned\"));\n        return -1;\n    }\n\n    if (qemuGetMemoryBackingDomainPath(def, cfg, &domainPath) < 0)\n        return -1;\n\n    *memPath = g_strdup_printf(\"%s/%s\", domainPath, alias);\n    return 0;\n}"
  },
  {
    "function_name": "qemuGetMemoryBackingDomainPath",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
    "lines": "1955-1970",
    "snippet": "int\nqemuGetMemoryBackingDomainPath(const virDomainDef *def,\n                               virQEMUDriverConfigPtr cfg,\n                               char **path)\n{\n    g_autofree char *shortName = NULL;\n    g_autofree char *base = NULL;\n\n    if (!(shortName = virDomainDefGetShortName(def)))\n        return -1;\n\n    qemuGetMemoryBackingBasePath(cfg, &base);\n    *path = g_strdup_printf(\"%s/%s\", base, shortName);\n\n    return 0;\n}",
    "includes": [
      "#include \"configmake.h\"",
      "#include \"virutil.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virstring.h\"",
      "#include \"virsocket.h\"",
      "#include \"virfile.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virlog.h\"",
      "#include \"virxml.h\"",
      "#include \"datatypes.h\"",
      "#include \"viralloc.h\"",
      "#include \"virconf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_firmware.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_capabilities.h\"",
      "#include \"qemu_conf.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"%s/%s\"",
            "base",
            "shortName"
          ],
          "line": 1967
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuGetMemoryBackingBasePath",
          "args": [
            "cfg",
            "&base"
          ],
          "line": 1966
        },
        "resolved": true,
        "details": {
          "function_name": "qemuGetMemoryBackingBasePath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
          "lines": "1947-1952",
          "snippet": "void\nqemuGetMemoryBackingBasePath(virQEMUDriverConfigPtr cfg,\n                             char **path)\n{\n    *path = g_strdup_printf(\"%s/libvirt/qemu\", cfg->memoryBackingDir);\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virutil.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virsocket.h\"",
            "#include \"virfile.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virlog.h\"",
            "#include \"virxml.h\"",
            "#include \"datatypes.h\"",
            "#include \"viralloc.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_firmware.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvoid\nqemuGetMemoryBackingBasePath(virQEMUDriverConfigPtr cfg,\n                             char **path)\n{\n    *path = g_strdup_printf(\"%s/libvirt/qemu\", cfg->memoryBackingDir);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDefGetShortName",
          "args": [
            "def"
          ],
          "line": 1963
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDefGetShortName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "30900-30952",
          "snippet": "char *\nvirDomainDefGetShortName(const virDomainDef *def)\n{\n    wchar_t wshortname[VIR_DOMAIN_SHORT_NAME_MAX + 1] = {0};\n    size_t len = 0;\n    char *ret = NULL;\n    g_autofree char *shortname = NULL;\n\n    /* No need to do the whole conversion thing when there are no multibyte\n     * characters.  The same applies for illegal sequences as they can occur\n     * with incompatible locales. */\n    len = mbstowcs(NULL, def->name, 0);\n    if ((len == (size_t) -1 && errno == EILSEQ) ||\n        len == strlen(def->name)) {\n        ret = g_strdup_printf(\"%d-%.*s\", def->id, VIR_DOMAIN_SHORT_NAME_MAX, def->name);\n        return ret;\n    }\n\n    if (len == (size_t) -1) {\n        virReportSystemError(errno, \"%s\",\n                             _(\"Cannot convert domain name to \"\n                               \"wide character string\"));\n        return NULL;\n    }\n\n    if (mbstowcs(wshortname, def->name, VIR_DOMAIN_SHORT_NAME_MAX) == (size_t) -1) {\n        virReportSystemError(errno, \"%s\",\n                             _(\"Cannot convert domain name to \"\n                               \"wide character string\"));\n        return NULL;\n    }\n\n    len = wcstombs(NULL, wshortname, 0);\n    if (len == (size_t) -1) {\n        virReportSystemError(errno, \"%s\",\n                             _(\"Cannot convert wide character string \"\n                               \"back to multi-byte domain name\"));\n        return NULL;\n    }\n\n    if (VIR_ALLOC_N(shortname, len + 1) < 0)\n        return NULL;\n\n    if (wcstombs(shortname, wshortname, len) == (size_t) -1) {\n        virReportSystemError(errno, \"%s\",\n                             _(\"Cannot convert wide character string \"\n                               \"back to multi-byte domain name\"));\n        return NULL;\n    }\n\n    ret = g_strdup_printf(\"%d-%s\", def->id, shortname);\n    return ret;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define VIR_DOMAIN_SHORT_NAME_MAX 20"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\n#define VIR_DOMAIN_SHORT_NAME_MAX 20\n\nchar *\nvirDomainDefGetShortName(const virDomainDef *def)\n{\n    wchar_t wshortname[VIR_DOMAIN_SHORT_NAME_MAX + 1] = {0};\n    size_t len = 0;\n    char *ret = NULL;\n    g_autofree char *shortname = NULL;\n\n    /* No need to do the whole conversion thing when there are no multibyte\n     * characters.  The same applies for illegal sequences as they can occur\n     * with incompatible locales. */\n    len = mbstowcs(NULL, def->name, 0);\n    if ((len == (size_t) -1 && errno == EILSEQ) ||\n        len == strlen(def->name)) {\n        ret = g_strdup_printf(\"%d-%.*s\", def->id, VIR_DOMAIN_SHORT_NAME_MAX, def->name);\n        return ret;\n    }\n\n    if (len == (size_t) -1) {\n        virReportSystemError(errno, \"%s\",\n                             _(\"Cannot convert domain name to \"\n                               \"wide character string\"));\n        return NULL;\n    }\n\n    if (mbstowcs(wshortname, def->name, VIR_DOMAIN_SHORT_NAME_MAX) == (size_t) -1) {\n        virReportSystemError(errno, \"%s\",\n                             _(\"Cannot convert domain name to \"\n                               \"wide character string\"));\n        return NULL;\n    }\n\n    len = wcstombs(NULL, wshortname, 0);\n    if (len == (size_t) -1) {\n        virReportSystemError(errno, \"%s\",\n                             _(\"Cannot convert wide character string \"\n                               \"back to multi-byte domain name\"));\n        return NULL;\n    }\n\n    if (VIR_ALLOC_N(shortname, len + 1) < 0)\n        return NULL;\n\n    if (wcstombs(shortname, wshortname, len) == (size_t) -1) {\n        virReportSystemError(errno, \"%s\",\n                             _(\"Cannot convert wide character string \"\n                               \"back to multi-byte domain name\"));\n        return NULL;\n    }\n\n    ret = g_strdup_printf(\"%d-%s\", def->id, shortname);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nint\nqemuGetMemoryBackingDomainPath(const virDomainDef *def,\n                               virQEMUDriverConfigPtr cfg,\n                               char **path)\n{\n    g_autofree char *shortName = NULL;\n    g_autofree char *base = NULL;\n\n    if (!(shortName = virDomainDefGetShortName(def)))\n        return -1;\n\n    qemuGetMemoryBackingBasePath(cfg, &base);\n    *path = g_strdup_printf(\"%s/%s\", base, shortName);\n\n    return 0;\n}"
  },
  {
    "function_name": "qemuGetMemoryBackingBasePath",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
    "lines": "1947-1952",
    "snippet": "void\nqemuGetMemoryBackingBasePath(virQEMUDriverConfigPtr cfg,\n                             char **path)\n{\n    *path = g_strdup_printf(\"%s/libvirt/qemu\", cfg->memoryBackingDir);\n}",
    "includes": [
      "#include \"configmake.h\"",
      "#include \"virutil.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virstring.h\"",
      "#include \"virsocket.h\"",
      "#include \"virfile.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virlog.h\"",
      "#include \"virxml.h\"",
      "#include \"datatypes.h\"",
      "#include \"viralloc.h\"",
      "#include \"virconf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_firmware.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_capabilities.h\"",
      "#include \"qemu_conf.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"%s/libvirt/qemu\"",
            "cfg->memoryBackingDir"
          ],
          "line": 1951
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvoid\nqemuGetMemoryBackingBasePath(virQEMUDriverConfigPtr cfg,\n                             char **path)\n{\n    *path = g_strdup_printf(\"%s/libvirt/qemu\", cfg->memoryBackingDir);\n}"
  },
  {
    "function_name": "qemuGetDomainHupageMemPath",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
    "lines": "1912-1944",
    "snippet": "int\nqemuGetDomainHupageMemPath(const virDomainDef *def,\n                           virQEMUDriverConfigPtr cfg,\n                           unsigned long long pagesize,\n                           char **memPath)\n{\n    size_t i = 0;\n\n    if (!cfg->nhugetlbfs) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"hugetlbfs filesystem is not mounted \"\n                               \"or disabled by administrator config\"));\n        return -1;\n    }\n\n    for (i = 0; i < cfg->nhugetlbfs; i++) {\n        if (cfg->hugetlbfs[i].size == pagesize)\n            break;\n    }\n\n    if (i == cfg->nhugetlbfs) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Unable to find any usable hugetlbfs \"\n                         \"mount for %llu KiB\"),\n                       pagesize);\n        return -1;\n    }\n\n    if (!(*memPath = qemuGetDomainHugepagePath(def, &cfg->hugetlbfs[i])))\n        return -1;\n\n    return 0;\n}",
    "includes": [
      "#include \"configmake.h\"",
      "#include \"virutil.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virstring.h\"",
      "#include \"virsocket.h\"",
      "#include \"virfile.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virlog.h\"",
      "#include \"virxml.h\"",
      "#include \"datatypes.h\"",
      "#include \"viralloc.h\"",
      "#include \"virconf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_firmware.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_capabilities.h\"",
      "#include \"qemu_conf.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "qemuGetDomainHugepagePath",
          "args": [
            "def",
            "&cfg->hugetlbfs[i]"
          ],
          "line": 1940
        },
        "resolved": true,
        "details": {
          "function_name": "qemuGetDomainHugepagePath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
          "lines": "1890-1901",
          "snippet": "char *\nqemuGetDomainHugepagePath(const virDomainDef *def,\n                          virHugeTLBFSPtr hugepage)\n{\n    g_autofree char *base = qemuGetBaseHugepagePath(hugepage);\n    g_autofree char *domPath = virDomainDefGetShortName(def);\n    char *ret = NULL;\n\n    if (base && domPath)\n        ret = g_strdup_printf(\"%s/%s\", base, domPath);\n    return ret;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virutil.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virsocket.h\"",
            "#include \"virfile.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virlog.h\"",
            "#include \"virxml.h\"",
            "#include \"datatypes.h\"",
            "#include \"viralloc.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_firmware.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nchar *\nqemuGetDomainHugepagePath(const virDomainDef *def,\n                          virHugeTLBFSPtr hugepage)\n{\n    g_autofree char *base = qemuGetBaseHugepagePath(hugepage);\n    g_autofree char *domPath = virDomainDefGetShortName(def);\n    char *ret = NULL;\n\n    if (base && domPath)\n        ret = g_strdup_printf(\"%s/%s\", base, domPath);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Unable to find any usable hugetlbfs \"\n                         \"mount for %llu KiB\")",
            "pagesize"
          ],
          "line": 1933
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to find any usable hugetlbfs \"\n                         \"mount for %llu KiB\""
          ],
          "line": 1934
        },
        "resolved": true,
        "details": {
          "function_name": "bswap_header",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_driver.c",
          "lines": "2852-2860",
          "snippet": "static inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virenum.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virqemu.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virnuma.h\"",
            "#include \"virperf.h\"",
            "#include \"vircgroup.h\"",
            "#include \"domain_capabilities.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapicheckqemu.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virkeycode.h\"",
            "#include \"locking/domain_lock.h\"",
            "#include \"locking/lock_manager.h\"",
            "#include \"virthreadpool.h\"",
            "#include \"configmake.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virhook.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virxml.h\"",
            "#include \"libvirt_internal.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virusb.h\"",
            "#include \"virpci.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"domain_conf.h\"",
            "#include \"viruuid.h\"",
            "#include \"virarptable.h\"",
            "#include \"viralloc.h\"",
            "#include \"capabilities.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virbuffer.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"qemu_backup.h\"",
            "#include \"qemu_checkpoint.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_blockjob.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_monitor.h\"",
            "#include \"qemu_hotplug.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"qemu_block.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_agent.h\"",
            "#include \"qemu_driver.h\"",
            "#include <sys/ioctl.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <dirent.h>",
            "#include <sys/time.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virenum.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virqemu.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virnuma.h\"\n#include \"virperf.h\"\n#include \"vircgroup.h\"\n#include \"domain_capabilities.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapicheckqemu.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virbitmap.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virnodesuspend.h\"\n#include \"virkeycode.h\"\n#include \"locking/domain_lock.h\"\n#include \"locking/lock_manager.h\"\n#include \"virthreadpool.h\"\n#include \"configmake.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"virhook.h\"\n#include \"domain_nwfilter.h\"\n#include \"virsysinfo.h\"\n#include \"cpu/cpu.h\"\n#include \"virxml.h\"\n#include \"libvirt_internal.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virusb.h\"\n#include \"virpci.h\"\n#include \"node_device_conf.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"domain_conf.h\"\n#include \"viruuid.h\"\n#include \"virarptable.h\"\n#include \"viralloc.h\"\n#include \"capabilities.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevtap.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"qemu_backup.h\"\n#include \"qemu_checkpoint.h\"\n#include \"qemu_security.h\"\n#include \"qemu_blockjob.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_process.h\"\n#include \"qemu_monitor.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_cgroup.h\"\n#include \"qemu_command.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"qemu_block.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_agent.h\"\n#include \"qemu_driver.h\"\n#include <sys/ioctl.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <dirent.h>\n#include <sys/time.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"hugetlbfs filesystem is not mounted \"\n                               \"or disabled by administrator config\")"
          ],
          "line": 1921
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nint\nqemuGetDomainHupageMemPath(const virDomainDef *def,\n                           virQEMUDriverConfigPtr cfg,\n                           unsigned long long pagesize,\n                           char **memPath)\n{\n    size_t i = 0;\n\n    if (!cfg->nhugetlbfs) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"hugetlbfs filesystem is not mounted \"\n                               \"or disabled by administrator config\"));\n        return -1;\n    }\n\n    for (i = 0; i < cfg->nhugetlbfs; i++) {\n        if (cfg->hugetlbfs[i].size == pagesize)\n            break;\n    }\n\n    if (i == cfg->nhugetlbfs) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"Unable to find any usable hugetlbfs \"\n                         \"mount for %llu KiB\"),\n                       pagesize);\n        return -1;\n    }\n\n    if (!(*memPath = qemuGetDomainHugepagePath(def, &cfg->hugetlbfs[i])))\n        return -1;\n\n    return 0;\n}"
  },
  {
    "function_name": "qemuGetDomainHugepagePath",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
    "lines": "1890-1901",
    "snippet": "char *\nqemuGetDomainHugepagePath(const virDomainDef *def,\n                          virHugeTLBFSPtr hugepage)\n{\n    g_autofree char *base = qemuGetBaseHugepagePath(hugepage);\n    g_autofree char *domPath = virDomainDefGetShortName(def);\n    char *ret = NULL;\n\n    if (base && domPath)\n        ret = g_strdup_printf(\"%s/%s\", base, domPath);\n    return ret;\n}",
    "includes": [
      "#include \"configmake.h\"",
      "#include \"virutil.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virstring.h\"",
      "#include \"virsocket.h\"",
      "#include \"virfile.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virlog.h\"",
      "#include \"virxml.h\"",
      "#include \"datatypes.h\"",
      "#include \"viralloc.h\"",
      "#include \"virconf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_firmware.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_capabilities.h\"",
      "#include \"qemu_conf.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"%s/%s\"",
            "base",
            "domPath"
          ],
          "line": 1899
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDefGetShortName",
          "args": [
            "def"
          ],
          "line": 1895
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDefGetShortName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "30900-30952",
          "snippet": "char *\nvirDomainDefGetShortName(const virDomainDef *def)\n{\n    wchar_t wshortname[VIR_DOMAIN_SHORT_NAME_MAX + 1] = {0};\n    size_t len = 0;\n    char *ret = NULL;\n    g_autofree char *shortname = NULL;\n\n    /* No need to do the whole conversion thing when there are no multibyte\n     * characters.  The same applies for illegal sequences as they can occur\n     * with incompatible locales. */\n    len = mbstowcs(NULL, def->name, 0);\n    if ((len == (size_t) -1 && errno == EILSEQ) ||\n        len == strlen(def->name)) {\n        ret = g_strdup_printf(\"%d-%.*s\", def->id, VIR_DOMAIN_SHORT_NAME_MAX, def->name);\n        return ret;\n    }\n\n    if (len == (size_t) -1) {\n        virReportSystemError(errno, \"%s\",\n                             _(\"Cannot convert domain name to \"\n                               \"wide character string\"));\n        return NULL;\n    }\n\n    if (mbstowcs(wshortname, def->name, VIR_DOMAIN_SHORT_NAME_MAX) == (size_t) -1) {\n        virReportSystemError(errno, \"%s\",\n                             _(\"Cannot convert domain name to \"\n                               \"wide character string\"));\n        return NULL;\n    }\n\n    len = wcstombs(NULL, wshortname, 0);\n    if (len == (size_t) -1) {\n        virReportSystemError(errno, \"%s\",\n                             _(\"Cannot convert wide character string \"\n                               \"back to multi-byte domain name\"));\n        return NULL;\n    }\n\n    if (VIR_ALLOC_N(shortname, len + 1) < 0)\n        return NULL;\n\n    if (wcstombs(shortname, wshortname, len) == (size_t) -1) {\n        virReportSystemError(errno, \"%s\",\n                             _(\"Cannot convert wide character string \"\n                               \"back to multi-byte domain name\"));\n        return NULL;\n    }\n\n    ret = g_strdup_printf(\"%d-%s\", def->id, shortname);\n    return ret;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define VIR_DOMAIN_SHORT_NAME_MAX 20"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\n#define VIR_DOMAIN_SHORT_NAME_MAX 20\n\nchar *\nvirDomainDefGetShortName(const virDomainDef *def)\n{\n    wchar_t wshortname[VIR_DOMAIN_SHORT_NAME_MAX + 1] = {0};\n    size_t len = 0;\n    char *ret = NULL;\n    g_autofree char *shortname = NULL;\n\n    /* No need to do the whole conversion thing when there are no multibyte\n     * characters.  The same applies for illegal sequences as they can occur\n     * with incompatible locales. */\n    len = mbstowcs(NULL, def->name, 0);\n    if ((len == (size_t) -1 && errno == EILSEQ) ||\n        len == strlen(def->name)) {\n        ret = g_strdup_printf(\"%d-%.*s\", def->id, VIR_DOMAIN_SHORT_NAME_MAX, def->name);\n        return ret;\n    }\n\n    if (len == (size_t) -1) {\n        virReportSystemError(errno, \"%s\",\n                             _(\"Cannot convert domain name to \"\n                               \"wide character string\"));\n        return NULL;\n    }\n\n    if (mbstowcs(wshortname, def->name, VIR_DOMAIN_SHORT_NAME_MAX) == (size_t) -1) {\n        virReportSystemError(errno, \"%s\",\n                             _(\"Cannot convert domain name to \"\n                               \"wide character string\"));\n        return NULL;\n    }\n\n    len = wcstombs(NULL, wshortname, 0);\n    if (len == (size_t) -1) {\n        virReportSystemError(errno, \"%s\",\n                             _(\"Cannot convert wide character string \"\n                               \"back to multi-byte domain name\"));\n        return NULL;\n    }\n\n    if (VIR_ALLOC_N(shortname, len + 1) < 0)\n        return NULL;\n\n    if (wcstombs(shortname, wshortname, len) == (size_t) -1) {\n        virReportSystemError(errno, \"%s\",\n                             _(\"Cannot convert wide character string \"\n                               \"back to multi-byte domain name\"));\n        return NULL;\n    }\n\n    ret = g_strdup_printf(\"%d-%s\", def->id, shortname);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuGetBaseHugepagePath",
          "args": [
            "hugepage"
          ],
          "line": 1894
        },
        "resolved": true,
        "details": {
          "function_name": "qemuGetBaseHugepagePath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
          "lines": "1879-1887",
          "snippet": "char *\nqemuGetBaseHugepagePath(virHugeTLBFSPtr hugepage)\n{\n    char *ret;\n\n    ret = g_strdup_printf(\"%s/libvirt/qemu\", hugepage->mnt_dir);\n\n    return ret;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virutil.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virsocket.h\"",
            "#include \"virfile.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virlog.h\"",
            "#include \"virxml.h\"",
            "#include \"datatypes.h\"",
            "#include \"viralloc.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_firmware.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nchar *\nqemuGetBaseHugepagePath(virHugeTLBFSPtr hugepage)\n{\n    char *ret;\n\n    ret = g_strdup_printf(\"%s/libvirt/qemu\", hugepage->mnt_dir);\n\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nchar *\nqemuGetDomainHugepagePath(const virDomainDef *def,\n                          virHugeTLBFSPtr hugepage)\n{\n    g_autofree char *base = qemuGetBaseHugepagePath(hugepage);\n    g_autofree char *domPath = virDomainDefGetShortName(def);\n    char *ret = NULL;\n\n    if (base && domPath)\n        ret = g_strdup_printf(\"%s/%s\", base, domPath);\n    return ret;\n}"
  },
  {
    "function_name": "qemuGetBaseHugepagePath",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
    "lines": "1879-1887",
    "snippet": "char *\nqemuGetBaseHugepagePath(virHugeTLBFSPtr hugepage)\n{\n    char *ret;\n\n    ret = g_strdup_printf(\"%s/libvirt/qemu\", hugepage->mnt_dir);\n\n    return ret;\n}",
    "includes": [
      "#include \"configmake.h\"",
      "#include \"virutil.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virstring.h\"",
      "#include \"virsocket.h\"",
      "#include \"virfile.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virlog.h\"",
      "#include \"virxml.h\"",
      "#include \"datatypes.h\"",
      "#include \"viralloc.h\"",
      "#include \"virconf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_firmware.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_capabilities.h\"",
      "#include \"qemu_conf.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"%s/libvirt/qemu\"",
            "hugepage->mnt_dir"
          ],
          "line": 1884
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nchar *\nqemuGetBaseHugepagePath(virHugeTLBFSPtr hugepage)\n{\n    char *ret;\n\n    ret = g_strdup_printf(\"%s/libvirt/qemu\", hugepage->mnt_dir);\n\n    return ret;\n}"
  },
  {
    "function_name": "qemuTranslateSnapshotDiskSourcePool",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
    "lines": "1868-1877",
    "snippet": "int\nqemuTranslateSnapshotDiskSourcePool(virDomainSnapshotDiskDefPtr def)\n{\n    if (def->src->type != VIR_STORAGE_TYPE_VOLUME)\n        return 0;\n\n    virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                   _(\"Snapshots are not yet supported with 'pool' volumes\"));\n    return -1;\n}",
    "includes": [
      "#include \"configmake.h\"",
      "#include \"virutil.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virstring.h\"",
      "#include \"virsocket.h\"",
      "#include \"virfile.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virlog.h\"",
      "#include \"virxml.h\"",
      "#include \"datatypes.h\"",
      "#include \"viralloc.h\"",
      "#include \"virconf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_firmware.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_capabilities.h\"",
      "#include \"qemu_conf.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"Snapshots are not yet supported with 'pool' volumes\")"
          ],
          "line": 1874
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Snapshots are not yet supported with 'pool' volumes\""
          ],
          "line": 1875
        },
        "resolved": true,
        "details": {
          "function_name": "bswap_header",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_driver.c",
          "lines": "2852-2860",
          "snippet": "static inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virenum.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virqemu.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virnuma.h\"",
            "#include \"virperf.h\"",
            "#include \"vircgroup.h\"",
            "#include \"domain_capabilities.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapicheckqemu.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virkeycode.h\"",
            "#include \"locking/domain_lock.h\"",
            "#include \"locking/lock_manager.h\"",
            "#include \"virthreadpool.h\"",
            "#include \"configmake.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virhook.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virxml.h\"",
            "#include \"libvirt_internal.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virusb.h\"",
            "#include \"virpci.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"domain_conf.h\"",
            "#include \"viruuid.h\"",
            "#include \"virarptable.h\"",
            "#include \"viralloc.h\"",
            "#include \"capabilities.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virbuffer.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"qemu_backup.h\"",
            "#include \"qemu_checkpoint.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_blockjob.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_monitor.h\"",
            "#include \"qemu_hotplug.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"qemu_block.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_agent.h\"",
            "#include \"qemu_driver.h\"",
            "#include <sys/ioctl.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <dirent.h>",
            "#include <sys/time.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virenum.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virqemu.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virnuma.h\"\n#include \"virperf.h\"\n#include \"vircgroup.h\"\n#include \"domain_capabilities.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapicheckqemu.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virbitmap.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virnodesuspend.h\"\n#include \"virkeycode.h\"\n#include \"locking/domain_lock.h\"\n#include \"locking/lock_manager.h\"\n#include \"virthreadpool.h\"\n#include \"configmake.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"virhook.h\"\n#include \"domain_nwfilter.h\"\n#include \"virsysinfo.h\"\n#include \"cpu/cpu.h\"\n#include \"virxml.h\"\n#include \"libvirt_internal.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virusb.h\"\n#include \"virpci.h\"\n#include \"node_device_conf.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"domain_conf.h\"\n#include \"viruuid.h\"\n#include \"virarptable.h\"\n#include \"viralloc.h\"\n#include \"capabilities.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevtap.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"qemu_backup.h\"\n#include \"qemu_checkpoint.h\"\n#include \"qemu_security.h\"\n#include \"qemu_blockjob.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_process.h\"\n#include \"qemu_monitor.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_cgroup.h\"\n#include \"qemu_command.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"qemu_block.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_agent.h\"\n#include \"qemu_driver.h\"\n#include <sys/ioctl.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <dirent.h>\n#include <sys/time.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nint\nqemuTranslateSnapshotDiskSourcePool(virDomainSnapshotDiskDefPtr def)\n{\n    if (def->src->type != VIR_STORAGE_TYPE_VOLUME)\n        return 0;\n\n    virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                   _(\"Snapshots are not yet supported with 'pool' volumes\"));\n    return -1;\n}"
  },
  {
    "function_name": "qemuDriverAllocateID",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
    "lines": "1862-1865",
    "snippet": "int qemuDriverAllocateID(virQEMUDriverPtr driver)\n{\n    return g_atomic_int_add(&driver->lastvmid, 1) + 1;\n}",
    "includes": [
      "#include \"configmake.h\"",
      "#include \"virutil.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virstring.h\"",
      "#include \"virsocket.h\"",
      "#include \"virfile.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virlog.h\"",
      "#include \"virxml.h\"",
      "#include \"datatypes.h\"",
      "#include \"viralloc.h\"",
      "#include \"virconf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_firmware.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_capabilities.h\"",
      "#include \"qemu_conf.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_atomic_int_add",
          "args": [
            "&driver->lastvmid",
            "1"
          ],
          "line": 1864
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nint qemuDriverAllocateID(virQEMUDriverPtr driver)\n{\n    return g_atomic_int_add(&driver->lastvmid, 1) + 1;\n}"
  },
  {
    "function_name": "qemuSetUnprivSGIO",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
    "lines": "1807-1860",
    "snippet": "int\nqemuSetUnprivSGIO(virDomainDeviceDefPtr dev)\n{\n    virDomainDiskDefPtr disk = NULL;\n    virDomainHostdevDefPtr hostdev = NULL;\n    g_autofree char *sysfs_path = NULL;\n    const char *path = NULL;\n    int val = -1;\n\n    /* \"sgio\" is only valid for block disk; cdrom\n     * and floopy disk can have empty source.\n     */\n    if (dev->type == VIR_DOMAIN_DEVICE_DISK) {\n        disk = dev->data.disk;\n\n        if (disk->device != VIR_DOMAIN_DISK_DEVICE_LUN ||\n            !virStorageSourceIsBlockLocal(disk->src))\n            return 0;\n\n        path = virDomainDiskGetSource(disk);\n    } else if (dev->type == VIR_DOMAIN_DEVICE_HOSTDEV) {\n        hostdev = dev->data.hostdev;\n\n        if (!qemuIsSharedHostdev(hostdev))\n            return 0;\n\n        if (hostdev->source.subsys.u.scsi.sgio) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"'sgio' is not supported for SCSI \"\n                             \"generic device yet \"));\n            return -1;\n        }\n\n        return 0;\n    } else {\n        return 0;\n    }\n\n    if (!(sysfs_path = virGetUnprivSGIOSysfsPath(path, NULL)))\n        return -1;\n\n    /* By default, filter the SG_IO commands, i.e. set unpriv_sgio to 0.  */\n    val = (disk->sgio == VIR_DOMAIN_DEVICE_SGIO_UNFILTERED);\n\n    /* Do not do anything if unpriv_sgio is not supported by the kernel and the\n     * whitelist is enabled.  But if requesting unfiltered access, always call\n     * virSetDeviceUnprivSGIO, to report an error for unsupported unpriv_sgio.\n     */\n    if ((virFileExists(sysfs_path) || val == 1) &&\n        virSetDeviceUnprivSGIO(path, NULL, val) < 0)\n        return -1;\n\n    return 0;\n}",
    "includes": [
      "#include \"configmake.h\"",
      "#include \"virutil.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virstring.h\"",
      "#include \"virsocket.h\"",
      "#include \"virfile.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virlog.h\"",
      "#include \"virxml.h\"",
      "#include \"datatypes.h\"",
      "#include \"viralloc.h\"",
      "#include \"virconf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_firmware.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_capabilities.h\"",
      "#include \"qemu_conf.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virSetDeviceUnprivSGIO",
          "args": [
            "path",
            "NULL",
            "val"
          ],
          "line": 1856
        },
        "resolved": true,
        "details": {
          "function_name": "virSetDeviceUnprivSGIO",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
          "lines": "1439-1470",
          "snippet": "int\nvirSetDeviceUnprivSGIO(const char *path,\n                       const char *sysfs_dir,\n                       int unpriv_sgio)\n{\n    char *sysfs_path = NULL;\n    char *val = NULL;\n    int ret = -1;\n    int rc;\n\n    if (!(sysfs_path = virGetUnprivSGIOSysfsPath(path, sysfs_dir)))\n        return -1;\n\n    if (!virFileExists(sysfs_path)) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"unpriv_sgio is not supported by this kernel\"));\n        goto cleanup;\n    }\n\n    val = g_strdup_printf(\"%d\", unpriv_sgio);\n\n    if ((rc = virFileWriteStr(sysfs_path, val, 0)) < 0) {\n        virReportSystemError(-rc, _(\"failed to set %s\"), sysfs_path);\n        goto cleanup;\n    }\n\n    ret = 0;\n cleanup:\n    VIR_FREE(sysfs_path);\n    VIR_FREE(val);\n    return ret;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <sys/prctl.h>",
            "# include <cap-ng.h>",
            "# include <grp.h>",
            "# include <pwd.h>",
            "# include <libdevmapper.h>",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <conio.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nint\nvirSetDeviceUnprivSGIO(const char *path,\n                       const char *sysfs_dir,\n                       int unpriv_sgio)\n{\n    char *sysfs_path = NULL;\n    char *val = NULL;\n    int ret = -1;\n    int rc;\n\n    if (!(sysfs_path = virGetUnprivSGIOSysfsPath(path, sysfs_dir)))\n        return -1;\n\n    if (!virFileExists(sysfs_path)) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"unpriv_sgio is not supported by this kernel\"));\n        goto cleanup;\n    }\n\n    val = g_strdup_printf(\"%d\", unpriv_sgio);\n\n    if ((rc = virFileWriteStr(sysfs_path, val, 0)) < 0) {\n        virReportSystemError(-rc, _(\"failed to set %s\"), sysfs_path);\n        goto cleanup;\n    }\n\n    ret = 0;\n cleanup:\n    VIR_FREE(sysfs_path);\n    VIR_FREE(val);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virFileExists",
          "args": [
            "sysfs_path"
          ],
          "line": 1855
        },
        "resolved": true,
        "details": {
          "function_name": "virFileExists",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1873-1877",
          "snippet": "bool\nvirFileExists(const char *path)\n{\n    return access(path, F_OK) == 0;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nbool\nvirFileExists(const char *path)\n{\n    return access(path, F_OK) == 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virGetUnprivSGIOSysfsPath",
          "args": [
            "path",
            "NULL"
          ],
          "line": 1845
        },
        "resolved": true,
        "details": {
          "function_name": "virGetUnprivSGIOSysfsPath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
          "lines": "1418-1437",
          "snippet": "char *\nvirGetUnprivSGIOSysfsPath(const char *path,\n                          const char *sysfs_dir)\n{\n    int maj, min;\n    char *sysfs_path = NULL;\n    int rc;\n\n    if ((rc = virGetDeviceID(path, &maj, &min)) < 0) {\n        virReportSystemError(-rc,\n                             _(\"Unable to get device ID '%s'\"),\n                             path);\n        return NULL;\n    }\n\n    sysfs_path = g_strdup_printf(\"%s/%d:%d/queue/unpriv_sgio\",\n                                 sysfs_dir ? sysfs_dir : SYSFS_DEV_BLOCK_PATH,\n                                 maj, min);\n    return sysfs_path;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <sys/prctl.h>",
            "# include <cap-ng.h>",
            "# include <grp.h>",
            "# include <pwd.h>",
            "# include <libdevmapper.h>",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <conio.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define SYSFS_DEV_BLOCK_PATH \"/sys/dev/block\""
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\n#define SYSFS_DEV_BLOCK_PATH \"/sys/dev/block\"\n\nchar *\nvirGetUnprivSGIOSysfsPath(const char *path,\n                          const char *sysfs_dir)\n{\n    int maj, min;\n    char *sysfs_path = NULL;\n    int rc;\n\n    if ((rc = virGetDeviceID(path, &maj, &min)) < 0) {\n        virReportSystemError(-rc,\n                             _(\"Unable to get device ID '%s'\"),\n                             path);\n        return NULL;\n    }\n\n    sysfs_path = g_strdup_printf(\"%s/%d:%d/queue/unpriv_sgio\",\n                                 sysfs_dir ? sysfs_dir : SYSFS_DEV_BLOCK_PATH,\n                                 maj, min);\n    return sysfs_path;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"'sgio' is not supported for SCSI \"\n                             \"generic device yet \")"
          ],
          "line": 1834
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"'sgio' is not supported for SCSI \"\n                             \"generic device yet \""
          ],
          "line": 1835
        },
        "resolved": true,
        "details": {
          "function_name": "bswap_header",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_driver.c",
          "lines": "2852-2860",
          "snippet": "static inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virenum.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virqemu.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virnuma.h\"",
            "#include \"virperf.h\"",
            "#include \"vircgroup.h\"",
            "#include \"domain_capabilities.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapicheckqemu.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virkeycode.h\"",
            "#include \"locking/domain_lock.h\"",
            "#include \"locking/lock_manager.h\"",
            "#include \"virthreadpool.h\"",
            "#include \"configmake.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virhook.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virxml.h\"",
            "#include \"libvirt_internal.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virusb.h\"",
            "#include \"virpci.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"domain_conf.h\"",
            "#include \"viruuid.h\"",
            "#include \"virarptable.h\"",
            "#include \"viralloc.h\"",
            "#include \"capabilities.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virbuffer.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"qemu_backup.h\"",
            "#include \"qemu_checkpoint.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_blockjob.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_monitor.h\"",
            "#include \"qemu_hotplug.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"qemu_block.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_agent.h\"",
            "#include \"qemu_driver.h\"",
            "#include <sys/ioctl.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <dirent.h>",
            "#include <sys/time.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virenum.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virqemu.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virnuma.h\"\n#include \"virperf.h\"\n#include \"vircgroup.h\"\n#include \"domain_capabilities.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapicheckqemu.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virbitmap.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virnodesuspend.h\"\n#include \"virkeycode.h\"\n#include \"locking/domain_lock.h\"\n#include \"locking/lock_manager.h\"\n#include \"virthreadpool.h\"\n#include \"configmake.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"virhook.h\"\n#include \"domain_nwfilter.h\"\n#include \"virsysinfo.h\"\n#include \"cpu/cpu.h\"\n#include \"virxml.h\"\n#include \"libvirt_internal.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virusb.h\"\n#include \"virpci.h\"\n#include \"node_device_conf.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"domain_conf.h\"\n#include \"viruuid.h\"\n#include \"virarptable.h\"\n#include \"viralloc.h\"\n#include \"capabilities.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevtap.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"qemu_backup.h\"\n#include \"qemu_checkpoint.h\"\n#include \"qemu_security.h\"\n#include \"qemu_blockjob.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_process.h\"\n#include \"qemu_monitor.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_cgroup.h\"\n#include \"qemu_command.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"qemu_block.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_agent.h\"\n#include \"qemu_driver.h\"\n#include <sys/ioctl.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <dirent.h>\n#include <sys/time.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuIsSharedHostdev",
          "args": [
            "hostdev"
          ],
          "line": 1830
        },
        "resolved": true,
        "details": {
          "function_name": "qemuIsSharedHostdev",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
          "lines": "1682-1689",
          "snippet": "static bool\nqemuIsSharedHostdev(virDomainHostdevDefPtr hostdev)\n{\n    return (hostdev->shareable &&\n            (virHostdevIsSCSIDevice(hostdev) &&\n             hostdev->source.subsys.u.scsi.protocol !=\n             VIR_DOMAIN_HOSTDEV_SCSI_PROTOCOL_TYPE_ISCSI));\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virutil.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virsocket.h\"",
            "#include \"virfile.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virlog.h\"",
            "#include \"virxml.h\"",
            "#include \"datatypes.h\"",
            "#include \"viralloc.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_firmware.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic bool\nqemuIsSharedHostdev(virDomainHostdevDefPtr hostdev)\n{\n    return (hostdev->shareable &&\n            (virHostdevIsSCSIDevice(hostdev) &&\n             hostdev->source.subsys.u.scsi.protocol !=\n             VIR_DOMAIN_HOSTDEV_SCSI_PROTOCOL_TYPE_ISCSI));\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDiskGetSource",
          "args": [
            "disk"
          ],
          "line": 1826
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDiskGetSource",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "2155-2159",
          "snippet": "const char *\nvirDomainDiskGetSource(virDomainDiskDef const *def)\n{\n    return def->src->path;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nconst char *\nvirDomainDiskGetSource(virDomainDiskDef const *def)\n{\n    return def->src->path;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStorageSourceIsBlockLocal",
          "args": [
            "disk->src"
          ],
          "line": 1823
        },
        "resolved": true,
        "details": {
          "function_name": "virStorageSourceIsBlockLocal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstoragefile.c",
          "lines": "2643-2647",
          "snippet": "bool\nvirStorageSourceIsBlockLocal(const virStorageSource *src)\n{\n    return virStorageSourceGetActualType(src) == VIR_STORAGE_TYPE_BLOCK;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsecret.h\"",
            "#include \"virstorageencryption.h\"",
            "#include \"virjson.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruri.h\"",
            "#include \"virstring.h\"",
            "#include \"virendian.h\"",
            "#include \"virhash.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include \"virstoragefilebackend.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsecret.h\"\n#include \"virstorageencryption.h\"\n#include \"virjson.h\"\n#include \"virbuffer.h\"\n#include \"viruri.h\"\n#include \"virstring.h\"\n#include \"virendian.h\"\n#include \"virhash.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include \"virstoragefilebackend.h\"\n#include <config.h>\n\nbool\nvirStorageSourceIsBlockLocal(const virStorageSource *src)\n{\n    return virStorageSourceGetActualType(src) == VIR_STORAGE_TYPE_BLOCK;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nint\nqemuSetUnprivSGIO(virDomainDeviceDefPtr dev)\n{\n    virDomainDiskDefPtr disk = NULL;\n    virDomainHostdevDefPtr hostdev = NULL;\n    g_autofree char *sysfs_path = NULL;\n    const char *path = NULL;\n    int val = -1;\n\n    /* \"sgio\" is only valid for block disk; cdrom\n     * and floopy disk can have empty source.\n     */\n    if (dev->type == VIR_DOMAIN_DEVICE_DISK) {\n        disk = dev->data.disk;\n\n        if (disk->device != VIR_DOMAIN_DISK_DEVICE_LUN ||\n            !virStorageSourceIsBlockLocal(disk->src))\n            return 0;\n\n        path = virDomainDiskGetSource(disk);\n    } else if (dev->type == VIR_DOMAIN_DEVICE_HOSTDEV) {\n        hostdev = dev->data.hostdev;\n\n        if (!qemuIsSharedHostdev(hostdev))\n            return 0;\n\n        if (hostdev->source.subsys.u.scsi.sgio) {\n            virReportError(VIR_ERR_INTERNAL_ERROR, \"%s\",\n                           _(\"'sgio' is not supported for SCSI \"\n                             \"generic device yet \"));\n            return -1;\n        }\n\n        return 0;\n    } else {\n        return 0;\n    }\n\n    if (!(sysfs_path = virGetUnprivSGIOSysfsPath(path, NULL)))\n        return -1;\n\n    /* By default, filter the SG_IO commands, i.e. set unpriv_sgio to 0.  */\n    val = (disk->sgio == VIR_DOMAIN_DEVICE_SGIO_UNFILTERED);\n\n    /* Do not do anything if unpriv_sgio is not supported by the kernel and the\n     * whitelist is enabled.  But if requesting unfiltered access, always call\n     * virSetDeviceUnprivSGIO, to report an error for unsupported unpriv_sgio.\n     */\n    if ((virFileExists(sysfs_path) || val == 1) &&\n        virSetDeviceUnprivSGIO(path, NULL, val) < 0)\n        return -1;\n\n    return 0;\n}"
  },
  {
    "function_name": "qemuRemoveSharedDevice",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
    "lines": "1798-1804",
    "snippet": "int\nqemuRemoveSharedDevice(virQEMUDriverPtr driver,\n                       virDomainDeviceDefPtr dev,\n                       const char *name)\n{\n    return qemuSharedDeviceAddRemoveInternal(driver, dev, name, false);\n}",
    "includes": [
      "#include \"configmake.h\"",
      "#include \"virutil.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virstring.h\"",
      "#include \"virsocket.h\"",
      "#include \"virfile.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virlog.h\"",
      "#include \"virxml.h\"",
      "#include \"datatypes.h\"",
      "#include \"viralloc.h\"",
      "#include \"virconf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_firmware.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_capabilities.h\"",
      "#include \"qemu_conf.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "qemuSharedDeviceAddRemoveInternal",
          "args": [
            "driver",
            "dev",
            "name",
            "false"
          ],
          "line": 1803
        },
        "resolved": true,
        "details": {
          "function_name": "qemuSharedDeviceAddRemoveInternal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
          "lines": "1741-1759",
          "snippet": "static int\nqemuSharedDeviceAddRemoveInternal(virQEMUDriverPtr driver,\n                                  virDomainDeviceDefPtr dev,\n                                  const char *name,\n                                  bool addDevice)\n{\n    /* Currently the only conflicts we have to care about for\n     * the shared disk and shared host device is \"sgio\" setting,\n     * which is only valid for block disk and scsi host device.\n     */\n    if (dev->type == VIR_DOMAIN_DEVICE_DISK)\n        return qemuSharedDiskAddRemoveInternal(driver, dev->data.disk,\n                                               name, addDevice);\n    else if (dev->type == VIR_DOMAIN_DEVICE_HOSTDEV)\n        return qemuSharedHostdevAddRemoveInternal(driver, dev->data.hostdev,\n                                                  name, addDevice);\n    else\n        return 0;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virutil.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virsocket.h\"",
            "#include \"virfile.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virlog.h\"",
            "#include \"virxml.h\"",
            "#include \"datatypes.h\"",
            "#include \"viralloc.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_firmware.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nqemuSharedDeviceAddRemoveInternal(virQEMUDriverPtr driver,\n                                  virDomainDeviceDefPtr dev,\n                                  const char *name,\n                                  bool addDevice)\n{\n    /* Currently the only conflicts we have to care about for\n     * the shared disk and shared host device is \"sgio\" setting,\n     * which is only valid for block disk and scsi host device.\n     */\n    if (dev->type == VIR_DOMAIN_DEVICE_DISK)\n        return qemuSharedDiskAddRemoveInternal(driver, dev->data.disk,\n                                               name, addDevice);\n    else if (dev->type == VIR_DOMAIN_DEVICE_HOSTDEV)\n        return qemuSharedHostdevAddRemoveInternal(driver, dev->data.hostdev,\n                                                  name, addDevice);\n    else\n        return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nint\nqemuRemoveSharedDevice(virQEMUDriverPtr driver,\n                       virDomainDeviceDefPtr dev,\n                       const char *name)\n{\n    return qemuSharedDeviceAddRemoveInternal(driver, dev, name, false);\n}"
  },
  {
    "function_name": "qemuRemoveSharedDisk",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
    "lines": "1780-1786",
    "snippet": "int\nqemuRemoveSharedDisk(virQEMUDriverPtr driver,\n                     virDomainDiskDefPtr disk,\n                     const char *name)\n{\n    return qemuSharedDiskAddRemoveInternal(driver, disk, name, false);\n}",
    "includes": [
      "#include \"configmake.h\"",
      "#include \"virutil.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virstring.h\"",
      "#include \"virsocket.h\"",
      "#include \"virfile.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virlog.h\"",
      "#include \"virxml.h\"",
      "#include \"datatypes.h\"",
      "#include \"viralloc.h\"",
      "#include \"virconf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_firmware.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_capabilities.h\"",
      "#include \"qemu_conf.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "qemuSharedDiskAddRemoveInternal",
          "args": [
            "driver",
            "disk",
            "name",
            "false"
          ],
          "line": 1785
        },
        "resolved": true,
        "details": {
          "function_name": "qemuSharedDiskAddRemoveInternal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
          "lines": "1627-1661",
          "snippet": "static int\nqemuSharedDiskAddRemoveInternal(virQEMUDriverPtr driver,\n                                virDomainDiskDefPtr disk,\n                                const char *name,\n                                bool addDisk)\n{\n    g_autofree char *key = NULL;\n    int ret = -1;\n\n    if (virStorageSourceIsEmpty(disk->src) ||\n        !disk->src->shared ||\n        !virStorageSourceIsBlockLocal(disk->src))\n        return 0;\n\n    qemuDriverLock(driver);\n\n    if (!(key = qemuGetSharedDeviceKey(virDomainDiskGetSource(disk))))\n        goto cleanup;\n\n    if (addDisk) {\n        if (qemuCheckSharedDisk(driver->sharedDevices, disk) < 0)\n            goto cleanup;\n\n        if (qemuSharedDeviceEntryInsert(driver, key, name) < 0)\n            goto cleanup;\n    } else {\n        if (qemuSharedDeviceEntryRemove(driver, key, name) < 0)\n            goto cleanup;\n    }\n\n    ret = 0;\n cleanup:\n    qemuDriverUnlock(driver);\n    return ret;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virutil.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virsocket.h\"",
            "#include \"virfile.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virlog.h\"",
            "#include \"virxml.h\"",
            "#include \"datatypes.h\"",
            "#include \"viralloc.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_firmware.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nqemuSharedDiskAddRemoveInternal(virQEMUDriverPtr driver,\n                                virDomainDiskDefPtr disk,\n                                const char *name,\n                                bool addDisk)\n{\n    g_autofree char *key = NULL;\n    int ret = -1;\n\n    if (virStorageSourceIsEmpty(disk->src) ||\n        !disk->src->shared ||\n        !virStorageSourceIsBlockLocal(disk->src))\n        return 0;\n\n    qemuDriverLock(driver);\n\n    if (!(key = qemuGetSharedDeviceKey(virDomainDiskGetSource(disk))))\n        goto cleanup;\n\n    if (addDisk) {\n        if (qemuCheckSharedDisk(driver->sharedDevices, disk) < 0)\n            goto cleanup;\n\n        if (qemuSharedDeviceEntryInsert(driver, key, name) < 0)\n            goto cleanup;\n    } else {\n        if (qemuSharedDeviceEntryRemove(driver, key, name) < 0)\n            goto cleanup;\n    }\n\n    ret = 0;\n cleanup:\n    qemuDriverUnlock(driver);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nint\nqemuRemoveSharedDisk(virQEMUDriverPtr driver,\n                     virDomainDiskDefPtr disk,\n                     const char *name)\n{\n    return qemuSharedDiskAddRemoveInternal(driver, disk, name, false);\n}"
  },
  {
    "function_name": "qemuAddSharedDevice",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
    "lines": "1771-1777",
    "snippet": "int\nqemuAddSharedDevice(virQEMUDriverPtr driver,\n                    virDomainDeviceDefPtr dev,\n                    const char *name)\n{\n    return qemuSharedDeviceAddRemoveInternal(driver, dev, name, true);\n}",
    "includes": [
      "#include \"configmake.h\"",
      "#include \"virutil.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virstring.h\"",
      "#include \"virsocket.h\"",
      "#include \"virfile.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virlog.h\"",
      "#include \"virxml.h\"",
      "#include \"datatypes.h\"",
      "#include \"viralloc.h\"",
      "#include \"virconf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_firmware.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_capabilities.h\"",
      "#include \"qemu_conf.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "qemuSharedDeviceAddRemoveInternal",
          "args": [
            "driver",
            "dev",
            "name",
            "true"
          ],
          "line": 1776
        },
        "resolved": true,
        "details": {
          "function_name": "qemuSharedDeviceAddRemoveInternal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
          "lines": "1741-1759",
          "snippet": "static int\nqemuSharedDeviceAddRemoveInternal(virQEMUDriverPtr driver,\n                                  virDomainDeviceDefPtr dev,\n                                  const char *name,\n                                  bool addDevice)\n{\n    /* Currently the only conflicts we have to care about for\n     * the shared disk and shared host device is \"sgio\" setting,\n     * which is only valid for block disk and scsi host device.\n     */\n    if (dev->type == VIR_DOMAIN_DEVICE_DISK)\n        return qemuSharedDiskAddRemoveInternal(driver, dev->data.disk,\n                                               name, addDevice);\n    else if (dev->type == VIR_DOMAIN_DEVICE_HOSTDEV)\n        return qemuSharedHostdevAddRemoveInternal(driver, dev->data.hostdev,\n                                                  name, addDevice);\n    else\n        return 0;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virutil.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virsocket.h\"",
            "#include \"virfile.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virlog.h\"",
            "#include \"virxml.h\"",
            "#include \"datatypes.h\"",
            "#include \"viralloc.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_firmware.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nqemuSharedDeviceAddRemoveInternal(virQEMUDriverPtr driver,\n                                  virDomainDeviceDefPtr dev,\n                                  const char *name,\n                                  bool addDevice)\n{\n    /* Currently the only conflicts we have to care about for\n     * the shared disk and shared host device is \"sgio\" setting,\n     * which is only valid for block disk and scsi host device.\n     */\n    if (dev->type == VIR_DOMAIN_DEVICE_DISK)\n        return qemuSharedDiskAddRemoveInternal(driver, dev->data.disk,\n                                               name, addDevice);\n    else if (dev->type == VIR_DOMAIN_DEVICE_HOSTDEV)\n        return qemuSharedHostdevAddRemoveInternal(driver, dev->data.hostdev,\n                                                  name, addDevice);\n    else\n        return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nint\nqemuAddSharedDevice(virQEMUDriverPtr driver,\n                    virDomainDeviceDefPtr dev,\n                    const char *name)\n{\n    return qemuSharedDeviceAddRemoveInternal(driver, dev, name, true);\n}"
  },
  {
    "function_name": "qemuSharedDeviceAddRemoveInternal",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
    "lines": "1741-1759",
    "snippet": "static int\nqemuSharedDeviceAddRemoveInternal(virQEMUDriverPtr driver,\n                                  virDomainDeviceDefPtr dev,\n                                  const char *name,\n                                  bool addDevice)\n{\n    /* Currently the only conflicts we have to care about for\n     * the shared disk and shared host device is \"sgio\" setting,\n     * which is only valid for block disk and scsi host device.\n     */\n    if (dev->type == VIR_DOMAIN_DEVICE_DISK)\n        return qemuSharedDiskAddRemoveInternal(driver, dev->data.disk,\n                                               name, addDevice);\n    else if (dev->type == VIR_DOMAIN_DEVICE_HOSTDEV)\n        return qemuSharedHostdevAddRemoveInternal(driver, dev->data.hostdev,\n                                                  name, addDevice);\n    else\n        return 0;\n}",
    "includes": [
      "#include \"configmake.h\"",
      "#include \"virutil.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virstring.h\"",
      "#include \"virsocket.h\"",
      "#include \"virfile.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virlog.h\"",
      "#include \"virxml.h\"",
      "#include \"datatypes.h\"",
      "#include \"viralloc.h\"",
      "#include \"virconf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_firmware.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_capabilities.h\"",
      "#include \"qemu_conf.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "qemuSharedHostdevAddRemoveInternal",
          "args": [
            "driver",
            "dev->data.hostdev",
            "name",
            "addDevice"
          ],
          "line": 1755
        },
        "resolved": true,
        "details": {
          "function_name": "qemuSharedHostdevAddRemoveInternal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
          "lines": "1712-1739",
          "snippet": "static int\nqemuSharedHostdevAddRemoveInternal(virQEMUDriverPtr driver,\n                                   virDomainHostdevDefPtr hostdev,\n                                   const char *name,\n                                   bool addDevice)\n{\n    g_autofree char *dev_path = NULL;\n    g_autofree char *key = NULL;\n    int ret = -1;\n\n    if (!qemuIsSharedHostdev(hostdev))\n        return 0;\n\n    if (!(dev_path = qemuGetHostdevPath(hostdev)) ||\n        !(key = qemuGetSharedDeviceKey(dev_path)))\n        return -1;\n\n    qemuDriverLock(driver);\n\n    if (addDevice)\n        ret = qemuSharedDeviceEntryInsert(driver, key, name);\n    else\n        ret = qemuSharedDeviceEntryRemove(driver, key, name);\n\n    qemuDriverUnlock(driver);\n\n    return ret;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virutil.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virsocket.h\"",
            "#include \"virfile.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virlog.h\"",
            "#include \"virxml.h\"",
            "#include \"datatypes.h\"",
            "#include \"viralloc.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_firmware.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nqemuSharedHostdevAddRemoveInternal(virQEMUDriverPtr driver,\n                                   virDomainHostdevDefPtr hostdev,\n                                   const char *name,\n                                   bool addDevice)\n{\n    g_autofree char *dev_path = NULL;\n    g_autofree char *key = NULL;\n    int ret = -1;\n\n    if (!qemuIsSharedHostdev(hostdev))\n        return 0;\n\n    if (!(dev_path = qemuGetHostdevPath(hostdev)) ||\n        !(key = qemuGetSharedDeviceKey(dev_path)))\n        return -1;\n\n    qemuDriverLock(driver);\n\n    if (addDevice)\n        ret = qemuSharedDeviceEntryInsert(driver, key, name);\n    else\n        ret = qemuSharedDeviceEntryRemove(driver, key, name);\n\n    qemuDriverUnlock(driver);\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuSharedDiskAddRemoveInternal",
          "args": [
            "driver",
            "dev->data.disk",
            "name",
            "addDevice"
          ],
          "line": 1752
        },
        "resolved": true,
        "details": {
          "function_name": "qemuSharedDiskAddRemoveInternal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
          "lines": "1627-1661",
          "snippet": "static int\nqemuSharedDiskAddRemoveInternal(virQEMUDriverPtr driver,\n                                virDomainDiskDefPtr disk,\n                                const char *name,\n                                bool addDisk)\n{\n    g_autofree char *key = NULL;\n    int ret = -1;\n\n    if (virStorageSourceIsEmpty(disk->src) ||\n        !disk->src->shared ||\n        !virStorageSourceIsBlockLocal(disk->src))\n        return 0;\n\n    qemuDriverLock(driver);\n\n    if (!(key = qemuGetSharedDeviceKey(virDomainDiskGetSource(disk))))\n        goto cleanup;\n\n    if (addDisk) {\n        if (qemuCheckSharedDisk(driver->sharedDevices, disk) < 0)\n            goto cleanup;\n\n        if (qemuSharedDeviceEntryInsert(driver, key, name) < 0)\n            goto cleanup;\n    } else {\n        if (qemuSharedDeviceEntryRemove(driver, key, name) < 0)\n            goto cleanup;\n    }\n\n    ret = 0;\n cleanup:\n    qemuDriverUnlock(driver);\n    return ret;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virutil.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virsocket.h\"",
            "#include \"virfile.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virlog.h\"",
            "#include \"virxml.h\"",
            "#include \"datatypes.h\"",
            "#include \"viralloc.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_firmware.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nqemuSharedDiskAddRemoveInternal(virQEMUDriverPtr driver,\n                                virDomainDiskDefPtr disk,\n                                const char *name,\n                                bool addDisk)\n{\n    g_autofree char *key = NULL;\n    int ret = -1;\n\n    if (virStorageSourceIsEmpty(disk->src) ||\n        !disk->src->shared ||\n        !virStorageSourceIsBlockLocal(disk->src))\n        return 0;\n\n    qemuDriverLock(driver);\n\n    if (!(key = qemuGetSharedDeviceKey(virDomainDiskGetSource(disk))))\n        goto cleanup;\n\n    if (addDisk) {\n        if (qemuCheckSharedDisk(driver->sharedDevices, disk) < 0)\n            goto cleanup;\n\n        if (qemuSharedDeviceEntryInsert(driver, key, name) < 0)\n            goto cleanup;\n    } else {\n        if (qemuSharedDeviceEntryRemove(driver, key, name) < 0)\n            goto cleanup;\n    }\n\n    ret = 0;\n cleanup:\n    qemuDriverUnlock(driver);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nqemuSharedDeviceAddRemoveInternal(virQEMUDriverPtr driver,\n                                  virDomainDeviceDefPtr dev,\n                                  const char *name,\n                                  bool addDevice)\n{\n    /* Currently the only conflicts we have to care about for\n     * the shared disk and shared host device is \"sgio\" setting,\n     * which is only valid for block disk and scsi host device.\n     */\n    if (dev->type == VIR_DOMAIN_DEVICE_DISK)\n        return qemuSharedDiskAddRemoveInternal(driver, dev->data.disk,\n                                               name, addDevice);\n    else if (dev->type == VIR_DOMAIN_DEVICE_HOSTDEV)\n        return qemuSharedHostdevAddRemoveInternal(driver, dev->data.hostdev,\n                                                  name, addDevice);\n    else\n        return 0;\n}"
  },
  {
    "function_name": "qemuSharedHostdevAddRemoveInternal",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
    "lines": "1712-1739",
    "snippet": "static int\nqemuSharedHostdevAddRemoveInternal(virQEMUDriverPtr driver,\n                                   virDomainHostdevDefPtr hostdev,\n                                   const char *name,\n                                   bool addDevice)\n{\n    g_autofree char *dev_path = NULL;\n    g_autofree char *key = NULL;\n    int ret = -1;\n\n    if (!qemuIsSharedHostdev(hostdev))\n        return 0;\n\n    if (!(dev_path = qemuGetHostdevPath(hostdev)) ||\n        !(key = qemuGetSharedDeviceKey(dev_path)))\n        return -1;\n\n    qemuDriverLock(driver);\n\n    if (addDevice)\n        ret = qemuSharedDeviceEntryInsert(driver, key, name);\n    else\n        ret = qemuSharedDeviceEntryRemove(driver, key, name);\n\n    qemuDriverUnlock(driver);\n\n    return ret;\n}",
    "includes": [
      "#include \"configmake.h\"",
      "#include \"virutil.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virstring.h\"",
      "#include \"virsocket.h\"",
      "#include \"virfile.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virlog.h\"",
      "#include \"virxml.h\"",
      "#include \"datatypes.h\"",
      "#include \"viralloc.h\"",
      "#include \"virconf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_firmware.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_capabilities.h\"",
      "#include \"qemu_conf.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "qemuDriverUnlock",
          "args": [
            "driver"
          ],
          "line": 1736
        },
        "resolved": true,
        "details": {
          "function_name": "qemuDriverUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
          "lines": "90-94",
          "snippet": "static void\nqemuDriverUnlock(virQEMUDriverPtr driver)\n{\n    virMutexUnlock(&driver->lock);\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virutil.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virsocket.h\"",
            "#include \"virfile.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virlog.h\"",
            "#include \"virxml.h\"",
            "#include \"datatypes.h\"",
            "#include \"viralloc.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_firmware.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic void\nqemuDriverUnlock(virQEMUDriverPtr driver)\n{\n    virMutexUnlock(&driver->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuSharedDeviceEntryRemove",
          "args": [
            "driver",
            "key",
            "name"
          ],
          "line": 1734
        },
        "resolved": true,
        "details": {
          "function_name": "qemuSharedDeviceEntryRemove",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
          "lines": "1601-1624",
          "snippet": "static int\nqemuSharedDeviceEntryRemove(virQEMUDriverPtr driver,\n                            const char *key,\n                            const char *name)\n{\n    qemuSharedDeviceEntryPtr entry = NULL;\n    int idx;\n\n    if (!(entry = virHashLookup(driver->sharedDevices, key)))\n        return -1;\n\n    /* Nothing to do if the shared disk is not recored in the table. */\n    if (!qemuSharedDeviceEntryDomainExists(entry, name, &idx))\n        return 0;\n\n    if (entry->ref != 1) {\n        VIR_FREE(entry->domains[idx]);\n        VIR_DELETE_ELEMENT(entry->domains, idx, entry->ref);\n    } else {\n        ignore_value(virHashRemoveEntry(driver->sharedDevices, key));\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virutil.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virsocket.h\"",
            "#include \"virfile.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virlog.h\"",
            "#include \"virxml.h\"",
            "#include \"datatypes.h\"",
            "#include \"viralloc.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_firmware.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nqemuSharedDeviceEntryRemove(virQEMUDriverPtr driver,\n                            const char *key,\n                            const char *name)\n{\n    qemuSharedDeviceEntryPtr entry = NULL;\n    int idx;\n\n    if (!(entry = virHashLookup(driver->sharedDevices, key)))\n        return -1;\n\n    /* Nothing to do if the shared disk is not recored in the table. */\n    if (!qemuSharedDeviceEntryDomainExists(entry, name, &idx))\n        return 0;\n\n    if (entry->ref != 1) {\n        VIR_FREE(entry->domains[idx]);\n        VIR_DELETE_ELEMENT(entry->domains, idx, entry->ref);\n    } else {\n        ignore_value(virHashRemoveEntry(driver->sharedDevices, key));\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuSharedDeviceEntryInsert",
          "args": [
            "driver",
            "key",
            "name"
          ],
          "line": 1732
        },
        "resolved": true,
        "details": {
          "function_name": "qemuSharedDeviceEntryInsert",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
          "lines": "1561-1598",
          "snippet": "static int\nqemuSharedDeviceEntryInsert(virQEMUDriverPtr driver,\n                            const char *key,\n                            const char *name)\n{\n    qemuSharedDeviceEntry *entry = NULL;\n\n    if ((entry = virHashLookup(driver->sharedDevices, key))) {\n        /* Nothing to do if the shared scsi host device is already\n         * recorded in the table.\n         */\n        if (!qemuSharedDeviceEntryDomainExists(entry, name, NULL)) {\n            if (VIR_EXPAND_N(entry->domains, entry->ref, 1) < 0) {\n                /* entry is owned by the hash table here */\n                entry = NULL;\n                goto error;\n            }\n            entry->domains[entry->ref - 1] = g_strdup(name);\n        }\n    } else {\n        if (VIR_ALLOC(entry) < 0 ||\n            VIR_ALLOC_N(entry->domains, 1) < 0)\n            goto error;\n\n        entry->domains[0] = g_strdup(name);\n\n        entry->ref = 1;\n\n        if (virHashAddEntry(driver->sharedDevices, key, entry) < 0)\n            goto error;\n    }\n\n    return 0;\n\n error:\n    qemuSharedDeviceEntryFree(entry);\n    return -1;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virutil.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virsocket.h\"",
            "#include \"virfile.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virlog.h\"",
            "#include \"virxml.h\"",
            "#include \"datatypes.h\"",
            "#include \"viralloc.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_firmware.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nqemuSharedDeviceEntryInsert(virQEMUDriverPtr driver,\n                            const char *key,\n                            const char *name)\n{\n    qemuSharedDeviceEntry *entry = NULL;\n\n    if ((entry = virHashLookup(driver->sharedDevices, key))) {\n        /* Nothing to do if the shared scsi host device is already\n         * recorded in the table.\n         */\n        if (!qemuSharedDeviceEntryDomainExists(entry, name, NULL)) {\n            if (VIR_EXPAND_N(entry->domains, entry->ref, 1) < 0) {\n                /* entry is owned by the hash table here */\n                entry = NULL;\n                goto error;\n            }\n            entry->domains[entry->ref - 1] = g_strdup(name);\n        }\n    } else {\n        if (VIR_ALLOC(entry) < 0 ||\n            VIR_ALLOC_N(entry->domains, 1) < 0)\n            goto error;\n\n        entry->domains[0] = g_strdup(name);\n\n        entry->ref = 1;\n\n        if (virHashAddEntry(driver->sharedDevices, key, entry) < 0)\n            goto error;\n    }\n\n    return 0;\n\n error:\n    qemuSharedDeviceEntryFree(entry);\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuDriverLock",
          "args": [
            "driver"
          ],
          "line": 1729
        },
        "resolved": true,
        "details": {
          "function_name": "qemuDriverLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
          "lines": "85-89",
          "snippet": "static void\nqemuDriverLock(virQEMUDriverPtr driver)\n{\n    virMutexLock(&driver->lock);\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virutil.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virsocket.h\"",
            "#include \"virfile.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virlog.h\"",
            "#include \"virxml.h\"",
            "#include \"datatypes.h\"",
            "#include \"viralloc.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_firmware.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic void\nqemuDriverLock(virQEMUDriverPtr driver)\n{\n    virMutexLock(&driver->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuGetSharedDeviceKey",
          "args": [
            "dev_path"
          ],
          "line": 1726
        },
        "resolved": true,
        "details": {
          "function_name": "qemuGetSharedDeviceKey",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
          "lines": "1417-1434",
          "snippet": "char *\nqemuGetSharedDeviceKey(const char *device_path)\n{\n    int maj, min;\n    char *key = NULL;\n    int rc;\n\n    if ((rc = virGetDeviceID(device_path, &maj, &min)) < 0) {\n        virReportSystemError(-rc,\n                             _(\"Unable to get minor number of device '%s'\"),\n                             device_path);\n        return NULL;\n    }\n\n    key = g_strdup_printf(\"%d:%d\", maj, min);\n\n    return key;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virutil.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virsocket.h\"",
            "#include \"virfile.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virlog.h\"",
            "#include \"virxml.h\"",
            "#include \"datatypes.h\"",
            "#include \"viralloc.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_firmware.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nchar *\nqemuGetSharedDeviceKey(const char *device_path)\n{\n    int maj, min;\n    char *key = NULL;\n    int rc;\n\n    if ((rc = virGetDeviceID(device_path, &maj, &min)) < 0) {\n        virReportSystemError(-rc,\n                             _(\"Unable to get minor number of device '%s'\"),\n                             device_path);\n        return NULL;\n    }\n\n    key = g_strdup_printf(\"%d:%d\", maj, min);\n\n    return key;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuGetHostdevPath",
          "args": [
            "hostdev"
          ],
          "line": 1725
        },
        "resolved": true,
        "details": {
          "function_name": "qemuGetHostdevPath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
          "lines": "1692-1709",
          "snippet": "static char *\nqemuGetHostdevPath(virDomainHostdevDefPtr hostdev)\n{\n    virDomainHostdevSubsysSCSIPtr scsisrc = &hostdev->source.subsys.u.scsi;\n    virDomainHostdevSubsysSCSIHostPtr scsihostsrc = &scsisrc->u.host;\n    g_autofree char *dev_name = NULL;\n    char *dev_path = NULL;\n\n    if (!(dev_name = virSCSIDeviceGetDevName(NULL,\n                                             scsihostsrc->adapter,\n                                             scsihostsrc->bus,\n                                             scsihostsrc->target,\n                                             scsihostsrc->unit)))\n        return NULL;\n\n    dev_path = g_strdup_printf(\"/dev/%s\", dev_name);\n    return dev_path;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virutil.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virsocket.h\"",
            "#include \"virfile.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virlog.h\"",
            "#include \"virxml.h\"",
            "#include \"datatypes.h\"",
            "#include \"viralloc.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_firmware.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic char *\nqemuGetHostdevPath(virDomainHostdevDefPtr hostdev)\n{\n    virDomainHostdevSubsysSCSIPtr scsisrc = &hostdev->source.subsys.u.scsi;\n    virDomainHostdevSubsysSCSIHostPtr scsihostsrc = &scsisrc->u.host;\n    g_autofree char *dev_name = NULL;\n    char *dev_path = NULL;\n\n    if (!(dev_name = virSCSIDeviceGetDevName(NULL,\n                                             scsihostsrc->adapter,\n                                             scsihostsrc->bus,\n                                             scsihostsrc->target,\n                                             scsihostsrc->unit)))\n        return NULL;\n\n    dev_path = g_strdup_printf(\"/dev/%s\", dev_name);\n    return dev_path;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuIsSharedHostdev",
          "args": [
            "hostdev"
          ],
          "line": 1722
        },
        "resolved": true,
        "details": {
          "function_name": "qemuIsSharedHostdev",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
          "lines": "1682-1689",
          "snippet": "static bool\nqemuIsSharedHostdev(virDomainHostdevDefPtr hostdev)\n{\n    return (hostdev->shareable &&\n            (virHostdevIsSCSIDevice(hostdev) &&\n             hostdev->source.subsys.u.scsi.protocol !=\n             VIR_DOMAIN_HOSTDEV_SCSI_PROTOCOL_TYPE_ISCSI));\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virutil.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virsocket.h\"",
            "#include \"virfile.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virlog.h\"",
            "#include \"virxml.h\"",
            "#include \"datatypes.h\"",
            "#include \"viralloc.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_firmware.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic bool\nqemuIsSharedHostdev(virDomainHostdevDefPtr hostdev)\n{\n    return (hostdev->shareable &&\n            (virHostdevIsSCSIDevice(hostdev) &&\n             hostdev->source.subsys.u.scsi.protocol !=\n             VIR_DOMAIN_HOSTDEV_SCSI_PROTOCOL_TYPE_ISCSI));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nqemuSharedHostdevAddRemoveInternal(virQEMUDriverPtr driver,\n                                   virDomainHostdevDefPtr hostdev,\n                                   const char *name,\n                                   bool addDevice)\n{\n    g_autofree char *dev_path = NULL;\n    g_autofree char *key = NULL;\n    int ret = -1;\n\n    if (!qemuIsSharedHostdev(hostdev))\n        return 0;\n\n    if (!(dev_path = qemuGetHostdevPath(hostdev)) ||\n        !(key = qemuGetSharedDeviceKey(dev_path)))\n        return -1;\n\n    qemuDriverLock(driver);\n\n    if (addDevice)\n        ret = qemuSharedDeviceEntryInsert(driver, key, name);\n    else\n        ret = qemuSharedDeviceEntryRemove(driver, key, name);\n\n    qemuDriverUnlock(driver);\n\n    return ret;\n}"
  },
  {
    "function_name": "qemuGetHostdevPath",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
    "lines": "1692-1709",
    "snippet": "static char *\nqemuGetHostdevPath(virDomainHostdevDefPtr hostdev)\n{\n    virDomainHostdevSubsysSCSIPtr scsisrc = &hostdev->source.subsys.u.scsi;\n    virDomainHostdevSubsysSCSIHostPtr scsihostsrc = &scsisrc->u.host;\n    g_autofree char *dev_name = NULL;\n    char *dev_path = NULL;\n\n    if (!(dev_name = virSCSIDeviceGetDevName(NULL,\n                                             scsihostsrc->adapter,\n                                             scsihostsrc->bus,\n                                             scsihostsrc->target,\n                                             scsihostsrc->unit)))\n        return NULL;\n\n    dev_path = g_strdup_printf(\"/dev/%s\", dev_name);\n    return dev_path;\n}",
    "includes": [
      "#include \"configmake.h\"",
      "#include \"virutil.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virstring.h\"",
      "#include \"virsocket.h\"",
      "#include \"virfile.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virlog.h\"",
      "#include \"virxml.h\"",
      "#include \"datatypes.h\"",
      "#include \"viralloc.h\"",
      "#include \"virconf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_firmware.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_capabilities.h\"",
      "#include \"qemu_conf.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"/dev/%s\"",
            "dev_name"
          ],
          "line": 1707
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSCSIDeviceGetDevName",
          "args": [
            "NULL",
            "scsihostsrc->adapter",
            "scsihostsrc->bus",
            "scsihostsrc->target",
            "scsihostsrc->unit"
          ],
          "line": 1700
        },
        "resolved": true,
        "details": {
          "function_name": "virSCSIDeviceGetDevName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virscsi.c",
          "lines": "139-170",
          "snippet": "char *\nvirSCSIDeviceGetDevName(const char *sysfs_prefix,\n                        const char *adapter,\n                        unsigned int bus,\n                        unsigned int target,\n                        unsigned long long unit)\n{\n    DIR *dir = NULL;\n    struct dirent *entry;\n    g_autofree char *path = NULL;\n    char *name = NULL;\n    unsigned int adapter_id;\n    const char *prefix = sysfs_prefix ? sysfs_prefix : SYSFS_SCSI_DEVICES;\n\n    if (virSCSIDeviceGetAdapterId(adapter, &adapter_id) < 0)\n        return NULL;\n\n    path = g_strdup_printf(\"%s/%d:%u:%u:%llu/block\", prefix, adapter_id, bus,\n                           target, unit);\n\n    if (virDirOpen(&dir, path) < 0)\n        goto cleanup;\n\n    while (virDirRead(dir, &entry, path) > 0) {\n        name = g_strdup(entry->d_name);\n        break;\n    }\n\n cleanup:\n    VIR_DIR_CLOSE(dir);\n    return name;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"virscsi.h\"",
            "#include \"virlog.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <inttypes.h>",
            "#include <fcntl.h>",
            "#include <dirent.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define SYSFS_SCSI_DEVICES \"/sys/bus/scsi/devices\""
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"virscsi.h\"\n#include \"virlog.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <inttypes.h>\n#include <fcntl.h>\n#include <dirent.h>\n#include <config.h>\n\n#define SYSFS_SCSI_DEVICES \"/sys/bus/scsi/devices\"\n\nchar *\nvirSCSIDeviceGetDevName(const char *sysfs_prefix,\n                        const char *adapter,\n                        unsigned int bus,\n                        unsigned int target,\n                        unsigned long long unit)\n{\n    DIR *dir = NULL;\n    struct dirent *entry;\n    g_autofree char *path = NULL;\n    char *name = NULL;\n    unsigned int adapter_id;\n    const char *prefix = sysfs_prefix ? sysfs_prefix : SYSFS_SCSI_DEVICES;\n\n    if (virSCSIDeviceGetAdapterId(adapter, &adapter_id) < 0)\n        return NULL;\n\n    path = g_strdup_printf(\"%s/%d:%u:%u:%llu/block\", prefix, adapter_id, bus,\n                           target, unit);\n\n    if (virDirOpen(&dir, path) < 0)\n        goto cleanup;\n\n    while (virDirRead(dir, &entry, path) > 0) {\n        name = g_strdup(entry->d_name);\n        break;\n    }\n\n cleanup:\n    VIR_DIR_CLOSE(dir);\n    return name;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic char *\nqemuGetHostdevPath(virDomainHostdevDefPtr hostdev)\n{\n    virDomainHostdevSubsysSCSIPtr scsisrc = &hostdev->source.subsys.u.scsi;\n    virDomainHostdevSubsysSCSIHostPtr scsihostsrc = &scsisrc->u.host;\n    g_autofree char *dev_name = NULL;\n    char *dev_path = NULL;\n\n    if (!(dev_name = virSCSIDeviceGetDevName(NULL,\n                                             scsihostsrc->adapter,\n                                             scsihostsrc->bus,\n                                             scsihostsrc->target,\n                                             scsihostsrc->unit)))\n        return NULL;\n\n    dev_path = g_strdup_printf(\"/dev/%s\", dev_name);\n    return dev_path;\n}"
  },
  {
    "function_name": "qemuIsSharedHostdev",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
    "lines": "1682-1689",
    "snippet": "static bool\nqemuIsSharedHostdev(virDomainHostdevDefPtr hostdev)\n{\n    return (hostdev->shareable &&\n            (virHostdevIsSCSIDevice(hostdev) &&\n             hostdev->source.subsys.u.scsi.protocol !=\n             VIR_DOMAIN_HOSTDEV_SCSI_PROTOCOL_TYPE_ISCSI));\n}",
    "includes": [
      "#include \"configmake.h\"",
      "#include \"virutil.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virstring.h\"",
      "#include \"virsocket.h\"",
      "#include \"virfile.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virlog.h\"",
      "#include \"virxml.h\"",
      "#include \"datatypes.h\"",
      "#include \"viralloc.h\"",
      "#include \"virconf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_firmware.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_capabilities.h\"",
      "#include \"qemu_conf.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virHostdevIsSCSIDevice",
          "args": [
            "hostdev"
          ],
          "line": 1686
        },
        "resolved": true,
        "details": {
          "function_name": "virHostdevIsSCSIDevice",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "32282-32287",
          "snippet": "bool\nvirHostdevIsSCSIDevice(const virDomainHostdevDef *hostdev)\n{\n    return hostdev->mode == VIR_DOMAIN_HOSTDEV_MODE_SUBSYS &&\n        hostdev->source.subsys.type == VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_SCSI;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nbool\nvirHostdevIsSCSIDevice(const virDomainHostdevDef *hostdev)\n{\n    return hostdev->mode == VIR_DOMAIN_HOSTDEV_MODE_SUBSYS &&\n        hostdev->source.subsys.type == VIR_DOMAIN_HOSTDEV_SUBSYS_TYPE_SCSI;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic bool\nqemuIsSharedHostdev(virDomainHostdevDefPtr hostdev)\n{\n    return (hostdev->shareable &&\n            (virHostdevIsSCSIDevice(hostdev) &&\n             hostdev->source.subsys.u.scsi.protocol !=\n             VIR_DOMAIN_HOSTDEV_SCSI_PROTOCOL_TYPE_ISCSI));\n}"
  },
  {
    "function_name": "qemuAddSharedDisk",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
    "lines": "1673-1679",
    "snippet": "int\nqemuAddSharedDisk(virQEMUDriverPtr driver,\n                  virDomainDiskDefPtr disk,\n                  const char *name)\n{\n    return qemuSharedDiskAddRemoveInternal(driver, disk, name, true);\n}",
    "includes": [
      "#include \"configmake.h\"",
      "#include \"virutil.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virstring.h\"",
      "#include \"virsocket.h\"",
      "#include \"virfile.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virlog.h\"",
      "#include \"virxml.h\"",
      "#include \"datatypes.h\"",
      "#include \"viralloc.h\"",
      "#include \"virconf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_firmware.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_capabilities.h\"",
      "#include \"qemu_conf.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "qemuSharedDiskAddRemoveInternal",
          "args": [
            "driver",
            "disk",
            "name",
            "true"
          ],
          "line": 1678
        },
        "resolved": true,
        "details": {
          "function_name": "qemuSharedDiskAddRemoveInternal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
          "lines": "1627-1661",
          "snippet": "static int\nqemuSharedDiskAddRemoveInternal(virQEMUDriverPtr driver,\n                                virDomainDiskDefPtr disk,\n                                const char *name,\n                                bool addDisk)\n{\n    g_autofree char *key = NULL;\n    int ret = -1;\n\n    if (virStorageSourceIsEmpty(disk->src) ||\n        !disk->src->shared ||\n        !virStorageSourceIsBlockLocal(disk->src))\n        return 0;\n\n    qemuDriverLock(driver);\n\n    if (!(key = qemuGetSharedDeviceKey(virDomainDiskGetSource(disk))))\n        goto cleanup;\n\n    if (addDisk) {\n        if (qemuCheckSharedDisk(driver->sharedDevices, disk) < 0)\n            goto cleanup;\n\n        if (qemuSharedDeviceEntryInsert(driver, key, name) < 0)\n            goto cleanup;\n    } else {\n        if (qemuSharedDeviceEntryRemove(driver, key, name) < 0)\n            goto cleanup;\n    }\n\n    ret = 0;\n cleanup:\n    qemuDriverUnlock(driver);\n    return ret;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virutil.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virsocket.h\"",
            "#include \"virfile.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virlog.h\"",
            "#include \"virxml.h\"",
            "#include \"datatypes.h\"",
            "#include \"viralloc.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_firmware.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nqemuSharedDiskAddRemoveInternal(virQEMUDriverPtr driver,\n                                virDomainDiskDefPtr disk,\n                                const char *name,\n                                bool addDisk)\n{\n    g_autofree char *key = NULL;\n    int ret = -1;\n\n    if (virStorageSourceIsEmpty(disk->src) ||\n        !disk->src->shared ||\n        !virStorageSourceIsBlockLocal(disk->src))\n        return 0;\n\n    qemuDriverLock(driver);\n\n    if (!(key = qemuGetSharedDeviceKey(virDomainDiskGetSource(disk))))\n        goto cleanup;\n\n    if (addDisk) {\n        if (qemuCheckSharedDisk(driver->sharedDevices, disk) < 0)\n            goto cleanup;\n\n        if (qemuSharedDeviceEntryInsert(driver, key, name) < 0)\n            goto cleanup;\n    } else {\n        if (qemuSharedDeviceEntryRemove(driver, key, name) < 0)\n            goto cleanup;\n    }\n\n    ret = 0;\n cleanup:\n    qemuDriverUnlock(driver);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nint\nqemuAddSharedDisk(virQEMUDriverPtr driver,\n                  virDomainDiskDefPtr disk,\n                  const char *name)\n{\n    return qemuSharedDiskAddRemoveInternal(driver, disk, name, true);\n}"
  },
  {
    "function_name": "qemuSharedDiskAddRemoveInternal",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
    "lines": "1627-1661",
    "snippet": "static int\nqemuSharedDiskAddRemoveInternal(virQEMUDriverPtr driver,\n                                virDomainDiskDefPtr disk,\n                                const char *name,\n                                bool addDisk)\n{\n    g_autofree char *key = NULL;\n    int ret = -1;\n\n    if (virStorageSourceIsEmpty(disk->src) ||\n        !disk->src->shared ||\n        !virStorageSourceIsBlockLocal(disk->src))\n        return 0;\n\n    qemuDriverLock(driver);\n\n    if (!(key = qemuGetSharedDeviceKey(virDomainDiskGetSource(disk))))\n        goto cleanup;\n\n    if (addDisk) {\n        if (qemuCheckSharedDisk(driver->sharedDevices, disk) < 0)\n            goto cleanup;\n\n        if (qemuSharedDeviceEntryInsert(driver, key, name) < 0)\n            goto cleanup;\n    } else {\n        if (qemuSharedDeviceEntryRemove(driver, key, name) < 0)\n            goto cleanup;\n    }\n\n    ret = 0;\n cleanup:\n    qemuDriverUnlock(driver);\n    return ret;\n}",
    "includes": [
      "#include \"configmake.h\"",
      "#include \"virutil.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virstring.h\"",
      "#include \"virsocket.h\"",
      "#include \"virfile.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virlog.h\"",
      "#include \"virxml.h\"",
      "#include \"datatypes.h\"",
      "#include \"viralloc.h\"",
      "#include \"virconf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_firmware.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_capabilities.h\"",
      "#include \"qemu_conf.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "qemuDriverUnlock",
          "args": [
            "driver"
          ],
          "line": 1659
        },
        "resolved": true,
        "details": {
          "function_name": "qemuDriverUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
          "lines": "90-94",
          "snippet": "static void\nqemuDriverUnlock(virQEMUDriverPtr driver)\n{\n    virMutexUnlock(&driver->lock);\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virutil.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virsocket.h\"",
            "#include \"virfile.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virlog.h\"",
            "#include \"virxml.h\"",
            "#include \"datatypes.h\"",
            "#include \"viralloc.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_firmware.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic void\nqemuDriverUnlock(virQEMUDriverPtr driver)\n{\n    virMutexUnlock(&driver->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuSharedDeviceEntryRemove",
          "args": [
            "driver",
            "key",
            "name"
          ],
          "line": 1653
        },
        "resolved": true,
        "details": {
          "function_name": "qemuSharedDeviceEntryRemove",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
          "lines": "1601-1624",
          "snippet": "static int\nqemuSharedDeviceEntryRemove(virQEMUDriverPtr driver,\n                            const char *key,\n                            const char *name)\n{\n    qemuSharedDeviceEntryPtr entry = NULL;\n    int idx;\n\n    if (!(entry = virHashLookup(driver->sharedDevices, key)))\n        return -1;\n\n    /* Nothing to do if the shared disk is not recored in the table. */\n    if (!qemuSharedDeviceEntryDomainExists(entry, name, &idx))\n        return 0;\n\n    if (entry->ref != 1) {\n        VIR_FREE(entry->domains[idx]);\n        VIR_DELETE_ELEMENT(entry->domains, idx, entry->ref);\n    } else {\n        ignore_value(virHashRemoveEntry(driver->sharedDevices, key));\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virutil.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virsocket.h\"",
            "#include \"virfile.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virlog.h\"",
            "#include \"virxml.h\"",
            "#include \"datatypes.h\"",
            "#include \"viralloc.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_firmware.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nqemuSharedDeviceEntryRemove(virQEMUDriverPtr driver,\n                            const char *key,\n                            const char *name)\n{\n    qemuSharedDeviceEntryPtr entry = NULL;\n    int idx;\n\n    if (!(entry = virHashLookup(driver->sharedDevices, key)))\n        return -1;\n\n    /* Nothing to do if the shared disk is not recored in the table. */\n    if (!qemuSharedDeviceEntryDomainExists(entry, name, &idx))\n        return 0;\n\n    if (entry->ref != 1) {\n        VIR_FREE(entry->domains[idx]);\n        VIR_DELETE_ELEMENT(entry->domains, idx, entry->ref);\n    } else {\n        ignore_value(virHashRemoveEntry(driver->sharedDevices, key));\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuSharedDeviceEntryInsert",
          "args": [
            "driver",
            "key",
            "name"
          ],
          "line": 1650
        },
        "resolved": true,
        "details": {
          "function_name": "qemuSharedDeviceEntryInsert",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
          "lines": "1561-1598",
          "snippet": "static int\nqemuSharedDeviceEntryInsert(virQEMUDriverPtr driver,\n                            const char *key,\n                            const char *name)\n{\n    qemuSharedDeviceEntry *entry = NULL;\n\n    if ((entry = virHashLookup(driver->sharedDevices, key))) {\n        /* Nothing to do if the shared scsi host device is already\n         * recorded in the table.\n         */\n        if (!qemuSharedDeviceEntryDomainExists(entry, name, NULL)) {\n            if (VIR_EXPAND_N(entry->domains, entry->ref, 1) < 0) {\n                /* entry is owned by the hash table here */\n                entry = NULL;\n                goto error;\n            }\n            entry->domains[entry->ref - 1] = g_strdup(name);\n        }\n    } else {\n        if (VIR_ALLOC(entry) < 0 ||\n            VIR_ALLOC_N(entry->domains, 1) < 0)\n            goto error;\n\n        entry->domains[0] = g_strdup(name);\n\n        entry->ref = 1;\n\n        if (virHashAddEntry(driver->sharedDevices, key, entry) < 0)\n            goto error;\n    }\n\n    return 0;\n\n error:\n    qemuSharedDeviceEntryFree(entry);\n    return -1;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virutil.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virsocket.h\"",
            "#include \"virfile.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virlog.h\"",
            "#include \"virxml.h\"",
            "#include \"datatypes.h\"",
            "#include \"viralloc.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_firmware.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nqemuSharedDeviceEntryInsert(virQEMUDriverPtr driver,\n                            const char *key,\n                            const char *name)\n{\n    qemuSharedDeviceEntry *entry = NULL;\n\n    if ((entry = virHashLookup(driver->sharedDevices, key))) {\n        /* Nothing to do if the shared scsi host device is already\n         * recorded in the table.\n         */\n        if (!qemuSharedDeviceEntryDomainExists(entry, name, NULL)) {\n            if (VIR_EXPAND_N(entry->domains, entry->ref, 1) < 0) {\n                /* entry is owned by the hash table here */\n                entry = NULL;\n                goto error;\n            }\n            entry->domains[entry->ref - 1] = g_strdup(name);\n        }\n    } else {\n        if (VIR_ALLOC(entry) < 0 ||\n            VIR_ALLOC_N(entry->domains, 1) < 0)\n            goto error;\n\n        entry->domains[0] = g_strdup(name);\n\n        entry->ref = 1;\n\n        if (virHashAddEntry(driver->sharedDevices, key, entry) < 0)\n            goto error;\n    }\n\n    return 0;\n\n error:\n    qemuSharedDeviceEntryFree(entry);\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuCheckSharedDisk",
          "args": [
            "driver->sharedDevices",
            "disk"
          ],
          "line": 1647
        },
        "resolved": true,
        "details": {
          "function_name": "qemuCheckSharedDisk",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
          "lines": "1495-1524",
          "snippet": "static int\nqemuCheckSharedDisk(virHashTablePtr sharedDevices,\n                    virDomainDiskDefPtr disk)\n{\n    int ret;\n\n    if (disk->device != VIR_DOMAIN_DISK_DEVICE_LUN)\n        return 0;\n\n    if ((ret = qemuCheckUnprivSGIO(sharedDevices, disk->src->path,\n                                   disk->sgio)) < 0) {\n        if (ret == -2) {\n            if (virDomainDiskGetType(disk) == VIR_STORAGE_TYPE_VOLUME) {\n                virReportError(VIR_ERR_OPERATION_INVALID,\n                               _(\"sgio of shared disk 'pool=%s' 'volume=%s' \"\n                                 \"conflicts with other active domains\"),\n                               disk->src->srcpool->pool,\n                               disk->src->srcpool->volume);\n            } else {\n                virReportError(VIR_ERR_OPERATION_INVALID,\n                               _(\"sgio of shared disk '%s' conflicts with \"\n                                 \"other active domains\"),\n                               disk->src->path);\n            }\n        }\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virutil.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virsocket.h\"",
            "#include \"virfile.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virlog.h\"",
            "#include \"virxml.h\"",
            "#include \"datatypes.h\"",
            "#include \"viralloc.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_firmware.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nqemuCheckSharedDisk(virHashTablePtr sharedDevices,\n                    virDomainDiskDefPtr disk)\n{\n    int ret;\n\n    if (disk->device != VIR_DOMAIN_DISK_DEVICE_LUN)\n        return 0;\n\n    if ((ret = qemuCheckUnprivSGIO(sharedDevices, disk->src->path,\n                                   disk->sgio)) < 0) {\n        if (ret == -2) {\n            if (virDomainDiskGetType(disk) == VIR_STORAGE_TYPE_VOLUME) {\n                virReportError(VIR_ERR_OPERATION_INVALID,\n                               _(\"sgio of shared disk 'pool=%s' 'volume=%s' \"\n                                 \"conflicts with other active domains\"),\n                               disk->src->srcpool->pool,\n                               disk->src->srcpool->volume);\n            } else {\n                virReportError(VIR_ERR_OPERATION_INVALID,\n                               _(\"sgio of shared disk '%s' conflicts with \"\n                                 \"other active domains\"),\n                               disk->src->path);\n            }\n        }\n        return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuGetSharedDeviceKey",
          "args": [
            "virDomainDiskGetSource(disk)"
          ],
          "line": 1643
        },
        "resolved": true,
        "details": {
          "function_name": "qemuGetSharedDeviceKey",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
          "lines": "1417-1434",
          "snippet": "char *\nqemuGetSharedDeviceKey(const char *device_path)\n{\n    int maj, min;\n    char *key = NULL;\n    int rc;\n\n    if ((rc = virGetDeviceID(device_path, &maj, &min)) < 0) {\n        virReportSystemError(-rc,\n                             _(\"Unable to get minor number of device '%s'\"),\n                             device_path);\n        return NULL;\n    }\n\n    key = g_strdup_printf(\"%d:%d\", maj, min);\n\n    return key;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virutil.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virsocket.h\"",
            "#include \"virfile.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virlog.h\"",
            "#include \"virxml.h\"",
            "#include \"datatypes.h\"",
            "#include \"viralloc.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_firmware.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nchar *\nqemuGetSharedDeviceKey(const char *device_path)\n{\n    int maj, min;\n    char *key = NULL;\n    int rc;\n\n    if ((rc = virGetDeviceID(device_path, &maj, &min)) < 0) {\n        virReportSystemError(-rc,\n                             _(\"Unable to get minor number of device '%s'\"),\n                             device_path);\n        return NULL;\n    }\n\n    key = g_strdup_printf(\"%d:%d\", maj, min);\n\n    return key;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDiskGetSource",
          "args": [
            "disk"
          ],
          "line": 1643
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDiskGetSource",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "2155-2159",
          "snippet": "const char *\nvirDomainDiskGetSource(virDomainDiskDef const *def)\n{\n    return def->src->path;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nconst char *\nvirDomainDiskGetSource(virDomainDiskDef const *def)\n{\n    return def->src->path;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuDriverLock",
          "args": [
            "driver"
          ],
          "line": 1641
        },
        "resolved": true,
        "details": {
          "function_name": "qemuDriverLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
          "lines": "85-89",
          "snippet": "static void\nqemuDriverLock(virQEMUDriverPtr driver)\n{\n    virMutexLock(&driver->lock);\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virutil.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virsocket.h\"",
            "#include \"virfile.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virlog.h\"",
            "#include \"virxml.h\"",
            "#include \"datatypes.h\"",
            "#include \"viralloc.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_firmware.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic void\nqemuDriverLock(virQEMUDriverPtr driver)\n{\n    virMutexLock(&driver->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStorageSourceIsBlockLocal",
          "args": [
            "disk->src"
          ],
          "line": 1638
        },
        "resolved": true,
        "details": {
          "function_name": "virStorageSourceIsBlockLocal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstoragefile.c",
          "lines": "2643-2647",
          "snippet": "bool\nvirStorageSourceIsBlockLocal(const virStorageSource *src)\n{\n    return virStorageSourceGetActualType(src) == VIR_STORAGE_TYPE_BLOCK;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsecret.h\"",
            "#include \"virstorageencryption.h\"",
            "#include \"virjson.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruri.h\"",
            "#include \"virstring.h\"",
            "#include \"virendian.h\"",
            "#include \"virhash.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include \"virstoragefilebackend.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsecret.h\"\n#include \"virstorageencryption.h\"\n#include \"virjson.h\"\n#include \"virbuffer.h\"\n#include \"viruri.h\"\n#include \"virstring.h\"\n#include \"virendian.h\"\n#include \"virhash.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include \"virstoragefilebackend.h\"\n#include <config.h>\n\nbool\nvirStorageSourceIsBlockLocal(const virStorageSource *src)\n{\n    return virStorageSourceGetActualType(src) == VIR_STORAGE_TYPE_BLOCK;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virStorageSourceIsEmpty",
          "args": [
            "disk->src"
          ],
          "line": 1636
        },
        "resolved": true,
        "details": {
          "function_name": "virStorageSourceIsEmpty",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstoragefile.c",
          "lines": "2619-2633",
          "snippet": "bool\nvirStorageSourceIsEmpty(virStorageSourcePtr src)\n{\n    if (virStorageSourceIsLocalStorage(src) && !src->path)\n        return true;\n\n    if (src->type == VIR_STORAGE_TYPE_NONE)\n        return true;\n\n    if (src->type == VIR_STORAGE_TYPE_NETWORK &&\n        src->protocol == VIR_STORAGE_NET_PROTOCOL_NONE)\n        return true;\n\n    return false;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsecret.h\"",
            "#include \"virstorageencryption.h\"",
            "#include \"virjson.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruri.h\"",
            "#include \"virstring.h\"",
            "#include \"virendian.h\"",
            "#include \"virhash.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include \"virstoragefilebackend.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsecret.h\"\n#include \"virstorageencryption.h\"\n#include \"virjson.h\"\n#include \"virbuffer.h\"\n#include \"viruri.h\"\n#include \"virstring.h\"\n#include \"virendian.h\"\n#include \"virhash.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include \"virstoragefilebackend.h\"\n#include <config.h>\n\nbool\nvirStorageSourceIsEmpty(virStorageSourcePtr src)\n{\n    if (virStorageSourceIsLocalStorage(src) && !src->path)\n        return true;\n\n    if (src->type == VIR_STORAGE_TYPE_NONE)\n        return true;\n\n    if (src->type == VIR_STORAGE_TYPE_NETWORK &&\n        src->protocol == VIR_STORAGE_NET_PROTOCOL_NONE)\n        return true;\n\n    return false;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nqemuSharedDiskAddRemoveInternal(virQEMUDriverPtr driver,\n                                virDomainDiskDefPtr disk,\n                                const char *name,\n                                bool addDisk)\n{\n    g_autofree char *key = NULL;\n    int ret = -1;\n\n    if (virStorageSourceIsEmpty(disk->src) ||\n        !disk->src->shared ||\n        !virStorageSourceIsBlockLocal(disk->src))\n        return 0;\n\n    qemuDriverLock(driver);\n\n    if (!(key = qemuGetSharedDeviceKey(virDomainDiskGetSource(disk))))\n        goto cleanup;\n\n    if (addDisk) {\n        if (qemuCheckSharedDisk(driver->sharedDevices, disk) < 0)\n            goto cleanup;\n\n        if (qemuSharedDeviceEntryInsert(driver, key, name) < 0)\n            goto cleanup;\n    } else {\n        if (qemuSharedDeviceEntryRemove(driver, key, name) < 0)\n            goto cleanup;\n    }\n\n    ret = 0;\n cleanup:\n    qemuDriverUnlock(driver);\n    return ret;\n}"
  },
  {
    "function_name": "qemuSharedDeviceEntryRemove",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
    "lines": "1601-1624",
    "snippet": "static int\nqemuSharedDeviceEntryRemove(virQEMUDriverPtr driver,\n                            const char *key,\n                            const char *name)\n{\n    qemuSharedDeviceEntryPtr entry = NULL;\n    int idx;\n\n    if (!(entry = virHashLookup(driver->sharedDevices, key)))\n        return -1;\n\n    /* Nothing to do if the shared disk is not recored in the table. */\n    if (!qemuSharedDeviceEntryDomainExists(entry, name, &idx))\n        return 0;\n\n    if (entry->ref != 1) {\n        VIR_FREE(entry->domains[idx]);\n        VIR_DELETE_ELEMENT(entry->domains, idx, entry->ref);\n    } else {\n        ignore_value(virHashRemoveEntry(driver->sharedDevices, key));\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"configmake.h\"",
      "#include \"virutil.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virstring.h\"",
      "#include \"virsocket.h\"",
      "#include \"virfile.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virlog.h\"",
      "#include \"virxml.h\"",
      "#include \"datatypes.h\"",
      "#include \"viralloc.h\"",
      "#include \"virconf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_firmware.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_capabilities.h\"",
      "#include \"qemu_conf.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ignore_value",
          "args": [
            "virHashRemoveEntry(driver->sharedDevices, key)"
          ],
          "line": 1620
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virHashRemoveEntry",
          "args": [
            "driver->sharedDevices",
            "key"
          ],
          "line": 1620
        },
        "resolved": true,
        "details": {
          "function_name": "virHashRemoveEntry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "584-609",
          "snippet": "int\nvirHashRemoveEntry(virHashTablePtr table, const void *name)\n{\n    virHashEntryPtr entry;\n    virHashEntryPtr *nextptr;\n\n    if (table == NULL || name == NULL)\n        return -1;\n\n    nextptr = table->table + virHashComputeKey(table, name);\n    for (entry = *nextptr; entry; entry = entry->next) {\n        if (table->keyEqual(entry->name, name)) {\n            if (table->dataFree)\n                table->dataFree(entry->payload);\n            if (table->keyFree)\n                table->keyFree(entry->name);\n            *nextptr = entry->next;\n            VIR_FREE(entry);\n            table->nbElems--;\n            return 0;\n        }\n        nextptr = &entry->next;\n    }\n\n    return -1;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint\nvirHashRemoveEntry(virHashTablePtr table, const void *name)\n{\n    virHashEntryPtr entry;\n    virHashEntryPtr *nextptr;\n\n    if (table == NULL || name == NULL)\n        return -1;\n\n    nextptr = table->table + virHashComputeKey(table, name);\n    for (entry = *nextptr; entry; entry = entry->next) {\n        if (table->keyEqual(entry->name, name)) {\n            if (table->dataFree)\n                table->dataFree(entry->payload);\n            if (table->keyFree)\n                table->keyFree(entry->name);\n            *nextptr = entry->next;\n            VIR_FREE(entry);\n            table->nbElems--;\n            return 0;\n        }\n        nextptr = &entry->next;\n    }\n\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DELETE_ELEMENT",
          "args": [
            "entry->domains",
            "idx",
            "entry->ref"
          ],
          "line": 1618
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "entry->domains[idx]"
          ],
          "line": 1617
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qemuSharedDeviceEntryDomainExists",
          "args": [
            "entry",
            "name",
            "&idx"
          ],
          "line": 1613
        },
        "resolved": true,
        "details": {
          "function_name": "qemuSharedDeviceEntryDomainExists",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
          "lines": "1527-1543",
          "snippet": "bool\nqemuSharedDeviceEntryDomainExists(qemuSharedDeviceEntryPtr entry,\n                                  const char *name,\n                                  int *idx)\n{\n    size_t i;\n\n    for (i = 0; i < entry->ref; i++) {\n        if (STREQ(entry->domains[i], name)) {\n            if (idx)\n                *idx = i;\n            return true;\n        }\n    }\n\n    return false;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virutil.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virsocket.h\"",
            "#include \"virfile.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virlog.h\"",
            "#include \"virxml.h\"",
            "#include \"datatypes.h\"",
            "#include \"viralloc.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_firmware.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nbool\nqemuSharedDeviceEntryDomainExists(qemuSharedDeviceEntryPtr entry,\n                                  const char *name,\n                                  int *idx)\n{\n    size_t i;\n\n    for (i = 0; i < entry->ref; i++) {\n        if (STREQ(entry->domains[i], name)) {\n            if (idx)\n                *idx = i;\n            return true;\n        }\n    }\n\n    return false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashLookup",
          "args": [
            "driver->sharedDevices",
            "key"
          ],
          "line": 1609
        },
        "resolved": true,
        "details": {
          "function_name": "virHashLookup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "473-482",
          "snippet": "void *\nvirHashLookup(const virHashTable *table, const void *name)\n{\n    virHashEntryPtr entry = virHashGetEntry(table, name);\n\n    if (!entry)\n        return NULL;\n\n    return entry->payload;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvoid *\nvirHashLookup(const virHashTable *table, const void *name)\n{\n    virHashEntryPtr entry = virHashGetEntry(table, name);\n\n    if (!entry)\n        return NULL;\n\n    return entry->payload;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nqemuSharedDeviceEntryRemove(virQEMUDriverPtr driver,\n                            const char *key,\n                            const char *name)\n{\n    qemuSharedDeviceEntryPtr entry = NULL;\n    int idx;\n\n    if (!(entry = virHashLookup(driver->sharedDevices, key)))\n        return -1;\n\n    /* Nothing to do if the shared disk is not recored in the table. */\n    if (!qemuSharedDeviceEntryDomainExists(entry, name, &idx))\n        return 0;\n\n    if (entry->ref != 1) {\n        VIR_FREE(entry->domains[idx]);\n        VIR_DELETE_ELEMENT(entry->domains, idx, entry->ref);\n    } else {\n        ignore_value(virHashRemoveEntry(driver->sharedDevices, key));\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "qemuSharedDeviceEntryInsert",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
    "lines": "1561-1598",
    "snippet": "static int\nqemuSharedDeviceEntryInsert(virQEMUDriverPtr driver,\n                            const char *key,\n                            const char *name)\n{\n    qemuSharedDeviceEntry *entry = NULL;\n\n    if ((entry = virHashLookup(driver->sharedDevices, key))) {\n        /* Nothing to do if the shared scsi host device is already\n         * recorded in the table.\n         */\n        if (!qemuSharedDeviceEntryDomainExists(entry, name, NULL)) {\n            if (VIR_EXPAND_N(entry->domains, entry->ref, 1) < 0) {\n                /* entry is owned by the hash table here */\n                entry = NULL;\n                goto error;\n            }\n            entry->domains[entry->ref - 1] = g_strdup(name);\n        }\n    } else {\n        if (VIR_ALLOC(entry) < 0 ||\n            VIR_ALLOC_N(entry->domains, 1) < 0)\n            goto error;\n\n        entry->domains[0] = g_strdup(name);\n\n        entry->ref = 1;\n\n        if (virHashAddEntry(driver->sharedDevices, key, entry) < 0)\n            goto error;\n    }\n\n    return 0;\n\n error:\n    qemuSharedDeviceEntryFree(entry);\n    return -1;\n}",
    "includes": [
      "#include \"configmake.h\"",
      "#include \"virutil.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virstring.h\"",
      "#include \"virsocket.h\"",
      "#include \"virfile.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virlog.h\"",
      "#include \"virxml.h\"",
      "#include \"datatypes.h\"",
      "#include \"viralloc.h\"",
      "#include \"virconf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_firmware.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_capabilities.h\"",
      "#include \"qemu_conf.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "qemuSharedDeviceEntryFree",
          "args": [
            "entry"
          ],
          "line": 1596
        },
        "resolved": true,
        "details": {
          "function_name": "qemuSharedDeviceEntryFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
          "lines": "1545-1558",
          "snippet": "void\nqemuSharedDeviceEntryFree(void *payload)\n{\n    qemuSharedDeviceEntryPtr entry = payload;\n    size_t i;\n\n    if (!entry)\n        return;\n\n    for (i = 0; i < entry->ref; i++)\n        VIR_FREE(entry->domains[i]);\n    VIR_FREE(entry->domains);\n    VIR_FREE(entry);\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virutil.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virsocket.h\"",
            "#include \"virfile.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virlog.h\"",
            "#include \"virxml.h\"",
            "#include \"datatypes.h\"",
            "#include \"viralloc.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_firmware.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvoid\nqemuSharedDeviceEntryFree(void *payload)\n{\n    qemuSharedDeviceEntryPtr entry = payload;\n    size_t i;\n\n    if (!entry)\n        return;\n\n    for (i = 0; i < entry->ref; i++)\n        VIR_FREE(entry->domains[i]);\n    VIR_FREE(entry->domains);\n    VIR_FREE(entry);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashAddEntry",
          "args": [
            "driver->sharedDevices",
            "key",
            "entry"
          ],
          "line": 1589
        },
        "resolved": true,
        "details": {
          "function_name": "virHashAddEntry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "404-408",
          "snippet": "int\nvirHashAddEntry(virHashTablePtr table, const void *name, void *userdata)\n{\n    return virHashAddOrUpdateEntry(table, name, userdata, false);\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nint\nvirHashAddEntry(virHashTablePtr table, const void *name, void *userdata)\n{\n    return virHashAddOrUpdateEntry(table, name, userdata, false);\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "name"
          ],
          "line": 1585
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC_N",
          "args": [
            "entry->domains",
            "1"
          ],
          "line": 1582
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC",
          "args": [
            "entry"
          ],
          "line": 1581
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_EXPAND_N",
          "args": [
            "entry->domains",
            "entry->ref",
            "1"
          ],
          "line": 1573
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qemuSharedDeviceEntryDomainExists",
          "args": [
            "entry",
            "name",
            "NULL"
          ],
          "line": 1572
        },
        "resolved": true,
        "details": {
          "function_name": "qemuSharedDeviceEntryDomainExists",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
          "lines": "1527-1543",
          "snippet": "bool\nqemuSharedDeviceEntryDomainExists(qemuSharedDeviceEntryPtr entry,\n                                  const char *name,\n                                  int *idx)\n{\n    size_t i;\n\n    for (i = 0; i < entry->ref; i++) {\n        if (STREQ(entry->domains[i], name)) {\n            if (idx)\n                *idx = i;\n            return true;\n        }\n    }\n\n    return false;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virutil.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virsocket.h\"",
            "#include \"virfile.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virlog.h\"",
            "#include \"virxml.h\"",
            "#include \"datatypes.h\"",
            "#include \"viralloc.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_firmware.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nbool\nqemuSharedDeviceEntryDomainExists(qemuSharedDeviceEntryPtr entry,\n                                  const char *name,\n                                  int *idx)\n{\n    size_t i;\n\n    for (i = 0; i < entry->ref; i++) {\n        if (STREQ(entry->domains[i], name)) {\n            if (idx)\n                *idx = i;\n            return true;\n        }\n    }\n\n    return false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashLookup",
          "args": [
            "driver->sharedDevices",
            "key"
          ],
          "line": 1568
        },
        "resolved": true,
        "details": {
          "function_name": "virHashLookup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "473-482",
          "snippet": "void *\nvirHashLookup(const virHashTable *table, const void *name)\n{\n    virHashEntryPtr entry = virHashGetEntry(table, name);\n\n    if (!entry)\n        return NULL;\n\n    return entry->payload;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvoid *\nvirHashLookup(const virHashTable *table, const void *name)\n{\n    virHashEntryPtr entry = virHashGetEntry(table, name);\n\n    if (!entry)\n        return NULL;\n\n    return entry->payload;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nqemuSharedDeviceEntryInsert(virQEMUDriverPtr driver,\n                            const char *key,\n                            const char *name)\n{\n    qemuSharedDeviceEntry *entry = NULL;\n\n    if ((entry = virHashLookup(driver->sharedDevices, key))) {\n        /* Nothing to do if the shared scsi host device is already\n         * recorded in the table.\n         */\n        if (!qemuSharedDeviceEntryDomainExists(entry, name, NULL)) {\n            if (VIR_EXPAND_N(entry->domains, entry->ref, 1) < 0) {\n                /* entry is owned by the hash table here */\n                entry = NULL;\n                goto error;\n            }\n            entry->domains[entry->ref - 1] = g_strdup(name);\n        }\n    } else {\n        if (VIR_ALLOC(entry) < 0 ||\n            VIR_ALLOC_N(entry->domains, 1) < 0)\n            goto error;\n\n        entry->domains[0] = g_strdup(name);\n\n        entry->ref = 1;\n\n        if (virHashAddEntry(driver->sharedDevices, key, entry) < 0)\n            goto error;\n    }\n\n    return 0;\n\n error:\n    qemuSharedDeviceEntryFree(entry);\n    return -1;\n}"
  },
  {
    "function_name": "qemuSharedDeviceEntryFree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
    "lines": "1545-1558",
    "snippet": "void\nqemuSharedDeviceEntryFree(void *payload)\n{\n    qemuSharedDeviceEntryPtr entry = payload;\n    size_t i;\n\n    if (!entry)\n        return;\n\n    for (i = 0; i < entry->ref; i++)\n        VIR_FREE(entry->domains[i]);\n    VIR_FREE(entry->domains);\n    VIR_FREE(entry);\n}",
    "includes": [
      "#include \"configmake.h\"",
      "#include \"virutil.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virstring.h\"",
      "#include \"virsocket.h\"",
      "#include \"virfile.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virlog.h\"",
      "#include \"virxml.h\"",
      "#include \"datatypes.h\"",
      "#include \"viralloc.h\"",
      "#include \"virconf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_firmware.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_capabilities.h\"",
      "#include \"qemu_conf.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "entry"
          ],
          "line": 1557
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "entry->domains"
          ],
          "line": 1556
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "entry->domains[i]"
          ],
          "line": 1555
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvoid\nqemuSharedDeviceEntryFree(void *payload)\n{\n    qemuSharedDeviceEntryPtr entry = payload;\n    size_t i;\n\n    if (!entry)\n        return;\n\n    for (i = 0; i < entry->ref; i++)\n        VIR_FREE(entry->domains[i]);\n    VIR_FREE(entry->domains);\n    VIR_FREE(entry);\n}"
  },
  {
    "function_name": "qemuSharedDeviceEntryDomainExists",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
    "lines": "1527-1543",
    "snippet": "bool\nqemuSharedDeviceEntryDomainExists(qemuSharedDeviceEntryPtr entry,\n                                  const char *name,\n                                  int *idx)\n{\n    size_t i;\n\n    for (i = 0; i < entry->ref; i++) {\n        if (STREQ(entry->domains[i], name)) {\n            if (idx)\n                *idx = i;\n            return true;\n        }\n    }\n\n    return false;\n}",
    "includes": [
      "#include \"configmake.h\"",
      "#include \"virutil.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virstring.h\"",
      "#include \"virsocket.h\"",
      "#include \"virfile.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virlog.h\"",
      "#include \"virxml.h\"",
      "#include \"datatypes.h\"",
      "#include \"viralloc.h\"",
      "#include \"virconf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_firmware.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_capabilities.h\"",
      "#include \"qemu_conf.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "entry->domains[i]",
            "name"
          ],
          "line": 1535
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nbool\nqemuSharedDeviceEntryDomainExists(qemuSharedDeviceEntryPtr entry,\n                                  const char *name,\n                                  int *idx)\n{\n    size_t i;\n\n    for (i = 0; i < entry->ref; i++) {\n        if (STREQ(entry->domains[i], name)) {\n            if (idx)\n                *idx = i;\n            return true;\n        }\n    }\n\n    return false;\n}"
  },
  {
    "function_name": "qemuCheckSharedDisk",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
    "lines": "1495-1524",
    "snippet": "static int\nqemuCheckSharedDisk(virHashTablePtr sharedDevices,\n                    virDomainDiskDefPtr disk)\n{\n    int ret;\n\n    if (disk->device != VIR_DOMAIN_DISK_DEVICE_LUN)\n        return 0;\n\n    if ((ret = qemuCheckUnprivSGIO(sharedDevices, disk->src->path,\n                                   disk->sgio)) < 0) {\n        if (ret == -2) {\n            if (virDomainDiskGetType(disk) == VIR_STORAGE_TYPE_VOLUME) {\n                virReportError(VIR_ERR_OPERATION_INVALID,\n                               _(\"sgio of shared disk 'pool=%s' 'volume=%s' \"\n                                 \"conflicts with other active domains\"),\n                               disk->src->srcpool->pool,\n                               disk->src->srcpool->volume);\n            } else {\n                virReportError(VIR_ERR_OPERATION_INVALID,\n                               _(\"sgio of shared disk '%s' conflicts with \"\n                                 \"other active domains\"),\n                               disk->src->path);\n            }\n        }\n        return -1;\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"configmake.h\"",
      "#include \"virutil.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virstring.h\"",
      "#include \"virsocket.h\"",
      "#include \"virfile.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virlog.h\"",
      "#include \"virxml.h\"",
      "#include \"datatypes.h\"",
      "#include \"viralloc.h\"",
      "#include \"virconf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_firmware.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_capabilities.h\"",
      "#include \"qemu_conf.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_INVALID",
            "_(\"sgio of shared disk '%s' conflicts with \"\n                                 \"other active domains\")",
            "disk->src->path"
          ],
          "line": 1514
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"sgio of shared disk '%s' conflicts with \"\n                                 \"other active domains\""
          ],
          "line": 1515
        },
        "resolved": true,
        "details": {
          "function_name": "bswap_header",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_driver.c",
          "lines": "2852-2860",
          "snippet": "static inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virenum.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virqemu.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virnuma.h\"",
            "#include \"virperf.h\"",
            "#include \"vircgroup.h\"",
            "#include \"domain_capabilities.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapicheckqemu.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virkeycode.h\"",
            "#include \"locking/domain_lock.h\"",
            "#include \"locking/lock_manager.h\"",
            "#include \"virthreadpool.h\"",
            "#include \"configmake.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virhook.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virxml.h\"",
            "#include \"libvirt_internal.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virusb.h\"",
            "#include \"virpci.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"domain_conf.h\"",
            "#include \"viruuid.h\"",
            "#include \"virarptable.h\"",
            "#include \"viralloc.h\"",
            "#include \"capabilities.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virbuffer.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"qemu_backup.h\"",
            "#include \"qemu_checkpoint.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_blockjob.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_monitor.h\"",
            "#include \"qemu_hotplug.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"qemu_block.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_agent.h\"",
            "#include \"qemu_driver.h\"",
            "#include <sys/ioctl.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <dirent.h>",
            "#include <sys/time.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virenum.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virqemu.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virnuma.h\"\n#include \"virperf.h\"\n#include \"vircgroup.h\"\n#include \"domain_capabilities.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapicheckqemu.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virbitmap.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virnodesuspend.h\"\n#include \"virkeycode.h\"\n#include \"locking/domain_lock.h\"\n#include \"locking/lock_manager.h\"\n#include \"virthreadpool.h\"\n#include \"configmake.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"virhook.h\"\n#include \"domain_nwfilter.h\"\n#include \"virsysinfo.h\"\n#include \"cpu/cpu.h\"\n#include \"virxml.h\"\n#include \"libvirt_internal.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virusb.h\"\n#include \"virpci.h\"\n#include \"node_device_conf.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"domain_conf.h\"\n#include \"viruuid.h\"\n#include \"virarptable.h\"\n#include \"viralloc.h\"\n#include \"capabilities.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevtap.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"qemu_backup.h\"\n#include \"qemu_checkpoint.h\"\n#include \"qemu_security.h\"\n#include \"qemu_blockjob.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_process.h\"\n#include \"qemu_monitor.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_cgroup.h\"\n#include \"qemu_command.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"qemu_block.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_agent.h\"\n#include \"qemu_driver.h\"\n#include <sys/ioctl.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <dirent.h>\n#include <sys/time.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_OPERATION_INVALID",
            "_(\"sgio of shared disk 'pool=%s' 'volume=%s' \"\n                                 \"conflicts with other active domains\")",
            "disk->src->srcpool->pool",
            "disk->src->srcpool->volume"
          ],
          "line": 1508
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virDomainDiskGetType",
          "args": [
            "disk"
          ],
          "line": 1507
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDiskGetType",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "2141-2145",
          "snippet": "int\nvirDomainDiskGetType(virDomainDiskDefPtr def)\n{\n    return def->src->type;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nint\nvirDomainDiskGetType(virDomainDiskDefPtr def)\n{\n    return def->src->type;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuCheckUnprivSGIO",
          "args": [
            "sharedDevices",
            "disk->src->path",
            "disk->sgio"
          ],
          "line": 1504
        },
        "resolved": true,
        "details": {
          "function_name": "qemuCheckUnprivSGIO",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
          "lines": "1447-1485",
          "snippet": "static int\nqemuCheckUnprivSGIO(virHashTablePtr sharedDevices,\n                    const char *device_path,\n                    int sgio)\n{\n    g_autofree char *sysfs_path = NULL;\n    g_autofree char *key = NULL;\n    int val;\n\n    if (!(sysfs_path = virGetUnprivSGIOSysfsPath(device_path, NULL)))\n        return -1;\n\n    /* It can't be conflict if unpriv_sgio is not supported by kernel. */\n    if (!virFileExists(sysfs_path))\n        return 0;\n\n    if (!(key = qemuGetSharedDeviceKey(device_path)))\n        return -1;\n\n    /* It can't be conflict if no other domain is sharing it. */\n    if (!(virHashLookup(sharedDevices, key)))\n        return 0;\n\n    if (virGetDeviceUnprivSGIO(device_path, NULL, &val) < 0)\n        return -1;\n\n    /* Error message on failure needs to be handled in caller\n     * since there is more specific knowledge of device\n     */\n    if (!((val == 0 &&\n           (sgio == VIR_DOMAIN_DEVICE_SGIO_FILTERED ||\n            sgio == VIR_DOMAIN_DEVICE_SGIO_DEFAULT)) ||\n          (val == 1 &&\n           sgio == VIR_DOMAIN_DEVICE_SGIO_UNFILTERED))) {\n        return -2;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virutil.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virsocket.h\"",
            "#include \"virfile.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virlog.h\"",
            "#include \"virxml.h\"",
            "#include \"datatypes.h\"",
            "#include \"viralloc.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_firmware.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nqemuCheckUnprivSGIO(virHashTablePtr sharedDevices,\n                    const char *device_path,\n                    int sgio)\n{\n    g_autofree char *sysfs_path = NULL;\n    g_autofree char *key = NULL;\n    int val;\n\n    if (!(sysfs_path = virGetUnprivSGIOSysfsPath(device_path, NULL)))\n        return -1;\n\n    /* It can't be conflict if unpriv_sgio is not supported by kernel. */\n    if (!virFileExists(sysfs_path))\n        return 0;\n\n    if (!(key = qemuGetSharedDeviceKey(device_path)))\n        return -1;\n\n    /* It can't be conflict if no other domain is sharing it. */\n    if (!(virHashLookup(sharedDevices, key)))\n        return 0;\n\n    if (virGetDeviceUnprivSGIO(device_path, NULL, &val) < 0)\n        return -1;\n\n    /* Error message on failure needs to be handled in caller\n     * since there is more specific knowledge of device\n     */\n    if (!((val == 0 &&\n           (sgio == VIR_DOMAIN_DEVICE_SGIO_FILTERED ||\n            sgio == VIR_DOMAIN_DEVICE_SGIO_DEFAULT)) ||\n          (val == 1 &&\n           sgio == VIR_DOMAIN_DEVICE_SGIO_UNFILTERED))) {\n        return -2;\n    }\n\n    return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nqemuCheckSharedDisk(virHashTablePtr sharedDevices,\n                    virDomainDiskDefPtr disk)\n{\n    int ret;\n\n    if (disk->device != VIR_DOMAIN_DISK_DEVICE_LUN)\n        return 0;\n\n    if ((ret = qemuCheckUnprivSGIO(sharedDevices, disk->src->path,\n                                   disk->sgio)) < 0) {\n        if (ret == -2) {\n            if (virDomainDiskGetType(disk) == VIR_STORAGE_TYPE_VOLUME) {\n                virReportError(VIR_ERR_OPERATION_INVALID,\n                               _(\"sgio of shared disk 'pool=%s' 'volume=%s' \"\n                                 \"conflicts with other active domains\"),\n                               disk->src->srcpool->pool,\n                               disk->src->srcpool->volume);\n            } else {\n                virReportError(VIR_ERR_OPERATION_INVALID,\n                               _(\"sgio of shared disk '%s' conflicts with \"\n                                 \"other active domains\"),\n                               disk->src->path);\n            }\n        }\n        return -1;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "qemuCheckUnprivSGIO",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
    "lines": "1447-1485",
    "snippet": "static int\nqemuCheckUnprivSGIO(virHashTablePtr sharedDevices,\n                    const char *device_path,\n                    int sgio)\n{\n    g_autofree char *sysfs_path = NULL;\n    g_autofree char *key = NULL;\n    int val;\n\n    if (!(sysfs_path = virGetUnprivSGIOSysfsPath(device_path, NULL)))\n        return -1;\n\n    /* It can't be conflict if unpriv_sgio is not supported by kernel. */\n    if (!virFileExists(sysfs_path))\n        return 0;\n\n    if (!(key = qemuGetSharedDeviceKey(device_path)))\n        return -1;\n\n    /* It can't be conflict if no other domain is sharing it. */\n    if (!(virHashLookup(sharedDevices, key)))\n        return 0;\n\n    if (virGetDeviceUnprivSGIO(device_path, NULL, &val) < 0)\n        return -1;\n\n    /* Error message on failure needs to be handled in caller\n     * since there is more specific knowledge of device\n     */\n    if (!((val == 0 &&\n           (sgio == VIR_DOMAIN_DEVICE_SGIO_FILTERED ||\n            sgio == VIR_DOMAIN_DEVICE_SGIO_DEFAULT)) ||\n          (val == 1 &&\n           sgio == VIR_DOMAIN_DEVICE_SGIO_UNFILTERED))) {\n        return -2;\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"configmake.h\"",
      "#include \"virutil.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virstring.h\"",
      "#include \"virsocket.h\"",
      "#include \"virfile.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virlog.h\"",
      "#include \"virxml.h\"",
      "#include \"datatypes.h\"",
      "#include \"viralloc.h\"",
      "#include \"virconf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_firmware.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_capabilities.h\"",
      "#include \"qemu_conf.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virGetDeviceUnprivSGIO",
          "args": [
            "device_path",
            "NULL",
            "&val"
          ],
          "line": 1470
        },
        "resolved": true,
        "details": {
          "function_name": "virGetDeviceUnprivSGIO",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
          "lines": "1472-1508",
          "snippet": "int\nvirGetDeviceUnprivSGIO(const char *path,\n                       const char *sysfs_dir,\n                       int *unpriv_sgio)\n{\n    char *sysfs_path = NULL;\n    char *buf = NULL;\n    char *tmp = NULL;\n    int ret = -1;\n\n    if (!(sysfs_path = virGetUnprivSGIOSysfsPath(path, sysfs_dir)))\n        return -1;\n\n    if (!virFileExists(sysfs_path)) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"unpriv_sgio is not supported by this kernel\"));\n        goto cleanup;\n    }\n\n    if (virFileReadAll(sysfs_path, 1024, &buf) < 0)\n        goto cleanup;\n\n    if ((tmp = strchr(buf, '\\n')))\n        *tmp = '\\0';\n\n    if (virStrToLong_i(buf, NULL, 10, unpriv_sgio) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"failed to parse value of %s\"), sysfs_path);\n        goto cleanup;\n    }\n\n    ret = 0;\n cleanup:\n    VIR_FREE(sysfs_path);\n    VIR_FREE(buf);\n    return ret;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <sys/prctl.h>",
            "# include <cap-ng.h>",
            "# include <grp.h>",
            "# include <pwd.h>",
            "# include <libdevmapper.h>",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <conio.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nint\nvirGetDeviceUnprivSGIO(const char *path,\n                       const char *sysfs_dir,\n                       int *unpriv_sgio)\n{\n    char *sysfs_path = NULL;\n    char *buf = NULL;\n    char *tmp = NULL;\n    int ret = -1;\n\n    if (!(sysfs_path = virGetUnprivSGIOSysfsPath(path, sysfs_dir)))\n        return -1;\n\n    if (!virFileExists(sysfs_path)) {\n        virReportError(VIR_ERR_OPERATION_INVALID, \"%s\",\n                       _(\"unpriv_sgio is not supported by this kernel\"));\n        goto cleanup;\n    }\n\n    if (virFileReadAll(sysfs_path, 1024, &buf) < 0)\n        goto cleanup;\n\n    if ((tmp = strchr(buf, '\\n')))\n        *tmp = '\\0';\n\n    if (virStrToLong_i(buf, NULL, 10, unpriv_sgio) < 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"failed to parse value of %s\"), sysfs_path);\n        goto cleanup;\n    }\n\n    ret = 0;\n cleanup:\n    VIR_FREE(sysfs_path);\n    VIR_FREE(buf);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virHashLookup",
          "args": [
            "sharedDevices",
            "key"
          ],
          "line": 1467
        },
        "resolved": true,
        "details": {
          "function_name": "virHashLookup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virhash.c",
          "lines": "473-482",
          "snippet": "void *\nvirHashLookup(const virHashTable *table, const void *name)\n{\n    virHashEntryPtr entry = virHashGetEntry(table, name);\n\n    if (!entry)\n        return NULL;\n\n    return entry->payload;\n}",
          "includes": [
            "#include \"virobject.h\"",
            "#include \"virstring.h\"",
            "#include \"virrandom.h\"",
            "#include \"virhashcode.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"virhash.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virobject.h\"\n#include \"virstring.h\"\n#include \"virrandom.h\"\n#include \"virhashcode.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"virhash.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvoid *\nvirHashLookup(const virHashTable *table, const void *name)\n{\n    virHashEntryPtr entry = virHashGetEntry(table, name);\n\n    if (!entry)\n        return NULL;\n\n    return entry->payload;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuGetSharedDeviceKey",
          "args": [
            "device_path"
          ],
          "line": 1463
        },
        "resolved": true,
        "details": {
          "function_name": "qemuGetSharedDeviceKey",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
          "lines": "1417-1434",
          "snippet": "char *\nqemuGetSharedDeviceKey(const char *device_path)\n{\n    int maj, min;\n    char *key = NULL;\n    int rc;\n\n    if ((rc = virGetDeviceID(device_path, &maj, &min)) < 0) {\n        virReportSystemError(-rc,\n                             _(\"Unable to get minor number of device '%s'\"),\n                             device_path);\n        return NULL;\n    }\n\n    key = g_strdup_printf(\"%d:%d\", maj, min);\n\n    return key;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virutil.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virsocket.h\"",
            "#include \"virfile.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virlog.h\"",
            "#include \"virxml.h\"",
            "#include \"datatypes.h\"",
            "#include \"viralloc.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_firmware.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nchar *\nqemuGetSharedDeviceKey(const char *device_path)\n{\n    int maj, min;\n    char *key = NULL;\n    int rc;\n\n    if ((rc = virGetDeviceID(device_path, &maj, &min)) < 0) {\n        virReportSystemError(-rc,\n                             _(\"Unable to get minor number of device '%s'\"),\n                             device_path);\n        return NULL;\n    }\n\n    key = g_strdup_printf(\"%d:%d\", maj, min);\n\n    return key;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virFileExists",
          "args": [
            "sysfs_path"
          ],
          "line": 1460
        },
        "resolved": true,
        "details": {
          "function_name": "virFileExists",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1873-1877",
          "snippet": "bool\nvirFileExists(const char *path)\n{\n    return access(path, F_OK) == 0;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nbool\nvirFileExists(const char *path)\n{\n    return access(path, F_OK) == 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virGetUnprivSGIOSysfsPath",
          "args": [
            "device_path",
            "NULL"
          ],
          "line": 1456
        },
        "resolved": true,
        "details": {
          "function_name": "virGetUnprivSGIOSysfsPath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
          "lines": "1418-1437",
          "snippet": "char *\nvirGetUnprivSGIOSysfsPath(const char *path,\n                          const char *sysfs_dir)\n{\n    int maj, min;\n    char *sysfs_path = NULL;\n    int rc;\n\n    if ((rc = virGetDeviceID(path, &maj, &min)) < 0) {\n        virReportSystemError(-rc,\n                             _(\"Unable to get device ID '%s'\"),\n                             path);\n        return NULL;\n    }\n\n    sysfs_path = g_strdup_printf(\"%s/%d:%d/queue/unpriv_sgio\",\n                                 sysfs_dir ? sysfs_dir : SYSFS_DEV_BLOCK_PATH,\n                                 maj, min);\n    return sysfs_path;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <sys/prctl.h>",
            "# include <cap-ng.h>",
            "# include <grp.h>",
            "# include <pwd.h>",
            "# include <libdevmapper.h>",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <conio.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define SYSFS_DEV_BLOCK_PATH \"/sys/dev/block\""
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\n#define SYSFS_DEV_BLOCK_PATH \"/sys/dev/block\"\n\nchar *\nvirGetUnprivSGIOSysfsPath(const char *path,\n                          const char *sysfs_dir)\n{\n    int maj, min;\n    char *sysfs_path = NULL;\n    int rc;\n\n    if ((rc = virGetDeviceID(path, &maj, &min)) < 0) {\n        virReportSystemError(-rc,\n                             _(\"Unable to get device ID '%s'\"),\n                             path);\n        return NULL;\n    }\n\n    sysfs_path = g_strdup_printf(\"%s/%d:%d/queue/unpriv_sgio\",\n                                 sysfs_dir ? sysfs_dir : SYSFS_DEV_BLOCK_PATH,\n                                 maj, min);\n    return sysfs_path;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nqemuCheckUnprivSGIO(virHashTablePtr sharedDevices,\n                    const char *device_path,\n                    int sgio)\n{\n    g_autofree char *sysfs_path = NULL;\n    g_autofree char *key = NULL;\n    int val;\n\n    if (!(sysfs_path = virGetUnprivSGIOSysfsPath(device_path, NULL)))\n        return -1;\n\n    /* It can't be conflict if unpriv_sgio is not supported by kernel. */\n    if (!virFileExists(sysfs_path))\n        return 0;\n\n    if (!(key = qemuGetSharedDeviceKey(device_path)))\n        return -1;\n\n    /* It can't be conflict if no other domain is sharing it. */\n    if (!(virHashLookup(sharedDevices, key)))\n        return 0;\n\n    if (virGetDeviceUnprivSGIO(device_path, NULL, &val) < 0)\n        return -1;\n\n    /* Error message on failure needs to be handled in caller\n     * since there is more specific knowledge of device\n     */\n    if (!((val == 0 &&\n           (sgio == VIR_DOMAIN_DEVICE_SGIO_FILTERED ||\n            sgio == VIR_DOMAIN_DEVICE_SGIO_DEFAULT)) ||\n          (val == 1 &&\n           sgio == VIR_DOMAIN_DEVICE_SGIO_UNFILTERED))) {\n        return -2;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "qemuGetSharedDeviceKey",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
    "lines": "1417-1434",
    "snippet": "char *\nqemuGetSharedDeviceKey(const char *device_path)\n{\n    int maj, min;\n    char *key = NULL;\n    int rc;\n\n    if ((rc = virGetDeviceID(device_path, &maj, &min)) < 0) {\n        virReportSystemError(-rc,\n                             _(\"Unable to get minor number of device '%s'\"),\n                             device_path);\n        return NULL;\n    }\n\n    key = g_strdup_printf(\"%d:%d\", maj, min);\n\n    return key;\n}",
    "includes": [
      "#include \"configmake.h\"",
      "#include \"virutil.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virstring.h\"",
      "#include \"virsocket.h\"",
      "#include \"virfile.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virlog.h\"",
      "#include \"virxml.h\"",
      "#include \"datatypes.h\"",
      "#include \"viralloc.h\"",
      "#include \"virconf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_firmware.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_capabilities.h\"",
      "#include \"qemu_conf.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_strdup_printf",
          "args": [
            "\"%d:%d\"",
            "maj",
            "min"
          ],
          "line": 1431
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportSystemError",
          "args": [
            "-rc",
            "_(\"Unable to get minor number of device '%s'\")",
            "device_path"
          ],
          "line": 1425
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to get minor number of device '%s'\""
          ],
          "line": 1426
        },
        "resolved": true,
        "details": {
          "function_name": "bswap_header",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_driver.c",
          "lines": "2852-2860",
          "snippet": "static inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virenum.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virqemu.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virnuma.h\"",
            "#include \"virperf.h\"",
            "#include \"vircgroup.h\"",
            "#include \"domain_capabilities.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapicheckqemu.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virkeycode.h\"",
            "#include \"locking/domain_lock.h\"",
            "#include \"locking/lock_manager.h\"",
            "#include \"virthreadpool.h\"",
            "#include \"configmake.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virhook.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virxml.h\"",
            "#include \"libvirt_internal.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virusb.h\"",
            "#include \"virpci.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"domain_conf.h\"",
            "#include \"viruuid.h\"",
            "#include \"virarptable.h\"",
            "#include \"viralloc.h\"",
            "#include \"capabilities.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virbuffer.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"qemu_backup.h\"",
            "#include \"qemu_checkpoint.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_blockjob.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_monitor.h\"",
            "#include \"qemu_hotplug.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"qemu_block.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_agent.h\"",
            "#include \"qemu_driver.h\"",
            "#include <sys/ioctl.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <dirent.h>",
            "#include <sys/time.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virenum.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virqemu.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virnuma.h\"\n#include \"virperf.h\"\n#include \"vircgroup.h\"\n#include \"domain_capabilities.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapicheckqemu.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virbitmap.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virnodesuspend.h\"\n#include \"virkeycode.h\"\n#include \"locking/domain_lock.h\"\n#include \"locking/lock_manager.h\"\n#include \"virthreadpool.h\"\n#include \"configmake.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"virhook.h\"\n#include \"domain_nwfilter.h\"\n#include \"virsysinfo.h\"\n#include \"cpu/cpu.h\"\n#include \"virxml.h\"\n#include \"libvirt_internal.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virusb.h\"\n#include \"virpci.h\"\n#include \"node_device_conf.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"domain_conf.h\"\n#include \"viruuid.h\"\n#include \"virarptable.h\"\n#include \"viralloc.h\"\n#include \"capabilities.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevtap.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"qemu_backup.h\"\n#include \"qemu_checkpoint.h\"\n#include \"qemu_security.h\"\n#include \"qemu_blockjob.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_process.h\"\n#include \"qemu_monitor.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_cgroup.h\"\n#include \"qemu_command.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"qemu_block.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_agent.h\"\n#include \"qemu_driver.h\"\n#include <sys/ioctl.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <dirent.h>\n#include <sys/time.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virGetDeviceID",
          "args": [
            "device_path",
            "&maj",
            "&min"
          ],
          "line": 1424
        },
        "resolved": true,
        "details": {
          "function_name": "virGetDeviceID",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
          "lines": "1406-1413",
          "snippet": "int\nvirGetDeviceID(const char *path G_GNUC_UNUSED,\n               int *maj,\n               int *min)\n{\n    *maj = *min = 0;\n    return -ENOSYS;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <sys/prctl.h>",
            "# include <cap-ng.h>",
            "# include <grp.h>",
            "# include <pwd.h>",
            "# include <libdevmapper.h>",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <conio.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nint\nvirGetDeviceID(const char *path G_GNUC_UNUSED,\n               int *maj,\n               int *min)\n{\n    *maj = *min = 0;\n    return -ENOSYS;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nchar *\nqemuGetSharedDeviceKey(const char *device_path)\n{\n    int maj, min;\n    char *key = NULL;\n    int rc;\n\n    if ((rc = virGetDeviceID(device_path, &maj, &min)) < 0) {\n        virReportSystemError(-rc,\n                             _(\"Unable to get minor number of device '%s'\"),\n                             device_path);\n        return NULL;\n    }\n\n    key = g_strdup_printf(\"%d:%d\", maj, min);\n\n    return key;\n}"
  },
  {
    "function_name": "virQEMUDriverGetDomainCapabilities",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
    "lines": "1391-1408",
    "snippet": "virDomainCapsPtr\nvirQEMUDriverGetDomainCapabilities(virQEMUDriverPtr driver,\n                                   virQEMUCapsPtr qemuCaps,\n                                   const char *machine,\n                                   virArch arch,\n                                   virDomainVirtType virttype)\n{\n    g_autoptr(virQEMUDriverConfig) cfg = virQEMUDriverGetConfig(driver);\n\n    return virQEMUCapsGetDomainCapsCache(qemuCaps,\n                                         machine,\n                                         arch,\n                                         virttype,\n                                         driver->hostarch,\n                                         driver->privileged,\n                                         cfg->firmwares,\n                                         cfg->nfirmwares);\n}",
    "includes": [
      "#include \"configmake.h\"",
      "#include \"virutil.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virstring.h\"",
      "#include \"virsocket.h\"",
      "#include \"virfile.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virlog.h\"",
      "#include \"virxml.h\"",
      "#include \"datatypes.h\"",
      "#include \"viralloc.h\"",
      "#include \"virconf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_firmware.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_capabilities.h\"",
      "#include \"qemu_conf.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virQEMUCapsGetDomainCapsCache",
          "args": [
            "qemuCaps",
            "machine",
            "arch",
            "virttype",
            "driver->hostarch",
            "driver->privileged",
            "cfg->firmwares",
            "cfg->nfirmwares"
          ],
          "line": 1400
        },
        "resolved": true,
        "details": {
          "function_name": "virQEMUCapsGetDomainCapsCache",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_capabilities.c",
          "lines": "2075-2125",
          "snippet": "virDomainCapsPtr\nvirQEMUCapsGetDomainCapsCache(virQEMUCapsPtr qemuCaps,\n                              const char *machine,\n                              virArch arch,\n                              virDomainVirtType virttype,\n                              virArch hostarch,\n                              bool privileged,\n                              virFirmwarePtr *firmwares,\n                              size_t nfirmwares)\n{\n    virQEMUDomainCapsCachePtr cache = qemuCaps->domCapsCache;\n    virDomainCapsPtr domCaps = NULL;\n    const char *path = virQEMUCapsGetBinary(qemuCaps);\n    struct virQEMUCapsSearchDomcapsData data = {\n        .path = path,\n        .machine = machine,\n        .arch = arch,\n        .virttype = virttype,\n    };\n\n    virObjectLock(cache);\n\n    domCaps = virHashSearch(cache->cache, virQEMUCapsSearchDomcaps, &data, NULL);\n\n    if (!domCaps) {\n        g_autoptr(virDomainCaps) tempDomCaps = NULL;\n        g_autofree char *key = NULL;\n\n        /* hash miss, build new domcaps */\n        if (!(tempDomCaps = virDomainCapsNew(path, machine,\n                                             arch, virttype)))\n            goto cleanup;\n\n        if (virQEMUCapsFillDomainCaps(qemuCaps, hostarch, tempDomCaps,\n                                      privileged, firmwares, nfirmwares) < 0)\n            goto cleanup;\n\n        key = g_strdup_printf(\"%d:%d:%s:%s\", arch, virttype,\n                              NULLSTR(machine), path);\n\n        if (virHashAddEntry(cache->cache, key, tempDomCaps) < 0)\n            goto cleanup;\n\n        domCaps = g_steal_pointer(&tempDomCaps);\n    }\n\n    virObjectRef(domCaps);\n cleanup:\n    virObjectUnlock(cache);\n    return domCaps;\n}",
          "includes": [
            "#include <sys/utsname.h>",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include \"virutil.h\"",
            "#include \"qemu_firmware.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_qapi.h\"",
            "#include \"qemu_capspriv.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"virstring.h\"",
            "#include \"qemu_monitor.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virnuma.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virbitmap.h\"",
            "#include \"vircommand.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu/cpu_x86.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfilecache.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"vircrypto.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/utsname.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include \"virutil.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_process.h\"\n#include \"qemu_qapi.h\"\n#include \"qemu_capspriv.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_hostdev.h\"\n#include \"virstring.h\"\n#include \"qemu_monitor.h\"\n#include \"virhostcpu.h\"\n#include \"virnuma.h\"\n#include \"virnodesuspend.h\"\n#include \"virbitmap.h\"\n#include \"vircommand.h\"\n#include \"domain_conf.h\"\n#include \"cpu/cpu_x86.h\"\n#include \"cpu/cpu.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfilecache.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"vircrypto.h\"\n#include \"viralloc.h\"\n#include \"qemu_capabilities.h\"\n#include <config.h>\n\nvirDomainCapsPtr\nvirQEMUCapsGetDomainCapsCache(virQEMUCapsPtr qemuCaps,\n                              const char *machine,\n                              virArch arch,\n                              virDomainVirtType virttype,\n                              virArch hostarch,\n                              bool privileged,\n                              virFirmwarePtr *firmwares,\n                              size_t nfirmwares)\n{\n    virQEMUDomainCapsCachePtr cache = qemuCaps->domCapsCache;\n    virDomainCapsPtr domCaps = NULL;\n    const char *path = virQEMUCapsGetBinary(qemuCaps);\n    struct virQEMUCapsSearchDomcapsData data = {\n        .path = path,\n        .machine = machine,\n        .arch = arch,\n        .virttype = virttype,\n    };\n\n    virObjectLock(cache);\n\n    domCaps = virHashSearch(cache->cache, virQEMUCapsSearchDomcaps, &data, NULL);\n\n    if (!domCaps) {\n        g_autoptr(virDomainCaps) tempDomCaps = NULL;\n        g_autofree char *key = NULL;\n\n        /* hash miss, build new domcaps */\n        if (!(tempDomCaps = virDomainCapsNew(path, machine,\n                                             arch, virttype)))\n            goto cleanup;\n\n        if (virQEMUCapsFillDomainCaps(qemuCaps, hostarch, tempDomCaps,\n                                      privileged, firmwares, nfirmwares) < 0)\n            goto cleanup;\n\n        key = g_strdup_printf(\"%d:%d:%s:%s\", arch, virttype,\n                              NULLSTR(machine), path);\n\n        if (virHashAddEntry(cache->cache, key, tempDomCaps) < 0)\n            goto cleanup;\n\n        domCaps = g_steal_pointer(&tempDomCaps);\n    }\n\n    virObjectRef(domCaps);\n cleanup:\n    virObjectUnlock(cache);\n    return domCaps;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virQEMUDriverGetConfig",
          "args": [
            "driver"
          ],
          "line": 1398
        },
        "resolved": true,
        "details": {
          "function_name": "virQEMUDriverGetConfig",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
          "lines": "1211-1218",
          "snippet": "virQEMUDriverConfigPtr virQEMUDriverGetConfig(virQEMUDriverPtr driver)\n{\n    virQEMUDriverConfigPtr conf;\n    qemuDriverLock(driver);\n    conf = virObjectRef(driver->config);\n    qemuDriverUnlock(driver);\n    return conf;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virutil.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virsocket.h\"",
            "#include \"virfile.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virlog.h\"",
            "#include \"virxml.h\"",
            "#include \"datatypes.h\"",
            "#include \"viralloc.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_firmware.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvirQEMUDriverConfigPtr virQEMUDriverGetConfig(virQEMUDriverPtr driver)\n{\n    virQEMUDriverConfigPtr conf;\n    qemuDriverLock(driver);\n    conf = virObjectRef(driver->config);\n    qemuDriverUnlock(driver);\n    return conf;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvirDomainCapsPtr\nvirQEMUDriverGetDomainCapabilities(virQEMUDriverPtr driver,\n                                   virQEMUCapsPtr qemuCaps,\n                                   const char *machine,\n                                   virArch arch,\n                                   virDomainVirtType virttype)\n{\n    g_autoptr(virQEMUDriverConfig) cfg = virQEMUDriverGetConfig(driver);\n\n    return virQEMUCapsGetDomainCapsCache(qemuCaps,\n                                         machine,\n                                         arch,\n                                         virttype,\n                                         driver->hostarch,\n                                         driver->privileged,\n                                         cfg->firmwares,\n                                         cfg->nfirmwares);\n}"
  },
  {
    "function_name": "virQEMUDriverGetCapabilities",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
    "lines": "1350-1377",
    "snippet": "virCapsPtr virQEMUDriverGetCapabilities(virQEMUDriverPtr driver,\n                                        bool refresh)\n{\n    virCapsPtr ret = NULL;\n    if (refresh) {\n        virCapsPtr caps = NULL;\n        if ((caps = virQEMUDriverCreateCapabilities(driver)) == NULL)\n            return NULL;\n\n        qemuDriverLock(driver);\n        virObjectUnref(driver->caps);\n        driver->caps = caps;\n    } else {\n        qemuDriverLock(driver);\n\n        if (driver->caps == NULL ||\n            driver->caps->nguests == 0) {\n            VIR_DEBUG(\"Capabilities didn't detect any guests. Forcing a \"\n                      \"refresh.\");\n            qemuDriverUnlock(driver);\n            return virQEMUDriverGetCapabilities(driver, true);\n        }\n    }\n\n    ret = virObjectRef(driver->caps);\n    qemuDriverUnlock(driver);\n    return ret;\n}",
    "includes": [
      "#include \"configmake.h\"",
      "#include \"virutil.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virstring.h\"",
      "#include \"virsocket.h\"",
      "#include \"virfile.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virlog.h\"",
      "#include \"virxml.h\"",
      "#include \"datatypes.h\"",
      "#include \"viralloc.h\"",
      "#include \"virconf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_firmware.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_capabilities.h\"",
      "#include \"qemu_conf.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "qemuDriverUnlock",
          "args": [
            "driver"
          ],
          "line": 1375
        },
        "resolved": true,
        "details": {
          "function_name": "qemuDriverUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
          "lines": "90-94",
          "snippet": "static void\nqemuDriverUnlock(virQEMUDriverPtr driver)\n{\n    virMutexUnlock(&driver->lock);\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virutil.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virsocket.h\"",
            "#include \"virfile.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virlog.h\"",
            "#include \"virxml.h\"",
            "#include \"datatypes.h\"",
            "#include \"viralloc.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_firmware.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic void\nqemuDriverUnlock(virQEMUDriverPtr driver)\n{\n    virMutexUnlock(&driver->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectRef",
          "args": [
            "driver->caps"
          ],
          "line": 1374
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "377-387",
          "snippet": "void *\nvirObjectRef(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return NULL;\n    g_atomic_int_add(&obj->u.s.refs, 1);\n    PROBE(OBJECT_REF, \"obj=%p\", obj);\n    return anyobj;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid *\nvirObjectRef(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return NULL;\n    g_atomic_int_add(&obj->u.s.refs, 1);\n    PROBE(OBJECT_REF, \"obj=%p\", obj);\n    return anyobj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virQEMUDriverGetCapabilities",
          "args": [
            "driver",
            "true"
          ],
          "line": 1370
        },
        "resolved": true,
        "details": {
          "function_name": "virQEMUDriverGetCapabilities",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
          "lines": "1350-1377",
          "snippet": "virCapsPtr virQEMUDriverGetCapabilities(virQEMUDriverPtr driver,\n                                        bool refresh)\n{\n    virCapsPtr ret = NULL;\n    if (refresh) {\n        virCapsPtr caps = NULL;\n        if ((caps = virQEMUDriverCreateCapabilities(driver)) == NULL)\n            return NULL;\n\n        qemuDriverLock(driver);\n        virObjectUnref(driver->caps);\n        driver->caps = caps;\n    } else {\n        qemuDriverLock(driver);\n\n        if (driver->caps == NULL ||\n            driver->caps->nguests == 0) {\n            VIR_DEBUG(\"Capabilities didn't detect any guests. Forcing a \"\n                      \"refresh.\");\n            qemuDriverUnlock(driver);\n            return virQEMUDriverGetCapabilities(driver, true);\n        }\n    }\n\n    ret = virObjectRef(driver->caps);\n    qemuDriverUnlock(driver);\n    return ret;\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Capabilities didn't detect any guests. Forcing a \"\n                      \"refresh.\""
          ],
          "line": 1367
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qemuDriverLock",
          "args": [
            "driver"
          ],
          "line": 1363
        },
        "resolved": true,
        "details": {
          "function_name": "qemuDriverLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
          "lines": "85-89",
          "snippet": "static void\nqemuDriverLock(virQEMUDriverPtr driver)\n{\n    virMutexLock(&driver->lock);\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virutil.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virsocket.h\"",
            "#include \"virfile.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virlog.h\"",
            "#include \"virxml.h\"",
            "#include \"datatypes.h\"",
            "#include \"viralloc.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_firmware.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic void\nqemuDriverLock(virQEMUDriverPtr driver)\n{\n    virMutexLock(&driver->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectUnref",
          "args": [
            "driver->caps"
          ],
          "line": 1360
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectUnref",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "338-365",
          "snippet": "bool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nbool\nvirObjectUnref(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return false;\n\n    bool lastRef = !!g_atomic_int_dec_and_test(&obj->u.s.refs);\n    PROBE(OBJECT_UNREF, \"obj=%p\", obj);\n    if (lastRef) {\n        PROBE(OBJECT_DISPOSE, \"obj=%p\", obj);\n        virClassPtr klass = obj->klass;\n        while (klass) {\n            if (klass->dispose)\n                klass->dispose(obj);\n            klass = klass->parent;\n        }\n\n        /* Clear & poison object */\n        memset(obj, 0, obj->klass->objectSize);\n        obj->u.s.magic = 0xDEADBEEF;\n        obj->klass = (void*)0xDEADBEEF;\n        VIR_FREE(obj);\n    }\n\n    return !lastRef;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virQEMUDriverCreateCapabilities",
          "args": [
            "driver"
          ],
          "line": 1356
        },
        "resolved": true,
        "details": {
          "function_name": "virQEMUDriverCreateCapabilities",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
          "lines": "1282-1336",
          "snippet": "virCapsPtr virQEMUDriverCreateCapabilities(virQEMUDriverPtr driver)\n{\n    size_t i, j;\n    g_autoptr(virCaps) caps = NULL;\n    g_autofree virSecurityManagerPtr *sec_managers = NULL;\n    /* Security driver data */\n    const char *doi, *model, *lbl, *type;\n    const int virtTypes[] = {VIR_DOMAIN_VIRT_KVM,\n                             VIR_DOMAIN_VIRT_QEMU,};\n\n    /* Basic host arch / guest machine capabilities */\n    if (!(caps = virQEMUCapsInit(driver->qemuCapsCache)))\n        return NULL;\n\n    if (virGetHostUUID(caps->host.host_uuid)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"cannot get the host uuid\"));\n        return NULL;\n    }\n\n    /* access sec drivers and create a sec model for each one */\n    if (!(sec_managers = qemuSecurityGetNested(driver->securityManager)))\n        return NULL;\n\n    /* calculate length */\n    for (i = 0; sec_managers[i]; i++)\n        ;\n    caps->host.nsecModels = i;\n\n    if (VIR_ALLOC_N(caps->host.secModels, caps->host.nsecModels) < 0)\n        return NULL;\n\n    for (i = 0; sec_managers[i]; i++) {\n        virCapsHostSecModelPtr sm = &caps->host.secModels[i];\n        doi = qemuSecurityGetDOI(sec_managers[i]);\n        model = qemuSecurityGetModel(sec_managers[i]);\n        sm->model = g_strdup(model);\n        sm->doi = g_strdup(doi);\n\n        for (j = 0; j < G_N_ELEMENTS(virtTypes); j++) {\n            lbl = qemuSecurityGetBaseLabel(sec_managers[i], virtTypes[j]);\n            type = virDomainVirtTypeToString(virtTypes[j]);\n            if (lbl &&\n                virCapabilitiesHostSecModelAddBaseLabel(sm, type, lbl) < 0)\n                return NULL;\n        }\n\n        VIR_DEBUG(\"Initialized caps for security driver \\\"%s\\\" with \"\n                  \"DOI \\\"%s\\\"\", model, doi);\n    }\n\n    caps->host.numa = virQEMUDriverGetHostNUMACaps(driver);\n    caps->host.cpu = virQEMUDriverGetHostCPU(driver);\n    return g_steal_pointer(&caps);\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virutil.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virsocket.h\"",
            "#include \"virfile.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virlog.h\"",
            "#include \"virxml.h\"",
            "#include \"datatypes.h\"",
            "#include \"viralloc.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_firmware.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvirCapsPtr virQEMUDriverCreateCapabilities(virQEMUDriverPtr driver)\n{\n    size_t i, j;\n    g_autoptr(virCaps) caps = NULL;\n    g_autofree virSecurityManagerPtr *sec_managers = NULL;\n    /* Security driver data */\n    const char *doi, *model, *lbl, *type;\n    const int virtTypes[] = {VIR_DOMAIN_VIRT_KVM,\n                             VIR_DOMAIN_VIRT_QEMU,};\n\n    /* Basic host arch / guest machine capabilities */\n    if (!(caps = virQEMUCapsInit(driver->qemuCapsCache)))\n        return NULL;\n\n    if (virGetHostUUID(caps->host.host_uuid)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"cannot get the host uuid\"));\n        return NULL;\n    }\n\n    /* access sec drivers and create a sec model for each one */\n    if (!(sec_managers = qemuSecurityGetNested(driver->securityManager)))\n        return NULL;\n\n    /* calculate length */\n    for (i = 0; sec_managers[i]; i++)\n        ;\n    caps->host.nsecModels = i;\n\n    if (VIR_ALLOC_N(caps->host.secModels, caps->host.nsecModels) < 0)\n        return NULL;\n\n    for (i = 0; sec_managers[i]; i++) {\n        virCapsHostSecModelPtr sm = &caps->host.secModels[i];\n        doi = qemuSecurityGetDOI(sec_managers[i]);\n        model = qemuSecurityGetModel(sec_managers[i]);\n        sm->model = g_strdup(model);\n        sm->doi = g_strdup(doi);\n\n        for (j = 0; j < G_N_ELEMENTS(virtTypes); j++) {\n            lbl = qemuSecurityGetBaseLabel(sec_managers[i], virtTypes[j]);\n            type = virDomainVirtTypeToString(virtTypes[j]);\n            if (lbl &&\n                virCapabilitiesHostSecModelAddBaseLabel(sm, type, lbl) < 0)\n                return NULL;\n        }\n\n        VIR_DEBUG(\"Initialized caps for security driver \\\"%s\\\" with \"\n                  \"DOI \\\"%s\\\"\", model, doi);\n    }\n\n    caps->host.numa = virQEMUDriverGetHostNUMACaps(driver);\n    caps->host.cpu = virQEMUDriverGetHostCPU(driver);\n    return g_steal_pointer(&caps);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvirCapsPtr virQEMUDriverGetCapabilities(virQEMUDriverPtr driver,\n                                        bool refresh)\n{\n    virCapsPtr ret = NULL;\n    if (refresh) {\n        virCapsPtr caps = NULL;\n        if ((caps = virQEMUDriverCreateCapabilities(driver)) == NULL)\n            return NULL;\n\n        qemuDriverLock(driver);\n        virObjectUnref(driver->caps);\n        driver->caps = caps;\n    } else {\n        qemuDriverLock(driver);\n\n        if (driver->caps == NULL ||\n            driver->caps->nguests == 0) {\n            VIR_DEBUG(\"Capabilities didn't detect any guests. Forcing a \"\n                      \"refresh.\");\n            qemuDriverUnlock(driver);\n            return virQEMUDriverGetCapabilities(driver, true);\n        }\n    }\n\n    ret = virObjectRef(driver->caps);\n    qemuDriverUnlock(driver);\n    return ret;\n}"
  },
  {
    "function_name": "virQEMUDriverCreateCapabilities",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
    "lines": "1282-1336",
    "snippet": "virCapsPtr virQEMUDriverCreateCapabilities(virQEMUDriverPtr driver)\n{\n    size_t i, j;\n    g_autoptr(virCaps) caps = NULL;\n    g_autofree virSecurityManagerPtr *sec_managers = NULL;\n    /* Security driver data */\n    const char *doi, *model, *lbl, *type;\n    const int virtTypes[] = {VIR_DOMAIN_VIRT_KVM,\n                             VIR_DOMAIN_VIRT_QEMU,};\n\n    /* Basic host arch / guest machine capabilities */\n    if (!(caps = virQEMUCapsInit(driver->qemuCapsCache)))\n        return NULL;\n\n    if (virGetHostUUID(caps->host.host_uuid)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"cannot get the host uuid\"));\n        return NULL;\n    }\n\n    /* access sec drivers and create a sec model for each one */\n    if (!(sec_managers = qemuSecurityGetNested(driver->securityManager)))\n        return NULL;\n\n    /* calculate length */\n    for (i = 0; sec_managers[i]; i++)\n        ;\n    caps->host.nsecModels = i;\n\n    if (VIR_ALLOC_N(caps->host.secModels, caps->host.nsecModels) < 0)\n        return NULL;\n\n    for (i = 0; sec_managers[i]; i++) {\n        virCapsHostSecModelPtr sm = &caps->host.secModels[i];\n        doi = qemuSecurityGetDOI(sec_managers[i]);\n        model = qemuSecurityGetModel(sec_managers[i]);\n        sm->model = g_strdup(model);\n        sm->doi = g_strdup(doi);\n\n        for (j = 0; j < G_N_ELEMENTS(virtTypes); j++) {\n            lbl = qemuSecurityGetBaseLabel(sec_managers[i], virtTypes[j]);\n            type = virDomainVirtTypeToString(virtTypes[j]);\n            if (lbl &&\n                virCapabilitiesHostSecModelAddBaseLabel(sm, type, lbl) < 0)\n                return NULL;\n        }\n\n        VIR_DEBUG(\"Initialized caps for security driver \\\"%s\\\" with \"\n                  \"DOI \\\"%s\\\"\", model, doi);\n    }\n\n    caps->host.numa = virQEMUDriverGetHostNUMACaps(driver);\n    caps->host.cpu = virQEMUDriverGetHostCPU(driver);\n    return g_steal_pointer(&caps);\n}",
    "includes": [
      "#include \"configmake.h\"",
      "#include \"virutil.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virstring.h\"",
      "#include \"virsocket.h\"",
      "#include \"virfile.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virlog.h\"",
      "#include \"virxml.h\"",
      "#include \"datatypes.h\"",
      "#include \"viralloc.h\"",
      "#include \"virconf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_firmware.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_capabilities.h\"",
      "#include \"qemu_conf.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_steal_pointer",
          "args": [
            "&caps"
          ],
          "line": 1335
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virQEMUDriverGetHostCPU",
          "args": [
            "driver"
          ],
          "line": 1334
        },
        "resolved": true,
        "details": {
          "function_name": "virQEMUDriverGetHostCPU",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
          "lines": "1261-1279",
          "snippet": "virCPUDefPtr\nvirQEMUDriverGetHostCPU(virQEMUDriverPtr driver)\n{\n    virCPUDefPtr hostcpu;\n\n    qemuDriverLock(driver);\n\n    if (!driver->hostcpu)\n        driver->hostcpu = virCPUProbeHost(virArchFromHost());\n\n    hostcpu = driver->hostcpu;\n\n    qemuDriverUnlock(driver);\n\n    if (hostcpu)\n        virCPUDefRef(hostcpu);\n\n    return hostcpu;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virutil.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virsocket.h\"",
            "#include \"virfile.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virlog.h\"",
            "#include \"virxml.h\"",
            "#include \"datatypes.h\"",
            "#include \"viralloc.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_firmware.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvirCPUDefPtr\nvirQEMUDriverGetHostCPU(virQEMUDriverPtr driver)\n{\n    virCPUDefPtr hostcpu;\n\n    qemuDriverLock(driver);\n\n    if (!driver->hostcpu)\n        driver->hostcpu = virCPUProbeHost(virArchFromHost());\n\n    hostcpu = driver->hostcpu;\n\n    qemuDriverUnlock(driver);\n\n    if (hostcpu)\n        virCPUDefRef(hostcpu);\n\n    return hostcpu;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virQEMUDriverGetHostNUMACaps",
          "args": [
            "driver"
          ],
          "line": 1333
        },
        "resolved": true,
        "details": {
          "function_name": "virQEMUDriverGetHostNUMACaps",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
          "lines": "1240-1258",
          "snippet": "virCapsHostNUMAPtr\nvirQEMUDriverGetHostNUMACaps(virQEMUDriverPtr driver)\n{\n    virCapsHostNUMAPtr hostnuma;\n\n    qemuDriverLock(driver);\n\n    if (!driver->hostnuma)\n        driver->hostnuma = virCapabilitiesHostNUMANewHost();\n\n    hostnuma = driver->hostnuma;\n\n    qemuDriverUnlock(driver);\n\n    if (hostnuma)\n        virCapabilitiesHostNUMARef(hostnuma);\n\n    return hostnuma;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virutil.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virsocket.h\"",
            "#include \"virfile.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virlog.h\"",
            "#include \"virxml.h\"",
            "#include \"datatypes.h\"",
            "#include \"viralloc.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_firmware.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvirCapsHostNUMAPtr\nvirQEMUDriverGetHostNUMACaps(virQEMUDriverPtr driver)\n{\n    virCapsHostNUMAPtr hostnuma;\n\n    qemuDriverLock(driver);\n\n    if (!driver->hostnuma)\n        driver->hostnuma = virCapabilitiesHostNUMANewHost();\n\n    hostnuma = driver->hostnuma;\n\n    qemuDriverUnlock(driver);\n\n    if (hostnuma)\n        virCapabilitiesHostNUMARef(hostnuma);\n\n    return hostnuma;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_DEBUG",
          "args": [
            "\"Initialized caps for security driver \\\"%s\\\" with \"\n                  \"DOI \\\"%s\\\"\"",
            "model",
            "doi"
          ],
          "line": 1329
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCapabilitiesHostSecModelAddBaseLabel",
          "args": [
            "sm",
            "type",
            "lbl"
          ],
          "line": 1325
        },
        "resolved": true,
        "details": {
          "function_name": "virCapabilitiesHostSecModelAddBaseLabel",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/capabilities.c",
          "lines": "596-611",
          "snippet": "extern int\nvirCapabilitiesHostSecModelAddBaseLabel(virCapsHostSecModelPtr secmodel,\n                                        const char *type,\n                                        const char *label)\n{\n    if (type == NULL || label == NULL)\n        return -1;\n\n    if (VIR_EXPAND_N(secmodel->labels, secmodel->nlabels, 1) < 0)\n        return -1;\n\n    secmodel->labels[secmodel->nlabels - 1].type = g_strdup(type);\n    secmodel->labels[secmodel->nlabels - 1].label = g_strdup(label);\n\n    return 0;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virenum.h\"",
            "#include \"viruuid.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virstring.h\"",
            "#include \"virnuma.h\"",
            "#include \"virlog.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virarch.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"capabilities.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virenum.h\"\n#include \"viruuid.h\"\n#include \"virtypedparam.h\"\n#include \"virstring.h\"\n#include \"virnuma.h\"\n#include \"virlog.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"virarch.h\"\n#include \"viralloc.h\"\n#include \"storage_conf.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"capabilities.h\"\n#include <unistd.h>\n#include <config.h>\n\nextern int\nvirCapabilitiesHostSecModelAddBaseLabel(virCapsHostSecModelPtr secmodel,\n                                        const char *type,\n                                        const char *label)\n{\n    if (type == NULL || label == NULL)\n        return -1;\n\n    if (VIR_EXPAND_N(secmodel->labels, secmodel->nlabels, 1) < 0)\n        return -1;\n\n    secmodel->labels[secmodel->nlabels - 1].type = g_strdup(type);\n    secmodel->labels[secmodel->nlabels - 1].label = g_strdup(label);\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainVirtTypeToString",
          "args": [
            "virtTypes[j]"
          ],
          "line": 1323
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qemuSecurityGetBaseLabel",
          "args": [
            "sec_managers[i]",
            "virtTypes[j]"
          ],
          "line": 1322
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "G_N_ELEMENTS",
          "args": [
            "virtTypes"
          ],
          "line": 1321
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "doi"
          ],
          "line": 1319
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuSecurityGetModel",
          "args": [
            "sec_managers[i]"
          ],
          "line": 1317
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qemuSecurityGetDOI",
          "args": [
            "sec_managers[i]"
          ],
          "line": 1316
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC_N",
          "args": [
            "caps->host.secModels",
            "caps->host.nsecModels"
          ],
          "line": 1311
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qemuSecurityGetNested",
          "args": [
            "driver->securityManager"
          ],
          "line": 1303
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "\"%s\"",
            "_(\"cannot get the host uuid\")"
          ],
          "line": 1297
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"cannot get the host uuid\""
          ],
          "line": 1298
        },
        "resolved": true,
        "details": {
          "function_name": "bswap_header",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_driver.c",
          "lines": "2852-2860",
          "snippet": "static inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virenum.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virqemu.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virnuma.h\"",
            "#include \"virperf.h\"",
            "#include \"vircgroup.h\"",
            "#include \"domain_capabilities.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapicheckqemu.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virkeycode.h\"",
            "#include \"locking/domain_lock.h\"",
            "#include \"locking/lock_manager.h\"",
            "#include \"virthreadpool.h\"",
            "#include \"configmake.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virhook.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virxml.h\"",
            "#include \"libvirt_internal.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virusb.h\"",
            "#include \"virpci.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"domain_conf.h\"",
            "#include \"viruuid.h\"",
            "#include \"virarptable.h\"",
            "#include \"viralloc.h\"",
            "#include \"capabilities.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virbuffer.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"qemu_backup.h\"",
            "#include \"qemu_checkpoint.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_blockjob.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_monitor.h\"",
            "#include \"qemu_hotplug.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"qemu_block.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_agent.h\"",
            "#include \"qemu_driver.h\"",
            "#include <sys/ioctl.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <dirent.h>",
            "#include <sys/time.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virenum.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virqemu.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virnuma.h\"\n#include \"virperf.h\"\n#include \"vircgroup.h\"\n#include \"domain_capabilities.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapicheckqemu.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virbitmap.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virnodesuspend.h\"\n#include \"virkeycode.h\"\n#include \"locking/domain_lock.h\"\n#include \"locking/lock_manager.h\"\n#include \"virthreadpool.h\"\n#include \"configmake.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"virhook.h\"\n#include \"domain_nwfilter.h\"\n#include \"virsysinfo.h\"\n#include \"cpu/cpu.h\"\n#include \"virxml.h\"\n#include \"libvirt_internal.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virusb.h\"\n#include \"virpci.h\"\n#include \"node_device_conf.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"domain_conf.h\"\n#include \"viruuid.h\"\n#include \"virarptable.h\"\n#include \"viralloc.h\"\n#include \"capabilities.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevtap.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"qemu_backup.h\"\n#include \"qemu_checkpoint.h\"\n#include \"qemu_security.h\"\n#include \"qemu_blockjob.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_process.h\"\n#include \"qemu_monitor.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_cgroup.h\"\n#include \"qemu_command.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"qemu_block.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_agent.h\"\n#include \"qemu_driver.h\"\n#include <sys/ioctl.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <dirent.h>\n#include <sys/time.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virGetHostUUID",
          "args": [
            "caps->host.host_uuid"
          ],
          "line": 1296
        },
        "resolved": true,
        "details": {
          "function_name": "virGetHostUUID",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/viruuid.c",
          "lines": "258-268",
          "snippet": "int virGetHostUUID(unsigned char *uuid)\n{\n    int ret = 0;\n\n    if (!virUUIDIsValid(host_uuid))\n        ret = virSetHostUUIDStr(NULL);\n\n    memcpy(uuid, host_uuid, sizeof(host_uuid));\n\n    return ret;\n}",
          "includes": [
            "#include \"virrandom.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <fcntl.h>",
            "#include \"viruuid.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static unsigned char host_uuid[VIR_UUID_BUFLEN];"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virrandom.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include <unistd.h>\n#include <time.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <fcntl.h>\n#include \"viruuid.h\"\n#include <config.h>\n\nstatic unsigned char host_uuid[VIR_UUID_BUFLEN];\n\nint virGetHostUUID(unsigned char *uuid)\n{\n    int ret = 0;\n\n    if (!virUUIDIsValid(host_uuid))\n        ret = virSetHostUUIDStr(NULL);\n\n    memcpy(uuid, host_uuid, sizeof(host_uuid));\n\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virQEMUCapsInit",
          "args": [
            "driver->qemuCapsCache"
          ],
          "line": 1293
        },
        "resolved": true,
        "details": {
          "function_name": "virQEMUCapsInitProcessCaps",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_capabilities.c",
          "lines": "4866-4910",
          "snippet": "static void\nvirQEMUCapsInitProcessCaps(virQEMUCapsPtr qemuCaps)\n{\n    /* 'intel-iommu' shows up as a device since 2.2.0, but can\n     * not be used with -device until 2.7.0. Before that it\n     * requires -machine iommu=on. So we must clear the device\n     * capability we detected on older QEMUs\n     */\n    if (qemuCaps->version < 2007000 &&\n        virQEMUCapsGet(qemuCaps, QEMU_CAPS_DEVICE_INTEL_IOMMU)) {\n        virQEMUCapsClear(qemuCaps, QEMU_CAPS_DEVICE_INTEL_IOMMU);\n        virQEMUCapsSet(qemuCaps, QEMU_CAPS_MACHINE_IOMMU);\n    }\n\n    /* Prealloc on NVDIMMs is broken on older QEMUs leading to\n     * user data corruption. If we are dealing with such version\n     * of QEMU pretend we don't know how to NVDIMM. */\n    if (qemuCaps->version < 2009000)\n        virQEMUCapsClear(qemuCaps, QEMU_CAPS_DEVICE_NVDIMM);\n\n    if (ARCH_IS_X86(qemuCaps->arch) &&\n        virQEMUCapsGet(qemuCaps, QEMU_CAPS_QUERY_CPU_MODEL_EXPANSION))\n        virQEMUCapsSet(qemuCaps, QEMU_CAPS_CPU_CACHE);\n\n    if (ARCH_IS_S390(qemuCaps->arch)) {\n        /* Legacy assurance for QEMU_CAPS_CCW */\n        if (!virQEMUCapsGet(qemuCaps, QEMU_CAPS_CCW) &&\n            virQEMUCapsGet(qemuCaps, QEMU_CAPS_VIRTIO_CCW))\n            virQEMUCapsSet(qemuCaps, QEMU_CAPS_CCW);\n        if (!virQEMUCapsGet(qemuCaps, QEMU_CAPS_CCW_CSSID_UNRESTRICTED))\n            virQEMUCapsClear(qemuCaps, QEMU_CAPS_DEVICE_VFIO_CCW);\n    }\n\n    if (virQEMUCapsGet(qemuCaps, QEMU_CAPS_CPU_UNAVAILABLE_FEATURES))\n        virQEMUCapsSet(qemuCaps, QEMU_CAPS_CANONICAL_CPU_FEATURES);\n\n    /* To avoid guest ABI regression, blockdev shall be enabled only when\n     * we are able to pass the custom 'device_id' for SCSI disks and cdroms. */\n    if (virQEMUCapsGet(qemuCaps, QEMU_CAPS_BLOCK_FILE_AUTO_READONLY_DYNAMIC) &&\n        virQEMUCapsGet(qemuCaps, QEMU_CAPS_SCSI_DISK_DEVICE_ID) &&\n        virQEMUCapsGet(qemuCaps, QEMU_CAPS_SAVEVM_MONITOR_NODES))\n        virQEMUCapsSet(qemuCaps, QEMU_CAPS_BLOCKDEV);\n\n    virQEMUCapsInitProcessCapsInterlock(qemuCaps);\n}",
          "includes": [
            "#include <sys/utsname.h>",
            "#include <stdarg.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include \"virutil.h\"",
            "#include \"qemu_firmware.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_qapi.h\"",
            "#include \"qemu_capspriv.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"virstring.h\"",
            "#include \"qemu_monitor.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virnuma.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virbitmap.h\"",
            "#include \"vircommand.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu/cpu_x86.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virfilecache.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"vircrypto.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/utsname.h>\n#include <stdarg.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include \"virutil.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_process.h\"\n#include \"qemu_qapi.h\"\n#include \"qemu_capspriv.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_hostdev.h\"\n#include \"virstring.h\"\n#include \"qemu_monitor.h\"\n#include \"virhostcpu.h\"\n#include \"virnuma.h\"\n#include \"virnodesuspend.h\"\n#include \"virbitmap.h\"\n#include \"vircommand.h\"\n#include \"domain_conf.h\"\n#include \"cpu/cpu_x86.h\"\n#include \"cpu/cpu.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virfilecache.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"vircrypto.h\"\n#include \"viralloc.h\"\n#include \"qemu_capabilities.h\"\n#include <config.h>\n\nstatic void\nvirQEMUCapsInitProcessCaps(virQEMUCapsPtr qemuCaps)\n{\n    /* 'intel-iommu' shows up as a device since 2.2.0, but can\n     * not be used with -device until 2.7.0. Before that it\n     * requires -machine iommu=on. So we must clear the device\n     * capability we detected on older QEMUs\n     */\n    if (qemuCaps->version < 2007000 &&\n        virQEMUCapsGet(qemuCaps, QEMU_CAPS_DEVICE_INTEL_IOMMU)) {\n        virQEMUCapsClear(qemuCaps, QEMU_CAPS_DEVICE_INTEL_IOMMU);\n        virQEMUCapsSet(qemuCaps, QEMU_CAPS_MACHINE_IOMMU);\n    }\n\n    /* Prealloc on NVDIMMs is broken on older QEMUs leading to\n     * user data corruption. If we are dealing with such version\n     * of QEMU pretend we don't know how to NVDIMM. */\n    if (qemuCaps->version < 2009000)\n        virQEMUCapsClear(qemuCaps, QEMU_CAPS_DEVICE_NVDIMM);\n\n    if (ARCH_IS_X86(qemuCaps->arch) &&\n        virQEMUCapsGet(qemuCaps, QEMU_CAPS_QUERY_CPU_MODEL_EXPANSION))\n        virQEMUCapsSet(qemuCaps, QEMU_CAPS_CPU_CACHE);\n\n    if (ARCH_IS_S390(qemuCaps->arch)) {\n        /* Legacy assurance for QEMU_CAPS_CCW */\n        if (!virQEMUCapsGet(qemuCaps, QEMU_CAPS_CCW) &&\n            virQEMUCapsGet(qemuCaps, QEMU_CAPS_VIRTIO_CCW))\n            virQEMUCapsSet(qemuCaps, QEMU_CAPS_CCW);\n        if (!virQEMUCapsGet(qemuCaps, QEMU_CAPS_CCW_CSSID_UNRESTRICTED))\n            virQEMUCapsClear(qemuCaps, QEMU_CAPS_DEVICE_VFIO_CCW);\n    }\n\n    if (virQEMUCapsGet(qemuCaps, QEMU_CAPS_CPU_UNAVAILABLE_FEATURES))\n        virQEMUCapsSet(qemuCaps, QEMU_CAPS_CANONICAL_CPU_FEATURES);\n\n    /* To avoid guest ABI regression, blockdev shall be enabled only when\n     * we are able to pass the custom 'device_id' for SCSI disks and cdroms. */\n    if (virQEMUCapsGet(qemuCaps, QEMU_CAPS_BLOCK_FILE_AUTO_READONLY_DYNAMIC) &&\n        virQEMUCapsGet(qemuCaps, QEMU_CAPS_SCSI_DISK_DEVICE_ID) &&\n        virQEMUCapsGet(qemuCaps, QEMU_CAPS_SAVEVM_MONITOR_NODES))\n        virQEMUCapsSet(qemuCaps, QEMU_CAPS_BLOCKDEV);\n\n    virQEMUCapsInitProcessCapsInterlock(qemuCaps);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvirCapsPtr virQEMUDriverCreateCapabilities(virQEMUDriverPtr driver)\n{\n    size_t i, j;\n    g_autoptr(virCaps) caps = NULL;\n    g_autofree virSecurityManagerPtr *sec_managers = NULL;\n    /* Security driver data */\n    const char *doi, *model, *lbl, *type;\n    const int virtTypes[] = {VIR_DOMAIN_VIRT_KVM,\n                             VIR_DOMAIN_VIRT_QEMU,};\n\n    /* Basic host arch / guest machine capabilities */\n    if (!(caps = virQEMUCapsInit(driver->qemuCapsCache)))\n        return NULL;\n\n    if (virGetHostUUID(caps->host.host_uuid)) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       \"%s\", _(\"cannot get the host uuid\"));\n        return NULL;\n    }\n\n    /* access sec drivers and create a sec model for each one */\n    if (!(sec_managers = qemuSecurityGetNested(driver->securityManager)))\n        return NULL;\n\n    /* calculate length */\n    for (i = 0; sec_managers[i]; i++)\n        ;\n    caps->host.nsecModels = i;\n\n    if (VIR_ALLOC_N(caps->host.secModels, caps->host.nsecModels) < 0)\n        return NULL;\n\n    for (i = 0; sec_managers[i]; i++) {\n        virCapsHostSecModelPtr sm = &caps->host.secModels[i];\n        doi = qemuSecurityGetDOI(sec_managers[i]);\n        model = qemuSecurityGetModel(sec_managers[i]);\n        sm->model = g_strdup(model);\n        sm->doi = g_strdup(doi);\n\n        for (j = 0; j < G_N_ELEMENTS(virtTypes); j++) {\n            lbl = qemuSecurityGetBaseLabel(sec_managers[i], virtTypes[j]);\n            type = virDomainVirtTypeToString(virtTypes[j]);\n            if (lbl &&\n                virCapabilitiesHostSecModelAddBaseLabel(sm, type, lbl) < 0)\n                return NULL;\n        }\n\n        VIR_DEBUG(\"Initialized caps for security driver \\\"%s\\\" with \"\n                  \"DOI \\\"%s\\\"\", model, doi);\n    }\n\n    caps->host.numa = virQEMUDriverGetHostNUMACaps(driver);\n    caps->host.cpu = virQEMUDriverGetHostCPU(driver);\n    return g_steal_pointer(&caps);\n}"
  },
  {
    "function_name": "virQEMUDriverGetHostCPU",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
    "lines": "1261-1279",
    "snippet": "virCPUDefPtr\nvirQEMUDriverGetHostCPU(virQEMUDriverPtr driver)\n{\n    virCPUDefPtr hostcpu;\n\n    qemuDriverLock(driver);\n\n    if (!driver->hostcpu)\n        driver->hostcpu = virCPUProbeHost(virArchFromHost());\n\n    hostcpu = driver->hostcpu;\n\n    qemuDriverUnlock(driver);\n\n    if (hostcpu)\n        virCPUDefRef(hostcpu);\n\n    return hostcpu;\n}",
    "includes": [
      "#include \"configmake.h\"",
      "#include \"virutil.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virstring.h\"",
      "#include \"virsocket.h\"",
      "#include \"virfile.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virlog.h\"",
      "#include \"virxml.h\"",
      "#include \"datatypes.h\"",
      "#include \"viralloc.h\"",
      "#include \"virconf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_firmware.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_capabilities.h\"",
      "#include \"qemu_conf.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCPUDefRef",
          "args": [
            "hostcpu"
          ],
          "line": 1276
        },
        "resolved": true,
        "details": {
          "function_name": "virCPUDefRef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/cpu_conf.c",
          "lines": "114-118",
          "snippet": "void\nvirCPUDefRef(virCPUDefPtr def)\n{\n    g_atomic_int_inc(&def->refs);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virstring.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virerror.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virstring.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virerror.h\"\n#include <config.h>\n\nvoid\nvirCPUDefRef(virCPUDefPtr def)\n{\n    g_atomic_int_inc(&def->refs);\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuDriverUnlock",
          "args": [
            "driver"
          ],
          "line": 1273
        },
        "resolved": true,
        "details": {
          "function_name": "qemuDriverUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
          "lines": "90-94",
          "snippet": "static void\nqemuDriverUnlock(virQEMUDriverPtr driver)\n{\n    virMutexUnlock(&driver->lock);\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virutil.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virsocket.h\"",
            "#include \"virfile.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virlog.h\"",
            "#include \"virxml.h\"",
            "#include \"datatypes.h\"",
            "#include \"viralloc.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_firmware.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic void\nqemuDriverUnlock(virQEMUDriverPtr driver)\n{\n    virMutexUnlock(&driver->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCPUProbeHost",
          "args": [
            "virArchFromHost()"
          ],
          "line": 1269
        },
        "resolved": true,
        "details": {
          "function_name": "virCPUProbeHost",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/cpu/cpu.c",
          "lines": "454-463",
          "snippet": "virCPUDefPtr\nvirCPUProbeHost(virArch arch)\n{\n    virNodeInfo nodeinfo;\n\n    if (virCapabilitiesGetNodeInfo(&nodeinfo) < 0)\n        return NULL;\n\n    return virCPUGetHost(arch, VIR_CPU_TYPE_HOST, &nodeinfo, NULL);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"capabilities.h\"",
            "#include \"cpu_arm.h\"",
            "#include \"cpu_s390.h\"",
            "#include \"cpu_ppc64.h\"",
            "#include \"cpu_x86.h\"",
            "#include \"cpu_map.h\"",
            "#include \"cpu.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"capabilities.h\"\n#include \"cpu_arm.h\"\n#include \"cpu_s390.h\"\n#include \"cpu_ppc64.h\"\n#include \"cpu_x86.h\"\n#include \"cpu_map.h\"\n#include \"cpu.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include <config.h>\n\nvirCPUDefPtr\nvirCPUProbeHost(virArch arch)\n{\n    virNodeInfo nodeinfo;\n\n    if (virCapabilitiesGetNodeInfo(&nodeinfo) < 0)\n        return NULL;\n\n    return virCPUGetHost(arch, VIR_CPU_TYPE_HOST, &nodeinfo, NULL);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virArchFromHost",
          "args": [],
          "line": 1269
        },
        "resolved": true,
        "details": {
          "function_name": "virArchFromHost",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virarch.c",
          "lines": "206-235",
          "snippet": "virArch virArchFromHost(void)\n{\n    struct utsname ut;\n    virArch arch;\n\n    uname(&ut);\n\n    /* Some special cases we need to handle first\n     * for non-canonical names */\n    if (strlen(ut.machine) == 4 &&\n        ut.machine[0] == 'i' &&\n        ut.machine[2] == '8' &&\n        ut.machine[3] == '6' &&\n        ut.machine[4] == '\\0') {\n        arch = VIR_ARCH_I686;\n    } else if (STREQ(ut.machine, \"amd64\")) {\n        arch = VIR_ARCH_X86_64;\n    } else {\n        /* Otherwise assume the canonical name */\n        if ((arch = virArchFromString(ut.machine)) == VIR_ARCH_NONE) {\n            VIR_WARN(\"Unknown host arch %s, report to libvir-list@redhat.com\",\n                     ut.machine);\n        }\n    }\n\n    VIR_DEBUG(\"Mapped %s to %d (%s)\",\n              ut.machine, arch, virArchToString(arch));\n\n    return arch;\n}",
          "includes": [
            "#include \"virarch.h\"",
            "#include \"virlog.h\"",
            "# include <sys/utsname.h>",
            "# include <windows.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virarch.h\"\n#include \"virlog.h\"\n# include <sys/utsname.h>\n# include <windows.h>\n#include <config.h>\n\nvirArch virArchFromHost(void)\n{\n    struct utsname ut;\n    virArch arch;\n\n    uname(&ut);\n\n    /* Some special cases we need to handle first\n     * for non-canonical names */\n    if (strlen(ut.machine) == 4 &&\n        ut.machine[0] == 'i' &&\n        ut.machine[2] == '8' &&\n        ut.machine[3] == '6' &&\n        ut.machine[4] == '\\0') {\n        arch = VIR_ARCH_I686;\n    } else if (STREQ(ut.machine, \"amd64\")) {\n        arch = VIR_ARCH_X86_64;\n    } else {\n        /* Otherwise assume the canonical name */\n        if ((arch = virArchFromString(ut.machine)) == VIR_ARCH_NONE) {\n            VIR_WARN(\"Unknown host arch %s, report to libvir-list@redhat.com\",\n                     ut.machine);\n        }\n    }\n\n    VIR_DEBUG(\"Mapped %s to %d (%s)\",\n              ut.machine, arch, virArchToString(arch));\n\n    return arch;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuDriverLock",
          "args": [
            "driver"
          ],
          "line": 1266
        },
        "resolved": true,
        "details": {
          "function_name": "qemuDriverLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
          "lines": "85-89",
          "snippet": "static void\nqemuDriverLock(virQEMUDriverPtr driver)\n{\n    virMutexLock(&driver->lock);\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virutil.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virsocket.h\"",
            "#include \"virfile.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virlog.h\"",
            "#include \"virxml.h\"",
            "#include \"datatypes.h\"",
            "#include \"viralloc.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_firmware.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic void\nqemuDriverLock(virQEMUDriverPtr driver)\n{\n    virMutexLock(&driver->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvirCPUDefPtr\nvirQEMUDriverGetHostCPU(virQEMUDriverPtr driver)\n{\n    virCPUDefPtr hostcpu;\n\n    qemuDriverLock(driver);\n\n    if (!driver->hostcpu)\n        driver->hostcpu = virCPUProbeHost(virArchFromHost());\n\n    hostcpu = driver->hostcpu;\n\n    qemuDriverUnlock(driver);\n\n    if (hostcpu)\n        virCPUDefRef(hostcpu);\n\n    return hostcpu;\n}"
  },
  {
    "function_name": "virQEMUDriverGetHostNUMACaps",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
    "lines": "1240-1258",
    "snippet": "virCapsHostNUMAPtr\nvirQEMUDriverGetHostNUMACaps(virQEMUDriverPtr driver)\n{\n    virCapsHostNUMAPtr hostnuma;\n\n    qemuDriverLock(driver);\n\n    if (!driver->hostnuma)\n        driver->hostnuma = virCapabilitiesHostNUMANewHost();\n\n    hostnuma = driver->hostnuma;\n\n    qemuDriverUnlock(driver);\n\n    if (hostnuma)\n        virCapabilitiesHostNUMARef(hostnuma);\n\n    return hostnuma;\n}",
    "includes": [
      "#include \"configmake.h\"",
      "#include \"virutil.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virstring.h\"",
      "#include \"virsocket.h\"",
      "#include \"virfile.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virlog.h\"",
      "#include \"virxml.h\"",
      "#include \"datatypes.h\"",
      "#include \"viralloc.h\"",
      "#include \"virconf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_firmware.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_capabilities.h\"",
      "#include \"qemu_conf.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virCapabilitiesHostNUMARef",
          "args": [
            "hostnuma"
          ],
          "line": 1255
        },
        "resolved": true,
        "details": {
          "function_name": "virCapabilitiesHostNUMARef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/capabilities.c",
          "lines": "197-201",
          "snippet": "void\nvirCapabilitiesHostNUMARef(virCapsHostNUMAPtr caps)\n{\n    g_atomic_int_inc(&caps->refs);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virenum.h\"",
            "#include \"viruuid.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virstring.h\"",
            "#include \"virnuma.h\"",
            "#include \"virlog.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virarch.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"capabilities.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virenum.h\"\n#include \"viruuid.h\"\n#include \"virtypedparam.h\"\n#include \"virstring.h\"\n#include \"virnuma.h\"\n#include \"virlog.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"virarch.h\"\n#include \"viralloc.h\"\n#include \"storage_conf.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"capabilities.h\"\n#include <unistd.h>\n#include <config.h>\n\nvoid\nvirCapabilitiesHostNUMARef(virCapsHostNUMAPtr caps)\n{\n    g_atomic_int_inc(&caps->refs);\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuDriverUnlock",
          "args": [
            "driver"
          ],
          "line": 1252
        },
        "resolved": true,
        "details": {
          "function_name": "qemuDriverUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
          "lines": "90-94",
          "snippet": "static void\nqemuDriverUnlock(virQEMUDriverPtr driver)\n{\n    virMutexUnlock(&driver->lock);\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virutil.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virsocket.h\"",
            "#include \"virfile.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virlog.h\"",
            "#include \"virxml.h\"",
            "#include \"datatypes.h\"",
            "#include \"viralloc.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_firmware.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic void\nqemuDriverUnlock(virQEMUDriverPtr driver)\n{\n    virMutexUnlock(&driver->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virCapabilitiesHostNUMANewHost",
          "args": [],
          "line": 1248
        },
        "resolved": true,
        "details": {
          "function_name": "virCapabilitiesHostNUMANewHost",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/capabilities.c",
          "lines": "1714-1734",
          "snippet": "virCapsHostNUMAPtr\nvirCapabilitiesHostNUMANewHost(void)\n{\n    virCapsHostNUMAPtr caps = virCapabilitiesHostNUMANew();\n\n    if (virNumaIsAvailable()) {\n        if (virCapabilitiesHostNUMAInitReal(caps) == 0)\n            return caps;\n\n        virCapabilitiesHostNUMAUnref(caps);\n        caps = virCapabilitiesHostNUMANew();\n        VIR_WARN(\"Failed to query host NUMA topology, faking single NUMA node\");\n    }\n\n    if (virCapabilitiesHostNUMAInitFake(caps) < 0) {\n        virCapabilitiesHostNUMAUnref(caps);\n        return NULL;\n    }\n\n    return caps;\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virenum.h\"",
            "#include \"viruuid.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virstring.h\"",
            "#include \"virnuma.h\"",
            "#include \"virlog.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virarch.h\"",
            "#include \"viralloc.h\"",
            "#include \"storage_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"cpu_conf.h\"",
            "#include \"capabilities.h\"",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virenum.h\"\n#include \"viruuid.h\"\n#include \"virtypedparam.h\"\n#include \"virstring.h\"\n#include \"virnuma.h\"\n#include \"virlog.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"virarch.h\"\n#include \"viralloc.h\"\n#include \"storage_conf.h\"\n#include \"domain_conf.h\"\n#include \"cpu_conf.h\"\n#include \"capabilities.h\"\n#include <unistd.h>\n#include <config.h>\n\nvirCapsHostNUMAPtr\nvirCapabilitiesHostNUMANewHost(void)\n{\n    virCapsHostNUMAPtr caps = virCapabilitiesHostNUMANew();\n\n    if (virNumaIsAvailable()) {\n        if (virCapabilitiesHostNUMAInitReal(caps) == 0)\n            return caps;\n\n        virCapabilitiesHostNUMAUnref(caps);\n        caps = virCapabilitiesHostNUMANew();\n        VIR_WARN(\"Failed to query host NUMA topology, faking single NUMA node\");\n    }\n\n    if (virCapabilitiesHostNUMAInitFake(caps) < 0) {\n        virCapabilitiesHostNUMAUnref(caps);\n        return NULL;\n    }\n\n    return caps;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuDriverLock",
          "args": [
            "driver"
          ],
          "line": 1245
        },
        "resolved": true,
        "details": {
          "function_name": "qemuDriverLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
          "lines": "85-89",
          "snippet": "static void\nqemuDriverLock(virQEMUDriverPtr driver)\n{\n    virMutexLock(&driver->lock);\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virutil.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virsocket.h\"",
            "#include \"virfile.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virlog.h\"",
            "#include \"virxml.h\"",
            "#include \"datatypes.h\"",
            "#include \"viralloc.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_firmware.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic void\nqemuDriverLock(virQEMUDriverPtr driver)\n{\n    virMutexLock(&driver->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvirCapsHostNUMAPtr\nvirQEMUDriverGetHostNUMACaps(virQEMUDriverPtr driver)\n{\n    virCapsHostNUMAPtr hostnuma;\n\n    qemuDriverLock(driver);\n\n    if (!driver->hostnuma)\n        driver->hostnuma = virCapabilitiesHostNUMANewHost();\n\n    hostnuma = driver->hostnuma;\n\n    qemuDriverUnlock(driver);\n\n    if (hostnuma)\n        virCapabilitiesHostNUMARef(hostnuma);\n\n    return hostnuma;\n}"
  },
  {
    "function_name": "virQEMUDriverCreateXMLConf",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
    "lines": "1226-1237",
    "snippet": "virDomainXMLOptionPtr\nvirQEMUDriverCreateXMLConf(virQEMUDriverPtr driver,\n                           const char *defsecmodel)\n{\n    virQEMUDriverDomainDefParserConfig.priv = driver;\n    virQEMUDriverDomainDefParserConfig.defSecModel = defsecmodel;\n    return virDomainXMLOptionNew(&virQEMUDriverDomainDefParserConfig,\n                                 &virQEMUDriverPrivateDataCallbacks,\n                                 &virQEMUDriverDomainXMLNamespace,\n                                 &virQEMUDriverDomainABIStability,\n                                 &virQEMUDriverDomainSaveCookie);\n}",
    "includes": [
      "#include \"configmake.h\"",
      "#include \"virutil.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virstring.h\"",
      "#include \"virsocket.h\"",
      "#include \"virfile.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virlog.h\"",
      "#include \"virxml.h\"",
      "#include \"datatypes.h\"",
      "#include \"viralloc.h\"",
      "#include \"virconf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_firmware.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_capabilities.h\"",
      "#include \"qemu_conf.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virDomainXMLOptionNew",
          "args": [
            "&virQEMUDriverDomainDefParserConfig",
            "&virQEMUDriverPrivateDataCallbacks",
            "&virQEMUDriverDomainXMLNamespace",
            "&virQEMUDriverDomainABIStability",
            "&virQEMUDriverDomainSaveCookie"
          ],
          "line": 1232
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainXMLOptionNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "1415-1458",
          "snippet": "virDomainXMLOptionPtr\nvirDomainXMLOptionNew(virDomainDefParserConfigPtr config,\n                      virDomainXMLPrivateDataCallbacksPtr priv,\n                      virXMLNamespacePtr xmlns,\n                      virDomainABIStabilityPtr abi,\n                      virSaveCookieCallbacksPtr saveCookie)\n{\n    virDomainXMLOptionPtr xmlopt;\n\n    if (virDomainObjInitialize() < 0)\n        return NULL;\n\n    if (!(xmlopt = virObjectNew(virDomainXMLOptionClass)))\n        return NULL;\n\n    if (priv)\n        xmlopt->privateData = *priv;\n\n    if (config)\n        xmlopt->config = *config;\n\n    if (xmlns)\n        xmlopt->ns = *xmlns;\n\n    if (abi)\n        xmlopt->abi = *abi;\n\n    if (saveCookie)\n        xmlopt->saveCookie = *saveCookie;\n\n    /* Technically this forbids to use one of Xerox's MAC address prefixes in\n     * our hypervisor drivers. This shouldn't ever be a problem.\n     *\n     * Use the KVM prefix as default as it's in the privately administered\n     * range */\n    if (xmlopt->config.macPrefix[0] == 0 &&\n        xmlopt->config.macPrefix[1] == 0 &&\n        xmlopt->config.macPrefix[2] == 0) {\n        xmlopt->config.macPrefix[0] = 0x52;\n        xmlopt->config.macPrefix[1] = 0x54;\n    }\n\n    return xmlopt;\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virClassPtr virDomainXMLOptionClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nstatic virClassPtr virDomainXMLOptionClass;\n\nvirDomainXMLOptionPtr\nvirDomainXMLOptionNew(virDomainDefParserConfigPtr config,\n                      virDomainXMLPrivateDataCallbacksPtr priv,\n                      virXMLNamespacePtr xmlns,\n                      virDomainABIStabilityPtr abi,\n                      virSaveCookieCallbacksPtr saveCookie)\n{\n    virDomainXMLOptionPtr xmlopt;\n\n    if (virDomainObjInitialize() < 0)\n        return NULL;\n\n    if (!(xmlopt = virObjectNew(virDomainXMLOptionClass)))\n        return NULL;\n\n    if (priv)\n        xmlopt->privateData = *priv;\n\n    if (config)\n        xmlopt->config = *config;\n\n    if (xmlns)\n        xmlopt->ns = *xmlns;\n\n    if (abi)\n        xmlopt->abi = *abi;\n\n    if (saveCookie)\n        xmlopt->saveCookie = *saveCookie;\n\n    /* Technically this forbids to use one of Xerox's MAC address prefixes in\n     * our hypervisor drivers. This shouldn't ever be a problem.\n     *\n     * Use the KVM prefix as default as it's in the privately administered\n     * range */\n    if (xmlopt->config.macPrefix[0] == 0 &&\n        xmlopt->config.macPrefix[1] == 0 &&\n        xmlopt->config.macPrefix[2] == 0) {\n        xmlopt->config.macPrefix[0] = 0x52;\n        xmlopt->config.macPrefix[1] = 0x54;\n    }\n\n    return xmlopt;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvirDomainXMLOptionPtr\nvirQEMUDriverCreateXMLConf(virQEMUDriverPtr driver,\n                           const char *defsecmodel)\n{\n    virQEMUDriverDomainDefParserConfig.priv = driver;\n    virQEMUDriverDomainDefParserConfig.defSecModel = defsecmodel;\n    return virDomainXMLOptionNew(&virQEMUDriverDomainDefParserConfig,\n                                 &virQEMUDriverPrivateDataCallbacks,\n                                 &virQEMUDriverDomainXMLNamespace,\n                                 &virQEMUDriverDomainABIStability,\n                                 &virQEMUDriverDomainSaveCookie);\n}"
  },
  {
    "function_name": "virQEMUDriverIsPrivileged",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
    "lines": "1220-1224",
    "snippet": "bool\nvirQEMUDriverIsPrivileged(virQEMUDriverPtr driver)\n{\n    return driver->privileged;\n}",
    "includes": [
      "#include \"configmake.h\"",
      "#include \"virutil.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virstring.h\"",
      "#include \"virsocket.h\"",
      "#include \"virfile.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virlog.h\"",
      "#include \"virxml.h\"",
      "#include \"datatypes.h\"",
      "#include \"viralloc.h\"",
      "#include \"virconf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_firmware.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_capabilities.h\"",
      "#include \"qemu_conf.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nbool\nvirQEMUDriverIsPrivileged(virQEMUDriverPtr driver)\n{\n    return driver->privileged;\n}"
  },
  {
    "function_name": "virQEMUDriverGetConfig",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
    "lines": "1211-1218",
    "snippet": "virQEMUDriverConfigPtr virQEMUDriverGetConfig(virQEMUDriverPtr driver)\n{\n    virQEMUDriverConfigPtr conf;\n    qemuDriverLock(driver);\n    conf = virObjectRef(driver->config);\n    qemuDriverUnlock(driver);\n    return conf;\n}",
    "includes": [
      "#include \"configmake.h\"",
      "#include \"virutil.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virstring.h\"",
      "#include \"virsocket.h\"",
      "#include \"virfile.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virlog.h\"",
      "#include \"virxml.h\"",
      "#include \"datatypes.h\"",
      "#include \"viralloc.h\"",
      "#include \"virconf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_firmware.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_capabilities.h\"",
      "#include \"qemu_conf.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "qemuDriverUnlock",
          "args": [
            "driver"
          ],
          "line": 1216
        },
        "resolved": true,
        "details": {
          "function_name": "qemuDriverUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
          "lines": "90-94",
          "snippet": "static void\nqemuDriverUnlock(virQEMUDriverPtr driver)\n{\n    virMutexUnlock(&driver->lock);\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virutil.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virsocket.h\"",
            "#include \"virfile.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virlog.h\"",
            "#include \"virxml.h\"",
            "#include \"datatypes.h\"",
            "#include \"viralloc.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_firmware.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic void\nqemuDriverUnlock(virQEMUDriverPtr driver)\n{\n    virMutexUnlock(&driver->lock);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectRef",
          "args": [
            "driver->config"
          ],
          "line": 1215
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectRef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "377-387",
          "snippet": "void *\nvirObjectRef(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return NULL;\n    g_atomic_int_add(&obj->u.s.refs, 1);\n    PROBE(OBJECT_REF, \"obj=%p\", obj);\n    return anyobj;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static void virObjectLockableDispose(void *anyobj);",
            "static void virObjectRWLockableDispose(void *anyobj);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic void virObjectLockableDispose(void *anyobj);\nstatic void virObjectRWLockableDispose(void *anyobj);\n\nvoid *\nvirObjectRef(void *anyobj)\n{\n    virObjectPtr obj = anyobj;\n\n    if (VIR_OBJECT_NOTVALID(obj))\n        return NULL;\n    g_atomic_int_add(&obj->u.s.refs, 1);\n    PROBE(OBJECT_REF, \"obj=%p\", obj);\n    return anyobj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuDriverLock",
          "args": [
            "driver"
          ],
          "line": 1214
        },
        "resolved": true,
        "details": {
          "function_name": "qemuDriverLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
          "lines": "85-89",
          "snippet": "static void\nqemuDriverLock(virQEMUDriverPtr driver)\n{\n    virMutexLock(&driver->lock);\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virutil.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virsocket.h\"",
            "#include \"virfile.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virlog.h\"",
            "#include \"virxml.h\"",
            "#include \"datatypes.h\"",
            "#include \"viralloc.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_firmware.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic void\nqemuDriverLock(virQEMUDriverPtr driver)\n{\n    virMutexLock(&driver->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nvirQEMUDriverConfigPtr virQEMUDriverGetConfig(virQEMUDriverPtr driver)\n{\n    virQEMUDriverConfigPtr conf;\n    qemuDriverLock(driver);\n    conf = virObjectRef(driver->config);\n    qemuDriverUnlock(driver);\n    return conf;\n}"
  },
  {
    "function_name": "virQEMUDriverConfigSetDefaults",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
    "lines": "1150-1208",
    "snippet": "int\nvirQEMUDriverConfigSetDefaults(virQEMUDriverConfigPtr cfg)\n{\n#define SET_TLS_SECRET_UUID_DEFAULT(val) \\\n    do { \\\n        if (!cfg->val## TLSx509certdir && \\\n            !cfg->val## TLSx509secretUUID && \\\n            cfg->defaultTLSx509secretUUID) { \\\n            cfg->val## TLSx509secretUUID = g_strdup(cfg->defaultTLSx509secretUUID); \\\n        } \\\n    } while (0)\n\n    SET_TLS_SECRET_UUID_DEFAULT(vnc);\n    SET_TLS_SECRET_UUID_DEFAULT(chardev);\n    SET_TLS_SECRET_UUID_DEFAULT(migrate);\n\n#undef SET_TLS_SECRET_UUID_DEFAULT\n\n    /*\n     * If a \"SYSCONFDIR\" + \"pki/libvirt-<val>\" exists, then assume someone\n     * has created a val specific area to place service specific certificates.\n     *\n     * If the service specific directory doesn't exist, 'assume' that the\n     * user has created and populated the \"SYSCONFDIR\" + \"pki/libvirt-default\".\n     */\n#define SET_TLS_X509_CERT_DEFAULT(val) \\\n    do { \\\n        if (cfg->val ## TLSx509certdir) \\\n            break; \\\n        if (virFileExists(SYSCONFDIR \"/pki/libvirt-\"#val)) { \\\n            cfg->val ## TLSx509certdir = g_strdup(SYSCONFDIR \"/pki/libvirt-\"#val); \\\n        } else { \\\n            cfg->val ## TLSx509certdir = g_strdup(cfg->defaultTLSx509certdir); \\\n        } \\\n    } while (0)\n\n    SET_TLS_X509_CERT_DEFAULT(vnc);\n    SET_TLS_X509_CERT_DEFAULT(spice);\n    SET_TLS_X509_CERT_DEFAULT(chardev);\n    SET_TLS_X509_CERT_DEFAULT(migrate);\n    SET_TLS_X509_CERT_DEFAULT(vxhs);\n    SET_TLS_X509_CERT_DEFAULT(nbd);\n\n#undef SET_TLS_X509_CERT_DEFAULT\n\n#define SET_TLS_VERIFY_DEFAULT(val) \\\n    do { \\\n        if (!cfg->val## TLSx509verifyPresent) \\\n            cfg->val## TLSx509verify = cfg->defaultTLSx509verify; \\\n    } while (0)\n\n    SET_TLS_VERIFY_DEFAULT(vnc);\n    SET_TLS_VERIFY_DEFAULT(chardev);\n    SET_TLS_VERIFY_DEFAULT(migrate);\n\n#undef SET_TLS_VERIFY_DEFAULT\n\n    return 0;\n}",
    "includes": [
      "#include \"configmake.h\"",
      "#include \"virutil.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virstring.h\"",
      "#include \"virsocket.h\"",
      "#include \"virfile.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virlog.h\"",
      "#include \"virxml.h\"",
      "#include \"datatypes.h\"",
      "#include \"viralloc.h\"",
      "#include \"virconf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_firmware.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_capabilities.h\"",
      "#include \"qemu_conf.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "SET_TLS_VERIFY_DEFAULT",
          "args": [
            "migrate"
          ],
          "line": 1203
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SET_TLS_VERIFY_DEFAULT",
          "args": [
            "chardev"
          ],
          "line": 1202
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SET_TLS_VERIFY_DEFAULT",
          "args": [
            "vnc"
          ],
          "line": 1201
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SET_TLS_X509_CERT_DEFAULT",
          "args": [
            "nbd"
          ],
          "line": 1191
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SET_TLS_X509_CERT_DEFAULT",
          "args": [
            "vxhs"
          ],
          "line": 1190
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SET_TLS_X509_CERT_DEFAULT",
          "args": [
            "migrate"
          ],
          "line": 1189
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SET_TLS_X509_CERT_DEFAULT",
          "args": [
            "chardev"
          ],
          "line": 1188
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SET_TLS_X509_CERT_DEFAULT",
          "args": [
            "spice"
          ],
          "line": 1187
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SET_TLS_X509_CERT_DEFAULT",
          "args": [
            "vnc"
          ],
          "line": 1186
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SET_TLS_SECRET_UUID_DEFAULT",
          "args": [
            "migrate"
          ],
          "line": 1164
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SET_TLS_SECRET_UUID_DEFAULT",
          "args": [
            "chardev"
          ],
          "line": 1163
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SET_TLS_SECRET_UUID_DEFAULT",
          "args": [
            "vnc"
          ],
          "line": 1162
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nint\nvirQEMUDriverConfigSetDefaults(virQEMUDriverConfigPtr cfg)\n{\n#define SET_TLS_SECRET_UUID_DEFAULT(val) \\\n    do { \\\n        if (!cfg->val## TLSx509certdir && \\\n            !cfg->val## TLSx509secretUUID && \\\n            cfg->defaultTLSx509secretUUID) { \\\n            cfg->val## TLSx509secretUUID = g_strdup(cfg->defaultTLSx509secretUUID); \\\n        } \\\n    } while (0)\n\n    SET_TLS_SECRET_UUID_DEFAULT(vnc);\n    SET_TLS_SECRET_UUID_DEFAULT(chardev);\n    SET_TLS_SECRET_UUID_DEFAULT(migrate);\n\n#undef SET_TLS_SECRET_UUID_DEFAULT\n\n    /*\n     * If a \"SYSCONFDIR\" + \"pki/libvirt-<val>\" exists, then assume someone\n     * has created a val specific area to place service specific certificates.\n     *\n     * If the service specific directory doesn't exist, 'assume' that the\n     * user has created and populated the \"SYSCONFDIR\" + \"pki/libvirt-default\".\n     */\n#define SET_TLS_X509_CERT_DEFAULT(val) \\\n    do { \\\n        if (cfg->val ## TLSx509certdir) \\\n            break; \\\n        if (virFileExists(SYSCONFDIR \"/pki/libvirt-\"#val)) { \\\n            cfg->val ## TLSx509certdir = g_strdup(SYSCONFDIR \"/pki/libvirt-\"#val); \\\n        } else { \\\n            cfg->val ## TLSx509certdir = g_strdup(cfg->defaultTLSx509certdir); \\\n        } \\\n    } while (0)\n\n    SET_TLS_X509_CERT_DEFAULT(vnc);\n    SET_TLS_X509_CERT_DEFAULT(spice);\n    SET_TLS_X509_CERT_DEFAULT(chardev);\n    SET_TLS_X509_CERT_DEFAULT(migrate);\n    SET_TLS_X509_CERT_DEFAULT(vxhs);\n    SET_TLS_X509_CERT_DEFAULT(nbd);\n\n#undef SET_TLS_X509_CERT_DEFAULT\n\n#define SET_TLS_VERIFY_DEFAULT(val) \\\n    do { \\\n        if (!cfg->val## TLSx509verifyPresent) \\\n            cfg->val## TLSx509verify = cfg->defaultTLSx509verify; \\\n    } while (0)\n\n    SET_TLS_VERIFY_DEFAULT(vnc);\n    SET_TLS_VERIFY_DEFAULT(chardev);\n    SET_TLS_VERIFY_DEFAULT(migrate);\n\n#undef SET_TLS_VERIFY_DEFAULT\n\n    return 0;\n}"
  },
  {
    "function_name": "virQEMUDriverConfigValidate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
    "lines": "1085-1147",
    "snippet": "int\nvirQEMUDriverConfigValidate(virQEMUDriverConfigPtr cfg)\n{\n    if (cfg->defaultTLSx509certdirPresent) {\n        if (!virFileExists(cfg->defaultTLSx509certdir)) {\n            virReportError(VIR_ERR_CONF_SYNTAX,\n                           _(\"default_tls_x509_cert_dir directory '%s' \"\n                             \"does not exist\"),\n                           cfg->defaultTLSx509certdir);\n            return -1;\n        }\n    }\n\n    if (cfg->vncTLSx509certdir &&\n        !virFileExists(cfg->vncTLSx509certdir)) {\n        virReportError(VIR_ERR_CONF_SYNTAX,\n                       _(\"vnc_tls_x509_cert_dir directory '%s' does not exist\"),\n                       cfg->vncTLSx509certdir);\n        return -1;\n    }\n\n    if (cfg->spiceTLSx509certdir &&\n        !virFileExists(cfg->spiceTLSx509certdir)) {\n        virReportError(VIR_ERR_CONF_SYNTAX,\n                       _(\"spice_tls_x509_cert_dir directory '%s' does not exist\"),\n                       cfg->spiceTLSx509certdir);\n        return -1;\n    }\n\n    if (cfg->chardevTLSx509certdir &&\n        !virFileExists(cfg->chardevTLSx509certdir)) {\n        virReportError(VIR_ERR_CONF_SYNTAX,\n                       _(\"chardev_tls_x509_cert_dir directory '%s' does not exist\"),\n                       cfg->chardevTLSx509certdir);\n        return -1;\n    }\n\n    if (cfg->migrateTLSx509certdir &&\n        !virFileExists(cfg->migrateTLSx509certdir)) {\n        virReportError(VIR_ERR_CONF_SYNTAX,\n                       _(\"migrate_tls_x509_cert_dir directory '%s' does not exist\"),\n                       cfg->migrateTLSx509certdir);\n        return -1;\n    }\n\n    if (cfg->vxhsTLSx509certdir &&\n        !virFileExists(cfg->vxhsTLSx509certdir)) {\n        virReportError(VIR_ERR_CONF_SYNTAX,\n                       _(\"vxhs_tls_x509_cert_dir directory '%s' does not exist\"),\n                       cfg->vxhsTLSx509certdir);\n        return -1;\n    }\n\n    if (cfg->nbdTLSx509certdir &&\n        !virFileExists(cfg->nbdTLSx509certdir)) {\n        virReportError(VIR_ERR_CONF_SYNTAX,\n                       _(\"nbd_tls_x509_cert_dir directory '%s' does not exist\"),\n                       cfg->nbdTLSx509certdir);\n        return -1;\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"configmake.h\"",
      "#include \"virutil.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virstring.h\"",
      "#include \"virsocket.h\"",
      "#include \"virfile.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virlog.h\"",
      "#include \"virxml.h\"",
      "#include \"datatypes.h\"",
      "#include \"viralloc.h\"",
      "#include \"virconf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_firmware.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_capabilities.h\"",
      "#include \"qemu_conf.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONF_SYNTAX",
            "_(\"nbd_tls_x509_cert_dir directory '%s' does not exist\")",
            "cfg->nbdTLSx509certdir"
          ],
          "line": 1140
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"nbd_tls_x509_cert_dir directory '%s' does not exist\""
          ],
          "line": 1141
        },
        "resolved": true,
        "details": {
          "function_name": "bswap_header",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_driver.c",
          "lines": "2852-2860",
          "snippet": "static inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virenum.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virqemu.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virnuma.h\"",
            "#include \"virperf.h\"",
            "#include \"vircgroup.h\"",
            "#include \"domain_capabilities.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapicheckqemu.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virkeycode.h\"",
            "#include \"locking/domain_lock.h\"",
            "#include \"locking/lock_manager.h\"",
            "#include \"virthreadpool.h\"",
            "#include \"configmake.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virhook.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virxml.h\"",
            "#include \"libvirt_internal.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virusb.h\"",
            "#include \"virpci.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"domain_conf.h\"",
            "#include \"viruuid.h\"",
            "#include \"virarptable.h\"",
            "#include \"viralloc.h\"",
            "#include \"capabilities.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virbuffer.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"qemu_backup.h\"",
            "#include \"qemu_checkpoint.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_blockjob.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_monitor.h\"",
            "#include \"qemu_hotplug.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"qemu_block.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_agent.h\"",
            "#include \"qemu_driver.h\"",
            "#include <sys/ioctl.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <dirent.h>",
            "#include <sys/time.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virenum.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virqemu.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virnuma.h\"\n#include \"virperf.h\"\n#include \"vircgroup.h\"\n#include \"domain_capabilities.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapicheckqemu.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virbitmap.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virnodesuspend.h\"\n#include \"virkeycode.h\"\n#include \"locking/domain_lock.h\"\n#include \"locking/lock_manager.h\"\n#include \"virthreadpool.h\"\n#include \"configmake.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"virhook.h\"\n#include \"domain_nwfilter.h\"\n#include \"virsysinfo.h\"\n#include \"cpu/cpu.h\"\n#include \"virxml.h\"\n#include \"libvirt_internal.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virusb.h\"\n#include \"virpci.h\"\n#include \"node_device_conf.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"domain_conf.h\"\n#include \"viruuid.h\"\n#include \"virarptable.h\"\n#include \"viralloc.h\"\n#include \"capabilities.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevtap.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"qemu_backup.h\"\n#include \"qemu_checkpoint.h\"\n#include \"qemu_security.h\"\n#include \"qemu_blockjob.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_process.h\"\n#include \"qemu_monitor.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_cgroup.h\"\n#include \"qemu_command.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"qemu_block.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_agent.h\"\n#include \"qemu_driver.h\"\n#include <sys/ioctl.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <dirent.h>\n#include <sys/time.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virFileExists",
          "args": [
            "cfg->nbdTLSx509certdir"
          ],
          "line": 1139
        },
        "resolved": true,
        "details": {
          "function_name": "virFileExists",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "1873-1877",
          "snippet": "bool\nvirFileExists(const char *path)\n{\n    return access(path, F_OK) == 0;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nbool\nvirFileExists(const char *path)\n{\n    return access(path, F_OK) == 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONF_SYNTAX",
            "_(\"vxhs_tls_x509_cert_dir directory '%s' does not exist\")",
            "cfg->vxhsTLSx509certdir"
          ],
          "line": 1132
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONF_SYNTAX",
            "_(\"migrate_tls_x509_cert_dir directory '%s' does not exist\")",
            "cfg->migrateTLSx509certdir"
          ],
          "line": 1124
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONF_SYNTAX",
            "_(\"chardev_tls_x509_cert_dir directory '%s' does not exist\")",
            "cfg->chardevTLSx509certdir"
          ],
          "line": 1116
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONF_SYNTAX",
            "_(\"spice_tls_x509_cert_dir directory '%s' does not exist\")",
            "cfg->spiceTLSx509certdir"
          ],
          "line": 1108
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONF_SYNTAX",
            "_(\"vnc_tls_x509_cert_dir directory '%s' does not exist\")",
            "cfg->vncTLSx509certdir"
          ],
          "line": 1100
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONF_SYNTAX",
            "_(\"default_tls_x509_cert_dir directory '%s' \"\n                             \"does not exist\")",
            "cfg->defaultTLSx509certdir"
          ],
          "line": 1090
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nint\nvirQEMUDriverConfigValidate(virQEMUDriverConfigPtr cfg)\n{\n    if (cfg->defaultTLSx509certdirPresent) {\n        if (!virFileExists(cfg->defaultTLSx509certdir)) {\n            virReportError(VIR_ERR_CONF_SYNTAX,\n                           _(\"default_tls_x509_cert_dir directory '%s' \"\n                             \"does not exist\"),\n                           cfg->defaultTLSx509certdir);\n            return -1;\n        }\n    }\n\n    if (cfg->vncTLSx509certdir &&\n        !virFileExists(cfg->vncTLSx509certdir)) {\n        virReportError(VIR_ERR_CONF_SYNTAX,\n                       _(\"vnc_tls_x509_cert_dir directory '%s' does not exist\"),\n                       cfg->vncTLSx509certdir);\n        return -1;\n    }\n\n    if (cfg->spiceTLSx509certdir &&\n        !virFileExists(cfg->spiceTLSx509certdir)) {\n        virReportError(VIR_ERR_CONF_SYNTAX,\n                       _(\"spice_tls_x509_cert_dir directory '%s' does not exist\"),\n                       cfg->spiceTLSx509certdir);\n        return -1;\n    }\n\n    if (cfg->chardevTLSx509certdir &&\n        !virFileExists(cfg->chardevTLSx509certdir)) {\n        virReportError(VIR_ERR_CONF_SYNTAX,\n                       _(\"chardev_tls_x509_cert_dir directory '%s' does not exist\"),\n                       cfg->chardevTLSx509certdir);\n        return -1;\n    }\n\n    if (cfg->migrateTLSx509certdir &&\n        !virFileExists(cfg->migrateTLSx509certdir)) {\n        virReportError(VIR_ERR_CONF_SYNTAX,\n                       _(\"migrate_tls_x509_cert_dir directory '%s' does not exist\"),\n                       cfg->migrateTLSx509certdir);\n        return -1;\n    }\n\n    if (cfg->vxhsTLSx509certdir &&\n        !virFileExists(cfg->vxhsTLSx509certdir)) {\n        virReportError(VIR_ERR_CONF_SYNTAX,\n                       _(\"vxhs_tls_x509_cert_dir directory '%s' does not exist\"),\n                       cfg->vxhsTLSx509certdir);\n        return -1;\n    }\n\n    if (cfg->nbdTLSx509certdir &&\n        !virFileExists(cfg->nbdTLSx509certdir)) {\n        virReportError(VIR_ERR_CONF_SYNTAX,\n                       _(\"nbd_tls_x509_cert_dir directory '%s' does not exist\"),\n                       cfg->nbdTLSx509certdir);\n        return -1;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virQEMUDriverConfigLoadFile",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
    "lines": "1003-1075",
    "snippet": "int virQEMUDriverConfigLoadFile(virQEMUDriverConfigPtr cfg,\n                                const char *filename,\n                                bool privileged)\n{\n    g_autoptr(virConf) conf = NULL;\n\n    /* Just check the file is readable before opening it, otherwise\n     * libvirt emits an error.\n     */\n    if (access(filename, R_OK) == -1) {\n        VIR_INFO(\"Could not read qemu config file %s\", filename);\n        return 0;\n    }\n\n    if (!(conf = virConfReadFile(filename, 0)))\n        return -1;\n\n    if (virQEMUDriverConfigLoadDefaultTLSEntry(cfg, conf) < 0)\n        return -1;\n\n    if (virQEMUDriverConfigLoadVNCEntry(cfg, conf) < 0)\n        return -1;\n\n    if (virQEMUDriverConfigLoadNographicsEntry(cfg, conf) < 0)\n        return -1;\n\n    if (virQEMUDriverConfigLoadSPICEEntry(cfg, conf) < 0)\n        return -1;\n\n    if (virQEMUDriverConfigLoadSpecificTLSEntry(cfg, conf) < 0)\n        return -1;\n\n    if (virQEMUDriverConfigLoadRemoteDisplayEntry(cfg, conf, filename) < 0)\n        return -1;\n\n    if (virQEMUDriverConfigLoadSaveEntry(cfg, conf) < 0)\n        return -1;\n\n    if (virQEMUDriverConfigLoadProcessEntry(cfg, conf) < 0)\n        return -1;\n\n    if (virQEMUDriverConfigLoadDeviceEntry(cfg, conf) < 0)\n        return -1;\n\n    if (virQEMUDriverConfigLoadRPCEntry(cfg, conf) < 0)\n        return -1;\n\n    if (virQEMUDriverConfigLoadNetworkEntry(cfg, conf, filename) < 0)\n        return -1;\n\n    if (virQEMUDriverConfigLoadLogEntry(cfg, conf) < 0)\n        return -1;\n\n    if (virQEMUDriverConfigLoadNVRAMEntry(cfg, conf, privileged) < 0)\n        return -1;\n\n    if (virQEMUDriverConfigLoadDebugEntry(cfg, conf) < 0)\n        return -1;\n\n    if (virQEMUDriverConfigLoadSecurityEntry(cfg, conf, privileged) < 0)\n        return -1;\n\n    if (virQEMUDriverConfigLoadMemoryEntry(cfg, conf) < 0)\n        return -1;\n\n    if (virQEMUDriverConfigLoadSWTPMEntry(cfg, conf) < 0)\n        return -1;\n\n    if (virQEMUDriverConfigLoadCapsFiltersEntry(cfg, conf) < 0)\n        return -1;\n\n    return 0;\n}",
    "includes": [
      "#include \"configmake.h\"",
      "#include \"virutil.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virstring.h\"",
      "#include \"virsocket.h\"",
      "#include \"virfile.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virlog.h\"",
      "#include \"virxml.h\"",
      "#include \"datatypes.h\"",
      "#include \"viralloc.h\"",
      "#include \"virconf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_firmware.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_capabilities.h\"",
      "#include \"qemu_conf.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virQEMUDriverConfigLoadCapsFiltersEntry",
          "args": [
            "cfg",
            "conf"
          ],
          "line": 1071
        },
        "resolved": true,
        "details": {
          "function_name": "virQEMUDriverConfigLoadCapsFiltersEntry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
          "lines": "991-1000",
          "snippet": "static int\nvirQEMUDriverConfigLoadCapsFiltersEntry(virQEMUDriverConfigPtr cfg,\n                                        virConfPtr conf)\n{\n    if (virConfGetValueStringList(conf, \"capability_filters\", false,\n                                  &cfg->capabilityfilters) < 0)\n        return -1;\n\n    return 0;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virutil.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virsocket.h\"",
            "#include \"virfile.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virlog.h\"",
            "#include \"virxml.h\"",
            "#include \"datatypes.h\"",
            "#include \"viralloc.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_firmware.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvirQEMUDriverConfigLoadCapsFiltersEntry(virQEMUDriverConfigPtr cfg,\n                                        virConfPtr conf)\n{\n    if (virConfGetValueStringList(conf, \"capability_filters\", false,\n                                  &cfg->capabilityfilters) < 0)\n        return -1;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virQEMUDriverConfigLoadSWTPMEntry",
          "args": [
            "cfg",
            "conf"
          ],
          "line": 1068
        },
        "resolved": true,
        "details": {
          "function_name": "virQEMUDriverConfigLoadSWTPMEntry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
          "lines": "970-988",
          "snippet": "static int\nvirQEMUDriverConfigLoadSWTPMEntry(virQEMUDriverConfigPtr cfg,\n                                  virConfPtr conf)\n{\n    g_autofree char *swtpm_user = NULL;\n    g_autofree char *swtpm_group = NULL;\n\n    if (virConfGetValueString(conf, \"swtpm_user\", &swtpm_user) < 0)\n        return -1;\n    if (swtpm_user && virGetUserID(swtpm_user, &cfg->swtpm_user) < 0)\n        return -1;\n\n    if (virConfGetValueString(conf, \"swtpm_group\", &swtpm_group) < 0)\n        return -1;\n    if (swtpm_group && virGetGroupID(swtpm_group, &cfg->swtpm_group) < 0)\n        return -1;\n\n    return 0;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virutil.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virsocket.h\"",
            "#include \"virfile.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virlog.h\"",
            "#include \"virxml.h\"",
            "#include \"datatypes.h\"",
            "#include \"viralloc.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_firmware.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvirQEMUDriverConfigLoadSWTPMEntry(virQEMUDriverConfigPtr cfg,\n                                  virConfPtr conf)\n{\n    g_autofree char *swtpm_user = NULL;\n    g_autofree char *swtpm_group = NULL;\n\n    if (virConfGetValueString(conf, \"swtpm_user\", &swtpm_user) < 0)\n        return -1;\n    if (swtpm_user && virGetUserID(swtpm_user, &cfg->swtpm_user) < 0)\n        return -1;\n\n    if (virConfGetValueString(conf, \"swtpm_group\", &swtpm_group) < 0)\n        return -1;\n    if (swtpm_group && virGetGroupID(swtpm_group, &cfg->swtpm_group) < 0)\n        return -1;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virQEMUDriverConfigLoadMemoryEntry",
          "args": [
            "cfg",
            "conf"
          ],
          "line": 1065
        },
        "resolved": true,
        "details": {
          "function_name": "virQEMUDriverConfigLoadMemoryEntry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
          "lines": "962-967",
          "snippet": "static int\nvirQEMUDriverConfigLoadMemoryEntry(virQEMUDriverConfigPtr cfg,\n                                   virConfPtr conf)\n{\n    return virConfGetValueString(conf, \"memory_backing_dir\", &cfg->memoryBackingDir);\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virutil.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virsocket.h\"",
            "#include \"virfile.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virlog.h\"",
            "#include \"virxml.h\"",
            "#include \"datatypes.h\"",
            "#include \"viralloc.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_firmware.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvirQEMUDriverConfigLoadMemoryEntry(virQEMUDriverConfigPtr cfg,\n                                   virConfPtr conf)\n{\n    return virConfGetValueString(conf, \"memory_backing_dir\", &cfg->memoryBackingDir);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virQEMUDriverConfigLoadSecurityEntry",
          "args": [
            "cfg",
            "conf",
            "privileged"
          ],
          "line": 1062
        },
        "resolved": true,
        "details": {
          "function_name": "virQEMUDriverConfigLoadSecurityEntry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
          "lines": "848-959",
          "snippet": "static int\nvirQEMUDriverConfigLoadSecurityEntry(virQEMUDriverConfigPtr cfg,\n                                     virConfPtr conf,\n                                     bool privileged)\n{\n    VIR_AUTOSTRINGLIST controllers = NULL;\n    VIR_AUTOSTRINGLIST namespaces = NULL;\n    g_autofree char *user = NULL;\n    g_autofree char *group = NULL;\n    size_t i, j;\n\n    if (virConfGetValueStringList(conf, \"security_driver\", true, &cfg->securityDriverNames) < 0)\n        return -1;\n\n    for (i = 0; cfg->securityDriverNames && cfg->securityDriverNames[i] != NULL; i++) {\n        for (j = i + 1; cfg->securityDriverNames[j] != NULL; j++) {\n            if (STREQ(cfg->securityDriverNames[i],\n                      cfg->securityDriverNames[j])) {\n                virReportError(VIR_ERR_CONF_SYNTAX,\n                               _(\"Duplicate security driver %s\"),\n                               cfg->securityDriverNames[i]);\n                return -1;\n            }\n        }\n    }\n\n    if (virConfGetValueBool(conf, \"security_default_confined\", &cfg->securityDefaultConfined) < 0)\n        return -1;\n    if (virConfGetValueBool(conf, \"security_require_confined\", &cfg->securityRequireConfined) < 0)\n        return -1;\n\n    if (virConfGetValueString(conf, \"user\", &user) < 0)\n        return -1;\n    if (user && virGetUserID(user, &cfg->user) < 0)\n        return -1;\n\n    if (virConfGetValueString(conf, \"group\", &group) < 0)\n        return -1;\n    if (group && virGetGroupID(group, &cfg->group) < 0)\n        return -1;\n\n    if (virConfGetValueBool(conf, \"dynamic_ownership\", &cfg->dynamicOwnership) < 0)\n        return -1;\n\n    if (virConfGetValueBool(conf, \"remember_owner\", &cfg->rememberOwner) < 0)\n        return -1;\n\n    if (virConfGetValueStringList(conf, \"cgroup_controllers\", false,\n                                  &controllers) < 0)\n        return -1;\n\n    if (controllers) {\n        cfg->cgroupControllers = 0;\n        for (i = 0; controllers[i] != NULL; i++) {\n            int ctl;\n            if ((ctl = virCgroupControllerTypeFromString(controllers[i])) < 0) {\n                virReportError(VIR_ERR_CONF_SYNTAX,\n                               _(\"Unknown cgroup controller '%s'\"),\n                               controllers[i]);\n                return -1;\n            }\n            cfg->cgroupControllers |= (1 << ctl);\n        }\n    }\n\n    if (virConfGetValueStringList(conf, \"cgroup_device_acl\", false,\n                                  &cfg->cgroupDeviceACL) < 0)\n        return -1;\n\n    if (virConfGetValueInt(conf, \"seccomp_sandbox\", &cfg->seccompSandbox) < 0)\n        return -1;\n\n    if (virConfGetValueStringList(conf, \"namespaces\", false, &namespaces) < 0)\n        return -1;\n\n    if (namespaces) {\n        virBitmapClearAll(cfg->namespaces);\n\n        for (i = 0; namespaces[i]; i++) {\n            int ns = qemuDomainNamespaceTypeFromString(namespaces[i]);\n\n            if (ns < 0) {\n                virReportError(VIR_ERR_CONF_SYNTAX,\n                               _(\"Unknown namespace: %s\"),\n                               namespaces[i]);\n                return -1;\n            }\n\n            if (!privileged) {\n                virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                               _(\"cannot use namespaces in session mode\"));\n                return -1;\n            }\n\n            if (!qemuDomainNamespaceAvailable(ns)) {\n                virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                               _(\"%s namespace is not available\"),\n                               namespaces[i]);\n                return -1;\n            }\n\n            if (virBitmapSetBit(cfg->namespaces, ns) < 0) {\n                virReportError(VIR_ERR_INTERNAL_ERROR,\n                               _(\"Unable to enable namespace: %s\"),\n                               namespaces[i]);\n                return -1;\n            }\n        }\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virutil.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virsocket.h\"",
            "#include \"virfile.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virlog.h\"",
            "#include \"virxml.h\"",
            "#include \"datatypes.h\"",
            "#include \"viralloc.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_firmware.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvirQEMUDriverConfigLoadSecurityEntry(virQEMUDriverConfigPtr cfg,\n                                     virConfPtr conf,\n                                     bool privileged)\n{\n    VIR_AUTOSTRINGLIST controllers = NULL;\n    VIR_AUTOSTRINGLIST namespaces = NULL;\n    g_autofree char *user = NULL;\n    g_autofree char *group = NULL;\n    size_t i, j;\n\n    if (virConfGetValueStringList(conf, \"security_driver\", true, &cfg->securityDriverNames) < 0)\n        return -1;\n\n    for (i = 0; cfg->securityDriverNames && cfg->securityDriverNames[i] != NULL; i++) {\n        for (j = i + 1; cfg->securityDriverNames[j] != NULL; j++) {\n            if (STREQ(cfg->securityDriverNames[i],\n                      cfg->securityDriverNames[j])) {\n                virReportError(VIR_ERR_CONF_SYNTAX,\n                               _(\"Duplicate security driver %s\"),\n                               cfg->securityDriverNames[i]);\n                return -1;\n            }\n        }\n    }\n\n    if (virConfGetValueBool(conf, \"security_default_confined\", &cfg->securityDefaultConfined) < 0)\n        return -1;\n    if (virConfGetValueBool(conf, \"security_require_confined\", &cfg->securityRequireConfined) < 0)\n        return -1;\n\n    if (virConfGetValueString(conf, \"user\", &user) < 0)\n        return -1;\n    if (user && virGetUserID(user, &cfg->user) < 0)\n        return -1;\n\n    if (virConfGetValueString(conf, \"group\", &group) < 0)\n        return -1;\n    if (group && virGetGroupID(group, &cfg->group) < 0)\n        return -1;\n\n    if (virConfGetValueBool(conf, \"dynamic_ownership\", &cfg->dynamicOwnership) < 0)\n        return -1;\n\n    if (virConfGetValueBool(conf, \"remember_owner\", &cfg->rememberOwner) < 0)\n        return -1;\n\n    if (virConfGetValueStringList(conf, \"cgroup_controllers\", false,\n                                  &controllers) < 0)\n        return -1;\n\n    if (controllers) {\n        cfg->cgroupControllers = 0;\n        for (i = 0; controllers[i] != NULL; i++) {\n            int ctl;\n            if ((ctl = virCgroupControllerTypeFromString(controllers[i])) < 0) {\n                virReportError(VIR_ERR_CONF_SYNTAX,\n                               _(\"Unknown cgroup controller '%s'\"),\n                               controllers[i]);\n                return -1;\n            }\n            cfg->cgroupControllers |= (1 << ctl);\n        }\n    }\n\n    if (virConfGetValueStringList(conf, \"cgroup_device_acl\", false,\n                                  &cfg->cgroupDeviceACL) < 0)\n        return -1;\n\n    if (virConfGetValueInt(conf, \"seccomp_sandbox\", &cfg->seccompSandbox) < 0)\n        return -1;\n\n    if (virConfGetValueStringList(conf, \"namespaces\", false, &namespaces) < 0)\n        return -1;\n\n    if (namespaces) {\n        virBitmapClearAll(cfg->namespaces);\n\n        for (i = 0; namespaces[i]; i++) {\n            int ns = qemuDomainNamespaceTypeFromString(namespaces[i]);\n\n            if (ns < 0) {\n                virReportError(VIR_ERR_CONF_SYNTAX,\n                               _(\"Unknown namespace: %s\"),\n                               namespaces[i]);\n                return -1;\n            }\n\n            if (!privileged) {\n                virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                               _(\"cannot use namespaces in session mode\"));\n                return -1;\n            }\n\n            if (!qemuDomainNamespaceAvailable(ns)) {\n                virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                               _(\"%s namespace is not available\"),\n                               namespaces[i]);\n                return -1;\n            }\n\n            if (virBitmapSetBit(cfg->namespaces, ns) < 0) {\n                virReportError(VIR_ERR_INTERNAL_ERROR,\n                               _(\"Unable to enable namespace: %s\"),\n                               namespaces[i]);\n                return -1;\n            }\n        }\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virQEMUDriverConfigLoadDebugEntry",
          "args": [
            "cfg",
            "conf"
          ],
          "line": 1059
        },
        "resolved": true,
        "details": {
          "function_name": "virQEMUDriverConfigLoadDebugEntry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
          "lines": "835-845",
          "snippet": "static int\nvirQEMUDriverConfigLoadDebugEntry(virQEMUDriverConfigPtr cfg,\n                                  virConfPtr conf)\n{\n    if (virConfGetValueUInt(conf, \"gluster_debug_level\", &cfg->glusterDebugLevel) < 0)\n        return -1;\n    if (virConfGetValueBool(conf, \"virtiofsd_debug\", &cfg->virtiofsdDebug) < 0)\n        return -1;\n\n    return 0;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virutil.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virsocket.h\"",
            "#include \"virfile.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virlog.h\"",
            "#include \"virxml.h\"",
            "#include \"datatypes.h\"",
            "#include \"viralloc.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_firmware.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvirQEMUDriverConfigLoadDebugEntry(virQEMUDriverConfigPtr cfg,\n                                  virConfPtr conf)\n{\n    if (virConfGetValueUInt(conf, \"gluster_debug_level\", &cfg->glusterDebugLevel) < 0)\n        return -1;\n    if (virConfGetValueBool(conf, \"virtiofsd_debug\", &cfg->virtiofsdDebug) < 0)\n        return -1;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virQEMUDriverConfigLoadNVRAMEntry",
          "args": [
            "cfg",
            "conf",
            "privileged"
          ],
          "line": 1056
        },
        "resolved": true,
        "details": {
          "function_name": "virQEMUDriverConfigLoadNVRAMEntry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
          "lines": "793-832",
          "snippet": "static int\nvirQEMUDriverConfigLoadNVRAMEntry(virQEMUDriverConfigPtr cfg,\n                                  virConfPtr conf,\n                                  bool privileged)\n{\n    VIR_AUTOSTRINGLIST nvram = NULL;\n    size_t i;\n\n    if (virConfGetValueStringList(conf, \"nvram\", false, &nvram) < 0)\n        return -1;\n    if (nvram) {\n        VIR_AUTOSTRINGLIST fwList = NULL;\n\n        virFirmwareFreeList(cfg->firmwares, cfg->nfirmwares);\n\n        if (qemuFirmwareFetchConfigs(&fwList, privileged) < 0)\n            return -1;\n\n        if (fwList) {\n            VIR_WARN(\"Obsolete nvram variable is set while firmware metadata \"\n                     \"files found. Note that the nvram config file variable is \"\n                     \"going to be ignored.\");\n            cfg->nfirmwares = 0;\n            return 0;\n        }\n\n        cfg->nfirmwares = virStringListLength((const char *const *)nvram);\n        if (nvram[0] && VIR_ALLOC_N(cfg->firmwares, cfg->nfirmwares) < 0)\n            return -1;\n\n        for (i = 0; nvram[i] != NULL; i++) {\n            if (VIR_ALLOC(cfg->firmwares[i]) < 0)\n                return -1;\n            if (virFirmwareParse(nvram[i], cfg->firmwares[i]) < 0)\n                return -1;\n        }\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virutil.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virsocket.h\"",
            "#include \"virfile.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virlog.h\"",
            "#include \"virxml.h\"",
            "#include \"datatypes.h\"",
            "#include \"viralloc.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_firmware.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvirQEMUDriverConfigLoadNVRAMEntry(virQEMUDriverConfigPtr cfg,\n                                  virConfPtr conf,\n                                  bool privileged)\n{\n    VIR_AUTOSTRINGLIST nvram = NULL;\n    size_t i;\n\n    if (virConfGetValueStringList(conf, \"nvram\", false, &nvram) < 0)\n        return -1;\n    if (nvram) {\n        VIR_AUTOSTRINGLIST fwList = NULL;\n\n        virFirmwareFreeList(cfg->firmwares, cfg->nfirmwares);\n\n        if (qemuFirmwareFetchConfigs(&fwList, privileged) < 0)\n            return -1;\n\n        if (fwList) {\n            VIR_WARN(\"Obsolete nvram variable is set while firmware metadata \"\n                     \"files found. Note that the nvram config file variable is \"\n                     \"going to be ignored.\");\n            cfg->nfirmwares = 0;\n            return 0;\n        }\n\n        cfg->nfirmwares = virStringListLength((const char *const *)nvram);\n        if (nvram[0] && VIR_ALLOC_N(cfg->firmwares, cfg->nfirmwares) < 0)\n            return -1;\n\n        for (i = 0; nvram[i] != NULL; i++) {\n            if (VIR_ALLOC(cfg->firmwares[i]) < 0)\n                return -1;\n            if (virFirmwareParse(nvram[i], cfg->firmwares[i]) < 0)\n                return -1;\n        }\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virQEMUDriverConfigLoadLogEntry",
          "args": [
            "cfg",
            "conf"
          ],
          "line": 1053
        },
        "resolved": true,
        "details": {
          "function_name": "virQEMUDriverConfigLoadLogEntry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
          "lines": "785-790",
          "snippet": "static int\nvirQEMUDriverConfigLoadLogEntry(virQEMUDriverConfigPtr cfg,\n                                virConfPtr conf)\n{\n    return virConfGetValueBool(conf, \"log_timestamp\", &cfg->logTimestamp);\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virutil.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virsocket.h\"",
            "#include \"virfile.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virlog.h\"",
            "#include \"virxml.h\"",
            "#include \"datatypes.h\"",
            "#include \"viralloc.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_firmware.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvirQEMUDriverConfigLoadLogEntry(virQEMUDriverConfigPtr cfg,\n                                virConfPtr conf)\n{\n    return virConfGetValueBool(conf, \"log_timestamp\", &cfg->logTimestamp);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virQEMUDriverConfigLoadNetworkEntry",
          "args": [
            "cfg",
            "conf",
            "filename"
          ],
          "line": 1050
        },
        "resolved": true,
        "details": {
          "function_name": "virQEMUDriverConfigLoadNetworkEntry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
          "lines": "730-782",
          "snippet": "static int\nvirQEMUDriverConfigLoadNetworkEntry(virQEMUDriverConfigPtr cfg,\n                                    virConfPtr conf,\n                                    const char *filename)\n{\n    if (virConfGetValueUInt(conf, \"migration_port_min\", &cfg->migrationPortMin) < 0)\n        return -1;\n    if (cfg->migrationPortMin <= 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: migration_port_min: port must be greater than 0\"),\n                        filename);\n        return -1;\n    }\n\n    if (virConfGetValueUInt(conf, \"migration_port_max\", &cfg->migrationPortMax) < 0)\n        return -1;\n    if (cfg->migrationPortMax > 65535 ||\n        cfg->migrationPortMax < cfg->migrationPortMin) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                        _(\"%s: migration_port_max: port must be between \"\n                          \"the minimal port %d and 65535\"),\n                       filename, cfg->migrationPortMin);\n        return -1;\n    }\n\n    if (virConfGetValueString(conf, \"migration_host\", &cfg->migrateHost) < 0)\n        return -1;\n    virStringStripIPv6Brackets(cfg->migrateHost);\n    if (cfg->migrateHost &&\n        (STRPREFIX(cfg->migrateHost, \"localhost\") ||\n         virSocketAddrIsNumericLocalhost(cfg->migrateHost))) {\n        virReportError(VIR_ERR_CONF_SYNTAX,\n                       _(\"migration_host must not be the address of\"\n                         \" the local machine: %s\"),\n                       cfg->migrateHost);\n        return -1;\n    }\n\n    if (virConfGetValueString(conf, \"migration_address\", &cfg->migrationAddress) < 0)\n        return -1;\n    virStringStripIPv6Brackets(cfg->migrationAddress);\n    if (cfg->migrationAddress &&\n        (STRPREFIX(cfg->migrationAddress, \"localhost\") ||\n         virSocketAddrIsNumericLocalhost(cfg->migrationAddress))) {\n        virReportError(VIR_ERR_CONF_SYNTAX,\n                       _(\"migration_address must not be the address of\"\n                         \" the local machine: %s\"),\n                       cfg->migrationAddress);\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virutil.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virsocket.h\"",
            "#include \"virfile.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virlog.h\"",
            "#include \"virxml.h\"",
            "#include \"datatypes.h\"",
            "#include \"viralloc.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_firmware.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvirQEMUDriverConfigLoadNetworkEntry(virQEMUDriverConfigPtr cfg,\n                                    virConfPtr conf,\n                                    const char *filename)\n{\n    if (virConfGetValueUInt(conf, \"migration_port_min\", &cfg->migrationPortMin) < 0)\n        return -1;\n    if (cfg->migrationPortMin <= 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: migration_port_min: port must be greater than 0\"),\n                        filename);\n        return -1;\n    }\n\n    if (virConfGetValueUInt(conf, \"migration_port_max\", &cfg->migrationPortMax) < 0)\n        return -1;\n    if (cfg->migrationPortMax > 65535 ||\n        cfg->migrationPortMax < cfg->migrationPortMin) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                        _(\"%s: migration_port_max: port must be between \"\n                          \"the minimal port %d and 65535\"),\n                       filename, cfg->migrationPortMin);\n        return -1;\n    }\n\n    if (virConfGetValueString(conf, \"migration_host\", &cfg->migrateHost) < 0)\n        return -1;\n    virStringStripIPv6Brackets(cfg->migrateHost);\n    if (cfg->migrateHost &&\n        (STRPREFIX(cfg->migrateHost, \"localhost\") ||\n         virSocketAddrIsNumericLocalhost(cfg->migrateHost))) {\n        virReportError(VIR_ERR_CONF_SYNTAX,\n                       _(\"migration_host must not be the address of\"\n                         \" the local machine: %s\"),\n                       cfg->migrateHost);\n        return -1;\n    }\n\n    if (virConfGetValueString(conf, \"migration_address\", &cfg->migrationAddress) < 0)\n        return -1;\n    virStringStripIPv6Brackets(cfg->migrationAddress);\n    if (cfg->migrationAddress &&\n        (STRPREFIX(cfg->migrationAddress, \"localhost\") ||\n         virSocketAddrIsNumericLocalhost(cfg->migrationAddress))) {\n        virReportError(VIR_ERR_CONF_SYNTAX,\n                       _(\"migration_address must not be the address of\"\n                         \" the local machine: %s\"),\n                       cfg->migrationAddress);\n        return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virQEMUDriverConfigLoadRPCEntry",
          "args": [
            "cfg",
            "conf"
          ],
          "line": 1047
        },
        "resolved": true,
        "details": {
          "function_name": "virQEMUDriverConfigLoadRPCEntry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
          "lines": "715-727",
          "snippet": "static int\nvirQEMUDriverConfigLoadRPCEntry(virQEMUDriverConfigPtr cfg,\n                                virConfPtr conf)\n{\n    if (virConfGetValueUInt(conf, \"max_queued\", &cfg->maxQueuedJobs) < 0)\n        return -1;\n    if (virConfGetValueInt(conf, \"keepalive_interval\", &cfg->keepAliveInterval) < 0)\n        return -1;\n    if (virConfGetValueUInt(conf, \"keepalive_count\", &cfg->keepAliveCount) < 0)\n        return -1;\n\n    return 0;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virutil.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virsocket.h\"",
            "#include \"virfile.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virlog.h\"",
            "#include \"virxml.h\"",
            "#include \"datatypes.h\"",
            "#include \"viralloc.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_firmware.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvirQEMUDriverConfigLoadRPCEntry(virQEMUDriverConfigPtr cfg,\n                                virConfPtr conf)\n{\n    if (virConfGetValueUInt(conf, \"max_queued\", &cfg->maxQueuedJobs) < 0)\n        return -1;\n    if (virConfGetValueInt(conf, \"keepalive_interval\", &cfg->keepAliveInterval) < 0)\n        return -1;\n    if (virConfGetValueUInt(conf, \"keepalive_count\", &cfg->keepAliveCount) < 0)\n        return -1;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virQEMUDriverConfigLoadDeviceEntry",
          "args": [
            "cfg",
            "conf"
          ],
          "line": 1044
        },
        "resolved": true,
        "details": {
          "function_name": "virQEMUDriverConfigLoadDeviceEntry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
          "lines": "689-712",
          "snippet": "static int\nvirQEMUDriverConfigLoadDeviceEntry(virQEMUDriverConfigPtr cfg,\n                                   virConfPtr conf)\n{\n    bool tmp;\n    int rv;\n\n    if (virConfGetValueBool(conf, \"mac_filter\", &cfg->macFilter) < 0)\n        return -1;\n\n    if (virConfGetValueBool(conf, \"relaxed_acs_check\", &cfg->relaxedACS) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"lock_manager\", &cfg->lockManagerName) < 0)\n        return -1;\n    if ((rv = virConfGetValueBool(conf, \"allow_disk_format_probing\", &tmp)) < 0)\n        return -1;\n    if (rv == 1 && tmp) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"allow_disk_format_probing is no longer supported\"));\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virutil.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virsocket.h\"",
            "#include \"virfile.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virlog.h\"",
            "#include \"virxml.h\"",
            "#include \"datatypes.h\"",
            "#include \"viralloc.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_firmware.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvirQEMUDriverConfigLoadDeviceEntry(virQEMUDriverConfigPtr cfg,\n                                   virConfPtr conf)\n{\n    bool tmp;\n    int rv;\n\n    if (virConfGetValueBool(conf, \"mac_filter\", &cfg->macFilter) < 0)\n        return -1;\n\n    if (virConfGetValueBool(conf, \"relaxed_acs_check\", &cfg->relaxedACS) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"lock_manager\", &cfg->lockManagerName) < 0)\n        return -1;\n    if ((rv = virConfGetValueBool(conf, \"allow_disk_format_probing\", &tmp)) < 0)\n        return -1;\n    if (rv == 1 && tmp) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"allow_disk_format_probing is no longer supported\"));\n        return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virQEMUDriverConfigLoadProcessEntry",
          "args": [
            "cfg",
            "conf"
          ],
          "line": 1041
        },
        "resolved": true,
        "details": {
          "function_name": "virQEMUDriverConfigLoadProcessEntry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
          "lines": "603-686",
          "snippet": "static int\nvirQEMUDriverConfigLoadProcessEntry(virQEMUDriverConfigPtr cfg,\n                                    virConfPtr conf)\n{\n    VIR_AUTOSTRINGLIST hugetlbfs = NULL;\n    g_autofree char *stdioHandler = NULL;\n    g_autofree char *corestr = NULL;\n    size_t i;\n\n    if (virConfGetValueStringList(conf, \"hugetlbfs_mount\", true,\n                                  &hugetlbfs) < 0)\n        return -1;\n    if (hugetlbfs) {\n        /* There already might be something autodetected. Avoid leaking it. */\n        while (cfg->nhugetlbfs) {\n            cfg->nhugetlbfs--;\n            VIR_FREE(cfg->hugetlbfs[cfg->nhugetlbfs].mnt_dir);\n        }\n        VIR_FREE(cfg->hugetlbfs);\n\n        cfg->nhugetlbfs = virStringListLength((const char *const *)hugetlbfs);\n        if (hugetlbfs[0] &&\n            VIR_ALLOC_N(cfg->hugetlbfs, cfg->nhugetlbfs) < 0)\n            return -1;\n\n        for (i = 0; hugetlbfs[i] != NULL; i++) {\n            if (virQEMUDriverConfigHugeTLBFSInit(&cfg->hugetlbfs[i],\n                                                 hugetlbfs[i], i != 0) < 0)\n                return -1;\n        }\n    }\n\n    if (virConfGetValueString(conf, \"bridge_helper\", &cfg->bridgeHelperName) < 0)\n        return -1;\n\n    if (virConfGetValueString(conf, \"pr_helper\", &cfg->prHelperName) < 0)\n        return -1;\n\n    if (virConfGetValueString(conf, \"slirp_helper\", &cfg->slirpHelperName) < 0)\n        return -1;\n\n    if (virConfGetValueBool(conf, \"set_process_name\", &cfg->setProcessName) < 0)\n        return -1;\n    if (virConfGetValueUInt(conf, \"max_processes\", &cfg->maxProcesses) < 0)\n        return -1;\n    if (virConfGetValueUInt(conf, \"max_files\", &cfg->maxFiles) < 0)\n        return -1;\n    if (virConfGetValueUInt(conf, \"max_threads_per_process\", &cfg->maxThreadsPerProc) < 0)\n        return -1;\n\n    if (virConfGetValueType(conf, \"max_core\") == VIR_CONF_STRING) {\n        if (virConfGetValueString(conf, \"max_core\", &corestr) < 0)\n            return -1;\n        if (STREQ(corestr, \"unlimited\")) {\n            cfg->maxCore = ULLONG_MAX;\n        } else {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                           _(\"Unknown core size '%s'\"),\n                           corestr);\n            return -1;\n        }\n    } else if (virConfGetValueULLong(conf, \"max_core\", &cfg->maxCore) < 0) {\n        return -1;\n    }\n\n    if (virConfGetValueBool(conf, \"dump_guest_core\", &cfg->dumpGuestCore) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"stdio_handler\", &stdioHandler) < 0)\n        return -1;\n    if (stdioHandler) {\n        if (STREQ(stdioHandler, \"logd\")) {\n            cfg->stdioLogD = true;\n        } else if (STREQ(stdioHandler, \"file\")) {\n            cfg->stdioLogD = false;\n        } else {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                           _(\"Unknown stdio handler %s\"),\n                           stdioHandler);\n            return -1;\n        }\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virutil.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virsocket.h\"",
            "#include \"virfile.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virlog.h\"",
            "#include \"virxml.h\"",
            "#include \"datatypes.h\"",
            "#include \"viralloc.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_firmware.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvirQEMUDriverConfigLoadProcessEntry(virQEMUDriverConfigPtr cfg,\n                                    virConfPtr conf)\n{\n    VIR_AUTOSTRINGLIST hugetlbfs = NULL;\n    g_autofree char *stdioHandler = NULL;\n    g_autofree char *corestr = NULL;\n    size_t i;\n\n    if (virConfGetValueStringList(conf, \"hugetlbfs_mount\", true,\n                                  &hugetlbfs) < 0)\n        return -1;\n    if (hugetlbfs) {\n        /* There already might be something autodetected. Avoid leaking it. */\n        while (cfg->nhugetlbfs) {\n            cfg->nhugetlbfs--;\n            VIR_FREE(cfg->hugetlbfs[cfg->nhugetlbfs].mnt_dir);\n        }\n        VIR_FREE(cfg->hugetlbfs);\n\n        cfg->nhugetlbfs = virStringListLength((const char *const *)hugetlbfs);\n        if (hugetlbfs[0] &&\n            VIR_ALLOC_N(cfg->hugetlbfs, cfg->nhugetlbfs) < 0)\n            return -1;\n\n        for (i = 0; hugetlbfs[i] != NULL; i++) {\n            if (virQEMUDriverConfigHugeTLBFSInit(&cfg->hugetlbfs[i],\n                                                 hugetlbfs[i], i != 0) < 0)\n                return -1;\n        }\n    }\n\n    if (virConfGetValueString(conf, \"bridge_helper\", &cfg->bridgeHelperName) < 0)\n        return -1;\n\n    if (virConfGetValueString(conf, \"pr_helper\", &cfg->prHelperName) < 0)\n        return -1;\n\n    if (virConfGetValueString(conf, \"slirp_helper\", &cfg->slirpHelperName) < 0)\n        return -1;\n\n    if (virConfGetValueBool(conf, \"set_process_name\", &cfg->setProcessName) < 0)\n        return -1;\n    if (virConfGetValueUInt(conf, \"max_processes\", &cfg->maxProcesses) < 0)\n        return -1;\n    if (virConfGetValueUInt(conf, \"max_files\", &cfg->maxFiles) < 0)\n        return -1;\n    if (virConfGetValueUInt(conf, \"max_threads_per_process\", &cfg->maxThreadsPerProc) < 0)\n        return -1;\n\n    if (virConfGetValueType(conf, \"max_core\") == VIR_CONF_STRING) {\n        if (virConfGetValueString(conf, \"max_core\", &corestr) < 0)\n            return -1;\n        if (STREQ(corestr, \"unlimited\")) {\n            cfg->maxCore = ULLONG_MAX;\n        } else {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                           _(\"Unknown core size '%s'\"),\n                           corestr);\n            return -1;\n        }\n    } else if (virConfGetValueULLong(conf, \"max_core\", &cfg->maxCore) < 0) {\n        return -1;\n    }\n\n    if (virConfGetValueBool(conf, \"dump_guest_core\", &cfg->dumpGuestCore) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"stdio_handler\", &stdioHandler) < 0)\n        return -1;\n    if (stdioHandler) {\n        if (STREQ(stdioHandler, \"logd\")) {\n            cfg->stdioLogD = true;\n        } else if (STREQ(stdioHandler, \"file\")) {\n            cfg->stdioLogD = false;\n        } else {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                           _(\"Unknown stdio handler %s\"),\n                           stdioHandler);\n            return -1;\n        }\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virQEMUDriverConfigLoadSaveEntry",
          "args": [
            "cfg",
            "conf"
          ],
          "line": 1038
        },
        "resolved": true,
        "details": {
          "function_name": "virQEMUDriverConfigLoadSaveEntry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
          "lines": "582-600",
          "snippet": "static int\nvirQEMUDriverConfigLoadSaveEntry(virQEMUDriverConfigPtr cfg,\n                                 virConfPtr conf)\n{\n    if (virConfGetValueString(conf, \"save_image_format\", &cfg->saveImageFormat) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"dump_image_format\", &cfg->dumpImageFormat) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"snapshot_image_format\", &cfg->snapshotImageFormat) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"auto_dump_path\", &cfg->autoDumpPath) < 0)\n        return -1;\n    if (virConfGetValueBool(conf, \"auto_dump_bypass_cache\", &cfg->autoDumpBypassCache) < 0)\n        return -1;\n    if (virConfGetValueBool(conf, \"auto_start_bypass_cache\", &cfg->autoStartBypassCache) < 0)\n        return -1;\n\n    return 0;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virutil.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virsocket.h\"",
            "#include \"virfile.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virlog.h\"",
            "#include \"virxml.h\"",
            "#include \"datatypes.h\"",
            "#include \"viralloc.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_firmware.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvirQEMUDriverConfigLoadSaveEntry(virQEMUDriverConfigPtr cfg,\n                                 virConfPtr conf)\n{\n    if (virConfGetValueString(conf, \"save_image_format\", &cfg->saveImageFormat) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"dump_image_format\", &cfg->dumpImageFormat) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"snapshot_image_format\", &cfg->snapshotImageFormat) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"auto_dump_path\", &cfg->autoDumpPath) < 0)\n        return -1;\n    if (virConfGetValueBool(conf, \"auto_dump_bypass_cache\", &cfg->autoDumpBypassCache) < 0)\n        return -1;\n    if (virConfGetValueBool(conf, \"auto_start_bypass_cache\", &cfg->autoStartBypassCache) < 0)\n        return -1;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virQEMUDriverConfigLoadRemoteDisplayEntry",
          "args": [
            "cfg",
            "conf",
            "filename"
          ],
          "line": 1035
        },
        "resolved": true,
        "details": {
          "function_name": "virQEMUDriverConfigLoadRemoteDisplayEntry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
          "lines": "511-579",
          "snippet": "static int\nvirQEMUDriverConfigLoadRemoteDisplayEntry(virQEMUDriverConfigPtr cfg,\n                                          virConfPtr conf,\n                                          const char *filename)\n{\n    if (virConfGetValueUInt(conf, \"remote_websocket_port_min\", &cfg->webSocketPortMin) < 0)\n        return -1;\n    if (cfg->webSocketPortMin < QEMU_WEBSOCKET_PORT_MIN) {\n        /* if the port is too low, we can't get the display name\n         * to tell to vnc (usually subtract 5700, e.g. localhost:1\n         * for port 5701) */\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: remote_websocket_port_min: port must be greater \"\n                         \"than or equal to %d\"),\n                        filename, QEMU_WEBSOCKET_PORT_MIN);\n        return -1;\n    }\n\n    if (virConfGetValueUInt(conf, \"remote_websocket_port_max\", &cfg->webSocketPortMax) < 0)\n        return -1;\n    if (cfg->webSocketPortMax > QEMU_WEBSOCKET_PORT_MAX ||\n        cfg->webSocketPortMax < cfg->webSocketPortMin) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                        _(\"%s: remote_websocket_port_max: port must be between \"\n                          \"the minimal port and %d\"),\n                       filename, QEMU_WEBSOCKET_PORT_MAX);\n        return -1;\n    }\n\n    if (cfg->webSocketPortMin > cfg->webSocketPortMax) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                        _(\"%s: remote_websocket_port_min: min port must not be \"\n                          \"greater than max port\"), filename);\n        return -1;\n    }\n\n    if (virConfGetValueUInt(conf, \"remote_display_port_min\", &cfg->remotePortMin) < 0)\n        return -1;\n    if (cfg->remotePortMin < QEMU_REMOTE_PORT_MIN) {\n        /* if the port is too low, we can't get the display name\n         * to tell to vnc (usually subtract 5900, e.g. localhost:1\n         * for port 5901) */\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: remote_display_port_min: port must be greater \"\n                         \"than or equal to %d\"),\n                        filename, QEMU_REMOTE_PORT_MIN);\n        return -1;\n    }\n\n    if (virConfGetValueUInt(conf, \"remote_display_port_max\", &cfg->remotePortMax) < 0)\n        return -1;\n    if (cfg->remotePortMax > QEMU_REMOTE_PORT_MAX ||\n        cfg->remotePortMax < cfg->remotePortMin) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                        _(\"%s: remote_display_port_max: port must be between \"\n                          \"the minimal port and %d\"),\n                       filename, QEMU_REMOTE_PORT_MAX);\n        return -1;\n    }\n\n    if (cfg->remotePortMin > cfg->remotePortMax) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                        _(\"%s: remote_display_port_min: min port must not be \"\n                          \"greater than max port\"), filename);\n        return -1;\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virutil.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virsocket.h\"",
            "#include \"virfile.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virlog.h\"",
            "#include \"virxml.h\"",
            "#include \"datatypes.h\"",
            "#include \"viralloc.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_firmware.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define QEMU_WEBSOCKET_PORT_MAX 65535",
            "#define QEMU_WEBSOCKET_PORT_MIN 5700",
            "#define QEMU_REMOTE_PORT_MAX 65535",
            "#define QEMU_REMOTE_PORT_MIN 5900"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\n#define QEMU_WEBSOCKET_PORT_MAX 65535\n#define QEMU_WEBSOCKET_PORT_MIN 5700\n#define QEMU_REMOTE_PORT_MAX 65535\n#define QEMU_REMOTE_PORT_MIN 5900\n\nstatic int\nvirQEMUDriverConfigLoadRemoteDisplayEntry(virQEMUDriverConfigPtr cfg,\n                                          virConfPtr conf,\n                                          const char *filename)\n{\n    if (virConfGetValueUInt(conf, \"remote_websocket_port_min\", &cfg->webSocketPortMin) < 0)\n        return -1;\n    if (cfg->webSocketPortMin < QEMU_WEBSOCKET_PORT_MIN) {\n        /* if the port is too low, we can't get the display name\n         * to tell to vnc (usually subtract 5700, e.g. localhost:1\n         * for port 5701) */\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: remote_websocket_port_min: port must be greater \"\n                         \"than or equal to %d\"),\n                        filename, QEMU_WEBSOCKET_PORT_MIN);\n        return -1;\n    }\n\n    if (virConfGetValueUInt(conf, \"remote_websocket_port_max\", &cfg->webSocketPortMax) < 0)\n        return -1;\n    if (cfg->webSocketPortMax > QEMU_WEBSOCKET_PORT_MAX ||\n        cfg->webSocketPortMax < cfg->webSocketPortMin) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                        _(\"%s: remote_websocket_port_max: port must be between \"\n                          \"the minimal port and %d\"),\n                       filename, QEMU_WEBSOCKET_PORT_MAX);\n        return -1;\n    }\n\n    if (cfg->webSocketPortMin > cfg->webSocketPortMax) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                        _(\"%s: remote_websocket_port_min: min port must not be \"\n                          \"greater than max port\"), filename);\n        return -1;\n    }\n\n    if (virConfGetValueUInt(conf, \"remote_display_port_min\", &cfg->remotePortMin) < 0)\n        return -1;\n    if (cfg->remotePortMin < QEMU_REMOTE_PORT_MIN) {\n        /* if the port is too low, we can't get the display name\n         * to tell to vnc (usually subtract 5900, e.g. localhost:1\n         * for port 5901) */\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: remote_display_port_min: port must be greater \"\n                         \"than or equal to %d\"),\n                        filename, QEMU_REMOTE_PORT_MIN);\n        return -1;\n    }\n\n    if (virConfGetValueUInt(conf, \"remote_display_port_max\", &cfg->remotePortMax) < 0)\n        return -1;\n    if (cfg->remotePortMax > QEMU_REMOTE_PORT_MAX ||\n        cfg->remotePortMax < cfg->remotePortMin) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                        _(\"%s: remote_display_port_max: port must be between \"\n                          \"the minimal port and %d\"),\n                       filename, QEMU_REMOTE_PORT_MAX);\n        return -1;\n    }\n\n    if (cfg->remotePortMin > cfg->remotePortMax) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                        _(\"%s: remote_display_port_min: min port must not be \"\n                          \"greater than max port\"), filename);\n        return -1;\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virQEMUDriverConfigLoadSpecificTLSEntry",
          "args": [
            "cfg",
            "conf"
          ],
          "line": 1032
        },
        "resolved": true,
        "details": {
          "function_name": "virQEMUDriverConfigLoadSpecificTLSEntry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
          "lines": "469-508",
          "snippet": "static int\nvirQEMUDriverConfigLoadSpecificTLSEntry(virQEMUDriverConfigPtr cfg,\n                                        virConfPtr conf)\n{\n    int rv;\n\n    if (virConfGetValueBool(conf, \"vxhs_tls\", &cfg->vxhsTLS) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"vxhs_tls_x509_cert_dir\", &cfg->vxhsTLSx509certdir) < 0)\n        return -1;\n    if (virConfGetValueBool(conf, \"nbd_tls\", &cfg->nbdTLS) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"nbd_tls_x509_cert_dir\", &cfg->nbdTLSx509certdir) < 0)\n        return -1;\n\n#define GET_CONFIG_TLS_CERTINFO(val) \\\n    do { \\\n        if ((rv = virConfGetValueBool(conf, #val \"_tls_x509_verify\", \\\n                                      &cfg->val## TLSx509verify)) < 0) \\\n            return -1; \\\n        if (rv == 1) \\\n            cfg->val## TLSx509verifyPresent = true; \\\n        if (virConfGetValueString(conf, #val \"_tls_x509_cert_dir\", \\\n                                  &cfg->val## TLSx509certdir) < 0) \\\n            return -1; \\\n        if (virConfGetValueString(conf, \\\n                                  #val \"_tls_x509_secret_uuid\", \\\n                                  &cfg->val## TLSx509secretUUID) < 0) \\\n            return -1; \\\n    } while (0)\n\n    if (virConfGetValueBool(conf, \"chardev_tls\", &cfg->chardevTLS) < 0)\n        return -1;\n    GET_CONFIG_TLS_CERTINFO(chardev);\n\n    GET_CONFIG_TLS_CERTINFO(migrate);\n\n#undef GET_CONFIG_TLS_CERTINFO\n    return 0;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virutil.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virsocket.h\"",
            "#include \"virfile.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virlog.h\"",
            "#include \"virxml.h\"",
            "#include \"datatypes.h\"",
            "#include \"viralloc.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_firmware.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvirQEMUDriverConfigLoadSpecificTLSEntry(virQEMUDriverConfigPtr cfg,\n                                        virConfPtr conf)\n{\n    int rv;\n\n    if (virConfGetValueBool(conf, \"vxhs_tls\", &cfg->vxhsTLS) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"vxhs_tls_x509_cert_dir\", &cfg->vxhsTLSx509certdir) < 0)\n        return -1;\n    if (virConfGetValueBool(conf, \"nbd_tls\", &cfg->nbdTLS) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"nbd_tls_x509_cert_dir\", &cfg->nbdTLSx509certdir) < 0)\n        return -1;\n\n#define GET_CONFIG_TLS_CERTINFO(val) \\\n    do { \\\n        if ((rv = virConfGetValueBool(conf, #val \"_tls_x509_verify\", \\\n                                      &cfg->val## TLSx509verify)) < 0) \\\n            return -1; \\\n        if (rv == 1) \\\n            cfg->val## TLSx509verifyPresent = true; \\\n        if (virConfGetValueString(conf, #val \"_tls_x509_cert_dir\", \\\n                                  &cfg->val## TLSx509certdir) < 0) \\\n            return -1; \\\n        if (virConfGetValueString(conf, \\\n                                  #val \"_tls_x509_secret_uuid\", \\\n                                  &cfg->val## TLSx509secretUUID) < 0) \\\n            return -1; \\\n    } while (0)\n\n    if (virConfGetValueBool(conf, \"chardev_tls\", &cfg->chardevTLS) < 0)\n        return -1;\n    GET_CONFIG_TLS_CERTINFO(chardev);\n\n    GET_CONFIG_TLS_CERTINFO(migrate);\n\n#undef GET_CONFIG_TLS_CERTINFO\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virQEMUDriverConfigLoadSPICEEntry",
          "args": [
            "cfg",
            "conf"
          ],
          "line": 1029
        },
        "resolved": true,
        "details": {
          "function_name": "virQEMUDriverConfigLoadSPICEEntry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
          "lines": "446-466",
          "snippet": "static int\nvirQEMUDriverConfigLoadSPICEEntry(virQEMUDriverConfigPtr cfg,\n                                  virConfPtr conf)\n{\n    if (virConfGetValueBool(conf, \"spice_tls\", &cfg->spiceTLS) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"spice_tls_x509_cert_dir\", &cfg->spiceTLSx509certdir) < 0)\n        return -1;\n    if (virConfGetValueBool(conf, \"spice_sasl\", &cfg->spiceSASL) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"spice_sasl_dir\", &cfg->spiceSASLdir) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"spice_listen\", &cfg->spiceListen) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"spice_password\", &cfg->spicePassword) < 0)\n        return -1;\n    if (virConfGetValueBool(conf, \"spice_auto_unix_socket\", &cfg->spiceAutoUnixSocket) < 0)\n        return -1;\n\n    return 0;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virutil.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virsocket.h\"",
            "#include \"virfile.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virlog.h\"",
            "#include \"virxml.h\"",
            "#include \"datatypes.h\"",
            "#include \"viralloc.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_firmware.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvirQEMUDriverConfigLoadSPICEEntry(virQEMUDriverConfigPtr cfg,\n                                  virConfPtr conf)\n{\n    if (virConfGetValueBool(conf, \"spice_tls\", &cfg->spiceTLS) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"spice_tls_x509_cert_dir\", &cfg->spiceTLSx509certdir) < 0)\n        return -1;\n    if (virConfGetValueBool(conf, \"spice_sasl\", &cfg->spiceSASL) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"spice_sasl_dir\", &cfg->spiceSASLdir) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"spice_listen\", &cfg->spiceListen) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"spice_password\", &cfg->spicePassword) < 0)\n        return -1;\n    if (virConfGetValueBool(conf, \"spice_auto_unix_socket\", &cfg->spiceAutoUnixSocket) < 0)\n        return -1;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virQEMUDriverConfigLoadNographicsEntry",
          "args": [
            "cfg",
            "conf"
          ],
          "line": 1026
        },
        "resolved": true,
        "details": {
          "function_name": "virQEMUDriverConfigLoadNographicsEntry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
          "lines": "438-443",
          "snippet": "static int\nvirQEMUDriverConfigLoadNographicsEntry(virQEMUDriverConfigPtr cfg,\n                                       virConfPtr conf)\n{\n    return virConfGetValueBool(conf, \"nographics_allow_host_audio\", &cfg->nogfxAllowHostAudio);\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virutil.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virsocket.h\"",
            "#include \"virfile.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virlog.h\"",
            "#include \"virxml.h\"",
            "#include \"datatypes.h\"",
            "#include \"viralloc.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_firmware.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvirQEMUDriverConfigLoadNographicsEntry(virQEMUDriverConfigPtr cfg,\n                                       virConfPtr conf)\n{\n    return virConfGetValueBool(conf, \"nographics_allow_host_audio\", &cfg->nogfxAllowHostAudio);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virQEMUDriverConfigLoadVNCEntry",
          "args": [
            "cfg",
            "conf"
          ],
          "line": 1023
        },
        "resolved": true,
        "details": {
          "function_name": "virQEMUDriverConfigLoadVNCEntry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
          "lines": "405-435",
          "snippet": "static int\nvirQEMUDriverConfigLoadVNCEntry(virQEMUDriverConfigPtr cfg,\n                                virConfPtr conf)\n{\n    int rv;\n\n    if (virConfGetValueBool(conf, \"vnc_auto_unix_socket\", &cfg->vncAutoUnixSocket) < 0)\n        return -1;\n    if (virConfGetValueBool(conf, \"vnc_tls\", &cfg->vncTLS) < 0)\n        return -1;\n    if ((rv = virConfGetValueBool(conf, \"vnc_tls_x509_verify\", &cfg->vncTLSx509verify)) < 0)\n        return -1;\n    if (rv == 1)\n        cfg->vncTLSx509verifyPresent = true;\n    if (virConfGetValueString(conf, \"vnc_tls_x509_cert_dir\", &cfg->vncTLSx509certdir) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"vnc_tls_x509_secret_uuid\", &cfg->vncTLSx509secretUUID) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"vnc_listen\", &cfg->vncListen) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"vnc_password\", &cfg->vncPassword) < 0)\n        return -1;\n    if (virConfGetValueBool(conf, \"vnc_sasl\", &cfg->vncSASL) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"vnc_sasl_dir\", &cfg->vncSASLdir) < 0)\n        return -1;\n    if (virConfGetValueBool(conf, \"vnc_allow_host_audio\", &cfg->vncAllowHostAudio) < 0)\n        return -1;\n\n    return 0;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virutil.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virsocket.h\"",
            "#include \"virfile.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virlog.h\"",
            "#include \"virxml.h\"",
            "#include \"datatypes.h\"",
            "#include \"viralloc.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_firmware.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvirQEMUDriverConfigLoadVNCEntry(virQEMUDriverConfigPtr cfg,\n                                virConfPtr conf)\n{\n    int rv;\n\n    if (virConfGetValueBool(conf, \"vnc_auto_unix_socket\", &cfg->vncAutoUnixSocket) < 0)\n        return -1;\n    if (virConfGetValueBool(conf, \"vnc_tls\", &cfg->vncTLS) < 0)\n        return -1;\n    if ((rv = virConfGetValueBool(conf, \"vnc_tls_x509_verify\", &cfg->vncTLSx509verify)) < 0)\n        return -1;\n    if (rv == 1)\n        cfg->vncTLSx509verifyPresent = true;\n    if (virConfGetValueString(conf, \"vnc_tls_x509_cert_dir\", &cfg->vncTLSx509certdir) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"vnc_tls_x509_secret_uuid\", &cfg->vncTLSx509secretUUID) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"vnc_listen\", &cfg->vncListen) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"vnc_password\", &cfg->vncPassword) < 0)\n        return -1;\n    if (virConfGetValueBool(conf, \"vnc_sasl\", &cfg->vncSASL) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"vnc_sasl_dir\", &cfg->vncSASLdir) < 0)\n        return -1;\n    if (virConfGetValueBool(conf, \"vnc_allow_host_audio\", &cfg->vncAllowHostAudio) < 0)\n        return -1;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virQEMUDriverConfigLoadDefaultTLSEntry",
          "args": [
            "cfg",
            "conf"
          ],
          "line": 1020
        },
        "resolved": true,
        "details": {
          "function_name": "virQEMUDriverConfigLoadDefaultTLSEntry",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
          "lines": "386-402",
          "snippet": "static int\nvirQEMUDriverConfigLoadDefaultTLSEntry(virQEMUDriverConfigPtr cfg,\n                                       virConfPtr conf)\n{\n    int rv;\n\n    if ((rv = virConfGetValueString(conf, \"default_tls_x509_cert_dir\", &cfg->defaultTLSx509certdir)) < 0)\n        return -1;\n    cfg->defaultTLSx509certdirPresent = (rv == 1);\n    if (virConfGetValueBool(conf, \"default_tls_x509_verify\", &cfg->defaultTLSx509verify) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"default_tls_x509_secret_uuid\",\n                              &cfg->defaultTLSx509secretUUID) < 0)\n        return -1;\n\n    return 0;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virutil.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virsocket.h\"",
            "#include \"virfile.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virlog.h\"",
            "#include \"virxml.h\"",
            "#include \"datatypes.h\"",
            "#include \"viralloc.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_firmware.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvirQEMUDriverConfigLoadDefaultTLSEntry(virQEMUDriverConfigPtr cfg,\n                                       virConfPtr conf)\n{\n    int rv;\n\n    if ((rv = virConfGetValueString(conf, \"default_tls_x509_cert_dir\", &cfg->defaultTLSx509certdir)) < 0)\n        return -1;\n    cfg->defaultTLSx509certdirPresent = (rv == 1);\n    if (virConfGetValueBool(conf, \"default_tls_x509_verify\", &cfg->defaultTLSx509verify) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"default_tls_x509_secret_uuid\",\n                              &cfg->defaultTLSx509secretUUID) < 0)\n        return -1;\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virConfReadFile",
          "args": [
            "filename",
            "0"
          ],
          "line": 1017
        },
        "resolved": true,
        "details": {
          "function_name": "virConfReadFile",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
          "lines": "730-752",
          "snippet": "virConfPtr\nvirConfReadFile(const char *filename, unsigned int flags)\n{\n    char *content;\n    int len;\n    virConfPtr conf;\n\n    VIR_DEBUG(\"filename=%s\", NULLSTR(filename));\n\n    if (filename == NULL) {\n        virConfError(NULL, VIR_ERR_INVALID_ARG, __FUNCTION__);\n        return NULL;\n    }\n\n    if ((len = virFileReadAll(filename, MAX_CONFIG_FILE_SIZE, &content)) < 0)\n        return NULL;\n\n    conf = virConfParse(filename, content, len, flags);\n\n    VIR_FREE(content);\n\n    return conf;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define MAX_CONFIG_FILE_SIZE (1024*1024*10)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\n#define MAX_CONFIG_FILE_SIZE (1024*1024*10)\n\nvirConfPtr\nvirConfReadFile(const char *filename, unsigned int flags)\n{\n    char *content;\n    int len;\n    virConfPtr conf;\n\n    VIR_DEBUG(\"filename=%s\", NULLSTR(filename));\n\n    if (filename == NULL) {\n        virConfError(NULL, VIR_ERR_INVALID_ARG, __FUNCTION__);\n        return NULL;\n    }\n\n    if ((len = virFileReadAll(filename, MAX_CONFIG_FILE_SIZE, &content)) < 0)\n        return NULL;\n\n    conf = virConfParse(filename, content, len, flags);\n\n    VIR_FREE(content);\n\n    return conf;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_INFO",
          "args": [
            "\"Could not read qemu config file %s\"",
            "filename"
          ],
          "line": 1013
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "access",
          "args": [
            "filename",
            "R_OK"
          ],
          "line": 1012
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nint virQEMUDriverConfigLoadFile(virQEMUDriverConfigPtr cfg,\n                                const char *filename,\n                                bool privileged)\n{\n    g_autoptr(virConf) conf = NULL;\n\n    /* Just check the file is readable before opening it, otherwise\n     * libvirt emits an error.\n     */\n    if (access(filename, R_OK) == -1) {\n        VIR_INFO(\"Could not read qemu config file %s\", filename);\n        return 0;\n    }\n\n    if (!(conf = virConfReadFile(filename, 0)))\n        return -1;\n\n    if (virQEMUDriverConfigLoadDefaultTLSEntry(cfg, conf) < 0)\n        return -1;\n\n    if (virQEMUDriverConfigLoadVNCEntry(cfg, conf) < 0)\n        return -1;\n\n    if (virQEMUDriverConfigLoadNographicsEntry(cfg, conf) < 0)\n        return -1;\n\n    if (virQEMUDriverConfigLoadSPICEEntry(cfg, conf) < 0)\n        return -1;\n\n    if (virQEMUDriverConfigLoadSpecificTLSEntry(cfg, conf) < 0)\n        return -1;\n\n    if (virQEMUDriverConfigLoadRemoteDisplayEntry(cfg, conf, filename) < 0)\n        return -1;\n\n    if (virQEMUDriverConfigLoadSaveEntry(cfg, conf) < 0)\n        return -1;\n\n    if (virQEMUDriverConfigLoadProcessEntry(cfg, conf) < 0)\n        return -1;\n\n    if (virQEMUDriverConfigLoadDeviceEntry(cfg, conf) < 0)\n        return -1;\n\n    if (virQEMUDriverConfigLoadRPCEntry(cfg, conf) < 0)\n        return -1;\n\n    if (virQEMUDriverConfigLoadNetworkEntry(cfg, conf, filename) < 0)\n        return -1;\n\n    if (virQEMUDriverConfigLoadLogEntry(cfg, conf) < 0)\n        return -1;\n\n    if (virQEMUDriverConfigLoadNVRAMEntry(cfg, conf, privileged) < 0)\n        return -1;\n\n    if (virQEMUDriverConfigLoadDebugEntry(cfg, conf) < 0)\n        return -1;\n\n    if (virQEMUDriverConfigLoadSecurityEntry(cfg, conf, privileged) < 0)\n        return -1;\n\n    if (virQEMUDriverConfigLoadMemoryEntry(cfg, conf) < 0)\n        return -1;\n\n    if (virQEMUDriverConfigLoadSWTPMEntry(cfg, conf) < 0)\n        return -1;\n\n    if (virQEMUDriverConfigLoadCapsFiltersEntry(cfg, conf) < 0)\n        return -1;\n\n    return 0;\n}"
  },
  {
    "function_name": "virQEMUDriverConfigLoadCapsFiltersEntry",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
    "lines": "991-1000",
    "snippet": "static int\nvirQEMUDriverConfigLoadCapsFiltersEntry(virQEMUDriverConfigPtr cfg,\n                                        virConfPtr conf)\n{\n    if (virConfGetValueStringList(conf, \"capability_filters\", false,\n                                  &cfg->capabilityfilters) < 0)\n        return -1;\n\n    return 0;\n}",
    "includes": [
      "#include \"configmake.h\"",
      "#include \"virutil.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virstring.h\"",
      "#include \"virsocket.h\"",
      "#include \"virfile.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virlog.h\"",
      "#include \"virxml.h\"",
      "#include \"datatypes.h\"",
      "#include \"viralloc.h\"",
      "#include \"virconf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_firmware.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_capabilities.h\"",
      "#include \"qemu_conf.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virConfGetValueStringList",
          "args": [
            "conf",
            "\"capability_filters\"",
            "false",
            "&cfg->capabilityfilters"
          ],
          "line": 995
        },
        "resolved": true,
        "details": {
          "function_name": "virConfGetValueStringList",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
          "lines": "920-984",
          "snippet": "int virConfGetValueStringList(virConfPtr conf,\n                              const char *setting,\n                              bool compatString,\n                              char ***values)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n    size_t len;\n    virConfValuePtr eval;\n\n    VIR_DEBUG(\"Get value string list %p %d\",\n              cval, cval ? cval->type : VIR_CONF_NONE);\n\n    if (!cval)\n        return 0;\n\n    virStringListFree(*values);\n    *values = NULL;\n\n    switch (cval->type) {\n    case VIR_CONF_LIST:\n        /* Calc length and check items */\n        for (len = 0, eval = cval->list; eval; len++, eval = eval->next) {\n            if (eval->type != VIR_CONF_STRING) {\n                virReportError(VIR_ERR_CONF_SYNTAX,\n                               _(\"%s: expected a string list for '%s' parameter\"),\n                               conf->filename, setting);\n                return -1;\n            }\n        }\n\n        if (VIR_ALLOC_N(*values, len + 1) < 0)\n            return -1;\n\n        for (len = 0, eval = cval->list; eval; len++, eval = eval->next)\n            (*values)[len] = g_strdup(eval->str);\n        break;\n\n    case VIR_CONF_STRING:\n        if (compatString) {\n            if (VIR_ALLOC_N(*values, cval->str ? 2 : 1) < 0)\n                return -1;\n            if (cval->str)\n                (*values)[0] = g_strdup(cval->str);\n            break;\n        }\n        G_GNUC_FALLTHROUGH;\n\n    case VIR_CONF_LLONG:\n    case VIR_CONF_ULLONG:\n    case VIR_CONF_NONE:\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       compatString ?\n                       _(\"%s: expected a string or string list for '%s' parameter\") :\n                       _(\"%s: expected a string list for '%s' parameter\"),\n                       conf->filename, setting);\n        return -1;\n\n    case VIR_CONF_LAST:\n    default:\n        virReportEnumRangeError(virConfType, cval->type);\n        return -1;\n    }\n\n    return 1;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nint virConfGetValueStringList(virConfPtr conf,\n                              const char *setting,\n                              bool compatString,\n                              char ***values)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n    size_t len;\n    virConfValuePtr eval;\n\n    VIR_DEBUG(\"Get value string list %p %d\",\n              cval, cval ? cval->type : VIR_CONF_NONE);\n\n    if (!cval)\n        return 0;\n\n    virStringListFree(*values);\n    *values = NULL;\n\n    switch (cval->type) {\n    case VIR_CONF_LIST:\n        /* Calc length and check items */\n        for (len = 0, eval = cval->list; eval; len++, eval = eval->next) {\n            if (eval->type != VIR_CONF_STRING) {\n                virReportError(VIR_ERR_CONF_SYNTAX,\n                               _(\"%s: expected a string list for '%s' parameter\"),\n                               conf->filename, setting);\n                return -1;\n            }\n        }\n\n        if (VIR_ALLOC_N(*values, len + 1) < 0)\n            return -1;\n\n        for (len = 0, eval = cval->list; eval; len++, eval = eval->next)\n            (*values)[len] = g_strdup(eval->str);\n        break;\n\n    case VIR_CONF_STRING:\n        if (compatString) {\n            if (VIR_ALLOC_N(*values, cval->str ? 2 : 1) < 0)\n                return -1;\n            if (cval->str)\n                (*values)[0] = g_strdup(cval->str);\n            break;\n        }\n        G_GNUC_FALLTHROUGH;\n\n    case VIR_CONF_LLONG:\n    case VIR_CONF_ULLONG:\n    case VIR_CONF_NONE:\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       compatString ?\n                       _(\"%s: expected a string or string list for '%s' parameter\") :\n                       _(\"%s: expected a string list for '%s' parameter\"),\n                       conf->filename, setting);\n        return -1;\n\n    case VIR_CONF_LAST:\n    default:\n        virReportEnumRangeError(virConfType, cval->type);\n        return -1;\n    }\n\n    return 1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvirQEMUDriverConfigLoadCapsFiltersEntry(virQEMUDriverConfigPtr cfg,\n                                        virConfPtr conf)\n{\n    if (virConfGetValueStringList(conf, \"capability_filters\", false,\n                                  &cfg->capabilityfilters) < 0)\n        return -1;\n\n    return 0;\n}"
  },
  {
    "function_name": "virQEMUDriverConfigLoadSWTPMEntry",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
    "lines": "970-988",
    "snippet": "static int\nvirQEMUDriverConfigLoadSWTPMEntry(virQEMUDriverConfigPtr cfg,\n                                  virConfPtr conf)\n{\n    g_autofree char *swtpm_user = NULL;\n    g_autofree char *swtpm_group = NULL;\n\n    if (virConfGetValueString(conf, \"swtpm_user\", &swtpm_user) < 0)\n        return -1;\n    if (swtpm_user && virGetUserID(swtpm_user, &cfg->swtpm_user) < 0)\n        return -1;\n\n    if (virConfGetValueString(conf, \"swtpm_group\", &swtpm_group) < 0)\n        return -1;\n    if (swtpm_group && virGetGroupID(swtpm_group, &cfg->swtpm_group) < 0)\n        return -1;\n\n    return 0;\n}",
    "includes": [
      "#include \"configmake.h\"",
      "#include \"virutil.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virstring.h\"",
      "#include \"virsocket.h\"",
      "#include \"virfile.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virlog.h\"",
      "#include \"virxml.h\"",
      "#include \"datatypes.h\"",
      "#include \"viralloc.h\"",
      "#include \"virconf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_firmware.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_capabilities.h\"",
      "#include \"qemu_conf.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virGetGroupID",
          "args": [
            "swtpm_group",
            "&cfg->swtpm_group"
          ],
          "line": 984
        },
        "resolved": true,
        "details": {
          "function_name": "virGetGroupID",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
          "lines": "1138-1145",
          "snippet": "int virGetGroupID(const char *name G_GNUC_UNUSED,\n                  gid_t *gid G_GNUC_UNUSED)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   \"%s\", _(\"virGetGroupID is not available\"));\n\n    return -1;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <sys/prctl.h>",
            "# include <cap-ng.h>",
            "# include <grp.h>",
            "# include <pwd.h>",
            "# include <libdevmapper.h>",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <conio.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nint virGetGroupID(const char *name G_GNUC_UNUSED,\n                  gid_t *gid G_GNUC_UNUSED)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   \"%s\", _(\"virGetGroupID is not available\"));\n\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virConfGetValueString",
          "args": [
            "conf",
            "\"swtpm_group\"",
            "&swtpm_group"
          ],
          "line": 982
        },
        "resolved": true,
        "details": {
          "function_name": "virConfGetValueString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
          "lines": "875-898",
          "snippet": "int virConfGetValueString(virConfPtr conf,\n                          const char *setting,\n                          char **value)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n\n    VIR_DEBUG(\"Get value string %p %d\",\n              cval, cval ? cval->type : VIR_CONF_NONE);\n\n    if (!cval)\n        return 0;\n\n    if (cval->type != VIR_CONF_STRING) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: expected a string for '%s' parameter\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    VIR_FREE(*value);\n    *value = g_strdup(cval->str);\n\n    return 1;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nint virConfGetValueString(virConfPtr conf,\n                          const char *setting,\n                          char **value)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n\n    VIR_DEBUG(\"Get value string %p %d\",\n              cval, cval ? cval->type : VIR_CONF_NONE);\n\n    if (!cval)\n        return 0;\n\n    if (cval->type != VIR_CONF_STRING) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: expected a string for '%s' parameter\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    VIR_FREE(*value);\n    *value = g_strdup(cval->str);\n\n    return 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virGetUserID",
          "args": [
            "swtpm_user",
            "&cfg->swtpm_user"
          ],
          "line": 979
        },
        "resolved": true,
        "details": {
          "function_name": "virGetUserID",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
          "lines": "1128-1135",
          "snippet": "int virGetUserID(const char *name G_GNUC_UNUSED,\n                 uid_t *uid G_GNUC_UNUSED)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   \"%s\", _(\"virGetUserID is not available\"));\n\n    return -1;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <sys/prctl.h>",
            "# include <cap-ng.h>",
            "# include <grp.h>",
            "# include <pwd.h>",
            "# include <libdevmapper.h>",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <conio.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nint virGetUserID(const char *name G_GNUC_UNUSED,\n                 uid_t *uid G_GNUC_UNUSED)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   \"%s\", _(\"virGetUserID is not available\"));\n\n    return -1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvirQEMUDriverConfigLoadSWTPMEntry(virQEMUDriverConfigPtr cfg,\n                                  virConfPtr conf)\n{\n    g_autofree char *swtpm_user = NULL;\n    g_autofree char *swtpm_group = NULL;\n\n    if (virConfGetValueString(conf, \"swtpm_user\", &swtpm_user) < 0)\n        return -1;\n    if (swtpm_user && virGetUserID(swtpm_user, &cfg->swtpm_user) < 0)\n        return -1;\n\n    if (virConfGetValueString(conf, \"swtpm_group\", &swtpm_group) < 0)\n        return -1;\n    if (swtpm_group && virGetGroupID(swtpm_group, &cfg->swtpm_group) < 0)\n        return -1;\n\n    return 0;\n}"
  },
  {
    "function_name": "virQEMUDriverConfigLoadMemoryEntry",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
    "lines": "962-967",
    "snippet": "static int\nvirQEMUDriverConfigLoadMemoryEntry(virQEMUDriverConfigPtr cfg,\n                                   virConfPtr conf)\n{\n    return virConfGetValueString(conf, \"memory_backing_dir\", &cfg->memoryBackingDir);\n}",
    "includes": [
      "#include \"configmake.h\"",
      "#include \"virutil.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virstring.h\"",
      "#include \"virsocket.h\"",
      "#include \"virfile.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virlog.h\"",
      "#include \"virxml.h\"",
      "#include \"datatypes.h\"",
      "#include \"viralloc.h\"",
      "#include \"virconf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_firmware.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_capabilities.h\"",
      "#include \"qemu_conf.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virConfGetValueString",
          "args": [
            "conf",
            "\"memory_backing_dir\"",
            "&cfg->memoryBackingDir"
          ],
          "line": 966
        },
        "resolved": true,
        "details": {
          "function_name": "virConfGetValueString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
          "lines": "875-898",
          "snippet": "int virConfGetValueString(virConfPtr conf,\n                          const char *setting,\n                          char **value)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n\n    VIR_DEBUG(\"Get value string %p %d\",\n              cval, cval ? cval->type : VIR_CONF_NONE);\n\n    if (!cval)\n        return 0;\n\n    if (cval->type != VIR_CONF_STRING) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: expected a string for '%s' parameter\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    VIR_FREE(*value);\n    *value = g_strdup(cval->str);\n\n    return 1;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nint virConfGetValueString(virConfPtr conf,\n                          const char *setting,\n                          char **value)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n\n    VIR_DEBUG(\"Get value string %p %d\",\n              cval, cval ? cval->type : VIR_CONF_NONE);\n\n    if (!cval)\n        return 0;\n\n    if (cval->type != VIR_CONF_STRING) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: expected a string for '%s' parameter\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    VIR_FREE(*value);\n    *value = g_strdup(cval->str);\n\n    return 1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvirQEMUDriverConfigLoadMemoryEntry(virQEMUDriverConfigPtr cfg,\n                                   virConfPtr conf)\n{\n    return virConfGetValueString(conf, \"memory_backing_dir\", &cfg->memoryBackingDir);\n}"
  },
  {
    "function_name": "virQEMUDriverConfigLoadSecurityEntry",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
    "lines": "848-959",
    "snippet": "static int\nvirQEMUDriverConfigLoadSecurityEntry(virQEMUDriverConfigPtr cfg,\n                                     virConfPtr conf,\n                                     bool privileged)\n{\n    VIR_AUTOSTRINGLIST controllers = NULL;\n    VIR_AUTOSTRINGLIST namespaces = NULL;\n    g_autofree char *user = NULL;\n    g_autofree char *group = NULL;\n    size_t i, j;\n\n    if (virConfGetValueStringList(conf, \"security_driver\", true, &cfg->securityDriverNames) < 0)\n        return -1;\n\n    for (i = 0; cfg->securityDriverNames && cfg->securityDriverNames[i] != NULL; i++) {\n        for (j = i + 1; cfg->securityDriverNames[j] != NULL; j++) {\n            if (STREQ(cfg->securityDriverNames[i],\n                      cfg->securityDriverNames[j])) {\n                virReportError(VIR_ERR_CONF_SYNTAX,\n                               _(\"Duplicate security driver %s\"),\n                               cfg->securityDriverNames[i]);\n                return -1;\n            }\n        }\n    }\n\n    if (virConfGetValueBool(conf, \"security_default_confined\", &cfg->securityDefaultConfined) < 0)\n        return -1;\n    if (virConfGetValueBool(conf, \"security_require_confined\", &cfg->securityRequireConfined) < 0)\n        return -1;\n\n    if (virConfGetValueString(conf, \"user\", &user) < 0)\n        return -1;\n    if (user && virGetUserID(user, &cfg->user) < 0)\n        return -1;\n\n    if (virConfGetValueString(conf, \"group\", &group) < 0)\n        return -1;\n    if (group && virGetGroupID(group, &cfg->group) < 0)\n        return -1;\n\n    if (virConfGetValueBool(conf, \"dynamic_ownership\", &cfg->dynamicOwnership) < 0)\n        return -1;\n\n    if (virConfGetValueBool(conf, \"remember_owner\", &cfg->rememberOwner) < 0)\n        return -1;\n\n    if (virConfGetValueStringList(conf, \"cgroup_controllers\", false,\n                                  &controllers) < 0)\n        return -1;\n\n    if (controllers) {\n        cfg->cgroupControllers = 0;\n        for (i = 0; controllers[i] != NULL; i++) {\n            int ctl;\n            if ((ctl = virCgroupControllerTypeFromString(controllers[i])) < 0) {\n                virReportError(VIR_ERR_CONF_SYNTAX,\n                               _(\"Unknown cgroup controller '%s'\"),\n                               controllers[i]);\n                return -1;\n            }\n            cfg->cgroupControllers |= (1 << ctl);\n        }\n    }\n\n    if (virConfGetValueStringList(conf, \"cgroup_device_acl\", false,\n                                  &cfg->cgroupDeviceACL) < 0)\n        return -1;\n\n    if (virConfGetValueInt(conf, \"seccomp_sandbox\", &cfg->seccompSandbox) < 0)\n        return -1;\n\n    if (virConfGetValueStringList(conf, \"namespaces\", false, &namespaces) < 0)\n        return -1;\n\n    if (namespaces) {\n        virBitmapClearAll(cfg->namespaces);\n\n        for (i = 0; namespaces[i]; i++) {\n            int ns = qemuDomainNamespaceTypeFromString(namespaces[i]);\n\n            if (ns < 0) {\n                virReportError(VIR_ERR_CONF_SYNTAX,\n                               _(\"Unknown namespace: %s\"),\n                               namespaces[i]);\n                return -1;\n            }\n\n            if (!privileged) {\n                virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                               _(\"cannot use namespaces in session mode\"));\n                return -1;\n            }\n\n            if (!qemuDomainNamespaceAvailable(ns)) {\n                virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                               _(\"%s namespace is not available\"),\n                               namespaces[i]);\n                return -1;\n            }\n\n            if (virBitmapSetBit(cfg->namespaces, ns) < 0) {\n                virReportError(VIR_ERR_INTERNAL_ERROR,\n                               _(\"Unable to enable namespace: %s\"),\n                               namespaces[i]);\n                return -1;\n            }\n        }\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"configmake.h\"",
      "#include \"virutil.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virstring.h\"",
      "#include \"virsocket.h\"",
      "#include \"virfile.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virlog.h\"",
      "#include \"virxml.h\"",
      "#include \"datatypes.h\"",
      "#include \"viralloc.h\"",
      "#include \"virconf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_firmware.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_capabilities.h\"",
      "#include \"qemu_conf.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"Unable to enable namespace: %s\")",
            "namespaces[i]"
          ],
          "line": 950
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unable to enable namespace: %s\""
          ],
          "line": 951
        },
        "resolved": true,
        "details": {
          "function_name": "bswap_header",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_driver.c",
          "lines": "2852-2860",
          "snippet": "static inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virenum.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virqemu.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virnuma.h\"",
            "#include \"virperf.h\"",
            "#include \"vircgroup.h\"",
            "#include \"domain_capabilities.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapicheckqemu.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virkeycode.h\"",
            "#include \"locking/domain_lock.h\"",
            "#include \"locking/lock_manager.h\"",
            "#include \"virthreadpool.h\"",
            "#include \"configmake.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virhook.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virxml.h\"",
            "#include \"libvirt_internal.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virusb.h\"",
            "#include \"virpci.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"domain_conf.h\"",
            "#include \"viruuid.h\"",
            "#include \"virarptable.h\"",
            "#include \"viralloc.h\"",
            "#include \"capabilities.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virbuffer.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"qemu_backup.h\"",
            "#include \"qemu_checkpoint.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_blockjob.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_monitor.h\"",
            "#include \"qemu_hotplug.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"qemu_block.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_agent.h\"",
            "#include \"qemu_driver.h\"",
            "#include <sys/ioctl.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <dirent.h>",
            "#include <sys/time.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virenum.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virqemu.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virnuma.h\"\n#include \"virperf.h\"\n#include \"vircgroup.h\"\n#include \"domain_capabilities.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapicheckqemu.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virbitmap.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virnodesuspend.h\"\n#include \"virkeycode.h\"\n#include \"locking/domain_lock.h\"\n#include \"locking/lock_manager.h\"\n#include \"virthreadpool.h\"\n#include \"configmake.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"virhook.h\"\n#include \"domain_nwfilter.h\"\n#include \"virsysinfo.h\"\n#include \"cpu/cpu.h\"\n#include \"virxml.h\"\n#include \"libvirt_internal.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virusb.h\"\n#include \"virpci.h\"\n#include \"node_device_conf.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"domain_conf.h\"\n#include \"viruuid.h\"\n#include \"virarptable.h\"\n#include \"viralloc.h\"\n#include \"capabilities.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevtap.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"qemu_backup.h\"\n#include \"qemu_checkpoint.h\"\n#include \"qemu_security.h\"\n#include \"qemu_blockjob.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_process.h\"\n#include \"qemu_monitor.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_cgroup.h\"\n#include \"qemu_command.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"qemu_block.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_agent.h\"\n#include \"qemu_driver.h\"\n#include <sys/ioctl.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <dirent.h>\n#include <sys/time.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBitmapSetBit",
          "args": [
            "cfg->namespaces",
            "ns"
          ],
          "line": 949
        },
        "resolved": true,
        "details": {
          "function_name": "virBitmapSetBitExpand",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
          "lines": "222-231",
          "snippet": "int\nvirBitmapSetBitExpand(virBitmapPtr bitmap,\n                      size_t b)\n{\n    if (bitmap->nbits <= b && virBitmapExpand(bitmap, b) < 0)\n        return -1;\n\n    bitmap->map[VIR_BITMAP_UNIT_OFFSET(b)] |= VIR_BITMAP_BIT(b);\n    return 0;\n}",
          "includes": [
            "#include \"virerror.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbitmap.h\"",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\nint\nvirBitmapSetBitExpand(virBitmapPtr bitmap,\n                      size_t b)\n{\n    if (bitmap->nbits <= b && virBitmapExpand(bitmap, b) < 0)\n        return -1;\n\n    bitmap->map[VIR_BITMAP_UNIT_OFFSET(b)] |= VIR_BITMAP_BIT(b);\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "_(\"%s namespace is not available\")",
            "namespaces[i]"
          ],
          "line": 943
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qemuDomainNamespaceAvailable",
          "args": [
            "ns"
          ],
          "line": 942
        },
        "resolved": true,
        "details": {
          "function_name": "qemuDomainNamespaceAvailable",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_domain.c",
          "lines": "15352-15378",
          "snippet": "bool\nqemuDomainNamespaceAvailable(qemuDomainNamespace ns G_GNUC_UNUSED)\n{\n#if !defined(__linux__)\n    /* Namespaces are Linux specific. */\n    return false;\n\n#else /* defined(__linux__) */\n\n    switch (ns) {\n    case QEMU_DOMAIN_NS_MOUNT:\n# if !defined(HAVE_SYS_ACL_H) || !defined(WITH_SELINUX)\n        /* We can't create the exact copy of paths if either of\n         * these is not available. */\n        return false;\n# else\n        if (virProcessNamespaceAvailable(VIR_PROCESS_NAMESPACE_MNT) < 0)\n            return false;\n# endif\n        break;\n    case QEMU_DOMAIN_NS_LAST:\n        break;\n    }\n\n    return true;\n#endif /* defined(__linux__) */\n}",
          "includes": [
            "# include <selinux/selinux.h>",
            "# include <sys/mount.h>",
            "#include <fcntl.h>",
            "#include <sys/time.h>",
            "# include <sys/sysmacros.h>",
            "#include \"virdevmapper.h\"",
            "#include \"virutil.h\"",
            "#include \"backup_conf.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"locking/domain_lock.h\"",
            "#include \"logging/log_manager.h\"",
            "#include \"virsecret.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virrandom.h\"",
            "#include \"vircrypto.h\"",
            "#include \"virprocess.h\"",
            "#include \"virthreadjob.h\"",
            "#include \"virstring.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virtime.h\"",
            "#include \"domain_event.h\"",
            "#include \"domain_capabilities.h\"",
            "#include \"domain_addr.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_checkpoint.h\"",
            "#include \"qemu_blockjob.h\"",
            "#include \"qemu_extdevice.h\"",
            "#include \"qemu_slirp.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_dbus.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include \"qemu_block.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <selinux/selinux.h>\n# include <sys/mount.h>\n#include <fcntl.h>\n#include <sys/time.h>\n# include <sys/sysmacros.h>\n#include \"virdevmapper.h\"\n#include \"virutil.h\"\n#include \"backup_conf.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"locking/domain_lock.h\"\n#include \"logging/log_manager.h\"\n#include \"virsecret.h\"\n#include \"virsystemd.h\"\n#include \"virrandom.h\"\n#include \"vircrypto.h\"\n#include \"virprocess.h\"\n#include \"virthreadjob.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virtime.h\"\n#include \"domain_event.h\"\n#include \"domain_capabilities.h\"\n#include \"domain_addr.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"cpu/cpu.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"qemu_checkpoint.h\"\n#include \"qemu_blockjob.h\"\n#include \"qemu_extdevice.h\"\n#include \"qemu_slirp.h\"\n#include \"qemu_security.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_process.h\"\n#include \"qemu_dbus.h\"\n#include \"qemu_command.h\"\n#include \"qemu_cgroup.h\"\n#include \"qemu_block.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include <config.h>\n\nbool\nqemuDomainNamespaceAvailable(qemuDomainNamespace ns G_GNUC_UNUSED)\n{\n#if !defined(__linux__)\n    /* Namespaces are Linux specific. */\n    return false;\n\n#else /* defined(__linux__) */\n\n    switch (ns) {\n    case QEMU_DOMAIN_NS_MOUNT:\n# if !defined(HAVE_SYS_ACL_H) || !defined(WITH_SELINUX)\n        /* We can't create the exact copy of paths if either of\n         * these is not available. */\n        return false;\n# else\n        if (virProcessNamespaceAvailable(VIR_PROCESS_NAMESPACE_MNT) < 0)\n            return false;\n# endif\n        break;\n    case QEMU_DOMAIN_NS_LAST:\n        break;\n    }\n\n    return true;\n#endif /* defined(__linux__) */\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "\"%s\"",
            "_(\"cannot use namespaces in session mode\")"
          ],
          "line": 937
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONF_SYNTAX",
            "_(\"Unknown namespace: %s\")",
            "namespaces[i]"
          ],
          "line": 930
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qemuDomainNamespaceTypeFromString",
          "args": [
            "namespaces[i]"
          ],
          "line": 927
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBitmapClearAll",
          "args": [
            "cfg->namespaces"
          ],
          "line": 924
        },
        "resolved": true,
        "details": {
          "function_name": "virBitmapClearAll",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
          "lines": "915-920",
          "snippet": "void\nvirBitmapClearAll(virBitmapPtr bitmap)\n{\n    memset(bitmap->map, 0,\n           bitmap->map_len * (VIR_BITMAP_BITS_PER_UNIT / CHAR_BIT));\n}",
          "includes": [
            "#include \"virerror.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbitmap.h\"",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [
            "#define VIR_BITMAP_BITS_PER_UNIT  ((int) sizeof(unsigned long) * CHAR_BIT)"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\n#define VIR_BITMAP_BITS_PER_UNIT  ((int) sizeof(unsigned long) * CHAR_BIT)\n\nvoid\nvirBitmapClearAll(virBitmapPtr bitmap)\n{\n    memset(bitmap->map, 0,\n           bitmap->map_len * (VIR_BITMAP_BITS_PER_UNIT / CHAR_BIT));\n}"
        }
      },
      {
        "call_info": {
          "callee": "virConfGetValueStringList",
          "args": [
            "conf",
            "\"namespaces\"",
            "false",
            "&namespaces"
          ],
          "line": 920
        },
        "resolved": true,
        "details": {
          "function_name": "virConfGetValueStringList",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
          "lines": "920-984",
          "snippet": "int virConfGetValueStringList(virConfPtr conf,\n                              const char *setting,\n                              bool compatString,\n                              char ***values)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n    size_t len;\n    virConfValuePtr eval;\n\n    VIR_DEBUG(\"Get value string list %p %d\",\n              cval, cval ? cval->type : VIR_CONF_NONE);\n\n    if (!cval)\n        return 0;\n\n    virStringListFree(*values);\n    *values = NULL;\n\n    switch (cval->type) {\n    case VIR_CONF_LIST:\n        /* Calc length and check items */\n        for (len = 0, eval = cval->list; eval; len++, eval = eval->next) {\n            if (eval->type != VIR_CONF_STRING) {\n                virReportError(VIR_ERR_CONF_SYNTAX,\n                               _(\"%s: expected a string list for '%s' parameter\"),\n                               conf->filename, setting);\n                return -1;\n            }\n        }\n\n        if (VIR_ALLOC_N(*values, len + 1) < 0)\n            return -1;\n\n        for (len = 0, eval = cval->list; eval; len++, eval = eval->next)\n            (*values)[len] = g_strdup(eval->str);\n        break;\n\n    case VIR_CONF_STRING:\n        if (compatString) {\n            if (VIR_ALLOC_N(*values, cval->str ? 2 : 1) < 0)\n                return -1;\n            if (cval->str)\n                (*values)[0] = g_strdup(cval->str);\n            break;\n        }\n        G_GNUC_FALLTHROUGH;\n\n    case VIR_CONF_LLONG:\n    case VIR_CONF_ULLONG:\n    case VIR_CONF_NONE:\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       compatString ?\n                       _(\"%s: expected a string or string list for '%s' parameter\") :\n                       _(\"%s: expected a string list for '%s' parameter\"),\n                       conf->filename, setting);\n        return -1;\n\n    case VIR_CONF_LAST:\n    default:\n        virReportEnumRangeError(virConfType, cval->type);\n        return -1;\n    }\n\n    return 1;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nint virConfGetValueStringList(virConfPtr conf,\n                              const char *setting,\n                              bool compatString,\n                              char ***values)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n    size_t len;\n    virConfValuePtr eval;\n\n    VIR_DEBUG(\"Get value string list %p %d\",\n              cval, cval ? cval->type : VIR_CONF_NONE);\n\n    if (!cval)\n        return 0;\n\n    virStringListFree(*values);\n    *values = NULL;\n\n    switch (cval->type) {\n    case VIR_CONF_LIST:\n        /* Calc length and check items */\n        for (len = 0, eval = cval->list; eval; len++, eval = eval->next) {\n            if (eval->type != VIR_CONF_STRING) {\n                virReportError(VIR_ERR_CONF_SYNTAX,\n                               _(\"%s: expected a string list for '%s' parameter\"),\n                               conf->filename, setting);\n                return -1;\n            }\n        }\n\n        if (VIR_ALLOC_N(*values, len + 1) < 0)\n            return -1;\n\n        for (len = 0, eval = cval->list; eval; len++, eval = eval->next)\n            (*values)[len] = g_strdup(eval->str);\n        break;\n\n    case VIR_CONF_STRING:\n        if (compatString) {\n            if (VIR_ALLOC_N(*values, cval->str ? 2 : 1) < 0)\n                return -1;\n            if (cval->str)\n                (*values)[0] = g_strdup(cval->str);\n            break;\n        }\n        G_GNUC_FALLTHROUGH;\n\n    case VIR_CONF_LLONG:\n    case VIR_CONF_ULLONG:\n    case VIR_CONF_NONE:\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       compatString ?\n                       _(\"%s: expected a string or string list for '%s' parameter\") :\n                       _(\"%s: expected a string list for '%s' parameter\"),\n                       conf->filename, setting);\n        return -1;\n\n    case VIR_CONF_LAST:\n    default:\n        virReportEnumRangeError(virConfType, cval->type);\n        return -1;\n    }\n\n    return 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virConfGetValueInt",
          "args": [
            "conf",
            "\"seccomp_sandbox\"",
            "&cfg->seccompSandbox"
          ],
          "line": 917
        },
        "resolved": true,
        "details": {
          "function_name": "virConfGetValueInt",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
          "lines": "1050-1080",
          "snippet": "int virConfGetValueInt(virConfPtr conf,\n                       const char *setting,\n                       int *value)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n\n    VIR_DEBUG(\"Get value int %p %d\",\n              cval, cval ? cval->type : VIR_CONF_NONE);\n\n    if (!cval)\n        return 0;\n\n    if (cval->type != VIR_CONF_LLONG &&\n        cval->type != VIR_CONF_ULLONG) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: expected a signed integer for '%s' parameter\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    if (cval->l > INT_MAX || cval->l < INT_MIN) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: value for '%s' parameter must be in range %d:%d\"),\n                       conf->filename, setting, INT_MIN, INT_MAX);\n        return -1;\n    }\n\n    *value = (int)cval->l;\n\n    return 1;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nint virConfGetValueInt(virConfPtr conf,\n                       const char *setting,\n                       int *value)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n\n    VIR_DEBUG(\"Get value int %p %d\",\n              cval, cval ? cval->type : VIR_CONF_NONE);\n\n    if (!cval)\n        return 0;\n\n    if (cval->type != VIR_CONF_LLONG &&\n        cval->type != VIR_CONF_ULLONG) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: expected a signed integer for '%s' parameter\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    if (cval->l > INT_MAX || cval->l < INT_MIN) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: value for '%s' parameter must be in range %d:%d\"),\n                       conf->filename, setting, INT_MIN, INT_MAX);\n        return -1;\n    }\n\n    *value = (int)cval->l;\n\n    return 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONF_SYNTAX",
            "_(\"Unknown cgroup controller '%s'\")",
            "controllers[i]"
          ],
          "line": 904
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virCgroupControllerTypeFromString",
          "args": [
            "controllers[i]"
          ],
          "line": 903
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virConfGetValueBool",
          "args": [
            "conf",
            "\"remember_owner\"",
            "&cfg->rememberOwner"
          ],
          "line": 892
        },
        "resolved": true,
        "details": {
          "function_name": "virConfGetValueBool",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
          "lines": "1002-1031",
          "snippet": "int virConfGetValueBool(virConfPtr conf,\n                        const char *setting,\n                        bool *value)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n\n    VIR_DEBUG(\"Get value bool %p %d\",\n              cval, cval ? cval->type : VIR_CONF_NONE);\n\n    if (!cval)\n        return 0;\n\n    if (cval->type != VIR_CONF_ULLONG) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: expected a bool for '%s' parameter\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    if (((unsigned long long)cval->l) > 1) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: value for '%s' parameter must be 0 or 1\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    *value = cval->l == 1;\n\n    return 1;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nint virConfGetValueBool(virConfPtr conf,\n                        const char *setting,\n                        bool *value)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n\n    VIR_DEBUG(\"Get value bool %p %d\",\n              cval, cval ? cval->type : VIR_CONF_NONE);\n\n    if (!cval)\n        return 0;\n\n    if (cval->type != VIR_CONF_ULLONG) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: expected a bool for '%s' parameter\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    if (((unsigned long long)cval->l) > 1) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: value for '%s' parameter must be 0 or 1\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    *value = cval->l == 1;\n\n    return 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virGetGroupID",
          "args": [
            "group",
            "&cfg->group"
          ],
          "line": 886
        },
        "resolved": true,
        "details": {
          "function_name": "virGetGroupID",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
          "lines": "1138-1145",
          "snippet": "int virGetGroupID(const char *name G_GNUC_UNUSED,\n                  gid_t *gid G_GNUC_UNUSED)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   \"%s\", _(\"virGetGroupID is not available\"));\n\n    return -1;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <sys/prctl.h>",
            "# include <cap-ng.h>",
            "# include <grp.h>",
            "# include <pwd.h>",
            "# include <libdevmapper.h>",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <conio.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nint virGetGroupID(const char *name G_GNUC_UNUSED,\n                  gid_t *gid G_GNUC_UNUSED)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   \"%s\", _(\"virGetGroupID is not available\"));\n\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virConfGetValueString",
          "args": [
            "conf",
            "\"group\"",
            "&group"
          ],
          "line": 884
        },
        "resolved": true,
        "details": {
          "function_name": "virConfGetValueString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
          "lines": "875-898",
          "snippet": "int virConfGetValueString(virConfPtr conf,\n                          const char *setting,\n                          char **value)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n\n    VIR_DEBUG(\"Get value string %p %d\",\n              cval, cval ? cval->type : VIR_CONF_NONE);\n\n    if (!cval)\n        return 0;\n\n    if (cval->type != VIR_CONF_STRING) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: expected a string for '%s' parameter\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    VIR_FREE(*value);\n    *value = g_strdup(cval->str);\n\n    return 1;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nint virConfGetValueString(virConfPtr conf,\n                          const char *setting,\n                          char **value)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n\n    VIR_DEBUG(\"Get value string %p %d\",\n              cval, cval ? cval->type : VIR_CONF_NONE);\n\n    if (!cval)\n        return 0;\n\n    if (cval->type != VIR_CONF_STRING) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: expected a string for '%s' parameter\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    VIR_FREE(*value);\n    *value = g_strdup(cval->str);\n\n    return 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virGetUserID",
          "args": [
            "user",
            "&cfg->user"
          ],
          "line": 881
        },
        "resolved": true,
        "details": {
          "function_name": "virGetUserID",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
          "lines": "1128-1135",
          "snippet": "int virGetUserID(const char *name G_GNUC_UNUSED,\n                 uid_t *uid G_GNUC_UNUSED)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   \"%s\", _(\"virGetUserID is not available\"));\n\n    return -1;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <sys/prctl.h>",
            "# include <cap-ng.h>",
            "# include <grp.h>",
            "# include <pwd.h>",
            "# include <libdevmapper.h>",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <conio.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nint virGetUserID(const char *name G_GNUC_UNUSED,\n                 uid_t *uid G_GNUC_UNUSED)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   \"%s\", _(\"virGetUserID is not available\"));\n\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONF_SYNTAX",
            "_(\"Duplicate security driver %s\")",
            "cfg->securityDriverNames[i]"
          ],
          "line": 866
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "cfg->securityDriverNames[i]",
            "cfg->securityDriverNames[j]"
          ],
          "line": 864
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvirQEMUDriverConfigLoadSecurityEntry(virQEMUDriverConfigPtr cfg,\n                                     virConfPtr conf,\n                                     bool privileged)\n{\n    VIR_AUTOSTRINGLIST controllers = NULL;\n    VIR_AUTOSTRINGLIST namespaces = NULL;\n    g_autofree char *user = NULL;\n    g_autofree char *group = NULL;\n    size_t i, j;\n\n    if (virConfGetValueStringList(conf, \"security_driver\", true, &cfg->securityDriverNames) < 0)\n        return -1;\n\n    for (i = 0; cfg->securityDriverNames && cfg->securityDriverNames[i] != NULL; i++) {\n        for (j = i + 1; cfg->securityDriverNames[j] != NULL; j++) {\n            if (STREQ(cfg->securityDriverNames[i],\n                      cfg->securityDriverNames[j])) {\n                virReportError(VIR_ERR_CONF_SYNTAX,\n                               _(\"Duplicate security driver %s\"),\n                               cfg->securityDriverNames[i]);\n                return -1;\n            }\n        }\n    }\n\n    if (virConfGetValueBool(conf, \"security_default_confined\", &cfg->securityDefaultConfined) < 0)\n        return -1;\n    if (virConfGetValueBool(conf, \"security_require_confined\", &cfg->securityRequireConfined) < 0)\n        return -1;\n\n    if (virConfGetValueString(conf, \"user\", &user) < 0)\n        return -1;\n    if (user && virGetUserID(user, &cfg->user) < 0)\n        return -1;\n\n    if (virConfGetValueString(conf, \"group\", &group) < 0)\n        return -1;\n    if (group && virGetGroupID(group, &cfg->group) < 0)\n        return -1;\n\n    if (virConfGetValueBool(conf, \"dynamic_ownership\", &cfg->dynamicOwnership) < 0)\n        return -1;\n\n    if (virConfGetValueBool(conf, \"remember_owner\", &cfg->rememberOwner) < 0)\n        return -1;\n\n    if (virConfGetValueStringList(conf, \"cgroup_controllers\", false,\n                                  &controllers) < 0)\n        return -1;\n\n    if (controllers) {\n        cfg->cgroupControllers = 0;\n        for (i = 0; controllers[i] != NULL; i++) {\n            int ctl;\n            if ((ctl = virCgroupControllerTypeFromString(controllers[i])) < 0) {\n                virReportError(VIR_ERR_CONF_SYNTAX,\n                               _(\"Unknown cgroup controller '%s'\"),\n                               controllers[i]);\n                return -1;\n            }\n            cfg->cgroupControllers |= (1 << ctl);\n        }\n    }\n\n    if (virConfGetValueStringList(conf, \"cgroup_device_acl\", false,\n                                  &cfg->cgroupDeviceACL) < 0)\n        return -1;\n\n    if (virConfGetValueInt(conf, \"seccomp_sandbox\", &cfg->seccompSandbox) < 0)\n        return -1;\n\n    if (virConfGetValueStringList(conf, \"namespaces\", false, &namespaces) < 0)\n        return -1;\n\n    if (namespaces) {\n        virBitmapClearAll(cfg->namespaces);\n\n        for (i = 0; namespaces[i]; i++) {\n            int ns = qemuDomainNamespaceTypeFromString(namespaces[i]);\n\n            if (ns < 0) {\n                virReportError(VIR_ERR_CONF_SYNTAX,\n                               _(\"Unknown namespace: %s\"),\n                               namespaces[i]);\n                return -1;\n            }\n\n            if (!privileged) {\n                virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                               _(\"cannot use namespaces in session mode\"));\n                return -1;\n            }\n\n            if (!qemuDomainNamespaceAvailable(ns)) {\n                virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                               _(\"%s namespace is not available\"),\n                               namespaces[i]);\n                return -1;\n            }\n\n            if (virBitmapSetBit(cfg->namespaces, ns) < 0) {\n                virReportError(VIR_ERR_INTERNAL_ERROR,\n                               _(\"Unable to enable namespace: %s\"),\n                               namespaces[i]);\n                return -1;\n            }\n        }\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virQEMUDriverConfigLoadDebugEntry",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
    "lines": "835-845",
    "snippet": "static int\nvirQEMUDriverConfigLoadDebugEntry(virQEMUDriverConfigPtr cfg,\n                                  virConfPtr conf)\n{\n    if (virConfGetValueUInt(conf, \"gluster_debug_level\", &cfg->glusterDebugLevel) < 0)\n        return -1;\n    if (virConfGetValueBool(conf, \"virtiofsd_debug\", &cfg->virtiofsdDebug) < 0)\n        return -1;\n\n    return 0;\n}",
    "includes": [
      "#include \"configmake.h\"",
      "#include \"virutil.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virstring.h\"",
      "#include \"virsocket.h\"",
      "#include \"virfile.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virlog.h\"",
      "#include \"virxml.h\"",
      "#include \"datatypes.h\"",
      "#include \"viralloc.h\"",
      "#include \"virconf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_firmware.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_capabilities.h\"",
      "#include \"qemu_conf.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virConfGetValueBool",
          "args": [
            "conf",
            "\"virtiofsd_debug\"",
            "&cfg->virtiofsdDebug"
          ],
          "line": 841
        },
        "resolved": true,
        "details": {
          "function_name": "virConfGetValueBool",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
          "lines": "1002-1031",
          "snippet": "int virConfGetValueBool(virConfPtr conf,\n                        const char *setting,\n                        bool *value)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n\n    VIR_DEBUG(\"Get value bool %p %d\",\n              cval, cval ? cval->type : VIR_CONF_NONE);\n\n    if (!cval)\n        return 0;\n\n    if (cval->type != VIR_CONF_ULLONG) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: expected a bool for '%s' parameter\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    if (((unsigned long long)cval->l) > 1) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: value for '%s' parameter must be 0 or 1\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    *value = cval->l == 1;\n\n    return 1;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nint virConfGetValueBool(virConfPtr conf,\n                        const char *setting,\n                        bool *value)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n\n    VIR_DEBUG(\"Get value bool %p %d\",\n              cval, cval ? cval->type : VIR_CONF_NONE);\n\n    if (!cval)\n        return 0;\n\n    if (cval->type != VIR_CONF_ULLONG) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: expected a bool for '%s' parameter\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    if (((unsigned long long)cval->l) > 1) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: value for '%s' parameter must be 0 or 1\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    *value = cval->l == 1;\n\n    return 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virConfGetValueUInt",
          "args": [
            "conf",
            "\"gluster_debug_level\"",
            "&cfg->glusterDebugLevel"
          ],
          "line": 839
        },
        "resolved": true,
        "details": {
          "function_name": "virConfGetValueUInt",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
          "lines": "1099-1128",
          "snippet": "int virConfGetValueUInt(virConfPtr conf,\n                        const char *setting,\n                        unsigned int *value)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n\n    VIR_DEBUG(\"Get value uint %p %d\",\n              cval, cval ? cval->type : VIR_CONF_NONE);\n\n    if (!cval)\n        return 0;\n\n    if (cval->type != VIR_CONF_ULLONG) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: expected an unsigned integer for '%s' parameter\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    if (((unsigned long long)cval->l) > UINT_MAX) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: value for '%s' parameter must be in range 0:%u\"),\n                       conf->filename, setting, UINT_MAX);\n        return -1;\n    }\n\n    *value = (unsigned int)cval->l;\n\n    return 1;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nint virConfGetValueUInt(virConfPtr conf,\n                        const char *setting,\n                        unsigned int *value)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n\n    VIR_DEBUG(\"Get value uint %p %d\",\n              cval, cval ? cval->type : VIR_CONF_NONE);\n\n    if (!cval)\n        return 0;\n\n    if (cval->type != VIR_CONF_ULLONG) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: expected an unsigned integer for '%s' parameter\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    if (((unsigned long long)cval->l) > UINT_MAX) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: value for '%s' parameter must be in range 0:%u\"),\n                       conf->filename, setting, UINT_MAX);\n        return -1;\n    }\n\n    *value = (unsigned int)cval->l;\n\n    return 1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvirQEMUDriverConfigLoadDebugEntry(virQEMUDriverConfigPtr cfg,\n                                  virConfPtr conf)\n{\n    if (virConfGetValueUInt(conf, \"gluster_debug_level\", &cfg->glusterDebugLevel) < 0)\n        return -1;\n    if (virConfGetValueBool(conf, \"virtiofsd_debug\", &cfg->virtiofsdDebug) < 0)\n        return -1;\n\n    return 0;\n}"
  },
  {
    "function_name": "virQEMUDriverConfigLoadNVRAMEntry",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
    "lines": "793-832",
    "snippet": "static int\nvirQEMUDriverConfigLoadNVRAMEntry(virQEMUDriverConfigPtr cfg,\n                                  virConfPtr conf,\n                                  bool privileged)\n{\n    VIR_AUTOSTRINGLIST nvram = NULL;\n    size_t i;\n\n    if (virConfGetValueStringList(conf, \"nvram\", false, &nvram) < 0)\n        return -1;\n    if (nvram) {\n        VIR_AUTOSTRINGLIST fwList = NULL;\n\n        virFirmwareFreeList(cfg->firmwares, cfg->nfirmwares);\n\n        if (qemuFirmwareFetchConfigs(&fwList, privileged) < 0)\n            return -1;\n\n        if (fwList) {\n            VIR_WARN(\"Obsolete nvram variable is set while firmware metadata \"\n                     \"files found. Note that the nvram config file variable is \"\n                     \"going to be ignored.\");\n            cfg->nfirmwares = 0;\n            return 0;\n        }\n\n        cfg->nfirmwares = virStringListLength((const char *const *)nvram);\n        if (nvram[0] && VIR_ALLOC_N(cfg->firmwares, cfg->nfirmwares) < 0)\n            return -1;\n\n        for (i = 0; nvram[i] != NULL; i++) {\n            if (VIR_ALLOC(cfg->firmwares[i]) < 0)\n                return -1;\n            if (virFirmwareParse(nvram[i], cfg->firmwares[i]) < 0)\n                return -1;\n        }\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"configmake.h\"",
      "#include \"virutil.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virstring.h\"",
      "#include \"virsocket.h\"",
      "#include \"virfile.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virlog.h\"",
      "#include \"virxml.h\"",
      "#include \"datatypes.h\"",
      "#include \"viralloc.h\"",
      "#include \"virconf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_firmware.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_capabilities.h\"",
      "#include \"qemu_conf.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virFirmwareParse",
          "args": [
            "nvram[i]",
            "cfg->firmwares[i]"
          ],
          "line": 826
        },
        "resolved": true,
        "details": {
          "function_name": "virFirmwareParse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfirmware.c",
          "lines": "58-89",
          "snippet": "int\nvirFirmwareParse(const char *str, virFirmwarePtr firmware)\n{\n    int ret = -1;\n    char **token;\n\n    if (!(token = virStringSplit(str, \":\", 0)))\n        goto cleanup;\n\n    if (token[0]) {\n        virSkipSpaces((const char **) &token[0]);\n        if (token[1])\n            virSkipSpaces((const char **) &token[1]);\n    }\n\n    /* Exactly two tokens are expected */\n    if (!token[0] || !token[1] || token[2] ||\n        STREQ(token[0], \"\") || STREQ(token[1], \"\")) {\n        virReportError(VIR_ERR_CONF_SYNTAX,\n                       _(\"Invalid nvram format: '%s'\"),\n                       str);\n        goto cleanup;\n    }\n\n    firmware->name = g_strdup(token[0]);\n    firmware->nvram = g_strdup(token[1]);\n\n    ret = 0;\n cleanup:\n    virStringListFree(token);\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfirmware.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfirmware.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <config.h>\n\nint\nvirFirmwareParse(const char *str, virFirmwarePtr firmware)\n{\n    int ret = -1;\n    char **token;\n\n    if (!(token = virStringSplit(str, \":\", 0)))\n        goto cleanup;\n\n    if (token[0]) {\n        virSkipSpaces((const char **) &token[0]);\n        if (token[1])\n            virSkipSpaces((const char **) &token[1]);\n    }\n\n    /* Exactly two tokens are expected */\n    if (!token[0] || !token[1] || token[2] ||\n        STREQ(token[0], \"\") || STREQ(token[1], \"\")) {\n        virReportError(VIR_ERR_CONF_SYNTAX,\n                       _(\"Invalid nvram format: '%s'\"),\n                       str);\n        goto cleanup;\n    }\n\n    firmware->name = g_strdup(token[0]);\n    firmware->nvram = g_strdup(token[1]);\n\n    ret = 0;\n cleanup:\n    virStringListFree(token);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC",
          "args": [
            "cfg->firmwares[i]"
          ],
          "line": 824
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC_N",
          "args": [
            "cfg->firmwares",
            "cfg->nfirmwares"
          ],
          "line": 820
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStringListLength",
          "args": [
            "(const char *const *)nvram"
          ],
          "line": 819
        },
        "resolved": true,
        "details": {
          "function_name": "virStringListLength",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "893-901",
          "snippet": "size_t virStringListLength(const char * const *strings)\n{\n    size_t i = 0;\n\n    while (strings && strings[i])\n        i++;\n\n    return i;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nsize_t virStringListLength(const char * const *strings)\n{\n    size_t i = 0;\n\n    while (strings && strings[i])\n        i++;\n\n    return i;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_WARN",
          "args": [
            "\"Obsolete nvram variable is set while firmware metadata \"\n                     \"files found. Note that the nvram config file variable is \"\n                     \"going to be ignored.\""
          ],
          "line": 812
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qemuFirmwareFetchConfigs",
          "args": [
            "&fwList",
            "privileged"
          ],
          "line": 808
        },
        "resolved": true,
        "details": {
          "function_name": "qemuFirmwareFetchConfigs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_firmware.c",
          "lines": "884-889",
          "snippet": "int\nqemuFirmwareFetchConfigs(char ***firmwares,\n                         bool privileged)\n{\n    return qemuInteropFetchConfigs(\"firmware\", firmwares, privileged);\n}",
          "includes": [
            "#include \"virenum.h\"",
            "#include \"viralloc.h\"",
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virjson.h\"",
            "#include \"virarch.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"configmake.h\"",
            "#include \"qemu_interop_config.h\"",
            "#include \"qemu_firmware.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virenum.h\"\n#include \"viralloc.h\"\n#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virjson.h\"\n#include \"virarch.h\"\n#include \"qemu_process.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"configmake.h\"\n#include \"qemu_interop_config.h\"\n#include \"qemu_firmware.h\"\n#include <config.h>\n\nint\nqemuFirmwareFetchConfigs(char ***firmwares,\n                         bool privileged)\n{\n    return qemuInteropFetchConfigs(\"firmware\", firmwares, privileged);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virFirmwareFreeList",
          "args": [
            "cfg->firmwares",
            "cfg->nfirmwares"
          ],
          "line": 806
        },
        "resolved": true,
        "details": {
          "function_name": "virFirmwareFreeList",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfirmware.c",
          "lines": "46-55",
          "snippet": "void\nvirFirmwareFreeList(virFirmwarePtr *firmwares, size_t nfirmwares)\n{\n    size_t i;\n\n    for (i = 0; i < nfirmwares; i++)\n        virFirmwareFree(firmwares[i]);\n\n    VIR_FREE(firmwares);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfirmware.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfirmware.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <config.h>\n\nvoid\nvirFirmwareFreeList(virFirmwarePtr *firmwares, size_t nfirmwares)\n{\n    size_t i;\n\n    for (i = 0; i < nfirmwares; i++)\n        virFirmwareFree(firmwares[i]);\n\n    VIR_FREE(firmwares);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virConfGetValueStringList",
          "args": [
            "conf",
            "\"nvram\"",
            "false",
            "&nvram"
          ],
          "line": 801
        },
        "resolved": true,
        "details": {
          "function_name": "virConfGetValueStringList",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
          "lines": "920-984",
          "snippet": "int virConfGetValueStringList(virConfPtr conf,\n                              const char *setting,\n                              bool compatString,\n                              char ***values)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n    size_t len;\n    virConfValuePtr eval;\n\n    VIR_DEBUG(\"Get value string list %p %d\",\n              cval, cval ? cval->type : VIR_CONF_NONE);\n\n    if (!cval)\n        return 0;\n\n    virStringListFree(*values);\n    *values = NULL;\n\n    switch (cval->type) {\n    case VIR_CONF_LIST:\n        /* Calc length and check items */\n        for (len = 0, eval = cval->list; eval; len++, eval = eval->next) {\n            if (eval->type != VIR_CONF_STRING) {\n                virReportError(VIR_ERR_CONF_SYNTAX,\n                               _(\"%s: expected a string list for '%s' parameter\"),\n                               conf->filename, setting);\n                return -1;\n            }\n        }\n\n        if (VIR_ALLOC_N(*values, len + 1) < 0)\n            return -1;\n\n        for (len = 0, eval = cval->list; eval; len++, eval = eval->next)\n            (*values)[len] = g_strdup(eval->str);\n        break;\n\n    case VIR_CONF_STRING:\n        if (compatString) {\n            if (VIR_ALLOC_N(*values, cval->str ? 2 : 1) < 0)\n                return -1;\n            if (cval->str)\n                (*values)[0] = g_strdup(cval->str);\n            break;\n        }\n        G_GNUC_FALLTHROUGH;\n\n    case VIR_CONF_LLONG:\n    case VIR_CONF_ULLONG:\n    case VIR_CONF_NONE:\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       compatString ?\n                       _(\"%s: expected a string or string list for '%s' parameter\") :\n                       _(\"%s: expected a string list for '%s' parameter\"),\n                       conf->filename, setting);\n        return -1;\n\n    case VIR_CONF_LAST:\n    default:\n        virReportEnumRangeError(virConfType, cval->type);\n        return -1;\n    }\n\n    return 1;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nint virConfGetValueStringList(virConfPtr conf,\n                              const char *setting,\n                              bool compatString,\n                              char ***values)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n    size_t len;\n    virConfValuePtr eval;\n\n    VIR_DEBUG(\"Get value string list %p %d\",\n              cval, cval ? cval->type : VIR_CONF_NONE);\n\n    if (!cval)\n        return 0;\n\n    virStringListFree(*values);\n    *values = NULL;\n\n    switch (cval->type) {\n    case VIR_CONF_LIST:\n        /* Calc length and check items */\n        for (len = 0, eval = cval->list; eval; len++, eval = eval->next) {\n            if (eval->type != VIR_CONF_STRING) {\n                virReportError(VIR_ERR_CONF_SYNTAX,\n                               _(\"%s: expected a string list for '%s' parameter\"),\n                               conf->filename, setting);\n                return -1;\n            }\n        }\n\n        if (VIR_ALLOC_N(*values, len + 1) < 0)\n            return -1;\n\n        for (len = 0, eval = cval->list; eval; len++, eval = eval->next)\n            (*values)[len] = g_strdup(eval->str);\n        break;\n\n    case VIR_CONF_STRING:\n        if (compatString) {\n            if (VIR_ALLOC_N(*values, cval->str ? 2 : 1) < 0)\n                return -1;\n            if (cval->str)\n                (*values)[0] = g_strdup(cval->str);\n            break;\n        }\n        G_GNUC_FALLTHROUGH;\n\n    case VIR_CONF_LLONG:\n    case VIR_CONF_ULLONG:\n    case VIR_CONF_NONE:\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       compatString ?\n                       _(\"%s: expected a string or string list for '%s' parameter\") :\n                       _(\"%s: expected a string list for '%s' parameter\"),\n                       conf->filename, setting);\n        return -1;\n\n    case VIR_CONF_LAST:\n    default:\n        virReportEnumRangeError(virConfType, cval->type);\n        return -1;\n    }\n\n    return 1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvirQEMUDriverConfigLoadNVRAMEntry(virQEMUDriverConfigPtr cfg,\n                                  virConfPtr conf,\n                                  bool privileged)\n{\n    VIR_AUTOSTRINGLIST nvram = NULL;\n    size_t i;\n\n    if (virConfGetValueStringList(conf, \"nvram\", false, &nvram) < 0)\n        return -1;\n    if (nvram) {\n        VIR_AUTOSTRINGLIST fwList = NULL;\n\n        virFirmwareFreeList(cfg->firmwares, cfg->nfirmwares);\n\n        if (qemuFirmwareFetchConfigs(&fwList, privileged) < 0)\n            return -1;\n\n        if (fwList) {\n            VIR_WARN(\"Obsolete nvram variable is set while firmware metadata \"\n                     \"files found. Note that the nvram config file variable is \"\n                     \"going to be ignored.\");\n            cfg->nfirmwares = 0;\n            return 0;\n        }\n\n        cfg->nfirmwares = virStringListLength((const char *const *)nvram);\n        if (nvram[0] && VIR_ALLOC_N(cfg->firmwares, cfg->nfirmwares) < 0)\n            return -1;\n\n        for (i = 0; nvram[i] != NULL; i++) {\n            if (VIR_ALLOC(cfg->firmwares[i]) < 0)\n                return -1;\n            if (virFirmwareParse(nvram[i], cfg->firmwares[i]) < 0)\n                return -1;\n        }\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virQEMUDriverConfigLoadLogEntry",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
    "lines": "785-790",
    "snippet": "static int\nvirQEMUDriverConfigLoadLogEntry(virQEMUDriverConfigPtr cfg,\n                                virConfPtr conf)\n{\n    return virConfGetValueBool(conf, \"log_timestamp\", &cfg->logTimestamp);\n}",
    "includes": [
      "#include \"configmake.h\"",
      "#include \"virutil.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virstring.h\"",
      "#include \"virsocket.h\"",
      "#include \"virfile.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virlog.h\"",
      "#include \"virxml.h\"",
      "#include \"datatypes.h\"",
      "#include \"viralloc.h\"",
      "#include \"virconf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_firmware.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_capabilities.h\"",
      "#include \"qemu_conf.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virConfGetValueBool",
          "args": [
            "conf",
            "\"log_timestamp\"",
            "&cfg->logTimestamp"
          ],
          "line": 789
        },
        "resolved": true,
        "details": {
          "function_name": "virConfGetValueBool",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
          "lines": "1002-1031",
          "snippet": "int virConfGetValueBool(virConfPtr conf,\n                        const char *setting,\n                        bool *value)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n\n    VIR_DEBUG(\"Get value bool %p %d\",\n              cval, cval ? cval->type : VIR_CONF_NONE);\n\n    if (!cval)\n        return 0;\n\n    if (cval->type != VIR_CONF_ULLONG) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: expected a bool for '%s' parameter\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    if (((unsigned long long)cval->l) > 1) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: value for '%s' parameter must be 0 or 1\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    *value = cval->l == 1;\n\n    return 1;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nint virConfGetValueBool(virConfPtr conf,\n                        const char *setting,\n                        bool *value)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n\n    VIR_DEBUG(\"Get value bool %p %d\",\n              cval, cval ? cval->type : VIR_CONF_NONE);\n\n    if (!cval)\n        return 0;\n\n    if (cval->type != VIR_CONF_ULLONG) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: expected a bool for '%s' parameter\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    if (((unsigned long long)cval->l) > 1) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: value for '%s' parameter must be 0 or 1\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    *value = cval->l == 1;\n\n    return 1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvirQEMUDriverConfigLoadLogEntry(virQEMUDriverConfigPtr cfg,\n                                virConfPtr conf)\n{\n    return virConfGetValueBool(conf, \"log_timestamp\", &cfg->logTimestamp);\n}"
  },
  {
    "function_name": "virQEMUDriverConfigLoadNetworkEntry",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
    "lines": "730-782",
    "snippet": "static int\nvirQEMUDriverConfigLoadNetworkEntry(virQEMUDriverConfigPtr cfg,\n                                    virConfPtr conf,\n                                    const char *filename)\n{\n    if (virConfGetValueUInt(conf, \"migration_port_min\", &cfg->migrationPortMin) < 0)\n        return -1;\n    if (cfg->migrationPortMin <= 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: migration_port_min: port must be greater than 0\"),\n                        filename);\n        return -1;\n    }\n\n    if (virConfGetValueUInt(conf, \"migration_port_max\", &cfg->migrationPortMax) < 0)\n        return -1;\n    if (cfg->migrationPortMax > 65535 ||\n        cfg->migrationPortMax < cfg->migrationPortMin) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                        _(\"%s: migration_port_max: port must be between \"\n                          \"the minimal port %d and 65535\"),\n                       filename, cfg->migrationPortMin);\n        return -1;\n    }\n\n    if (virConfGetValueString(conf, \"migration_host\", &cfg->migrateHost) < 0)\n        return -1;\n    virStringStripIPv6Brackets(cfg->migrateHost);\n    if (cfg->migrateHost &&\n        (STRPREFIX(cfg->migrateHost, \"localhost\") ||\n         virSocketAddrIsNumericLocalhost(cfg->migrateHost))) {\n        virReportError(VIR_ERR_CONF_SYNTAX,\n                       _(\"migration_host must not be the address of\"\n                         \" the local machine: %s\"),\n                       cfg->migrateHost);\n        return -1;\n    }\n\n    if (virConfGetValueString(conf, \"migration_address\", &cfg->migrationAddress) < 0)\n        return -1;\n    virStringStripIPv6Brackets(cfg->migrationAddress);\n    if (cfg->migrationAddress &&\n        (STRPREFIX(cfg->migrationAddress, \"localhost\") ||\n         virSocketAddrIsNumericLocalhost(cfg->migrationAddress))) {\n        virReportError(VIR_ERR_CONF_SYNTAX,\n                       _(\"migration_address must not be the address of\"\n                         \" the local machine: %s\"),\n                       cfg->migrationAddress);\n        return -1;\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"configmake.h\"",
      "#include \"virutil.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virstring.h\"",
      "#include \"virsocket.h\"",
      "#include \"virfile.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virlog.h\"",
      "#include \"virxml.h\"",
      "#include \"datatypes.h\"",
      "#include \"viralloc.h\"",
      "#include \"virconf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_firmware.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_capabilities.h\"",
      "#include \"qemu_conf.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONF_SYNTAX",
            "_(\"migration_address must not be the address of\"\n                         \" the local machine: %s\")",
            "cfg->migrationAddress"
          ],
          "line": 774
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"migration_address must not be the address of\"\n                         \" the local machine: %s\""
          ],
          "line": 775
        },
        "resolved": true,
        "details": {
          "function_name": "bswap_header",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_driver.c",
          "lines": "2852-2860",
          "snippet": "static inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virenum.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virqemu.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virnuma.h\"",
            "#include \"virperf.h\"",
            "#include \"vircgroup.h\"",
            "#include \"domain_capabilities.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapicheckqemu.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virkeycode.h\"",
            "#include \"locking/domain_lock.h\"",
            "#include \"locking/lock_manager.h\"",
            "#include \"virthreadpool.h\"",
            "#include \"configmake.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virhook.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virxml.h\"",
            "#include \"libvirt_internal.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virusb.h\"",
            "#include \"virpci.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"domain_conf.h\"",
            "#include \"viruuid.h\"",
            "#include \"virarptable.h\"",
            "#include \"viralloc.h\"",
            "#include \"capabilities.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virbuffer.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"qemu_backup.h\"",
            "#include \"qemu_checkpoint.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_blockjob.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_monitor.h\"",
            "#include \"qemu_hotplug.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"qemu_block.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_agent.h\"",
            "#include \"qemu_driver.h\"",
            "#include <sys/ioctl.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <dirent.h>",
            "#include <sys/time.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virenum.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virqemu.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virnuma.h\"\n#include \"virperf.h\"\n#include \"vircgroup.h\"\n#include \"domain_capabilities.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapicheckqemu.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virbitmap.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virnodesuspend.h\"\n#include \"virkeycode.h\"\n#include \"locking/domain_lock.h\"\n#include \"locking/lock_manager.h\"\n#include \"virthreadpool.h\"\n#include \"configmake.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"virhook.h\"\n#include \"domain_nwfilter.h\"\n#include \"virsysinfo.h\"\n#include \"cpu/cpu.h\"\n#include \"virxml.h\"\n#include \"libvirt_internal.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virusb.h\"\n#include \"virpci.h\"\n#include \"node_device_conf.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"domain_conf.h\"\n#include \"viruuid.h\"\n#include \"virarptable.h\"\n#include \"viralloc.h\"\n#include \"capabilities.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevtap.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"qemu_backup.h\"\n#include \"qemu_checkpoint.h\"\n#include \"qemu_security.h\"\n#include \"qemu_blockjob.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_process.h\"\n#include \"qemu_monitor.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_cgroup.h\"\n#include \"qemu_command.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"qemu_block.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_agent.h\"\n#include \"qemu_driver.h\"\n#include <sys/ioctl.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <dirent.h>\n#include <sys/time.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virSocketAddrIsNumericLocalhost",
          "args": [
            "cfg->migrationAddress"
          ],
          "line": 773
        },
        "resolved": true,
        "details": {
          "function_name": "virSocketAddrIsNumericLocalhost",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virsocketaddr.c",
          "lines": "1232-1250",
          "snippet": "bool\nvirSocketAddrIsNumericLocalhost(const char *addr)\n{\n    virSocketAddr res;\n    struct in_addr tmp = { .s_addr = htonl(INADDR_LOOPBACK) };\n\n    if (virSocketAddrParse(&res, addr, AF_UNSPEC) < 0)\n        return false;\n\n    switch (res.data.stor.ss_family) {\n    case AF_INET:\n        return memcmp(&res.data.inet4.sin_addr.s_addr, &tmp.s_addr,\n                      sizeof(res.data.inet4.sin_addr.s_addr)) == 0;\n    case AF_INET6:\n        return IN6_IS_ADDR_LOOPBACK(&res.data.inet6.sin6_addr);\n    }\n\n    return false;\n}",
          "includes": [
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virstring.h\"",
            "#include \"virerror.h\"",
            "#include \"virsocketaddr.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virstring.h\"\n#include \"virerror.h\"\n#include \"virsocketaddr.h\"\n#include <config.h>\n\nbool\nvirSocketAddrIsNumericLocalhost(const char *addr)\n{\n    virSocketAddr res;\n    struct in_addr tmp = { .s_addr = htonl(INADDR_LOOPBACK) };\n\n    if (virSocketAddrParse(&res, addr, AF_UNSPEC) < 0)\n        return false;\n\n    switch (res.data.stor.ss_family) {\n    case AF_INET:\n        return memcmp(&res.data.inet4.sin_addr.s_addr, &tmp.s_addr,\n                      sizeof(res.data.inet4.sin_addr.s_addr)) == 0;\n    case AF_INET6:\n        return IN6_IS_ADDR_LOOPBACK(&res.data.inet6.sin6_addr);\n    }\n\n    return false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "STRPREFIX",
          "args": [
            "cfg->migrationAddress",
            "\"localhost\""
          ],
          "line": 772
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStringStripIPv6Brackets",
          "args": [
            "cfg->migrationAddress"
          ],
          "line": 770
        },
        "resolved": true,
        "details": {
          "function_name": "virStringStripIPv6Brackets",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "1165-1178",
          "snippet": "void\nvirStringStripIPv6Brackets(char *str)\n{\n    size_t len;\n\n    if (!str)\n        return;\n\n    len = strlen(str);\n    if (str[0] == '[' && str[len - 1] == ']' && strchr(str, ':')) {\n        memmove(&str[0], &str[1], len - 2);\n        str[len - 2] = '\\0';\n    }\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nvoid\nvirStringStripIPv6Brackets(char *str)\n{\n    size_t len;\n\n    if (!str)\n        return;\n\n    len = strlen(str);\n    if (str[0] == '[' && str[len - 1] == ']' && strchr(str, ':')) {\n        memmove(&str[0], &str[1], len - 2);\n        str[len - 2] = '\\0';\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "virConfGetValueString",
          "args": [
            "conf",
            "\"migration_address\"",
            "&cfg->migrationAddress"
          ],
          "line": 768
        },
        "resolved": true,
        "details": {
          "function_name": "virConfGetValueString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
          "lines": "875-898",
          "snippet": "int virConfGetValueString(virConfPtr conf,\n                          const char *setting,\n                          char **value)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n\n    VIR_DEBUG(\"Get value string %p %d\",\n              cval, cval ? cval->type : VIR_CONF_NONE);\n\n    if (!cval)\n        return 0;\n\n    if (cval->type != VIR_CONF_STRING) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: expected a string for '%s' parameter\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    VIR_FREE(*value);\n    *value = g_strdup(cval->str);\n\n    return 1;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nint virConfGetValueString(virConfPtr conf,\n                          const char *setting,\n                          char **value)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n\n    VIR_DEBUG(\"Get value string %p %d\",\n              cval, cval ? cval->type : VIR_CONF_NONE);\n\n    if (!cval)\n        return 0;\n\n    if (cval->type != VIR_CONF_STRING) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: expected a string for '%s' parameter\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    VIR_FREE(*value);\n    *value = g_strdup(cval->str);\n\n    return 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONF_SYNTAX",
            "_(\"migration_host must not be the address of\"\n                         \" the local machine: %s\")",
            "cfg->migrateHost"
          ],
          "line": 761
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STRPREFIX",
          "args": [
            "cfg->migrateHost",
            "\"localhost\""
          ],
          "line": 759
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"%s: migration_port_max: port must be between \"\n                          \"the minimal port %d and 65535\")",
            "filename",
            "cfg->migrationPortMin"
          ],
          "line": 748
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virConfGetValueUInt",
          "args": [
            "conf",
            "\"migration_port_max\"",
            "&cfg->migrationPortMax"
          ],
          "line": 744
        },
        "resolved": true,
        "details": {
          "function_name": "virConfGetValueUInt",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
          "lines": "1099-1128",
          "snippet": "int virConfGetValueUInt(virConfPtr conf,\n                        const char *setting,\n                        unsigned int *value)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n\n    VIR_DEBUG(\"Get value uint %p %d\",\n              cval, cval ? cval->type : VIR_CONF_NONE);\n\n    if (!cval)\n        return 0;\n\n    if (cval->type != VIR_CONF_ULLONG) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: expected an unsigned integer for '%s' parameter\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    if (((unsigned long long)cval->l) > UINT_MAX) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: value for '%s' parameter must be in range 0:%u\"),\n                       conf->filename, setting, UINT_MAX);\n        return -1;\n    }\n\n    *value = (unsigned int)cval->l;\n\n    return 1;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nint virConfGetValueUInt(virConfPtr conf,\n                        const char *setting,\n                        unsigned int *value)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n\n    VIR_DEBUG(\"Get value uint %p %d\",\n              cval, cval ? cval->type : VIR_CONF_NONE);\n\n    if (!cval)\n        return 0;\n\n    if (cval->type != VIR_CONF_ULLONG) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: expected an unsigned integer for '%s' parameter\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    if (((unsigned long long)cval->l) > UINT_MAX) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: value for '%s' parameter must be in range 0:%u\"),\n                       conf->filename, setting, UINT_MAX);\n        return -1;\n    }\n\n    *value = (unsigned int)cval->l;\n\n    return 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"%s: migration_port_min: port must be greater than 0\")",
            "filename"
          ],
          "line": 738
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvirQEMUDriverConfigLoadNetworkEntry(virQEMUDriverConfigPtr cfg,\n                                    virConfPtr conf,\n                                    const char *filename)\n{\n    if (virConfGetValueUInt(conf, \"migration_port_min\", &cfg->migrationPortMin) < 0)\n        return -1;\n    if (cfg->migrationPortMin <= 0) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: migration_port_min: port must be greater than 0\"),\n                        filename);\n        return -1;\n    }\n\n    if (virConfGetValueUInt(conf, \"migration_port_max\", &cfg->migrationPortMax) < 0)\n        return -1;\n    if (cfg->migrationPortMax > 65535 ||\n        cfg->migrationPortMax < cfg->migrationPortMin) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                        _(\"%s: migration_port_max: port must be between \"\n                          \"the minimal port %d and 65535\"),\n                       filename, cfg->migrationPortMin);\n        return -1;\n    }\n\n    if (virConfGetValueString(conf, \"migration_host\", &cfg->migrateHost) < 0)\n        return -1;\n    virStringStripIPv6Brackets(cfg->migrateHost);\n    if (cfg->migrateHost &&\n        (STRPREFIX(cfg->migrateHost, \"localhost\") ||\n         virSocketAddrIsNumericLocalhost(cfg->migrateHost))) {\n        virReportError(VIR_ERR_CONF_SYNTAX,\n                       _(\"migration_host must not be the address of\"\n                         \" the local machine: %s\"),\n                       cfg->migrateHost);\n        return -1;\n    }\n\n    if (virConfGetValueString(conf, \"migration_address\", &cfg->migrationAddress) < 0)\n        return -1;\n    virStringStripIPv6Brackets(cfg->migrationAddress);\n    if (cfg->migrationAddress &&\n        (STRPREFIX(cfg->migrationAddress, \"localhost\") ||\n         virSocketAddrIsNumericLocalhost(cfg->migrationAddress))) {\n        virReportError(VIR_ERR_CONF_SYNTAX,\n                       _(\"migration_address must not be the address of\"\n                         \" the local machine: %s\"),\n                       cfg->migrationAddress);\n        return -1;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virQEMUDriverConfigLoadRPCEntry",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
    "lines": "715-727",
    "snippet": "static int\nvirQEMUDriverConfigLoadRPCEntry(virQEMUDriverConfigPtr cfg,\n                                virConfPtr conf)\n{\n    if (virConfGetValueUInt(conf, \"max_queued\", &cfg->maxQueuedJobs) < 0)\n        return -1;\n    if (virConfGetValueInt(conf, \"keepalive_interval\", &cfg->keepAliveInterval) < 0)\n        return -1;\n    if (virConfGetValueUInt(conf, \"keepalive_count\", &cfg->keepAliveCount) < 0)\n        return -1;\n\n    return 0;\n}",
    "includes": [
      "#include \"configmake.h\"",
      "#include \"virutil.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virstring.h\"",
      "#include \"virsocket.h\"",
      "#include \"virfile.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virlog.h\"",
      "#include \"virxml.h\"",
      "#include \"datatypes.h\"",
      "#include \"viralloc.h\"",
      "#include \"virconf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_firmware.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_capabilities.h\"",
      "#include \"qemu_conf.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virConfGetValueUInt",
          "args": [
            "conf",
            "\"keepalive_count\"",
            "&cfg->keepAliveCount"
          ],
          "line": 723
        },
        "resolved": true,
        "details": {
          "function_name": "virConfGetValueUInt",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
          "lines": "1099-1128",
          "snippet": "int virConfGetValueUInt(virConfPtr conf,\n                        const char *setting,\n                        unsigned int *value)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n\n    VIR_DEBUG(\"Get value uint %p %d\",\n              cval, cval ? cval->type : VIR_CONF_NONE);\n\n    if (!cval)\n        return 0;\n\n    if (cval->type != VIR_CONF_ULLONG) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: expected an unsigned integer for '%s' parameter\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    if (((unsigned long long)cval->l) > UINT_MAX) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: value for '%s' parameter must be in range 0:%u\"),\n                       conf->filename, setting, UINT_MAX);\n        return -1;\n    }\n\n    *value = (unsigned int)cval->l;\n\n    return 1;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nint virConfGetValueUInt(virConfPtr conf,\n                        const char *setting,\n                        unsigned int *value)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n\n    VIR_DEBUG(\"Get value uint %p %d\",\n              cval, cval ? cval->type : VIR_CONF_NONE);\n\n    if (!cval)\n        return 0;\n\n    if (cval->type != VIR_CONF_ULLONG) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: expected an unsigned integer for '%s' parameter\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    if (((unsigned long long)cval->l) > UINT_MAX) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: value for '%s' parameter must be in range 0:%u\"),\n                       conf->filename, setting, UINT_MAX);\n        return -1;\n    }\n\n    *value = (unsigned int)cval->l;\n\n    return 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virConfGetValueInt",
          "args": [
            "conf",
            "\"keepalive_interval\"",
            "&cfg->keepAliveInterval"
          ],
          "line": 721
        },
        "resolved": true,
        "details": {
          "function_name": "virConfGetValueInt",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
          "lines": "1050-1080",
          "snippet": "int virConfGetValueInt(virConfPtr conf,\n                       const char *setting,\n                       int *value)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n\n    VIR_DEBUG(\"Get value int %p %d\",\n              cval, cval ? cval->type : VIR_CONF_NONE);\n\n    if (!cval)\n        return 0;\n\n    if (cval->type != VIR_CONF_LLONG &&\n        cval->type != VIR_CONF_ULLONG) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: expected a signed integer for '%s' parameter\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    if (cval->l > INT_MAX || cval->l < INT_MIN) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: value for '%s' parameter must be in range %d:%d\"),\n                       conf->filename, setting, INT_MIN, INT_MAX);\n        return -1;\n    }\n\n    *value = (int)cval->l;\n\n    return 1;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nint virConfGetValueInt(virConfPtr conf,\n                       const char *setting,\n                       int *value)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n\n    VIR_DEBUG(\"Get value int %p %d\",\n              cval, cval ? cval->type : VIR_CONF_NONE);\n\n    if (!cval)\n        return 0;\n\n    if (cval->type != VIR_CONF_LLONG &&\n        cval->type != VIR_CONF_ULLONG) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: expected a signed integer for '%s' parameter\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    if (cval->l > INT_MAX || cval->l < INT_MIN) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: value for '%s' parameter must be in range %d:%d\"),\n                       conf->filename, setting, INT_MIN, INT_MAX);\n        return -1;\n    }\n\n    *value = (int)cval->l;\n\n    return 1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvirQEMUDriverConfigLoadRPCEntry(virQEMUDriverConfigPtr cfg,\n                                virConfPtr conf)\n{\n    if (virConfGetValueUInt(conf, \"max_queued\", &cfg->maxQueuedJobs) < 0)\n        return -1;\n    if (virConfGetValueInt(conf, \"keepalive_interval\", &cfg->keepAliveInterval) < 0)\n        return -1;\n    if (virConfGetValueUInt(conf, \"keepalive_count\", &cfg->keepAliveCount) < 0)\n        return -1;\n\n    return 0;\n}"
  },
  {
    "function_name": "virQEMUDriverConfigLoadDeviceEntry",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
    "lines": "689-712",
    "snippet": "static int\nvirQEMUDriverConfigLoadDeviceEntry(virQEMUDriverConfigPtr cfg,\n                                   virConfPtr conf)\n{\n    bool tmp;\n    int rv;\n\n    if (virConfGetValueBool(conf, \"mac_filter\", &cfg->macFilter) < 0)\n        return -1;\n\n    if (virConfGetValueBool(conf, \"relaxed_acs_check\", &cfg->relaxedACS) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"lock_manager\", &cfg->lockManagerName) < 0)\n        return -1;\n    if ((rv = virConfGetValueBool(conf, \"allow_disk_format_probing\", &tmp)) < 0)\n        return -1;\n    if (rv == 1 && tmp) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"allow_disk_format_probing is no longer supported\"));\n        return -1;\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"configmake.h\"",
      "#include \"virutil.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virstring.h\"",
      "#include \"virsocket.h\"",
      "#include \"virfile.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virlog.h\"",
      "#include \"virxml.h\"",
      "#include \"datatypes.h\"",
      "#include \"viralloc.h\"",
      "#include \"virconf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_firmware.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_capabilities.h\"",
      "#include \"qemu_conf.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "\"%s\"",
            "_(\"allow_disk_format_probing is no longer supported\")"
          ],
          "line": 706
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"allow_disk_format_probing is no longer supported\""
          ],
          "line": 707
        },
        "resolved": true,
        "details": {
          "function_name": "bswap_header",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_driver.c",
          "lines": "2852-2860",
          "snippet": "static inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virenum.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virqemu.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virnuma.h\"",
            "#include \"virperf.h\"",
            "#include \"vircgroup.h\"",
            "#include \"domain_capabilities.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapicheckqemu.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virkeycode.h\"",
            "#include \"locking/domain_lock.h\"",
            "#include \"locking/lock_manager.h\"",
            "#include \"virthreadpool.h\"",
            "#include \"configmake.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virhook.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virxml.h\"",
            "#include \"libvirt_internal.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virusb.h\"",
            "#include \"virpci.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"domain_conf.h\"",
            "#include \"viruuid.h\"",
            "#include \"virarptable.h\"",
            "#include \"viralloc.h\"",
            "#include \"capabilities.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virbuffer.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"qemu_backup.h\"",
            "#include \"qemu_checkpoint.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_blockjob.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_monitor.h\"",
            "#include \"qemu_hotplug.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"qemu_block.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_agent.h\"",
            "#include \"qemu_driver.h\"",
            "#include <sys/ioctl.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <dirent.h>",
            "#include <sys/time.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virenum.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virqemu.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virnuma.h\"\n#include \"virperf.h\"\n#include \"vircgroup.h\"\n#include \"domain_capabilities.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapicheckqemu.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virbitmap.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virnodesuspend.h\"\n#include \"virkeycode.h\"\n#include \"locking/domain_lock.h\"\n#include \"locking/lock_manager.h\"\n#include \"virthreadpool.h\"\n#include \"configmake.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"virhook.h\"\n#include \"domain_nwfilter.h\"\n#include \"virsysinfo.h\"\n#include \"cpu/cpu.h\"\n#include \"virxml.h\"\n#include \"libvirt_internal.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virusb.h\"\n#include \"virpci.h\"\n#include \"node_device_conf.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"domain_conf.h\"\n#include \"viruuid.h\"\n#include \"virarptable.h\"\n#include \"viralloc.h\"\n#include \"capabilities.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevtap.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"qemu_backup.h\"\n#include \"qemu_checkpoint.h\"\n#include \"qemu_security.h\"\n#include \"qemu_blockjob.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_process.h\"\n#include \"qemu_monitor.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_cgroup.h\"\n#include \"qemu_command.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"qemu_block.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_agent.h\"\n#include \"qemu_driver.h\"\n#include <sys/ioctl.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <dirent.h>\n#include <sys/time.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virConfGetValueBool",
          "args": [
            "conf",
            "\"allow_disk_format_probing\"",
            "&tmp"
          ],
          "line": 703
        },
        "resolved": true,
        "details": {
          "function_name": "virConfGetValueBool",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
          "lines": "1002-1031",
          "snippet": "int virConfGetValueBool(virConfPtr conf,\n                        const char *setting,\n                        bool *value)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n\n    VIR_DEBUG(\"Get value bool %p %d\",\n              cval, cval ? cval->type : VIR_CONF_NONE);\n\n    if (!cval)\n        return 0;\n\n    if (cval->type != VIR_CONF_ULLONG) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: expected a bool for '%s' parameter\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    if (((unsigned long long)cval->l) > 1) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: value for '%s' parameter must be 0 or 1\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    *value = cval->l == 1;\n\n    return 1;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nint virConfGetValueBool(virConfPtr conf,\n                        const char *setting,\n                        bool *value)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n\n    VIR_DEBUG(\"Get value bool %p %d\",\n              cval, cval ? cval->type : VIR_CONF_NONE);\n\n    if (!cval)\n        return 0;\n\n    if (cval->type != VIR_CONF_ULLONG) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: expected a bool for '%s' parameter\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    if (((unsigned long long)cval->l) > 1) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: value for '%s' parameter must be 0 or 1\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    *value = cval->l == 1;\n\n    return 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virConfGetValueString",
          "args": [
            "conf",
            "\"lock_manager\"",
            "&cfg->lockManagerName"
          ],
          "line": 701
        },
        "resolved": true,
        "details": {
          "function_name": "virConfGetValueString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
          "lines": "875-898",
          "snippet": "int virConfGetValueString(virConfPtr conf,\n                          const char *setting,\n                          char **value)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n\n    VIR_DEBUG(\"Get value string %p %d\",\n              cval, cval ? cval->type : VIR_CONF_NONE);\n\n    if (!cval)\n        return 0;\n\n    if (cval->type != VIR_CONF_STRING) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: expected a string for '%s' parameter\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    VIR_FREE(*value);\n    *value = g_strdup(cval->str);\n\n    return 1;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nint virConfGetValueString(virConfPtr conf,\n                          const char *setting,\n                          char **value)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n\n    VIR_DEBUG(\"Get value string %p %d\",\n              cval, cval ? cval->type : VIR_CONF_NONE);\n\n    if (!cval)\n        return 0;\n\n    if (cval->type != VIR_CONF_STRING) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: expected a string for '%s' parameter\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    VIR_FREE(*value);\n    *value = g_strdup(cval->str);\n\n    return 1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvirQEMUDriverConfigLoadDeviceEntry(virQEMUDriverConfigPtr cfg,\n                                   virConfPtr conf)\n{\n    bool tmp;\n    int rv;\n\n    if (virConfGetValueBool(conf, \"mac_filter\", &cfg->macFilter) < 0)\n        return -1;\n\n    if (virConfGetValueBool(conf, \"relaxed_acs_check\", &cfg->relaxedACS) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"lock_manager\", &cfg->lockManagerName) < 0)\n        return -1;\n    if ((rv = virConfGetValueBool(conf, \"allow_disk_format_probing\", &tmp)) < 0)\n        return -1;\n    if (rv == 1 && tmp) {\n        virReportError(VIR_ERR_CONFIG_UNSUPPORTED, \"%s\",\n                       _(\"allow_disk_format_probing is no longer supported\"));\n        return -1;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virQEMUDriverConfigLoadProcessEntry",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
    "lines": "603-686",
    "snippet": "static int\nvirQEMUDriverConfigLoadProcessEntry(virQEMUDriverConfigPtr cfg,\n                                    virConfPtr conf)\n{\n    VIR_AUTOSTRINGLIST hugetlbfs = NULL;\n    g_autofree char *stdioHandler = NULL;\n    g_autofree char *corestr = NULL;\n    size_t i;\n\n    if (virConfGetValueStringList(conf, \"hugetlbfs_mount\", true,\n                                  &hugetlbfs) < 0)\n        return -1;\n    if (hugetlbfs) {\n        /* There already might be something autodetected. Avoid leaking it. */\n        while (cfg->nhugetlbfs) {\n            cfg->nhugetlbfs--;\n            VIR_FREE(cfg->hugetlbfs[cfg->nhugetlbfs].mnt_dir);\n        }\n        VIR_FREE(cfg->hugetlbfs);\n\n        cfg->nhugetlbfs = virStringListLength((const char *const *)hugetlbfs);\n        if (hugetlbfs[0] &&\n            VIR_ALLOC_N(cfg->hugetlbfs, cfg->nhugetlbfs) < 0)\n            return -1;\n\n        for (i = 0; hugetlbfs[i] != NULL; i++) {\n            if (virQEMUDriverConfigHugeTLBFSInit(&cfg->hugetlbfs[i],\n                                                 hugetlbfs[i], i != 0) < 0)\n                return -1;\n        }\n    }\n\n    if (virConfGetValueString(conf, \"bridge_helper\", &cfg->bridgeHelperName) < 0)\n        return -1;\n\n    if (virConfGetValueString(conf, \"pr_helper\", &cfg->prHelperName) < 0)\n        return -1;\n\n    if (virConfGetValueString(conf, \"slirp_helper\", &cfg->slirpHelperName) < 0)\n        return -1;\n\n    if (virConfGetValueBool(conf, \"set_process_name\", &cfg->setProcessName) < 0)\n        return -1;\n    if (virConfGetValueUInt(conf, \"max_processes\", &cfg->maxProcesses) < 0)\n        return -1;\n    if (virConfGetValueUInt(conf, \"max_files\", &cfg->maxFiles) < 0)\n        return -1;\n    if (virConfGetValueUInt(conf, \"max_threads_per_process\", &cfg->maxThreadsPerProc) < 0)\n        return -1;\n\n    if (virConfGetValueType(conf, \"max_core\") == VIR_CONF_STRING) {\n        if (virConfGetValueString(conf, \"max_core\", &corestr) < 0)\n            return -1;\n        if (STREQ(corestr, \"unlimited\")) {\n            cfg->maxCore = ULLONG_MAX;\n        } else {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                           _(\"Unknown core size '%s'\"),\n                           corestr);\n            return -1;\n        }\n    } else if (virConfGetValueULLong(conf, \"max_core\", &cfg->maxCore) < 0) {\n        return -1;\n    }\n\n    if (virConfGetValueBool(conf, \"dump_guest_core\", &cfg->dumpGuestCore) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"stdio_handler\", &stdioHandler) < 0)\n        return -1;\n    if (stdioHandler) {\n        if (STREQ(stdioHandler, \"logd\")) {\n            cfg->stdioLogD = true;\n        } else if (STREQ(stdioHandler, \"file\")) {\n            cfg->stdioLogD = false;\n        } else {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                           _(\"Unknown stdio handler %s\"),\n                           stdioHandler);\n            return -1;\n        }\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"configmake.h\"",
      "#include \"virutil.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virstring.h\"",
      "#include \"virsocket.h\"",
      "#include \"virfile.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virlog.h\"",
      "#include \"virxml.h\"",
      "#include \"datatypes.h\"",
      "#include \"viralloc.h\"",
      "#include \"virconf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_firmware.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_capabilities.h\"",
      "#include \"qemu_conf.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "_(\"Unknown stdio handler %s\")",
            "stdioHandler"
          ],
          "line": 678
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unknown stdio handler %s\""
          ],
          "line": 679
        },
        "resolved": true,
        "details": {
          "function_name": "bswap_header",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_driver.c",
          "lines": "2852-2860",
          "snippet": "static inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virenum.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virqemu.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virnuma.h\"",
            "#include \"virperf.h\"",
            "#include \"vircgroup.h\"",
            "#include \"domain_capabilities.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapicheckqemu.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virkeycode.h\"",
            "#include \"locking/domain_lock.h\"",
            "#include \"locking/lock_manager.h\"",
            "#include \"virthreadpool.h\"",
            "#include \"configmake.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virhook.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virxml.h\"",
            "#include \"libvirt_internal.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virusb.h\"",
            "#include \"virpci.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"domain_conf.h\"",
            "#include \"viruuid.h\"",
            "#include \"virarptable.h\"",
            "#include \"viralloc.h\"",
            "#include \"capabilities.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virbuffer.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"qemu_backup.h\"",
            "#include \"qemu_checkpoint.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_blockjob.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_monitor.h\"",
            "#include \"qemu_hotplug.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"qemu_block.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_agent.h\"",
            "#include \"qemu_driver.h\"",
            "#include <sys/ioctl.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <dirent.h>",
            "#include <sys/time.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virenum.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virqemu.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virnuma.h\"\n#include \"virperf.h\"\n#include \"vircgroup.h\"\n#include \"domain_capabilities.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapicheckqemu.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virbitmap.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virnodesuspend.h\"\n#include \"virkeycode.h\"\n#include \"locking/domain_lock.h\"\n#include \"locking/lock_manager.h\"\n#include \"virthreadpool.h\"\n#include \"configmake.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"virhook.h\"\n#include \"domain_nwfilter.h\"\n#include \"virsysinfo.h\"\n#include \"cpu/cpu.h\"\n#include \"virxml.h\"\n#include \"libvirt_internal.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virusb.h\"\n#include \"virpci.h\"\n#include \"node_device_conf.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"domain_conf.h\"\n#include \"viruuid.h\"\n#include \"virarptable.h\"\n#include \"viralloc.h\"\n#include \"capabilities.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevtap.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"qemu_backup.h\"\n#include \"qemu_checkpoint.h\"\n#include \"qemu_security.h\"\n#include \"qemu_blockjob.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_process.h\"\n#include \"qemu_monitor.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_cgroup.h\"\n#include \"qemu_command.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"qemu_block.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_agent.h\"\n#include \"qemu_driver.h\"\n#include <sys/ioctl.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <dirent.h>\n#include <sys/time.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}"
        }
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "stdioHandler",
            "\"file\""
          ],
          "line": 675
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "stdioHandler",
            "\"logd\""
          ],
          "line": 673
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virConfGetValueString",
          "args": [
            "conf",
            "\"stdio_handler\"",
            "&stdioHandler"
          ],
          "line": 670
        },
        "resolved": true,
        "details": {
          "function_name": "virConfGetValueString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
          "lines": "875-898",
          "snippet": "int virConfGetValueString(virConfPtr conf,\n                          const char *setting,\n                          char **value)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n\n    VIR_DEBUG(\"Get value string %p %d\",\n              cval, cval ? cval->type : VIR_CONF_NONE);\n\n    if (!cval)\n        return 0;\n\n    if (cval->type != VIR_CONF_STRING) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: expected a string for '%s' parameter\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    VIR_FREE(*value);\n    *value = g_strdup(cval->str);\n\n    return 1;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nint virConfGetValueString(virConfPtr conf,\n                          const char *setting,\n                          char **value)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n\n    VIR_DEBUG(\"Get value string %p %d\",\n              cval, cval ? cval->type : VIR_CONF_NONE);\n\n    if (!cval)\n        return 0;\n\n    if (cval->type != VIR_CONF_STRING) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: expected a string for '%s' parameter\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    VIR_FREE(*value);\n    *value = g_strdup(cval->str);\n\n    return 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virConfGetValueBool",
          "args": [
            "conf",
            "\"dump_guest_core\"",
            "&cfg->dumpGuestCore"
          ],
          "line": 668
        },
        "resolved": true,
        "details": {
          "function_name": "virConfGetValueBool",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
          "lines": "1002-1031",
          "snippet": "int virConfGetValueBool(virConfPtr conf,\n                        const char *setting,\n                        bool *value)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n\n    VIR_DEBUG(\"Get value bool %p %d\",\n              cval, cval ? cval->type : VIR_CONF_NONE);\n\n    if (!cval)\n        return 0;\n\n    if (cval->type != VIR_CONF_ULLONG) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: expected a bool for '%s' parameter\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    if (((unsigned long long)cval->l) > 1) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: value for '%s' parameter must be 0 or 1\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    *value = cval->l == 1;\n\n    return 1;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nint virConfGetValueBool(virConfPtr conf,\n                        const char *setting,\n                        bool *value)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n\n    VIR_DEBUG(\"Get value bool %p %d\",\n              cval, cval ? cval->type : VIR_CONF_NONE);\n\n    if (!cval)\n        return 0;\n\n    if (cval->type != VIR_CONF_ULLONG) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: expected a bool for '%s' parameter\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    if (((unsigned long long)cval->l) > 1) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: value for '%s' parameter must be 0 or 1\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    *value = cval->l == 1;\n\n    return 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virConfGetValueULLong",
          "args": [
            "conf",
            "\"max_core\"",
            "&cfg->maxCore"
          ],
          "line": 664
        },
        "resolved": true,
        "details": {
          "function_name": "virConfGetValueULLong",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
          "lines": "1301-1323",
          "snippet": "int virConfGetValueULLong(virConfPtr conf,\n                          const char *setting,\n                          unsigned long long *value)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n\n    VIR_DEBUG(\"Get value unsigned long long %p %d\",\n              cval, cval ? cval->type : VIR_CONF_NONE);\n\n    if (!cval)\n        return 0;\n\n    if (cval->type != VIR_CONF_ULLONG) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: expected an unsigned integer for '%s' parameter\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    *value = (unsigned long long)cval->l;\n\n    return 1;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nint virConfGetValueULLong(virConfPtr conf,\n                          const char *setting,\n                          unsigned long long *value)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n\n    VIR_DEBUG(\"Get value unsigned long long %p %d\",\n              cval, cval ? cval->type : VIR_CONF_NONE);\n\n    if (!cval)\n        return 0;\n\n    if (cval->type != VIR_CONF_ULLONG) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: expected an unsigned integer for '%s' parameter\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    *value = (unsigned long long)cval->l;\n\n    return 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_CONFIG_UNSUPPORTED",
            "_(\"Unknown core size '%s'\")",
            "corestr"
          ],
          "line": 659
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "corestr",
            "\"unlimited\""
          ],
          "line": 656
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virConfGetValueType",
          "args": [
            "conf",
            "\"max_core\""
          ],
          "line": 653
        },
        "resolved": true,
        "details": {
          "function_name": "virConfGetValueType",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
          "lines": "849-857",
          "snippet": "virConfType virConfGetValueType(virConfPtr conf,\n                                const char *setting)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n    if (!cval)\n        return VIR_CONF_NONE;\n\n    return cval->type;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nvirConfType virConfGetValueType(virConfPtr conf,\n                                const char *setting)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n    if (!cval)\n        return VIR_CONF_NONE;\n\n    return cval->type;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virConfGetValueUInt",
          "args": [
            "conf",
            "\"max_threads_per_process\"",
            "&cfg->maxThreadsPerProc"
          ],
          "line": 650
        },
        "resolved": true,
        "details": {
          "function_name": "virConfGetValueUInt",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
          "lines": "1099-1128",
          "snippet": "int virConfGetValueUInt(virConfPtr conf,\n                        const char *setting,\n                        unsigned int *value)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n\n    VIR_DEBUG(\"Get value uint %p %d\",\n              cval, cval ? cval->type : VIR_CONF_NONE);\n\n    if (!cval)\n        return 0;\n\n    if (cval->type != VIR_CONF_ULLONG) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: expected an unsigned integer for '%s' parameter\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    if (((unsigned long long)cval->l) > UINT_MAX) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: value for '%s' parameter must be in range 0:%u\"),\n                       conf->filename, setting, UINT_MAX);\n        return -1;\n    }\n\n    *value = (unsigned int)cval->l;\n\n    return 1;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nint virConfGetValueUInt(virConfPtr conf,\n                        const char *setting,\n                        unsigned int *value)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n\n    VIR_DEBUG(\"Get value uint %p %d\",\n              cval, cval ? cval->type : VIR_CONF_NONE);\n\n    if (!cval)\n        return 0;\n\n    if (cval->type != VIR_CONF_ULLONG) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: expected an unsigned integer for '%s' parameter\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    if (((unsigned long long)cval->l) > UINT_MAX) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: value for '%s' parameter must be in range 0:%u\"),\n                       conf->filename, setting, UINT_MAX);\n        return -1;\n    }\n\n    *value = (unsigned int)cval->l;\n\n    return 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virQEMUDriverConfigHugeTLBFSInit",
          "args": [
            "&cfg->hugetlbfs[i]",
            "hugetlbfs[i]",
            "i != 0"
          ],
          "line": 629
        },
        "resolved": true,
        "details": {
          "function_name": "virQEMUDriverConfigHugeTLBFSInit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
          "lines": "372-383",
          "snippet": "static int\nvirQEMUDriverConfigHugeTLBFSInit(virHugeTLBFSPtr hugetlbfs,\n                                 const char *path,\n                                 bool deflt)\n{\n    hugetlbfs->mnt_dir = g_strdup(path);\n    if (virFileGetHugepageSize(path, &hugetlbfs->size) < 0)\n        return -1;\n\n    hugetlbfs->deflt = deflt;\n    return 0;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virutil.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virstring.h\"",
            "#include \"virsocket.h\"",
            "#include \"virfile.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virlog.h\"",
            "#include \"virxml.h\"",
            "#include \"datatypes.h\"",
            "#include \"viralloc.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_firmware.h\"",
            "#include \"qemu_domain.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvirQEMUDriverConfigHugeTLBFSInit(virHugeTLBFSPtr hugetlbfs,\n                                 const char *path,\n                                 bool deflt)\n{\n    hugetlbfs->mnt_dir = g_strdup(path);\n    if (virFileGetHugepageSize(path, &hugetlbfs->size) < 0)\n        return -1;\n\n    hugetlbfs->deflt = deflt;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC_N",
          "args": [
            "cfg->hugetlbfs",
            "cfg->nhugetlbfs"
          ],
          "line": 625
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStringListLength",
          "args": [
            "(const char *const *)hugetlbfs"
          ],
          "line": 623
        },
        "resolved": true,
        "details": {
          "function_name": "virStringListLength",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "893-901",
          "snippet": "size_t virStringListLength(const char * const *strings)\n{\n    size_t i = 0;\n\n    while (strings && strings[i])\n        i++;\n\n    return i;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nsize_t virStringListLength(const char * const *strings)\n{\n    size_t i = 0;\n\n    while (strings && strings[i])\n        i++;\n\n    return i;\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "cfg->hugetlbfs"
          ],
          "line": 621
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "cfg->hugetlbfs[cfg->nhugetlbfs].mnt_dir"
          ],
          "line": 619
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virConfGetValueStringList",
          "args": [
            "conf",
            "\"hugetlbfs_mount\"",
            "true",
            "&hugetlbfs"
          ],
          "line": 612
        },
        "resolved": true,
        "details": {
          "function_name": "virConfGetValueStringList",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
          "lines": "920-984",
          "snippet": "int virConfGetValueStringList(virConfPtr conf,\n                              const char *setting,\n                              bool compatString,\n                              char ***values)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n    size_t len;\n    virConfValuePtr eval;\n\n    VIR_DEBUG(\"Get value string list %p %d\",\n              cval, cval ? cval->type : VIR_CONF_NONE);\n\n    if (!cval)\n        return 0;\n\n    virStringListFree(*values);\n    *values = NULL;\n\n    switch (cval->type) {\n    case VIR_CONF_LIST:\n        /* Calc length and check items */\n        for (len = 0, eval = cval->list; eval; len++, eval = eval->next) {\n            if (eval->type != VIR_CONF_STRING) {\n                virReportError(VIR_ERR_CONF_SYNTAX,\n                               _(\"%s: expected a string list for '%s' parameter\"),\n                               conf->filename, setting);\n                return -1;\n            }\n        }\n\n        if (VIR_ALLOC_N(*values, len + 1) < 0)\n            return -1;\n\n        for (len = 0, eval = cval->list; eval; len++, eval = eval->next)\n            (*values)[len] = g_strdup(eval->str);\n        break;\n\n    case VIR_CONF_STRING:\n        if (compatString) {\n            if (VIR_ALLOC_N(*values, cval->str ? 2 : 1) < 0)\n                return -1;\n            if (cval->str)\n                (*values)[0] = g_strdup(cval->str);\n            break;\n        }\n        G_GNUC_FALLTHROUGH;\n\n    case VIR_CONF_LLONG:\n    case VIR_CONF_ULLONG:\n    case VIR_CONF_NONE:\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       compatString ?\n                       _(\"%s: expected a string or string list for '%s' parameter\") :\n                       _(\"%s: expected a string list for '%s' parameter\"),\n                       conf->filename, setting);\n        return -1;\n\n    case VIR_CONF_LAST:\n    default:\n        virReportEnumRangeError(virConfType, cval->type);\n        return -1;\n    }\n\n    return 1;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nint virConfGetValueStringList(virConfPtr conf,\n                              const char *setting,\n                              bool compatString,\n                              char ***values)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n    size_t len;\n    virConfValuePtr eval;\n\n    VIR_DEBUG(\"Get value string list %p %d\",\n              cval, cval ? cval->type : VIR_CONF_NONE);\n\n    if (!cval)\n        return 0;\n\n    virStringListFree(*values);\n    *values = NULL;\n\n    switch (cval->type) {\n    case VIR_CONF_LIST:\n        /* Calc length and check items */\n        for (len = 0, eval = cval->list; eval; len++, eval = eval->next) {\n            if (eval->type != VIR_CONF_STRING) {\n                virReportError(VIR_ERR_CONF_SYNTAX,\n                               _(\"%s: expected a string list for '%s' parameter\"),\n                               conf->filename, setting);\n                return -1;\n            }\n        }\n\n        if (VIR_ALLOC_N(*values, len + 1) < 0)\n            return -1;\n\n        for (len = 0, eval = cval->list; eval; len++, eval = eval->next)\n            (*values)[len] = g_strdup(eval->str);\n        break;\n\n    case VIR_CONF_STRING:\n        if (compatString) {\n            if (VIR_ALLOC_N(*values, cval->str ? 2 : 1) < 0)\n                return -1;\n            if (cval->str)\n                (*values)[0] = g_strdup(cval->str);\n            break;\n        }\n        G_GNUC_FALLTHROUGH;\n\n    case VIR_CONF_LLONG:\n    case VIR_CONF_ULLONG:\n    case VIR_CONF_NONE:\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       compatString ?\n                       _(\"%s: expected a string or string list for '%s' parameter\") :\n                       _(\"%s: expected a string list for '%s' parameter\"),\n                       conf->filename, setting);\n        return -1;\n\n    case VIR_CONF_LAST:\n    default:\n        virReportEnumRangeError(virConfType, cval->type);\n        return -1;\n    }\n\n    return 1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvirQEMUDriverConfigLoadProcessEntry(virQEMUDriverConfigPtr cfg,\n                                    virConfPtr conf)\n{\n    VIR_AUTOSTRINGLIST hugetlbfs = NULL;\n    g_autofree char *stdioHandler = NULL;\n    g_autofree char *corestr = NULL;\n    size_t i;\n\n    if (virConfGetValueStringList(conf, \"hugetlbfs_mount\", true,\n                                  &hugetlbfs) < 0)\n        return -1;\n    if (hugetlbfs) {\n        /* There already might be something autodetected. Avoid leaking it. */\n        while (cfg->nhugetlbfs) {\n            cfg->nhugetlbfs--;\n            VIR_FREE(cfg->hugetlbfs[cfg->nhugetlbfs].mnt_dir);\n        }\n        VIR_FREE(cfg->hugetlbfs);\n\n        cfg->nhugetlbfs = virStringListLength((const char *const *)hugetlbfs);\n        if (hugetlbfs[0] &&\n            VIR_ALLOC_N(cfg->hugetlbfs, cfg->nhugetlbfs) < 0)\n            return -1;\n\n        for (i = 0; hugetlbfs[i] != NULL; i++) {\n            if (virQEMUDriverConfigHugeTLBFSInit(&cfg->hugetlbfs[i],\n                                                 hugetlbfs[i], i != 0) < 0)\n                return -1;\n        }\n    }\n\n    if (virConfGetValueString(conf, \"bridge_helper\", &cfg->bridgeHelperName) < 0)\n        return -1;\n\n    if (virConfGetValueString(conf, \"pr_helper\", &cfg->prHelperName) < 0)\n        return -1;\n\n    if (virConfGetValueString(conf, \"slirp_helper\", &cfg->slirpHelperName) < 0)\n        return -1;\n\n    if (virConfGetValueBool(conf, \"set_process_name\", &cfg->setProcessName) < 0)\n        return -1;\n    if (virConfGetValueUInt(conf, \"max_processes\", &cfg->maxProcesses) < 0)\n        return -1;\n    if (virConfGetValueUInt(conf, \"max_files\", &cfg->maxFiles) < 0)\n        return -1;\n    if (virConfGetValueUInt(conf, \"max_threads_per_process\", &cfg->maxThreadsPerProc) < 0)\n        return -1;\n\n    if (virConfGetValueType(conf, \"max_core\") == VIR_CONF_STRING) {\n        if (virConfGetValueString(conf, \"max_core\", &corestr) < 0)\n            return -1;\n        if (STREQ(corestr, \"unlimited\")) {\n            cfg->maxCore = ULLONG_MAX;\n        } else {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                           _(\"Unknown core size '%s'\"),\n                           corestr);\n            return -1;\n        }\n    } else if (virConfGetValueULLong(conf, \"max_core\", &cfg->maxCore) < 0) {\n        return -1;\n    }\n\n    if (virConfGetValueBool(conf, \"dump_guest_core\", &cfg->dumpGuestCore) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"stdio_handler\", &stdioHandler) < 0)\n        return -1;\n    if (stdioHandler) {\n        if (STREQ(stdioHandler, \"logd\")) {\n            cfg->stdioLogD = true;\n        } else if (STREQ(stdioHandler, \"file\")) {\n            cfg->stdioLogD = false;\n        } else {\n            virReportError(VIR_ERR_CONFIG_UNSUPPORTED,\n                           _(\"Unknown stdio handler %s\"),\n                           stdioHandler);\n            return -1;\n        }\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virQEMUDriverConfigLoadSaveEntry",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
    "lines": "582-600",
    "snippet": "static int\nvirQEMUDriverConfigLoadSaveEntry(virQEMUDriverConfigPtr cfg,\n                                 virConfPtr conf)\n{\n    if (virConfGetValueString(conf, \"save_image_format\", &cfg->saveImageFormat) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"dump_image_format\", &cfg->dumpImageFormat) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"snapshot_image_format\", &cfg->snapshotImageFormat) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"auto_dump_path\", &cfg->autoDumpPath) < 0)\n        return -1;\n    if (virConfGetValueBool(conf, \"auto_dump_bypass_cache\", &cfg->autoDumpBypassCache) < 0)\n        return -1;\n    if (virConfGetValueBool(conf, \"auto_start_bypass_cache\", &cfg->autoStartBypassCache) < 0)\n        return -1;\n\n    return 0;\n}",
    "includes": [
      "#include \"configmake.h\"",
      "#include \"virutil.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virstring.h\"",
      "#include \"virsocket.h\"",
      "#include \"virfile.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virlog.h\"",
      "#include \"virxml.h\"",
      "#include \"datatypes.h\"",
      "#include \"viralloc.h\"",
      "#include \"virconf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_firmware.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_capabilities.h\"",
      "#include \"qemu_conf.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virConfGetValueBool",
          "args": [
            "conf",
            "\"auto_start_bypass_cache\"",
            "&cfg->autoStartBypassCache"
          ],
          "line": 596
        },
        "resolved": true,
        "details": {
          "function_name": "virConfGetValueBool",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
          "lines": "1002-1031",
          "snippet": "int virConfGetValueBool(virConfPtr conf,\n                        const char *setting,\n                        bool *value)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n\n    VIR_DEBUG(\"Get value bool %p %d\",\n              cval, cval ? cval->type : VIR_CONF_NONE);\n\n    if (!cval)\n        return 0;\n\n    if (cval->type != VIR_CONF_ULLONG) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: expected a bool for '%s' parameter\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    if (((unsigned long long)cval->l) > 1) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: value for '%s' parameter must be 0 or 1\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    *value = cval->l == 1;\n\n    return 1;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nint virConfGetValueBool(virConfPtr conf,\n                        const char *setting,\n                        bool *value)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n\n    VIR_DEBUG(\"Get value bool %p %d\",\n              cval, cval ? cval->type : VIR_CONF_NONE);\n\n    if (!cval)\n        return 0;\n\n    if (cval->type != VIR_CONF_ULLONG) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: expected a bool for '%s' parameter\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    if (((unsigned long long)cval->l) > 1) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: value for '%s' parameter must be 0 or 1\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    *value = cval->l == 1;\n\n    return 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virConfGetValueString",
          "args": [
            "conf",
            "\"auto_dump_path\"",
            "&cfg->autoDumpPath"
          ],
          "line": 592
        },
        "resolved": true,
        "details": {
          "function_name": "virConfGetValueString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
          "lines": "875-898",
          "snippet": "int virConfGetValueString(virConfPtr conf,\n                          const char *setting,\n                          char **value)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n\n    VIR_DEBUG(\"Get value string %p %d\",\n              cval, cval ? cval->type : VIR_CONF_NONE);\n\n    if (!cval)\n        return 0;\n\n    if (cval->type != VIR_CONF_STRING) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: expected a string for '%s' parameter\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    VIR_FREE(*value);\n    *value = g_strdup(cval->str);\n\n    return 1;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nint virConfGetValueString(virConfPtr conf,\n                          const char *setting,\n                          char **value)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n\n    VIR_DEBUG(\"Get value string %p %d\",\n              cval, cval ? cval->type : VIR_CONF_NONE);\n\n    if (!cval)\n        return 0;\n\n    if (cval->type != VIR_CONF_STRING) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: expected a string for '%s' parameter\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    VIR_FREE(*value);\n    *value = g_strdup(cval->str);\n\n    return 1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvirQEMUDriverConfigLoadSaveEntry(virQEMUDriverConfigPtr cfg,\n                                 virConfPtr conf)\n{\n    if (virConfGetValueString(conf, \"save_image_format\", &cfg->saveImageFormat) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"dump_image_format\", &cfg->dumpImageFormat) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"snapshot_image_format\", &cfg->snapshotImageFormat) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"auto_dump_path\", &cfg->autoDumpPath) < 0)\n        return -1;\n    if (virConfGetValueBool(conf, \"auto_dump_bypass_cache\", &cfg->autoDumpBypassCache) < 0)\n        return -1;\n    if (virConfGetValueBool(conf, \"auto_start_bypass_cache\", &cfg->autoStartBypassCache) < 0)\n        return -1;\n\n    return 0;\n}"
  },
  {
    "function_name": "virQEMUDriverConfigLoadRemoteDisplayEntry",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
    "lines": "511-579",
    "snippet": "static int\nvirQEMUDriverConfigLoadRemoteDisplayEntry(virQEMUDriverConfigPtr cfg,\n                                          virConfPtr conf,\n                                          const char *filename)\n{\n    if (virConfGetValueUInt(conf, \"remote_websocket_port_min\", &cfg->webSocketPortMin) < 0)\n        return -1;\n    if (cfg->webSocketPortMin < QEMU_WEBSOCKET_PORT_MIN) {\n        /* if the port is too low, we can't get the display name\n         * to tell to vnc (usually subtract 5700, e.g. localhost:1\n         * for port 5701) */\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: remote_websocket_port_min: port must be greater \"\n                         \"than or equal to %d\"),\n                        filename, QEMU_WEBSOCKET_PORT_MIN);\n        return -1;\n    }\n\n    if (virConfGetValueUInt(conf, \"remote_websocket_port_max\", &cfg->webSocketPortMax) < 0)\n        return -1;\n    if (cfg->webSocketPortMax > QEMU_WEBSOCKET_PORT_MAX ||\n        cfg->webSocketPortMax < cfg->webSocketPortMin) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                        _(\"%s: remote_websocket_port_max: port must be between \"\n                          \"the minimal port and %d\"),\n                       filename, QEMU_WEBSOCKET_PORT_MAX);\n        return -1;\n    }\n\n    if (cfg->webSocketPortMin > cfg->webSocketPortMax) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                        _(\"%s: remote_websocket_port_min: min port must not be \"\n                          \"greater than max port\"), filename);\n        return -1;\n    }\n\n    if (virConfGetValueUInt(conf, \"remote_display_port_min\", &cfg->remotePortMin) < 0)\n        return -1;\n    if (cfg->remotePortMin < QEMU_REMOTE_PORT_MIN) {\n        /* if the port is too low, we can't get the display name\n         * to tell to vnc (usually subtract 5900, e.g. localhost:1\n         * for port 5901) */\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: remote_display_port_min: port must be greater \"\n                         \"than or equal to %d\"),\n                        filename, QEMU_REMOTE_PORT_MIN);\n        return -1;\n    }\n\n    if (virConfGetValueUInt(conf, \"remote_display_port_max\", &cfg->remotePortMax) < 0)\n        return -1;\n    if (cfg->remotePortMax > QEMU_REMOTE_PORT_MAX ||\n        cfg->remotePortMax < cfg->remotePortMin) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                        _(\"%s: remote_display_port_max: port must be between \"\n                          \"the minimal port and %d\"),\n                       filename, QEMU_REMOTE_PORT_MAX);\n        return -1;\n    }\n\n    if (cfg->remotePortMin > cfg->remotePortMax) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                        _(\"%s: remote_display_port_min: min port must not be \"\n                          \"greater than max port\"), filename);\n        return -1;\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"configmake.h\"",
      "#include \"virutil.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virstring.h\"",
      "#include \"virsocket.h\"",
      "#include \"virfile.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virlog.h\"",
      "#include \"virxml.h\"",
      "#include \"datatypes.h\"",
      "#include \"viralloc.h\"",
      "#include \"virconf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_firmware.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_capabilities.h\"",
      "#include \"qemu_conf.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define QEMU_WEBSOCKET_PORT_MAX 65535",
      "#define QEMU_WEBSOCKET_PORT_MIN 5700",
      "#define QEMU_REMOTE_PORT_MAX 65535",
      "#define QEMU_REMOTE_PORT_MIN 5900"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"%s: remote_display_port_min: min port must not be \"\n                          \"greater than max port\")",
            "filename"
          ],
          "line": 572
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"%s: remote_display_port_min: min port must not be \"\n                          \"greater than max port\""
          ],
          "line": 573
        },
        "resolved": true,
        "details": {
          "function_name": "bswap_header",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_driver.c",
          "lines": "2852-2860",
          "snippet": "static inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}",
          "includes": [
            "#include \"virutil.h\"",
            "#include \"virsocket.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virenum.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virqemu.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"virnuma.h\"",
            "#include \"virperf.h\"",
            "#include \"vircgroup.h\"",
            "#include \"domain_capabilities.h\"",
            "#include \"virhostdev.h\"",
            "#include \"viraccessapicheckqemu.h\"",
            "#include \"viraccessapicheck.h\"",
            "#include \"virstring.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virtypedparam.h\"",
            "#include \"virtime.h\"",
            "#include \"virnodesuspend.h\"",
            "#include \"virkeycode.h\"",
            "#include \"locking/domain_lock.h\"",
            "#include \"locking/lock_manager.h\"",
            "#include \"virthreadpool.h\"",
            "#include \"configmake.h\"",
            "#include \"virfdstream.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virhook.h\"",
            "#include \"domain_nwfilter.h\"",
            "#include \"virsysinfo.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virxml.h\"",
            "#include \"libvirt_internal.h\"",
            "#include \"virprocess.h\"",
            "#include \"virpidfile.h\"",
            "#include \"virusb.h\"",
            "#include \"virpci.h\"",
            "#include \"node_device_conf.h\"",
            "#include \"domain_driver.h\"",
            "#include \"domain_cgroup.h\"",
            "#include \"domain_audit.h\"",
            "#include \"domain_conf.h\"",
            "#include \"viruuid.h\"",
            "#include \"virarptable.h\"",
            "#include \"viralloc.h\"",
            "#include \"capabilities.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virhostmem.h\"",
            "#include \"virhostcpu.h\"",
            "#include \"virbuffer.h\"",
            "#include \"datatypes.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"qemu_backup.h\"",
            "#include \"qemu_checkpoint.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_blockjob.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_monitor.h\"",
            "#include \"qemu_hotplug.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_conf.h\"",
            "#include \"qemu_block.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_agent.h\"",
            "#include \"qemu_driver.h\"",
            "#include <sys/ioctl.h>",
            "#include <signal.h>",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <stdarg.h>",
            "#include <dirent.h>",
            "#include <sys/time.h>",
            "#include <sys/poll.h>",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virutil.h\"\n#include \"virsocket.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virenum.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virqemu.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"virnuma.h\"\n#include \"virperf.h\"\n#include \"vircgroup.h\"\n#include \"domain_capabilities.h\"\n#include \"virhostdev.h\"\n#include \"viraccessapicheckqemu.h\"\n#include \"viraccessapicheck.h\"\n#include \"virstring.h\"\n#include \"virbitmap.h\"\n#include \"virtypedparam.h\"\n#include \"virtime.h\"\n#include \"virnodesuspend.h\"\n#include \"virkeycode.h\"\n#include \"locking/domain_lock.h\"\n#include \"locking/lock_manager.h\"\n#include \"virthreadpool.h\"\n#include \"configmake.h\"\n#include \"virfdstream.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"virhook.h\"\n#include \"domain_nwfilter.h\"\n#include \"virsysinfo.h\"\n#include \"cpu/cpu.h\"\n#include \"virxml.h\"\n#include \"libvirt_internal.h\"\n#include \"virprocess.h\"\n#include \"virpidfile.h\"\n#include \"virusb.h\"\n#include \"virpci.h\"\n#include \"node_device_conf.h\"\n#include \"domain_driver.h\"\n#include \"domain_cgroup.h\"\n#include \"domain_audit.h\"\n#include \"domain_conf.h\"\n#include \"viruuid.h\"\n#include \"virarptable.h\"\n#include \"viralloc.h\"\n#include \"capabilities.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virnetdevtap.h\"\n#include \"virhostmem.h\"\n#include \"virhostcpu.h\"\n#include \"virbuffer.h\"\n#include \"datatypes.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"qemu_backup.h\"\n#include \"qemu_checkpoint.h\"\n#include \"qemu_security.h\"\n#include \"qemu_blockjob.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_process.h\"\n#include \"qemu_monitor.h\"\n#include \"qemu_hotplug.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_cgroup.h\"\n#include \"qemu_command.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"qemu_block.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_agent.h\"\n#include \"qemu_driver.h\"\n#include <sys/ioctl.h>\n#include <signal.h>\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <unistd.h>\n#include <stdarg.h>\n#include <dirent.h>\n#include <sys/time.h>\n#include <sys/poll.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic inline void\nbswap_header(virQEMUSaveHeaderPtr hdr)\n{\n    hdr->version = GUINT32_SWAP_LE_BE(hdr->version);\n    hdr->data_len = GUINT32_SWAP_LE_BE(hdr->data_len);\n    hdr->was_running = GUINT32_SWAP_LE_BE(hdr->was_running);\n    hdr->compressed = GUINT32_SWAP_LE_BE(hdr->compressed);\n    hdr->cookieOffset = GUINT32_SWAP_LE_BE(hdr->cookieOffset);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"%s: remote_display_port_max: port must be between \"\n                          \"the minimal port and %d\")",
            "filename",
            "QEMU_REMOTE_PORT_MAX"
          ],
          "line": 564
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virConfGetValueUInt",
          "args": [
            "conf",
            "\"remote_display_port_max\"",
            "&cfg->remotePortMax"
          ],
          "line": 560
        },
        "resolved": true,
        "details": {
          "function_name": "virConfGetValueUInt",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
          "lines": "1099-1128",
          "snippet": "int virConfGetValueUInt(virConfPtr conf,\n                        const char *setting,\n                        unsigned int *value)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n\n    VIR_DEBUG(\"Get value uint %p %d\",\n              cval, cval ? cval->type : VIR_CONF_NONE);\n\n    if (!cval)\n        return 0;\n\n    if (cval->type != VIR_CONF_ULLONG) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: expected an unsigned integer for '%s' parameter\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    if (((unsigned long long)cval->l) > UINT_MAX) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: value for '%s' parameter must be in range 0:%u\"),\n                       conf->filename, setting, UINT_MAX);\n        return -1;\n    }\n\n    *value = (unsigned int)cval->l;\n\n    return 1;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nint virConfGetValueUInt(virConfPtr conf,\n                        const char *setting,\n                        unsigned int *value)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n\n    VIR_DEBUG(\"Get value uint %p %d\",\n              cval, cval ? cval->type : VIR_CONF_NONE);\n\n    if (!cval)\n        return 0;\n\n    if (cval->type != VIR_CONF_ULLONG) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: expected an unsigned integer for '%s' parameter\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    if (((unsigned long long)cval->l) > UINT_MAX) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: value for '%s' parameter must be in range 0:%u\"),\n                       conf->filename, setting, UINT_MAX);\n        return -1;\n    }\n\n    *value = (unsigned int)cval->l;\n\n    return 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"%s: remote_display_port_min: port must be greater \"\n                         \"than or equal to %d\")",
            "filename",
            "QEMU_REMOTE_PORT_MIN"
          ],
          "line": 553
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"%s: remote_websocket_port_min: min port must not be \"\n                          \"greater than max port\")",
            "filename"
          ],
          "line": 541
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"%s: remote_websocket_port_max: port must be between \"\n                          \"the minimal port and %d\")",
            "filename",
            "QEMU_WEBSOCKET_PORT_MAX"
          ],
          "line": 533
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INTERNAL_ERROR",
            "_(\"%s: remote_websocket_port_min: port must be greater \"\n                         \"than or equal to %d\")",
            "filename",
            "QEMU_WEBSOCKET_PORT_MIN"
          ],
          "line": 522
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\n#define QEMU_WEBSOCKET_PORT_MAX 65535\n#define QEMU_WEBSOCKET_PORT_MIN 5700\n#define QEMU_REMOTE_PORT_MAX 65535\n#define QEMU_REMOTE_PORT_MIN 5900\n\nstatic int\nvirQEMUDriverConfigLoadRemoteDisplayEntry(virQEMUDriverConfigPtr cfg,\n                                          virConfPtr conf,\n                                          const char *filename)\n{\n    if (virConfGetValueUInt(conf, \"remote_websocket_port_min\", &cfg->webSocketPortMin) < 0)\n        return -1;\n    if (cfg->webSocketPortMin < QEMU_WEBSOCKET_PORT_MIN) {\n        /* if the port is too low, we can't get the display name\n         * to tell to vnc (usually subtract 5700, e.g. localhost:1\n         * for port 5701) */\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: remote_websocket_port_min: port must be greater \"\n                         \"than or equal to %d\"),\n                        filename, QEMU_WEBSOCKET_PORT_MIN);\n        return -1;\n    }\n\n    if (virConfGetValueUInt(conf, \"remote_websocket_port_max\", &cfg->webSocketPortMax) < 0)\n        return -1;\n    if (cfg->webSocketPortMax > QEMU_WEBSOCKET_PORT_MAX ||\n        cfg->webSocketPortMax < cfg->webSocketPortMin) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                        _(\"%s: remote_websocket_port_max: port must be between \"\n                          \"the minimal port and %d\"),\n                       filename, QEMU_WEBSOCKET_PORT_MAX);\n        return -1;\n    }\n\n    if (cfg->webSocketPortMin > cfg->webSocketPortMax) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                        _(\"%s: remote_websocket_port_min: min port must not be \"\n                          \"greater than max port\"), filename);\n        return -1;\n    }\n\n    if (virConfGetValueUInt(conf, \"remote_display_port_min\", &cfg->remotePortMin) < 0)\n        return -1;\n    if (cfg->remotePortMin < QEMU_REMOTE_PORT_MIN) {\n        /* if the port is too low, we can't get the display name\n         * to tell to vnc (usually subtract 5900, e.g. localhost:1\n         * for port 5901) */\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: remote_display_port_min: port must be greater \"\n                         \"than or equal to %d\"),\n                        filename, QEMU_REMOTE_PORT_MIN);\n        return -1;\n    }\n\n    if (virConfGetValueUInt(conf, \"remote_display_port_max\", &cfg->remotePortMax) < 0)\n        return -1;\n    if (cfg->remotePortMax > QEMU_REMOTE_PORT_MAX ||\n        cfg->remotePortMax < cfg->remotePortMin) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                        _(\"%s: remote_display_port_max: port must be between \"\n                          \"the minimal port and %d\"),\n                       filename, QEMU_REMOTE_PORT_MAX);\n        return -1;\n    }\n\n    if (cfg->remotePortMin > cfg->remotePortMax) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                        _(\"%s: remote_display_port_min: min port must not be \"\n                          \"greater than max port\"), filename);\n        return -1;\n    }\n\n    return 0;\n}"
  },
  {
    "function_name": "virQEMUDriverConfigLoadSpecificTLSEntry",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
    "lines": "469-508",
    "snippet": "static int\nvirQEMUDriverConfigLoadSpecificTLSEntry(virQEMUDriverConfigPtr cfg,\n                                        virConfPtr conf)\n{\n    int rv;\n\n    if (virConfGetValueBool(conf, \"vxhs_tls\", &cfg->vxhsTLS) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"vxhs_tls_x509_cert_dir\", &cfg->vxhsTLSx509certdir) < 0)\n        return -1;\n    if (virConfGetValueBool(conf, \"nbd_tls\", &cfg->nbdTLS) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"nbd_tls_x509_cert_dir\", &cfg->nbdTLSx509certdir) < 0)\n        return -1;\n\n#define GET_CONFIG_TLS_CERTINFO(val) \\\n    do { \\\n        if ((rv = virConfGetValueBool(conf, #val \"_tls_x509_verify\", \\\n                                      &cfg->val## TLSx509verify)) < 0) \\\n            return -1; \\\n        if (rv == 1) \\\n            cfg->val## TLSx509verifyPresent = true; \\\n        if (virConfGetValueString(conf, #val \"_tls_x509_cert_dir\", \\\n                                  &cfg->val## TLSx509certdir) < 0) \\\n            return -1; \\\n        if (virConfGetValueString(conf, \\\n                                  #val \"_tls_x509_secret_uuid\", \\\n                                  &cfg->val## TLSx509secretUUID) < 0) \\\n            return -1; \\\n    } while (0)\n\n    if (virConfGetValueBool(conf, \"chardev_tls\", &cfg->chardevTLS) < 0)\n        return -1;\n    GET_CONFIG_TLS_CERTINFO(chardev);\n\n    GET_CONFIG_TLS_CERTINFO(migrate);\n\n#undef GET_CONFIG_TLS_CERTINFO\n    return 0;\n}",
    "includes": [
      "#include \"configmake.h\"",
      "#include \"virutil.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virstring.h\"",
      "#include \"virsocket.h\"",
      "#include \"virfile.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virlog.h\"",
      "#include \"virxml.h\"",
      "#include \"datatypes.h\"",
      "#include \"viralloc.h\"",
      "#include \"virconf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_firmware.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_capabilities.h\"",
      "#include \"qemu_conf.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GET_CONFIG_TLS_CERTINFO",
          "args": [
            "migrate"
          ],
          "line": 504
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GET_CONFIG_TLS_CERTINFO",
          "args": [
            "chardev"
          ],
          "line": 502
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virConfGetValueBool",
          "args": [
            "conf",
            "\"chardev_tls\"",
            "&cfg->chardevTLS"
          ],
          "line": 500
        },
        "resolved": true,
        "details": {
          "function_name": "virConfGetValueBool",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
          "lines": "1002-1031",
          "snippet": "int virConfGetValueBool(virConfPtr conf,\n                        const char *setting,\n                        bool *value)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n\n    VIR_DEBUG(\"Get value bool %p %d\",\n              cval, cval ? cval->type : VIR_CONF_NONE);\n\n    if (!cval)\n        return 0;\n\n    if (cval->type != VIR_CONF_ULLONG) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: expected a bool for '%s' parameter\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    if (((unsigned long long)cval->l) > 1) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: value for '%s' parameter must be 0 or 1\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    *value = cval->l == 1;\n\n    return 1;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nint virConfGetValueBool(virConfPtr conf,\n                        const char *setting,\n                        bool *value)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n\n    VIR_DEBUG(\"Get value bool %p %d\",\n              cval, cval ? cval->type : VIR_CONF_NONE);\n\n    if (!cval)\n        return 0;\n\n    if (cval->type != VIR_CONF_ULLONG) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: expected a bool for '%s' parameter\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    if (((unsigned long long)cval->l) > 1) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: value for '%s' parameter must be 0 or 1\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    *value = cval->l == 1;\n\n    return 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virConfGetValueString",
          "args": [
            "conf",
            "\"nbd_tls_x509_cert_dir\"",
            "&cfg->nbdTLSx509certdir"
          ],
          "line": 481
        },
        "resolved": true,
        "details": {
          "function_name": "virConfGetValueString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
          "lines": "875-898",
          "snippet": "int virConfGetValueString(virConfPtr conf,\n                          const char *setting,\n                          char **value)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n\n    VIR_DEBUG(\"Get value string %p %d\",\n              cval, cval ? cval->type : VIR_CONF_NONE);\n\n    if (!cval)\n        return 0;\n\n    if (cval->type != VIR_CONF_STRING) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: expected a string for '%s' parameter\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    VIR_FREE(*value);\n    *value = g_strdup(cval->str);\n\n    return 1;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nint virConfGetValueString(virConfPtr conf,\n                          const char *setting,\n                          char **value)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n\n    VIR_DEBUG(\"Get value string %p %d\",\n              cval, cval ? cval->type : VIR_CONF_NONE);\n\n    if (!cval)\n        return 0;\n\n    if (cval->type != VIR_CONF_STRING) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: expected a string for '%s' parameter\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    VIR_FREE(*value);\n    *value = g_strdup(cval->str);\n\n    return 1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvirQEMUDriverConfigLoadSpecificTLSEntry(virQEMUDriverConfigPtr cfg,\n                                        virConfPtr conf)\n{\n    int rv;\n\n    if (virConfGetValueBool(conf, \"vxhs_tls\", &cfg->vxhsTLS) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"vxhs_tls_x509_cert_dir\", &cfg->vxhsTLSx509certdir) < 0)\n        return -1;\n    if (virConfGetValueBool(conf, \"nbd_tls\", &cfg->nbdTLS) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"nbd_tls_x509_cert_dir\", &cfg->nbdTLSx509certdir) < 0)\n        return -1;\n\n#define GET_CONFIG_TLS_CERTINFO(val) \\\n    do { \\\n        if ((rv = virConfGetValueBool(conf, #val \"_tls_x509_verify\", \\\n                                      &cfg->val## TLSx509verify)) < 0) \\\n            return -1; \\\n        if (rv == 1) \\\n            cfg->val## TLSx509verifyPresent = true; \\\n        if (virConfGetValueString(conf, #val \"_tls_x509_cert_dir\", \\\n                                  &cfg->val## TLSx509certdir) < 0) \\\n            return -1; \\\n        if (virConfGetValueString(conf, \\\n                                  #val \"_tls_x509_secret_uuid\", \\\n                                  &cfg->val## TLSx509secretUUID) < 0) \\\n            return -1; \\\n    } while (0)\n\n    if (virConfGetValueBool(conf, \"chardev_tls\", &cfg->chardevTLS) < 0)\n        return -1;\n    GET_CONFIG_TLS_CERTINFO(chardev);\n\n    GET_CONFIG_TLS_CERTINFO(migrate);\n\n#undef GET_CONFIG_TLS_CERTINFO\n    return 0;\n}"
  },
  {
    "function_name": "virQEMUDriverConfigLoadSPICEEntry",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
    "lines": "446-466",
    "snippet": "static int\nvirQEMUDriverConfigLoadSPICEEntry(virQEMUDriverConfigPtr cfg,\n                                  virConfPtr conf)\n{\n    if (virConfGetValueBool(conf, \"spice_tls\", &cfg->spiceTLS) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"spice_tls_x509_cert_dir\", &cfg->spiceTLSx509certdir) < 0)\n        return -1;\n    if (virConfGetValueBool(conf, \"spice_sasl\", &cfg->spiceSASL) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"spice_sasl_dir\", &cfg->spiceSASLdir) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"spice_listen\", &cfg->spiceListen) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"spice_password\", &cfg->spicePassword) < 0)\n        return -1;\n    if (virConfGetValueBool(conf, \"spice_auto_unix_socket\", &cfg->spiceAutoUnixSocket) < 0)\n        return -1;\n\n    return 0;\n}",
    "includes": [
      "#include \"configmake.h\"",
      "#include \"virutil.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virstring.h\"",
      "#include \"virsocket.h\"",
      "#include \"virfile.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virlog.h\"",
      "#include \"virxml.h\"",
      "#include \"datatypes.h\"",
      "#include \"viralloc.h\"",
      "#include \"virconf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_firmware.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_capabilities.h\"",
      "#include \"qemu_conf.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virConfGetValueBool",
          "args": [
            "conf",
            "\"spice_auto_unix_socket\"",
            "&cfg->spiceAutoUnixSocket"
          ],
          "line": 462
        },
        "resolved": true,
        "details": {
          "function_name": "virConfGetValueBool",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
          "lines": "1002-1031",
          "snippet": "int virConfGetValueBool(virConfPtr conf,\n                        const char *setting,\n                        bool *value)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n\n    VIR_DEBUG(\"Get value bool %p %d\",\n              cval, cval ? cval->type : VIR_CONF_NONE);\n\n    if (!cval)\n        return 0;\n\n    if (cval->type != VIR_CONF_ULLONG) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: expected a bool for '%s' parameter\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    if (((unsigned long long)cval->l) > 1) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: value for '%s' parameter must be 0 or 1\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    *value = cval->l == 1;\n\n    return 1;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nint virConfGetValueBool(virConfPtr conf,\n                        const char *setting,\n                        bool *value)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n\n    VIR_DEBUG(\"Get value bool %p %d\",\n              cval, cval ? cval->type : VIR_CONF_NONE);\n\n    if (!cval)\n        return 0;\n\n    if (cval->type != VIR_CONF_ULLONG) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: expected a bool for '%s' parameter\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    if (((unsigned long long)cval->l) > 1) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: value for '%s' parameter must be 0 or 1\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    *value = cval->l == 1;\n\n    return 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virConfGetValueString",
          "args": [
            "conf",
            "\"spice_password\"",
            "&cfg->spicePassword"
          ],
          "line": 460
        },
        "resolved": true,
        "details": {
          "function_name": "virConfGetValueString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
          "lines": "875-898",
          "snippet": "int virConfGetValueString(virConfPtr conf,\n                          const char *setting,\n                          char **value)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n\n    VIR_DEBUG(\"Get value string %p %d\",\n              cval, cval ? cval->type : VIR_CONF_NONE);\n\n    if (!cval)\n        return 0;\n\n    if (cval->type != VIR_CONF_STRING) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: expected a string for '%s' parameter\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    VIR_FREE(*value);\n    *value = g_strdup(cval->str);\n\n    return 1;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nint virConfGetValueString(virConfPtr conf,\n                          const char *setting,\n                          char **value)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n\n    VIR_DEBUG(\"Get value string %p %d\",\n              cval, cval ? cval->type : VIR_CONF_NONE);\n\n    if (!cval)\n        return 0;\n\n    if (cval->type != VIR_CONF_STRING) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: expected a string for '%s' parameter\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    VIR_FREE(*value);\n    *value = g_strdup(cval->str);\n\n    return 1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvirQEMUDriverConfigLoadSPICEEntry(virQEMUDriverConfigPtr cfg,\n                                  virConfPtr conf)\n{\n    if (virConfGetValueBool(conf, \"spice_tls\", &cfg->spiceTLS) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"spice_tls_x509_cert_dir\", &cfg->spiceTLSx509certdir) < 0)\n        return -1;\n    if (virConfGetValueBool(conf, \"spice_sasl\", &cfg->spiceSASL) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"spice_sasl_dir\", &cfg->spiceSASLdir) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"spice_listen\", &cfg->spiceListen) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"spice_password\", &cfg->spicePassword) < 0)\n        return -1;\n    if (virConfGetValueBool(conf, \"spice_auto_unix_socket\", &cfg->spiceAutoUnixSocket) < 0)\n        return -1;\n\n    return 0;\n}"
  },
  {
    "function_name": "virQEMUDriverConfigLoadNographicsEntry",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
    "lines": "438-443",
    "snippet": "static int\nvirQEMUDriverConfigLoadNographicsEntry(virQEMUDriverConfigPtr cfg,\n                                       virConfPtr conf)\n{\n    return virConfGetValueBool(conf, \"nographics_allow_host_audio\", &cfg->nogfxAllowHostAudio);\n}",
    "includes": [
      "#include \"configmake.h\"",
      "#include \"virutil.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virstring.h\"",
      "#include \"virsocket.h\"",
      "#include \"virfile.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virlog.h\"",
      "#include \"virxml.h\"",
      "#include \"datatypes.h\"",
      "#include \"viralloc.h\"",
      "#include \"virconf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_firmware.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_capabilities.h\"",
      "#include \"qemu_conf.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virConfGetValueBool",
          "args": [
            "conf",
            "\"nographics_allow_host_audio\"",
            "&cfg->nogfxAllowHostAudio"
          ],
          "line": 442
        },
        "resolved": true,
        "details": {
          "function_name": "virConfGetValueBool",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
          "lines": "1002-1031",
          "snippet": "int virConfGetValueBool(virConfPtr conf,\n                        const char *setting,\n                        bool *value)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n\n    VIR_DEBUG(\"Get value bool %p %d\",\n              cval, cval ? cval->type : VIR_CONF_NONE);\n\n    if (!cval)\n        return 0;\n\n    if (cval->type != VIR_CONF_ULLONG) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: expected a bool for '%s' parameter\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    if (((unsigned long long)cval->l) > 1) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: value for '%s' parameter must be 0 or 1\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    *value = cval->l == 1;\n\n    return 1;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nint virConfGetValueBool(virConfPtr conf,\n                        const char *setting,\n                        bool *value)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n\n    VIR_DEBUG(\"Get value bool %p %d\",\n              cval, cval ? cval->type : VIR_CONF_NONE);\n\n    if (!cval)\n        return 0;\n\n    if (cval->type != VIR_CONF_ULLONG) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: expected a bool for '%s' parameter\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    if (((unsigned long long)cval->l) > 1) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: value for '%s' parameter must be 0 or 1\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    *value = cval->l == 1;\n\n    return 1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvirQEMUDriverConfigLoadNographicsEntry(virQEMUDriverConfigPtr cfg,\n                                       virConfPtr conf)\n{\n    return virConfGetValueBool(conf, \"nographics_allow_host_audio\", &cfg->nogfxAllowHostAudio);\n}"
  },
  {
    "function_name": "virQEMUDriverConfigLoadVNCEntry",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
    "lines": "405-435",
    "snippet": "static int\nvirQEMUDriverConfigLoadVNCEntry(virQEMUDriverConfigPtr cfg,\n                                virConfPtr conf)\n{\n    int rv;\n\n    if (virConfGetValueBool(conf, \"vnc_auto_unix_socket\", &cfg->vncAutoUnixSocket) < 0)\n        return -1;\n    if (virConfGetValueBool(conf, \"vnc_tls\", &cfg->vncTLS) < 0)\n        return -1;\n    if ((rv = virConfGetValueBool(conf, \"vnc_tls_x509_verify\", &cfg->vncTLSx509verify)) < 0)\n        return -1;\n    if (rv == 1)\n        cfg->vncTLSx509verifyPresent = true;\n    if (virConfGetValueString(conf, \"vnc_tls_x509_cert_dir\", &cfg->vncTLSx509certdir) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"vnc_tls_x509_secret_uuid\", &cfg->vncTLSx509secretUUID) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"vnc_listen\", &cfg->vncListen) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"vnc_password\", &cfg->vncPassword) < 0)\n        return -1;\n    if (virConfGetValueBool(conf, \"vnc_sasl\", &cfg->vncSASL) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"vnc_sasl_dir\", &cfg->vncSASLdir) < 0)\n        return -1;\n    if (virConfGetValueBool(conf, \"vnc_allow_host_audio\", &cfg->vncAllowHostAudio) < 0)\n        return -1;\n\n    return 0;\n}",
    "includes": [
      "#include \"configmake.h\"",
      "#include \"virutil.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virstring.h\"",
      "#include \"virsocket.h\"",
      "#include \"virfile.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virlog.h\"",
      "#include \"virxml.h\"",
      "#include \"datatypes.h\"",
      "#include \"viralloc.h\"",
      "#include \"virconf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_firmware.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_capabilities.h\"",
      "#include \"qemu_conf.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virConfGetValueBool",
          "args": [
            "conf",
            "\"vnc_allow_host_audio\"",
            "&cfg->vncAllowHostAudio"
          ],
          "line": 431
        },
        "resolved": true,
        "details": {
          "function_name": "virConfGetValueBool",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
          "lines": "1002-1031",
          "snippet": "int virConfGetValueBool(virConfPtr conf,\n                        const char *setting,\n                        bool *value)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n\n    VIR_DEBUG(\"Get value bool %p %d\",\n              cval, cval ? cval->type : VIR_CONF_NONE);\n\n    if (!cval)\n        return 0;\n\n    if (cval->type != VIR_CONF_ULLONG) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: expected a bool for '%s' parameter\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    if (((unsigned long long)cval->l) > 1) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: value for '%s' parameter must be 0 or 1\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    *value = cval->l == 1;\n\n    return 1;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nint virConfGetValueBool(virConfPtr conf,\n                        const char *setting,\n                        bool *value)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n\n    VIR_DEBUG(\"Get value bool %p %d\",\n              cval, cval ? cval->type : VIR_CONF_NONE);\n\n    if (!cval)\n        return 0;\n\n    if (cval->type != VIR_CONF_ULLONG) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: expected a bool for '%s' parameter\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    if (((unsigned long long)cval->l) > 1) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: value for '%s' parameter must be 0 or 1\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    *value = cval->l == 1;\n\n    return 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virConfGetValueString",
          "args": [
            "conf",
            "\"vnc_sasl_dir\"",
            "&cfg->vncSASLdir"
          ],
          "line": 429
        },
        "resolved": true,
        "details": {
          "function_name": "virConfGetValueString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
          "lines": "875-898",
          "snippet": "int virConfGetValueString(virConfPtr conf,\n                          const char *setting,\n                          char **value)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n\n    VIR_DEBUG(\"Get value string %p %d\",\n              cval, cval ? cval->type : VIR_CONF_NONE);\n\n    if (!cval)\n        return 0;\n\n    if (cval->type != VIR_CONF_STRING) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: expected a string for '%s' parameter\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    VIR_FREE(*value);\n    *value = g_strdup(cval->str);\n\n    return 1;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nint virConfGetValueString(virConfPtr conf,\n                          const char *setting,\n                          char **value)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n\n    VIR_DEBUG(\"Get value string %p %d\",\n              cval, cval ? cval->type : VIR_CONF_NONE);\n\n    if (!cval)\n        return 0;\n\n    if (cval->type != VIR_CONF_STRING) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: expected a string for '%s' parameter\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    VIR_FREE(*value);\n    *value = g_strdup(cval->str);\n\n    return 1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvirQEMUDriverConfigLoadVNCEntry(virQEMUDriverConfigPtr cfg,\n                                virConfPtr conf)\n{\n    int rv;\n\n    if (virConfGetValueBool(conf, \"vnc_auto_unix_socket\", &cfg->vncAutoUnixSocket) < 0)\n        return -1;\n    if (virConfGetValueBool(conf, \"vnc_tls\", &cfg->vncTLS) < 0)\n        return -1;\n    if ((rv = virConfGetValueBool(conf, \"vnc_tls_x509_verify\", &cfg->vncTLSx509verify)) < 0)\n        return -1;\n    if (rv == 1)\n        cfg->vncTLSx509verifyPresent = true;\n    if (virConfGetValueString(conf, \"vnc_tls_x509_cert_dir\", &cfg->vncTLSx509certdir) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"vnc_tls_x509_secret_uuid\", &cfg->vncTLSx509secretUUID) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"vnc_listen\", &cfg->vncListen) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"vnc_password\", &cfg->vncPassword) < 0)\n        return -1;\n    if (virConfGetValueBool(conf, \"vnc_sasl\", &cfg->vncSASL) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"vnc_sasl_dir\", &cfg->vncSASLdir) < 0)\n        return -1;\n    if (virConfGetValueBool(conf, \"vnc_allow_host_audio\", &cfg->vncAllowHostAudio) < 0)\n        return -1;\n\n    return 0;\n}"
  },
  {
    "function_name": "virQEMUDriverConfigLoadDefaultTLSEntry",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
    "lines": "386-402",
    "snippet": "static int\nvirQEMUDriverConfigLoadDefaultTLSEntry(virQEMUDriverConfigPtr cfg,\n                                       virConfPtr conf)\n{\n    int rv;\n\n    if ((rv = virConfGetValueString(conf, \"default_tls_x509_cert_dir\", &cfg->defaultTLSx509certdir)) < 0)\n        return -1;\n    cfg->defaultTLSx509certdirPresent = (rv == 1);\n    if (virConfGetValueBool(conf, \"default_tls_x509_verify\", &cfg->defaultTLSx509verify) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"default_tls_x509_secret_uuid\",\n                              &cfg->defaultTLSx509secretUUID) < 0)\n        return -1;\n\n    return 0;\n}",
    "includes": [
      "#include \"configmake.h\"",
      "#include \"virutil.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virstring.h\"",
      "#include \"virsocket.h\"",
      "#include \"virfile.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virlog.h\"",
      "#include \"virxml.h\"",
      "#include \"datatypes.h\"",
      "#include \"viralloc.h\"",
      "#include \"virconf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_firmware.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_capabilities.h\"",
      "#include \"qemu_conf.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virConfGetValueString",
          "args": [
            "conf",
            "\"default_tls_x509_secret_uuid\"",
            "&cfg->defaultTLSx509secretUUID"
          ],
          "line": 397
        },
        "resolved": true,
        "details": {
          "function_name": "virConfGetValueString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
          "lines": "875-898",
          "snippet": "int virConfGetValueString(virConfPtr conf,\n                          const char *setting,\n                          char **value)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n\n    VIR_DEBUG(\"Get value string %p %d\",\n              cval, cval ? cval->type : VIR_CONF_NONE);\n\n    if (!cval)\n        return 0;\n\n    if (cval->type != VIR_CONF_STRING) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: expected a string for '%s' parameter\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    VIR_FREE(*value);\n    *value = g_strdup(cval->str);\n\n    return 1;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nint virConfGetValueString(virConfPtr conf,\n                          const char *setting,\n                          char **value)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n\n    VIR_DEBUG(\"Get value string %p %d\",\n              cval, cval ? cval->type : VIR_CONF_NONE);\n\n    if (!cval)\n        return 0;\n\n    if (cval->type != VIR_CONF_STRING) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: expected a string for '%s' parameter\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    VIR_FREE(*value);\n    *value = g_strdup(cval->str);\n\n    return 1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virConfGetValueBool",
          "args": [
            "conf",
            "\"default_tls_x509_verify\"",
            "&cfg->defaultTLSx509verify"
          ],
          "line": 395
        },
        "resolved": true,
        "details": {
          "function_name": "virConfGetValueBool",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virconf.c",
          "lines": "1002-1031",
          "snippet": "int virConfGetValueBool(virConfPtr conf,\n                        const char *setting,\n                        bool *value)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n\n    VIR_DEBUG(\"Get value bool %p %d\",\n              cval, cval ? cval->type : VIR_CONF_NONE);\n\n    if (!cval)\n        return 0;\n\n    if (cval->type != VIR_CONF_ULLONG) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: expected a bool for '%s' parameter\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    if (((unsigned long long)cval->l) > 1) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: value for '%s' parameter must be 0 or 1\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    *value = cval->l == 1;\n\n    return 1;\n}",
          "includes": [
            "#include \"configmake.h\"",
            "#include \"virstring.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virlog.h\"",
            "#include \"virutil.h\"",
            "#include \"virconf.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virerror.h\"",
            "#include <fcntl.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"configmake.h\"\n#include \"virstring.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virlog.h\"\n#include \"virutil.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <config.h>\n\nint virConfGetValueBool(virConfPtr conf,\n                        const char *setting,\n                        bool *value)\n{\n    virConfValuePtr cval = virConfGetValue(conf, setting);\n\n    VIR_DEBUG(\"Get value bool %p %d\",\n              cval, cval ? cval->type : VIR_CONF_NONE);\n\n    if (!cval)\n        return 0;\n\n    if (cval->type != VIR_CONF_ULLONG) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: expected a bool for '%s' parameter\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    if (((unsigned long long)cval->l) > 1) {\n        virReportError(VIR_ERR_INTERNAL_ERROR,\n                       _(\"%s: value for '%s' parameter must be 0 or 1\"),\n                       conf->filename, setting);\n        return -1;\n    }\n\n    *value = cval->l == 1;\n\n    return 1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvirQEMUDriverConfigLoadDefaultTLSEntry(virQEMUDriverConfigPtr cfg,\n                                       virConfPtr conf)\n{\n    int rv;\n\n    if ((rv = virConfGetValueString(conf, \"default_tls_x509_cert_dir\", &cfg->defaultTLSx509certdir)) < 0)\n        return -1;\n    cfg->defaultTLSx509certdirPresent = (rv == 1);\n    if (virConfGetValueBool(conf, \"default_tls_x509_verify\", &cfg->defaultTLSx509verify) < 0)\n        return -1;\n    if (virConfGetValueString(conf, \"default_tls_x509_secret_uuid\",\n                              &cfg->defaultTLSx509secretUUID) < 0)\n        return -1;\n\n    return 0;\n}"
  },
  {
    "function_name": "virQEMUDriverConfigHugeTLBFSInit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
    "lines": "372-383",
    "snippet": "static int\nvirQEMUDriverConfigHugeTLBFSInit(virHugeTLBFSPtr hugetlbfs,\n                                 const char *path,\n                                 bool deflt)\n{\n    hugetlbfs->mnt_dir = g_strdup(path);\n    if (virFileGetHugepageSize(path, &hugetlbfs->size) < 0)\n        return -1;\n\n    hugetlbfs->deflt = deflt;\n    return 0;\n}",
    "includes": [
      "#include \"configmake.h\"",
      "#include \"virutil.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virstring.h\"",
      "#include \"virsocket.h\"",
      "#include \"virfile.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virlog.h\"",
      "#include \"virxml.h\"",
      "#include \"datatypes.h\"",
      "#include \"viralloc.h\"",
      "#include \"virconf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_firmware.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_capabilities.h\"",
      "#include \"qemu_conf.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virFileGetHugepageSize",
          "args": [
            "path",
            "&hugetlbfs->size"
          ],
          "line": 378
        },
        "resolved": true,
        "details": {
          "function_name": "virFileGetHugepageSize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "3655-3662",
          "snippet": "int\nvirFileGetHugepageSize(const char *path G_GNUC_UNUSED,\n                       unsigned long long *size G_GNUC_UNUSED)\n{\n    /* XXX implement me :-) */\n    virReportUnsupportedError();\n    return -1;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileGetHugepageSize(const char *path G_GNUC_UNUSED,\n                       unsigned long long *size G_GNUC_UNUSED)\n{\n    /* XXX implement me :-) */\n    virReportUnsupportedError();\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "path"
          ],
          "line": 377
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int\nvirQEMUDriverConfigHugeTLBFSInit(virHugeTLBFSPtr hugetlbfs,\n                                 const char *path,\n                                 bool deflt)\n{\n    hugetlbfs->mnt_dir = g_strdup(path);\n    if (virFileGetHugepageSize(path, &hugetlbfs->size) < 0)\n        return -1;\n\n    hugetlbfs->deflt = deflt;\n    return 0;\n}"
  },
  {
    "function_name": "virQEMUDriverConfigDispose",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
    "lines": "295-369",
    "snippet": "static void virQEMUDriverConfigDispose(void *obj)\n{\n    virQEMUDriverConfigPtr cfg = obj;\n\n    virBitmapFree(cfg->namespaces);\n\n    virStringListFree(cfg->cgroupDeviceACL);\n    VIR_FREE(cfg->uri);\n    VIR_FREE(cfg->root);\n\n    VIR_FREE(cfg->configBaseDir);\n    VIR_FREE(cfg->configDir);\n    VIR_FREE(cfg->autostartDir);\n    VIR_FREE(cfg->logDir);\n    VIR_FREE(cfg->swtpmLogDir);\n    VIR_FREE(cfg->stateDir);\n    VIR_FREE(cfg->swtpmStateDir);\n    VIR_FREE(cfg->slirpStateDir);\n\n    VIR_FREE(cfg->libDir);\n    VIR_FREE(cfg->cacheDir);\n    VIR_FREE(cfg->saveDir);\n    VIR_FREE(cfg->snapshotDir);\n    VIR_FREE(cfg->checkpointDir);\n    VIR_FREE(cfg->channelTargetDir);\n    VIR_FREE(cfg->nvramDir);\n\n    VIR_FREE(cfg->defaultTLSx509certdir);\n    VIR_FREE(cfg->defaultTLSx509secretUUID);\n\n    VIR_FREE(cfg->vncTLSx509certdir);\n    VIR_FREE(cfg->vncTLSx509secretUUID);\n    VIR_FREE(cfg->vncListen);\n    VIR_FREE(cfg->vncPassword);\n    VIR_FREE(cfg->vncSASLdir);\n\n    VIR_FREE(cfg->spiceTLSx509certdir);\n    VIR_FREE(cfg->spiceListen);\n    VIR_FREE(cfg->spicePassword);\n    VIR_FREE(cfg->spiceSASLdir);\n\n    VIR_FREE(cfg->chardevTLSx509certdir);\n    VIR_FREE(cfg->chardevTLSx509secretUUID);\n\n    VIR_FREE(cfg->vxhsTLSx509certdir);\n    VIR_FREE(cfg->nbdTLSx509certdir);\n\n    VIR_FREE(cfg->migrateTLSx509certdir);\n    VIR_FREE(cfg->migrateTLSx509secretUUID);\n\n    while (cfg->nhugetlbfs) {\n        cfg->nhugetlbfs--;\n        VIR_FREE(cfg->hugetlbfs[cfg->nhugetlbfs].mnt_dir);\n    }\n    VIR_FREE(cfg->hugetlbfs);\n    VIR_FREE(cfg->bridgeHelperName);\n    VIR_FREE(cfg->prHelperName);\n    VIR_FREE(cfg->slirpHelperName);\n\n    VIR_FREE(cfg->saveImageFormat);\n    VIR_FREE(cfg->dumpImageFormat);\n    VIR_FREE(cfg->snapshotImageFormat);\n    VIR_FREE(cfg->autoDumpPath);\n\n    virStringListFree(cfg->securityDriverNames);\n\n    VIR_FREE(cfg->lockManagerName);\n\n    virFirmwareFreeList(cfg->firmwares, cfg->nfirmwares);\n\n    VIR_FREE(cfg->memoryBackingDir);\n    VIR_FREE(cfg->swtpmStorageDir);\n\n    virStringListFree(cfg->capabilityfilters);\n}",
    "includes": [
      "#include \"configmake.h\"",
      "#include \"virutil.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virstring.h\"",
      "#include \"virsocket.h\"",
      "#include \"virfile.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virlog.h\"",
      "#include \"virxml.h\"",
      "#include \"datatypes.h\"",
      "#include \"viralloc.h\"",
      "#include \"virconf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_firmware.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_capabilities.h\"",
      "#include \"qemu_conf.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [
      "static void virQEMUDriverConfigDispose(void *obj);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "virStringListFree",
          "args": [
            "cfg->capabilityfilters"
          ],
          "line": 368
        },
        "resolved": true,
        "details": {
          "function_name": "virStringListFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "306-314",
          "snippet": "void virStringListFree(char **strings)\n{\n    char **tmp = strings;\n    while (tmp && *tmp) {\n        VIR_FREE(*tmp);\n        tmp++;\n    }\n    VIR_FREE(strings);\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nvoid virStringListFree(char **strings)\n{\n    char **tmp = strings;\n    while (tmp && *tmp) {\n        VIR_FREE(*tmp);\n        tmp++;\n    }\n    VIR_FREE(strings);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "cfg->swtpmStorageDir"
          ],
          "line": 366
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "cfg->memoryBackingDir"
          ],
          "line": 365
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virFirmwareFreeList",
          "args": [
            "cfg->firmwares",
            "cfg->nfirmwares"
          ],
          "line": 363
        },
        "resolved": true,
        "details": {
          "function_name": "virFirmwareFreeList",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfirmware.c",
          "lines": "46-55",
          "snippet": "void\nvirFirmwareFreeList(virFirmwarePtr *firmwares, size_t nfirmwares)\n{\n    size_t i;\n\n    for (i = 0; i < nfirmwares; i++)\n        virFirmwareFree(firmwares[i]);\n\n    VIR_FREE(firmwares);\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfirmware.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfirmware.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <config.h>\n\nvoid\nvirFirmwareFreeList(virFirmwarePtr *firmwares, size_t nfirmwares)\n{\n    size_t i;\n\n    for (i = 0; i < nfirmwares; i++)\n        virFirmwareFree(firmwares[i]);\n\n    VIR_FREE(firmwares);\n}"
        }
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "cfg->lockManagerName"
          ],
          "line": 361
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "cfg->autoDumpPath"
          ],
          "line": 357
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "cfg->snapshotImageFormat"
          ],
          "line": 356
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "cfg->dumpImageFormat"
          ],
          "line": 355
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "cfg->saveImageFormat"
          ],
          "line": 354
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "cfg->slirpHelperName"
          ],
          "line": 352
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "cfg->prHelperName"
          ],
          "line": 351
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "cfg->bridgeHelperName"
          ],
          "line": 350
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "cfg->hugetlbfs"
          ],
          "line": 349
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "cfg->hugetlbfs[cfg->nhugetlbfs].mnt_dir"
          ],
          "line": 347
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "cfg->migrateTLSx509secretUUID"
          ],
          "line": 343
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "cfg->migrateTLSx509certdir"
          ],
          "line": 342
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "cfg->nbdTLSx509certdir"
          ],
          "line": 340
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "cfg->vxhsTLSx509certdir"
          ],
          "line": 339
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "cfg->chardevTLSx509secretUUID"
          ],
          "line": 337
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "cfg->chardevTLSx509certdir"
          ],
          "line": 336
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "cfg->spiceSASLdir"
          ],
          "line": 334
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "cfg->spicePassword"
          ],
          "line": 333
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "cfg->spiceListen"
          ],
          "line": 332
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "cfg->spiceTLSx509certdir"
          ],
          "line": 331
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "cfg->vncSASLdir"
          ],
          "line": 329
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "cfg->vncPassword"
          ],
          "line": 328
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "cfg->vncListen"
          ],
          "line": 327
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "cfg->vncTLSx509secretUUID"
          ],
          "line": 326
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "cfg->vncTLSx509certdir"
          ],
          "line": 325
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "cfg->defaultTLSx509secretUUID"
          ],
          "line": 323
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "cfg->defaultTLSx509certdir"
          ],
          "line": 322
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "cfg->nvramDir"
          ],
          "line": 320
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "cfg->channelTargetDir"
          ],
          "line": 319
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "cfg->checkpointDir"
          ],
          "line": 318
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "cfg->snapshotDir"
          ],
          "line": 317
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "cfg->saveDir"
          ],
          "line": 316
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "cfg->cacheDir"
          ],
          "line": 315
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "cfg->libDir"
          ],
          "line": 314
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "cfg->slirpStateDir"
          ],
          "line": 312
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "cfg->swtpmStateDir"
          ],
          "line": 311
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "cfg->stateDir"
          ],
          "line": 310
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "cfg->swtpmLogDir"
          ],
          "line": 309
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "cfg->logDir"
          ],
          "line": 308
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "cfg->autostartDir"
          ],
          "line": 307
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "cfg->configDir"
          ],
          "line": 306
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "cfg->configBaseDir"
          ],
          "line": 305
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "cfg->root"
          ],
          "line": 303
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "cfg->uri"
          ],
          "line": 302
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBitmapFree",
          "args": [
            "cfg->namespaces"
          ],
          "line": 299
        },
        "resolved": true,
        "details": {
          "function_name": "virBitmapFree",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
          "lines": "128-135",
          "snippet": "void\nvirBitmapFree(virBitmapPtr bitmap)\n{\n    if (bitmap) {\n        VIR_FREE(bitmap->map);\n        VIR_FREE(bitmap);\n    }\n}",
          "includes": [
            "#include \"virerror.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbitmap.h\"",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\nvoid\nvirBitmapFree(virBitmapPtr bitmap)\n{\n    if (bitmap) {\n        VIR_FREE(bitmap->map);\n        VIR_FREE(bitmap);\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic void virQEMUDriverConfigDispose(void *obj);\n\nstatic void virQEMUDriverConfigDispose(void *obj)\n{\n    virQEMUDriverConfigPtr cfg = obj;\n\n    virBitmapFree(cfg->namespaces);\n\n    virStringListFree(cfg->cgroupDeviceACL);\n    VIR_FREE(cfg->uri);\n    VIR_FREE(cfg->root);\n\n    VIR_FREE(cfg->configBaseDir);\n    VIR_FREE(cfg->configDir);\n    VIR_FREE(cfg->autostartDir);\n    VIR_FREE(cfg->logDir);\n    VIR_FREE(cfg->swtpmLogDir);\n    VIR_FREE(cfg->stateDir);\n    VIR_FREE(cfg->swtpmStateDir);\n    VIR_FREE(cfg->slirpStateDir);\n\n    VIR_FREE(cfg->libDir);\n    VIR_FREE(cfg->cacheDir);\n    VIR_FREE(cfg->saveDir);\n    VIR_FREE(cfg->snapshotDir);\n    VIR_FREE(cfg->checkpointDir);\n    VIR_FREE(cfg->channelTargetDir);\n    VIR_FREE(cfg->nvramDir);\n\n    VIR_FREE(cfg->defaultTLSx509certdir);\n    VIR_FREE(cfg->defaultTLSx509secretUUID);\n\n    VIR_FREE(cfg->vncTLSx509certdir);\n    VIR_FREE(cfg->vncTLSx509secretUUID);\n    VIR_FREE(cfg->vncListen);\n    VIR_FREE(cfg->vncPassword);\n    VIR_FREE(cfg->vncSASLdir);\n\n    VIR_FREE(cfg->spiceTLSx509certdir);\n    VIR_FREE(cfg->spiceListen);\n    VIR_FREE(cfg->spicePassword);\n    VIR_FREE(cfg->spiceSASLdir);\n\n    VIR_FREE(cfg->chardevTLSx509certdir);\n    VIR_FREE(cfg->chardevTLSx509secretUUID);\n\n    VIR_FREE(cfg->vxhsTLSx509certdir);\n    VIR_FREE(cfg->nbdTLSx509certdir);\n\n    VIR_FREE(cfg->migrateTLSx509certdir);\n    VIR_FREE(cfg->migrateTLSx509secretUUID);\n\n    while (cfg->nhugetlbfs) {\n        cfg->nhugetlbfs--;\n        VIR_FREE(cfg->hugetlbfs[cfg->nhugetlbfs].mnt_dir);\n    }\n    VIR_FREE(cfg->hugetlbfs);\n    VIR_FREE(cfg->bridgeHelperName);\n    VIR_FREE(cfg->prHelperName);\n    VIR_FREE(cfg->slirpHelperName);\n\n    VIR_FREE(cfg->saveImageFormat);\n    VIR_FREE(cfg->dumpImageFormat);\n    VIR_FREE(cfg->snapshotImageFormat);\n    VIR_FREE(cfg->autoDumpPath);\n\n    virStringListFree(cfg->securityDriverNames);\n\n    VIR_FREE(cfg->lockManagerName);\n\n    virFirmwareFreeList(cfg->firmwares, cfg->nfirmwares);\n\n    VIR_FREE(cfg->memoryBackingDir);\n    VIR_FREE(cfg->swtpmStorageDir);\n\n    virStringListFree(cfg->capabilityfilters);\n}"
  },
  {
    "function_name": "virQEMUDriverConfigNew",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
    "lines": "105-292",
    "snippet": "virQEMUDriverConfigPtr virQEMUDriverConfigNew(bool privileged,\n                                              const char *root)\n{\n    g_autoptr(virQEMUDriverConfig) cfg = NULL;\n\n    if (virQEMUConfigInitialize() < 0)\n        return NULL;\n\n    if (!(cfg = virObjectNew(virQEMUDriverConfigClass)))\n        return NULL;\n\n    if (root) {\n        cfg->uri = g_strdup_printf(\"qemu:///embed?root=%s\", root);\n        cfg->root = g_strdup(root);\n    } else {\n        cfg->uri = g_strdup(privileged ? \"qemu:///system\" : \"qemu:///session\");\n    }\n\n    if (privileged) {\n        if (virGetUserID(QEMU_USER, &cfg->user) < 0)\n            return NULL;\n        if (virGetGroupID(QEMU_GROUP, &cfg->group) < 0)\n            return NULL;\n    } else {\n        cfg->user = (uid_t)-1;\n        cfg->group = (gid_t)-1;\n    }\n    cfg->dynamicOwnership = privileged;\n    cfg->rememberOwner = privileged;\n\n    cfg->cgroupControllers = -1; /* -1 == auto-detect */\n\n    if (root != NULL) {\n        cfg->logDir = g_strdup_printf(\"%s/log/qemu\", root);\n        cfg->swtpmLogDir = g_strdup_printf(\"%s/log/swtpm\", root);\n        cfg->configBaseDir = g_strdup_printf(\"%s/etc\", root);\n        cfg->stateDir = g_strdup_printf(\"%s/run/qemu\", root);\n        cfg->swtpmStateDir = g_strdup_printf(\"%s/run/swtpm\", root);\n        cfg->cacheDir = g_strdup_printf(\"%s/cache/qemu\", root);\n        cfg->libDir = g_strdup_printf(\"%s/lib/qemu\", root);\n        cfg->swtpmStorageDir = g_strdup_printf(\"%s/lib/swtpm\", root);\n\n        cfg->saveDir = g_strdup_printf(\"%s/save\", cfg->libDir);\n        cfg->snapshotDir = g_strdup_printf(\"%s/snapshot\", cfg->libDir);\n        cfg->checkpointDir = g_strdup_printf(\"%s/checkpoint\", cfg->libDir);\n        cfg->autoDumpPath = g_strdup_printf(\"%s/dump\", cfg->libDir);\n        cfg->channelTargetDir = g_strdup_printf(\"%s/channel/target\", cfg->libDir);\n        cfg->nvramDir = g_strdup_printf(\"%s/nvram\", cfg->libDir);\n        cfg->memoryBackingDir = g_strdup_printf(\"%s/ram\", cfg->libDir);\n    } else if (privileged) {\n        cfg->logDir = g_strdup_printf(\"%s/log/libvirt/qemu\", LOCALSTATEDIR);\n\n        cfg->swtpmLogDir = g_strdup_printf(\"%s/log/swtpm/libvirt/qemu\",\n                                           LOCALSTATEDIR);\n\n        cfg->configBaseDir = g_strdup(SYSCONFDIR \"/libvirt\");\n\n        cfg->stateDir = g_strdup_printf(\"%s/libvirt/qemu\", RUNSTATEDIR);\n\n        cfg->swtpmStateDir = g_strdup_printf(\"%s/libvirt/qemu/swtpm\", RUNSTATEDIR);\n\n        cfg->cacheDir = g_strdup_printf(\"%s/cache/libvirt/qemu\", LOCALSTATEDIR);\n\n        cfg->libDir = g_strdup_printf(\"%s/lib/libvirt/qemu\", LOCALSTATEDIR);\n        cfg->saveDir = g_strdup_printf(\"%s/save\", cfg->libDir);\n        cfg->snapshotDir = g_strdup_printf(\"%s/snapshot\", cfg->libDir);\n        cfg->checkpointDir = g_strdup_printf(\"%s/checkpoint\", cfg->libDir);\n        cfg->autoDumpPath = g_strdup_printf(\"%s/dump\", cfg->libDir);\n        cfg->channelTargetDir = g_strdup_printf(\"%s/channel/target\", cfg->libDir);\n        cfg->nvramDir = g_strdup_printf(\"%s/nvram\", cfg->libDir);\n        cfg->memoryBackingDir = g_strdup_printf(\"%s/ram\", cfg->libDir);\n        cfg->swtpmStorageDir = g_strdup_printf(\"%s/lib/libvirt/swtpm\",\n                                               LOCALSTATEDIR);\n        if (!virDoesUserExist(\"tss\") ||\n            virGetUserID(\"tss\", &cfg->swtpm_user) < 0)\n            cfg->swtpm_user = 0; /* fall back to root */\n        if (!virDoesGroupExist(\"tss\") ||\n            virGetGroupID(\"tss\", &cfg->swtpm_group) < 0)\n            cfg->swtpm_group = 0; /* fall back to root */\n    } else {\n        g_autofree char *rundir = NULL;\n        g_autofree char *cachedir = NULL;\n\n        cachedir = virGetUserCacheDirectory();\n\n        cfg->logDir = g_strdup_printf(\"%s/qemu/log\", cachedir);\n        cfg->swtpmLogDir = g_strdup_printf(\"%s/qemu/log\", cachedir);\n        cfg->cacheDir = g_strdup_printf(\"%s/qemu/cache\", cachedir);\n\n        rundir = virGetUserRuntimeDirectory();\n        cfg->stateDir = g_strdup_printf(\"%s/qemu/run\", rundir);\n\n        cfg->swtpmStateDir = g_strdup_printf(\"%s/swtpm\", cfg->stateDir);\n\n        cfg->configBaseDir = virGetUserConfigDirectory();\n\n        cfg->libDir = g_strdup_printf(\"%s/qemu/lib\", cfg->configBaseDir);\n        cfg->saveDir = g_strdup_printf(\"%s/qemu/save\", cfg->configBaseDir);\n        cfg->snapshotDir = g_strdup_printf(\"%s/qemu/snapshot\", cfg->configBaseDir);\n        cfg->checkpointDir = g_strdup_printf(\"%s/qemu/checkpoint\",\n                                             cfg->configBaseDir);\n        cfg->autoDumpPath = g_strdup_printf(\"%s/qemu/dump\", cfg->configBaseDir);\n        cfg->channelTargetDir = g_strdup_printf(\"%s/qemu/channel/target\",\n                                                cfg->configBaseDir);\n        cfg->nvramDir = g_strdup_printf(\"%s/qemu/nvram\", cfg->configBaseDir);\n        cfg->memoryBackingDir = g_strdup_printf(\"%s/qemu/ram\", cfg->configBaseDir);\n        cfg->swtpmStorageDir = g_strdup_printf(\"%s/qemu/swtpm\",\n                                               cfg->configBaseDir);\n    }\n\n    if (privileged) {\n        if (!virDoesUserExist(\"tss\") ||\n            virGetUserID(\"tss\", &cfg->swtpm_user) < 0)\n            cfg->swtpm_user = 0; /* fall back to root */\n        if (!virDoesGroupExist(\"tss\") ||\n            virGetGroupID(\"tss\", &cfg->swtpm_group) < 0)\n            cfg->swtpm_group = 0; /* fall back to root */\n    } else {\n        cfg->swtpm_user = (uid_t)-1;\n        cfg->swtpm_group = (gid_t)-1;\n    }\n\n    cfg->configDir = g_strdup_printf(\"%s/qemu\", cfg->configBaseDir);\n    cfg->autostartDir = g_strdup_printf(\"%s/qemu/autostart\", cfg->configBaseDir);\n    cfg->slirpStateDir = g_strdup_printf(\"%s/slirp\", cfg->stateDir);\n\n    /* Set the default directory to find TLS X.509 certificates.\n     * This will then be used as a fallback if the service specific\n     * directory doesn't exist (although we don't check if this exists).\n     */\n    if (root == NULL) {\n        cfg->defaultTLSx509certdir = g_strdup(SYSCONFDIR \"pki/qemu\");\n    } else {\n        cfg->defaultTLSx509certdir = g_strdup_printf(\"%s/etc/pki/qemu\", root);\n    }\n\n    cfg->vncListen = g_strdup(VIR_LOOPBACK_IPV4_ADDR);\n    cfg->spiceListen = g_strdup(VIR_LOOPBACK_IPV4_ADDR);\n\n    cfg->remotePortMin = QEMU_REMOTE_PORT_MIN;\n    cfg->remotePortMax = QEMU_REMOTE_PORT_MAX;\n\n    cfg->webSocketPortMin = QEMU_WEBSOCKET_PORT_MIN;\n    cfg->webSocketPortMax = QEMU_WEBSOCKET_PORT_MAX;\n\n    cfg->migrationPortMin = QEMU_MIGRATION_PORT_MIN;\n    cfg->migrationPortMax = QEMU_MIGRATION_PORT_MAX;\n\n    /* For privileged driver, try and find hugetlbfs mounts automatically.\n     * Non-privileged driver requires admin to create a dir for the\n     * user, chown it, and then let user configure it manually. */\n    if (privileged &&\n        virFileFindHugeTLBFS(&cfg->hugetlbfs, &cfg->nhugetlbfs) < 0) {\n        /* This however is not implemented on all platforms. */\n        if (virGetLastErrorCode() != VIR_ERR_NO_SUPPORT)\n            return NULL;\n    }\n\n    cfg->bridgeHelperName = g_strdup(QEMU_BRIDGE_HELPER);\n    cfg->prHelperName = g_strdup(QEMU_PR_HELPER);\n    cfg->slirpHelperName = g_strdup(QEMU_SLIRP_HELPER);\n\n    cfg->securityDefaultConfined = true;\n    cfg->securityRequireConfined = false;\n\n    cfg->keepAliveInterval = 5;\n    cfg->keepAliveCount = 5;\n    cfg->seccompSandbox = -1;\n\n    cfg->logTimestamp = true;\n    cfg->glusterDebugLevel = 4;\n    cfg->stdioLogD = true;\n\n    if (!(cfg->namespaces = virBitmapNew(QEMU_DOMAIN_NS_LAST)))\n        return NULL;\n\n    if (privileged &&\n        qemuDomainNamespaceAvailable(QEMU_DOMAIN_NS_MOUNT) &&\n        virBitmapSetBit(cfg->namespaces, QEMU_DOMAIN_NS_MOUNT) < 0)\n        return NULL;\n\n    if (virFirmwareParseList(DEFAULT_LOADER_NVRAM,\n                             &cfg->firmwares,\n                             &cfg->nfirmwares) < 0)\n        return NULL;\n\n    return g_steal_pointer(&cfg);\n}",
    "includes": [
      "#include \"configmake.h\"",
      "#include \"virutil.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virstring.h\"",
      "#include \"virsocket.h\"",
      "#include \"virfile.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virlog.h\"",
      "#include \"virxml.h\"",
      "#include \"datatypes.h\"",
      "#include \"viralloc.h\"",
      "#include \"virconf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_firmware.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_capabilities.h\"",
      "#include \"qemu_conf.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [
      "#define QEMU_MIGRATION_PORT_MAX 49215",
      "#define QEMU_MIGRATION_PORT_MIN 49152",
      "#define QEMU_WEBSOCKET_PORT_MAX 65535",
      "#define QEMU_WEBSOCKET_PORT_MIN 5700",
      "#define QEMU_REMOTE_PORT_MAX 65535",
      "#define QEMU_REMOTE_PORT_MIN 5900"
    ],
    "globals_used": [
      "static virClassPtr virQEMUDriverConfigClass;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_steal_pointer",
          "args": [
            "&cfg"
          ],
          "line": 291
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virFirmwareParseList",
          "args": [
            "DEFAULT_LOADER_NVRAM",
            "&cfg->firmwares",
            "&cfg->nfirmwares"
          ],
          "line": 286
        },
        "resolved": true,
        "details": {
          "function_name": "virFirmwareParseList",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfirmware.c",
          "lines": "92-133",
          "snippet": "int\nvirFirmwareParseList(const char *list,\n                     virFirmwarePtr **firmwares,\n                     size_t *nfirmwares)\n{\n    int ret = -1;\n    char **token;\n    size_t i, j;\n\n    if (!(token = virStringSplit(list, \":\", 0)))\n        goto cleanup;\n\n    for (i = 0; token[i]; i += 2) {\n        if (!token[i] || !token[i + 1] ||\n            STREQ(token[i], \"\") || STREQ(token[i + 1], \"\")) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Invalid --with-loader-nvram list: %s\"),\n                           list);\n            goto cleanup;\n        }\n    }\n\n    if (i) {\n        if (VIR_ALLOC_N(*firmwares, i / 2) < 0)\n            goto cleanup;\n        *nfirmwares = i / 2;\n\n        for (j = 0; j < i / 2; j++) {\n            virFirmwarePtr *fws = *firmwares;\n\n            if (VIR_ALLOC(fws[j]) < 0)\n                goto cleanup;\n            fws[j]->name = g_strdup(token[2 * j]);\n            fws[j]->nvram = g_strdup(token[2 * j + 1]);\n        }\n    }\n\n    ret = 0;\n cleanup:\n    virStringListFree(token);\n    return ret;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virlog.h\"",
            "#include \"virfirmware.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virlog.h\"\n#include \"virfirmware.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include <config.h>\n\nint\nvirFirmwareParseList(const char *list,\n                     virFirmwarePtr **firmwares,\n                     size_t *nfirmwares)\n{\n    int ret = -1;\n    char **token;\n    size_t i, j;\n\n    if (!(token = virStringSplit(list, \":\", 0)))\n        goto cleanup;\n\n    for (i = 0; token[i]; i += 2) {\n        if (!token[i] || !token[i + 1] ||\n            STREQ(token[i], \"\") || STREQ(token[i + 1], \"\")) {\n            virReportError(VIR_ERR_INTERNAL_ERROR,\n                           _(\"Invalid --with-loader-nvram list: %s\"),\n                           list);\n            goto cleanup;\n        }\n    }\n\n    if (i) {\n        if (VIR_ALLOC_N(*firmwares, i / 2) < 0)\n            goto cleanup;\n        *nfirmwares = i / 2;\n\n        for (j = 0; j < i / 2; j++) {\n            virFirmwarePtr *fws = *firmwares;\n\n            if (VIR_ALLOC(fws[j]) < 0)\n                goto cleanup;\n            fws[j]->name = g_strdup(token[2 * j]);\n            fws[j]->nvram = g_strdup(token[2 * j + 1]);\n        }\n    }\n\n    ret = 0;\n cleanup:\n    virStringListFree(token);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBitmapSetBit",
          "args": [
            "cfg->namespaces",
            "QEMU_DOMAIN_NS_MOUNT"
          ],
          "line": 283
        },
        "resolved": true,
        "details": {
          "function_name": "virBitmapSetBitExpand",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
          "lines": "222-231",
          "snippet": "int\nvirBitmapSetBitExpand(virBitmapPtr bitmap,\n                      size_t b)\n{\n    if (bitmap->nbits <= b && virBitmapExpand(bitmap, b) < 0)\n        return -1;\n\n    bitmap->map[VIR_BITMAP_UNIT_OFFSET(b)] |= VIR_BITMAP_BIT(b);\n    return 0;\n}",
          "includes": [
            "#include \"virerror.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbitmap.h\"",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\nint\nvirBitmapSetBitExpand(virBitmapPtr bitmap,\n                      size_t b)\n{\n    if (bitmap->nbits <= b && virBitmapExpand(bitmap, b) < 0)\n        return -1;\n\n    bitmap->map[VIR_BITMAP_UNIT_OFFSET(b)] |= VIR_BITMAP_BIT(b);\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "qemuDomainNamespaceAvailable",
          "args": [
            "QEMU_DOMAIN_NS_MOUNT"
          ],
          "line": 282
        },
        "resolved": true,
        "details": {
          "function_name": "qemuDomainNamespaceAvailable",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_domain.c",
          "lines": "15352-15378",
          "snippet": "bool\nqemuDomainNamespaceAvailable(qemuDomainNamespace ns G_GNUC_UNUSED)\n{\n#if !defined(__linux__)\n    /* Namespaces are Linux specific. */\n    return false;\n\n#else /* defined(__linux__) */\n\n    switch (ns) {\n    case QEMU_DOMAIN_NS_MOUNT:\n# if !defined(HAVE_SYS_ACL_H) || !defined(WITH_SELINUX)\n        /* We can't create the exact copy of paths if either of\n         * these is not available. */\n        return false;\n# else\n        if (virProcessNamespaceAvailable(VIR_PROCESS_NAMESPACE_MNT) < 0)\n            return false;\n# endif\n        break;\n    case QEMU_DOMAIN_NS_LAST:\n        break;\n    }\n\n    return true;\n#endif /* defined(__linux__) */\n}",
          "includes": [
            "# include <selinux/selinux.h>",
            "# include <sys/mount.h>",
            "#include <fcntl.h>",
            "#include <sys/time.h>",
            "# include <sys/sysmacros.h>",
            "#include \"virdevmapper.h\"",
            "#include \"virutil.h\"",
            "#include \"backup_conf.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"locking/domain_lock.h\"",
            "#include \"logging/log_manager.h\"",
            "#include \"virsecret.h\"",
            "#include \"virsystemd.h\"",
            "#include \"virrandom.h\"",
            "#include \"vircrypto.h\"",
            "#include \"virprocess.h\"",
            "#include \"virthreadjob.h\"",
            "#include \"virstring.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"virnetdevopenvswitch.h\"",
            "#include \"virtime.h\"",
            "#include \"domain_event.h\"",
            "#include \"domain_capabilities.h\"",
            "#include \"domain_addr.h\"",
            "#include \"virfile.h\"",
            "#include \"viruuid.h\"",
            "#include \"cpu/cpu.h\"",
            "#include \"virerror.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"qemu_checkpoint.h\"",
            "#include \"qemu_blockjob.h\"",
            "#include \"qemu_extdevice.h\"",
            "#include \"qemu_slirp.h\"",
            "#include \"qemu_security.h\"",
            "#include \"qemu_migration_params.h\"",
            "#include \"qemu_migration.h\"",
            "#include \"qemu_hostdev.h\"",
            "#include \"qemu_capabilities.h\"",
            "#include \"qemu_process.h\"",
            "#include \"qemu_dbus.h\"",
            "#include \"qemu_command.h\"",
            "#include \"qemu_cgroup.h\"",
            "#include \"qemu_block.h\"",
            "#include \"qemu_alias.h\"",
            "#include \"qemu_domain.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <selinux/selinux.h>\n# include <sys/mount.h>\n#include <fcntl.h>\n#include <sys/time.h>\n# include <sys/sysmacros.h>\n#include \"virdevmapper.h\"\n#include \"virutil.h\"\n#include \"backup_conf.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"locking/domain_lock.h\"\n#include \"logging/log_manager.h\"\n#include \"virsecret.h\"\n#include \"virsystemd.h\"\n#include \"virrandom.h\"\n#include \"vircrypto.h\"\n#include \"virprocess.h\"\n#include \"virthreadjob.h\"\n#include \"virstring.h\"\n#include \"virstoragefile.h\"\n#include \"virnetdevopenvswitch.h\"\n#include \"virtime.h\"\n#include \"domain_event.h\"\n#include \"domain_capabilities.h\"\n#include \"domain_addr.h\"\n#include \"virfile.h\"\n#include \"viruuid.h\"\n#include \"cpu/cpu.h\"\n#include \"virerror.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"qemu_checkpoint.h\"\n#include \"qemu_blockjob.h\"\n#include \"qemu_extdevice.h\"\n#include \"qemu_slirp.h\"\n#include \"qemu_security.h\"\n#include \"qemu_migration_params.h\"\n#include \"qemu_migration.h\"\n#include \"qemu_hostdev.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_process.h\"\n#include \"qemu_dbus.h\"\n#include \"qemu_command.h\"\n#include \"qemu_cgroup.h\"\n#include \"qemu_block.h\"\n#include \"qemu_alias.h\"\n#include \"qemu_domain.h\"\n#include <config.h>\n\nbool\nqemuDomainNamespaceAvailable(qemuDomainNamespace ns G_GNUC_UNUSED)\n{\n#if !defined(__linux__)\n    /* Namespaces are Linux specific. */\n    return false;\n\n#else /* defined(__linux__) */\n\n    switch (ns) {\n    case QEMU_DOMAIN_NS_MOUNT:\n# if !defined(HAVE_SYS_ACL_H) || !defined(WITH_SELINUX)\n        /* We can't create the exact copy of paths if either of\n         * these is not available. */\n        return false;\n# else\n        if (virProcessNamespaceAvailable(VIR_PROCESS_NAMESPACE_MNT) < 0)\n            return false;\n# endif\n        break;\n    case QEMU_DOMAIN_NS_LAST:\n        break;\n    }\n\n    return true;\n#endif /* defined(__linux__) */\n}"
        }
      },
      {
        "call_info": {
          "callee": "virBitmapNew",
          "args": [
            "QEMU_DOMAIN_NS_LAST"
          ],
          "line": 278
        },
        "resolved": true,
        "details": {
          "function_name": "virBitmapNewString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virbitmap.c",
          "lines": "1144-1168",
          "snippet": "virBitmapPtr\nvirBitmapNewString(const char *string)\n{\n    virBitmapPtr bitmap;\n    size_t i = 0;\n    size_t len = strlen(string);\n\n    if (strspn(string, \"0123456789abcdefABCDEF\") != len) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"Invalid hexadecimal string '%s'\"), string);\n        return NULL;\n    }\n\n    bitmap = virBitmapNew(len * 4);\n    if (!bitmap)\n        return NULL;\n\n    for (i = 0; i < len; i++) {\n        unsigned long nibble = g_ascii_xdigit_value(string[len - i - 1]);\n        nibble <<= VIR_BITMAP_BIT_OFFSET(i * 4);\n        bitmap->map[VIR_BITMAP_UNIT_OFFSET(i * 4)] |= nibble;\n    }\n\n    return bitmap;\n}",
          "includes": [
            "#include \"virerror.h\"",
            "#include \"virstring.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbitmap.h\"",
            "#include <sys/types.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerror.h\"\n#include \"virstring.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virbitmap.h\"\n#include <sys/types.h>\n#include <config.h>\n\nvirBitmapPtr\nvirBitmapNewString(const char *string)\n{\n    virBitmapPtr bitmap;\n    size_t i = 0;\n    size_t len = strlen(string);\n\n    if (strspn(string, \"0123456789abcdefABCDEF\") != len) {\n        virReportError(VIR_ERR_INVALID_ARG,\n                       _(\"Invalid hexadecimal string '%s'\"), string);\n        return NULL;\n    }\n\n    bitmap = virBitmapNew(len * 4);\n    if (!bitmap)\n        return NULL;\n\n    for (i = 0; i < len; i++) {\n        unsigned long nibble = g_ascii_xdigit_value(string[len - i - 1]);\n        nibble <<= VIR_BITMAP_BIT_OFFSET(i * 4);\n        bitmap->map[VIR_BITMAP_UNIT_OFFSET(i * 4)] |= nibble;\n    }\n\n    return bitmap;\n}"
        }
      },
      {
        "call_info": {
          "callee": "g_strdup",
          "args": [
            "QEMU_SLIRP_HELPER"
          ],
          "line": 265
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virGetLastErrorCode",
          "args": [],
          "line": 259
        },
        "resolved": true,
        "details": {
          "function_name": "virGetLastErrorCode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virerror.c",
          "lines": "280-287",
          "snippet": "int\nvirGetLastErrorCode(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (!err)\n        return VIR_ERR_OK;\n    return err->code;\n}",
          "includes": [
            "#include \"virerrorpriv.h\"",
            "#include \"virstring.h\"",
            "#include \"virthread.h\"",
            "#include \"virlog.h\"",
            "#include \"viralloc.h\"",
            "#include \"datatypes.h\"",
            "#include \"virerror.h\"",
            "#include <stdarg.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virerrorpriv.h\"\n#include \"virstring.h\"\n#include \"virthread.h\"\n#include \"virlog.h\"\n#include \"viralloc.h\"\n#include \"datatypes.h\"\n#include \"virerror.h\"\n#include <stdarg.h>\n#include <config.h>\n\nint\nvirGetLastErrorCode(void)\n{\n    virErrorPtr err = virLastErrorObject();\n    if (!err)\n        return VIR_ERR_OK;\n    return err->code;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virFileFindHugeTLBFS",
          "args": [
            "&cfg->hugetlbfs",
            "&cfg->nhugetlbfs"
          ],
          "line": 257
        },
        "resolved": true,
        "details": {
          "function_name": "virFileFindHugeTLBFS",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virfile.c",
          "lines": "3664-3671",
          "snippet": "int\nvirFileFindHugeTLBFS(virHugeTLBFSPtr *ret_fs G_GNUC_UNUSED,\n                     size_t *ret_nfs G_GNUC_UNUSED)\n{\n    /* XXX implement me :-) */\n    virReportUnsupportedError();\n    return -1;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"virlog.h\"",
            "#include \"virkmod.h\"",
            "#include \"virfile.h\"",
            "#include \"virerror.h\"",
            "#include \"vircommand.h\"",
            "#include \"viralloc.h\"",
            "#include \"configmake.h\"",
            "# include <sys/xattr.h>",
            "# include <linux/cdrom.h>",
            "# include <sys/ioctl.h>",
            "#  include <linux/loop.h>",
            "# include <sys/statfs.h>",
            "#  include <linux/magic.h>",
            "#include <sys/file.h>",
            "# include <sys/acl.h>",
            "# include <sys/syscall.h>",
            "# include <sys/mman.h>",
            "# include <mntent.h>",
            "#include <dirent.h>",
            "#include <unistd.h>",
            "# include <sys/mount.h>",
            "#include <sys/stat.h>",
            "# include <libutil.h>",
            "# include <util.h>",
            "# include <pty.h>",
            "# include <termios.h>",
            "#include <fcntl.h>",
            "#include \"internal.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"virlog.h\"\n#include \"virkmod.h\"\n#include \"virfile.h\"\n#include \"virerror.h\"\n#include \"vircommand.h\"\n#include \"viralloc.h\"\n#include \"configmake.h\"\n# include <sys/xattr.h>\n# include <linux/cdrom.h>\n# include <sys/ioctl.h>\n#  include <linux/loop.h>\n# include <sys/statfs.h>\n#  include <linux/magic.h>\n#include <sys/file.h>\n# include <sys/acl.h>\n# include <sys/syscall.h>\n# include <sys/mman.h>\n# include <mntent.h>\n#include <dirent.h>\n#include <unistd.h>\n# include <sys/mount.h>\n#include <sys/stat.h>\n# include <libutil.h>\n# include <util.h>\n# include <pty.h>\n# include <termios.h>\n#include <fcntl.h>\n#include \"internal.h\"\n#include <config.h>\n\nint\nvirFileFindHugeTLBFS(virHugeTLBFSPtr *ret_fs G_GNUC_UNUSED,\n                     size_t *ret_nfs G_GNUC_UNUSED)\n{\n    /* XXX implement me :-) */\n    virReportUnsupportedError();\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virGetGroupID",
          "args": [
            "\"tss\"",
            "&cfg->swtpm_group"
          ],
          "line": 220
        },
        "resolved": true,
        "details": {
          "function_name": "virGetGroupID",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
          "lines": "1138-1145",
          "snippet": "int virGetGroupID(const char *name G_GNUC_UNUSED,\n                  gid_t *gid G_GNUC_UNUSED)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   \"%s\", _(\"virGetGroupID is not available\"));\n\n    return -1;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <sys/prctl.h>",
            "# include <cap-ng.h>",
            "# include <grp.h>",
            "# include <pwd.h>",
            "# include <libdevmapper.h>",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <conio.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nint virGetGroupID(const char *name G_GNUC_UNUSED,\n                  gid_t *gid G_GNUC_UNUSED)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   \"%s\", _(\"virGetGroupID is not available\"));\n\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDoesGroupExist",
          "args": [
            "\"tss\""
          ],
          "line": 219
        },
        "resolved": true,
        "details": {
          "function_name": "virDoesGroupExist",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
          "lines": "1073-1077",
          "snippet": "bool\nvirDoesGroupExist(const char *name G_GNUC_UNUSED)\n{\n    return false;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <sys/prctl.h>",
            "# include <cap-ng.h>",
            "# include <grp.h>",
            "# include <pwd.h>",
            "# include <libdevmapper.h>",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <conio.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nbool\nvirDoesGroupExist(const char *name G_GNUC_UNUSED)\n{\n    return false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virGetUserID",
          "args": [
            "\"tss\"",
            "&cfg->swtpm_user"
          ],
          "line": 217
        },
        "resolved": true,
        "details": {
          "function_name": "virGetUserID",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
          "lines": "1128-1135",
          "snippet": "int virGetUserID(const char *name G_GNUC_UNUSED,\n                 uid_t *uid G_GNUC_UNUSED)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   \"%s\", _(\"virGetUserID is not available\"));\n\n    return -1;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <sys/prctl.h>",
            "# include <cap-ng.h>",
            "# include <grp.h>",
            "# include <pwd.h>",
            "# include <libdevmapper.h>",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <conio.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nint virGetUserID(const char *name G_GNUC_UNUSED,\n                 uid_t *uid G_GNUC_UNUSED)\n{\n    virReportError(VIR_ERR_INTERNAL_ERROR,\n                   \"%s\", _(\"virGetUserID is not available\"));\n\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDoesUserExist",
          "args": [
            "\"tss\""
          ],
          "line": 216
        },
        "resolved": true,
        "details": {
          "function_name": "virDoesUserExist",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
          "lines": "1067-1071",
          "snippet": "bool\nvirDoesUserExist(const char *name G_GNUC_UNUSED)\n{\n    return false;\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <sys/prctl.h>",
            "# include <cap-ng.h>",
            "# include <grp.h>",
            "# include <pwd.h>",
            "# include <libdevmapper.h>",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <conio.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nbool\nvirDoesUserExist(const char *name G_GNUC_UNUSED)\n{\n    return false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virGetUserConfigDirectory",
          "args": [],
          "line": 199
        },
        "resolved": true,
        "details": {
          "function_name": "virGetUserConfigDirectory",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
          "lines": "574-581",
          "snippet": "char *virGetUserConfigDirectory(void)\n{\n#ifdef WIN32\n    return g_strdup(g_get_user_config_dir());\n#else\n    return g_build_filename(g_get_user_config_dir(), \"libvirt\", NULL);\n#endif\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <sys/prctl.h>",
            "# include <cap-ng.h>",
            "# include <grp.h>",
            "# include <pwd.h>",
            "# include <libdevmapper.h>",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <conio.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nchar *virGetUserConfigDirectory(void)\n{\n#ifdef WIN32\n    return g_strdup(g_get_user_config_dir());\n#else\n    return g_build_filename(g_get_user_config_dir(), \"libvirt\", NULL);\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "virGetUserRuntimeDirectory",
          "args": [],
          "line": 194
        },
        "resolved": true,
        "details": {
          "function_name": "virGetUserRuntimeDirectory",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
          "lines": "594-601",
          "snippet": "char *virGetUserRuntimeDirectory(void)\n{\n#ifdef WIN32\n    return g_strdup(g_get_user_runtime_dir());\n#else\n    return g_build_filename(g_get_user_runtime_dir(), \"libvirt\", NULL);\n#endif\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <sys/prctl.h>",
            "# include <cap-ng.h>",
            "# include <grp.h>",
            "# include <pwd.h>",
            "# include <libdevmapper.h>",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <conio.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nchar *virGetUserRuntimeDirectory(void)\n{\n#ifdef WIN32\n    return g_strdup(g_get_user_runtime_dir());\n#else\n    return g_build_filename(g_get_user_runtime_dir(), \"libvirt\", NULL);\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "virGetUserCacheDirectory",
          "args": [],
          "line": 188
        },
        "resolved": true,
        "details": {
          "function_name": "virGetUserCacheDirectory",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virutil.c",
          "lines": "584-591",
          "snippet": "char *virGetUserCacheDirectory(void)\n{\n#ifdef WIN32\n    return g_strdup(g_get_user_cache_dir());\n#else\n    return g_build_filename(g_get_user_cache_dir(), \"libvirt\", NULL);\n#endif\n}",
          "includes": [
            "#include \"virsocket.h\"",
            "#include \"virutil.h\"",
            "#include \"virstring.h\"",
            "#include \"virprocess.h\"",
            "#include \"vircommand.h\"",
            "#include \"virfile.h\"",
            "#include \"viralloc.h\"",
            "#include \"virbuffer.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "# include <sys/prctl.h>",
            "# include <cap-ng.h>",
            "# include <grp.h>",
            "# include <pwd.h>",
            "# include <libdevmapper.h>",
            "#include <sys/types.h>",
            "# include <sys/sysmacros.h>",
            "# include <conio.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virsocket.h\"\n#include \"virutil.h\"\n#include \"virstring.h\"\n#include \"virprocess.h\"\n#include \"vircommand.h\"\n#include \"virfile.h\"\n#include \"viralloc.h\"\n#include \"virbuffer.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n# include <sys/prctl.h>\n# include <cap-ng.h>\n# include <grp.h>\n# include <pwd.h>\n# include <libdevmapper.h>\n#include <sys/types.h>\n# include <sys/sysmacros.h>\n# include <conio.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <config.h>\n\nchar *virGetUserCacheDirectory(void)\n{\n#ifdef WIN32\n    return g_strdup(g_get_user_cache_dir());\n#else\n    return g_build_filename(g_get_user_cache_dir(), \"libvirt\", NULL);\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "virObjectNew",
          "args": [
            "virQEMUDriverConfigClass"
          ],
          "line": 113
        },
        "resolved": true,
        "details": {
          "function_name": "virObjectNew",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "236-253",
          "snippet": "void *\nvirObjectNew(virClassPtr klass)\n{\n    virObjectPtr obj = NULL;\n\n    if (VIR_ALLOC_VAR(obj,\n                      char,\n                      klass->objectSize - sizeof(virObject)) < 0)\n        return NULL;\n\n    obj->u.s.magic = klass->magic;\n    obj->klass = klass;\n    g_atomic_int_set(&obj->u.s.refs, 1);\n\n    PROBE(OBJECT_NEW, \"obj=%p classname=%s\", obj, obj->klass->name);\n\n    return obj;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nvoid *\nvirObjectNew(virClassPtr klass)\n{\n    virObjectPtr obj = NULL;\n\n    if (VIR_ALLOC_VAR(obj,\n                      char,\n                      klass->objectSize - sizeof(virObject)) < 0)\n        return NULL;\n\n    obj->u.s.magic = klass->magic;\n    obj->klass = klass;\n    g_atomic_int_set(&obj->u.s.refs, 1);\n\n    PROBE(OBJECT_NEW, \"obj=%p classname=%s\", obj, obj->klass->name);\n\n    return obj;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virQEMUConfigInitialize",
          "args": [],
          "line": 110
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\n#define QEMU_MIGRATION_PORT_MAX 49215\n#define QEMU_MIGRATION_PORT_MIN 49152\n#define QEMU_WEBSOCKET_PORT_MAX 65535\n#define QEMU_WEBSOCKET_PORT_MIN 5700\n#define QEMU_REMOTE_PORT_MAX 65535\n#define QEMU_REMOTE_PORT_MIN 5900\n\nstatic virClassPtr virQEMUDriverConfigClass;\n\nvirQEMUDriverConfigPtr virQEMUDriverConfigNew(bool privileged,\n                                              const char *root)\n{\n    g_autoptr(virQEMUDriverConfig) cfg = NULL;\n\n    if (virQEMUConfigInitialize() < 0)\n        return NULL;\n\n    if (!(cfg = virObjectNew(virQEMUDriverConfigClass)))\n        return NULL;\n\n    if (root) {\n        cfg->uri = g_strdup_printf(\"qemu:///embed?root=%s\", root);\n        cfg->root = g_strdup(root);\n    } else {\n        cfg->uri = g_strdup(privileged ? \"qemu:///system\" : \"qemu:///session\");\n    }\n\n    if (privileged) {\n        if (virGetUserID(QEMU_USER, &cfg->user) < 0)\n            return NULL;\n        if (virGetGroupID(QEMU_GROUP, &cfg->group) < 0)\n            return NULL;\n    } else {\n        cfg->user = (uid_t)-1;\n        cfg->group = (gid_t)-1;\n    }\n    cfg->dynamicOwnership = privileged;\n    cfg->rememberOwner = privileged;\n\n    cfg->cgroupControllers = -1; /* -1 == auto-detect */\n\n    if (root != NULL) {\n        cfg->logDir = g_strdup_printf(\"%s/log/qemu\", root);\n        cfg->swtpmLogDir = g_strdup_printf(\"%s/log/swtpm\", root);\n        cfg->configBaseDir = g_strdup_printf(\"%s/etc\", root);\n        cfg->stateDir = g_strdup_printf(\"%s/run/qemu\", root);\n        cfg->swtpmStateDir = g_strdup_printf(\"%s/run/swtpm\", root);\n        cfg->cacheDir = g_strdup_printf(\"%s/cache/qemu\", root);\n        cfg->libDir = g_strdup_printf(\"%s/lib/qemu\", root);\n        cfg->swtpmStorageDir = g_strdup_printf(\"%s/lib/swtpm\", root);\n\n        cfg->saveDir = g_strdup_printf(\"%s/save\", cfg->libDir);\n        cfg->snapshotDir = g_strdup_printf(\"%s/snapshot\", cfg->libDir);\n        cfg->checkpointDir = g_strdup_printf(\"%s/checkpoint\", cfg->libDir);\n        cfg->autoDumpPath = g_strdup_printf(\"%s/dump\", cfg->libDir);\n        cfg->channelTargetDir = g_strdup_printf(\"%s/channel/target\", cfg->libDir);\n        cfg->nvramDir = g_strdup_printf(\"%s/nvram\", cfg->libDir);\n        cfg->memoryBackingDir = g_strdup_printf(\"%s/ram\", cfg->libDir);\n    } else if (privileged) {\n        cfg->logDir = g_strdup_printf(\"%s/log/libvirt/qemu\", LOCALSTATEDIR);\n\n        cfg->swtpmLogDir = g_strdup_printf(\"%s/log/swtpm/libvirt/qemu\",\n                                           LOCALSTATEDIR);\n\n        cfg->configBaseDir = g_strdup(SYSCONFDIR \"/libvirt\");\n\n        cfg->stateDir = g_strdup_printf(\"%s/libvirt/qemu\", RUNSTATEDIR);\n\n        cfg->swtpmStateDir = g_strdup_printf(\"%s/libvirt/qemu/swtpm\", RUNSTATEDIR);\n\n        cfg->cacheDir = g_strdup_printf(\"%s/cache/libvirt/qemu\", LOCALSTATEDIR);\n\n        cfg->libDir = g_strdup_printf(\"%s/lib/libvirt/qemu\", LOCALSTATEDIR);\n        cfg->saveDir = g_strdup_printf(\"%s/save\", cfg->libDir);\n        cfg->snapshotDir = g_strdup_printf(\"%s/snapshot\", cfg->libDir);\n        cfg->checkpointDir = g_strdup_printf(\"%s/checkpoint\", cfg->libDir);\n        cfg->autoDumpPath = g_strdup_printf(\"%s/dump\", cfg->libDir);\n        cfg->channelTargetDir = g_strdup_printf(\"%s/channel/target\", cfg->libDir);\n        cfg->nvramDir = g_strdup_printf(\"%s/nvram\", cfg->libDir);\n        cfg->memoryBackingDir = g_strdup_printf(\"%s/ram\", cfg->libDir);\n        cfg->swtpmStorageDir = g_strdup_printf(\"%s/lib/libvirt/swtpm\",\n                                               LOCALSTATEDIR);\n        if (!virDoesUserExist(\"tss\") ||\n            virGetUserID(\"tss\", &cfg->swtpm_user) < 0)\n            cfg->swtpm_user = 0; /* fall back to root */\n        if (!virDoesGroupExist(\"tss\") ||\n            virGetGroupID(\"tss\", &cfg->swtpm_group) < 0)\n            cfg->swtpm_group = 0; /* fall back to root */\n    } else {\n        g_autofree char *rundir = NULL;\n        g_autofree char *cachedir = NULL;\n\n        cachedir = virGetUserCacheDirectory();\n\n        cfg->logDir = g_strdup_printf(\"%s/qemu/log\", cachedir);\n        cfg->swtpmLogDir = g_strdup_printf(\"%s/qemu/log\", cachedir);\n        cfg->cacheDir = g_strdup_printf(\"%s/qemu/cache\", cachedir);\n\n        rundir = virGetUserRuntimeDirectory();\n        cfg->stateDir = g_strdup_printf(\"%s/qemu/run\", rundir);\n\n        cfg->swtpmStateDir = g_strdup_printf(\"%s/swtpm\", cfg->stateDir);\n\n        cfg->configBaseDir = virGetUserConfigDirectory();\n\n        cfg->libDir = g_strdup_printf(\"%s/qemu/lib\", cfg->configBaseDir);\n        cfg->saveDir = g_strdup_printf(\"%s/qemu/save\", cfg->configBaseDir);\n        cfg->snapshotDir = g_strdup_printf(\"%s/qemu/snapshot\", cfg->configBaseDir);\n        cfg->checkpointDir = g_strdup_printf(\"%s/qemu/checkpoint\",\n                                             cfg->configBaseDir);\n        cfg->autoDumpPath = g_strdup_printf(\"%s/qemu/dump\", cfg->configBaseDir);\n        cfg->channelTargetDir = g_strdup_printf(\"%s/qemu/channel/target\",\n                                                cfg->configBaseDir);\n        cfg->nvramDir = g_strdup_printf(\"%s/qemu/nvram\", cfg->configBaseDir);\n        cfg->memoryBackingDir = g_strdup_printf(\"%s/qemu/ram\", cfg->configBaseDir);\n        cfg->swtpmStorageDir = g_strdup_printf(\"%s/qemu/swtpm\",\n                                               cfg->configBaseDir);\n    }\n\n    if (privileged) {\n        if (!virDoesUserExist(\"tss\") ||\n            virGetUserID(\"tss\", &cfg->swtpm_user) < 0)\n            cfg->swtpm_user = 0; /* fall back to root */\n        if (!virDoesGroupExist(\"tss\") ||\n            virGetGroupID(\"tss\", &cfg->swtpm_group) < 0)\n            cfg->swtpm_group = 0; /* fall back to root */\n    } else {\n        cfg->swtpm_user = (uid_t)-1;\n        cfg->swtpm_group = (gid_t)-1;\n    }\n\n    cfg->configDir = g_strdup_printf(\"%s/qemu\", cfg->configBaseDir);\n    cfg->autostartDir = g_strdup_printf(\"%s/qemu/autostart\", cfg->configBaseDir);\n    cfg->slirpStateDir = g_strdup_printf(\"%s/slirp\", cfg->stateDir);\n\n    /* Set the default directory to find TLS X.509 certificates.\n     * This will then be used as a fallback if the service specific\n     * directory doesn't exist (although we don't check if this exists).\n     */\n    if (root == NULL) {\n        cfg->defaultTLSx509certdir = g_strdup(SYSCONFDIR \"pki/qemu\");\n    } else {\n        cfg->defaultTLSx509certdir = g_strdup_printf(\"%s/etc/pki/qemu\", root);\n    }\n\n    cfg->vncListen = g_strdup(VIR_LOOPBACK_IPV4_ADDR);\n    cfg->spiceListen = g_strdup(VIR_LOOPBACK_IPV4_ADDR);\n\n    cfg->remotePortMin = QEMU_REMOTE_PORT_MIN;\n    cfg->remotePortMax = QEMU_REMOTE_PORT_MAX;\n\n    cfg->webSocketPortMin = QEMU_WEBSOCKET_PORT_MIN;\n    cfg->webSocketPortMax = QEMU_WEBSOCKET_PORT_MAX;\n\n    cfg->migrationPortMin = QEMU_MIGRATION_PORT_MIN;\n    cfg->migrationPortMax = QEMU_MIGRATION_PORT_MAX;\n\n    /* For privileged driver, try and find hugetlbfs mounts automatically.\n     * Non-privileged driver requires admin to create a dir for the\n     * user, chown it, and then let user configure it manually. */\n    if (privileged &&\n        virFileFindHugeTLBFS(&cfg->hugetlbfs, &cfg->nhugetlbfs) < 0) {\n        /* This however is not implemented on all platforms. */\n        if (virGetLastErrorCode() != VIR_ERR_NO_SUPPORT)\n            return NULL;\n    }\n\n    cfg->bridgeHelperName = g_strdup(QEMU_BRIDGE_HELPER);\n    cfg->prHelperName = g_strdup(QEMU_PR_HELPER);\n    cfg->slirpHelperName = g_strdup(QEMU_SLIRP_HELPER);\n\n    cfg->securityDefaultConfined = true;\n    cfg->securityRequireConfined = false;\n\n    cfg->keepAliveInterval = 5;\n    cfg->keepAliveCount = 5;\n    cfg->seccompSandbox = -1;\n\n    cfg->logTimestamp = true;\n    cfg->glusterDebugLevel = 4;\n    cfg->stdioLogD = true;\n\n    if (!(cfg->namespaces = virBitmapNew(QEMU_DOMAIN_NS_LAST)))\n        return NULL;\n\n    if (privileged &&\n        qemuDomainNamespaceAvailable(QEMU_DOMAIN_NS_MOUNT) &&\n        virBitmapSetBit(cfg->namespaces, QEMU_DOMAIN_NS_MOUNT) < 0)\n        return NULL;\n\n    if (virFirmwareParseList(DEFAULT_LOADER_NVRAM,\n                             &cfg->firmwares,\n                             &cfg->nfirmwares) < 0)\n        return NULL;\n\n    return g_steal_pointer(&cfg);\n}"
  },
  {
    "function_name": "qemuDriverUnlock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
    "lines": "90-94",
    "snippet": "static void\nqemuDriverUnlock(virQEMUDriverPtr driver)\n{\n    virMutexUnlock(&driver->lock);\n}",
    "includes": [
      "#include \"configmake.h\"",
      "#include \"virutil.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virstring.h\"",
      "#include \"virsocket.h\"",
      "#include \"virfile.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virlog.h\"",
      "#include \"virxml.h\"",
      "#include \"datatypes.h\"",
      "#include \"viralloc.h\"",
      "#include \"virconf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_firmware.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_capabilities.h\"",
      "#include \"qemu_conf.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virMutexUnlock",
          "args": [
            "&driver->lock"
          ],
          "line": 93
        },
        "resolved": true,
        "details": {
          "function_name": "virMutexUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virthread.c",
          "lines": "86-89",
          "snippet": "void virMutexUnlock(virMutexPtr m)\n{\n    pthread_mutex_unlock(&m->lock);\n}",
          "includes": [
            "#include \"virthreadjob.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/syscall.h>",
            "#include <inttypes.h>",
            "#include <unistd.h>",
            "# include <pthread_np.h>",
            "#include \"virthread.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthreadjob.h\"\n#include \"viralloc.h\"\n# include <sys/syscall.h>\n#include <inttypes.h>\n#include <unistd.h>\n# include <pthread_np.h>\n#include \"virthread.h\"\n#include <config.h>\n\nvoid virMutexUnlock(virMutexPtr m)\n{\n    pthread_mutex_unlock(&m->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic void\nqemuDriverUnlock(virQEMUDriverPtr driver)\n{\n    virMutexUnlock(&driver->lock);\n}"
  },
  {
    "function_name": "qemuDriverLock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
    "lines": "85-89",
    "snippet": "static void\nqemuDriverLock(virQEMUDriverPtr driver)\n{\n    virMutexLock(&driver->lock);\n}",
    "includes": [
      "#include \"configmake.h\"",
      "#include \"virutil.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virstring.h\"",
      "#include \"virsocket.h\"",
      "#include \"virfile.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virlog.h\"",
      "#include \"virxml.h\"",
      "#include \"datatypes.h\"",
      "#include \"viralloc.h\"",
      "#include \"virconf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_firmware.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_capabilities.h\"",
      "#include \"qemu_conf.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "virMutexLock",
          "args": [
            "&driver->lock"
          ],
          "line": 88
        },
        "resolved": true,
        "details": {
          "function_name": "virMutexLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virthread.c",
          "lines": "81-84",
          "snippet": "void virMutexLock(virMutexPtr m)\n{\n    pthread_mutex_lock(&m->lock);\n}",
          "includes": [
            "#include \"virthreadjob.h\"",
            "#include \"viralloc.h\"",
            "# include <sys/syscall.h>",
            "#include <inttypes.h>",
            "#include <unistd.h>",
            "# include <pthread_np.h>",
            "#include \"virthread.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virthreadjob.h\"\n#include \"viralloc.h\"\n# include <sys/syscall.h>\n#include <inttypes.h>\n#include <unistd.h>\n# include <pthread_np.h>\n#include \"virthread.h\"\n#include <config.h>\n\nvoid virMutexLock(virMutexPtr m)\n{\n    pthread_mutex_lock(&m->lock);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic void\nqemuDriverLock(virQEMUDriverPtr driver)\n{\n    virMutexLock(&driver->lock);\n}"
  },
  {
    "function_name": "virQEMUConfigOnceInit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/qemu/qemu_conf.c",
    "lines": "74-80",
    "snippet": "static int virQEMUConfigOnceInit(void)\n{\n    if (!VIR_CLASS_NEW(virQEMUDriverConfig, virClassForObject()))\n        return -1;\n\n    return 0;\n}",
    "includes": [
      "#include \"configmake.h\"",
      "#include \"virutil.h\"",
      "#include \"storage_conf.h\"",
      "#include \"virstring.h\"",
      "#include \"virsocket.h\"",
      "#include \"virfile.h\"",
      "#include \"domain_nwfilter.h\"",
      "#include \"cpu/cpu.h\"",
      "#include \"virlog.h\"",
      "#include \"virxml.h\"",
      "#include \"datatypes.h\"",
      "#include \"viralloc.h\"",
      "#include \"virconf.h\"",
      "#include \"virbuffer.h\"",
      "#include \"viruuid.h\"",
      "#include \"qemu_security.h\"",
      "#include \"qemu_firmware.h\"",
      "#include \"qemu_domain.h\"",
      "#include \"qemu_capabilities.h\"",
      "#include \"qemu_conf.h\"",
      "#include \"virerror.h\"",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <sys/stat.h>",
      "#include <sys/types.h>",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_CLASS_NEW",
          "args": [
            "virQEMUDriverConfig",
            "virClassForObject()"
          ],
          "line": 76
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virClassForObject",
          "args": [],
          "line": 76
        },
        "resolved": true,
        "details": {
          "function_name": "virClassForObjectRWLockable",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virobject.c",
          "lines": "131-138",
          "snippet": "virClassPtr\nvirClassForObjectRWLockable(void)\n{\n    if (virObjectInitialize() < 0)\n        return NULL;\n\n    return virObjectRWLockableClass;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"virprobe.h\"",
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virobject.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [
            "static virClassPtr virObjectRWLockableClass;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"virprobe.h\"\n#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virobject.h\"\n#include <config.h>\n\nstatic virClassPtr virObjectRWLockableClass;\n\nvirClassPtr\nvirClassForObjectRWLockable(void)\n{\n    if (virObjectInitialize() < 0)\n        return NULL;\n\n    return virObjectRWLockableClass;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"configmake.h\"\n#include \"virutil.h\"\n#include \"storage_conf.h\"\n#include \"virstring.h\"\n#include \"virsocket.h\"\n#include \"virfile.h\"\n#include \"domain_nwfilter.h\"\n#include \"cpu/cpu.h\"\n#include \"virlog.h\"\n#include \"virxml.h\"\n#include \"datatypes.h\"\n#include \"viralloc.h\"\n#include \"virconf.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"qemu_security.h\"\n#include \"qemu_firmware.h\"\n#include \"qemu_domain.h\"\n#include \"qemu_capabilities.h\"\n#include \"qemu_conf.h\"\n#include \"virerror.h\"\n#include <fcntl.h>\n#include <unistd.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <config.h>\n\nstatic int virQEMUConfigOnceInit(void)\n{\n    if (!VIR_CLASS_NEW(virQEMUDriverConfig, virClassForObject()))\n        return -1;\n\n    return 0;\n}"
  }
]