[
  {
    "function_name": "virDomainDriverSetupPersistentDefBlkioParams",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/hypervisor/domain_driver.c",
    "lines": "211-252",
    "snippet": "int\nvirDomainDriverSetupPersistentDefBlkioParams(virDomainDefPtr persistentDef,\n                                             virTypedParameterPtr params,\n                                             int nparams)\n{\n    size_t i;\n    int ret = 0;\n\n    for (i = 0; i < nparams; i++) {\n        virTypedParameterPtr param = &params[i];\n\n        if (STREQ(param->field, VIR_DOMAIN_BLKIO_WEIGHT)) {\n            persistentDef->blkio.weight = param->value.ui;\n        } else if (STREQ(param->field, VIR_DOMAIN_BLKIO_DEVICE_WEIGHT) ||\n                   STREQ(param->field, VIR_DOMAIN_BLKIO_DEVICE_READ_IOPS) ||\n                   STREQ(param->field, VIR_DOMAIN_BLKIO_DEVICE_WRITE_IOPS) ||\n                   STREQ(param->field, VIR_DOMAIN_BLKIO_DEVICE_READ_BPS) ||\n                   STREQ(param->field, VIR_DOMAIN_BLKIO_DEVICE_WRITE_BPS)) {\n            virBlkioDevicePtr devices = NULL;\n            size_t ndevices;\n\n            if (virDomainDriverParseBlkioDeviceStr(param->value.s,\n                                             param->field,\n                                             &devices,\n                                             &ndevices) < 0) {\n                ret = -1;\n                continue;\n            }\n\n            if (virDomainDriverMergeBlkioDevice(&persistentDef->blkio.devices,\n                                                &persistentDef->blkio.ndevices,\n                                                devices, ndevices,\n                                                param->field) < 0)\n                ret = -1;\n\n            virBlkioDeviceArrayClear(devices, ndevices);\n            g_free(devices);\n        }\n    }\n\n    return ret;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"domain_driver.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "g_free",
          "args": [
            "devices"
          ],
          "line": 247
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBlkioDeviceArrayClear",
          "args": [
            "devices",
            "ndevices"
          ],
          "line": 246
        },
        "resolved": true,
        "details": {
          "function_name": "virBlkioDeviceArrayClear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "1538-1546",
          "snippet": "void\nvirBlkioDeviceArrayClear(virBlkioDevicePtr devices,\n                         int ndevices)\n{\n    size_t i;\n\n    for (i = 0; i < ndevices; i++)\n        VIR_FREE(devices[i].path);\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirBlkioDeviceArrayClear(virBlkioDevicePtr devices,\n                         int ndevices)\n{\n    size_t i;\n\n    for (i = 0; i < ndevices; i++)\n        VIR_FREE(devices[i].path);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDriverMergeBlkioDevice",
          "args": [
            "&persistentDef->blkio.devices",
            "&persistentDef->blkio.ndevices",
            "devices",
            "ndevices",
            "param->field"
          ],
          "line": 240
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDriverMergeBlkioDevice",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/hypervisor/domain_driver.c",
          "lines": "32-97",
          "snippet": "int\nvirDomainDriverMergeBlkioDevice(virBlkioDevicePtr *dest_array,\n                                size_t *dest_size,\n                                virBlkioDevicePtr src_array,\n                                size_t src_size,\n                                const char *type)\n{\n    size_t i, j;\n    virBlkioDevicePtr dest, src;\n\n    for (i = 0; i < src_size; i++) {\n        bool found = false;\n\n        src = &src_array[i];\n        for (j = 0; j < *dest_size; j++) {\n            dest = &(*dest_array)[j];\n            if (STREQ(src->path, dest->path)) {\n                found = true;\n\n                if (STREQ(type, VIR_DOMAIN_BLKIO_DEVICE_WEIGHT)) {\n                    dest->weight = src->weight;\n                } else if (STREQ(type, VIR_DOMAIN_BLKIO_DEVICE_READ_IOPS)) {\n                    dest->riops = src->riops;\n                } else if (STREQ(type, VIR_DOMAIN_BLKIO_DEVICE_WRITE_IOPS)) {\n                    dest->wiops = src->wiops;\n                } else if (STREQ(type, VIR_DOMAIN_BLKIO_DEVICE_READ_BPS)) {\n                    dest->rbps = src->rbps;\n                } else if (STREQ(type, VIR_DOMAIN_BLKIO_DEVICE_WRITE_BPS)) {\n                    dest->wbps = src->wbps;\n                } else {\n                    virReportError(VIR_ERR_INVALID_ARG, _(\"Unknown parameter %s\"),\n                                   type);\n                    return -1;\n                }\n                break;\n            }\n        }\n        if (!found) {\n            if (!src->weight && !src->riops && !src->wiops && !src->rbps && !src->wbps)\n                continue;\n            if (VIR_EXPAND_N(*dest_array, *dest_size, 1) < 0)\n                return -1;\n            dest = &(*dest_array)[*dest_size - 1];\n\n            if (STREQ(type, VIR_DOMAIN_BLKIO_DEVICE_WEIGHT)) {\n                dest->weight = src->weight;\n            } else if (STREQ(type, VIR_DOMAIN_BLKIO_DEVICE_READ_IOPS)) {\n                dest->riops = src->riops;\n            } else if (STREQ(type, VIR_DOMAIN_BLKIO_DEVICE_WRITE_IOPS)) {\n                dest->wiops = src->wiops;\n            } else if (STREQ(type, VIR_DOMAIN_BLKIO_DEVICE_READ_BPS)) {\n                dest->rbps = src->rbps;\n            } else if (STREQ(type, VIR_DOMAIN_BLKIO_DEVICE_WRITE_BPS)) {\n                dest->wbps = src->wbps;\n            } else {\n                *dest_size = *dest_size - 1;\n                return -1;\n            }\n\n            dest->path = src->path;\n            src->path = NULL;\n        }\n    }\n\n    return 0;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"domain_driver.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"domain_driver.h\"\n#include <config.h>\n\nint\nvirDomainDriverMergeBlkioDevice(virBlkioDevicePtr *dest_array,\n                                size_t *dest_size,\n                                virBlkioDevicePtr src_array,\n                                size_t src_size,\n                                const char *type)\n{\n    size_t i, j;\n    virBlkioDevicePtr dest, src;\n\n    for (i = 0; i < src_size; i++) {\n        bool found = false;\n\n        src = &src_array[i];\n        for (j = 0; j < *dest_size; j++) {\n            dest = &(*dest_array)[j];\n            if (STREQ(src->path, dest->path)) {\n                found = true;\n\n                if (STREQ(type, VIR_DOMAIN_BLKIO_DEVICE_WEIGHT)) {\n                    dest->weight = src->weight;\n                } else if (STREQ(type, VIR_DOMAIN_BLKIO_DEVICE_READ_IOPS)) {\n                    dest->riops = src->riops;\n                } else if (STREQ(type, VIR_DOMAIN_BLKIO_DEVICE_WRITE_IOPS)) {\n                    dest->wiops = src->wiops;\n                } else if (STREQ(type, VIR_DOMAIN_BLKIO_DEVICE_READ_BPS)) {\n                    dest->rbps = src->rbps;\n                } else if (STREQ(type, VIR_DOMAIN_BLKIO_DEVICE_WRITE_BPS)) {\n                    dest->wbps = src->wbps;\n                } else {\n                    virReportError(VIR_ERR_INVALID_ARG, _(\"Unknown parameter %s\"),\n                                   type);\n                    return -1;\n                }\n                break;\n            }\n        }\n        if (!found) {\n            if (!src->weight && !src->riops && !src->wiops && !src->rbps && !src->wbps)\n                continue;\n            if (VIR_EXPAND_N(*dest_array, *dest_size, 1) < 0)\n                return -1;\n            dest = &(*dest_array)[*dest_size - 1];\n\n            if (STREQ(type, VIR_DOMAIN_BLKIO_DEVICE_WEIGHT)) {\n                dest->weight = src->weight;\n            } else if (STREQ(type, VIR_DOMAIN_BLKIO_DEVICE_READ_IOPS)) {\n                dest->riops = src->riops;\n            } else if (STREQ(type, VIR_DOMAIN_BLKIO_DEVICE_WRITE_IOPS)) {\n                dest->wiops = src->wiops;\n            } else if (STREQ(type, VIR_DOMAIN_BLKIO_DEVICE_READ_BPS)) {\n                dest->rbps = src->rbps;\n            } else if (STREQ(type, VIR_DOMAIN_BLKIO_DEVICE_WRITE_BPS)) {\n                dest->wbps = src->wbps;\n            } else {\n                *dest_size = *dest_size - 1;\n                return -1;\n            }\n\n            dest->path = src->path;\n            src->path = NULL;\n        }\n    }\n\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virDomainDriverParseBlkioDeviceStr",
          "args": [
            "param->value.s",
            "param->field",
            "&devices",
            "&ndevices"
          ],
          "line": 232
        },
        "resolved": true,
        "details": {
          "function_name": "virDomainDriverParseBlkioDeviceStr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/hypervisor/domain_driver.c",
          "lines": "103-208",
          "snippet": "int\nvirDomainDriverParseBlkioDeviceStr(char *blkioDeviceStr, const char *type,\n                                   virBlkioDevicePtr *dev, size_t *size)\n{\n    char *temp;\n    int ndevices = 0;\n    int nsep = 0;\n    size_t i;\n    virBlkioDevicePtr result = NULL;\n\n    *dev = NULL;\n    *size = 0;\n\n    if (STREQ(blkioDeviceStr, \"\"))\n        return 0;\n\n    temp = blkioDeviceStr;\n    while (temp) {\n        temp = strchr(temp, ',');\n        if (temp) {\n            temp++;\n            nsep++;\n        }\n    }\n\n    /* A valid string must have even number of fields, hence an odd\n     * number of commas.  */\n    if (!(nsep & 1))\n        goto parse_error;\n\n    ndevices = (nsep + 1) / 2;\n\n    if (VIR_ALLOC_N(result, ndevices) < 0)\n        return -1;\n\n    i = 0;\n    temp = blkioDeviceStr;\n    while (temp) {\n        char *p = temp;\n\n        /* device path */\n        p = strchr(p, ',');\n        if (!p)\n            goto parse_error;\n\n        result[i].path = g_strndup(temp, p - temp);\n\n        /* value */\n        temp = p + 1;\n\n        if (STREQ(type, VIR_DOMAIN_BLKIO_DEVICE_WEIGHT)) {\n            if (virStrToLong_uip(temp, &p, 10, &result[i].weight) < 0)\n                goto number_error;\n        } else if (STREQ(type, VIR_DOMAIN_BLKIO_DEVICE_READ_IOPS)) {\n            if (virStrToLong_uip(temp, &p, 10, &result[i].riops) < 0)\n                goto number_error;\n        } else if (STREQ(type, VIR_DOMAIN_BLKIO_DEVICE_WRITE_IOPS)) {\n            if (virStrToLong_uip(temp, &p, 10, &result[i].wiops) < 0)\n                goto number_error;\n        } else if (STREQ(type, VIR_DOMAIN_BLKIO_DEVICE_READ_BPS)) {\n            if (virStrToLong_ullp(temp, &p, 10, &result[i].rbps) < 0)\n                goto number_error;\n        } else if (STREQ(type, VIR_DOMAIN_BLKIO_DEVICE_WRITE_BPS)) {\n            if (virStrToLong_ullp(temp, &p, 10, &result[i].wbps) < 0)\n                goto number_error;\n        } else {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"unknown parameter '%s'\"), type);\n            goto cleanup;\n        }\n\n        i++;\n\n        if (*p == '\\0')\n            break;\n        else if (*p != ',')\n            goto parse_error;\n        temp = p + 1;\n    }\n\n    if (!i)\n        VIR_FREE(result);\n\n    *dev = result;\n    *size = i;\n\n    return 0;\n\n parse_error:\n    virReportError(VIR_ERR_INVALID_ARG,\n                   _(\"unable to parse blkio device '%s' '%s'\"),\n                   type, blkioDeviceStr);\n    goto cleanup;\n\n number_error:\n    virReportError(VIR_ERR_INVALID_ARG,\n                   _(\"invalid value '%s' for parameter '%s' of device '%s'\"),\n                   temp, type, result[i].path);\n\n cleanup:\n    if (result) {\n        virBlkioDeviceArrayClear(result, ndevices);\n        VIR_FREE(result);\n    }\n    return -1;\n}",
          "includes": [
            "#include \"virstring.h\"",
            "#include \"viralloc.h\"",
            "#include \"domain_driver.h\"",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"domain_driver.h\"\n#include <config.h>\n\nint\nvirDomainDriverParseBlkioDeviceStr(char *blkioDeviceStr, const char *type,\n                                   virBlkioDevicePtr *dev, size_t *size)\n{\n    char *temp;\n    int ndevices = 0;\n    int nsep = 0;\n    size_t i;\n    virBlkioDevicePtr result = NULL;\n\n    *dev = NULL;\n    *size = 0;\n\n    if (STREQ(blkioDeviceStr, \"\"))\n        return 0;\n\n    temp = blkioDeviceStr;\n    while (temp) {\n        temp = strchr(temp, ',');\n        if (temp) {\n            temp++;\n            nsep++;\n        }\n    }\n\n    /* A valid string must have even number of fields, hence an odd\n     * number of commas.  */\n    if (!(nsep & 1))\n        goto parse_error;\n\n    ndevices = (nsep + 1) / 2;\n\n    if (VIR_ALLOC_N(result, ndevices) < 0)\n        return -1;\n\n    i = 0;\n    temp = blkioDeviceStr;\n    while (temp) {\n        char *p = temp;\n\n        /* device path */\n        p = strchr(p, ',');\n        if (!p)\n            goto parse_error;\n\n        result[i].path = g_strndup(temp, p - temp);\n\n        /* value */\n        temp = p + 1;\n\n        if (STREQ(type, VIR_DOMAIN_BLKIO_DEVICE_WEIGHT)) {\n            if (virStrToLong_uip(temp, &p, 10, &result[i].weight) < 0)\n                goto number_error;\n        } else if (STREQ(type, VIR_DOMAIN_BLKIO_DEVICE_READ_IOPS)) {\n            if (virStrToLong_uip(temp, &p, 10, &result[i].riops) < 0)\n                goto number_error;\n        } else if (STREQ(type, VIR_DOMAIN_BLKIO_DEVICE_WRITE_IOPS)) {\n            if (virStrToLong_uip(temp, &p, 10, &result[i].wiops) < 0)\n                goto number_error;\n        } else if (STREQ(type, VIR_DOMAIN_BLKIO_DEVICE_READ_BPS)) {\n            if (virStrToLong_ullp(temp, &p, 10, &result[i].rbps) < 0)\n                goto number_error;\n        } else if (STREQ(type, VIR_DOMAIN_BLKIO_DEVICE_WRITE_BPS)) {\n            if (virStrToLong_ullp(temp, &p, 10, &result[i].wbps) < 0)\n                goto number_error;\n        } else {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"unknown parameter '%s'\"), type);\n            goto cleanup;\n        }\n\n        i++;\n\n        if (*p == '\\0')\n            break;\n        else if (*p != ',')\n            goto parse_error;\n        temp = p + 1;\n    }\n\n    if (!i)\n        VIR_FREE(result);\n\n    *dev = result;\n    *size = i;\n\n    return 0;\n\n parse_error:\n    virReportError(VIR_ERR_INVALID_ARG,\n                   _(\"unable to parse blkio device '%s' '%s'\"),\n                   type, blkioDeviceStr);\n    goto cleanup;\n\n number_error:\n    virReportError(VIR_ERR_INVALID_ARG,\n                   _(\"invalid value '%s' for parameter '%s' of device '%s'\"),\n                   temp, type, result[i].path);\n\n cleanup:\n    if (result) {\n        virBlkioDeviceArrayClear(result, ndevices);\n        VIR_FREE(result);\n    }\n    return -1;\n}"
        }
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "param->field",
            "VIR_DOMAIN_BLKIO_DEVICE_WRITE_BPS"
          ],
          "line": 228
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "param->field",
            "VIR_DOMAIN_BLKIO_DEVICE_READ_BPS"
          ],
          "line": 227
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "param->field",
            "VIR_DOMAIN_BLKIO_DEVICE_WRITE_IOPS"
          ],
          "line": 226
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "param->field",
            "VIR_DOMAIN_BLKIO_DEVICE_READ_IOPS"
          ],
          "line": 225
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "param->field",
            "VIR_DOMAIN_BLKIO_DEVICE_WEIGHT"
          ],
          "line": 224
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "param->field",
            "VIR_DOMAIN_BLKIO_WEIGHT"
          ],
          "line": 222
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"domain_driver.h\"\n#include <config.h>\n\nint\nvirDomainDriverSetupPersistentDefBlkioParams(virDomainDefPtr persistentDef,\n                                             virTypedParameterPtr params,\n                                             int nparams)\n{\n    size_t i;\n    int ret = 0;\n\n    for (i = 0; i < nparams; i++) {\n        virTypedParameterPtr param = &params[i];\n\n        if (STREQ(param->field, VIR_DOMAIN_BLKIO_WEIGHT)) {\n            persistentDef->blkio.weight = param->value.ui;\n        } else if (STREQ(param->field, VIR_DOMAIN_BLKIO_DEVICE_WEIGHT) ||\n                   STREQ(param->field, VIR_DOMAIN_BLKIO_DEVICE_READ_IOPS) ||\n                   STREQ(param->field, VIR_DOMAIN_BLKIO_DEVICE_WRITE_IOPS) ||\n                   STREQ(param->field, VIR_DOMAIN_BLKIO_DEVICE_READ_BPS) ||\n                   STREQ(param->field, VIR_DOMAIN_BLKIO_DEVICE_WRITE_BPS)) {\n            virBlkioDevicePtr devices = NULL;\n            size_t ndevices;\n\n            if (virDomainDriverParseBlkioDeviceStr(param->value.s,\n                                             param->field,\n                                             &devices,\n                                             &ndevices) < 0) {\n                ret = -1;\n                continue;\n            }\n\n            if (virDomainDriverMergeBlkioDevice(&persistentDef->blkio.devices,\n                                                &persistentDef->blkio.ndevices,\n                                                devices, ndevices,\n                                                param->field) < 0)\n                ret = -1;\n\n            virBlkioDeviceArrayClear(devices, ndevices);\n            g_free(devices);\n        }\n    }\n\n    return ret;\n}"
  },
  {
    "function_name": "virDomainDriverParseBlkioDeviceStr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/hypervisor/domain_driver.c",
    "lines": "103-208",
    "snippet": "int\nvirDomainDriverParseBlkioDeviceStr(char *blkioDeviceStr, const char *type,\n                                   virBlkioDevicePtr *dev, size_t *size)\n{\n    char *temp;\n    int ndevices = 0;\n    int nsep = 0;\n    size_t i;\n    virBlkioDevicePtr result = NULL;\n\n    *dev = NULL;\n    *size = 0;\n\n    if (STREQ(blkioDeviceStr, \"\"))\n        return 0;\n\n    temp = blkioDeviceStr;\n    while (temp) {\n        temp = strchr(temp, ',');\n        if (temp) {\n            temp++;\n            nsep++;\n        }\n    }\n\n    /* A valid string must have even number of fields, hence an odd\n     * number of commas.  */\n    if (!(nsep & 1))\n        goto parse_error;\n\n    ndevices = (nsep + 1) / 2;\n\n    if (VIR_ALLOC_N(result, ndevices) < 0)\n        return -1;\n\n    i = 0;\n    temp = blkioDeviceStr;\n    while (temp) {\n        char *p = temp;\n\n        /* device path */\n        p = strchr(p, ',');\n        if (!p)\n            goto parse_error;\n\n        result[i].path = g_strndup(temp, p - temp);\n\n        /* value */\n        temp = p + 1;\n\n        if (STREQ(type, VIR_DOMAIN_BLKIO_DEVICE_WEIGHT)) {\n            if (virStrToLong_uip(temp, &p, 10, &result[i].weight) < 0)\n                goto number_error;\n        } else if (STREQ(type, VIR_DOMAIN_BLKIO_DEVICE_READ_IOPS)) {\n            if (virStrToLong_uip(temp, &p, 10, &result[i].riops) < 0)\n                goto number_error;\n        } else if (STREQ(type, VIR_DOMAIN_BLKIO_DEVICE_WRITE_IOPS)) {\n            if (virStrToLong_uip(temp, &p, 10, &result[i].wiops) < 0)\n                goto number_error;\n        } else if (STREQ(type, VIR_DOMAIN_BLKIO_DEVICE_READ_BPS)) {\n            if (virStrToLong_ullp(temp, &p, 10, &result[i].rbps) < 0)\n                goto number_error;\n        } else if (STREQ(type, VIR_DOMAIN_BLKIO_DEVICE_WRITE_BPS)) {\n            if (virStrToLong_ullp(temp, &p, 10, &result[i].wbps) < 0)\n                goto number_error;\n        } else {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"unknown parameter '%s'\"), type);\n            goto cleanup;\n        }\n\n        i++;\n\n        if (*p == '\\0')\n            break;\n        else if (*p != ',')\n            goto parse_error;\n        temp = p + 1;\n    }\n\n    if (!i)\n        VIR_FREE(result);\n\n    *dev = result;\n    *size = i;\n\n    return 0;\n\n parse_error:\n    virReportError(VIR_ERR_INVALID_ARG,\n                   _(\"unable to parse blkio device '%s' '%s'\"),\n                   type, blkioDeviceStr);\n    goto cleanup;\n\n number_error:\n    virReportError(VIR_ERR_INVALID_ARG,\n                   _(\"invalid value '%s' for parameter '%s' of device '%s'\"),\n                   temp, type, result[i].path);\n\n cleanup:\n    if (result) {\n        virBlkioDeviceArrayClear(result, ndevices);\n        VIR_FREE(result);\n    }\n    return -1;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"domain_driver.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "result"
          ],
          "line": 205
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virBlkioDeviceArrayClear",
          "args": [
            "result",
            "ndevices"
          ],
          "line": 204
        },
        "resolved": true,
        "details": {
          "function_name": "virBlkioDeviceArrayClear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/conf/domain_conf.c",
          "lines": "1538-1546",
          "snippet": "void\nvirBlkioDeviceArrayClear(virBlkioDevicePtr devices,\n                         int ndevices)\n{\n    size_t i;\n\n    for (i = 0; i < ndevices; i++)\n        VIR_FREE(devices[i].path);\n}",
          "includes": [
            "#include \"vircrypto.h\"",
            "#include \"virutil.h\"",
            "#include \"virdomaincheckpointobjlist.h\"",
            "#include \"virdomainsnapshotobjlist.h\"",
            "#include \"virmdev.h\"",
            "#include \"virarptable.h\"",
            "#include \"virnetdevmacvlan.h\"",
            "#include \"virnetdevtap.h\"",
            "#include \"virnetdev.h\"",
            "#include \"virstring.h\"",
            "#include \"virsecret.h\"",
            "#include \"virtpm.h\"",
            "#include \"network_conf.h\"",
            "#include \"device_conf.h\"",
            "#include \"netdev_vlan_conf.h\"",
            "#include \"netdev_bandwidth_conf.h\"",
            "#include \"netdev_vport_profile_conf.h\"",
            "#include \"secret_conf.h\"",
            "#include \"virbitmap.h\"",
            "#include \"virfile.h\"",
            "#include \"virstoragefile.h\"",
            "#include \"storage_conf.h\"",
            "#include \"virnetworkportdef.h\"",
            "#include \"nwfilter_conf.h\"",
            "#include \"virlog.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viruuid.h\"",
            "#include \"virxml.h\"",
            "#include \"viralloc.h\"",
            "#include \"snapshot_conf.h\"",
            "#include \"domain_conf.h\"",
            "#include \"domain_addr.h\"",
            "#include \"datatypes.h\"",
            "#include \"checkpoint_conf.h\"",
            "#include \"virerror.h\"",
            "#include \"internal.h\"",
            "#include \"configmake.h\"",
            "#include <unistd.h>",
            "#include <sys/stat.h>",
            "#include <fcntl.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"vircrypto.h\"\n#include \"virutil.h\"\n#include \"virdomaincheckpointobjlist.h\"\n#include \"virdomainsnapshotobjlist.h\"\n#include \"virmdev.h\"\n#include \"virarptable.h\"\n#include \"virnetdevmacvlan.h\"\n#include \"virnetdevtap.h\"\n#include \"virnetdev.h\"\n#include \"virstring.h\"\n#include \"virsecret.h\"\n#include \"virtpm.h\"\n#include \"network_conf.h\"\n#include \"device_conf.h\"\n#include \"netdev_vlan_conf.h\"\n#include \"netdev_bandwidth_conf.h\"\n#include \"netdev_vport_profile_conf.h\"\n#include \"secret_conf.h\"\n#include \"virbitmap.h\"\n#include \"virfile.h\"\n#include \"virstoragefile.h\"\n#include \"storage_conf.h\"\n#include \"virnetworkportdef.h\"\n#include \"nwfilter_conf.h\"\n#include \"virlog.h\"\n#include \"virbuffer.h\"\n#include \"viruuid.h\"\n#include \"virxml.h\"\n#include \"viralloc.h\"\n#include \"snapshot_conf.h\"\n#include \"domain_conf.h\"\n#include \"domain_addr.h\"\n#include \"datatypes.h\"\n#include \"checkpoint_conf.h\"\n#include \"virerror.h\"\n#include \"internal.h\"\n#include \"configmake.h\"\n#include <unistd.h>\n#include <sys/stat.h>\n#include <fcntl.h>\n#include <config.h>\n\nvoid\nvirBlkioDeviceArrayClear(virBlkioDevicePtr devices,\n                         int ndevices)\n{\n    size_t i;\n\n    for (i = 0; i < ndevices; i++)\n        VIR_FREE(devices[i].path);\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INVALID_ARG",
            "_(\"invalid value '%s' for parameter '%s' of device '%s'\")",
            "temp",
            "type",
            "result[i].path"
          ],
          "line": 198
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"invalid value '%s' for parameter '%s' of device '%s'\""
          ],
          "line": 199
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INVALID_ARG",
            "_(\"unable to parse blkio device '%s' '%s'\")",
            "type",
            "blkioDeviceStr"
          ],
          "line": 192
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_FREE",
          "args": [
            "result"
          ],
          "line": 184
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INVALID_ARG",
            "_(\"unknown parameter '%s'\")",
            "type"
          ],
          "line": 169
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStrToLong_ullp",
          "args": [
            "temp",
            "&p",
            "10",
            "&result[i].wbps"
          ],
          "line": 166
        },
        "resolved": true,
        "details": {
          "function_name": "virStrToLong_ullp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "568-586",
          "snippet": "int\nvirStrToLong_ullp(char const *s, char **end_ptr, int base,\n                  unsigned long long *result)\n{\n    unsigned long long val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtoull(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToLong_ullp(char const *s, char **end_ptr, int base,\n                  unsigned long long *result)\n{\n    unsigned long long val;\n    char *p;\n    int err;\n\n    errno = 0;\n    val = strtoull(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "type",
            "VIR_DOMAIN_BLKIO_DEVICE_WRITE_BPS"
          ],
          "line": 165
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "type",
            "VIR_DOMAIN_BLKIO_DEVICE_READ_BPS"
          ],
          "line": 162
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virStrToLong_uip",
          "args": [
            "temp",
            "&p",
            "10",
            "&result[i].wiops"
          ],
          "line": 160
        },
        "resolved": true,
        "details": {
          "function_name": "virStrToLong_uip",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/virstring.c",
          "lines": "444-461",
          "snippet": "int\nvirStrToLong_uip(char const *s, char **end_ptr, int base, unsigned int *result)\n{\n    unsigned long int val;\n    char *p;\n    bool err = false;\n\n    errno = 0;\n    val = strtoul(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s || (unsigned int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}",
          "includes": [
            "#include \"virlog.h\"",
            "#include \"virerror.h\"",
            "#include \"virbuffer.h\"",
            "#include \"viralloc.h\"",
            "#include \"virthread.h\"",
            "#include \"virstring.h\"",
            "# include <xlocale.h>",
            "#include <locale.h>",
            "#include <glib/gprintf.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"virlog.h\"\n#include \"virerror.h\"\n#include \"virbuffer.h\"\n#include \"viralloc.h\"\n#include \"virthread.h\"\n#include \"virstring.h\"\n# include <xlocale.h>\n#include <locale.h>\n#include <glib/gprintf.h>\n#include <config.h>\n\nint\nvirStrToLong_uip(char const *s, char **end_ptr, int base, unsigned int *result)\n{\n    unsigned long int val;\n    char *p;\n    bool err = false;\n\n    errno = 0;\n    val = strtoul(s, &p, base); /* exempt from syntax-check */\n    err = (memchr(s, '-', p - s) ||\n           errno || (!end_ptr && *p) || p == s || (unsigned int) val != val);\n    if (end_ptr)\n        *end_ptr = p;\n    if (err)\n        return -1;\n    *result = val;\n    return 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "type",
            "VIR_DOMAIN_BLKIO_DEVICE_WRITE_IOPS"
          ],
          "line": 159
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "type",
            "VIR_DOMAIN_BLKIO_DEVICE_READ_IOPS"
          ],
          "line": 156
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "type",
            "VIR_DOMAIN_BLKIO_DEVICE_WEIGHT"
          ],
          "line": 153
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g_strndup",
          "args": [
            "temp",
            "p - temp"
          ],
          "line": 148
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "p",
            "','"
          ],
          "line": 144
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_ALLOC_N",
          "args": [
            "result",
            "ndevices"
          ],
          "line": 135
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strchr",
          "args": [
            "temp",
            "','"
          ],
          "line": 121
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "blkioDeviceStr",
            "\"\""
          ],
          "line": 116
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"domain_driver.h\"\n#include <config.h>\n\nint\nvirDomainDriverParseBlkioDeviceStr(char *blkioDeviceStr, const char *type,\n                                   virBlkioDevicePtr *dev, size_t *size)\n{\n    char *temp;\n    int ndevices = 0;\n    int nsep = 0;\n    size_t i;\n    virBlkioDevicePtr result = NULL;\n\n    *dev = NULL;\n    *size = 0;\n\n    if (STREQ(blkioDeviceStr, \"\"))\n        return 0;\n\n    temp = blkioDeviceStr;\n    while (temp) {\n        temp = strchr(temp, ',');\n        if (temp) {\n            temp++;\n            nsep++;\n        }\n    }\n\n    /* A valid string must have even number of fields, hence an odd\n     * number of commas.  */\n    if (!(nsep & 1))\n        goto parse_error;\n\n    ndevices = (nsep + 1) / 2;\n\n    if (VIR_ALLOC_N(result, ndevices) < 0)\n        return -1;\n\n    i = 0;\n    temp = blkioDeviceStr;\n    while (temp) {\n        char *p = temp;\n\n        /* device path */\n        p = strchr(p, ',');\n        if (!p)\n            goto parse_error;\n\n        result[i].path = g_strndup(temp, p - temp);\n\n        /* value */\n        temp = p + 1;\n\n        if (STREQ(type, VIR_DOMAIN_BLKIO_DEVICE_WEIGHT)) {\n            if (virStrToLong_uip(temp, &p, 10, &result[i].weight) < 0)\n                goto number_error;\n        } else if (STREQ(type, VIR_DOMAIN_BLKIO_DEVICE_READ_IOPS)) {\n            if (virStrToLong_uip(temp, &p, 10, &result[i].riops) < 0)\n                goto number_error;\n        } else if (STREQ(type, VIR_DOMAIN_BLKIO_DEVICE_WRITE_IOPS)) {\n            if (virStrToLong_uip(temp, &p, 10, &result[i].wiops) < 0)\n                goto number_error;\n        } else if (STREQ(type, VIR_DOMAIN_BLKIO_DEVICE_READ_BPS)) {\n            if (virStrToLong_ullp(temp, &p, 10, &result[i].rbps) < 0)\n                goto number_error;\n        } else if (STREQ(type, VIR_DOMAIN_BLKIO_DEVICE_WRITE_BPS)) {\n            if (virStrToLong_ullp(temp, &p, 10, &result[i].wbps) < 0)\n                goto number_error;\n        } else {\n            virReportError(VIR_ERR_INVALID_ARG,\n                           _(\"unknown parameter '%s'\"), type);\n            goto cleanup;\n        }\n\n        i++;\n\n        if (*p == '\\0')\n            break;\n        else if (*p != ',')\n            goto parse_error;\n        temp = p + 1;\n    }\n\n    if (!i)\n        VIR_FREE(result);\n\n    *dev = result;\n    *size = i;\n\n    return 0;\n\n parse_error:\n    virReportError(VIR_ERR_INVALID_ARG,\n                   _(\"unable to parse blkio device '%s' '%s'\"),\n                   type, blkioDeviceStr);\n    goto cleanup;\n\n number_error:\n    virReportError(VIR_ERR_INVALID_ARG,\n                   _(\"invalid value '%s' for parameter '%s' of device '%s'\"),\n                   temp, type, result[i].path);\n\n cleanup:\n    if (result) {\n        virBlkioDeviceArrayClear(result, ndevices);\n        VIR_FREE(result);\n    }\n    return -1;\n}"
  },
  {
    "function_name": "virDomainDriverMergeBlkioDevice",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/hypervisor/domain_driver.c",
    "lines": "32-97",
    "snippet": "int\nvirDomainDriverMergeBlkioDevice(virBlkioDevicePtr *dest_array,\n                                size_t *dest_size,\n                                virBlkioDevicePtr src_array,\n                                size_t src_size,\n                                const char *type)\n{\n    size_t i, j;\n    virBlkioDevicePtr dest, src;\n\n    for (i = 0; i < src_size; i++) {\n        bool found = false;\n\n        src = &src_array[i];\n        for (j = 0; j < *dest_size; j++) {\n            dest = &(*dest_array)[j];\n            if (STREQ(src->path, dest->path)) {\n                found = true;\n\n                if (STREQ(type, VIR_DOMAIN_BLKIO_DEVICE_WEIGHT)) {\n                    dest->weight = src->weight;\n                } else if (STREQ(type, VIR_DOMAIN_BLKIO_DEVICE_READ_IOPS)) {\n                    dest->riops = src->riops;\n                } else if (STREQ(type, VIR_DOMAIN_BLKIO_DEVICE_WRITE_IOPS)) {\n                    dest->wiops = src->wiops;\n                } else if (STREQ(type, VIR_DOMAIN_BLKIO_DEVICE_READ_BPS)) {\n                    dest->rbps = src->rbps;\n                } else if (STREQ(type, VIR_DOMAIN_BLKIO_DEVICE_WRITE_BPS)) {\n                    dest->wbps = src->wbps;\n                } else {\n                    virReportError(VIR_ERR_INVALID_ARG, _(\"Unknown parameter %s\"),\n                                   type);\n                    return -1;\n                }\n                break;\n            }\n        }\n        if (!found) {\n            if (!src->weight && !src->riops && !src->wiops && !src->rbps && !src->wbps)\n                continue;\n            if (VIR_EXPAND_N(*dest_array, *dest_size, 1) < 0)\n                return -1;\n            dest = &(*dest_array)[*dest_size - 1];\n\n            if (STREQ(type, VIR_DOMAIN_BLKIO_DEVICE_WEIGHT)) {\n                dest->weight = src->weight;\n            } else if (STREQ(type, VIR_DOMAIN_BLKIO_DEVICE_READ_IOPS)) {\n                dest->riops = src->riops;\n            } else if (STREQ(type, VIR_DOMAIN_BLKIO_DEVICE_WRITE_IOPS)) {\n                dest->wiops = src->wiops;\n            } else if (STREQ(type, VIR_DOMAIN_BLKIO_DEVICE_READ_BPS)) {\n                dest->rbps = src->rbps;\n            } else if (STREQ(type, VIR_DOMAIN_BLKIO_DEVICE_WRITE_BPS)) {\n                dest->wbps = src->wbps;\n            } else {\n                *dest_size = *dest_size - 1;\n                return -1;\n            }\n\n            dest->path = src->path;\n            src->path = NULL;\n        }\n    }\n\n    return 0;\n}",
    "includes": [
      "#include \"virstring.h\"",
      "#include \"viralloc.h\"",
      "#include \"domain_driver.h\"",
      "#include <config.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "type",
            "VIR_DOMAIN_BLKIO_DEVICE_WRITE_BPS"
          ],
          "line": 84
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "type",
            "VIR_DOMAIN_BLKIO_DEVICE_READ_BPS"
          ],
          "line": 82
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "type",
            "VIR_DOMAIN_BLKIO_DEVICE_WRITE_IOPS"
          ],
          "line": 80
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "type",
            "VIR_DOMAIN_BLKIO_DEVICE_READ_IOPS"
          ],
          "line": 78
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "type",
            "VIR_DOMAIN_BLKIO_DEVICE_WEIGHT"
          ],
          "line": 76
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VIR_EXPAND_N",
          "args": [
            "*dest_array",
            "*dest_size",
            "1"
          ],
          "line": 72
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "virReportError",
          "args": [
            "VIR_ERR_INVALID_ARG",
            "_(\"Unknown parameter %s\")",
            "type"
          ],
          "line": 62
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_",
          "args": [
            "\"Unknown parameter %s\""
          ],
          "line": 62
        },
        "resolved": true,
        "details": {
          "function_name": "vir_g_strdup_printf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_c/CVE-2020-10701/repo/src/util/glibcompat.c",
          "lines": "191-202",
          "snippet": "char *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}",
          "includes": [
            "#include \"glibcompat.h\"",
            "#include <unistd.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <config.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"glibcompat.h\"\n#include <unistd.h>\n#include <string.h>\n#include <stdlib.h>\n#include <config.h>\n\nchar *\nvir_g_strdup_printf(const char *msg, ...)\n{\n    va_list args;\n    char *ret;\n    va_start(args, msg);\n    ret = g_strdup_vprintf(msg, args);\n    if (!ret)\n        abort();\n    va_end(args);\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "type",
            "VIR_DOMAIN_BLKIO_DEVICE_WRITE_BPS"
          ],
          "line": 59
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "type",
            "VIR_DOMAIN_BLKIO_DEVICE_READ_BPS"
          ],
          "line": 57
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "type",
            "VIR_DOMAIN_BLKIO_DEVICE_WRITE_IOPS"
          ],
          "line": 55
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "type",
            "VIR_DOMAIN_BLKIO_DEVICE_READ_IOPS"
          ],
          "line": 53
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "type",
            "VIR_DOMAIN_BLKIO_DEVICE_WEIGHT"
          ],
          "line": 51
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STREQ",
          "args": [
            "src->path",
            "dest->path"
          ],
          "line": 48
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"virstring.h\"\n#include \"viralloc.h\"\n#include \"domain_driver.h\"\n#include <config.h>\n\nint\nvirDomainDriverMergeBlkioDevice(virBlkioDevicePtr *dest_array,\n                                size_t *dest_size,\n                                virBlkioDevicePtr src_array,\n                                size_t src_size,\n                                const char *type)\n{\n    size_t i, j;\n    virBlkioDevicePtr dest, src;\n\n    for (i = 0; i < src_size; i++) {\n        bool found = false;\n\n        src = &src_array[i];\n        for (j = 0; j < *dest_size; j++) {\n            dest = &(*dest_array)[j];\n            if (STREQ(src->path, dest->path)) {\n                found = true;\n\n                if (STREQ(type, VIR_DOMAIN_BLKIO_DEVICE_WEIGHT)) {\n                    dest->weight = src->weight;\n                } else if (STREQ(type, VIR_DOMAIN_BLKIO_DEVICE_READ_IOPS)) {\n                    dest->riops = src->riops;\n                } else if (STREQ(type, VIR_DOMAIN_BLKIO_DEVICE_WRITE_IOPS)) {\n                    dest->wiops = src->wiops;\n                } else if (STREQ(type, VIR_DOMAIN_BLKIO_DEVICE_READ_BPS)) {\n                    dest->rbps = src->rbps;\n                } else if (STREQ(type, VIR_DOMAIN_BLKIO_DEVICE_WRITE_BPS)) {\n                    dest->wbps = src->wbps;\n                } else {\n                    virReportError(VIR_ERR_INVALID_ARG, _(\"Unknown parameter %s\"),\n                                   type);\n                    return -1;\n                }\n                break;\n            }\n        }\n        if (!found) {\n            if (!src->weight && !src->riops && !src->wiops && !src->rbps && !src->wbps)\n                continue;\n            if (VIR_EXPAND_N(*dest_array, *dest_size, 1) < 0)\n                return -1;\n            dest = &(*dest_array)[*dest_size - 1];\n\n            if (STREQ(type, VIR_DOMAIN_BLKIO_DEVICE_WEIGHT)) {\n                dest->weight = src->weight;\n            } else if (STREQ(type, VIR_DOMAIN_BLKIO_DEVICE_READ_IOPS)) {\n                dest->riops = src->riops;\n            } else if (STREQ(type, VIR_DOMAIN_BLKIO_DEVICE_WRITE_IOPS)) {\n                dest->wiops = src->wiops;\n            } else if (STREQ(type, VIR_DOMAIN_BLKIO_DEVICE_READ_BPS)) {\n                dest->rbps = src->rbps;\n            } else if (STREQ(type, VIR_DOMAIN_BLKIO_DEVICE_WRITE_BPS)) {\n                dest->wbps = src->wbps;\n            } else {\n                *dest_size = *dest_size - 1;\n                return -1;\n            }\n\n            dest->path = src->path;\n            src->path = NULL;\n        }\n    }\n\n    return 0;\n}"
  }
]